<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-167"><a id="_idTextAnchor167" class="pcalibre calibre6 pcalibre1"/>13</h1>
<h1 id="_idParaDest-168" class="calibre5"><a id="_idTextAnchor168" class="pcalibre calibre6 pcalibre1"/>Putting It All Together</h1>
<p class="calibre3">In the previous chapters, we explored different data problems amenable to network science solutions, learned many network centrality metrics, and applied <strong class="bold">machine learning</strong> (<strong class="bold">ML</strong>) models to network science datasets. In this chapter, we’ll put together what we have learned so far to assess epidemic risk on a spatiotemporal dataset assessed at each time point for centrality metrics and number of Ebola cases. Our example will include network and other data collected on a geographic region of the Democratic Republic of Congo that was impacted by a large Ebola outbreak in 2018-2020 and several smaller outbreaks since 2020. We’ll also introduce a statistical model used to model time series data much like a regression model.</p>
<p class="calibre3">Specifically, we will cover the following topics in this chapter:</p>
<ul class="calibre10">
<li class="calibre11">Introduction to the problem</li>
<li class="calibre11">Introduction to <strong class="bold">generalized estimating </strong><strong class="bold">equations</strong> (<strong class="bold">GEEs</strong>)</li>
<li class="calibre11">Data transformation</li>
<li class="calibre11">Data modeling</li>
</ul>
<p class="calibre3">By the end of this chapter, you’ll understand how to solve a problem end-to-end with network science tools and statistical models. You’ll be able to run time series models in Python and interpret the results mathematically. Finally, you’ll end this chapter equipped to apply what you have learned in this book to data science problems that you face in your work.</p>
<h1 id="_idParaDest-169" class="calibre5"><a id="_idTextAnchor169" class="pcalibre calibre6 pcalibre1"/>Technical requirements</h1>
<p class="calibre3">The code for the practical examples presented in this chapter can be found here: <a href="https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python" class="pcalibre calibre6 pcalibre1">https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python</a></p>
<h1 id="_idParaDest-170" class="calibre5"><a id="_idTextAnchor170" class="pcalibre calibre6 pcalibre1"/>Introduction to the problem</h1>
<p class="calibre3">The <a id="_idIndexMarker562" class="pcalibre calibre6 pcalibre1"/>Ebola virus<a id="_idIndexMarker563" class="pcalibre calibre6 pcalibre1"/> is a <strong class="bold">filovirus</strong>, a single-stranded ribonucleic acid (RNA) virus enveloped with a lipid layer. It was first identified in 1976 and is <strong class="bold">zoonotic</strong>—spreading<a id="_idIndexMarker564" class="pcalibre calibre6 pcalibre1"/> from infected animal hosts to human populations. The animal vector from which Ebola spreads to humans is currently unknown. However, the virus is spread from person to person through direct contact with bodily fluids, placing frontline healthcare workers and family caregivers at high risk of both contracting and spreading the virus.</p>
<p class="calibre3">The Ebola virus inhibits immune response, inhibits clotting, promotes renal and electrolyte dysfunction, and promotes acidosis. All of these contribute to hypovolemia, which triggers organ failure and death in many cases. It is endemic to several areas of Africa, including the Congo Basin, where the majority of outbreaks have originated. Case fatality rates are typically in the 40-50% range in known outbreaks, typically due to a lack of supportive care such as transfusions and life support in rural regions that often experience the initial cases.</p>
<p class="calibre3">During outbreaks, personal protective gear is critical for avoiding spread to and by healthcare providers. However, in many rural areas, lack of medical supplies limits healthcare providers’ ability to protect themselves, contributing to early disease spread. In addition, isolation of cases is necessary to avoid infecting other patients seeking care at a clinic. <em class="italic">Figure 13</em><em class="italic">.1</em> shows a doctor in personal protective gear at a clinic set up to isolate Ebola patients:</p>
<div><div><img alt="Figure 13.1 – ﻿An illustration of a doctor in personal protective gear at a makeshift clinic to treat Ebola patients" src="img/B21087_13_01.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 13.1 – An illustration of a doctor in personal protective gear at a makeshift clinic to treat Ebola patients</p>
<p class="calibre3">In December 2013, the <a id="_idIndexMarker565" class="pcalibre calibre6 pcalibre1"/>worst outbreak of the Ebola virus began in Meliandou in Guéckédou Prefecture, Guinea—a small town from which the virus spread through Guinea and its neighbors, Sierra Leone and Liberia. Eventually, cases spread to Italy, Mali, Nigeria, Senegal, Spain, the United Kingdom, and the United States, with secondary cases reported in several of these countries (mainly healthcare workers). By the end of the outbreak, nearly 30,000 people were infected, and over 10,000 died. The virus mutated multiple times by the end of the outbreak in 2016, and researchers developed a vaccine to extinguish the epidemic and limit its spread around the world and within large cities such as Conakry, Guinea. The reproduction number ranged from 1.20 in Liberia to 2.02 in Sierra Leone, contributing to the rapid spread and high infection rate in the three main countries impacted.</p>
<p class="calibre3">The 2018 Ebola virus outbreak <a id="_idIndexMarker566" class="pcalibre calibre6 pcalibre1"/>in the Democratic Republic of Congo impacted the provinces of Ituri, North Kivu, and South Kivu, with cases concentrated in Beni, Butembo, Katwa, Kalunguta, Mabalako, and Mandima. Over 3,500 confirmed and suspected cases were identified by 2020, with over 2,200 deaths despite prompt intervention from local and international public health workers and the availability of a vaccine developed during the 2014 West African Ebola outbreak. From late 2018 to mid-2019, the reproduction number remained over 1, indicating sustained infection potential. In fact, most cases did occur during this time frame.</p>
<p class="calibre3">Prompt intervention limited the potential number of infected people to roughly 16,000—rather than 16 million people living in the impacted provinces—due to the isolation of towns and prompt interventions by public health workers. Border surveillance measures limited the spread of Ebola to neighboring countries such as Burundi and Rwanda. However, distrust of international aid workers, the ongoing conflict with the M23 rebel group, and violence spilling into treatment areas complicated the epidemic response by local and international aid groups. Better coordination of response and better handling of security threats could have prevented the spread and led to better survival rates.</p>
<p class="calibre3">While this chapter will focus on modeling networks that facilitated the spread of Ebola across regions of the Democratic Republic of Congo, the methods we’ll use can be extended to working<a id="_idIndexMarker567" class="pcalibre calibre6 pcalibre1"/> with any type of <strong class="bold">partial differential equation</strong> (<strong class="bold">PDE</strong>) model related to the spread of networks. For instance, readers interested in ecology and conservation might consider a network science approach to modeling the geographic spread of toxins that impact leafy sea dragons, Bahamian saw sharks or sulcata tortoise populations; they may also want to understand evasion or delays in predator-prey relationships. Social scientists might consider the spread of political ideologies across countries in a region or models where effects of behavior change at a population level in response to social media campaigns may involve delays, where change happens over longer periods of time or needs to reach a threshold before effects are seen. Biomedical researchers might consider chemical gradient models within the context of cell differentiation and morphogenesis, the spreading of seizures through the cerebral cortex, or even the dynamics of tumor growth across regions of the brain. Farmers may wish to consider spatial models that limit the spread of locusts or other pests that endanger crops with limited barrier resources.</p>
<p class="calibre3">For now, let’s return to our Ebola virus example and dive deeper into the context of the outbreak.</p>
<h2 id="_idParaDest-171" class="calibre7"><a id="_idTextAnchor171" class="pcalibre calibre6 pcalibre1"/>Ebola spread in the Democratic Republic of Congo – 2018-2020 outbreak</h2>
<p class="calibre3">Despite a<a id="_idIndexMarker568" class="pcalibre calibre6 pcalibre1"/> rapid response from public health workers, the 2018 Ebola outbreak included waves of exponential growth. Many impacted areas included cities with populations over 100,000, and militant attacks on healthcare facilities prior to the outbreak and since the outbreak have threatened medical infrastructure and prompt care for patients. Due to the ongoing conflict, many at-risk populations in rural areas outside major cities hesitated to receive vaccines or follow public health advisories. Misinformation was abundant, delaying treatment for some patients and allowing Ebola to spread to caregivers. All these factors facilitated the spread of Ebola from city to city within the impacted regions.</p>
<p class="calibre3">However, much of Ituri, North Kivu, and South Kivu includes regions of dense rainforests, wildlife preserves, and sparse populations, limiting travel between cities that typically fuels epidemic spread across regions (see <em class="italic">Figure 13</em><em class="italic">.2</em>). In fact, much of the spread occurred across larger cities connected by transportation. This likely ameliorated the impact of this Ebola epidemic compared to the West African 2014 outbreak that included cities with many transportation routes:</p>
<div><div><img alt="Figure 13.2 – ﻿An illustration of a protected area of the Congo Basin" src="img/B21087_13_02.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 13.2 – An illustration of a protected area of the Congo Basin</p>
<p class="calibre3">Unfortunately, due<a id="_idIndexMarker569" class="pcalibre calibre6 pcalibre1"/> to cities nested in densely forested regions where Ebola’s animal vectors live, the geography of the northeastern Democratic Republic of Congo increases the likelihood of outbreaks in the region. This increases the likelihood of future Ebola outbreaks in the region. Thus, it is important to study some of the factors that facilitate epidemic spread and vulnerability over time, such that quick and effective responses reach the region as soon as another outbreak is identified. This limits the number of people exposed and potentially lowers mortality rates as more people are vaccinated and treated.</p>
<h2 id="_idParaDest-172" class="calibre7"><a id="_idTextAnchor172" class="pcalibre calibre6 pcalibre1"/>Geography and logistics</h2>
<p class="calibre3">As we have<a id="_idIndexMarker570" class="pcalibre calibre6 pcalibre1"/> seen in the prior subsections, regional geography and the logistics of transportation between cities play a large role in the potential spread of an epidemic. Within an epidemic, an isolated area with little or no population mixing with other regions suggests a contained epidemic. However, a transportation hub (such as a city with many international flights per day) poses a much greater risk to public health during an outbreak. In fact, this is exactly what quickly spread COVID-19; short incubation periods coupled with many travelers from international hubs traveling to other international hubs led to an explosion of cases in new countries and continents until borders were shut down to stem the flow of disease.</p>
<p class="calibre3">In our analysis, we’ll consider a few of the regions most impacted by the 2018 Ebola outbreak, including network connectivity metrics based on transportation routes between regions, number of cases per year, number of violent incidents (which may displace people regionally), and number of disaster incidents (again, a regional displacement risk) from 2017-2021. We hypothesize that network metrics derived from regional connectivity will impact the number of Ebola cases during the outbreak period.</p>
<p class="calibre3">Before we begin constructing our dataset, let’s first establish the necessary tools for our analysis—specifically, longitudinal regression modeling.</p>
<h1 id="_idParaDest-173" class="calibre5"><a id="_idTextAnchor173" class="pcalibre calibre6 pcalibre1"/>Introduction to GEEs</h1>
<p class="calibre3">Regression models <a id="_idIndexMarker571" class="pcalibre calibre6 pcalibre1"/>come with many assumptions that need to be relaxed for many types of real-world problems. For instance, linear regression assumes a normally distributed outcome. In many problems, we may wish to work with binary outcome data (yes/no, survived/died, recurred/did not recur…), count data (number of events in a period of time, such as this chapter’s outcome), or failure rates for a manufactured product (likelihood of failure outcome).</p>
<p class="calibre3">One of the most common outcome distributions comes from the binomial distribution, in which binary data is collected across a population. For example, we may have a sample of patients in a glioblastoma study, where we compare 6-month survival rates of patients across different treatment groups. Each patient will either survive or die (binary outcome); aggregated by group, these outcomes form binomial distributions, which can be compared statistically to determine if an optimal treatment exists for glioblastoma patients.</p>
<p class="calibre3"><strong class="bold">Generalized linear regression</strong> extends <a id="_idIndexMarker572" class="pcalibre calibre6 pcalibre1"/>linear regression to outcomes such as the aforementioned ones by using a link function to transform the outcome to that of a normal distribution using a geometry-rooted map; most types of outcomes fit into this framework, as they belong to an outcome family called <a id="_idIndexMarker573" class="pcalibre calibre6 pcalibre1"/>the <strong class="bold">exponential family</strong>. Distributions in the exponential family can be mapped to each other using tools from geometry.</p>
<p class="calibre3">However, generalized linear regression <a id="_idIndexMarker574" class="pcalibre calibre6 pcalibre1"/>comes with many assumptions common to linear regression: linear independence of variables, linear relationships between predictor variables and the outcome, and constancy of errors across levels of predictor variables (technically called homoscedasticity), among others. Some of these assumptions—namely, independence of predictor variables—do not hold for time series or spatial data. Predictor variables measured at one time point likely depend on values of those variables measured at prior time points. In our example, the ability of public health workers and doctors to identify an outbreak early enough to stop it plays a large role in later case rates and resource needs (shown in <em class="italic">Figure 13</em><em class="italic">.3</em>):</p>
<div><div><img alt="Figure 13.3 – ﻿An illustration of doctors and epidemiologists tracking the source of an outbreak" src="img/B21087_13_03.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 13.3 – An illustration of doctors and epidemiologists tracking the source of an outbreak</p>
<p class="calibre3">GEEs are one<a id="_idIndexMarker575" class="pcalibre calibre6 pcalibre1"/> solution that mathematically transforms generalized linear models to data involving multiple time points or clustering within the dataset. Essentially, we can model dependencies across time (or clusters) using a matrix of dependency correlations. GEEs retain a link function, allowing them to model outcomes within the exponential family, such as our number of yearly Ebola cases across regions.</p>
<p class="calibre3">One of the advantages of this approach compared to other generalized linear model extensions for time series or clustered data is that GEEs are easier to compute. Many other extensions, such as generalized linear mixed models, require multilevel modeling, with dependencies across levels. This creates additional parameters and dependencies within the model (which create conditional distributions). GEEs do not involve conditional distribution calculations. This allows us to save on computational costs, even with simple time series or clustering components in our model.</p>
<p class="calibre3">For readers <a id="_idIndexMarker576" class="pcalibre calibre6 pcalibre1"/>who have a more advanced mathematical background, we’ll spend a bit of time diving into the mathematics of generalized linear models and GEEs in the next section. Readers less comfortable mathematically can skip the mathematical formalization and go directly into the data construction part of the <em class="italic">Our problem and GEE formulation</em> section. However, it’s helpful to know the mathematics behind regression equations when using them, and those of you interested in using GEEs are encouraged to look through the references at the end of the chapter for more detailed mathematical explanations.</p>
<h2 id="_idParaDest-174" class="calibre7"><a id="_idTextAnchor174" class="pcalibre calibre6 pcalibre1"/>Mathematics of GEEs</h2>
<p class="calibre3">In <strong class="bold">linear regression</strong>, where<a id="_idIndexMarker577" class="pcalibre calibre6 pcalibre1"/> the outcome is normally distributed <a id="_idIndexMarker578" class="pcalibre calibre6 pcalibre1"/>and observations and predictors are independent of each other, we estimate the effect sizes of each predictor through estimations of matrix algebra, where the outcomes are known for each <a id="_idIndexMarker579" class="pcalibre calibre6 pcalibre1"/>observation (represented as a <strong class="bold">vector</strong>) and the predictors are known for each observation (represented as a matrix of vectors associated with each predictor). The outcome vector equals the effect-size vector multiplied by the predictor matrix plus an error term to capture random errors in measurement. In practice, the problem is difficult to solve with matrix operations and an algorithm to estimate the effect sizes iteratively is used to solve it.</p>
<p class="calibre3">Generalized linear regression extends this methodology by introducing a link function applied to the outcome vector to transform the equation to a linear form, for which effect size coefficients are found by applying an algorithm. However, to rescale those effect sizes so that they match the scale of the original outcome prior to the application of the link function, we reverse the operations of the link function to scale the effect size appropriately. In logistic regression, for instance, a common link function involves log transformation. Exponentiating the effect sizes rescales those effect sizes so that they match the outcome’s scale rather than the log of the outcome.</p>
<p class="calibre3">In practice, linear and generalized linear regression models are <a id="_idIndexMarker580" class="pcalibre calibre6 pcalibre1"/>fit using <strong class="bold">maximum likelihood estimation</strong> (<strong class="bold">MLE</strong>), an algorithm that iteratively adjusts estimates of the effect-size vector. This algorithm fits according to the assumed probability distribution of the outcome and the observed distribution of the predictors by iterative resampling. This allows for statistical inference on the estimation of effect sizes.</p>
<p class="calibre3">With respect to <a id="_idIndexMarker581" class="pcalibre calibre6 pcalibre1"/>GEEs, the clustered nature of the outcomes and predictors by individuals in our sample over time introduces a correlation structure for each individual in our sample, as well as sample-based effect sizes for predictors based on outcomes. We define a best guess as to the structure of the correlation matrix within individuals, called the <strong class="bold">autoregressive structure</strong>, which<a id="_idIndexMarker582" class="pcalibre calibre6 pcalibre1"/> can be estimated from the data, left unspecified, or defined as a specific structure tying observations together across time or space. In practice, leaving this unspecified or estimated from the data is best if the correlation structure is not known. After defining the autoregressive structure, we estimate the covariance matrix to correct for any assumption errors within the autoregression specifications.</p>
<p class="calibre3">An algorithm then estimates the effect sizes within and across individuals. Generally, algorithms used to fit the model rely on computing the derivatives of the GEE’s linear algebra formulation rather than the computation of maximum likelihood estimators; derivative-based methods often offer computational advantages over the MLE methodology. In addition, derivative-based methods yield model output similar to a generalized linear regression model, though not all overall model fit statistics can be estimated.</p>
<p class="calibre3">Those of you who are interested in the linear algebra formulation of generalized linear regression and GEEs can consult the references at the end of this chapter for detailed explanations of these models and the estimators used to find predictor effect sizes. The Nelder (1972) text overviews the theory of generalized linear models and their computation very nicely. The Hanley et al. (2003) text provides both a linear algebra overview of GEEs and a simple case study where estimates can be calculated easily by readers. It’s recommended that those of you who wish to understand the mathematics behind GEEs start with the mathematics and computational methodology of generalized linear models before tackling models derived from them, such as GEEs.</p>
<p class="calibre3">For now, let’s turn back to the construction of our dataset.</p>
<h2 id="_idParaDest-175" class="calibre7"><a id="_idTextAnchor175" class="pcalibre calibre6 pcalibre1"/>Our problem and GEE formulation</h2>
<p class="calibre3">In our formulation<a id="_idIndexMarker583" class="pcalibre calibre6 pcalibre1"/> of Ebola risk over time and geography in the Democratic Republic of Congo, we’ll look at the number of yearly Ebola cases in one of the following cities as our outcome:</p>
<ul class="calibre10">
<li class="calibre11">Mandima</li>
<li class="calibre11">Mabalako</li>
<li class="calibre11">Kangulata</li>
<li class="calibre11">Katwa</li>
<li class="calibre11">Butembo</li>
<li class="calibre11">Bunia</li>
<li class="calibre11">Beni</li>
</ul>
<p class="calibre3">We’ll cluster these cities by province, including Mandima and Bunia in Ituri and Mandima, Mabalako, Kangulata, Katwa, Butembo, and Beni in North Kivu. Next, we’ll construct a network of transportation options between cities and obtain betweenness and degree of centrality for each city. This will provide us with an estimate of bridgeness and hubness within each year’s network.</p>
<p class="calibre3">We’ll also include other statistics, including the number of violent incidents that year involving our cities and the number of natural disasters impacting our cities.</p>
<p class="calibre3">For a number of Ebola cases, we’ll consolidate the <code>ebola-epidemic-health-zone-figures.csv</code> <strong class="bold">Humanitarian Data Exchange</strong> (<strong class="bold">HDX</strong>) dataset (<a href="https://data.humdata.org/dataset/ebola-cases-and-deaths-drc-north-kivu" class="pcalibre calibre6 pcalibre1">https://data.humdata.org/dataset/ebola-cases-and-deaths-drc-north-kivu</a>) to include the cities of <a id="_idIndexMarker584" class="pcalibre calibre6 pcalibre1"/>interest for our analysis. To obtain the necessary transportation, we’ll search the web for feasible routes between cities (biking, public transportation, or driving). Given that this is current data, we will also search for changes within the period of 2017-2021, including COVID-19 restrictions. We’ll use <strong class="bold">ReliefWeb</strong> to find incidents mentioning natural disasters (<a href="https://reliefweb.int/disasters?list=Democratic%20Republic%20of%20the%20Congo%20Disasters&amp;advanced-search=%28C75%29" class="pcalibre calibre6 pcalibre1">https://reliefweb.int/disasters?list=Democratic%20Republic%20of%20the%20Congo%20Disasters&amp;advanced-search=%28C75%29</a>). Consolidating another HDX dataset will yield information about violent incidents in each area (<a href="https://data.humdata.org/dataset/ucdp-data-for-democratic-republic-of-the-congo" class="pcalibre calibre6 pcalibre1">https://data.humdata.org/dataset/ucdp-data-for-democratic-republic-of-the-congo</a>). While this may not include all information for a region in our time period, we should capture <a id="_idIndexMarker585" class="pcalibre calibre6 pcalibre1"/>major conflicts or disasters.</p>
<p class="calibre3">Now that we have our data sources, let’s explore the data and perform the needed transformations to coax the data into a format that will work as input to our GEE model.</p>
<h1 id="_idParaDest-176" class="calibre5"><a id="_idTextAnchor176" class="pcalibre calibre6 pcalibre1"/>Data transformation</h1>
<p class="calibre3">As we assembled our<a id="_idIndexMarker586" class="pcalibre calibre6 pcalibre1"/> dataset, we noticed a few caveats in data quality worth mentioning. Very few natural disasters hit the area during our time period of interest, and these were spread across a wide geography. It’s unlikely that this factor will impact Ebola spread, but we will keep this variable in our dataset.</p>
<p class="calibre3">The source for violent incidents appears to be missing information, as known attacks on aid workers and Ebola treatment sites in Katwa are not included in the data. This suggests an incomplete data source that may not capture violent incidents at the level needed for a real-world analysis of factors influencing Ebola spread. However, for purposes of demonstrating this method, it captures enough to be potentially interesting in the analysis. In projects such as this, data quality can be questionable, as good sources are hard to find in much of the developing world.</p>
<p class="calibre3">The search for transportation routes was also questionable, yielding some insight into direct routes but not in as much detail as would be ideal. We considered any route between city pairs to be viable if travel would take less than 10 hours by car, bus, or foot travel. Most cities yielded useable data; however, some cities did not show viable routes, yielding isolated vertices in our travel network. No major differences in routing existed across the years (no projects listed to create new roads or bus routes), so our network properties will not change over the years.</p>
<p class="calibre3">The Ebola case source data likely showed some errors, as cumulative cases were sometimes lower over time for certain locations. We erred on the side of retaining positive or zero case totals per year, given that we hope to model our outcome as count data. Cases can be difficult to determine in such outbreaks, as lab confirmation is difficult and often time-consuming when sent to another city for analysis.</p>
<p class="calibre3">Thus, our data collection for this project highlights some of the real-world challenges of building datasets from scratch, particularly in areas where data collection may be incomplete or nonexistent with respect to open source sites. It is often advantageous to examine many potential sources and either merge insights or choose the best source. In our case, we chose the most complete sources to obtain our dataset.</p>
<h2 id="_idParaDest-177" class="calibre7"><a id="_idTextAnchor177" class="pcalibre calibre6 pcalibre1"/>Python wrangling</h2>
<p class="calibre3">From our sources, we’ve assembled a <code>.csv</code> file containing year, city, region, conflict, disaster, and Ebola case data. However, we’ll need <a id="_idIndexMarker587" class="pcalibre calibre6 pcalibre1"/>to compute <strong class="bold">betweenness centrality</strong> and <strong class="bold">degree centrality</strong> from our transportation network and <a id="_idIndexMarker588" class="pcalibre calibre6 pcalibre1"/>add that to our dataset to capture transportation network properties for each city.</p>
<p class="calibre3">Let’s get started <a id="_idIndexMarker589" class="pcalibre calibre6 pcalibre1"/>by computing the centrality metrics for each city in our transportation dataset so that we can append these values to our <code>.csv</code> file. We’ll compute the metrics using <code>Script 13.1</code>:</p>
<pre class="source-code">
#install igraph and pycairo
!pip install igraph
!pip install pycairo
#import igraph, pandas, and numpy
import igraph as ig
from igraph import Graph
import numpy as np
import pandas as pd
import os
#import adjacency matrix
File ="C:/users/njfar/OneDrive/Desktop/DRC_Transport.csv"
pwd = os.getcwd()
os.chdir(os.path.dirname(File))
mydata =
    pd.read_csv(os.path.basename(File),encoding='latin1',header=None)
#create and plot graph
g_transport=Graph.Adjacency(mydata)
ig.plot(
    g_transport,bbox=(200,200),
    vertex_label = ["Beni","Bunia","Butembo","Kalunguta","Katwa",
        "Mabalako","Mandima"]
)
#calculate betweenness and degree centrality
bet=Graph.betweenness(g_transport)
deg=Graph.degree(g_transport)
#create vector to add to dataset
degree=deg+deg+deg+deg+deg
betweenness=bet+bet+bet+bet+bet</pre> <p class="calibre3">This script <a id="_idIndexMarker590" class="pcalibre calibre6 pcalibre1"/>should yield a plot showing two isolated vertices and several vertices connected by weighted paths with values of <code>1</code>, <code>2</code>, or <code>3</code>, as shown in <em class="italic">Figure 13</em><em class="italic">.4</em>:</p>
<div><div><img alt="Figure 13.4 – A plot of the Ebola network city" src="img/B21087_13_04.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 13.4 – A plot of the Ebola network city</p>
<p class="calibre3">From <em class="italic">Figure 13</em><em class="italic">.4</em>, we<a id="_idIndexMarker591" class="pcalibre calibre6 pcalibre1"/> can see that Kalunguta and Mandima are not connected to other cities, while other cities seem to be connected quite densely into a high-traffic area. For a more comprehensive examination of travel, we might also consider the volume of travel between areas; within our context, this data does not seem to exist.</p>
<p class="calibre3">Now that we have our vectors of betweenness and degree centrality, which capture the bridgeness and hubness of our cities, we can attach these values to the dataset we’ve created to ready the dataset for analysis with a GEE.</p>
<h2 id="_idParaDest-178" class="calibre7"><a id="_idTextAnchor178" class="pcalibre calibre6 pcalibre1"/>GEE input</h2>
<p class="calibre3">Now<a id="_idIndexMarker592" class="pcalibre calibre6 pcalibre1"/> that we’ve derived our network metrics, let’s import our collected dataset and attach the network metrics as additional columns by adding to <code>Script 13.1</code>:</p>
<pre class="source-code">
#import Ebola dataset
File ="C:/users/njfar/OneDrive/Desktop/Ebola_Data.csv"
pwd = os.getcwd()
os.chdir(os.path.dirname(File))
data = pd.read_csv(os.path.basename(File),encoding='latin1')
#add degree and betweenness to Ebola dataset
degree=np.array(degree)
betweenness=np.array(betweenness)
data['Betweenness']=betweenness
data['Degree']=degree</pre> <p class="calibre3">Now that we’ve<a id="_idIndexMarker593" class="pcalibre calibre6 pcalibre1"/> assembled our full dataset, we’re ready to analyze it with our GEE model.</p>
<h1 id="_idParaDest-179" class="calibre5"><a id="_idTextAnchor179" class="pcalibre calibre6 pcalibre1"/>Data modeling</h1>
<p class="calibre3">For our model, we’ll assume our <a id="_idIndexMarker594" class="pcalibre calibre6 pcalibre1"/>outcome has a <strong class="bold">Poisson distribution</strong>. While<a id="_idIndexMarker595" class="pcalibre calibre6 pcalibre1"/> our dataset doesn’t have a lot of zero values, it may be worth considering a zero-inflated Poisson or negative binomial distribution rather than a Poisson distribution. However, for simplicity of modeling, we will set our family to a Poisson distribution.</p>
<p class="calibre3">We’ll use a data-derived autocorrelation structure, as a best guess for correlations over time within towns isn’t readily apparent. In practice, it’s usually better to derive this structure from data than make a guess when the structure isn’t known well beforehand.</p>
<p class="calibre3">Let’s get started modeling this GEE in Python.</p>
<h2 id="_idParaDest-180" class="calibre7"><a id="_idTextAnchor180" class="pcalibre calibre6 pcalibre1"/>Running the GEE in Python</h2>
<p class="calibre3">Let’s first import <a id="_idIndexMarker596" class="pcalibre calibre6 pcalibre1"/>our GEE model and define the distribution family and covariance structure with <code>Script 13.2</code>:</p>
<pre class="source-code">
#load packages
import statsmodels.api as sm
import statsmodels.formula.api as smf
#define GEE parameters
family=sm.families.Poisson() #count data
#data-derived covariance structure
cov_str=sm.cov_struct.Exchangeable()</pre> <p class="calibre3">Now that <a id="_idIndexMarker597" class="pcalibre calibre6 pcalibre1"/>we have our model defined, we can fit the model to our data, including all of our relevant predictors by adding to <code>Script 13.2</code>:</p>
<pre class="source-code">
#create GEE model predicting Ebola cases
Model = smf.gee(
    "Ebola_Cases~Province+ViolentIncidents+Disasters+Degree+Betweenness",
    "Town",
    data,
    cov_struct=cov_str,
    family=family
)
results=model.fit()</pre> <p class="calibre3">This model should fit quickly given the small size of the dataset. Larger models may take a while to run, particularly those with large numbers of clusters and many time points considered. However, this model will run more quickly than other longitudinal models such as generalized linear mixed models, as it does not have a hierarchical structure or likelihood function derivations.</p>
<p class="calibre3">We can now examine our model’s parameters and fit statistics to see what is predictive of Ebola cases within our data by adding to <code>Script 13.2</code>:</p>
<pre class="source-code">
#examine resulting model
results.summary()</pre> <p class="calibre3">This should<a id="_idIndexMarker598" class="pcalibre calibre6 pcalibre1"/> give a summary similar to <em class="italic">Table 13.1</em>:</p>
<table class="no-table-style" id="table001-3">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<thead class="calibre19">
<tr class="no-table-style1">
<td class="no-table-style2" colspan="4">
<p class="calibre3"><strong class="bold">GEE </strong><strong class="bold">Regression Results</strong></p>
</td>
</tr>
</thead>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Dep. Variable:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Ebola_Cases</p>
</td>
<td class="no-table-style2">
<p class="calibre3">No. Observations:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">35</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Model:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">GEE</p>
</td>
<td class="no-table-style2">
<p class="calibre3">No. clusters:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">7</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Method:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Generalized</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Min. cluster size:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">5</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2"/>
<td class="no-table-style2">
<p class="calibre3">Estimating Equations</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Max. cluster size:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">5</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Family:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Poisson</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Mean cluster size:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">5.0</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Dependence structure:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Exchangeable</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Num. iterations:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">11</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Date:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Thu, 21 Dec 2023</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Scale:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">1.000</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Covariance type:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">robust</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Time:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">10:18:47</p>
</td>
</tr>
</tbody>
</table>
<table class="no-table-style" id="table002-1">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<thead class="calibre19">
<tr class="no-table-style1">
<td class="no-table-style2"/>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">coef</strong></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">std err</strong></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">Z</strong></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">P&gt;|z|</strong></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">[</strong><strong class="bold">0.025</strong></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">0.975]</strong></p>
</td>
</tr>
</thead>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Intercept</p>
</td>
<td class="no-table-style2">
<p class="calibre3">3.8291</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.716</p>
</td>
<td class="no-table-style2">
<p class="calibre3">5.345</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.000</p>
</td>
<td class="no-table-style2">
<p class="calibre3">2.425</p>
</td>
<td class="no-table-style2">
<p class="calibre3">5.233</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Province[T.North_Kivu]</p>
</td>
<td class="no-table-style2">
<p class="calibre3">1.1145</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.699</p>
</td>
<td class="no-table-style2">
<p class="calibre3">1.593</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.111</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-0.256</p>
</td>
<td class="no-table-style2">
<p class="calibre3">2.485</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Violent_Incidents</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.0312</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.022</p>
</td>
<td class="no-table-style2">
<p class="calibre3">1.415</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.157</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-0.012</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.074</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Disasters</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-3.3828</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.323</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-10.467</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.000</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-4.016</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-2.749</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Degree</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-0.0098</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.093</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-0.105</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.917</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-0.192</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.173</p>
</td>
</tr>
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Betweenness</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-0.0806</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.975</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-0.083</p>
</td>
<td class="no-table-style2">
<p class="calibre3">0.934</p>
</td>
<td class="no-table-style2">
<p class="calibre3">-1.991</p>
</td>
<td class="no-table-style2">
<p class="calibre3">1.830</p>
</td>
</tr>
</tbody>
</table>
<table class="no-table-style" id="table003">
<colgroup class="calibre12">
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
<col class="calibre13"/>
</colgroup>
<thead class="calibre19">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">Skew:</strong></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">1.7851</strong></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">Kurtosis:</strong></p>
</td>
<td class="no-table-style2">
<p class="calibre3"><strong class="bold">3.7263</strong></p>
</td>
</tr>
</thead>
<tbody class="calibre14">
<tr class="no-table-style1">
<td class="no-table-style2">
<p class="calibre3">Centered skew:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">1.3387</p>
</td>
<td class="no-table-style2">
<p class="calibre3">Centered kurtosis:</p>
</td>
<td class="no-table-style2">
<p class="calibre3">2.2241</p>
</td>
</tr>
</tbody>
</table>
<p class="img---caption" lang="en-US" xml:lang="en-US">Table 13.1 – GEE model fit statistics</p>
<p class="calibre3"><em class="italic">Table 13.1</em> shows<a id="_idIndexMarker599" class="pcalibre calibre6 pcalibre1"/> that most of our predictors do not show a relationship with the number of Ebola cases in each town. Disasters do seem to have a negative relationship (<em class="italic">z</em>-value of <code>-10.467</code>, which is significant at <code>p&lt;0.001</code>). This might relate to relevant resources positioned in an area to respond to a disaster that can be repurposed for response to the Ebola outbreak. Note that violent incidents reach a level of near significance statistically (<em class="italic">z</em>-value of <code>1.415</code>, which is a <em class="italic">p</em>-value of <code>0.157</code>), showing a potentially positive relationship with the number of cases. In a larger sample and with better data on violent incidents, it is likely that violent incidents would turn out to be predictive of Ebola cases, as we had hypothesized. The location of North Kivu appears to have another nearly significant relationship (<em class="italic">p</em>-value of <code>0.111</code>), suggesting that it is an important location that requires monitoring. The other potential predictors have <em class="italic">z</em>-values near <code>0</code>, suggesting that they are not important and likely would not play a role even with a larger sample size.</p>
<p class="calibre3">We do not see either of our network metrics as a significant predictor of Ebola cases. It is likely that transportation does not play a large role in outbreak case volumes; given the relative isolation of some areas, this makes logical sense. Yearly travel volumes between cities, if they could be obtained, might be more predictive of Ebola cases over time. However, to our knowledge, this does not exist for the towns considered in our analysis.</p>
<h1 id="_idParaDest-181" class="calibre5"><a id="_idTextAnchor181" class="pcalibre calibre6 pcalibre1"/>Summary</h1>
<p class="calibre3">In this chapter, we tied together many of the tools we examined in previous chapters to tackle a major problem in public health: Ebola outbreaks. We constructed and analyzed properties of spatiotemporal data in a region recently impacted by an Ebola outbreak. We then fed this information into a longitudinal statistical model called a GEE to understand which factors may have contributed to the outbreak’s spread over time and geography using Python.</p>
<p class="calibre3">In this book so far, we have overviewed many tools and now applied them on a final project. Next, we’ll consider nascent tools in network science that offer promise for future projects, including hypergraphs and quantum network science algorithms.</p>
<h1 id="_idParaDest-182" class="calibre5"><a id="_idTextAnchor182" class="pcalibre calibre6 pcalibre1"/>References</h1>
<p class="calibre3">Ballinger, G. A. (2004). Using generalized estimating equations for longitudinal data analysis. <em class="italic">Organizational research methods, </em><em class="italic">7(2), 127-150.</em></p>
<p class="calibre3">Bolker, B. M., Brooks, M. E., Clark, C. J., Geange, S. W., Poulsen, J. R., Stevens, M. H. H., &amp; White, J. S. S. (2009). Generalized linear mixed models: a practical guide for ecology and evolution. <em class="italic">Trends in ecology &amp; evolution, </em><em class="italic">24(3), 127-135.</em></p>
<p class="calibre3">Breslow, N. E. (1996). Generalized linear models: checking assumptions and strengthening conclusions. <em class="italic">Statistica applicata, </em><em class="italic">8(1), 23-41.</em></p>
<p class="calibre3">Gatherer, D. (2014). The 2014 Ebola virus disease outbreak in West Africa. <em class="italic">Journal of General Virology, </em><em class="italic">95(8), 1619-1624.</em></p>
<p class="calibre3">Groseth, A., Feldmann, H., &amp; Strong, J. E. (2007). The ecology of Ebola virus. <em class="italic">Trends in microbiology, </em><em class="italic">15(9), 408-416.</em></p>
<p class="calibre3">Guetiya Wadoum, R. E., Sevalie, S., Minutolo, A., Clarke, A., Russo, G., Colizzi, V., ... &amp; Montesano, C. (2021). The 2018–2020 ebola outbreak in the Democratic Republic of Congo: A better response had been achieved through inter-state coordination in Africa. <em class="italic">Risk management and healthcare </em><em class="italic">policy, 4923-4930.</em></p>
<p class="calibre3">Hanley, J. A., Negassa, A., Edwardes, M. D. D., &amp; Forrester, J. E. (2003). Statistical analysis of correlated data using generalized estimating equations: an orientation. <em class="italic">American journal of epidemiology, </em><em class="italic">157(4), 364-375.</em></p>
<p class="calibre3">Holmes, E. C., Dudas, G., Rambaut, A., &amp; Andersen, K. G. (2016). The evolution of Ebola virus: Insights from the 2013–2016 epidemic. <em class="italic">Nature, </em><em class="italic">538(7624), 193-200.</em></p>
<p class="calibre3">Jacob, S. T., Crozier, I., Fischer, W. A., Hewlett, A., Kraft, C. S., Vega, M. A. D. L., ... &amp; Kuhn, J. H. (2020). Ebola virus disease. <em class="italic">Nature reviews Disease primers, </em><em class="italic">6(1), 13.</em></p>
<p class="calibre3">Liang, K. Y., &amp; Zeger, S. L. (1986). Longitudinal data analysis using generalized linear models. <em class="italic">Biometrika, </em><em class="italic">73(1), 13-22.</em></p>
<p class="calibre3">McKinney, W., Perktold, J., &amp; Seabold, S. (2011). Time Series Analysis in Python with statsmodels. <em class="italic">Jarrodmillman </em><em class="italic">Com, 96-102.</em></p>
<p class="calibre3">Nelder, J. A., &amp; Wedderburn, R. W. (1972). Generalized linear models. <em class="italic">Journal of the Royal Statistical Society Series A: Statistics in Society, </em><em class="italic">135(3), 370-384.</em></p>
<p class="calibre3">Vossler, H., Akilimali, P., Pan, Y., KhudaBukhsh, W. R., Kenah, E., &amp; Rempała, G. A. (2022). Analysis of individual-level data from 2018–2020 Ebola outbreak in Democratic Republic of the Congo. <em class="italic">Scientific Reports, </em><em class="italic">12(1), 5534.</em></p>
<p class="calibre3">WHO Ebola Response Team. (2014). Ebola virus disease in West Africa—the first 9 months of the epidemic and forward projections. <em class="italic">New England Journal of Medicine, </em><em class="italic">371(16), 1481-1495.</em></p>
</div>
</body></html>