<html><head></head><body>
		<div id="_idContainer034">
			<h1 id="_idParaDest-70" class="chapter-number"><a id="_idTextAnchor078"/>4</h1>
			<h1 id="_idParaDest-71"><a id="_idTextAnchor079"/>Automating Further – Task Scheduling and Email</h1>
			<p>Sometimes, we can spend countless hours tediously creating, formatting, and emailing Excel spreadsheets. Well, fret no more! With the power of programming, specifically R or Python, you can effortlessly automate these mundane tasks and reclaim your <span class="No-Break">precious time.</span></p>
			<p>Imagine this: you have a list of sales data that needs to be organized into a professional-looking spreadsheet and sent to multiple recipients via email. Instead of slogging through manual data entry and formatting, you can leverage the prowess of R or Python to simplify <span class="No-Break">your workflow.</span></p>
			<p>In R, you can use the amazing <strong class="source-inline">taskscheduleR</strong> package to schedule tasks and run your script automatically at specified times. With this, you can set up a recurring job to generate your Excel spreadsheets and send them out without lifting a finger. For emailing, you can employ the <strong class="source-inline">RDCOMClient</strong>, <strong class="source-inline">Windows365R</strong>, or <strong class="source-inline">blastula</strong> packages, which allow you to interact with Outlook and Gmail directly. This means you can compose and send emails with the attached spreadsheets effortlessly, customizing the content and recipients <span class="No-Break">as needed.</span></p>
			<p>But wait, Python enthusiasts! Fear not, for you, too, can achieve the same level of automation magic. In Python, you can utilize the <strong class="source-inline">pywin32</strong> library to send out beautifully formatted emails via Gmail. It seamlessly integrates with your code, enabling you to attach your Excel spreadsheets and customize the email’s content and recipients <span class="No-Break">with ease.</span></p>
			<p>By harnessing the power of R or Python, along with <strong class="source-inline">taskscheduleR</strong>, <strong class="source-inline">RDCOMClient</strong>, <strong class="source-inline">Windows365R</strong>, or <strong class="source-inline">blastula</strong>, you can become the hero of your office, delivering accurate, visually appealing spreadsheets promptly, all while sipping your coffee. Say goodbye to mind-numbing repetition and hello to efficient automation. Let your creativity flourish as you unlock the power of R or Python to conquer the world of Excel spreadsheets and email distribution with confidence <span class="No-Break">and ease!</span></p>
			<p>In this chapter, we’re going to cover the following <span class="No-Break">main topics:</span></p>
			<ul>
				<li>Installing and understanding the <span class="No-Break"><strong class="source-inline">taskscheduleR</strong></span><span class="No-Break"> library</span></li>
				<li>Using <strong class="source-inline">RDCOMClient</strong>, <strong class="source-inline">Windows365R</strong>, and <strong class="source-inline">blastula</strong> for email in Outlook <span class="No-Break">or Gmail</span></li>
				<li>Scheduling <span class="No-Break">Python scripts</span></li>
				<li>Email notifications and automation <span class="No-Break">with Python</span></li>
			</ul>
			<h1 id="_idParaDest-72"><a id="_idTextAnchor080"/>Technical requirements</h1>
			<p>The code for this chapter can be found <span class="No-Break">here: </span><a href="https://github.com/PacktPublishing/Extending-Excel-with-Python-and-R/tree/main/Chapter%204"><span class="No-Break">https://github.com/PacktPublishing/Extending-Excel-with-Python-and-R/tree/main/Chapter%204</span></a><span class="No-Break">.</span></p>
			<p>You will need to install the following new R and <span class="No-Break">Python packages:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">Blastula</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">Windows365R</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">schedule==1.2.0</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">apscheduler==3.10.1</strong></span></li>
			</ul>
			<h1 id="_idParaDest-73"><a id="_idTextAnchor081"/>Installing and understanding the tasksheduleR library</h1>
			<p>The <strong class="source-inline">taskscheduleR</strong> R package allows you <a id="_idIndexMarker174"/>to schedule R scripts or processes with the Windows task scheduler. This means that you can automate R processes on specific time points from within R itself. The package is basically a wrapper around the <strong class="source-inline">Schtasks.exe</strong> functionality. <strong class="source-inline">Schtasks.exe</strong> is a command line tool that allows you to create, delete, query, change, run, and finish scheduled tasks on a local or remote computer. To use <strong class="source-inline">taskscheduleR</strong>, you first need to install the package from CRAN. Once the package is installed, you can use the following functions<a id="_idIndexMarker175"/> to schedule <span class="No-Break">R scripts:</span></p>
			<ul>
				<li><strong class="source-inline">taskscheduler_create()</strong>: This function creates a new <span class="No-Break">scheduled task.</span></li>
				<li><strong class="source-inline">taskscheduler_remove()</strong>: This function removes an existing scheduled task. If you are using version 1.8, then the function <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">taskscheduler_delete()</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">taskscheduler_get()</strong>: This function gets the information about an existing <span class="No-Break">scheduled task.</span></li>
			</ul>
			<p>The <strong class="source-inline">taskscheduler_create()</strong> function takes a number of arguments, including the name of the scheduled task, the R script to run, and the schedule to run the script. For example, the following code would create a scheduled task that runs the R script <strong class="source-inline">my_scheduled_excel_script.R</strong> every day at <span class="No-Break">10:00 am:</span></p>
			<pre class="source-code">
taskscheduler_create(
  name = "My Scheduled Excel Task",
  rscript = "my_scheduled_excel_script.R",
  schedule = "DAILY",
  start_time = "10:00:00"
)`</pre>			<p>You can also use the GUI to create tasks for the job<a id="_idIndexMarker176"/> scheduler by installing <strong class="source-inline">miniUI</strong> and <strong class="source-inline">shiny</strong>. This will install the add-in capability of the package, allowing you to easily create jobs without writing a single line of code. Here is the code you can use if you want to install the preceding <span class="No-Break">packages listed:</span></p>
			<pre class="source-code">
# The initial package itself
install.packages("taskscheduleR")
# To use the GUI
install.packages('miniUI')
install.packages('shiny')</pre>			<p>Now, we see how to create scripts <span class="No-Break">for this.</span></p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor082"/>Creating sample scripts</h2>
			<p>The first thing we need<a id="_idIndexMarker177"/> to do is create a script that can be run via the Windows task scheduler. Let’s keep the script simple and just print <strong class="source-inline">Hello</strong> and the current date and time using the R function <strong class="source-inline">Sys.time()</strong>. After this is done, we can then create a couple of jobs that will run <span class="No-Break">the script.</span></p>
			<p>Here is the <span class="No-Break"><strong class="source-inline">hello_world.R</strong></span><span class="No-Break"> script:</span></p>
			<pre class="source-code">
library("tcltk")
tkmessageBox(
  title='Message',
  message = paste0("Hello, it is: ", Sys.time()),
  type = "ok"
  )</pre>			<p>The first line of code, <strong class="source-inline">library("tcltk")</strong>, loads the <strong class="source-inline">tcltk</strong> package, which provides<a id="_idIndexMarker178"/> functions for creating and interacting with <strong class="bold">graphical user interfaces</strong> (<strong class="bold">GUIs</strong>) <span class="No-Break">in R.</span></p>
			<p>The second line of code, <strong class="source-inline">tkmessageBox()</strong>, creates a message box. The message box is a pop-up window that displays<a id="_idIndexMarker179"/> a message and allows the user to take some action, such as clicking <span class="No-Break">a button.</span></p>
			<p>The arguments to the <strong class="source-inline">tkmessageBox()</strong> function are <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="source-inline">title</strong>: The title of the <span class="No-Break">message box.</span></li>
				<li><strong class="source-inline">message</strong>: The message that will be displayed in the <span class="No-Break">message box.</span></li>
				<li><strong class="source-inline">type</strong>: The type of message box. The possible values are <strong class="source-inline">ok</strong>, <strong class="source-inline">okcancel</strong>, <strong class="source-inline">yesno</strong>, <strong class="source-inline">yesnocancel</strong>, <strong class="source-inline">retrycancel</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">abortretryignore</strong></span><span class="No-Break">.</span></li>
			</ul>
			<p>In this case, the type of message box is <strong class="source-inline">ok</strong>, which means that the user can only click an <strong class="source-inline">ok</strong> button to close the <span class="No-Break">message box.</span></p>
			<p>The third line of code, <strong class="source-inline">paste0("Hello, it is: ", Sys.time())</strong>, creates a string that will be displayed in the message box. The string includes the current time, which is obtained from the <span class="No-Break"><strong class="source-inline">Sys.time()</strong></span><span class="No-Break"> function.</span></p>
			<p>When this code is run, a message box will pop up that displays the current time and an <strong class="source-inline">ok</strong> button. The user can click the <strong class="bold">OK</strong> button to close the <span class="No-Break">message box.</span></p>
			<p>Here is a screenshot of what the message box will <span class="No-Break">look like:</span></p>
			<div>
				<div id="_idContainer033" class="IMG---Figure">
					<img src="image/B19142_04_1.jpg" alt="Figure 4.1 – Hello world message box"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.1 – Hello world message box</p>
			<p>Now, let’s make a couple of scripts that will pop this message up on a screen on schedule. Here is one that will run <span class="No-Break">this hourly:</span></p>
			<pre class="source-code">
taskscheduler_create(
  taskname = "Hello World Hourly",
  rscript = "hello_world.R",
  schedule = "HOURLY"
)</pre>			<p>The first line of code, <strong class="source-inline">taskscheduler_create()</strong>, calls the <strong class="source-inline">taskscheduler_create()</strong> function from the <strong class="source-inline">taskscheduleR</strong> package. The <strong class="source-inline">taskscheduleR</strong> package provides<a id="_idIndexMarker180"/> functions for creating and managing Windows task <span class="No-Break">scheduler jobs.</span></p>
			<p>The <strong class="source-inline">taskscheduler_create()</strong> function takes the following <span class="No-Break">three arguments:</span></p>
			<ul>
				<li>     <strong class="source-inline">taskname</strong>: The name of the task <span class="No-Break">scheduler job</span></li>
				<li>     <strong class="source-inline">rscript</strong>: The path to the R script that will be run by the task <span class="No-Break">scheduler job</span></li>
				<li>     <strong class="source-inline">schedule</strong>: The schedule for the task <span class="No-Break">scheduler job</span></li>
			</ul>
			<p>In this case, the task name is <strong class="source-inline">Hello World Hourly</strong>, the R script is <strong class="source-inline">hello_world.R</strong>, and the schedule <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">"HOURLY"</strong></span><span class="No-Break">.</span></p>
			<p>The second line of code, <strong class="source-inline">taskname = "Hello World Hourly"</strong>, sets the task name to <strong class="source-inline">Hello World Hourly</strong>. The task name is a unique identifier for the task <span class="No-Break">scheduler job.</span></p>
			<p>The third line of code, <strong class="source-inline">rscript = "hello_world.R"</strong>, sets the path to the R script that will be run by the task scheduler job. The R script must be saved in a location that is accessible by the <span class="No-Break">task scheduler.</span></p>
			<p>The fourth line of code, <strong class="source-inline">schedule = "HOURLY"</strong>, sets the schedule for the task scheduler job. The schedule is a string that specifies when the task scheduler job will run. The schedule <strong class="source-inline">"HOURLY"</strong> means that the task scheduler job will run every hour. When this code is run, a new task<a id="_idIndexMarker181"/> scheduler job will be created that runs the <strong class="source-inline">hello_world.R</strong> R script <span class="No-Break">every hour.</span></p>
			<p>Now, we will move on to using <strong class="source-inline">RDCOMClient</strong> for Outlook if you are not using Microsoft 365. This will allow us to script sending emails inside of <span class="No-Break">other processes.</span></p>
			<h1 id="_idParaDest-75"><a id="_idTextAnchor083"/>RDCOMClient for Outlook</h1>
			<p>As we have seen, <strong class="source-inline">RDCOMClient</strong> is a powerful R package<a id="_idIndexMarker182"/> that allows you to interact with Microsoft Outlook using the COM interface. With <strong class="source-inline">RDCOMClient</strong>, you can automate tasks in Outlook, such as sending emails, accessing folders, managing appointments, and more. Sending emails via Outlook using <strong class="source-inline">RDCOMClient</strong> is straightforward and can be achieved by following a few steps. Here is the script <span class="No-Break">for it:</span></p>
			<pre class="source-code">
install.packages("RDCOMClient")
library(RDCOMClient)
OutApp &lt;- COMCreate("Outlook.Application")
OutMail &lt;- OutApp$CreateItem(0)
outMail[["To"]] &lt;- "recipient@example.com"
outMail[["Subject"]] &lt;- "Hello from RDCOMClient"
outMail[["Body"]] &lt;- "This is the body of the email."
outMail$Attachments$Add("C:/path/to/attachment.txt")
outMail$Send()
outMail &lt;- NULL
OutApp &lt;- NULL</pre>			<p>Let us now understand<a id="_idIndexMarker183"/> each line of the <span class="No-Break">preceding code:</span></p>
			<ol>
				<li>First, you need to install and load the <strong class="source-inline">RDCOMClient</strong> package in your <span class="No-Break">R environment.</span></li>
				<li>Once installed, load the package using the <span class="No-Break"><strong class="source-inline">library()</strong></span><span class="No-Break"> function.</span></li>
				<li>Next, create a new Outlook application object using the <span class="No-Break"><strong class="source-inline">COMCreate()</strong></span><span class="No-Break"> function.</span></li>
				<li>This creates a connection to the Outlook application. Now, you can create a new email object using the <strong class="source-inline">OutApp$CreateItem()</strong> method and specify the email type <span class="No-Break">as </span><span class="No-Break"><strong class="source-inline">olMailItem</strong></span><span class="No-Break">.</span></li>
				<li>Next, you can set various properties of the email, such as the recipient, subject, body, attachments, and more. Here’s an example of how you can set <span class="No-Break">these properties:</span><pre class="source-code">
outMail[["To"]] &lt;- "recipient@example.com"
outMail[["Subject"]] &lt;- "Hello from RDCOMClient"
outMail[["Body"]] &lt;- "This is the body of the email."
outMail$Attachments$Add("C:/path/to/attachment.txt")</pre></li>				<li>After setting the desired properties, you can send the email using the <strong class="source-inline">Send()</strong> method, and <span class="No-Break">that’s it!</span><p class="list-inset">The email will be sent from your Outlook account to the specified recipient(s) with the configured properties. Remember to release the COM object and terminate the connection once you <span class="No-Break">are done.</span></p><p class="list-inset">This ensures that the resources are <span class="No-Break">properly released.</span></p></li>
			</ol>
			<p>By using <strong class="source-inline">RDCOMClient</strong>, you can automate email-sending tasks in Outlook directly from R, enabling you to streamline your workflow and save time. It provides a convenient way to integrate R with Outlook and leverage its <span class="No-Break">features programmatically.</span></p>
			<p>Now, we will delve into the <strong class="source-inline">Microsoft365R</strong> and <strong class="source-inline">blastula</strong> packages, which work in tandem. This will be instead<a id="_idIndexMarker184"/> of using the <strong class="source-inline">RDCOMClient</strong> library, with the reason being that Microsoft365R works for those that are using Microsoft Azure instead of a generic SMTP connection <span class="No-Break">via Outlook.</span></p>
			<h1 id="_idParaDest-76"><a id="_idTextAnchor084"/>Using the Microsoft365R and blastula packages</h1>
			<p>We are now going to go over two packages that can be used in conjunction with each other to create emails via Outlook from Microsoft. These packages are Microsoft365R and blastula. Let’s look at them in the <span class="No-Break">following sections.</span></p>
			<h2 id="_idParaDest-77"><a id="_idTextAnchor085"/>Microsoft365R</h2>
			<p><strong class="bold">Microsoft365R</strong> is an R library that provides<a id="_idIndexMarker185"/> an interface to Microsoft 365 (formerly known as Office 365) cloud services. It is built<a id="_idIndexMarker186"/> on top of the AzureGraph package, which provides a high-level abstraction for interacting with the Microsoft Graph API. Microsoft365R currently supports the following Microsoft <span class="No-Break">365 services:</span></p>
			<ul>
				<li>     <span class="No-Break">Teams</span></li>
				<li>     <span class="No-Break">Outlook</span></li>
				<li>     <span class="No-Break">SharePoint Online</span></li>
				<li>     <span class="No-Break">OneDrive</span></li>
			</ul>
			<p>The library provides several top-level client functions for accessing each of these services. For example, the <strong class="source-inline">get_personal_onedrive()</strong> function can be used to access your personal OneDrive account, and the <strong class="source-inline">get_business_outlook()</strong> function can be used to access your work or school <span class="No-Break">Outlook account.</span></p>
			<p>Microsoft365R also provides several helper functions for working with the Microsoft Graph API. For example, the <strong class="source-inline">list_drive_contents()</strong> function can be used to list the contents of a OneDrive drive, and the <strong class="source-inline">send_email()</strong> function can be used to send an email <span class="No-Break">from Outlook.</span></p>
			<p>The library is well-documented and provides several examples to help you get started. It is also actively maintained and updated with new features and bug fixes on a <span class="No-Break">regular basis.</span></p>
			<p>Here are some of the benefits<a id="_idIndexMarker187"/> of <span class="No-Break">using Microsoft365R:</span></p>
			<ul>
				<li>It provides a simple and easy-to-use interface for accessing Microsoft 365 <span class="No-Break">cloud services</span></li>
				<li>It is built on top of the <strong class="source-inline">AzureGraph</strong> package, which provides a high-level abstraction for interacting with the Microsoft <span class="No-Break">Graph API</span></li>
			</ul>
			<p>If you are looking for an R library<a id="_idIndexMarker188"/> that provides an easy way to access Microsoft 365 cloud services, then Microsoft365R is a great option. It is well-documented in the package vignettes, actively maintained, and supports a wide range of Microsoft 365 services. We will only be focusing on its use <span class="No-Break">for Outlook.</span></p>
			<h2 id="_idParaDest-78"><a id="_idTextAnchor086"/>The blastula package</h2>
			<p>The <strong class="source-inline">blastula</strong> R package is a tool<a id="_idIndexMarker189"/> that makes it easy to produce and send HTML email from R. You can use Markdown text, block-based components, and even HTML fragments to create email messages with three content areas: a body, header, and a footer. The package also provides functions to set up <strong class="bold">simple mail transfer protocol</strong> (<strong class="bold">SMTP</strong>) access credentials and send email<a id="_idIndexMarker190"/> through an SMTP server or RStudio Connect. You can install the blastula package from CRAN <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">install.packages("blastula")</strong></span><span class="No-Break">.</span></p>
			<p>Some of the advantages<a id="_idIndexMarker191"/> of using blastula over other email packages are <span class="No-Break">as follows:</span></p>
			<ul>
				<li>It allows you to use Markdown text, block-based components, and even HTML in order to create professional and potentially computed document emails. You can achieve this in the body, the header, and the footer of <span class="No-Break">the email.</span></li>
				<li>The package also provides functions to set up SMTP access credentials and send email through a traditional SMTP server, or, if you are a RStudio Connect user, you can send emails via <span class="No-Break">RStudio Connect.</span></li>
				<li>The resulting email will look great on <span class="No-Break">any display.</span></li>
				<li>The syntax is intuitive, allowing you to code quickly and effectively while making your primary focus the message of the <span class="No-Break">email itself.</span></li>
			</ul>
			<p>Here is an example of using <strong class="source-inline">blastula</strong> to create <a id="_idIndexMarker192"/>and send a simple HTML <span class="No-Break">email message:</span></p>
			<ol>
				<li>First, we need to load the <strong class="source-inline">blastula</strong> package with <strong class="source-inline">library(blastula)</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">library(glue)</strong></span><span class="No-Break">.</span></li>
				<li>Next, we can use the <strong class="source-inline">compose_email()</strong> function to create the email message. We can supply Markdown text to the body argument to be rendered in HTML; for example, see <span class="No-Break">the following:</span><pre class="source-code">
email &lt;- compose_email(
  body = md(glue(
"Hello, this is {sale_file} contains the latest quarters data. Here is a picture of the graph that will be on our dashboard:![sales dashboard] https://dashboard.company.com/)")
)</pre></li>				<li>Then, we can preview the email message in the viewer by calling the <span class="No-Break">email object:</span><pre class="source-code">
email</pre></li>				<li>Finally, we can send the email message through an SMTP server using the <strong class="source-inline">smtp_send()</strong> function. We need to provide the recipient’s email address, the sender’s email address, the subject line, and the credentials for the <span class="No-Break">SMTP server:</span><pre class="source-code">
email %&gt;%
  smtp_send(
     to = "jane_doe@example.com",
     from = "joe_public@example.net",
     subject = "Testing the `smtp_send()` function",
     credentials = creds_file("email_creds")
  )</pre><p class="list-inset">The <strong class="source-inline">creds_file()</strong> function is a helper function that creates a credentials file for <span class="No-Break">SMTP access.</span></p><p class="list-inset">We can use the <strong class="source-inline">create_smtp_creds_file()</strong> function to generate this <span class="No-Break">file interactively:</span></p><pre class="source-code">create_smtp_creds_file(
  file = "email_creds",
  user = "joe_public@example.net",
  provider = "gmail"
)</pre></li>			</ol>
			<p>This will prompt us to enter<a id="_idIndexMarker193"/> our password and a two-factor authentication code (if enabled) for Gmail. The credentials file will be saved in a secure location and can be reused for future <span class="No-Break">email messages.</span></p>
			<p>Now that we have gone over both packages separately, let’s see how we can use them together in a fashion that could be a bit more robust <span class="No-Break">and streamlined.</span></p>
			<p>Here is a full script, and then we will discuss how <span class="No-Break">it works:</span></p>
			<pre class="source-code">
install.packages("blastula")
install.packages("Microsoft365R")
library(blastula)
library(Microsoft365R)
# Get work/school email
outlb &lt;- get_business_outlook()
# compose an email with blastula
bl_body &lt;- "## Hello!
You can write email in **Markdown** with the blastula package."
bl_em &lt;- compose_email(
     body=md(bl_body),
     footer=md("sent via Microsoft365R and R")
)
em &lt;- outlb$create_email(bl_em, subject="Hello from R", to="email@example.com")
# add an attachment and send it
em$add_attachment("mydocument.docx")
em$send()</pre>			<p>Now, let’s go over each part of the script<a id="_idIndexMarker194"/> to understand what <span class="No-Break">is happening.</span></p>
			<ol>
				<li>First, we must install both the <strong class="source-inline">blastula</strong> and <span class="No-Break"><strong class="source-inline">Microsoft365R</strong></span><span class="No-Break"> packages.</span></li>
				<li>Then, we call those libraries into the current session using the <span class="No-Break"><strong class="source-inline">library()</strong></span><span class="No-Break"> function.</span></li>
				<li>We then create a variable called <strong class="source-inline">outlb</strong> that holds the variable for the <span class="No-Break"><strong class="source-inline">get_business_outlook()</strong></span><span class="No-Break"> function.</span></li>
				<li>We then create the body of the email. We can write the email using <span class="No-Break">Markdown syntax.</span></li>
				<li>After we make the body of the email, we then create a variable to hold the email itself that is created using the <span class="No-Break">function </span><span class="No-Break"><strong class="source-inline">compose_email()</strong></span><span class="No-Break">.</span></li>
				<li>From here, we then add the attachment and send <span class="No-Break">the email.</span></li>
			</ol>
			<p>The email is sent using the configured work/school email account retrieved earlier. So, in conclusion, these lines of code install the necessary packages, load the required libraries, retrieve the work/school email account, compose an email using the <strong class="source-inline">blastula</strong> package, add an attachment<a id="_idIndexMarker195"/> to the email, and finally, send the email using the <span class="No-Break"><strong class="source-inline">Microsoft365R</strong></span><span class="No-Break"> package.</span></p>
			<p>You have learned about scheduling and email integration in R. Now, let’s have a look at how the same can be achieved <span class="No-Break">in Python!</span></p>
			<h1 id="_idParaDest-79"><a id="_idTextAnchor087"/>Scheduling Python scripts</h1>
			<p>Automation is not limited<a id="_idIndexMarker196"/> to executing scripts manually; it also involves scheduling them to run at specific intervals or events. Scheduling Python scripts allows you to automate repetitive tasks, perform periodic data updates, generate reports, and carry out system maintenance without <span class="No-Break">manual intervention.</span></p>
			<p>In this section, we will explore various techniques and tools to schedule Python scripts and achieve efficient and <span class="No-Break">timely execution.</span></p>
			<p>By the end of this section, you will have a comprehensive understanding of various scheduling techniques and tools available for Python scripts. You will be equipped with the knowledge and skills to schedule your Python scripts effectively, automate routine tasks, and maximize your productivity. Whether you are running scripts on Windows or Unix-like systems, this chapter will empower you to implement reliable and efficient Python script <span class="No-Break">scheduling solutions.</span></p>
			<h2 id="_idParaDest-80"><a id="_idTextAnchor088"/>Introduction to Python script scheduling</h2>
			<p>We will start by discussing<a id="_idIndexMarker197"/> the importance of scheduling Python scripts and its benefits in streamlining workflows. You will learn why scheduling is crucial for automating tasks and how it can save time and effort. We will also highlight real-world scenarios where Python script scheduling is <span class="No-Break">commonly applied.</span></p>
			<p>Scheduling Python scripts plays a vital role in automating tasks and improving workflow efficiency. By scheduling scripts to run at specific intervals or events, you can eliminate the need for manual execution and ensure timely and accurate data processing, report generation, and <span class="No-Break">system maintenance.</span></p>
			<p>In this section, we will explore the importance of Python script scheduling and highlight its benefits in the various<a id="_idIndexMarker198"/> domains listed <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="bold">Automating repetitive tasks</strong>: Many tasks in data processing, analysis, and reporting involve repetitive actions. Scheduling Python scripts allows you to automate these tasks, reducing the time and effort required for manual execution. Whether it’s fetching data from external sources, performing calculations, generating reports, or updating databases, scheduling scripts ensures consistent and <span class="No-Break">reliable automation.</span></li>
				<li><strong class="bold">Periodic data updates</strong>: In many applications, data need to be regularly updated from external sources or refreshed from internal systems. Python script scheduling enables you to define a schedule for fetching, transforming, and updating data automatically. By specifying the desired frequency, you can ensure that your data remain up to date without <span class="No-Break">manual intervention.</span></li>
				<li><strong class="bold">Generating reports</strong>: Reports are often generated periodically, such as daily, weekly, or monthly. With Python script scheduling, you can automate the generation of reports by scheduling the script to run at specific intervals. This ensures that the reports are produced consistently and delivered on time, saving valuable time <span class="No-Break">and effort.</span></li>
				<li><strong class="bold">System maintenance</strong>: Python script scheduling is not limited to data-related tasks; it can also be used for system maintenance activities. From performing backups and database maintenance to running system checks and executing routine cleanup tasks, scheduling Python scripts enables you to keep your systems running smoothly without <span class="No-Break">manual intervention.</span></li>
				<li><strong class="bold">Real-world scenarios</strong>: Python script scheduling finds application in various industries and domains. For example, in ecommerce, scripts can be scheduled to update product inventory, synchronize prices, and generate sales reports. In finance, scheduled scripts can fetch stock market data, calculate portfolio performance, and generate financial statements. In IT operations, scripts can be scheduled for system monitoring, log analysis, and automated incident response. These are just a few examples of how Python script scheduling can be leveraged to enhance productivity<a id="_idIndexMarker199"/> and efficiency across <span class="No-Break">different domains.</span></li>
			</ul>
			<p>By understanding the importance of Python script scheduling and its benefits, you can identify opportunities to automate tasks, streamline workflows, and improve <span class="No-Break">overall productivity.</span></p>
			<p>In the following sections, we will explore different methods and tools for scheduling Python scripts, providing you with the knowledge and techniques to implement effective and reliable <span class="No-Break">automation solutions.</span></p>
			<h2 id="_idParaDest-81"><a id="_idTextAnchor089"/>Built-in scheduling options</h2>
			<p>Python provides built-in scheduling<a id="_idIndexMarker200"/> options on both Windows and Unix-like systems without the need for external libraries. These options provide a convenient and lightweight way to schedule and execute your Python scripts at predefined intervals. In this section, we will explore the built-in scheduling options and discuss their features, usage, <span class="No-Break">and limitations.</span></p>
			<p>We will explore <strong class="bold">Windows Task Scheduler</strong> and <strong class="bold">crontab</strong> on Unix-like systems. You will learn how to set up scheduled tasks using these native scheduling tools, specify the frequency of execution, and configure various options to meet your <span class="No-Break">specific requirements.</span></p>
			<p>Here is a list of the built-in options and their <span class="No-Break">key features:</span></p>
			<h3>cron (Unix-like systems)</h3>
			<p>The following <a id="_idIndexMarker201"/>are the key features<a id="_idIndexMarker202"/> <span class="No-Break">of cron:</span></p>
			<ul>
				<li>cron is a time-based job scheduler available on Unix-like operating systems, including Linux <span class="No-Break">and macOS</span></li>
				<li>It allows you to schedule recurring tasks by specifying the time, date, and frequency using a <span class="No-Break">cron expression</span></li>
				<li>cron provides flexibility in defining schedules, such as running scripts at specific times, on specific days of the week, or at <span class="No-Break">regular intervals</span></li>
				<li>It is widely supported and has been the de facto standard for scheduling tasks on Unix-like systems for <span class="No-Break">many years</span></li>
				<li>While cron is not a Python-specific<a id="_idIndexMarker203"/> tool, you can use it to schedule<a id="_idIndexMarker204"/> the execution of Python scripts by specifying the appropriate command <span class="No-Break">line invocation</span></li>
			</ul>
			<h3>Windows Task Scheduler (Windows systems)</h3>
			<p>The following points <a id="_idIndexMarker205"/>list the features<a id="_idIndexMarker206"/> of <span class="No-Break">Windows systems:</span></p>
			<ul>
				<li>Windows Task Scheduler is the built-in task scheduling tool provided by the Windows <span class="No-Break">operating system</span></li>
				<li>It allows you to schedule tasks to run at specific times or events on <span class="No-Break">Windows machines</span></li>
				<li>You can create scheduled tasks through the graphical user interface or using the command line <span class="No-Break">tool </span><span class="No-Break"><strong class="source-inline">schtasks</strong></span></li>
				<li>Windows Task Scheduler provides a range of options for defining triggers, such as specific times, daily, weekly, or monthly schedules, or even based on <span class="No-Break">system events</span></li>
				<li>It offers a user-friendly interface for managing scheduled tasks, including setting up dependencies, priority settings, and <span class="No-Break">error handling</span></li>
			</ul>
			<h3>Python’s time.sleep() function</h3>
			<p>This is a list of the key<a id="_idIndexMarker207"/> features<a id="_idIndexMarker208"/> of the <span class="No-Break"><strong class="source-inline">time.sleep()</strong></span><span class="No-Break"> function:</span></p>
			<ul>
				<li>While not specifically designed for scheduling tasks, Python’s built-in <strong class="source-inline">time</strong> module provides a simple way to introduce delays between <span class="No-Break">script executions</span></li>
				<li>The <strong class="source-inline">time.sleep()</strong> function pauses the script for a specified number of seconds, allowing you to control the timing between <span class="No-Break">script runs</span></li>
				<li>While this option lacks the sophistication and advanced features of dedicated scheduling tools, it can be useful for simple cases where a fixed delay <span class="No-Break">is sufficient</span></li>
				<li>However, keep in mind that using <strong class="source-inline">time.sleep()</strong> as a scheduling mechanism may not be suitable<a id="_idIndexMarker209"/> for precise or complex<a id="_idIndexMarker210"/> <span class="No-Break">scheduling requirements</span></li>
			</ul>
			<p>It’s important to note that these built-in scheduling options have their strengths and limitations. They are suitable for many use cases but may not provide the advanced features and flexibility required for complex scheduling scenarios. In such cases, external libraries and tools can offer more <span class="No-Break">robust solutions.</span></p>
			<p>In the next section, we will explore some popular third-party libraries for scheduling Python scripts, providing additional features and <span class="No-Break">customization options.</span></p>
			<h2 id="_idParaDest-82"><a id="_idTextAnchor090"/>Third-party scheduling libraries</h2>
			<p>While Python’s built-in scheduling<a id="_idIndexMarker211"/> options can handle many common scheduling tasks, there are several third-party libraries available that provide more advanced features and customization options. These libraries offer greater flexibility and control over scheduling Python scripts, allowing you to handle complex scheduling scenarios <span class="No-Break">with ease.</span></p>
			<p>In this section, we will explore some popular third-party scheduling libraries and discuss their features and benefits. We will cover topics such as defining schedules using cron-like syntax, handling time zones, and managing <span class="No-Break">concurrent execution.</span></p>
			<h3>schedule</h3>
			<p>Here are the features<a id="_idIndexMarker212"/> and benefits<a id="_idIndexMarker213"/> of the <span class="No-Break"><strong class="source-inline">schedule</strong></span><span class="No-Break"> library:</span></p>
			<ul>
				<li>The <strong class="source-inline">schedule</strong> library is a lightweight Python library that simplifies the process of <span class="No-Break">scheduling tasks</span></li>
				<li>It offers an intuitive and easy-to-use API for defining schedules using a <span class="No-Break">fluent interface</span></li>
				<li>The library supports various scheduling options, such as specific times, intervals, and <span class="No-Break">cron-like expressions</span></li>
				<li><strong class="source-inline">schedule</strong> allows you to execute functions, methods, or even shell commands at the <span class="No-Break">defined schedule</span></li>
				<li>It is designed to be simple and lightweight, making it suitable for smaller projects or cases where a minimalistic<a id="_idIndexMarker214"/> scheduling solution <span class="No-Break">is desired</span></li>
			</ul>
			<p>Here is an easy-to-demonstrate<a id="_idIndexMarker215"/> usage of <strong class="source-inline">schedule</strong> <span class="No-Break">in </span><span class="No-Break"><a id="_idIndexMarker216"/></span><span class="No-Break">Python:</span></p>
			<pre class="source-code">
import schedule
import time
def job():
    print("This job is executed every day at 8:00 AM.")
# Schedule the job to run every day at 8:00 AM
schedule.every().day.at("08:00").do(job)
# Keep the program running
while True:
    schedule.run_pending()
    time.sleep(1)</pre>			<p>In this example, we import the <strong class="source-inline">schedule</strong> library and define a function called <strong class="source-inline">job()</strong>, which prints a message. We then use the <strong class="source-inline">schedule.every().day.at(08:00).do(job)</strong> syntax to schedule the <strong class="source-inline">job</strong> function to run every day at 8:00 am. Finally, we use a <strong class="source-inline">while</strong> loop to continuously check for pending scheduled jobs and execute them. Note that this solution means the console is <strong class="source-inline">blocked</strong>, meaning the Python process running this infinite loop will not be available for other tasks. To stop the scheduler, simply interrupt the kernel/console or kill the underlying <span class="No-Break">Python process.</span></p>
			<p>You can customize the scheduling behavior by using different methods provided by the <strong class="source-inline">schedule</strong> library, such as <strong class="source-inline">.every().day.at()</strong>, <strong class="source-inline">.every().monday</strong>, <strong class="source-inline">.every().hour</strong>, and more. Additionally, you can schedule jobs to run at specific intervals or combine multiple<a id="_idIndexMarker217"/> scheduling patterns<a id="_idIndexMarker218"/> as per <span class="No-Break">your requirements.</span></p>
			<p>Let’s have a look at <span class="No-Break"><strong class="source-inline">APScheduler</strong></span><span class="No-Break"> next.</span></p>
			<h3>Advanced Python Scheduler (APScheduler)</h3>
			<p>Here are the features<a id="_idIndexMarker219"/> and benefits<a id="_idIndexMarker220"/> <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">APScheduler</strong></span><span class="No-Break">:</span></p>
			<ul>
				<li><strong class="bold">Advanced Python Scheduler</strong> (<strong class="bold">APScheduler</strong>) is another popular choice for scheduling tasks <span class="No-Break">in Python</span></li>
				<li>It provides a rich set of features, including various trigger types, such as intervals, cron expressions, and <span class="No-Break">date-based triggers</span></li>
				<li>APScheduler supports multiple job stores, including in-memory, SQL databases, <span class="No-Break">and Redis</span></li>
				<li>It offers advanced scheduling options, such as job coalescing, distributed scheduling, and time <span class="No-Break">zone support</span></li>
				<li>APScheduler has a well-documented API and is widely used in various applications, ranging from simple scripts to complex <span class="No-Break">web applications</span></li>
			</ul>
			<p>Here’s a sample code snippet demonstrating<a id="_idIndexMarker221"/> how to schedule tasks using the <span class="No-Break"><strong class="source-inline">APScheduler</strong></span><span class="No-Break"> library:</span></p>
			<pre class="source-code">
from apscheduler.schedulers.blocking import BlockingScheduler
# Create a scheduler instance
scheduler = BlockingScheduler()
# Define a task function
def send_email():
     # Code to send an email
     print("Email sent!")
# Schedule the task to run every hour
scheduler.add_job(send_email, 'interval', hours=1)
# Start the scheduler
scheduler.start()</pre>			<p>From the preceding<a id="_idIndexMarker222"/> example, we understand <span class="No-Break">the following:</span></p>
			<ol>
				<li>We first import the <strong class="source-inline">BlockingScheduler</strong> class from the <strong class="source-inline">apscheduler.schedulers.blocking</strong> module. Then, we create an instance of the scheduler <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">BlockingScheduler()</strong></span><span class="No-Break">.</span></li>
				<li>Next, we define a function called <strong class="source-inline">send_email()</strong>, which represents the task of sending an email. Inside this function, you can write the code to send an email or perform any other <span class="No-Break">desired action.</span></li>
				<li>To schedule the task, we use the <strong class="source-inline">add_job()</strong> method of the scheduler. In this case, we specify the <strong class="source-inline">send_email</strong> function as the task to be executed. We also provide the scheduling parameters using the <strong class="source-inline">interval</strong> option, which indicates that the task should be executed at regular intervals. In this example, we set it to run every <span class="No-Break">hour (</span><span class="No-Break"><strong class="source-inline">hours=1</strong></span><span class="No-Break">).</span></li>
				<li>Finally, we start the scheduler by calling the <strong class="source-inline">start()</strong> method. This will initiate the scheduler and begin executing the tasks according to the <span class="No-Break">defined schedule.</span></li>
			</ol>
			<p>The <strong class="source-inline">APScheduler</strong> library provides various scheduling options, such as fixed intervals, cron expressions, date/time triggers, and more. You can customize the scheduling behavior according to your specific requirements by exploring the documentation and using the appropriate scheduling<a id="_idIndexMarker223"/> options provided<a id="_idIndexMarker224"/> <span class="No-Break">by APScheduler.</span></p>
			<p>Next up, let’s have a look at the Celery package for <span class="No-Break">completeness’ sake.</span></p>
			<h3>Celery</h3>
			<p>The following are the<a id="_idIndexMarker225"/> features and benefits<a id="_idIndexMarker226"/> <span class="No-Break">of Celery:</span></p>
			<ul>
				<li>Celery is a distributed task queue library that can be used for both task execution <span class="No-Break">and scheduling</span></li>
				<li>It provides a robust and scalable solution for scheduling Python tasks across multiple workers <span class="No-Break">or machines</span></li>
				<li>Celery supports various scheduling options, including intervals, crontab-like expressions, <span class="No-Break">and more</span></li>
				<li>It offers advanced features such as task prioritization, result tracking, retries, and <span class="No-Break">task chaining</span></li>
				<li>Celery integrates<a id="_idIndexMarker227"/> well with message<a id="_idIndexMarker228"/> brokers such as <strong class="bold">RabbitMQ</strong>, <strong class="bold">Redis</strong>, or <strong class="bold">Apache Kafka</strong>, providing reliable and scalable<a id="_idIndexMarker229"/> <span class="No-Break">task-scheduling capabilities</span></li>
			</ul>
			<p>By using the Celery scheduler, you can automate the execution of tasks based on specific schedules, allowing you to perform recurring or time-based operations in your application. Configuring and deploying Celery apps is beyond the scope of this book, though, so it only stands here for completeness’ sake. You can consult the official documentation<a id="_idIndexMarker230"/> if you wish to delve <span class="No-Break">deeper: </span><a href="https://docs.celeryq.dev/en/stable/userguide/periodic-tasks.html"><span class="No-Break">https://docs.celeryq.dev/en/stable/userguide/periodic-tasks.html</span></a><span class="No-Break">.</span></p>
			<p>These third-party scheduling libraries provide powerful and flexible solutions for scheduling Python scripts. Depending on your specific requirements and the complexity of your scheduling tasks, you can choose the library that best fits your needs. Each library has its own strengths<a id="_idIndexMarker231"/> and capabilities, so it’s important to evaluate them based on your <span class="No-Break">project’s requirements.</span></p>
			<p>In the next section, we will explore practical examples of using these libraries to schedule Python scripts for various <span class="No-Break">use cases.</span></p>
			<h2 id="_idParaDest-83"><a id="_idTextAnchor091"/>Best practices and considerations for robust automation</h2>
			<p>When working with scheduling Python scripts, it’s essential to follow best practices and consider various factors to ensure efficient and reliable automation. This section provides insights into the best<a id="_idIndexMarker232"/> practices and considerations for scheduling Python <span class="No-Break">scripts effectively.</span></p>
			<p>These best practices will help you create robust and maintainable scheduled tasks. Let’s discuss these best practices in the <span class="No-Break">following sections.</span></p>
			<h3>Error handling and logging</h3>
			<p>Here are the<a id="_idIndexMarker233"/> best practices<a id="_idIndexMarker234"/> for error handling <span class="No-Break">and logging:</span></p>
			<ul>
				<li>Implement robust error-handling mechanisms to handle any unexpected exceptions and errors that may occur during <span class="No-Break">script execution</span></li>
				<li>Use logging frameworks to capture detailed information about script execution, including errors, warnings, and <span class="No-Break">information messages</span></li>
				<li>Proper error handling and logging allow you to diagnose issues, track script performance, and ensure that scheduled tasks are executed <span class="No-Break">as expected</span></li>
			</ul>
			<h3>Resource management</h3>
			<p>Here are the best practices<a id="_idIndexMarker235"/> for <span class="No-Break">resource management:</span></p>
			<ul>
				<li>Consider the resources required by your scheduled Python scripts, such as CPU, memory, and <span class="No-Break">disk space</span></li>
				<li>Optimize resource usage by identifying and minimizing any resource-intensive operations <span class="No-Break">or bottlenecks</span></li>
				<li>Ensure that your scripts release<a id="_idIndexMarker236"/> resources properly to avoid resource leaks <span class="No-Break">or conflicts</span></li>
			</ul>
			<h3>Security considerations</h3>
			<p>Here are the best practices <a id="_idIndexMarker237"/>for <span class="No-Break">security considerations:</span></p>
			<ul>
				<li>Evaluate the security implications of scheduling Python scripts, especially if they involve sensitive data or interact with <span class="No-Break">external systems</span></li>
				<li>Implement necessary security measures, such as encrypting credentials, securing API endpoints, and adhering to authentication and <span class="No-Break">authorization protocols</span></li>
				<li>Regularly review and update security measures to mitigate potential risks <span class="No-Break">and vulnerabilities</span></li>
			</ul>
			<h3>Testing and validation</h3>
			<p>Here are the<a id="_idIndexMarker238"/> best practices <a id="_idIndexMarker239"/>for testing <span class="No-Break">and validation:</span></p>
			<ul>
				<li>Thoroughly test and validate your scheduled Python scripts to ensure their correctness <span class="No-Break">and reliability</span></li>
				<li>Perform unit testing, integration testing, and end-to-end testing to verify that your scripts function as expected and handle <span class="No-Break">various scenarios</span></li>
				<li>Consider creating<a id="_idIndexMarker240"/> a staging environment<a id="_idIndexMarker241"/> where you can test scheduled tasks before deploying them to a <span class="No-Break">production environment</span></li>
			</ul>
			<h3>Monitoring and alerting</h3>
			<p>Here are the<a id="_idIndexMarker242"/> best practices<a id="_idIndexMarker243"/> for monitoring <span class="No-Break">and alerting:</span></p>
			<ul>
				<li>Establish monitoring and alerting mechanisms to track the execution status of <span class="No-Break">scheduled tasks</span></li>
				<li>Monitor the performance and health of your scheduling system, including script execution times, resource usage, and any potential errors <span class="No-Break">or failures</span></li>
				<li>Configure alerts to notify you when tasks fail, enabling prompt intervention <span class="No-Break">and troubleshooting</span></li>
			</ul>
			<h3>Documentation and maintenance</h3>
			<p>Here are the<a id="_idIndexMarker244"/> best practices <a id="_idIndexMarker245"/>for documentation <span class="No-Break">and maintenance:</span></p>
			<ul>
				<li>Document the scheduling process, including the configuration, dependencies, and any specific instructions for managing <span class="No-Break">scheduled tasks</span></li>
				<li>Maintain an up-to-date schedule of your scheduled Python scripts, including the frequency and expected outcomes of <span class="No-Break">each task</span></li>
				<li>Regularly review and update your scheduling setup, scripts, and dependencies to adapt to changing requirements <span class="No-Break">and technologies</span></li>
			</ul>
			<p>By following these best practices and considering the relevant factors, you can ensure the reliability, efficiency, and security of your scheduled Python scripts. Incorporating these considerations into your scheduling workflow will contribute to the smooth execution of tasks and help you maintain a well-structured and sustainable <span class="No-Break">automation system.</span></p>
			<p>In the next section, we will explore practical examples and use cases that illustrate the application of these best practices and considerations in <span class="No-Break">real-world scenarios.</span></p>
			<p>By completing this section<a id="_idIndexMarker246"/> on scheduling Python scripts, you have gained valuable knowledge and skills in automating and managing the execution of your scripts. Let’s summarize what you <span class="No-Break">have learned:</span></p>
			<ul>
				<li>You explored the various built-in scheduling options available in different operating systems, such as cron jobs on Unix-like systems and Task Scheduler on Windows, enabling you to schedule Python scripts at specific times <span class="No-Break">or intervals</span></li>
				<li>You discovered third-party scheduling libraries, such as <strong class="source-inline">APScheduler</strong> and <strong class="source-inline">Schedule</strong>, which provide more advanced scheduling capabilities, such as cron-like expressions and <span class="No-Break">interval-based scheduling</span></li>
				<li>You understood the best practices for scheduling Python scripts, including error handling, resource management, security considerations, testing, validation, monitoring, and alerting, as well as documentation <span class="No-Break">and maintenance</span></li>
				<li>Through practical examples and use cases, you gained hands-on experience in implementing and managing scheduled Python scripts, ensuring the efficient and reliable automation of <span class="No-Break">your tasks</span></li>
			</ul>
			<p>By mastering the concepts<a id="_idIndexMarker247"/> and techniques covered in this section, you are now equipped to schedule Python scripts effectively, automate repetitive tasks, and streamline your workflow. The ability to schedule scripts opens a world of possibilities for automating various processes, increasing productivity, and freeing up valuable time for more <span class="No-Break">critical tasks.</span></p>
			<p>In the next section, we will delve into the exciting realm of email notifications and explore how you can enhance your automation workflows by integrating email functionality into your <span class="No-Break">Python scripts.</span></p>
			<h1 id="_idParaDest-84"><a id="_idTextAnchor092"/>Email notifications and automation with Python</h1>
			<p>Much like scheduling Python scripts, email notifications and automation can make your daily work much more efficient. This section will cover the basics, such as the motivation behind using emails from Python, moving on to setting up the environment and sending basic emails, and then covering a real-life use case: sending email notifications for <span class="No-Break">script status.</span></p>
			<h2 id="_idParaDest-85"><a id="_idTextAnchor093"/>Introduction to email notifications in Python</h2>
			<p>Email notifications<a id="_idIndexMarker248"/> play a crucial<a id="_idIndexMarker249"/> role in automation by providing timely updates, alerts, and reports. In this section, we will explore the significance of integrating email functionality into your Python scripts. We’ll discuss various use cases where email notifications can be beneficial, and we’ll delve into the advantages they offer for streamlining workflows and <span class="No-Break">enhancing communication.</span></p>
			<p>Let’s start with the most basic considerations: why would you <span class="No-Break">do this?</span></p>
			<h3>Use cases and benefits of integrating email functionality into your scripts</h3>
			<p>Email notifications are versatile and can be applied to a wide range of scenarios. Some common use cases<a id="_idIndexMarker250"/> include <span class="No-Break">the following:</span></p>
			<ul>
				<li><strong class="bold">Task completion notifications</strong>: These send notifications to indicate the successful completion of a task or process, helping to keep stakeholders informed and reassuring them that everything is <span class="No-Break">running smoothly.</span></li>
				<li><strong class="bold">Error and exception reporting</strong>: This involves alerting relevant team members or administrators when errors or exceptions occur during script execution, allowing for prompt troubleshooting and <span class="No-Break">issue resolution.</span></li>
				<li><strong class="bold">Progress updates</strong>: This provides periodic progress updates to stakeholders or clients, ensuring transparency and maintaining open lines <span class="No-Break">of communication.</span></li>
				<li><strong class="bold">Data analysis reports</strong>: These automate the generation and delivery of data analysis reports via email, saving time and effort by eliminating the need for manual report creation <span class="No-Break">and distribution.</span></li>
				<li><strong class="bold">System monitoring</strong>: This involves setting up email notifications to monitor system status, such as server uptime, disk space usage, or application performance. Immediate<a id="_idIndexMarker251"/> alerts can help address potential issues before they <span class="No-Break">impact operations.</span></li>
			</ul>
			<p>By incorporating email notifications into your Python scripts, you can benefit from <span class="No-Break">the following:</span></p>
			<ul>
				<li><strong class="bold">Realtime updates</strong>: Stay informed about<a id="_idIndexMarker252"/> the progress, status, and results of <span class="No-Break">automated tasks</span></li>
				<li><strong class="bold">Enhanced collaboration</strong>: Facilitate communication and collaboration among team members by providing <span class="No-Break">timely notifications</span></li>
				<li><strong class="bold">Error detection and resolution</strong>: Receive alerts about errors or exceptions in your scripts, enabling you to identify and resolve <span class="No-Break">issues quickly</span></li>
				<li><strong class="bold">Customization and personalization</strong>: Tailor email notifications to suit your specific requirements, including content, formatting, <span class="No-Break">and recipients</span></li>
				<li><strong class="bold">Streamlined workflows</strong>: Automate the delivery of reports, updates, and alerts, saving time and effort in <span class="No-Break">manual distribution</span></li>
			</ul>
			<p>Throughout this section, we will explore the various aspects of email notifications in Python, empowering you to leverage this powerful communication tool within your <span class="No-Break">automation workflows.</span></p>
			<p>Let’s dive in and explore how to set up and use email <span class="No-Break">functionality effectively.</span></p>
			<h2 id="_idParaDest-86"><a id="_idTextAnchor094"/>Setting up email services</h2>
			<p>Before diving into sending<a id="_idIndexMarker253"/> email notifications from Python, it’s essential to set up the necessary email services to establish a connection between your script and the <span class="No-Break">email server.</span></p>
			<p>By the end of this section, you will have a clear understanding of how to set up email services for your Python scripts. You’ll be equipped with the necessary knowledge to choose the right email service provider, obtain the required SMTP server credentials, configure secure connections, and test the connection. With your email services in place, you’ll be ready to move on to the next steps of sending email notifications seamlessly from your <span class="No-Break">Python</span><span class="No-Break"><a id="_idIndexMarker254"/></span><span class="No-Break"> scripts.</span></p>
			<p>Let’s get started and set up your email <span class="No-Break">services effectively.</span></p>
			<p>In this section, we will cover the steps involved in configuring email services, including the <span class="No-Break">following aspects.</span></p>
			<h3>Choosing an email service provider</h3>
			<p>There are several email service providers<a id="_idIndexMarker255"/> available, each offering different features and options. In this section, we will be using Gmail as an example but the code can easily be adapted to other providers, such as Microsoft Exchange, <span class="No-Break">as well.</span></p>
			<h3>Obtaining SMTP server credentials</h3>
			<p>To send emails<a id="_idIndexMarker256"/> programmatically, it’s important<a id="_idIndexMarker257"/> to obtain the SMTP server credentials provided by your email service provider. These credentials are essential for establishing a connection with the email server and sending <span class="No-Break">emails securely.</span></p>
			<p>In this section, we’ll guide you through the process of acquiring the necessary information to configure your email <span class="No-Break">settings effectively.</span></p>
			<ul>
				<li><strong class="bold">SMTP server address</strong>: The SMTP server address is the hostname or IP address of the server responsible for sending outgoing emails. Your email service provider will provide you with this information, which typically follows a format such as <strong class="source-inline">smtp.example.com </strong>or <strong class="source-inline">mail.example.com</strong>. Make sure you verify the correct SMTP server address for your specific <span class="No-Break">email service.</span></li>
				<li><strong class="bold">Port number</strong>: The port number specifies the communication endpoint for the SMTP server. Common port numbers for SMTP communication include 25, 465 (for SSL/TLS encrypted connections), and 587 (for STARTTLS encrypted connections). Your email service provider will specify the appropriate port number to use for <span class="No-Break">sending emails.</span></li>
				<li><strong class="bold">Authentication details</strong>: To authenticate yourself with the SMTP server, you will need to provide a username and password. These credentials are used to establish a secure connection and ensure that only authorized users can send emails. Your email service provider will provide you with the necessary authentication details. In some cases, an API key or access token may be required for authentication instead of a traditional username <span class="No-Break">and password.</span></li>
			</ul>
			<p>It’s important to note that the process of obtaining SMTP server credentials may vary depending on your email service provider. Some providers offer specific instructions or account settings where you can find the required information. If you’re unsure about where to find your SMTP server credentials, it’s recommended that you consult the documentation or support resources provided by your email <span class="No-Break">service provider.</span></p>
			<p>By obtaining the SMTP server credentials, you’ll be equipped with the necessary information to establish a connection with the email server and send emails programmatically. This allows<a id="_idIndexMarker258"/> you to leverage the power of Python<a id="_idIndexMarker259"/> to automate email notifications, updates, and other communication tasks within your applications <span class="No-Break">or scripts.</span></p>
			<h3>Testing the connection</h3>
			<p>To ensure a successful <a id="_idIndexMarker260"/>setup, it’s important to test the connection between your Python script and the <span class="No-Break">email server.</span></p>
			<p>In the next section, we’ll demonstrate how to perform a connection test by sending a test email using the provided SMTP server credentials. This will help verify that the connection is established correctly and that your script can communicate with the <span class="No-Break">email server.</span></p>
			<h2 id="_idParaDest-87"><a id="_idTextAnchor095"/>Sending basic emails</h2>
			<p>Now that we have set up our email<a id="_idIndexMarker261"/> services, we can proceed to the next step: sending basic emails <span class="No-Break">from Python.</span></p>
			<p>By the end of this section, you will have a solid understanding of how to send basic emails from Python. You’ll know how to import the required libraries, create email messages, establish a connection with the email server, and send the email using the SMTP protocol. With this knowledge, you’ll be able to send simple text-based emails from your Python scripts<a id="_idIndexMarker262"/> and lay the foundation for more advanced <span class="No-Break">email notifications.</span></p>
			<p>In this section, we will explore the fundamental concepts and techniques for sending <span class="No-Break">emails programmatically.</span></p>
			<h3>Importing the required libraries</h3>
			<p>To send emails from Python, we need<a id="_idIndexMarker263"/> to import the necessary libraries that provide email-related functionality. Ahead, we’ll discuss popular libraries, such as <strong class="source-inline">smtplib</strong> and <strong class="source-inline">email.mime</strong>, which offer convenient features for creating and sending emails. We’ll guide you through the installation process and demonstrate<a id="_idIndexMarker264"/> how to import these libraries into your <span class="No-Break">Python script.</span></p>
			<h3>Creating the email message</h3>
			<p>Before sending an email, we need<a id="_idIndexMarker265"/> to construct the email message, which includes the sender, recipient, subject, and body of the email. We’ll show you how to create an email message using the <strong class="source-inline">email.mime</strong> library, allowing you to customize various aspects of the email, such as adding attachments or setting HTML content. We’ll provide code examples and explanations to help you understand the structure and components of an <span class="No-Break">email message.</span></p>
			<h3>Establishing the connection</h3>
			<p>To send an email, we need to establish<a id="_idIndexMarker266"/> a connection with the email server using the SMTP protocol. We’ll demonstrate how to establish a connection using the SMTP server credentials obtained earlier. We’ll guide you through the process of creating an SMTP object, setting up the connection, and handling any potential errors or exceptions that may arise during the establishment of <span class="No-Break">the connection.</span></p>
			<h3>Sending the email</h3>
			<p>Once the connection<a id="_idIndexMarker267"/> is established, we can proceed to send the email. We’ll demonstrate how to use the <strong class="source-inline">smtplib</strong> library to send an email message. We’ll cover the necessary steps, including authenticating with the email server, specifying the sender and recipient addresses, and invoking the <strong class="source-inline">sendmail()</strong> method. We’ll also discuss error handling and provide best practices for ensuring the successful delivery of <span class="No-Break">the email.</span></p>
			<p>The preceding sections are the steps that are implemented in the following <span class="No-Break">code sample:</span></p>
			<pre class="source-code">
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
# Define email server and credentials
smtp_server = 'your_smtp_server'
smtp_port = 587
smtp_username = 'your_username'
smtp_password = 'your_password'
# Create a MIME message
message = MIMEMultipart()
message['From'] = 'sender@example.com'
message['To'] = 'recipient@example.com'
message['Subject'] = 'Test Email'
# Add the email body
body = MIMEText('This is the email body.')
message.attach(body)
# Establish a connection with the email server
with smtplib.SMTP(smtp_server, smtp_port) as server:
    # Start the TLS encryption
    server.starttls()
    # Log in to the email server
    server.login(smtp_username, smtp_password)
    # Send the email
    server.send_message(message)</pre>			<p>From this code example, we can<a id="_idIndexMarker268"/> observe <span class="No-Break">the following:</span></p>
			<ol>
				<li>We first import the <strong class="source-inline">smtplib</strong> library to establish an SMTP connection and the <strong class="source-inline">MIMEText</strong> and <strong class="source-inline">MIMEMultipart</strong> classes from the <strong class="source-inline">email.mime</strong> module for creating the <span class="No-Break">email message.</span></li>
				<li>Next, we define the SMTP server details, including the server address, port, and the credentials (username and password) required <span class="No-Break">for authentication.</span></li>
				<li>We then create a <strong class="source-inline">MIMEMultipart</strong> object called message, which represents the email message. We set the sender and recipient addresses, as well as the subject of <span class="No-Break">the email.</span></li>
				<li>Then, we send the email using the <strong class="source-inline">send_message()</strong> method of the SMTP server object, passing the message as <span class="No-Break">an argument.</span></li>
				<li>Remember to replace the placeholder values (<strong class="source-inline">your_smtp_server</strong> and <strong class="source-inline">your_username</strong>). To add the email body, we create a <strong class="source-inline">MIMEText</strong> object called body and attach it to <span class="No-Break">the message.</span></li>
				<li>Afterward, we establish a connection with the email server using the <strong class="source-inline">smtplib.SMTP</strong> class, passing the server address and port as arguments. We start the TLS encryption using the <span class="No-Break"><strong class="source-inline">starttls()</strong></span><span class="No-Break"> method.</span></li>
				<li>Next, we log in to the email server using the <strong class="source-inline">login()</strong> method and provide the username <span class="No-Break">and password.</span></li>
			</ol>
			<p>Finally, use <strong class="source-inline">your_password</strong>, <strong class="source-inline">sender@example.com</strong>, and <strong class="source-inline">recipient@example.com</strong> with your actual SMTP server details and <span class="No-Break">email addresses.</span></p>
			<p>By following this code <a id="_idIndexMarker269"/>example, you’ll be able to send basic emails using the <strong class="source-inline">smtplib</strong> and <strong class="source-inline">email.mime</strong> libraries <span class="No-Break">in Python.</span></p>
			<h2 id="_idParaDest-88"><a id="_idTextAnchor096"/>Sending email notifications for script status</h2>
			<p>In this section, you’ll learn how<a id="_idIndexMarker270"/> to define triggers, implement<a id="_idIndexMarker271"/> email notification logic, customize email content, and handle email delivery and errors effectively. With these skills, you’ll be able to enhance the monitoring and reporting capabilities of your scripts and stay informed about the progress and outcomes of your <span class="No-Break">automated processes.</span></p>
			<p>By the end of this section, you will have a clear understanding of how to incorporate email notifications into your Python scripts to receive updates on script execution <span class="No-Break">and status.</span></p>
			<p>One of the key use cases for email notifications in Python is to receive updates on the status of your scripts or processes. In this section, we will delve into the process of sending email notifications to keep track of the execution and status of your scripts. By implementing this functionality, you can stay informed about the progress and outcomes of your automated processes and take the necessary actions <span class="No-Break">when needed.</span></p>
			<p>To begin, let’s explore the steps involved in sending email notifications for <span class="No-Break">script status.</span></p>
			<h3>Defining triggers</h3>
			<p>Before we can send email<a id="_idIndexMarker272"/> notifications, we need to define triggers that determine when the notifications should be sent. Triggers can be based on specific conditions or events that occur during script execution. For example, you may want to send an email notification when a script completes successfully, encounters an error, or reaches a specific milestone. By defining triggers, you have full control over when<a id="_idIndexMarker273"/> and under what circumstances email notifications <span class="No-Break">are sent.</span></p>
			<h3>Implementing email notification logic</h3>
			<p>Once the triggers are defined, we can<a id="_idIndexMarker274"/> proceed to implement the logic for sending email notifications. This involves incorporating the necessary code within your script to check the triggers and initiate the email-sending process. You will need to import the required libraries, establish a connection with the email server, and customize the email content. The logic should be designed to efficiently handle the sending <a id="_idIndexMarker275"/>of email notifications based on the <span class="No-Break">specified triggers.</span></p>
			<h3>Customizing email content</h3>
			<p>To provide relevant and informative<a id="_idIndexMarker276"/> content in your email notifications, you can customize various aspects of the email, such as the subject, body, and any additional details. The content can include information about the script’s execution status, error messages, relevant data or statistics, and any other details that are important for understanding the script’s progress. By customizing the email content, you can ensure that recipients have the necessary information to take appropriate actions or make <span class="No-Break">informed decisions.</span></p>
			<h3>Handling email delivery and errors</h3>
			<p>Sending emails involves interacting<a id="_idIndexMarker277"/> with email<a id="_idIndexMarker278"/> servers, and various factors can affect the successful delivery of emails. It’s important to handle potential issues such as network connectivity problems, email server errors, or recipient email address errors. By implementing error-handling mechanisms, you can gracefully handle email delivery issues and ensure that notifications are sent reliably. Additionally, logging and error reporting can be useful for troubleshooting and diagnosing any email-related problems that <span class="No-Break">may occur.</span></p>
			<p>In summary, by implementing email notifications for script status, you can stay informed about the progress and outcomes of your automated processes. You have the flexibility to define triggers, customize email content, and handle potential email delivery issues effectively. This functionality enhances the monitoring and reporting capabilities of your scripts and enables you to take timely actions based on the script’s status. With these techniques in place, you can confidently<a id="_idIndexMarker279"/> automate your processes while staying<a id="_idIndexMarker280"/> updated on <span class="No-Break">their execution.</span></p>
			<h1 id="_idParaDest-89"><a id="_idTextAnchor097"/>Summary</h1>
			<p>In the sections on scheduling and email notifications in Python, you have gained a comprehensive understanding of the key concepts. You have learned about different scheduling options for Python scripts, including built-in options and third-party libraries such as <strong class="source-inline">schedule</strong> and <strong class="source-inline">APScheduler</strong>. The chapter also emphasizes the importance of following best practices for email notifications, such as error handling, resource management, security considerations, testing, monitoring, documentation, <span class="No-Break">and maintenance.</span></p>
			<p>You can now recognize the value of email notifications in providing timely updates on the status and results of processes in automated systems. We have explored Python’s powerful libraries and modules, such as <strong class="source-inline">smtplib</strong> and <strong class="source-inline">email.mime</strong>, which enable the creation and customization of email messages. Additionally, you have acquired the knowledge required to set up email services by configuring SMTP servers, authentication credentials, and other relevant settings. We have also learned about packages in R, such as <strong class="source-inline">tasksheduleR</strong>, <strong class="source-inline">blastula</strong>, and <strong class="source-inline">Microsoft365R</strong>, that will perform these functions as well. They have a solid and simple syntax, which makes them very <span class="No-Break">powerful tools.</span></p>
			<p>With a solid understanding of the basics, you have learned how to construct simple email messages with the necessary headers and content to implement basic email functionality. You have also discovered the versatility of email notifications in providing updates on script execution, including success, failure, or specific events. Now that you are armed with these insights, readers are well-equipped to integrate email notifications effectively into their <span class="No-Break">Python projects.</span></p>
			<p>By completing this chapter, you should have gained a comprehensive understanding of scheduling Python scripts and email notifications in Python. You have learned when and how to use various scheduling tools, set up email services, and send basic emails. In the next chapter, we will learn how to format Excel with Python <span class="No-Break">and R.</span></p>
		</div>
	

		<div id="_idContainer035" class="Content">
			<h1 id="_idParaDest-90" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor098"/>Part 2: Making It Pretty – Formatting, Graphs, and More</h1>
		</div>
		<div id="_idContainer036">
			<p>In this part, we delve into enhancing the visual appeal and functionality of your Excel sheets. You will learn how to format your data elegantly using libraries such as <strong class="source-inline">styledTables</strong>, <strong class="source-inline">tablaxlsx</strong>, <strong class="source-inline">excelR</strong>, <strong class="source-inline">basictabler</strong>, and <strong class="source-inline">tidyxl</strong> in R and <strong class="source-inline">pandas</strong> and <strong class="source-inline">openpyxl</strong> in Python. You will discover techniques to seamlessly insert <strong class="source-inline">ggplot2</strong> and <strong class="source-inline">matplotlib</strong> graphs into your Excel sheets, bringing your data to life. Additionally, you will master the art of creating pivot tables using <strong class="source-inline">tidyquant</strong> in R and <strong class="source-inline">win32com</strong> and <strong class="source-inline">pypiwin32</strong> in Python, along with advanced summary table creation <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">{gt}</strong></span><span class="No-Break">.</span></p>
			<p>This part has the <span class="No-Break">following chapters:</span></p>
			<ul>
				<li><a href="B19142_05.xhtml#_idTextAnchor099"><em class="italic">Chapter 5</em></a>, <em class="italic">Formatting Your Excel Sheet</em></li>
				<li><a href="B19142_06.xhtml#_idTextAnchor119"><em class="italic">Chapter 6</em></a>, <em class="italic">Inserting ggplot2/matplotlib Graphs</em></li>
				<li><a href="B19142_07.xhtml#_idTextAnchor145"><em class="italic">Chapter 7</em></a>, <em class="italic">Pivot Tables and Summary Tables</em></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer037">
			</div>
		</div>
		<div>
			<div id="_idContainer038" class="Basic-Graphics-Frame">
			</div>
		</div>
	</body></html>