<html><head></head><body>
		<div><h1 id="_idParaDest-70" class="chapter-number"><a id="_idTextAnchor078"/>4</h1>
			<h1 id="_idParaDest-71"><a id="_idTextAnchor079"/>Automating Further – Task Scheduling and Email</h1>
			<p>Sometimes, we can spend countless hours tediously creating, formatting, and emailing Excel spreadsheets. Well, fret no more! With the power of programming, specifically R or Python, you can effortlessly automate these mundane tasks and reclaim your precious time.</p>
			<p>Imagine this: you have a list of sales data that needs to be organized into a professional-looking spreadsheet and sent to multiple recipients via email. Instead of slogging through manual data entry and formatting, you can leverage the prowess of R or Python to simplify your workflow.</p>
			<p>In R, you can use the amazing <code>taskscheduleR</code> package to schedule tasks and run your script automatically at specified times. With this, you can set up a recurring job to generate your Excel spreadsheets and send them out without lifting a finger. For emailing, you can employ the <code>RDCOMClient</code>, <code>Windows365R</code>, or <code>blastula</code> packages, which allow you to interact with Outlook and Gmail directly. This means you can compose and send emails with the attached spreadsheets effortlessly, customizing the content and recipients as needed.</p>
			<p>But wait, Python enthusiasts! Fear not, for you, too, can achieve the same level of automation magic. In Python, you can utilize the <code>pywin32</code> library to send out beautifully formatted emails via Gmail. It seamlessly integrates with your code, enabling you to attach your Excel spreadsheets and customize the email’s content and recipients with ease.</p>
			<p>By harnessing the power of R or Python, along with <code>taskscheduleR</code>, <code>RDCOMClient</code>, <code>Windows365R</code>, or <code>blastula</code>, you can become the hero of your office, delivering accurate, visually appealing spreadsheets promptly, all while sipping your coffee. Say goodbye to mind-numbing repetition and hello to efficient automation. Let your creativity flourish as you unlock the power of R or Python to conquer the world of Excel spreadsheets and email distribution with confidence and ease!</p>
			<p>In this chapter, we’re going to cover the following main topics:</p>
			<ul>
				<li>Installing and understanding the <code>taskscheduleR</code> library</li>
				<li>Using <code>RDCOMClient</code>, <code>Windows365R</code>, and <code>blastula</code> for email in Outlook or Gmail</li>
				<li>Scheduling Python scripts</li>
				<li>Email notifications and automation with Python</li>
			</ul>
			<h1 id="_idParaDest-72"><a id="_idTextAnchor080"/>Technical requirements</h1>
			<p>The code for this chapter can be found here: <a href="https://github.com/PacktPublishing/Extending-Excel-with-Python-and-R/tree/main/Chapter%204">https://github.com/PacktPublishing/Extending-Excel-with-Python-and-R/tree/main/Chapter%204</a>.</p>
			<p>You will need to install the following new R and Python packages:</p>
			<ul>
				<li><code>Blastula</code></li>
				<li><code>Windows365R</code></li>
				<li><code>schedule==1.2.0</code></li>
				<li><code>apscheduler==3.10.1</code></li>
			</ul>
			<h1 id="_idParaDest-73"><a id="_idTextAnchor081"/>Installing and understanding the tasksheduleR library</h1>
			<p>The <code>taskscheduleR</code> R package allows you <a id="_idIndexMarker174"/>to schedule R scripts or processes with the Windows task scheduler. This means that you can automate R processes on specific time points from within R itself. The package is basically a wrapper around the <code>Schtasks.exe</code> functionality. <code>Schtasks.exe</code> is a command line tool that allows you to create, delete, query, change, run, and finish scheduled tasks on a local or remote computer. To use <code>taskscheduleR</code>, you first need to install the package from CRAN. Once the package is installed, you can use the following functions<a id="_idIndexMarker175"/> to schedule R scripts:</p>
			<ul>
				<li><code>taskscheduler_create()</code>: This function creates a new scheduled task.</li>
				<li><code>taskscheduler_remove()</code>: This function removes an existing scheduled task. If you are using version 1.8, then the function is <code>taskscheduler_delete()</code>.</li>
				<li><code>taskscheduler_get()</code>: This function gets the information about an existing scheduled task.</li>
			</ul>
			<p>The <code>taskscheduler_create()</code> function takes a number of arguments, including the name of the scheduled task, the R script to run, and the schedule to run the script. For example, the following code would create a scheduled task that runs the R script <code>my_scheduled_excel_script.R</code> every day at 10:00 am:</p>
			<pre class="source-code">
taskscheduler_create(
  name = "My Scheduled Excel Task",
  rscript = "my_scheduled_excel_script.R",
  schedule = "DAILY",
  start_time = "10:00:00"
)`</pre>			<p>You can also use the GUI to create tasks for the job<a id="_idIndexMarker176"/> scheduler by installing <code>miniUI</code> and <code>shiny</code>. This will install the add-in capability of the package, allowing you to easily create jobs without writing a single line of code. Here is the code you can use if you want to install the preceding packages listed:</p>
			<pre class="source-code">
# The initial package itself
install.packages("taskscheduleR")
# To use the GUI
install.packages('miniUI')
install.packages('shiny')</pre>			<p>Now, we see how to create scripts for this.</p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor082"/>Creating sample scripts</h2>
			<p>The first thing we need<a id="_idIndexMarker177"/> to do is create a script that can be run via the Windows task scheduler. Let’s keep the script simple and just print <code>Hello</code> and the current date and time using the R function <code>Sys.time()</code>. After this is done, we can then create a couple of jobs that will run the script.</p>
			<p>Here is the <code>hello_world.R</code> script:</p>
			<pre class="source-code">
library("tcltk")
tkmessageBox(
  title='Message',
  message = paste0("Hello, it is: ", Sys.time()),
  type = "ok"
  )</pre>			<p>The first line of code, <code>library("tcltk")</code>, loads the <code>tcltk</code> package, which provides<a id="_idIndexMarker178"/> functions for creating and interacting with <strong class="bold">graphical user interfaces</strong> (<strong class="bold">GUIs</strong>) in R.</p>
			<p>The second line of code, <code>tkmessageBox()</code>, creates a message box. The message box is a pop-up window that displays<a id="_idIndexMarker179"/> a message and allows the user to take some action, such as clicking a button.</p>
			<p>The arguments to the <code>tkmessageBox()</code> function are as follows:</p>
			<ul>
				<li><code>title</code>: The title of the message box.</li>
				<li><code>message</code>: The message that will be displayed in the message box.</li>
				<li><code>type</code>: The type of message box. The possible values are <code>ok</code>, <code>okcancel</code>, <code>yesno</code>, <code>yesnocancel</code>, <code>retrycancel</code>, and <code>abortretryignore</code>.</li>
			</ul>
			<p>In this case, the type of message box is <code>ok</code>, which means that the user can only click an <code>ok</code> button to close the message box.</p>
			<p>The third line of code, <code>paste0("Hello, it is: ", Sys.time())</code>, creates a string that will be displayed in the message box. The string includes the current time, which is obtained from the <code>Sys.time()</code> function.</p>
			<p>When this code is run, a message box will pop up that displays the current time and an <code>ok</code> button. The user can click the <strong class="bold">OK</strong> button to close the message box.</p>
			<p>Here is a screenshot of what the message box will look like:</p>
			<div><div><img src="img/B19142_04_1.jpg" alt="Figure 4.1 – Hello world message box"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.1 – Hello world message box</p>
			<p>Now, let’s make a couple of scripts that will pop this message up on a screen on schedule. Here is one that will run this hourly:</p>
			<pre class="source-code">
taskscheduler_create(
  taskname = "Hello World Hourly",
  rscript = "hello_world.R",
  schedule = "HOURLY"
)</pre>			<p>The first line of code, <code>taskscheduler_create()</code>, calls the <code>taskscheduler_create()</code> function from the <code>taskscheduleR</code> package. The <code>taskscheduleR</code> package provides<a id="_idIndexMarker180"/> functions for creating and managing Windows task scheduler jobs.</p>
			<p>The <code>taskscheduler_create()</code> function takes the following three arguments:</p>
			<ul>
				<li>     <code>taskname</code>: The name of the task scheduler job</li>
				<li>     <code>rscript</code>: The path to the R script that will be run by the task scheduler job</li>
				<li>     <code>schedule</code>: The schedule for the task scheduler job</li>
			</ul>
			<p>In this case, the task name is <code>Hello World Hourly</code>, the R script is <code>hello_world.R</code>, and the schedule is <code>"HOURLY"</code>.</p>
			<p>The second line of code, <code>taskname = "Hello World Hourly"</code>, sets the task name to <code>Hello World Hourly</code>. The task name is a unique identifier for the task scheduler job.</p>
			<p>The third line of code, <code>rscript = "hello_world.R"</code>, sets the path to the R script that will be run by the task scheduler job. The R script must be saved in a location that is accessible by the task scheduler.</p>
			<p>The fourth line of code, <code>schedule = "HOURLY"</code>, sets the schedule for the task scheduler job. The schedule is a string that specifies when the task scheduler job will run. The schedule <code>"HOURLY"</code> means that the task scheduler job will run every hour. When this code is run, a new task<a id="_idIndexMarker181"/> scheduler job will be created that runs the <code>hello_world.R</code> R script every hour.</p>
			<p>Now, we will move on to using <code>RDCOMClient</code> for Outlook if you are not using Microsoft 365. This will allow us to script sending emails inside of other processes.</p>
			<h1 id="_idParaDest-75"><a id="_idTextAnchor083"/>RDCOMClient for Outlook</h1>
			<p>As we have seen, <code>RDCOMClient</code> is a powerful R package<a id="_idIndexMarker182"/> that allows you to interact with Microsoft Outlook using the COM interface. With <code>RDCOMClient</code>, you can automate tasks in Outlook, such as sending emails, accessing folders, managing appointments, and more. Sending emails via Outlook using <code>RDCOMClient</code> is straightforward and can be achieved by following a few steps. Here is the script for it:</p>
			<pre class="source-code">
install.packages("RDCOMClient")
library(RDCOMClient)
OutApp &lt;- COMCreate("Outlook.Application")
OutMail &lt;- OutApp$CreateItem(0)
outMail[["To"]] &lt;- "recipient@example.com"
outMail[["Subject"]] &lt;- "Hello from RDCOMClient"
outMail[["Body"]] &lt;- "This is the body of the email."
outMail$Attachments$Add("C:/path/to/attachment.txt")
outMail$Send()
outMail &lt;- NULL
OutApp &lt;- NULL</pre>			<p>Let us now understand<a id="_idIndexMarker183"/> each line of the preceding code:</p>
			<ol>
				<li>First, you need to install and load the <code>RDCOMClient</code> package in your R environment.</li>
				<li>Once installed, load the package using the <code>library()</code> function.</li>
				<li>Next, create a new Outlook application object using the <code>COMCreate()</code> function.</li>
				<li>This creates a connection to the Outlook application. Now, you can create a new email object using the <code>OutApp$CreateItem()</code> method and specify the email type as <code>olMailItem</code>.</li>
				<li>Next, you can set various properties of the email, such as the recipient, subject, body, attachments, and more. Here’s an example of how you can set these properties:<pre class="source-code">
outMail[["To"]] &lt;- "recipient@example.com"
outMail[["Subject"]] &lt;- "Hello from RDCOMClient"
outMail[["Body"]] &lt;- "This is the body of the email."
outMail$Attachments$Add("C:/path/to/attachment.txt")</pre></li>				<li>After setting the desired properties, you can send the email using the <code>Send()</code> method, and that’s it!<p class="list-inset">The email will be sent from your Outlook account to the specified recipient(s) with the configured properties. Remember to release the COM object and terminate the connection once you are done.</p><p class="list-inset">This ensures that the resources are properly released.</p></li>
			</ol>
			<p>By using <code>RDCOMClient</code>, you can automate email-sending tasks in Outlook directly from R, enabling you to streamline your workflow and save time. It provides a convenient way to integrate R with Outlook and leverage its features programmatically.</p>
			<p>Now, we will delve into the <code>Microsoft365R</code> and <code>blastula</code> packages, which work in tandem. This will be instead<a id="_idIndexMarker184"/> of using the <code>RDCOMClient</code> library, with the reason being that Microsoft365R works for those that are using Microsoft Azure instead of a generic SMTP connection via Outlook.</p>
			<h1 id="_idParaDest-76"><a id="_idTextAnchor084"/>Using the Microsoft365R and blastula packages</h1>
			<p>We are now going to go over two packages that can be used in conjunction with each other to create emails via Outlook from Microsoft. These packages are Microsoft365R and blastula. Let’s look at them in the following sections.</p>
			<h2 id="_idParaDest-77"><a id="_idTextAnchor085"/>Microsoft365R</h2>
			<p><strong class="bold">Microsoft365R</strong> is an R library that provides<a id="_idIndexMarker185"/> an interface to Microsoft 365 (formerly known as Office 365) cloud services. It is built<a id="_idIndexMarker186"/> on top of the AzureGraph package, which provides a high-level abstraction for interacting with the Microsoft Graph API. Microsoft365R currently supports the following Microsoft 365 services:</p>
			<ul>
				<li>     Teams</li>
				<li>     Outlook</li>
				<li>     SharePoint Online</li>
				<li>     OneDrive</li>
			</ul>
			<p>The library provides several top-level client functions for accessing each of these services. For example, the <code>get_personal_onedrive()</code> function can be used to access your personal OneDrive account, and the <code>get_business_outlook()</code> function can be used to access your work or school Outlook account.</p>
			<p>Microsoft365R also provides several helper functions for working with the Microsoft Graph API. For example, the <code>list_drive_contents()</code> function can be used to list the contents of a OneDrive drive, and the <code>send_email()</code> function can be used to send an email from Outlook.</p>
			<p>The library is well-documented and provides several examples to help you get started. It is also actively maintained and updated with new features and bug fixes on a regular basis.</p>
			<p>Here are some of the benefits<a id="_idIndexMarker187"/> of using Microsoft365R:</p>
			<ul>
				<li>It provides a simple and easy-to-use interface for accessing Microsoft 365 cloud services</li>
				<li>It is built on top of the <code>AzureGraph</code> package, which provides a high-level abstraction for interacting with the Microsoft Graph API</li>
			</ul>
			<p>If you are looking for an R library<a id="_idIndexMarker188"/> that provides an easy way to access Microsoft 365 cloud services, then Microsoft365R is a great option. It is well-documented in the package vignettes, actively maintained, and supports a wide range of Microsoft 365 services. We will only be focusing on its use for Outlook.</p>
			<h2 id="_idParaDest-78"><a id="_idTextAnchor086"/>The blastula package</h2>
			<p>The <code>blastula</code> R package is a tool<a id="_idIndexMarker189"/> that makes it easy to produce and send HTML email from R. You can use Markdown text, block-based components, and even HTML fragments to create email messages with three content areas: a body, header, and a footer. The package also provides functions to set up <code>install.packages("blastula")</code>.</p>
			<p>Some of the advantages<a id="_idIndexMarker191"/> of using blastula over other email packages are as follows:</p>
			<ul>
				<li>It allows you to use Markdown text, block-based components, and even HTML in order to create professional and potentially computed document emails. You can achieve this in the body, the header, and the footer of the email.</li>
				<li>The package also provides functions to set up SMTP access credentials and send email through a traditional SMTP server, or, if you are a RStudio Connect user, you can send emails via RStudio Connect.</li>
				<li>The resulting email will look great on any display.</li>
				<li>The syntax is intuitive, allowing you to code quickly and effectively while making your primary focus the message of the email itself.</li>
			</ul>
			<p>Here is an example of using <code>blastula</code> to create <a id="_idIndexMarker192"/>and send a simple HTML email message:</p>
			<ol>
				<li>First, we need to load the <code>blastula</code> package with <code>library(blastula)</code> and <code>library(glue)</code>.</li>
				<li>Next, we can use the <code>compose_email()</code> function to create the email message. We can supply Markdown text to the body argument to be rendered in HTML; for example, see the following:<pre class="source-code">
email &lt;- compose_email(
  body = md(glue(
"Hello, this is {sale_file} contains the latest quarters data. Here is a picture of the graph that will be on our dashboard:![sales dashboard] https://dashboard.company.com/)")
)</pre></li>				<li>Then, we can preview the email message in the viewer by calling the email object:<pre class="source-code">
email</pre></li>				<li>Finally, we can send the email message through an SMTP server using the <code>smtp_send()</code> function. We need to provide the recipient’s email address, the sender’s email address, the subject line, and the credentials for the SMTP server:<pre class="source-code">
email %&gt;%
  smtp_send(
     to = "jane_doe@example.com",
     from = "joe_public@example.net",
     subject = "Testing the `smtp_send()` function",
     credentials = creds_file("email_creds")
  )</pre><p class="list-inset">The <code>creds_file()</code> function is a helper function that creates a credentials file for SMTP access.</p><p class="list-inset">We can use the <code>create_smtp_creds_file()</code> function to generate this file interactively:</p><pre class="source-code">create_smtp_creds_file(
  file = "email_creds",
  user = "joe_public@example.net",
  provider = "gmail"
)</pre></li>			</ol>
			<p>This will prompt us to enter<a id="_idIndexMarker193"/> our password and a two-factor authentication code (if enabled) for Gmail. The credentials file will be saved in a secure location and can be reused for future email messages.</p>
			<p>Now that we have gone over both packages separately, let’s see how we can use them together in a fashion that could be a bit more robust and streamlined.</p>
			<p>Here is a full script, and then we will discuss how it works:</p>
			<pre class="source-code">
install.packages("blastula")
install.packages("Microsoft365R")
library(blastula)
library(Microsoft365R)
# Get work/school email
outlb &lt;- get_business_outlook()
# compose an email with blastula
bl_body &lt;- "## Hello!
You can write email in **Markdown** with the blastula package."
bl_em &lt;- compose_email(
     body=md(bl_body),
     footer=md("sent via Microsoft365R and R")
)
em &lt;- outlb$create_email(bl_em, subject="Hello from R", to="email@example.com")
# add an attachment and send it
em$add_attachment("mydocument.docx")
em$send()</pre>			<p>Now, let’s go over each part of the script<a id="_idIndexMarker194"/> to understand what is happening.</p>
			<ol>
				<li>First, we must install both the <code>blastula</code> and <code>Microsoft365R</code> packages.</li>
				<li>Then, we call those libraries into the current session using the <code>library()</code> function.</li>
				<li>We then create a variable called <code>outlb</code> that holds the variable for the <code>get_business_outlook()</code> function.</li>
				<li>We then create the body of the email. We can write the email using Markdown syntax.</li>
				<li>After we make the body of the email, we then create a variable to hold the email itself that is created using the function <code>compose_email()</code>.</li>
				<li>From here, we then add the attachment and send the email.</li>
			</ol>
			<p>The email is sent using the configured work/school email account retrieved earlier. So, in conclusion, these lines of code install the necessary packages, load the required libraries, retrieve the work/school email account, compose an email using the <code>blastula</code> package, add an attachment<a id="_idIndexMarker195"/> to the email, and finally, send the email using the <code>Microsoft365R</code> package.</p>
			<p>You have learned about scheduling and email integration in R. Now, let’s have a look at how the same can be achieved in Python!</p>
			<h1 id="_idParaDest-79"><a id="_idTextAnchor087"/>Scheduling Python scripts</h1>
			<p>Automation is not limited<a id="_idIndexMarker196"/> to executing scripts manually; it also involves scheduling them to run at specific intervals or events. Scheduling Python scripts allows you to automate repetitive tasks, perform periodic data updates, generate reports, and carry out system maintenance without manual intervention.</p>
			<p>In this section, we will explore various techniques and tools to schedule Python scripts and achieve efficient and timely execution.</p>
			<p>By the end of this section, you will have a comprehensive understanding of various scheduling techniques and tools available for Python scripts. You will be equipped with the knowledge and skills to schedule your Python scripts effectively, automate routine tasks, and maximize your productivity. Whether you are running scripts on Windows or Unix-like systems, this chapter will empower you to implement reliable and efficient Python script scheduling solutions.</p>
			<h2 id="_idParaDest-80"><a id="_idTextAnchor088"/>Introduction to Python script scheduling</h2>
			<p>We will start by discussing<a id="_idIndexMarker197"/> the importance of scheduling Python scripts and its benefits in streamlining workflows. You will learn why scheduling is crucial for automating tasks and how it can save time and effort. We will also highlight real-world scenarios where Python script scheduling is commonly applied.</p>
			<p>Scheduling Python scripts plays a vital role in automating tasks and improving workflow efficiency. By scheduling scripts to run at specific intervals or events, you can eliminate the need for manual execution and ensure timely and accurate data processing, report generation, and system maintenance.</p>
			<p>In this section, we will explore the importance of Python script scheduling and highlight its benefits in the various<a id="_idIndexMarker198"/> domains listed as follows:</p>
			<ul>
				<li><strong class="bold">Automating repetitive tasks</strong>: Many tasks in data processing, analysis, and reporting involve repetitive actions. Scheduling Python scripts allows you to automate these tasks, reducing the time and effort required for manual execution. Whether it’s fetching data from external sources, performing calculations, generating reports, or updating databases, scheduling scripts ensures consistent and reliable automation.</li>
				<li><strong class="bold">Periodic data updates</strong>: In many applications, data need to be regularly updated from external sources or refreshed from internal systems. Python script scheduling enables you to define a schedule for fetching, transforming, and updating data automatically. By specifying the desired frequency, you can ensure that your data remain up to date without manual intervention.</li>
				<li><strong class="bold">Generating reports</strong>: Reports are often generated periodically, such as daily, weekly, or monthly. With Python script scheduling, you can automate the generation of reports by scheduling the script to run at specific intervals. This ensures that the reports are produced consistently and delivered on time, saving valuable time and effort.</li>
				<li><strong class="bold">System maintenance</strong>: Python script scheduling is not limited to data-related tasks; it can also be used for system maintenance activities. From performing backups and database maintenance to running system checks and executing routine cleanup tasks, scheduling Python scripts enables you to keep your systems running smoothly without manual intervention.</li>
				<li><strong class="bold">Real-world scenarios</strong>: Python script scheduling finds application in various industries and domains. For example, in ecommerce, scripts can be scheduled to update product inventory, synchronize prices, and generate sales reports. In finance, scheduled scripts can fetch stock market data, calculate portfolio performance, and generate financial statements. In IT operations, scripts can be scheduled for system monitoring, log analysis, and automated incident response. These are just a few examples of how Python script scheduling can be leveraged to enhance productivity<a id="_idIndexMarker199"/> and efficiency across different domains.</li>
			</ul>
			<p>By understanding the importance of Python script scheduling and its benefits, you can identify opportunities to automate tasks, streamline workflows, and improve overall productivity.</p>
			<p>In the following sections, we will explore different methods and tools for scheduling Python scripts, providing you with the knowledge and techniques to implement effective and reliable automation solutions.</p>
			<h2 id="_idParaDest-81"><a id="_idTextAnchor089"/>Built-in scheduling options</h2>
			<p>Python provides built-in scheduling<a id="_idIndexMarker200"/> options on both Windows and Unix-like systems without the need for external libraries. These options provide a convenient and lightweight way to schedule and execute your Python scripts at predefined intervals. In this section, we will explore the built-in scheduling options and discuss their features, usage, and limitations.</p>
			<p>We will explore <strong class="bold">Windows Task Scheduler</strong> and <strong class="bold">crontab</strong> on Unix-like systems. You will learn how to set up scheduled tasks using these native scheduling tools, specify the frequency of execution, and configure various options to meet your specific requirements.</p>
			<p>Here is a list of the built-in options and their key features:</p>
			<h3>cron (Unix-like systems)</h3>
			<p>The following <a id="_idIndexMarker201"/>are the key features<a id="_idIndexMarker202"/> of cron:</p>
			<ul>
				<li>cron is a time-based job scheduler available on Unix-like operating systems, including Linux and macOS</li>
				<li>It allows you to schedule recurring tasks by specifying the time, date, and frequency using a cron expression</li>
				<li>cron provides flexibility in defining schedules, such as running scripts at specific times, on specific days of the week, or at regular intervals</li>
				<li>It is widely supported and has been the de facto standard for scheduling tasks on Unix-like systems for many years</li>
				<li>While cron is not a Python-specific<a id="_idIndexMarker203"/> tool, you can use it to schedule<a id="_idIndexMarker204"/> the execution of Python scripts by specifying the appropriate command line invocation</li>
			</ul>
			<h3>Windows Task Scheduler (Windows systems)</h3>
			<p>The following points <a id="_idIndexMarker205"/>list the features<a id="_idIndexMarker206"/> of Windows systems:</p>
			<ul>
				<li>Windows Task Scheduler is the built-in task scheduling tool provided by the Windows operating system</li>
				<li>It allows you to schedule tasks to run at specific times or events on Windows machines</li>
				<li>You can create scheduled tasks through the graphical user interface or using the command line tool <code>schtasks</code></li>
				<li>Windows Task Scheduler provides a range of options for defining triggers, such as specific times, daily, weekly, or monthly schedules, or even based on system events</li>
				<li>It offers a user-friendly interface for managing scheduled tasks, including setting up dependencies, priority settings, and error handling</li>
			</ul>
			<h3>Python’s time.sleep() function</h3>
			<p>This is a list of the key<a id="_idIndexMarker207"/> features<a id="_idIndexMarker208"/> of the <code>time.sleep()</code> function:</p>
			<ul>
				<li>While not specifically designed for scheduling tasks, Python’s built-in <code>time</code> module provides a simple way to introduce delays between script executions</li>
				<li>The <code>time.sleep()</code> function pauses the script for a specified number of seconds, allowing you to control the timing between script runs</li>
				<li>While this option lacks the sophistication and advanced features of dedicated scheduling tools, it can be useful for simple cases where a fixed delay is sufficient</li>
				<li>However, keep in mind that using <code>time.sleep()</code> as a scheduling mechanism may not be suitable<a id="_idIndexMarker209"/> for precise or complex<a id="_idIndexMarker210"/> scheduling requirements</li>
			</ul>
			<p>It’s important to note that these built-in scheduling options have their strengths and limitations. They are suitable for many use cases but may not provide the advanced features and flexibility required for complex scheduling scenarios. In such cases, external libraries and tools can offer more robust solutions.</p>
			<p>In the next section, we will explore some popular third-party libraries for scheduling Python scripts, providing additional features and customization options.</p>
			<h2 id="_idParaDest-82"><a id="_idTextAnchor090"/>Third-party scheduling libraries</h2>
			<p>While Python’s built-in scheduling<a id="_idIndexMarker211"/> options can handle many common scheduling tasks, there are several third-party libraries available that provide more advanced features and customization options. These libraries offer greater flexibility and control over scheduling Python scripts, allowing you to handle complex scheduling scenarios with ease.</p>
			<p>In this section, we will explore some popular third-party scheduling libraries and discuss their features and benefits. We will cover topics such as defining schedules using cron-like syntax, handling time zones, and managing concurrent execution.</p>
			<h3>schedule</h3>
			<p>Here are the features<a id="_idIndexMarker212"/> and benefits<a id="_idIndexMarker213"/> of the <code>schedule</code> library:</p>
			<ul>
				<li>The <code>schedule</code> library is a lightweight Python library that simplifies the process of scheduling tasks</li>
				<li>It offers an intuitive and easy-to-use API for defining schedules using a fluent interface</li>
				<li>The library supports various scheduling options, such as specific times, intervals, and cron-like expressions</li>
				<li><code>schedule</code> allows you to execute functions, methods, or even shell commands at the defined schedule</li>
				<li>It is designed to be simple and lightweight, making it suitable for smaller projects or cases where a minimalistic<a id="_idIndexMarker214"/> scheduling solution is desired</li>
			</ul>
			<p>Here is an easy-to-demonstrate<a id="_idIndexMarker215"/> usage of <code>schedule</code> in <a id="_idIndexMarker216"/>Python:</p>
			<pre class="source-code">
import schedule
import time
def job():
    print("This job is executed every day at 8:00 AM.")
# Schedule the job to run every day at 8:00 AM
schedule.every().day.at("08:00").do(job)
# Keep the program running
while True:
    schedule.run_pending()
    time.sleep(1)</pre>			<p>In this example, we import the <code>schedule</code> library and define a function called <code>job()</code>, which prints a message. We then use the <code>schedule.every().day.at(08:00).do(job)</code> syntax to schedule the <code>job</code> function to run every day at 8:00 am. Finally, we use a <code>while</code> loop to continuously check for pending scheduled jobs and execute them. Note that this solution means the console is <code>blocked</code>, meaning the Python process running this infinite loop will not be available for other tasks. To stop the scheduler, simply interrupt the kernel/console or kill the underlying Python process.</p>
			<p>You can customize the scheduling behavior by using different methods provided by the <code>schedule</code> library, such as <code>.every().day.at()</code>, <code>.every().monday</code>, <code>.every().hour</code>, and more. Additionally, you can schedule jobs to run at specific intervals or combine multiple<a id="_idIndexMarker217"/> scheduling patterns<a id="_idIndexMarker218"/> as per your requirements.</p>
			<p>Let’s have a look at <code>APScheduler</code> next.</p>
			<h3>Advanced Python Scheduler (APScheduler)</h3>
			<p>Here are the features<a id="_idIndexMarker219"/> and benefits<a id="_idIndexMarker220"/> of <code>APScheduler</code>:</p>
			<ul>
				<li><strong class="bold">Advanced Python Scheduler</strong> (<strong class="bold">APScheduler</strong>) is another popular choice for scheduling tasks in Python</li>
				<li>It provides a rich set of features, including various trigger types, such as intervals, cron expressions, and date-based triggers</li>
				<li>APScheduler supports multiple job stores, including in-memory, SQL databases, and Redis</li>
				<li>It offers advanced scheduling options, such as job coalescing, distributed scheduling, and time zone support</li>
				<li>APScheduler has a well-documented API and is widely used in various applications, ranging from simple scripts to complex web applications</li>
			</ul>
			<p>Here’s a sample code snippet demonstrating<a id="_idIndexMarker221"/> how to schedule tasks using the <code>APScheduler</code> library:</p>
			<pre class="source-code">
from apscheduler.schedulers.blocking import BlockingScheduler
# Create a scheduler instance
scheduler = BlockingScheduler()
# Define a task function
def send_email():
     # Code to send an email
     print("Email sent!")
# Schedule the task to run every hour
scheduler.add_job(send_email, 'interval', hours=1)
# Start the scheduler
scheduler.start()</pre>			<p>From the preceding<a id="_idIndexMarker222"/> example, we understand the following:</p>
			<ol>
				<li>We first import the <code>BlockingScheduler</code> class from the <code>apscheduler.schedulers.blocking</code> module. Then, we create an instance of the scheduler using <code>BlockingScheduler()</code>.</li>
				<li>Next, we define a function called <code>send_email()</code>, which represents the task of sending an email. Inside this function, you can write the code to send an email or perform any other desired action.</li>
				<li>To schedule the task, we use the <code>add_job()</code> method of the scheduler. In this case, we specify the <code>send_email</code> function as the task to be executed. We also provide the scheduling parameters using the <code>interval</code> option, which indicates that the task should be executed at regular intervals. In this example, we set it to run every hour (<code>hours=1</code>).</li>
				<li>Finally, we start the scheduler by calling the <code>start()</code> method. This will initiate the scheduler and begin executing the tasks according to the defined schedule.</li>
			</ol>
			<p>The <code>APScheduler</code> library provides various scheduling options, such as fixed intervals, cron expressions, date/time triggers, and more. You can customize the scheduling behavior according to your specific requirements by exploring the documentation and using the appropriate scheduling<a id="_idIndexMarker223"/> options provided<a id="_idIndexMarker224"/> by APScheduler.</p>
			<p>Next up, let’s have a look at the Celery package for completeness’ sake.</p>
			<h3>Celery</h3>
			<p>The following are the<a id="_idIndexMarker225"/> features and benefits<a id="_idIndexMarker226"/> of Celery:</p>
			<ul>
				<li>Celery is a distributed task queue library that can be used for both task execution and scheduling</li>
				<li>It provides a robust and scalable solution for scheduling Python tasks across multiple workers or machines</li>
				<li>Celery supports various scheduling options, including intervals, crontab-like expressions, and more</li>
				<li>It offers advanced features such as task prioritization, result tracking, retries, and task chaining</li>
				<li>Celery integrates<a id="_idIndexMarker227"/> well with message<a id="_idIndexMarker228"/> brokers such as <strong class="bold">RabbitMQ</strong>, <strong class="bold">Redis</strong>, or <strong class="bold">Apache Kafka</strong>, providing reliable and scalable<a id="_idIndexMarker229"/> task-scheduling capabilities</li>
			</ul>
			<p>By using the Celery scheduler, you can automate the execution of tasks based on specific schedules, allowing you to perform recurring or time-based operations in your application. Configuring and deploying Celery apps is beyond the scope of this book, though, so it only stands here for completeness’ sake. You can consult the official documentation<a id="_idIndexMarker230"/> if you wish to delve deeper: <a href="https://docs.celeryq.dev/en/stable/userguide/periodic-tasks.html">https://docs.celeryq.dev/en/stable/userguide/periodic-tasks.html</a>.</p>
			<p>These third-party scheduling libraries provide powerful and flexible solutions for scheduling Python scripts. Depending on your specific requirements and the complexity of your scheduling tasks, you can choose the library that best fits your needs. Each library has its own strengths<a id="_idIndexMarker231"/> and capabilities, so it’s important to evaluate them based on your project’s requirements.</p>
			<p>In the next section, we will explore practical examples of using these libraries to schedule Python scripts for various use cases.</p>
			<h2 id="_idParaDest-83"><a id="_idTextAnchor091"/>Best practices and considerations for robust automation</h2>
			<p>When working with scheduling Python scripts, it’s essential to follow best practices and consider various factors to ensure efficient and reliable automation. This section provides insights into the best<a id="_idIndexMarker232"/> practices and considerations for scheduling Python scripts effectively.</p>
			<p>These best practices will help you create robust and maintainable scheduled tasks. Let’s discuss these best practices in the following sections.</p>
			<h3>Error handling and logging</h3>
			<p>Here are the<a id="_idIndexMarker233"/> best practices<a id="_idIndexMarker234"/> for error handling and logging:</p>
			<ul>
				<li>Implement robust error-handling mechanisms to handle any unexpected exceptions and errors that may occur during script execution</li>
				<li>Use logging frameworks to capture detailed information about script execution, including errors, warnings, and information messages</li>
				<li>Proper error handling and logging allow you to diagnose issues, track script performance, and ensure that scheduled tasks are executed as expected</li>
			</ul>
			<h3>Resource management</h3>
			<p>Here are the best practices<a id="_idIndexMarker235"/> for resource management:</p>
			<ul>
				<li>Consider the resources required by your scheduled Python scripts, such as CPU, memory, and disk space</li>
				<li>Optimize resource usage by identifying and minimizing any resource-intensive operations or bottlenecks</li>
				<li>Ensure that your scripts release<a id="_idIndexMarker236"/> resources properly to avoid resource leaks or conflicts</li>
			</ul>
			<h3>Security considerations</h3>
			<p>Here are the best practices <a id="_idIndexMarker237"/>for security considerations:</p>
			<ul>
				<li>Evaluate the security implications of scheduling Python scripts, especially if they involve sensitive data or interact with external systems</li>
				<li>Implement necessary security measures, such as encrypting credentials, securing API endpoints, and adhering to authentication and authorization protocols</li>
				<li>Regularly review and update security measures to mitigate potential risks and vulnerabilities</li>
			</ul>
			<h3>Testing and validation</h3>
			<p>Here are the<a id="_idIndexMarker238"/> best practices <a id="_idIndexMarker239"/>for testing and validation:</p>
			<ul>
				<li>Thoroughly test and validate your scheduled Python scripts to ensure their correctness and reliability</li>
				<li>Perform unit testing, integration testing, and end-to-end testing to verify that your scripts function as expected and handle various scenarios</li>
				<li>Consider creating<a id="_idIndexMarker240"/> a staging environment<a id="_idIndexMarker241"/> where you can test scheduled tasks before deploying them to a production environment</li>
			</ul>
			<h3>Monitoring and alerting</h3>
			<p>Here are the<a id="_idIndexMarker242"/> best practices<a id="_idIndexMarker243"/> for monitoring and alerting:</p>
			<ul>
				<li>Establish monitoring and alerting mechanisms to track the execution status of scheduled tasks</li>
				<li>Monitor the performance and health of your scheduling system, including script execution times, resource usage, and any potential errors or failures</li>
				<li>Configure alerts to notify you when tasks fail, enabling prompt intervention and troubleshooting</li>
			</ul>
			<h3>Documentation and maintenance</h3>
			<p>Here are the<a id="_idIndexMarker244"/> best practices <a id="_idIndexMarker245"/>for documentation and maintenance:</p>
			<ul>
				<li>Document the scheduling process, including the configuration, dependencies, and any specific instructions for managing scheduled tasks</li>
				<li>Maintain an up-to-date schedule of your scheduled Python scripts, including the frequency and expected outcomes of each task</li>
				<li>Regularly review and update your scheduling setup, scripts, and dependencies to adapt to changing requirements and technologies</li>
			</ul>
			<p>By following these best practices and considering the relevant factors, you can ensure the reliability, efficiency, and security of your scheduled Python scripts. Incorporating these considerations into your scheduling workflow will contribute to the smooth execution of tasks and help you maintain a well-structured and sustainable automation system.</p>
			<p>In the next section, we will explore practical examples and use cases that illustrate the application of these best practices and considerations in real-world scenarios.</p>
			<p>By completing this section<a id="_idIndexMarker246"/> on scheduling Python scripts, you have gained valuable knowledge and skills in automating and managing the execution of your scripts. Let’s summarize what you have learned:</p>
			<ul>
				<li>You explored the various built-in scheduling options available in different operating systems, such as cron jobs on Unix-like systems and Task Scheduler on Windows, enabling you to schedule Python scripts at specific times or intervals</li>
				<li>You discovered third-party scheduling libraries, such as <code>APScheduler</code> and <code>Schedule</code>, which provide more advanced scheduling capabilities, such as cron-like expressions and interval-based scheduling</li>
				<li>You understood the best practices for scheduling Python scripts, including error handling, resource management, security considerations, testing, validation, monitoring, and alerting, as well as documentation and maintenance</li>
				<li>Through practical examples and use cases, you gained hands-on experience in implementing and managing scheduled Python scripts, ensuring the efficient and reliable automation of your tasks</li>
			</ul>
			<p>By mastering the concepts<a id="_idIndexMarker247"/> and techniques covered in this section, you are now equipped to schedule Python scripts effectively, automate repetitive tasks, and streamline your workflow. The ability to schedule scripts opens a world of possibilities for automating various processes, increasing productivity, and freeing up valuable time for more critical tasks.</p>
			<p>In the next section, we will delve into the exciting realm of email notifications and explore how you can enhance your automation workflows by integrating email functionality into your Python scripts.</p>
			<h1 id="_idParaDest-84"><a id="_idTextAnchor092"/>Email notifications and automation with Python</h1>
			<p>Much like scheduling Python scripts, email notifications and automation can make your daily work much more efficient. This section will cover the basics, such as the motivation behind using emails from Python, moving on to setting up the environment and sending basic emails, and then covering a real-life use case: sending email notifications for script status.</p>
			<h2 id="_idParaDest-85"><a id="_idTextAnchor093"/>Introduction to email notifications in Python</h2>
			<p>Email notifications<a id="_idIndexMarker248"/> play a crucial<a id="_idIndexMarker249"/> role in automation by providing timely updates, alerts, and reports. In this section, we will explore the significance of integrating email functionality into your Python scripts. We’ll discuss various use cases where email notifications can be beneficial, and we’ll delve into the advantages they offer for streamlining workflows and enhancing communication.</p>
			<p>Let’s start with the most basic considerations: why would you do this?</p>
			<h3>Use cases and benefits of integrating email functionality into your scripts</h3>
			<p>Email notifications are versatile and can be applied to a wide range of scenarios. Some common use cases<a id="_idIndexMarker250"/> include the following:</p>
			<ul>
				<li><strong class="bold">Task completion notifications</strong>: These send notifications to indicate the successful completion of a task or process, helping to keep stakeholders informed and reassuring them that everything is running smoothly.</li>
				<li><strong class="bold">Error and exception reporting</strong>: This involves alerting relevant team members or administrators when errors or exceptions occur during script execution, allowing for prompt troubleshooting and issue resolution.</li>
				<li><strong class="bold">Progress updates</strong>: This provides periodic progress updates to stakeholders or clients, ensuring transparency and maintaining open lines of communication.</li>
				<li><strong class="bold">Data analysis reports</strong>: These automate the generation and delivery of data analysis reports via email, saving time and effort by eliminating the need for manual report creation and distribution.</li>
				<li><strong class="bold">System monitoring</strong>: This involves setting up email notifications to monitor system status, such as server uptime, disk space usage, or application performance. Immediate<a id="_idIndexMarker251"/> alerts can help address potential issues before they impact operations.</li>
			</ul>
			<p>By incorporating email notifications into your Python scripts, you can benefit from the following:</p>
			<ul>
				<li><strong class="bold">Realtime updates</strong>: Stay informed about<a id="_idIndexMarker252"/> the progress, status, and results of automated tasks</li>
				<li><strong class="bold">Enhanced collaboration</strong>: Facilitate communication and collaboration among team members by providing timely notifications</li>
				<li><strong class="bold">Error detection and resolution</strong>: Receive alerts about errors or exceptions in your scripts, enabling you to identify and resolve issues quickly</li>
				<li><strong class="bold">Customization and personalization</strong>: Tailor email notifications to suit your specific requirements, including content, formatting, and recipients</li>
				<li><strong class="bold">Streamlined workflows</strong>: Automate the delivery of reports, updates, and alerts, saving time and effort in manual distribution</li>
			</ul>
			<p>Throughout this section, we will explore the various aspects of email notifications in Python, empowering you to leverage this powerful communication tool within your automation workflows.</p>
			<p>Let’s dive in and explore how to set up and use email functionality effectively.</p>
			<h2 id="_idParaDest-86"><a id="_idTextAnchor094"/>Setting up email services</h2>
			<p>Before diving into sending<a id="_idIndexMarker253"/> email notifications from Python, it’s essential to set up the necessary email services to establish a connection between your script and the email server.</p>
			<p>By the end of this section, you will have a clear understanding of how to set up email services for your Python scripts. You’ll be equipped with the necessary knowledge to choose the right email service provider, obtain the required SMTP server credentials, configure secure connections, and test the connection. With your email services in place, you’ll be ready to move on to the next steps of sending email notifications seamlessly from your Python<a id="_idIndexMarker254"/> scripts.</p>
			<p>Let’s get started and set up your email services effectively.</p>
			<p>In this section, we will cover the steps involved in configuring email services, including the following aspects.</p>
			<h3>Choosing an email service provider</h3>
			<p>There are several email service providers<a id="_idIndexMarker255"/> available, each offering different features and options. In this section, we will be using Gmail as an example but the code can easily be adapted to other providers, such as Microsoft Exchange, as well.</p>
			<h3>Obtaining SMTP server credentials</h3>
			<p>To send emails<a id="_idIndexMarker256"/> programmatically, it’s important<a id="_idIndexMarker257"/> to obtain the SMTP server credentials provided by your email service provider. These credentials are essential for establishing a connection with the email server and sending emails securely.</p>
			<p>In this section, we’ll guide you through the process of acquiring the necessary information to configure your email settings effectively.</p>
			<ul>
				<li><code>smtp.example.com </code>or <code>mail.example.com</code>. Make sure you verify the correct SMTP server address for your specific email service.</li>
				<li><strong class="bold">Port number</strong>: The port number specifies the communication endpoint for the SMTP server. Common port numbers for SMTP communication include 25, 465 (for SSL/TLS encrypted connections), and 587 (for STARTTLS encrypted connections). Your email service provider will specify the appropriate port number to use for sending emails.</li>
				<li><strong class="bold">Authentication details</strong>: To authenticate yourself with the SMTP server, you will need to provide a username and password. These credentials are used to establish a secure connection and ensure that only authorized users can send emails. Your email service provider will provide you with the necessary authentication details. In some cases, an API key or access token may be required for authentication instead of a traditional username and password.</li>
			</ul>
			<p>It’s important to note that the process of obtaining SMTP server credentials may vary depending on your email service provider. Some providers offer specific instructions or account settings where you can find the required information. If you’re unsure about where to find your SMTP server credentials, it’s recommended that you consult the documentation or support resources provided by your email service provider.</p>
			<p>By obtaining the SMTP server credentials, you’ll be equipped with the necessary information to establish a connection with the email server and send emails programmatically. This allows<a id="_idIndexMarker258"/> you to leverage the power of Python<a id="_idIndexMarker259"/> to automate email notifications, updates, and other communication tasks within your applications or scripts.</p>
			<h3>Testing the connection</h3>
			<p>To ensure a successful <a id="_idIndexMarker260"/>setup, it’s important to test the connection between your Python script and the email server.</p>
			<p>In the next section, we’ll demonstrate how to perform a connection test by sending a test email using the provided SMTP server credentials. This will help verify that the connection is established correctly and that your script can communicate with the email server.</p>
			<h2 id="_idParaDest-87"><a id="_idTextAnchor095"/>Sending basic emails</h2>
			<p>Now that we have set up our email<a id="_idIndexMarker261"/> services, we can proceed to the next step: sending basic emails from Python.</p>
			<p>By the end of this section, you will have a solid understanding of how to send basic emails from Python. You’ll know how to import the required libraries, create email messages, establish a connection with the email server, and send the email using the SMTP protocol. With this knowledge, you’ll be able to send simple text-based emails from your Python scripts<a id="_idIndexMarker262"/> and lay the foundation for more advanced email notifications.</p>
			<p>In this section, we will explore the fundamental concepts and techniques for sending emails programmatically.</p>
			<h3>Importing the required libraries</h3>
			<p>To send emails from Python, we need<a id="_idIndexMarker263"/> to import the necessary libraries that provide email-related functionality. Ahead, we’ll discuss popular libraries, such as <code>smtplib</code> and <code>email.mime</code>, which offer convenient features for creating and sending emails. We’ll guide you through the installation process and demonstrate<a id="_idIndexMarker264"/> how to import these libraries into your Python script.</p>
			<h3>Creating the email message</h3>
			<p>Before sending an email, we need<a id="_idIndexMarker265"/> to construct the email message, which includes the sender, recipient, subject, and body of the email. We’ll show you how to create an email message using the <code>email.mime</code> library, allowing you to customize various aspects of the email, such as adding attachments or setting HTML content. We’ll provide code examples and explanations to help you understand the structure and components of an email message.</p>
			<h3>Establishing the connection</h3>
			<p>To send an email, we need to establish<a id="_idIndexMarker266"/> a connection with the email server using the SMTP protocol. We’ll demonstrate how to establish a connection using the SMTP server credentials obtained earlier. We’ll guide you through the process of creating an SMTP object, setting up the connection, and handling any potential errors or exceptions that may arise during the establishment of the connection.</p>
			<h3>Sending the email</h3>
			<p>Once the connection<a id="_idIndexMarker267"/> is established, we can proceed to send the email. We’ll demonstrate how to use the <code>smtplib</code> library to send an email message. We’ll cover the necessary steps, including authenticating with the email server, specifying the sender and recipient addresses, and invoking the <code>sendmail()</code> method. We’ll also discuss error handling and provide best practices for ensuring the successful delivery of the email.</p>
			<p>The preceding sections are the steps that are implemented in the following code sample:</p>
			<pre class="source-code">
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
# Define email server and credentials
smtp_server = 'your_smtp_server'
smtp_port = 587
smtp_username = 'your_username'
smtp_password = 'your_password'
# Create a MIME message
message = MIMEMultipart()
message['From'] = 'sender@example.com'
message['To'] = 'recipient@example.com'
message['Subject'] = 'Test Email'
# Add the email body
body = MIMEText('This is the email body.')
message.attach(body)
# Establish a connection with the email server
with smtplib.SMTP(smtp_server, smtp_port) as server:
    # Start the TLS encryption
    server.starttls()
    # Log in to the email server
    server.login(smtp_username, smtp_password)
    # Send the email
    server.send_message(message)</pre>			<p>From this code example, we can<a id="_idIndexMarker268"/> observe the following:</p>
			<ol>
				<li>We first import the <code>smtplib</code> library to establish an SMTP connection and the <code>MIMEText</code> and <code>MIMEMultipart</code> classes from the <code>email.mime</code> module for creating the email message.</li>
				<li>Next, we define the SMTP server details, including the server address, port, and the credentials (username and password) required for authentication.</li>
				<li>We then create a <code>MIMEMultipart</code> object called message, which represents the email message. We set the sender and recipient addresses, as well as the subject of the email.</li>
				<li>Then, we send the email using the <code>send_message()</code> method of the SMTP server object, passing the message as an argument.</li>
				<li>Remember to replace the placeholder values (<code>your_smtp_server</code> and <code>your_username</code>). To add the email body, we create a <code>MIMEText</code> object called body and attach it to the message.</li>
				<li>Afterward, we establish a connection with the email server using the <code>smtplib.SMTP</code> class, passing the server address and port as arguments. We start the TLS encryption using the <code>starttls()</code> method.</li>
				<li>Next, we log in to the email server using the <code>login()</code> method and provide the username and password.</li>
			</ol>
			<p>Finally, use <code>your_password</code>, <code>sender@example.com</code>, and <code>recipient@example.com</code> with your actual SMTP server details and email addresses.</p>
			<p>By following this code <a id="_idIndexMarker269"/>example, you’ll be able to send basic emails using the <code>smtplib</code> and <code>email.mime</code> libraries in Python.</p>
			<h2 id="_idParaDest-88"><a id="_idTextAnchor096"/>Sending email notifications for script status</h2>
			<p>In this section, you’ll learn how<a id="_idIndexMarker270"/> to define triggers, implement<a id="_idIndexMarker271"/> email notification logic, customize email content, and handle email delivery and errors effectively. With these skills, you’ll be able to enhance the monitoring and reporting capabilities of your scripts and stay informed about the progress and outcomes of your automated processes.</p>
			<p>By the end of this section, you will have a clear understanding of how to incorporate email notifications into your Python scripts to receive updates on script execution and status.</p>
			<p>One of the key use cases for email notifications in Python is to receive updates on the status of your scripts or processes. In this section, we will delve into the process of sending email notifications to keep track of the execution and status of your scripts. By implementing this functionality, you can stay informed about the progress and outcomes of your automated processes and take the necessary actions when needed.</p>
			<p>To begin, let’s explore the steps involved in sending email notifications for script status.</p>
			<h3>Defining triggers</h3>
			<p>Before we can send email<a id="_idIndexMarker272"/> notifications, we need to define triggers that determine when the notifications should be sent. Triggers can be based on specific conditions or events that occur during script execution. For example, you may want to send an email notification when a script completes successfully, encounters an error, or reaches a specific milestone. By defining triggers, you have full control over when<a id="_idIndexMarker273"/> and under what circumstances email notifications are sent.</p>
			<h3>Implementing email notification logic</h3>
			<p>Once the triggers are defined, we can<a id="_idIndexMarker274"/> proceed to implement the logic for sending email notifications. This involves incorporating the necessary code within your script to check the triggers and initiate the email-sending process. You will need to import the required libraries, establish a connection with the email server, and customize the email content. The logic should be designed to efficiently handle the sending <a id="_idIndexMarker275"/>of email notifications based on the specified triggers.</p>
			<h3>Customizing email content</h3>
			<p>To provide relevant and informative<a id="_idIndexMarker276"/> content in your email notifications, you can customize various aspects of the email, such as the subject, body, and any additional details. The content can include information about the script’s execution status, error messages, relevant data or statistics, and any other details that are important for understanding the script’s progress. By customizing the email content, you can ensure that recipients have the necessary information to take appropriate actions or make informed decisions.</p>
			<h3>Handling email delivery and errors</h3>
			<p>Sending emails involves interacting<a id="_idIndexMarker277"/> with email<a id="_idIndexMarker278"/> servers, and various factors can affect the successful delivery of emails. It’s important to handle potential issues such as network connectivity problems, email server errors, or recipient email address errors. By implementing error-handling mechanisms, you can gracefully handle email delivery issues and ensure that notifications are sent reliably. Additionally, logging and error reporting can be useful for troubleshooting and diagnosing any email-related problems that may occur.</p>
			<p>In summary, by implementing email notifications for script status, you can stay informed about the progress and outcomes of your automated processes. You have the flexibility to define triggers, customize email content, and handle potential email delivery issues effectively. This functionality enhances the monitoring and reporting capabilities of your scripts and enables you to take timely actions based on the script’s status. With these techniques in place, you can confidently<a id="_idIndexMarker279"/> automate your processes while staying<a id="_idIndexMarker280"/> updated on their execution.</p>
			<h1 id="_idParaDest-89"><a id="_idTextAnchor097"/>Summary</h1>
			<p>In the sections on scheduling and email notifications in Python, you have gained a comprehensive understanding of the key concepts. You have learned about different scheduling options for Python scripts, including built-in options and third-party libraries such as <code>schedule</code> and <code>APScheduler</code>. The chapter also emphasizes the importance of following best practices for email notifications, such as error handling, resource management, security considerations, testing, monitoring, documentation, and maintenance.</p>
			<p>You can now recognize the value of email notifications in providing timely updates on the status and results of processes in automated systems. We have explored Python’s powerful libraries and modules, such as <code>smtplib</code> and <code>email.mime</code>, which enable the creation and customization of email messages. Additionally, you have acquired the knowledge required to set up email services by configuring SMTP servers, authentication credentials, and other relevant settings. We have also learned about packages in R, such as <code>tasksheduleR</code>, <code>blastula</code>, and <code>Microsoft365R</code>, that will perform these functions as well. They have a solid and simple syntax, which makes them very powerful tools.</p>
			<p>With a solid understanding of the basics, you have learned how to construct simple email messages with the necessary headers and content to implement basic email functionality. You have also discovered the versatility of email notifications in providing updates on script execution, including success, failure, or specific events. Now that you are armed with these insights, readers are well-equipped to integrate email notifications effectively into their Python projects.</p>
			<p>By completing this chapter, you should have gained a comprehensive understanding of scheduling Python scripts and email notifications in Python. You have learned when and how to use various scheduling tools, set up email services, and send basic emails. In the next chapter, we will learn how to format Excel with Python and R.</p>
		</div>
	

		<div><h1 id="_idParaDest-90" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor098"/>Part 2: Making It Pretty – Formatting, Graphs, and More</h1>
		</div>
		<div><p>In this part, we delve into enhancing the visual appeal and functionality of your Excel sheets. You will learn how to format your data elegantly using libraries such as <code>styledTables</code>, <code>tablaxlsx</code>, <code>excelR</code>, <code>basictabler</code>, and <code>tidyxl</code> in R and <code>pandas</code> and <code>openpyxl</code> in Python. You will discover techniques to seamlessly insert <code>ggplot2</code> and <code>matplotlib</code> graphs into your Excel sheets, bringing your data to life. Additionally, you will master the art of creating pivot tables using <code>tidyquant</code> in R and <code>win32com</code> and <code>pypiwin32</code> in Python, along with advanced summary table creation using <code>{gt}</code>.</p>
			<p>This part has the following chapters:</p>
			<ul>
				<li><a href="B19142_05.xhtml#_idTextAnchor099"><em class="italic">Chapter 5</em></a>, <em class="italic">Formatting Your Excel Sheet</em></li>
				<li><a href="B19142_06.xhtml#_idTextAnchor119"><em class="italic">Chapter 6</em></a>, <em class="italic">Inserting ggplot2/matplotlib Graphs</em></li>
				<li><a href="B19142_07.xhtml#_idTextAnchor145"><em class="italic">Chapter 7</em></a>, <em class="italic">Pivot Tables and Summary Tables</em></li>
			</ul>
		</div>
		<div><div></div>
		</div>
		<div><div></div>
		</div>
	</body></html>