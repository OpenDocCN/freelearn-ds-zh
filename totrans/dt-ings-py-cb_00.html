<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer004">
<h1 id="_idParaDest-5"><a id="_idTextAnchor004"/>Preface</h1>
<p>Welcome to <em class="italic">Data Ingestion with Python Cookbook</em>. I hope you are excited as me to enter the world of <span class="No-Break">data engineering.</span></p>
<p><em class="italic">Data Ingestion with Python Cookbook</em> is a practical guide that will empower you to design and implement efficient data ingestion pipelines. With real-world examples and renowned open-source tools, this book addresses your queries and <span class="No-Break">hurdles head-on.</span></p>
<p>Beginning with designing pipelines, you’ll explore working with and without data schemas, constructing monitored workflows using Airflow, and embracing data observability principles while adhering to best practices. Tackling the challenges of reading diverse data sources and formats, you’ll gain a comprehensive understanding of <span class="No-Break">all these.</span></p>
<p>Our journey continues with essential insights into error logging, identification, resolution, data orchestration, and effective monitoring. You’ll discover optimal approaches for storing logs, ensuring easy access and references for them in <span class="No-Break">the future.</span></p>
<p>By the end of this book, you’ll possess a fully automated setup to initiate data ingestion and pipeline monitoring. This streamlined process will seamlessly integrate into the subsequent stages of the <strong class="bold">Extract, Transform, and Load</strong> (<strong class="bold">ETL</strong>) process, propelling your data integration capabilities to new heights. Get ready to embark on an enlightening and transformative data <span class="No-Break">ingestion journey.</span></p>
<h1 id="_idParaDest-6"><a id="_idTextAnchor005"/>Who this book is for</h1>
<p>This comprehensive book is specifically designed for Data Engineers, Data Integration Specialists, and passionate data enthusiasts seeking a deeper understanding of data ingestion processes, data flows, and the typical challenges encountered along the way. It provides valuable insights, best practices, and practical knowledge to enhance your skills and proficiency in handling data ingestion <span class="No-Break">tasks effectively.</span></p>
<p>Whether you are a beginner in the data world or an experienced developer, this book will suit you. It is recommended to know the Python programming fundamentals and have basic knowledge of Docker to read and run this <span class="No-Break">book’s code.</span></p>
<h1 id="_idParaDest-7"><a id="_idTextAnchor006"/>What this book covers</h1>
<p><a href="B19453_01.xhtml#_idTextAnchor022"><span class="No-Break"><em class="italic">Chapter 1</em></span></a>, <em class="italic">Introduction to Data Ingestion, </em>introduces you to data ingestion best practices and the challenges of working with diverse data sources. It explains the importance of the tools covered in the book, presents them, and provides <span class="No-Break">installation instructions.</span></p>
<p><a href="B19453_02.xhtml#_idTextAnchor064"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, <em class="italic">Data Access Principals – Accessing your Data, </em>explores data access concepts related to data governance, covering workflows and management of familiar sources such as SFTP servers, APIs, and cloud providers. It also provides examples of creating data access policies in databases, data warehouses, and <span class="No-Break">the cloud.</span></p>
<p><a href="B19453_03.xhtml#_idTextAnchor108"><span class="No-Break"><em class="italic">Chapter 3</em></span></a>, <em class="italic">Data Discovery – Understanding Our Data Before Ingesting It, </em>teaches you the significance of carrying out the data discovery process before data ingestion. It covers manual discovery, documentation, and using an open-source tool, OpenMetadata, for <span class="No-Break">local configuration.</span></p>
<p><a href="B19453_04.xhtml#_idTextAnchor127"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <em class="italic">Reading CSV and JSON Files and Solving Problems,</em> introduces you to ingesting CSV and JSON files using Python and PySpark. It demonstrates handling varying data volumes and infrastructures while addressing common challenges and <span class="No-Break">providing solutions.</span></p>
<p><a href="B19453_05.xhtml#_idTextAnchor161"><span class="No-Break"><em class="italic">Chapter 5</em></span></a>, <em class="italic">Ingesting Data from Structured and Unstructured Databases,</em> covers fundamental concepts of relational and non-relational databases, including everyday use cases. You will learn how to read and handle data from these models, understand vital considerations, and troubleshoot <span class="No-Break">potential errors.</span></p>
<p><a href="B19453_06.xhtml#_idTextAnchor195"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, <em class="italic">Using PySpark with Defined and Non-Defined Schemas,</em> delves deeper into common PySpark use cases, focusing on handling defined and non-defined schemas. It also explores reading and understanding complex logs from Spark (PySpark core) and formatting techniques for <span class="No-Break">easier debugging.</span></p>
<p><a href="B19453_07.xhtml#_idTextAnchor227"><span class="No-Break"><em class="italic">Chapter 7</em></span></a>, <em class="italic">Ingesting Analytical Data,</em> introduces you to analytical data and common formats for reading and writing. It explores reading partitioned data for improved performance and discusses Reverse ETL theory with real-life application workflows <span class="No-Break">and diagrams.</span></p>
<p><a href="B19453_08.xhtml#_idTextAnchor280"><span class="No-Break"><em class="italic">Chapter 8</em></span></a>, <em class="italic">Designing Monitored Data Workﬂows,</em> covers logging best practices for data ingestion, facilitating error identification, and debugging. Techniques such as monitoring file size, row count, and object count enable improved monitoring of dashboards, alerts, <span class="No-Break">and insights.</span></p>
<p><a href="B19453_09.xhtml#_idTextAnchor319"><span class="No-Break"><em class="italic">Chapter 9</em></span></a>, <em class="italic">Putting Everything Together with Airﬂow,</em> consolidates the previously presented information and guides you in building a real-life data ingestion application using Airflow. It covers essential components, configuration, and issue resolution in <span class="No-Break">the process.</span></p>
<p><a href="B19453_10.xhtml#_idTextAnchor364"><span class="No-Break"><em class="italic">Chapter 10</em></span></a>, <em class="italic">Logging and Monitoring Your Data Ingest in Airflow,</em> explores advanced logging and monitoring in data ingestion with Airflow. It covers creating custom operators, setting up notifications, and monitoring for data anomalies. Configuration of notifications for tools such as Slack is also covered to stay updated on the data <span class="No-Break">ingestion process.</span></p>
<p><a href="B19453_11.xhtml#_idTextAnchor402"><span class="No-Break"><em class="italic">Chapter 11</em></span></a>, <em class="italic">Automating Your Data Ingestion Pipelines, </em>focuses on automating data ingests using previously learned best practices, enabling reader autonomy. It addresses common challenges with schedulers or orchestration tools and provides solutions to avoid problems in <span class="No-Break">production clusters.</span></p>
<p><a href="B19453_12.xhtml#_idTextAnchor433"><span class="No-Break"><em class="italic">Chapter 12</em></span></a><em class="italic">,</em> <em class="italic">Using Data Observability for Debugging, Error Handling, and Preventing Downtime,</em> explores data observability concepts, popular monitoring tools such as Grafana, and best practices for log storage and data lineage. It also covers creating visualization graphs to monitor data source issues using Airflow configuration and data <span class="No-Break">ingestion scripts.</span></p>
<h1 id="_idParaDest-8"><a id="_idTextAnchor007"/>To get the most out of this book</h1>
<p>To execute the code in this book, you must have at least a basic knowledge of Python. We will use Python as the core language to execute the code. The code examples have been tested using Python 3.8. However, it is expected to still work with future <span class="No-Break">language versions.</span></p>
<p>Along with Python, this book uses Docker to emulate data systems and applications in our local machine, such as PostgreSQL, MongoDB, and Airflow. Therefore, a basic knowledge of Docker is recommended to edit container image files and run and <span class="No-Break">stop containers.</span></p>
<p>Please, remember that some command-line commands may need adjustments depending on your local settings or operating system. The commands in the code examples are based on the Linux command-line syntax and might need some adaptations to run on <span class="No-Break">Windows PowerShell.</span></p>
<table class="No-Table-Style" id="table001">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">Software/Hardware covered in </strong><span class="No-Break"><strong class="bold">the book</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">OS Requirements</strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Python 3.8 <span class="No-Break">or higher</span></p>
</td>
<td class="No-Table-Style">
<p>Windows, Mac OS X, and <span class="No-Break">Linux (any)</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Docker Engine 24.0 / Docker <span class="No-Break">Desktop 4.19</span></p>
</td>
<td class="No-Table-Style">
<p>Windows, Mac OS X, and <span class="No-Break">Linux (any)</span></p>
</td>
</tr>
</tbody>
</table>
<p><em class="italic">For almost all recipes in this book, you can use a Jupyter Notebook to execute the code. Even though it is not mandatory to install it, this tool can help you to test the code and try new things on the code due to the </em><span class="No-Break"><em class="italic">friendly interface.</em></span></p>
<p><strong class="bold">If you are using the digital version of this book, we advise you to type the code yourself or access the code via the GitHub repository (link available in the next section). Doing so will help you avoid any potential errors related to the copying and pasting </strong><span class="No-Break"><strong class="bold">of code.</strong></span></p>
<h2 id="_idParaDest-9"><a id="_idTextAnchor008"/>Download the example code files</h2>
<p>You can download the example code files for this book from GitHub at <a href="https://github.com/PacktPublishing/Data-Ingestion-with-Python-Cookbook">https://github.com/PacktPublishing/Data-Ingestion-with-Python-Cookbook</a>. In case there’s an update to the code, it will be updated on the existing <span class="No-Break">GitHub repository.</span></p>
<p>We also have other code bundles from our rich catalog of books and videos available at <a href="https://github.com/PacktPublishing/">https://github.com/PacktPublishing/</a>. Check <span class="No-Break">them out!</span></p>
<h1 id="_idParaDest-10"><a id="_idTextAnchor009"/>Download the color images</h1>
<p>We also provide a PDF file that has color images of the screenshots/diagrams used in this book. You can download it <span class="No-Break">here: </span><a href="https://packt.link/xwl0U"><span class="No-Break">https://packt.link/xwl0U</span></a></p>
<h1 id="_idParaDest-11"><a id="_idTextAnchor010"/>Conventions used</h1>
<p>There are a number of text conventions used throughout <span class="No-Break">this book.</span></p>
<p><strong class="source-inline">Code in text</strong>: Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: “Then we proceeded with the <strong class="source-inline">with </strong><span class="No-Break"><strong class="source-inline">open</strong></span><span class="No-Break"> statement.”</span></p>
<p>A block of code is set <span class="No-Break">as follows:</span></p>
<pre class="source-code">
def gets_csv_first_line (csv_file):
    logging.info(f"Starting function to read first line")
    try:
        with open(csv_file, 'r') as file:
            logging.info(f"Reading file")</pre>
<p>Any command-line input or output is written <span class="No-Break">as follows:</span></p>
<pre class="console">
$ python3 –-version
Python 3.8.10</pre>
<p><strong class="bold">Bold</strong>: Indicates a new term, an important word, or words that you see onscreen. For example, words in menus or dialog boxes appear in the text like this. Here is an example: “Then, when we selected <strong class="source-inline">showString at NativeMethodAccessorImpl.java:0</strong>, which redirected us to the <span class="No-Break"><strong class="bold">Stages</strong></span><span class="No-Break"> page.”</span></p>
<p class="callout-heading">Tips or important notes</p>
<p class="callout">Appear like this.</p>
<h1 id="_idParaDest-12"><a id="_idTextAnchor011"/>Sections</h1>
<p>In this book, you will find several headings that appear frequently (<em class="italic">Getting ready</em>, <em class="italic">How to do it...</em>, <em class="italic">How it works...</em>, <em class="italic">There’s more...</em>, and <span class="No-Break"><em class="italic">See also</em></span><span class="No-Break">).</span></p>
<p>To give clear instructions on how to complete a recipe, use these sections <span class="No-Break">as follows:</span></p>
<h2 id="_idParaDest-13"><a id="_idTextAnchor012"/>Getting ready</h2>
<p>This section tells you what to expect in the recipe and describes how to set up any software or any preliminary settings required for <span class="No-Break">the recipe.</span></p>
<h2 id="_idParaDest-14"><a id="_idTextAnchor013"/>How to do it…</h2>
<p>This section contains the steps required to follow <span class="No-Break">the recipe.</span></p>
<h2 id="_idParaDest-15"><a id="_idTextAnchor014"/>How it works…</h2>
<p>This section usually consists of a detailed explanation of what happened in the <span class="No-Break">previous section.</span></p>
<h2 id="_idParaDest-16"><a id="_idTextAnchor015"/>There’s more…</h2>
<p>This section consists of additional information about the recipe in order to make you more knowledgeable about <span class="No-Break">the recipe.</span></p>
<h2 id="_idParaDest-17"><a id="_idTextAnchor016"/>See also</h2>
<p>This section provides helpful links to other useful information for <span class="No-Break">the recipe.</span></p>
<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/>Get in touch</h1>
<p>Feedback from our readers is <span class="No-Break">always welcome.</span></p>
<p><strong class="bold">General feedback</strong>: If you have questions about any aspect of this book, mention the book title in the subject of your message and email us <span class="No-Break">at </span><a href="mailto:customercare@packtpub.com"><span class="No-Break">customercare@packtpub.com</span></a><span class="No-Break">.</span></p>
<p><strong class="bold">Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packtpub.com/support/errata">www.packtpub.com/support/errata</a>, selecting your book, clicking on the Errata Submission Form link, and entering <span class="No-Break">the details.</span></p>
<p><strong class="bold">Piracy</strong>: If you come across any illegal copies of our works in any form on the Internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <a href="mailto:copyright@packt.com">copyright@packt.com</a> with a link to <span class="No-Break">the material.</span></p>
<p><strong class="bold">If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please <span class="No-Break">visit </span><a href="http://authors.packtpub.com"><span class="No-Break">authors.packtpub.com</span></a><span class="No-Break">.</span></p>
<h1 id="_idParaDest-19"><a id="_idTextAnchor018"/>Share Your Thoughts</h1>
<p>Once you’ve read <em class="italic">Data Ingestion with Python Cookbook</em>, we’d love to hear your thoughts! Please <a href="https://packt.link/r/183763260X">click here to go straight to the Amazon review page</a> for this book and share <span class="No-Break">your feedback.</span></p>
<p>Your review is important to us and the tech community and will help us make sure we’re delivering excellent <span class="No-Break">quality content.</span><a id="_idTextAnchor019"/></p>
<h1 id="_idParaDest-20"><a id="_idTextAnchor020"/>Download a free PDF copy of this book</h1>
<p>Thanks for purchasing <span class="No-Break">this book!</span></p>
<p>Do you like to read on the go but are unable to carry your print <span class="No-Break">books everywhere?</span></p>
<p>Is your eBook purchase not compatible with the device of <span class="No-Break">your choice?</span></p>
<p>Don’t worry, now with every Packt book you get a DRM-free PDF version of that book at <span class="No-Break">no cost.</span></p>
<p>Read anywhere, any place, on any device. Search, copy, and paste code from your favorite technical books directly into your application. </p>
<p>The perks don’t stop there, you can get exclusive access to discounts, newsletters, and great free content in your <span class="No-Break">inbox daily</span></p>
<p>Follow these simple steps to get <span class="No-Break">the benefits:</span></p>
<ol>
<li>Scan the QR code or visit the link below</li>
</ol>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer003">
<img alt="" height="200" src="image/B19453_QR_Free_PDF.jpg" width="200"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><a href="https://packt.link/free-ebook/9781837632602">https://packt.link/free-ebook/9781837632602</a></p>
<ol>
<li value="2">Submit your proof of purchase</li>
<li>That’s it! We’ll send your free PDF and other benefits to your email directly</li>
</ol>
</div>
</div>

<div id="sbo-rt-content"><div class="Content" id="_idContainer005">
<h1 id="_idParaDest-21"><a id="_idTextAnchor021"/>Part 1: Fundamentals of Data Ingestion</h1>
</div>
<div id="_idContainer006">
<p>In this part, you will be introduced to the fundamentals of data ingestion and data engineering, passing through the basic definition of an ingestion pipeline, the common types of data sources, and the <span class="No-Break">technologies involved.</span></p>
<p>This part has the <span class="No-Break">following chapters:</span></p>
<ul>
<li><a href="B19453_01.xhtml#_idTextAnchor022"><em class="italic">Chapter 1</em></a>, <em class="italic">Introduction to Data Ingestion</em></li>
<li><a href="B19453_02.xhtml#_idTextAnchor064"><em class="italic">Chapter 2</em></a>, <em class="italic">Principals of Data Access – Accessing Your Data</em></li>
<li><a href="B19453_03.xhtml#_idTextAnchor108"><em class="italic">Chapter 3</em></a>, <em class="italic">Data Discovery – Understanding Our Data Before Ingesting It</em></li>
<li><a href="B19453_04.xhtml#_idTextAnchor127"><em class="italic">Chapter 4</em></a>, <em class="italic">Reading CSV and JSON Files and Solving Problems</em></li>
<li><a href="B19453_05.xhtml#_idTextAnchor161"><em class="italic">Chapter 5</em></a>, <em class="italic">Ingesting Data from Structured and Unstructured Databases</em></li>
<li><a href="B19453_06.xhtml#_idTextAnchor195"><em class="italic">Chapter 6</em></a>, <em class="italic">Using PySpark with Deﬁned and Non-Deﬁned Schemas</em></li>
<li><a href="B19453_07.xhtml#_idTextAnchor227"><em class="italic">Chapter 7</em></a>, <em class="italic">Ingesting Analytical Data</em></li>
</ul>
</div>
<div>
<div id="_idContainer007">
</div>
</div>
<div>
<div class="Basic-Graphics-Frame" id="_idContainer008">
</div>
</div>
<div>
<div id="_idContainer009">
</div>
</div>
</div></body></html>