<html><head></head><body>
<div><div><h1 id="_idParaDest-5"><a id="_idTextAnchor004"/>Preface</h1>
<p>Welcome to <em class="italic">Data Ingestion with Python Cookbook</em>. I hope you are excited as me to enter the world of data engineering.</p>
<p><em class="italic">Data Ingestion with Python Cookbook</em> is a practical guide that will empower you to design and implement efficient data ingestion pipelines. With real-world examples and renowned open-source tools, this book addresses your queries and hurdles head-on.</p>
<p>Beginning with designing pipelines, you’ll explore working with and without data schemas, constructing monitored workflows using Airflow, and embracing data observability principles while adhering to best practices. Tackling the challenges of reading diverse data sources and formats, you’ll gain a comprehensive understanding of all these.</p>
<p>Our journey continues with essential insights into error logging, identification, resolution, data orchestration, and effective monitoring. You’ll discover optimal approaches for storing logs, ensuring easy access and references for them in the future.</p>
<p>By the end of this book, you’ll possess a fully automated setup to initiate data ingestion and pipeline monitoring. This streamlined process will seamlessly integrate into the subsequent stages of the <strong class="bold">Extract, Transform, and Load</strong> (<strong class="bold">ETL</strong>) process, propelling your data integration capabilities to new heights. Get ready to embark on an enlightening and transformative data ingestion journey.</p>
<h1 id="_idParaDest-6"><a id="_idTextAnchor005"/>Who this book is for</h1>
<p>This comprehensive book is specifically designed for Data Engineers, Data Integration Specialists, and passionate data enthusiasts seeking a deeper understanding of data ingestion processes, data flows, and the typical challenges encountered along the way. It provides valuable insights, best practices, and practical knowledge to enhance your skills and proficiency in handling data ingestion tasks effectively.</p>
<p>Whether you are a beginner in the data world or an experienced developer, this book will suit you. It is recommended to know the Python programming fundamentals and have basic knowledge of Docker to read and run this book’s code.</p>
<h1 id="_idParaDest-7"><a id="_idTextAnchor006"/>What this book covers</h1>
<p><a href="B19453_01.xhtml#_idTextAnchor022"><em class="italic">Chapter 1</em></a>, <em class="italic">Introduction to Data Ingestion, </em>introduces you to data ingestion best practices and the challenges of working with diverse data sources. It explains the importance of the tools covered in the book, presents them, and provides installation instructions.</p>
<p><a href="B19453_02.xhtml#_idTextAnchor064"><em class="italic">Chapter 2</em></a>, <em class="italic">Data Access Principals – Accessing your Data, </em>explores data access concepts related to data governance, covering workflows and management of familiar sources such as SFTP servers, APIs, and cloud providers. It also provides examples of creating data access policies in databases, data warehouses, and the cloud.</p>
<p><a href="B19453_03.xhtml#_idTextAnchor108"><em class="italic">Chapter 3</em></a>, <em class="italic">Data Discovery – Understanding Our Data Before Ingesting It, </em>teaches you the significance of carrying out the data discovery process before data ingestion. It covers manual discovery, documentation, and using an open-source tool, OpenMetadata, for local configuration.</p>
<p><a href="B19453_04.xhtml#_idTextAnchor127"><em class="italic">Chapter 4</em></a>, <em class="italic">Reading CSV and JSON Files and Solving Problems,</em> introduces you to ingesting CSV and JSON files using Python and PySpark. It demonstrates handling varying data volumes and infrastructures while addressing common challenges and providing solutions.</p>
<p><a href="B19453_05.xhtml#_idTextAnchor161"><em class="italic">Chapter 5</em></a>, <em class="italic">Ingesting Data from Structured and Unstructured Databases,</em> covers fundamental concepts of relational and non-relational databases, including everyday use cases. You will learn how to read and handle data from these models, understand vital considerations, and troubleshoot potential errors.</p>
<p><a href="B19453_06.xhtml#_idTextAnchor195"><em class="italic">Chapter 6</em></a>, <em class="italic">Using PySpark with Defined and Non-Defined Schemas,</em> delves deeper into common PySpark use cases, focusing on handling defined and non-defined schemas. It also explores reading and understanding complex logs from Spark (PySpark core) and formatting techniques for easier debugging.</p>
<p><a href="B19453_07.xhtml#_idTextAnchor227"><em class="italic">Chapter 7</em></a>, <em class="italic">Ingesting Analytical Data,</em> introduces you to analytical data and common formats for reading and writing. It explores reading partitioned data for improved performance and discusses Reverse ETL theory with real-life application workflows and diagrams.</p>
<p><a href="B19453_08.xhtml#_idTextAnchor280"><em class="italic">Chapter 8</em></a>, <em class="italic">Designing Monitored Data Workﬂows,</em> covers logging best practices for data ingestion, facilitating error identification, and debugging. Techniques such as monitoring file size, row count, and object count enable improved monitoring of dashboards, alerts, and insights.</p>
<p><a href="B19453_09.xhtml#_idTextAnchor319"><em class="italic">Chapter 9</em></a>, <em class="italic">Putting Everything Together with Airﬂow,</em> consolidates the previously presented information and guides you in building a real-life data ingestion application using Airflow. It covers essential components, configuration, and issue resolution in the process.</p>
<p><a href="B19453_10.xhtml#_idTextAnchor364"><em class="italic">Chapter 10</em></a>, <em class="italic">Logging and Monitoring Your Data Ingest in Airflow,</em> explores advanced logging and monitoring in data ingestion with Airflow. It covers creating custom operators, setting up notifications, and monitoring for data anomalies. Configuration of notifications for tools such as Slack is also covered to stay updated on the data ingestion process.</p>
<p><a href="B19453_11.xhtml#_idTextAnchor402"><em class="italic">Chapter 11</em></a>, <em class="italic">Automating Your Data Ingestion Pipelines, </em>focuses on automating data ingests using previously learned best practices, enabling reader autonomy. It addresses common challenges with schedulers or orchestration tools and provides solutions to avoid problems in production clusters.</p>
<p><a href="B19453_12.xhtml#_idTextAnchor433"><em class="italic">Chapter 12</em></a><em class="italic">,</em> <em class="italic">Using Data Observability for Debugging, Error Handling, and Preventing Downtime,</em> explores data observability concepts, popular monitoring tools such as Grafana, and best practices for log storage and data lineage. It also covers creating visualization graphs to monitor data source issues using Airflow configuration and data ingestion scripts.</p>
<h1 id="_idParaDest-8"><a id="_idTextAnchor007"/>To get the most out of this book</h1>
<p>To execute the code in this book, you must have at least a basic knowledge of Python. We will use Python as the core language to execute the code. The code examples have been tested using Python 3.8. However, it is expected to still work with future language versions.</p>
<p>Along with Python, this book uses Docker to emulate data systems and applications in our local machine, such as PostgreSQL, MongoDB, and Airflow. Therefore, a basic knowledge of Docker is recommended to edit container image files and run and stop containers.</p>
<p>Please, remember that some command-line commands may need adjustments depending on your local settings or operating system. The commands in the code examples are based on the Linux command-line syntax and might need some adaptations to run on Windows PowerShell.</p>
<table class="No-Table-Style" id="table001">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">Software/Hardware covered in </strong><strong class="bold">the book</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">OS Requirements</strong></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Python 3.8 or higher</p>
</td>
<td class="No-Table-Style">
<p>Windows, Mac OS X, and Linux (any)</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Docker Engine 24.0 / Docker Desktop 4.19</p>
</td>
<td class="No-Table-Style">
<p>Windows, Mac OS X, and Linux (any)</p>
</td>
</tr>
</tbody>
</table>
<p><em class="italic">For almost all recipes in this book, you can use a Jupyter Notebook to execute the code. Even though it is not mandatory to install it, this tool can help you to test the code and try new things on the code due to the </em><em class="italic">friendly interface.</em></p>
<p><strong class="bold">If you are using the digital version of this book, we advise you to type the code yourself or access the code via the GitHub repository (link available in the next section). Doing so will help you avoid any potential errors related to the copying and pasting </strong><strong class="bold">of code.</strong></p>
<h2 id="_idParaDest-9"><a id="_idTextAnchor008"/>Download the example code files</h2>
<p>You can download the example code files for this book from GitHub at <a href="https://github.com/PacktPublishing/Data-Ingestion-with-Python-Cookbook">https://github.com/PacktPublishing/Data-Ingestion-with-Python-Cookbook</a>. In case there’s an update to the code, it will be updated on the existing GitHub repository.</p>
<p>We also have other code bundles from our rich catalog of books and videos available at <a href="https://github.com/PacktPublishing/">https://github.com/PacktPublishing/</a>. Check them out!</p>
<h1 id="_idParaDest-10"><a id="_idTextAnchor009"/>Download the color images</h1>
<p>We also provide a PDF file that has color images of the screenshots/diagrams used in this book. You can download it here: <a href="https://packt.link/xwl0U">https://packt.link/xwl0U</a></p>
<h1 id="_idParaDest-11"><a id="_idTextAnchor010"/>Conventions used</h1>
<p>There are a number of text conventions used throughout this book.</p>
<p><code>Code in text</code>: Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: “Then we proceeded with the <code>with </code><code>open</code> statement.”</p>
<p>A block of code is set as follows:</p>
<pre class="source-code">
def gets_csv_first_line (csv_file):
    logging.info(f"Starting function to read first line")
    try:
        with open(csv_file, 'r') as file:
            logging.info(f"Reading file")</pre>
<p>Any command-line input or output is written as follows:</p>
<pre class="console">
$ python3 –-version
Python 3.8.10</pre>
<p><code>showString at NativeMethodAccessorImpl.java:0</code>, which redirected us to the <strong class="bold">Stages</strong> page.”</p>
<p class="callout-heading">Tips or important notes</p>
<p class="callout">Appear like this.</p>
<h1 id="_idParaDest-12"><a id="_idTextAnchor011"/>Sections</h1>
<p>In this book, you will find several headings that appear frequently (<em class="italic">Getting ready</em>, <em class="italic">How to do it...</em>, <em class="italic">How it works...</em>, <em class="italic">There’s more...</em>, and <em class="italic">See also</em>).</p>
<p>To give clear instructions on how to complete a recipe, use these sections as follows:</p>
<h2 id="_idParaDest-13"><a id="_idTextAnchor012"/>Getting ready</h2>
<p>This section tells you what to expect in the recipe and describes how to set up any software or any preliminary settings required for the recipe.</p>
<h2 id="_idParaDest-14"><a id="_idTextAnchor013"/>How to do it…</h2>
<p>This section contains the steps required to follow the recipe.</p>
<h2 id="_idParaDest-15"><a id="_idTextAnchor014"/>How it works…</h2>
<p>This section usually consists of a detailed explanation of what happened in the previous section.</p>
<h2 id="_idParaDest-16"><a id="_idTextAnchor015"/>There’s more…</h2>
<p>This section consists of additional information about the recipe in order to make you more knowledgeable about the recipe.</p>
<h2 id="_idParaDest-17"><a id="_idTextAnchor016"/>See also</h2>
<p>This section provides helpful links to other useful information for the recipe.</p>
<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/>Get in touch</h1>
<p>Feedback from our readers is always welcome.</p>
<p><strong class="bold">General feedback</strong>: If you have questions about any aspect of this book, mention the book title in the subject of your message and email us at <a href="mailto:customercare@packtpub.com">customercare@packtpub.com</a>.</p>
<p><strong class="bold">Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packtpub.com/support/errata">www.packtpub.com/support/errata</a>, selecting your book, clicking on the Errata Submission Form link, and entering the details.</p>
<p><strong class="bold">Piracy</strong>: If you come across any illegal copies of our works in any form on the Internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <a href="mailto:copyright@packt.com">copyright@packt.com</a> with a link to the material.</p>
<p><strong class="bold">If you are interested in becoming an author</strong>: If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, please visit <a href="http://authors.packtpub.com">authors.packtpub.com</a>.</p>
<h1 id="_idParaDest-19"><a id="_idTextAnchor018"/>Share Your Thoughts</h1>
<p>Once you’ve read <em class="italic">Data Ingestion with Python Cookbook</em>, we’d love to hear your thoughts! Please <a href="https://packt.link/r/183763260X">click here to go straight to the Amazon review page</a> for this book and share your feedback.</p>
<p>Your review is important to us and the tech community and will help us make sure we’re delivering excellent quality content.<a id="_idTextAnchor019"/></p>
<h1 id="_idParaDest-20"><a id="_idTextAnchor020"/>Download a free PDF copy of this book</h1>
<p>Thanks for purchasing this book!</p>
<p>Do you like to read on the go but are unable to carry your print books everywhere?</p>
<p>Is your eBook purchase not compatible with the device of your choice?</p>
<p>Don’t worry, now with every Packt book you get a DRM-free PDF version of that book at no cost.</p>
<p>Read anywhere, any place, on any device. Search, copy, and paste code from your favorite technical books directly into your application. </p>
<p>The perks don’t stop there, you can get exclusive access to discounts, newsletters, and great free content in your inbox daily</p>
<p>Follow these simple steps to get the benefits:</p>
<ol>
<li>Scan the QR code or visit the link below</li>
</ol>
<p class="IMG---Figure"> </p>
<div><div><img alt="" height="200" src="img/B19453_QR_Free_PDF.jpg" width="200"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><a href="https://packt.link/free-ebook/9781837632602">https://packt.link/free-ebook/9781837632602</a></p>
<ol>
<li value="2">Submit your proof of purchase</li>
<li>That’s it! We’ll send your free PDF and other benefits to your email directly</li>
</ol>
</div>
</div>

<div><div><h1 id="_idParaDest-21"><a id="_idTextAnchor021"/>Part 1: Fundamentals of Data Ingestion</h1>
</div>
<div><p>In this part, you will be introduced to the fundamentals of data ingestion and data engineering, passing through the basic definition of an ingestion pipeline, the common types of data sources, and the technologies involved.</p>
<p>This part has the following chapters:</p>
<ul>
<li><a href="B19453_01.xhtml#_idTextAnchor022"><em class="italic">Chapter 1</em></a>, <em class="italic">Introduction to Data Ingestion</em></li>
<li><a href="B19453_02.xhtml#_idTextAnchor064"><em class="italic">Chapter 2</em></a>, <em class="italic">Principals of Data Access – Accessing Your Data</em></li>
<li><a href="B19453_03.xhtml#_idTextAnchor108"><em class="italic">Chapter 3</em></a>, <em class="italic">Data Discovery – Understanding Our Data Before Ingesting It</em></li>
<li><a href="B19453_04.xhtml#_idTextAnchor127"><em class="italic">Chapter 4</em></a>, <em class="italic">Reading CSV and JSON Files and Solving Problems</em></li>
<li><a href="B19453_05.xhtml#_idTextAnchor161"><em class="italic">Chapter 5</em></a>, <em class="italic">Ingesting Data from Structured and Unstructured Databases</em></li>
<li><a href="B19453_06.xhtml#_idTextAnchor195"><em class="italic">Chapter 6</em></a>, <em class="italic">Using PySpark with Deﬁned and Non-Deﬁned Schemas</em></li>
<li><a href="B19453_07.xhtml#_idTextAnchor227"><em class="italic">Chapter 7</em></a>, <em class="italic">Ingesting Analytical Data</em></li>
</ul>
</div>
<div><div></div>
</div>
<div><div></div>
</div>
<div><div></div>
</div>
</div></body></html>