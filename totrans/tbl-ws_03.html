<html><head></head><body>
		<div><div></div>
		</div>
		<div><h1 id="_idParaDest-62">3. <a id="_idTextAnchor061"/>Data Preparation: Using Tableau Prep</h1>
		</div>
		<div><p class="callout-heading">Overview</p>
			<p class="callout">In this chapter, you will learn some advanced data preparation methods in Tableau Prep. You will learn how to use various Tableau Prep options to clean datasets, join different data sources using various options, and perform data manipulation activities such as pivots, grouping, and aggregations. By the end of this chapter, you will be able to export a cleaned data source to develop visualizations in Tableau.</p>
			<h1 id="_idParaDest-63"><a id="_idTextAnchor062"/>Introduction</h1>
			<p>In the previous chapter, you performed some fundamental  data transformations such as joins, filtering, and groups using Tableau Desktop. However, Tableau Desktop only performs basic data manipulation. It may not be able to handle raw unprocessed/unclean data, like data containing multiple entries, missing entries, or inconsistent formats. Now, you will learn about more advanced methods, better suited to these trickier scenarios.</p>
			<p>Tableau Prep is a tool  specifically designed to perform data transformation so we can use the data for our visualizations. It consists of advanced algorithms that help detect data inconsistencies and fix them. This can be done automatically as well as manually, depending on the requirements.</p>
			<p>In this chapter, you will learn about the Prep interface, along with data operations like adding data sources,  data profiling, and applying transformations such as cleaning, splitting, adding pivots, joining data sources, and applying unions. Finally, you will learn how to export this transformed dataset into Excel for data visualization. </p>
			<h1 id="_idParaDest-64"><a id="_idTextAnchor063"/>Prep Interface</h1>
			<p>In this section, you will look at the options available in Tableau Prep for data transformation. Tableau Prep can be downloaded from the Tableau website (<a href="https://www.tableau.com/products/prep">https://www.tableau.com/products/prep</a>) and installed like any other program. You can find detailed installation steps in the <em class="italic">Preface</em>. Once the installation is complete, navigate to your desktop and click on the Tableau Prep icon to open it. </p>
			<p>When you open Prep for the first time, it will look like this:</p>
			<div><div><img src="img/B16342_03_01.jpg" alt="Figure 3.1: Prep start screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.1: Prep start screen</p>
			<p>The <code>Connections </code>tab (top-left corner), shows all data sources that can be connected in the prep. This is similar to the <code>Connect</code> pane in Tableau Desktop. (<em class="italic">Chapter 2, Data Preparation Using Tableau Desktop</em>.)</p>
			<div><div><img src="img/B16342_03_02.jpg" alt=" Figure 3.2: Data connections in Prep&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> Figure 3.2: Data connections in Prep</p>
			<p>Throughout this chapter, you will be working with file-based connections such as Excel spreadsheets and CSVs. First, let's look briefly at the other options available on the start screen (as shown in <em class="italic">Figure 3.1</em>):</p>
			<p> </p>
			<div><div><img src="img/B16342_03_03.jpg" alt="Figure 3.3: Options on the start screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.3: Options on the start screen</p>
			<p>In the preceding figure, you can see the following elements:</p>
			<ul>
				<li><code>Open a Flow</code>: This opens a workflow that has already been created. A workflow, or flow, is a series of data transformation activities that you perform on the input data in Prep. You will learn about creating different flows in the upcoming sections.</li>
				<li><code>Connect to Data</code>: This opens the <code>Connections</code> menu, where you connect to data, as shown earlier.</li>
				<li><code>Recent Flows</code>: All previous flows can be viewed here. You can toggle between card view or list view using the controls on the right side.</li>
			</ul>
			<p>Other than these options, you also have <code>Sample Flows</code> provided by Tableau, and the <code>Discover</code> menu, where you can check out Prep-related content updates on the Tableau website.</p>
			<p>There are also other <code>File</code>, <code>Edit</code>, <code>Flow</code>, and <code>Server</code> menu options at the top. The <code>File</code> and <code>Edit</code> options should be self-explanatory. The <code>Flow</code> menu can be used to run the flow, and the <code>Server</code> menu has the option to sign in and publish the flow on Tableau Server.</p>
			<p>Now that you have learned about the various options, it's time to add some data in the flow.</p>
			<h1 id="_idParaDest-65"><a id="_idTextAnchor064"/>Adding Data in the Flow</h1>
			<p>As seen in <em class="italic">Chapter 2</em>, <em class="italic">Data Preparation using Tableau Desktop</em>, the first step of any data preparation activity is to add the data into your workflow. To do that in Prep, click on <code>Connections</code> and select the data source. In the following exercise, you will connect to file-based data sources, but the process is similar for server-based data sources.</p>
			<h2 id="_idParaDest-66"><a id="_idTextAnchor065"/>Exercise 3.01: Connecting to an Excel File</h2>
			<p>In this exercise, you will connect with your very first data source in Prep. Follow these steps to complete the exercise:</p>
			<ol>
				<li>After installing Tableau Prep Builder, find the files in the following location on your computer:<ul><li>Windows<pre><code>C:\Program Files\Tableau\Tableau Prep Builder &lt;version&gt;\help\Samples\en_US\Superstore Files</code></pre></li><li>Mac <pre><code>/Applications/Tableau Prep Builder &lt;version&gt;.app/Contents/help/Samples/en_US/Superstore Files</code></pre></li></ul></li>
				<li>Click on <code>Connections</code> and select the <code>Microsoft Excel</code> option.</li>
				<li>This will open the menu from which you can select the Excel file. Navigate to the aforementioned location and open the <code>Orders_East.xlsx</code> file.</li>
			</ol>
			<div><div><img src="img/B16342_03_04.jpg" alt="Figure 3.4: Connecting to an Excel file using Prep&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.4: Connecting to an Excel file using Prep</p>
			<p>You will get the following screen once the Excel file has loaded:</p>
			<div><div><img src="img/B16342_03_05.jpg" alt="Figure 3.5: Data input properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.5: Data input properties</p>
			<p>There are a lot of tabs and options on this screen. These will be covered in the upcoming sections.</p>
			<ol>
				<li value="4">Click the <code>+</code> icon (<em class="italic">Figure 3.6</em>) to see the steps that can be applied to this input dataÂ step:</li>
			</ol>
			<div><div><img src="img/B16342_03_06.jpg" alt="Figure 3.6: Adding steps to a workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.6: Adding steps to a workflow</p>
			<p>Now it's time to add an output step. To do so, click on <code>+</code> and select <code>Output</code>. An output tab will open, and you can preview the data.</p>
			<div><div><img src="img/B16342_03_07.jpg" alt="Figure 3.7: Output step properties in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.7: Output step properties in the workflow</p>
			<p>Here, you learned how to connect to an Excel file. Next, you will learn about bringing multiple inputs into the flow.</p>
			<h2 id="_idParaDest-67"><a id="_idTextAnchor066"/>Exercise 3.02: Connecting with Multiple Data Sources</h2>
			<p>Ideally, in a business project, data should be stored in separate sources. Thus, it is important to know how to connect to multiple data sources. In this exercise, you will try to add another data source to your existing flow.</p>
			<p>You will be connecting the <code>Orders_South</code> data, as follows:</p>
			<ol>
				<li value="1">Continuing from the last step of the previous exercise, click on <code>+</code> and select the <code>Text file</code> option. This is because the required data is stored as a CSV file, which is a type of text file.</li>
			</ol>
			<div><div><img src="img/B16342_03_08.jpg" alt="Figure 3.8: Connecting to a CSV file&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3<a id="_idTextAnchor067"/>.8: Connecting to a CSV file</p>
			<ol>
				<li value="2">Now, navigate to the <code>Order_South</code> folder under <code>Superstore Files</code>. Select <code>orders_south_2018.csv</code> and click on <code>Open</code> to bring the file into Prep.</li>
			</ol>
			<div><div><img src="img/B16342_03_09.jpg" alt="Figure 3.9: Data explorer window to view input files&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.9: Data explorer window to view input files</p>
			<p>You should get the following screen:</p>
			<div><div><img src="img/B16342_03_10.jpg" alt="Figure 3.10: Adding multiple files to the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.10: Adding multiple files to the workflow</p>
			<p>The following steps will walk you through the various tabs in the <code>Input</code> pane shown in <em class="italic">Figure 3.10</em>:</p>
			<div><div><img src="img/B16342_03_11.jpg" alt="Figure 3.11: CSV input properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.11: CSV input properties</p>
			<ol>
				<li value="3">The <code>Setting</code> tab is mostly related to the connection details of the data source, and might vary depending on the data source connection. You will find options here to edit connection details, select text options, decide which field separators to use, and more.</li>
				<li>You also have options such as <code>Text Qualifier</code>, <code>Character Set</code>, and <code>Locale</code>. Prep is smart enough to recognize these configurations but, if required, configurations can be changed as per requirements. Finally, there is an option for <code>Incremental Refresh</code>. This is similar to Tableau Desktop, and can be used to load new data based on certain columns rather than pulling all data every time the flow runs.</li>
				<li>Select the <code>Multiple File</code> tab to get the option to add multiple files together.</li>
			</ol>
			<div><div><img src="img/B16342_03_12.jpg" alt="Figure 3.12: Options to input multiple files&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.12: Options to input multiple files</p>
			<ol>
				<li value="6">Now, change the selection to <code>Wildcard union</code>. Suppose you want to get all the <code>orders_south</code> files from the folder. You can simply search it by a pattern (<code>*south*</code>) and get all the files you want to find (<em class="italic">Figure 3.13</em>).</li>
			</ol>
			<div><div><img src="img/B16342_03_13.jpg" alt="Figure 3.13: Wildcard search for multiple file input&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.13: Wildcard search for multiple file input</p>
			<p>You can search for files like this in the folders (or subfolders) as well. You can also include or exclude files that match a pattern. By including an asterisk (<code>*</code>) you can  selectively ignore all  characters before and after a keyword.</p>
			<ol>
				<li value="7">Click on <code>Apply</code>, and all these sheets will be included in the flow. Prep also includes a new column, <code>File Paths</code>, which indicates the locations this data is coming from.</li>
			</ol>
			<div><div><img src="img/B16342_03_14.jpg" alt="Figure 3.14: Identification of input file source using File Paths&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.14: Identification of input file source using File Paths</p>
			<ol>
				<li value="8">Next, select the <code>Data Sample</code> tab. Here, you get the option to sample the input data, which is especially useful if the data is vast. Ideally,  when working with a very large dataset, it is better to work with a sample to save time while developing the workflow, as the workflow will run faster if there are fewerÂ records.</li>
			</ol>
			<div><div><img src="img/B16342_03_15.jpg" alt="Figure 3.15: Sampling the input data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.15: Sampling the input data</p>
			<p>By hovering over the information icon, you can check how Prep samples theÂ data.</p>
			<ol>
				<li value="9">Select the <code>Changes</code> tab. Any changes made to the data will be tracked here. A simple example is unchecking certain column names in the data. For example, if you uncheck the <code>Sales</code> and <code>Quantity</code> columns, these are immediately added to the <code>Changes</code> tab. The changes are also indicated by the annotations (small icons) in the <code>Changes</code> column, and on the data input icon as well. (Figure 3.16.)</li>
			</ol>
			<div><div><img src="img/B16342_03_16.jpg" alt="Figure 3.16: Tracking changes in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.16: Tracking changes in the workflow</p>
			<p>In this section, you learned how to connect multiple data sources in a workflow and their configuration properties. Next, you will learn how to profile data in Prep.</p>
			<h1 id="_idParaDest-68"><a id="_idTextAnchor068"/>Data Source Profile</h1>
			<p>Until now, you have only connected to different data sources. But your main objective is to understand the data better. This can be done by observing the data distribution, the data types of various columns, the values that a column contains, and so on.</p>
			<p>A data source profile gives you an understanding of the underlying data by allowing you to observe the data distribution and frequency, along with the various data types for the fields. This helps you make appropriate changes to the data to fulfill the requirements in the flow. Some common options include checking the data distribution frequency, the number of unique records, and the associations among various columns. You will first learn about some commonly used profiling steps, and then apply them in an exercise.</p>
			<p>Data source profiling can be performed using a clean step. A clean step can be added by hovering over the <code>+</code> icon next to the data source and selecting <code>Clean Step</code>, asÂ follows:</p>
			<div><div><img src="img/B16342_03_17.jpg" alt="Figure 3.17: Adding a clean step in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.17: Adding a clean step in the workflow</p>
			<p>Now, a clean step has been added to the workflow, which will open a new window for its connected input dataset. In this window, you can profile your data.</p>
			<div><div><img src="img/B16342_03_18.jpg" alt="Figure 3.18: Clean step properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.18: Clean step properties</p>
			<p>The preceding screenshot shows the data profile pane. Each column will give a slightly different representation, depending on the data type.</p>
			<p>For example, a string data type will give a distribution of the frequency with which it has occurred. If you observe the <code>Customer Name</code> column (as shown in the following screenshot) you will observe the number of orders placed by a customer. This is because the view is based on the customer order frequency.</p>
			<div><div><img src="img/B16342_03_19.jpg" alt="Figure 3.19: Observing Customer Name value frequencies&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.19: Observing Customer Name value frequencies</p>
			<p>For a numeric column type, the profile would just give a histogram indicating the distribution of the values. Observe the <code>Quantity</code> column, which is a number. The data profile provides a histogram that can help you understand the range of the quantities sold.</p>
			<div><div><img src="img/B16342_03_20.jpg" alt="Figure 3.20: Data profile for a numeric column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.20: Data profile for a numeric column</p>
			<p>Now that you have learned about the concept of data profiling, it's time for an exercise, to practice using the data profile of the <code>Orders</code> dataset.</p>
			<h2 id="_idParaDest-69"><a id="_idTextAnchor069"/>Exercise 3.03: Data Profile for the Orders_South Dataset</h2>
			<p>In this exercise, you will learn how to better understand data using the data profile options in Prep.In the previous workflow, you connected to the <code>Order_South</code> dataset . This is a continuation of that exercise.</p>
			<ol>
				<li value="1">Perform the following steps: </li>
				<li>Once the data is connected in Prep, click the <code>+</code> icon and then select <code>CleanÂ Step</code>:</li>
			</ol>
			<div><div><img src="img/B16342_03_21.jpg" alt="Figure 3.21: Adding a clean step&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.21: Adding a clean step</p>
			<ol>
				<li value="3">Click on the clean step to open up the details, as follows:</li>
			</ol>
			<div><div><img src="img/B16342_03_22.jpg" alt="Figure 3.22: Data profile for Orders_South data source&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.22: Data profile for Orders_South data source</p>
			<ol>
				<li value="4">Hover over the <code>Product ID</code> column to see the unique values it contains. You also have the option to change the data type, and sort, search, and perform a cleaning operation on it. Additionally, you also get a composition of the data using a histogram, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B16342_03_23.jpg" alt="Figure 3.23: Observing the frequency of the values in the Product ID column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.23: Observing the frequency of the values in the Product ID column</p>
			<ol>
				<li value="5">Select any value. Note that all associated rows are now highlighted. For example, if you select the state of Florida, you will see how the data is connected across the other columns. You will also observe that its profit trend is on the lower side, which indicates Florida is a low-selling state.</li>
			</ol>
			<div><div><img src="img/B16342_03_24.jpg" alt="Figure 3.24: Associations across multiple columns in the data profile&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.24: Associations across multiple columns in the data profile</p>
			<p>Using data profiling like this, you can quickly see trends in data using the data distributions, which allows us to quickly spot and remove anomalies such as negative quantities sold.. These options will be covered in detail in the next section.</p>
			<h1 id="_idParaDest-70"><a id="_idTextAnchor070"/>Data Preparation Using Clean, Groups, and Split</h1>
			<p>Cleaning is a very important part of data preparation, because having the right data leads to proper and efficient data analysis.</p>
			<p>For example, imagine the sales amount for an order in a dataset is blank, but an order is processed anyway. This cannot be right, and requires some action. The order in question should either not be included, or the sales amount should be replaced with an average.</p>
			<p>Another example would be the same customer having multiple names, or more than one customer ID. You may need to combine the names into one to correctly analyze information. All such tasks can be done using data cleaning. Prep provides a variety of options to clean data. In this section, you will learn about them.</p>
			<p>Refer to the <code>Orders_South</code> dataset workflow that was created earlier:</p>
			<div><div><img src="img/B16342_03_25.jpg" alt="Figure 3.25: Orders_South workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.25: Orders_South workflow</p>
			<p>Right-click on the <code>Clean 1</code> step to open the additional properties, as shown in the following screenshot:</p>
			<div><div><img src="img/B16342_03_26.jpg" alt="Figure 3.26: Step customization option properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.26: Step customization option properties</p>
			<p>Here, you can perform operations such as renaming, adding a description and editing the color of the step, as explained in the following points:</p>
			<ul>
				<li><code>Rename</code>: Double-click or <em class="italic">Ctrl</em> + <em class="italic">click</em> (if you are using Mac) on the field name. This opens a text entry box. Here, you can add a name of your choice to this step.</li>
			</ul>
			<div><div><img src="img/B16342_03_27.jpg" alt="Figure 3.27: Rename the clean step in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.27: Rename the clean step in the workflow</p>
			<ul>
				<li><code>Add Description</code>: Descriptions clarify the purpose of a step. This is especially useful if the workflow is being used by multiple people. To add a description, right-click on the step and select the <code>Add Description</code> option.</li>
			</ul>
			<div><div><img src="img/B16342_03_28.jpg" alt="Figure 3.28: Adding a description to the clean step in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.28: Adding a description to the clean step in the workflow</p>
			<p>After you have added a description, the text appears under the step as follows:</p>
			<div><div><img src="img/B16342_03_29.jpg" alt="Figure 3.29: Toggling the description for the clean step in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.29: Toggling the description for the clean step in the workflow</p>
			<p>You can choose to show or hide the description by clicking on the highlighted icon in the preceding figure. After you have added the description, you can also edit or delete it. To do that, right-click on the step again and you will see the <code>Edit Description</code> and <code>Delete Description</code> options (<em class="italic">Figure 3.30</em>):</p>
			<div><div><img src="img/B16342_03_30.jpg" alt="Figure 3.30: Description editing and deleting options for the clean step in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.30: Description editing and deleting options for the clean step in the workflow</p>
			<ul>
				<li><code>Edit Color</code> will change the color of the step. This is useful for visual identification in various steps of the flow.</li>
			</ul>
			<p>You will now focus on the bottom pane. This is also known as the profile pane, which you saw earlier. Here, you will find the <code>Filter Values</code> and <code>Create Calculated Field</code> options. You will notice that Prep also gives recommendations related to the data. You can toggle between the three views using the view options.</p>
			<div><div><img src="img/B16342_03_31.jpg" alt="Figure 3.31: Recommendations for data cleaning in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.31: Recommendations for data cleaning in the workflow</p>
			<ul>
				<li><code>Change Data Type</code> changes the column's type to another data type. The following images shows the different data types in Prep:</li>
			</ul>
			<div><div><img src="img/B16342_03_32.jpg" alt="Figure 3.32: Changing the column data type&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.32: Changing the column data type</p>
			<p>Currently, the column has the <code>Number (decimal)</code> data type selected. If required, you can select <code>String</code> to change the column's data type accordingly.</p>
			<p><code>Number (decimal)</code> and <code>Number (whole)</code> are numeric data types. <code>Date &amp; Time</code> is used for columns consisting of date or time values. A <code>String</code> data type is used for columns consisting of character values. You also have <code>Data Role</code>. This is applicable to string data types, and further defines the type of string values a column contains.</p>
			<p>Often, you will need to change the column data type for correct representation. For example, if a postal code is saved as a numeric data type, then it is not the correct representation. Although postal codes are numbers, their true representation is in the form of a <code>String,</code> with a <code>Geographic</code> role. You will now learn how to change the data types based on the following examples in Prep. Refer to the recommendations provided:</p>
			<div><div><img src="img/B16342_03_33.jpg" alt="Figure 3.33: Changing the column data type using recommendations&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.33: Changing the column data type using recommendations</p>
			<p>As you can see, <code>State</code> is saved as a <code>String,</code> but no data role is assigned to it. To assign a data role to <code>State</code>, click on the <code>State</code> column, then change <code>Data Role</code> to <code>Geographic</code> â <code>State / Province</code>, as shown in the followingÂ screenshot:</p>
			<div><div><img src="img/B16342_03_34.jpg" alt="Figure 3.34: Changing the column data role&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.34: Changing the column data role</p>
			<p>You can do the same for other columns as well, that is, for <code>City</code>, <code>Postal Code</code>, and <code>Country</code>. All the changes that we perform will be tracked on the <code>Changes</code> tab.</p>
			<div><div><img src="img/B16342_03_35.jpg" alt="Figure 3.35: Applying the recommendations to the other columns&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.35: Applying the recommendations to the other columns</p>
			<p>At any time, if you want to reverse a change, you can select it by hovering over the change and selecting the <code>Remove</code> option, as follows:</p>
			<div><div><img src="img/B16342_03_36.jpg" alt="Figure 3.36: Reversing a change in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.36: Reversing a change in the workflow</p>
			<p>This is how the result looks after changing the data type and roles of theseÂ columns:</p>
			<div><div><img src="img/B16342_03_37.jpg" alt="Figure 3.37: How the columns look before the changes&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.37: How the columns look before the changes</p>
			<div><div><img src="img/B16342_03_38.jpg" alt="Figure 3.38: Columns after the changes are made&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.38: Columns after the changes are made</p>
			<p>These changes help to create the right type of visualization to draw useful insights â for example, if these were simple string types, you would not be able to create geographical visualizations such as maps. This would restrict your visualization abilities to draw certain insights, such as which cities or which postal codes order most products or how they compare with other cities.</p>
			<h2 id="_idParaDest-71"><a id="_idTextAnchor071"/>Additional Clean Steps</h2>
			<p>In the previous section, you learned how to add a clean step, and how to track changes using various options related to the clean step. You also saw how to change the data types and data roles. In this section, you will learn about some additional cleaning steps that are available at the individual column level. You will continue working in the same data profile pane.</p>
			<p>To access additional cleaning steps, hover over individual columns and click on the <code>â¦</code> icon to see the additional options, as follows:</p>
			<div><div><img src="img/B16342_03_39.jpg" alt="Figure 3.39: More cleaning options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.39: More cleaning options</p>
			<p>Before proceeding, it is important to note that certain columns might have some unavailable options due to the different data types. For example, for <code>Country</code>, <code>View State â Summary</code> is disabled. However, it is available for the <code>Profit</code> column, as the following screenshot shows:</p>
			<div><div><img src="img/B16342_03_40.jpg" alt="Figure 3.40: Available options based on column data type&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.40: Available options based on column data type</p>
			<p>With that in mind, it's time to learn more about the additional options you can use to clean your data.</p>
			<h2 id="_idParaDest-72"><a id="_idTextAnchor072"/>Cleaning Steps at the Column Level</h2>
			<p>In this section, you will learn about adding the filter and calculation options on the input data source. You will continue from where you left off, after changing the dataÂ roles.</p>
			<p>Filter: The filter option allows you to select a subset of the data from the dataset. This option limits the data being pulled into the workflow. Quite often, it is useful to limit your analysis to specific subsets of the data to analyze it further. We can achieve this using the filter options. For example, you might wish to identify the <code>State</code> with the highest orders. This can be easily done by sorting the <code>State</code> column as follows:</p>
			<div><div><img src="img/B16342_03_41.jpg" alt="Figure 3.41: Sorting the State column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.41: Sorting the State column</p>
			<h2 id="_idParaDest-73"><a id="_idTextAnchor073"/>Exercise 3.04: Applying a Filter in a Clean Step</h2>
			<p>In this exercise, you will learn how to apply a filter in the clean step. You can see in <em class="italic">Figure 3.41</em> that Florida has the highest number of orders. You can now filter the data to show only the orders for <code>Florida</code>.</p>
			<p>Follow these steps to complete this exercise:</p>
			<ol>
				<li value="1">Click on <code>â¦</code> and select <code>Filter</code> â <code>Selected Values</code>.</li>
			</ol>
			<div><div><img src="img/B16342_03_42.jpg" alt="Figure 3.42: Different filter types &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.42: Different filter types </p>
			<ol>
				<li value="2">Select <code>Florida</code> from the list and click on <code>Done</code> to filter the data:</li>
			</ol>
			<div><div><img src="img/B16342_03_43.jpg" alt="Figure 3.43: Selected Values filter properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.43: Selected Values filter properties</p>
			<p>There are also other ways to filter the data using <code>Calculation...</code>, <code>Null Values</code>, and <code>Wildcard Match</code>:</p>
			<div><div><img src="img/B16342_03_44.jpg" alt="Figure 3.44: More ways to filter the data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.44: More ways to filter the data</p>
			<ol>
				<li value="3"><code>Null Values</code> filters the nulls in the data, while <code>Wildcard Match</code> filters based on a keyword.</li>
			</ol>
			<div><div><img src="img/B16342_03_45.jpg" alt="Figure 3.45: Calculation filter properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.45: Calculation filter properties</p>
			<p>As the name suggests, the <code>Calculationâ¦</code> filter filters the data based on certain calculation conditions.</p>
			<ol>
				<li value="4">Now, create a calculation to check which month had the highest orders. To do that, click on the <code>â¦</code> icon on the <code>Order Date</code> column, then find <code>Create Calculated Field</code> and <code>Custom Calculation</code>:</li>
			</ol>
			<div><div><img src="img/B16342_03_46.jpg" alt="Figure 3.46: Creating a calculation in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.46: Creating a calculation in the workflow</p>
			<ol>
				<li value="5">This will open the calculation editor. Type the following expression in the editor and rename the calculation <code>Order_Date_Month</code>:<pre>Month([Order Date])</pre></li>
			</ol>
			<div><div><img src="img/B16342_03_47.jpg" alt="Figure 3.47: Calculation editor properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.47: Calculation editor properties</p>
			<ol>
				<li value="6">Sort the months and observe that the highest sales are in November, followed by June:</li>
			</ol>
			<div><div><img src="img/B16342_03_48.jpg" alt="Figure 3.48: New column added using calculations&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.48: New column added using calculations</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Given timing and version variance, your calculation may result in a different month for highest sales. The step instruction to sort will be the sameÂ regardless.</p>
			<p>Based on the conditions you specify, you can create calculations in a similar manner for filters. You will learn about calculations in more detail later as you progress through the book.</p>
			<h2 id="_idParaDest-74"><a id="_idTextAnchor074"/>Exercise 3.05: Cleaning a Column in the Workflow</h2>
			<p>In the previous section, you learned how to filter data using various conditions. You also learned how to add calculations to this data source. In this exercise, you will learn about the <code>Clean</code> option.</p>
			<p>The <code>Clean</code> option provides string operations that can be used to clean the column. Examples include removing punctuation marks or junk characters, making the character uppercase or lowercase, removing numbers from the strings, and more. The following steps must be executed to clean a column:</p>
			<ol>
				<li value="1">Continue with the same workflow from the previous section. Observe the <code>Product Name</code> column. It contains a lot of junk characters, such as <code>#</code> and <code>'</code>. You can remove these characters, as they are not very useful for analysis.</li>
			</ol>
			<div><div><img src="img/B16342_03_49.jpg" alt="Figure 3.49: Product Name preview with junk characters&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.49: Product Name preview with junk characters</p>
			<ol>
				<li value="2">To access the <code>Clean</code> option, click on the <code>â¦</code> icon. The <code>Clean</code> option will provide a variety of functions to clean the data, as you can see in the next screenshot:</li>
			</ol>
			<div><div><img src="img/B16342_03_50.jpg" alt="Figure 3.50: Various clean methods&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.50: Various clean methods</p>
			<ol>
				<li value="3">Now, use the <code>Remove Punctuation</code> option for <code>Product Name</code>, as follows:</li>
			</ol>
			<div><div><img src="img/B16342_03_51.jpg" alt="Figure 3.51: Using the Remove Punctuation option to clean the Product Name column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.51: Using the Remove Punctuation option to clean the Product Name column</p>
			<p>You will get a clean column without the junk characters:</p>
			<div><div><img src="img/B16342_03_52.jpg" alt="Figure 3.52: Cleaned Product Name column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.52: Cleaned Product Name column</p>
			<p>There are also a few other options, such as removing numbers or characters, changing the casing, and removing spaces in the values. These options are self-explanatory and can be used as and when the project requires.</p>
			<h2 id="_idParaDest-75"><a id="_idTextAnchor075"/>Grouping Values</h2>
			<p>To group values means to combine two or more values into a single combined value so that they are represented as one value or group. This is generally used when the data contains spelling errors that result in the same value appearing in differentÂ forms.</p>
			<p>Think back to our customer with multiple names being represented by different customer IDs. This data issue can be resolved using group values. We can combine the multiple customer names into one customer using group values.</p>
			<p>Like the <code>Clean</code> option, the <code>Group Values</code> option can be accessed by hovering over a column and clicking the <code>â¦</code> icon, as follows:</p>
			<div><div><img src="img/B16342_03_53.jpg" alt="Figure 3.53: Various Group Values methods&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.53: Various Group Values methods</p>
			<p>You will learn how to use this option in a workflow in the next exercise.</p>
			<h2 id="_idParaDest-76"><a id="_idTextAnchor076"/>Exercise 3.06: Grouping Values into a Group</h2>
			<p>In this exercise, you will group the <code>Sub-Category</code> values <code>Chairs</code> and <code>Tables</code> into a group using the <code>Manual Selection</code> option. Follow these steps to complete thisÂ exercise:</p>
			<ol>
				<li value="1">Click the dropdown on the <code>Sub-Category</code> column, then select <code>Group Values</code> and <code>Manual Selection</code>:</li>
			</ol>
			<div><div><img src="img/B16342_03_54.jpg" alt="Figure 3.54: Group values using the Manual Selection method&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.54: Group values using the Manual Selection method</p>
			<ol>
				<li value="2">Towards the left of the window, select the <code>Chairs</code> value, which should add a member group, also called <code>Chairs</code>, to the right. By default, the group will have the same name as the first member, which in this case is <code>Chairs</code>.</li>
			</ol>
			<div><div><img src="img/B16342_03_55.jpg" alt="Figure 3.55: Adding members to a group&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.55: Adding members to a group</p>
			<ol>
				<li value="3">To rename the group to <code>Office Furniture</code>, double-click on <code>Chairs</code> and type in the new name, as shown in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_03_56.jpg" alt="Figure 3.56: Renaming a group&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.56: Renaming a group</p>
			<p>Now the new group name should be visible as follows:</p>
			<div><div><img src="img/B16342_03_57.jpg" alt="Figure 3.57: Updated group name&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.57: Updated group name</p>
			<ol>
				<li value="4">Now you can add more members to the group using the right column. Add <code>Tables</code> to this group by selecting that value:</li>
			</ol>
			<div><div><img src="img/B16342_03_58.jpg" alt="Figure 3.58: Adding additional members to the group&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.58: Adding additional members to the group</p>
			<ol>
				<li value="5">You can also add values that are not currently in the data but will be added in the future. To do that, click on the <code>+</code> icon and add the value in the textbox. You will see a red dot next to the value, indicating that it does not currently exist in the data. Note that this value should match the future expected value, or else it might not get automatically added to the group.</li>
			</ol>
			<div><div><img src="img/B16342_03_59.jpg" alt="Figure 3.59: Adding future values to the group&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.59: Adding future values to the group</p>
			<div><div><img src="img/B16342_03_60.jpg" alt="Figure 3.60: Adding future available members to the group&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.60: Adding future available members to the group</p>
			<ol>
				<li value="6">Next, click on <code>Done</code> to add the group. The new group will be added, indicated by a paperclip icon (<em class="italic">Figure 3.61</em>).</li>
			</ol>
			<p> </p>
			<div><div><img src="img/B16342_03_61.jpg" alt="Figure 3.61: The grouped value replaces individual values in the Sub-Category column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.61: The grouped value replaces individual values in the Sub-Category column</p>
			<p>This is an example of manual grouping.  Another way to group data, is by using built-in algorithms that enable us to do this automatically using pronunciation, common characters, or spelling. A common example is the same phrase written in different ways, such as "Tableau Prep" and "Prep Tableau." These essentially mean the same thing but are written differently. Prep provides built-in algorithms that can identify such values and group them automatically.</p>
			<h2 id="_idParaDest-77"><a id="_idTextAnchor077"/>Splitting Values</h2>
			<p>This option allows us to split column values into multiple sub-values. This can be useful in scenarios where multiple values are stored as a single value based on a delimiter such as , or |.  Sometimes, to optimize data storage, multiple values may be stored as a combined column.</p>
			<p>Consider the next example of <code>Product ID</code>, which contains a combination of <code>Category</code>, <code>Sub-Category</code>, and the actual <code>Product ID</code> fields:</p>
			<div><div><img src="img/B16342_03_62.jpg" alt="Figure 3.62: Combined column value example&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.62: Combined column value example</p>
			<h2 id="_idParaDest-78"><a id="_idTextAnchor078"/>Exercise 3.07: Splitting Columns</h2>
			<p>Imagine that due to storage size restrictions, you maintain a highly optimized database and make sure it does not consist of duplicate data.  You only have the <code>Product ID</code> column available. , To obtain the <code>Category</code> and <code>Sub-Category</code> columns, you might split the <code>Product ID</code><code> </code>column using the <code>Split Values</code> option. The following steps will help you complete this exercise:</p>
			<ol>
				<li value="1">The <code>Split Values</code> option can be accessed by clicking on the <code>â¦</code> icon and selecting <code>Split Values</code>. There are two options available: <code>Automatic Split</code> and <code>Custom Split</code>.</li>
			</ol>
			<div><div><img src="img/B16342_03_63.jpg" alt="Figure 3.63: Various Split Values methods&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.63: Various Split Values methods</p>
			<ol>
				<li value="2"><code>Automatic Split</code> can be applied when you need to split the entire column into multiple parts using a delimiter. If you require <code>Product ID</code> to be split into three parts, you can use this option. Select <code>Automatic Split</code> on this column and view the results:</li>
			</ol>
			<div><div><img src="img/B16342_03_64.jpg" alt="Figure 3.64: Applying automatic split on the Product ID column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.64: Applying automatic split on the Product ID column</p>
			<p>You can see in the next screenshot that <code>Product ID</code> is now split into three parts using the hyphen (<code>-</code>) separator:</p>
			<div><div><img src="img/B16342_03_65.jpg" alt="Figure 3.65: Result of an automatic split on the Product ID column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.65: Result of an automatic split on the Product ID column</p>
			<ol>
				<li value="3">Now, suppose you want to have another column consisting of just <code>Product Category</code>. This is the first part of the <code>Product ID</code> column. Apply the <code>Custom Split</code> on <code>Product ID</code> to fetch the first part, which is the category. Use <em class="italic">Ctrl</em> + <em class="italic">Z</em> if you are using a PC (it's <em class="italic">Cmmd</em> + Z on a Mac) to revert to the original column and then apply <code>Custom Split</code>, as follows:</li>
			</ol>
			<div><div><img src="img/B16342_03_66.jpg" alt="Figure 3.66: Applying Custom Split on the Product ID column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.66: Applying Custom Split on the Product ID column</p>
			<ol>
				<li value="4">Enter the separator (<code>-</code>) along with the split number required, as follows:</li>
			</ol>
			<div><div><img src="img/B16342_03_67.jpg" alt="Figure 3.67: Custom Split properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.67: Custom Split properties</p>
			<p>You will now see a new column that consists of the product category, as follows:</p>
			<div><div><img src="img/B16342_03_68.jpg" alt="Figure 3.66: Applying Custom Split on the Product ID column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.68: Custom split results on the Product ID column</p>
			<p>This concludes the discussion on all the clean operations that you can perform on your data. You learned the various ways to clean the data using group, clean, and split. Next, you will learn about data transformation steps such as aggregation, pivot, join, and union.</p>
			<h1 id="_idParaDest-79"><a id="_idTextAnchor079"/>Aggregation, Pivot, Join, and Union</h1>
			<p>You will often encounter certain scenarios where the data might need to be adjusted to suit the visualization requirements. For example, if you are analyzing the monthly sales for your company, you don't need the data for every single day. In this case, you need to aggregate data to the monthly level. This also reduces the amount of data being used for analysis.</p>
			<p>Another example, is when the data for all the past years is stored as standalone files, and the current year is stored as a separate file. All the files have a similar column structure. If you were to analyze all the data together, you may need to perform a union transformation to combine all these separate files into a single file.</p>
			<p>Such data transformations can be done in Prep. You will now learn about how to doÂ them.</p>
			<h2 id="_idParaDest-80"><a id="_idTextAnchor080"/>Aggregations</h2>
			<p>Aggregations help to change the granularity of data. Granularity, in this context, means the level at which the data is available. For example, consider two files. One file consists of customer information such as customer ID, customer name, address, and joining date. The other table consists of transactional information that the customer has made, such as the number of orders of a particular product. The exercise explores this option in detail.</p>
			<h2 id="_idParaDest-81"><a id="_idTextAnchor081"/>Exercise 3.08: Identifying High-Value Customers Based on Purchases</h2>
			<p>Suppose your task is to identify high-value customers based on their purchases. To do that, you need to first roll up the transactions file to sum the value of all purchases for each customer ID and then join it with the customer information table. In this exercise, you will connect with the <code>Orders_South</code> data and aggregate the <code>Profit</code> values in the <code>Category</code> and <code>Ship Mode</code> columns:</p>
			<ol>
				<li value="1">You will continue with the same workflow. Click on the <code>+</code> icon and selectÂ <code>Aggregate</code>:</li>
			</ol>
			<div><div><img src="img/B16342_03_69.jpg" alt="Figure 3.69: Adding an Aggregate step to the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.69: Adding an Aggregate step to the workflow</p>
			<ol>
				<li value="2">This will add an <code>Aggregate</code> step to the workflow. Click on it, and select the grouped fields and the aggregated fields. You will see the following on yourÂ screen:</li>
			</ol>
			<div><div><img src="img/B16342_03_70.jpg" alt="Figure 3.70: The Aggregate step added to the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.70: The Aggregate step added to the workflow</p>
			<p>The dimensions or text columns indicated by the <code>Abc</code> icon or date columns will act as the <code>Grouped Fields</code>, while the measures or numerical columns indicated by <code>#</code> will be the <code>Aggregated Fields</code>. You can only group text or date columns with numerical columns to form an aggregation.</p>
			<div><div><img src="img/B16342_03_71.jpg" alt="Figure 3.71: Aggregate step properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.71: Aggregate step properties</p>
			<ol>
				<li value="3">Change the aggregation type by clicking on the field as follows:</li>
			</ol>
			<div><div><img src="img/B16342_03_72.jpg" alt="Figure 3.72: Various aggregation methods&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.72: Various aggregation methods</p>
			<ol>
				<li value="4">Aggregate the data based on sales, grouped per <code>Category</code>. Since <code>Category</code> is a dimension, it will be under <code>Grouped Fields,</code> and <code>Profit</code> will be under the aggregated fields (since it is a measure). Double-click on <code>Category</code> to add it under <code>Grouped Fields</code> and, similarly, double-click on <code>Profit</code> to add it under <code>Aggregated Fields</code>:</li>
			</ol>
			<div><div><img src="img/B16342_03_73.jpg" alt="Figure 3.73: Adding grouped and aggregated fields&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.73: Adding grouped and aggregated fields</p>
			<ol>
				<li value="5">Now the data is grouped by the various <code>Category</code> values and <code>Profit</code>. To add another dimension to the group, you can double-click and add it to the grouped field section. Now, add <code>Ship Mode</code> to <code>Grouped Fields</code>:</li>
			</ol>
			<div><div><img src="img/B16342_03_74.jpg" alt="Figure 3.74: Multiple grouped fields aggregation results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.74: Multiple grouped fields aggregation results</p>
			<ol>
				<li value="6">In addition to cleaning, the clean step also allows you to preview our data. Now add a clean step to this aggregation and preview the data. Toggle to display the data grid using the option highlighted in this screenshot:<div><img src="img/B16342_03_75.jpg" alt="Figure 3.75: Full data preview based on the results of the aggregation step&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">Figure 3.75: Full data preview based on the results of the aggregation step</p>
			<p>You have aggregated the data at the <code>Category</code> and <code>Ship Mode</code> level based on the <code>Profit</code> values. In this section, you learned how to aggregate data based on the different levels of granularity. Next, you will learn how to pivot data.</p>
			<h2 id="_idParaDest-82"><a id="_idTextAnchor082"/>Pivoting Data</h2>
			<p>Sometimes, data is stored in a wide manner as opposed to the tall manner required in Tableau. A wider manner indicates that the data is stored in a horizontal format. An example is the item category and the units sold for various years in Figure 3.76. Here, the data for a category is stored in multiple year columns, indicating a wide format.</p>
			<div><div><img src="img/B16342_03_76.jpg" alt="Figure 3.76: Wide format&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.76: Wide format</p>
			<p>Data in tall format indicates a vertical spread. This means that the different values for an item category would be stored in the same <code>Category</code> column. As indicated in Figure 3.77, all the years are in a single <code>Year</code> column and all the units sold values are in a <code>Units Sold</code> column:</p>
			<div><div><img src="img/B16342_03_77.jpg" alt="Figure 3.77: Tall format&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.77: Tall format</p>
			<p>To use data for visualization, Tableau needs the tall format. In this case, you might have to pivot the data to be used in Tableau. You can do that using the pivot step available in Prep, as the next exercise shows.</p>
			<h2 id="_idParaDest-83"><a id="_idTextAnchor083"/>Exercise 3.09: Using a Pivot for Data</h2>
			<p>In this exercise, you will connect to <code>ConsumerPriceIndices_E_All_Data.csv</code> and add a pivot on this data. Follow these steps to complete this exercise:</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Before proceeding with the exercise, make sure to download the CSV file from the GitHub repository for this chapter. You can find the data file at <a href="https://packt.link/LUsoU">https://packt.link/LUsoU</a>.</p>
			<ol>
				<li value="1">Connect to the <code>ConsumerPriceIndices_E_All_Data.csv</code> data source:</li>
			</ol>
			<div><div><img src="img/B16342_03_78.jpg" alt="Figure 3.78: Data in CustomerPriceIndices_E_All_Data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.78: Data in CustomerPriceIndices_E_All_Data</p>
			<p>As you can see, the country data is stored for the different years in different columns (column <code>H</code> to column <code>X</code>). This is an example of wide format. To use this data for visualization and analysis, you need to convert it into tall format.</p>
			<ol>
				<li value="2">Click on <code>Add Connection</code> â <code>Text File</code>. Navigate to the <code>WorldIndicators Files</code> folder, where you can find this file. Click on <code>Open</code> to add it to the flow.</li>
			</ol>
			<p>This will add the data to the flow. You can preview the data by adding a clean step. Once it has been added, click on <code>Clean 4</code> to open the data grid.</p>
			<div><div><img src="img/B16342_03_79.jpg" alt="Figure 3.79: Adding a clean step&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.79: Adding a clean step</p>
			<p>You will observe that the various year values are stored in different columns rather than different rows, as you saw in the Excel data preview in <em class="italic">Figure 3.78</em>. Also, the null values are the blank records where there is no data present:</p>
			<div><div><img src="img/B16342_03_80.jpg" alt="Figure 3.80: Data preview for year values stored horizontally&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.80: Data preview for year values stored horizontally</p>
			<ol>
				<li value="3">Make sure it is similar to the <code>Months</code> column values (that is, in a single column):</li>
			</ol>
			<div><div><img src="img/B16342_03_81.jpg" alt="Figure 3.81: Tall format representation by the Months column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.81: Tall format representation by the Months column</p>
			<ol>
				<li value="4">Do that by clicking on <code>+</code> and adding a <code>Pivot</code> step:</li>
			</ol>
			<div><div><img src="img/B16342_03_82.jpg" alt="Figure 3.82: Pivot step properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.82: Pivot step properties</p>
			<ol>
				<li value="5">Next, drag the fields that you want to pivot, that is, all the year fields. Do that by selecting all the year columns. Use <em class="italic">Ctrl</em> + click to multi-select and drag them to the <code>Pivoted Fields</code> area:</li>
			</ol>
			<div><div><img src="img/B16342_03_83.jpg" alt="Figure 3.83: Adding columns to pivot&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.83: Adding columns to pivot</p>
			<ol>
				<li value="6">Rename these new columns. If you wanted to add one more pivoted field, you can do it by clicking on the <code>+</code> icon and adding another pivot to your data. </li>
			</ol>
			<div><div><img src="img/B16342_03_84.jpg" alt="Figure 3.84: Adding additional columns to the pivot table&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.84: Adding additional columns to the pivot table</p>
			<ol>
				<li value="7">Now, add a clean step to this pivot, and preview the data. Scroll down the data preview window and observe the different values:</li>
			</ol>
			<div><div><img src="img/B16342_03_85.jpg" alt="Figure 3.85: Data preview after completing the pivot transformation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.85: Data preview after completing the pivot transformation</p>
			<p>You have pivoted data stored as years in various columns to years in a single column. Now you can compare the values for different years to understand the patterns â You will learn about this in further detail in the next chapters. Next, you will learn how to join and union the data.</p>
			<h3 id="_idParaDest-84"><a id="_idTextAnchor084"/>Joining and Union of Data</h3>
			<p>Joining and union of data is similar to that in Tableau Desktop, with some additional features that help to analyze the join results.</p>
			<p>Joining is a way to combine two or more tables into a single table based on certain common fields. The result of this combination contains more columns than the original table, hence it gets extended horizontally. Tableau Prep supports the following join types:</p>
			<div><div><img src="img/B16342_03_86.jpg" alt="Figure 3.86: Types of joins&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.86: Types of joins</p>
			<p>You will now take a closer look at joins with the next examples.</p>
			<h2 id="_idParaDest-85"><a id="_idTextAnchor085"/>Exercise 3.10: Joining Two Data Sources</h2>
			<p>In this exercise, you will join the <code>Orders_Central</code> table with the <code>Return_reason_new</code> table to analyze the order returns. Both the data sources are present in the <code>Superstore Files</code> folder:</p>
			<div><div><img src="img/B16342_03_87.jpg" alt="Figure 3.87: Input file locations&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.87: Input file locations</p>
			<p>Follow these steps to complete this exercise:</p>
			<ol>
				<li value="1">Add the <code>Orders_Central.csv</code> data source using <code>Connect</code> â <code>Text File</code> and select this file. Repeat the same for the <code>Returns</code> data. Use <code>Connect</code> â <code>Microsoft Excel</code> and select the <code>return reasons_new</code> file. </li>
				<li>After adding clean steps for both data sources, you can observe that the <code>Order ID</code> column can be used as a common field to join these two data sources.</li>
			</ol>
			<div><div><img src="img/B16342_03_88.jpg" alt="Figure 3.88: Finding the join column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.88: Finding the join column</p>
			<ol>
				<li value="3">Add a join step after the clean step for <code>Order_Central</code> as follows:</li>
			</ol>
			<div><div><img src="img/B16342_03_89.jpg" alt="Figure 3.89: Adding a join step in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.89: Adding a join step in the workflow</p>
			<ol>
				<li value="4">To do a join, select the step by clicking on it and dropping it on the <code>Join</code> icon. Select the <code>Clean 7</code> step and drag it on the <code>Join</code> step. When this is brought next to the <code>Join</code> icon, three options will pop up: <code>Add</code>, <code>Union</code>, and <code>Join</code>. Drop the <code>Clean 7</code> step on the <code>Add</code> option. Dropping it on the join will add another join step in the flow. You will study the <code>Union</code> option in the next section. </li>
			</ol>
			<div><div><img src="img/B16342_03_90.jpg" alt="Figure 3.90: Join option preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.90: Join option preview</p>
			<ol>
				<li value="5">After adding the join, click on the <code>Join 1</code> window to open the properties:</li>
			</ol>
			<div><div><img src="img/B16342_03_91.jpg" alt="Figure 3.91: Analyzing the join results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.91: Analyzing the join results</p>
			<ol>
				<li value="6">As you can see in the settings, the default join is based on the <code>Row ID</code> column. This needs to be changed to <code>Order ID</code>. To change the join clause, click on the <code>Row ID</code> column to open a popup with the different columns and select <code>OrderÂ ID</code>:</li>
			</ol>
			<div><div><img src="img/B16342_03_92.jpg" alt="Figure 3.92: Changing the join clause&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.92: Changing the join clause</p>
			<p>Once this is done, the workflow will reflect the join based on the <code>Order ID</code> column between the <code>Clean 6</code> and <code>Clean 7</code> steps:</p>
			<div><div><img src="img/B16342_03_93.jpg" alt="Figure 3.93: Join values preview based on changing the join clause&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.93: Join values preview based on changing the join clause</p>
			<p>On your screen, you will see that some values are shown in red on the right-hand side. The red values are the ones that were not joined, and the black ones are the ones that were joined.</p>
			<ol>
				<li value="7">The default join is the inner join, but clicking on the various shaded areas of the join icon can change the join type. There are multiple join types, which will be discussed in detail after this example. Select the blank area of <code>clean 6</code> to change the join type to left, as follows:</li>
			</ol>
			<div><div><img src="img/B16342_03_94.jpg" alt="Figure 3.94: Changing the join type&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.94: Changing the join type</p>
			<p>In the <code>Summary of Join Results</code>, you can see additional information, such as how many records are included and excluded, along with the matched/unmatched records. Based on the join condition, these values will change. You can see that there are <code>2,341</code> orders that have been returned, as indicated by the <code>Join Results</code>:</p>
			<div><div><img src="img/B16342_03_95.jpg" alt="Figure 3.95: Analyzing the join results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.95: Analyzing the join results</p>
			<ol>
				<li value="8">Hover over the bars for more information in the tooltip:</li>
			</ol>
			<div><div><img src="img/B16342_03_96.jpg" alt="Figure 3.96: More details on hovering over the result bars&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.96: More details on hovering over the result bars</p>
			<p>Finally, you have <code>Join Clause Recommendations</code>, which is a list of matching column names that can be used as potential joining clauses.</p>
			<div><div><img src="img/B16342_03_97.jpg" alt="Figure 3.97: Join Clause Recommendations&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.97: Join Clause Recommendations</p>
			<ol>
				<li value="9">As always, add a clean step to preview the joined data:</li>
			</ol>
			<div><div><img src="img/B16342_03_98.jpg" alt="Figure 3.98: Data preview for the join results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.98: Data preview for the join results</p>
			<p>You have now joined the <code>Returns</code> table with the <code>Orders_Central</code> table. You have brought in the records from <code>Orders_Central</code> and only the matching records from <code>return reasons_new</code>. This join has shown the number of orders that were returned. You can further analyze the returns based upon the customer names, product categories and products, and investigate the reasons for the returns.</p>
			<h2 id="_idParaDest-86"><a id="_idTextAnchor086"/>Union</h2>
			<p>A union is a way to combine multiple tables with similar column structures into a single table. Contrary to a join, in a union, you need to add the data rows vertically. A union is performed when instead of joining, you just want to append the data below another data that has similar columns. A very common example of union is when you have two tables containing similar columns but maintained separately to represent different years. For example, you may want to combine order information for multiple years into a consolidated dataset.</p>
			<p>Consider the following tables. Here, the union of A and B results in a single table that contains values from both tables:</p>
			<div><div><img src="img/B16342_03_99.jpg" alt="Figure 3.99: Union of two tables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.99: Union of two tables</p>
			<h2 id="_idParaDest-87"><a id="_idTextAnchor087"/>Exercise 3.11: Union of Tables</h2>
			<p>In this exercise, you will connect the <code>Orders_Central</code> data with <code>Orders_East</code> to unite these tables into a single table. Both tables consist of similar columns consisting of order-level information, as shown in the following screenshot:</p>
			<div><div><img src="img/B16342_03_100.jpg" alt="Figure 3.100: Data preview for Orders_Central&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.100: Data preview for Orders_Central</p>
			<div><div><img src="img/B16342_03_101.jpg" alt="Figure 3.101: Data preview for Orders_East&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.101: Data preview for Orders_East</p>
			<p>You can see that both files have similar columns. The goal here is to combine these tables to get a single unified data file. Follow these steps to union these data sources:</p>
			<ol>
				<li value="1">Access both data files from the <code>Superstore Files</code> folder:</li>
			</ol>
			<div><div><img src="img/B16342_03_102.jpg" alt="Figure 3.102: File location for the input files&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.102: File location for the input files</p>
			<p>You already have the data source <code>Orders_Central.csv</code> in the flow from the previous example.</p>
			<ol>
				<li value="2">Add the <code>Orders_East</code> data. Use <code>Connect</code> â <code>Microsoft Excel</code> and select this file. The flow should look like this after adding that step:</li>
			</ol>
			<div><div><img src="img/B16342_03_103.jpg" alt="Figure 3.103: Workflow after file the input step&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.103: Workflow after file the input step</p>
			<ol>
				<li value="3">Observe that the majority of the column names are the same, which means that you can unite these data sources. The ones that do not match are highlighted in both tables, as shown in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B16342_03_104.jpg" alt="Figure 3.104: Columns not matching in the two datasets&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.104: Columns not matching in the two datasets</p>
			<ol>
				<li value="4">Drag the clean step from <code>Orders_East</code> over the clean step of <code>Orders_Central</code> and onto the union step:</li>
			</ol>
			<div><div><img src="img/B16342_03_105.jpg" alt="Figure 3.105: Adding a union in the workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.105: Adding a union in the workflow</p>
			<ol>
				<li value="5">A new union step will be added with the two data sources indicated by the colored columns:</li>
			</ol>
			<div><div><img src="img/B16342_03_106.jpg" alt="Figure 3.106: Analyzing the union results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.106: Analyzing the union results</p>
			<p>You can see that there are 13 mismatched fields.</p>
			<ol>
				<li value="6">Certain columns, such as <code>Discounts</code> (<code>Orders_Central</code>) and <code>Discount</code> (<code>Orders_East</code>), refer to the same column. Similarly, <code>Product</code> (<code>Orders_Central</code>) and <code>Product Name</code> (<code>Orders_East</code>) are the same columns. Merge them into a single column, as follows.</li>
			</ol>
			<div><div><img src="img/B16342_03_107.jpg" alt="Figure 3.107: Identifying similar columns &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.107: Identifying similar columns </p>
			<ol>
				<li value="7">Select <code>Discount</code> first and then hover over the <code>Discounts</code> column and click the <code>+</code> icon. This will merge the two columns into one:</li>
			</ol>
			<div><div><img src="img/B16342_03_108.jpg" alt="Figure 3.108: Merging different Discount columns into a single column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.108: Merging different Discount columns into a single column</p>
			<ol>
				<li value="8">Select <code>Product Name</code>. Prep highlights the other column with the matching word, suggesting a possible match. Now, repeat the same step for <code>Product</code> asÂ well.</li>
			</ol>
			<div><div><img src="img/B16342_03_109.jpg" alt="Figure 3.109: Merging different Product Name columns into a single column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.109: Merging different Product Name columns into a single column</p>
			<ol>
				<li value="9">The <code>Region</code> column is not found in <code>Orders_East</code>, so that can be excluded from the union result. To do this, hover over the <code>Union Results</code> section and remove the <code>Region</code> column, as highlighted in the following screenshot:</li>
			</ol>
			<div><div><img src="img/B16342_03_110.jpg" alt="Figure 3.110: Excluding a column from union results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.110: Excluding a column from union results</p>
			<p>Further cleaning can be done by combining <code>Order Date</code>, <code>Order Year</code>, <code>Order Month</code>, <code>Order Day</code>, and <code>Ship Date</code> using the clean step.</p>
			<div><div><img src="img/B16342_03_111.jpg" alt="Figure 3.111: Mismatched columns that can be merged using the clean operations&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.111: Mismatched columns that can be merged using the clean operations</p>
			<ol>
				<li value="10">Once done, add a clean step to the union to preview the data. You can see that Prep has added a column named <code>Table Names</code> to indicate which table the data comes from:</li>
			</ol>
			<div><div><img src="img/B16342_03_112.jpg" alt="Figure 3.112: Union workflow results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.112: Union workflow results</p>
			<p>In this section, you learned how to use the union step to combine data from two sources. Once combined, the resulting data source can be used for performing comparative analysis through visualizations. You also saw how to merge mismatched column names. Next, you will learn about the script step. Note that this is not used very often as it is a very advanced step in which complex statistical programs are required to run on the input using R or Python scripts. Therefore, this will be a purely theoretical discussion.</p>
			<h2 id="_idParaDest-88"><a id="_idTextAnchor088"/>Script Step</h2>
			<p>A script allows you to run external programs written in R or Python. Sometimes, complex statistical computations on the data that cannot be done using Prep might be required. Hence, Prep allows you to integrate these programs into the workflow using the script step.</p>
			<p>Before adding the script, you need to establish the connection for R or Python programs using Rserve or TabPy. You can do so using the <code>Help</code> menu and the <code>Settings and Performance</code> option by going to <code>Help</code> â <code>Setting and Performance</code> â <code>Manage Analytics Extension Connection</code>:</p>
			<div><div><img src="img/B16342_03_113.jpg" alt="Figure 3.113: Script window properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.113: Script window properties</p>
			<p>Now you can add the server details for R or Python. Once this is done, you can add the script step in the flow. This will open the following window:</p>
			<div><div><img src="img/B16342_03_114.jpg" alt="Figure 3.114: Script connection settings&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.114: Script connection settings</p>
			<p>Here, you can add the program file and specify which function needs to run on the data. For further details, you can click the <code>Learn more</code> link.</p>
			<h1 id="_idParaDest-89"><a id="_idTextAnchor089"/>Flow and Data Exports</h1>
			<p>Once you have finished creating a workflow, you need to export the data or share the workflow so that it can be used in data analysis and visualization in Tableau Desktop. You will learn about the following exporting options in this section:</p>
			<ul>
				<li>Flow saving options</li>
				<li>Data export options</li>
			</ul>
			<p>Flow saving options: The workflow can be saved in two formats: <code>.tflx</code> and <code>.tfl</code>. If you are working by yourself and have all the data in your system, you can save the flow in the Tableau Prep Builder flow (<code>.tfl</code>) file format. If you want to share the flow along with the data used in it, use the <code>.tflx</code> format, which will combine or package all underlying local files used in the flow, such as the Excel, text, or Tableau extract file, into a single flow file to be shared. Note that only local files can be packaged into a flow. Data from database connections isn't included.</p>
			<p>To save a flow, click on the <code>File</code> menu, go to <code>Save As</code>, and select the formatÂ required.</p>
			<div><div><img src="img/B16342_03_115.jpg" alt="Figure 3.115: Saving a workflow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.115: Saving a workflow</p>
			<p>The next exercise looks at data export options in detail.</p>
			<h2 id="_idParaDest-90"><a id="_idTextAnchor090"/>Exercise 3.12: Exporting Data</h2>
			<p>Once you have completed the data transformation steps in Prep, the last thing to do is to export this data so that it can be used to develop visualizations. The <code>Output</code> step allows you to export the data in multiple formats. In this exercise, you will export the data using the <code>Output</code> step.</p>
			<ol>
				<li value="1">Continuing from the previous example, add an <code>Output</code> step to the <code>Union</code> step by clicking on the <code>+</code> and then selecting <code>Output</code>:</li>
			</ol>
			<div><div><img src="img/B16342_03_116.jpg" alt="Figure 3.116: Adding an output step&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.116: Adding an output step</p>
			<p>Once this is done, you will see the following window:</p>
			<div><div><img src="img/B16342_03_117.jpg" alt="Figure 3.117: Output step properties&#13;&#10;"/>
				</div>
			</div>
			<p> </p>
			<p class="figure-caption">Figure 3.117: Output step properties</p>
			<ol>
				<li value="2">Save the output in various formats, as the following screenshot shows:</li>
			</ol>
			<div><div><img src="img/B16342_03_118.jpg" alt="Figure 3.118: Formats for saving the flow output&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.118: Formats for saving the flow output</p>
			<p>Here, you will be saving it as the <code>File</code> format, but it's important to also know about the other formats.</p>
			<ol>
				<li value="3">Save it as a <code>Published data source</code> on Tableau Server, as a database table in a database such as SQL Server, or elsewhere, as follows:</li>
			</ol>
			<div><div><img src="img/B16342_03_119.jpg" alt="Figure 3.119: File formats for saving output on Tableau Server&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.119: File formats for saving output on Tableau Server</p>
			<ol>
				<li value="4">Select <code>File</code> and then select the folder to save to. Enter the output name and set the output type to CSV. You will also see another option, <code>.hyper</code> format, which can be used in Tableau Desktop as an extract.</li>
			</ol>
			<div><div><img src="img/B16342_03_120.jpg" alt="Figure 3.120: CSV file format for saving output&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.120: CSV file format for saving output</p>
			<ol>
				<li value="5">Click on <code>Run Flow</code> and save the output.</li>
			</ol>
			<div><div><img src="img/B16342_03_121.jpg" alt="Figure 3.121: Running the flow&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.121: Running the flow</p>
			<ol>
				<li value="6">Once done, navigate to the folder location and check the file:</li>
			</ol>
			<div><div><img src="img/B16342_03_122.jpg" alt="Figure 3.122: Workflow output preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.122: Workflow output preview</p>
			<ol>
				<li value="7">When the output type is CSV, the <code>Full refresh</code> option that you can see in <em class="italic">Figure 3.122</em> will overwrite the output file when the flow is run again. If the <code>.hyper</code> output format is selected, you can choose to append the new data to the existing extract as well.</li>
			</ol>
			<div><div><img src="img/B16342_03_123.jpg" alt="Figure 3.123: Adding new output to existing saved output&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.123: Adding new output to existing saved output</p>
			<p>Now that you have learned about the different ways to transform data, it's time to get some hands-on practice on some project-based scenarios.</p>
			<h2 id="_idParaDest-91"><a id="_idTextAnchor091"/>Activity 3.01: Finding the Month with the Highest Orders</h2>
			<p>As a store manager, you will have come across situations in which you would like to assess your store's performance by its sales. Hence, it is important to analyze patterns in the sales of the products. Further, you can also identify the products that sell more compared to other products, and this analysis can help to further increase their sales. Additionally, you want to know if there is a pattern in how the products sell in different months. If a pattern exists, then it can be analyzed and used to design strong marketing strategies to boost the store's sales and revenue.</p>
			<p>Usually, the order information is kept separate from the product information. This is to keep the data optimized.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The data that you will use in this activity is stored in <code>Activity File.xlsx</code>. The <code>Orders</code> sheet contains the <code>Order ID</code> and the <code>Product</code> categories. You can download the Excel file from the GitHub repository for this chapter at <a href="https://packt.link/iWtp4">https://packt.link/iWtp4</a>.</p>
			<div><div><img src="img/B16342_03_124.jpg" alt="Figure 3.124: Orders sheet preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.124: Orders sheet preview</p>
			<p>As you can see, the <code>Order ID</code> column is a combination of the ID, month, and year of each order. <code>Product Category</code> is an ID column. Further details about this can be found in the <code>Product Category</code> sheet:</p>
			<div><div><img src="img/B16342_03_125.jpg" alt="Figure 3.125: Product Category sheet preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.125: Product Category sheet preview</p>
			<p>To complete this activity successfully, you need to apply your knowledge of splits, joins, and cleaning to identify important sales trends. Specifically, you need to answer the following questions:</p>
			<p>Which month and year combination has the highest orders?</p>
			<p>Which product category has the highest orders?</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The solution to this activity can be found here: <a href="https://packt.link/CTCxk">https://packt.link/CTCxk</a>. </p>
			<h2 id="_idParaDest-92"><a id="_idTextAnchor092"/>Activity 3.02: Data Transformation</h2>
			<p>Now you know about the trends for various products, it would be useful to analyze customer information to better understand customer behavior towards each product. With the results of this analysis, you can design customized offers and coupons that can enhance a customer's shopping experience. This will also help create brand affinity with the customers, which can eventually lead to an increase in sales. In this activity, you will combine customer information with the previous workflow to get a unified view of orders, products, and customers. You will continue using the same Excel sheet from the previous activity to complete this one.</p>
			<p>The customer order information is stored in the <code>CustomerOrders</code> sheet, as shown in the following screenshot:</p>
			<div><div><img src="img/B16342_03_126.jpg" alt=" Figure 3.126: CustomerOrders sheet preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> Figure 3.126: CustomerOrders sheet preview</p>
			<p>You can see that the data is stored in a wide format, that is, it is spread horizontally across different years for each customer. You will need to pivot this data to use it in the workflow.</p>
			<p>Next, you must join this information with the <code>CustomerNames</code> sheet, which looks like the following:</p>
			<div><div><img src="img/B16342_03_127.jpg" alt="Figure 3.127: CustomerNames sheet preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.127: CustomerNames sheet preview</p>
			<p>In this activity, your goal is to identify the top five high-value customers, based on the number of orders. </p>
			<p>You also need to export this data so that you can analyze it better using visualizations in Tableau Desktop.</p>
			<div><div><img src="img/B16342_03_128.jpg" alt="Figure 3.128: Activity 2 output sheet preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.128: Activity 2 output sheet preview</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The solution to this activity can be found here: <a href="https://packt.link/CTCxk">https://packt.link/CTCxk</a>.</p>
			<h1 id="_idParaDest-93"><a id="_idTextAnchor093"/>Summary</h1>
			<p>In this chapter, you learned how to connect to various data sources. After connecting to the data, you learned how to analyze it using data profiling. Then, you learned to clean the data using various methods, such as filtering, creating calculations, groups, and splits. Cleaning data is a prerequisite for effective data analysis, and you will be using these methods throughout the remainder of this book.</p>
			<p>Once you cleaned the data, you looked at ways to group data using aggregation, and then learned to transform it with pivots. You also combined multiple data sources using the join and union options. Finally, you learned about how to save, share, and export your workflow and the data.</p>
			<p>The key takeaway from this chapter is how to transform data efficiently based on the project requirements so that it becomes fit for visualization. In the next chapter, you will use the skills you have learned in this chapter, such as aggregation, joins, and groups, to create charts in Tableau.</p>
		</div>
		<div><div></div>
		</div>
	</body></html>