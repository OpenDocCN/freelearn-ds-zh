<html><head></head><body><div class="preface" title="Preface"><div class="titlepage"><div><div><h1 class="title"><a id="pref05"/>Preface</h1></div></div></div><p>Welcome to the <span class="emphasis"><em>OpenCL Parallel Programming Development Cookbook</em></span>! Whew, that was more than a mouthful. This book was written by a developer, that's me, and for a developer, hopefully that's you. This book will look familiar to some and distinct to others. It is a result of my experience with OpenCL, but more importantly in programming heterogeneous computing environments. I wanted to organize the things I've learned and share them with you, the reader, and decided upon taking an approach where each problem is categorized into a recipe. These recipes are meant to be concise, but admittedly some are longer than others. The reason for doing that is because the problems I've chosen, which manifest as chapters in this book describe how you can apply those techniques to your current or future work. Hopefully it can be a part of the reference, which rests on your desk among others. I certainly hope that understanding the solution to these problems can help you as much as they helped me.</p><p>This book was written keeping a software developer in mind, who wishes to know not only how to program in parallel but also think in parallel. The latter is in my opinion more important than the former, but neither of them alone solves anything. This book reinforces each concept with code and expands on that as we leverage upon more recipes.</p><p>This book is structured to ease you gently into OpenCL by getting you to be familiar with the core concepts of OpenCL, and then we'll take deep dives by applying that newly gained knowledge into the various recipes and general parallel computing problems you'll encounter in your work.</p><p>To get the most out of this book, it is highly recommended that you are a software developer or an embedded software developer, and is interested in parallel software development but don't really know where/how to start. Ideally, you should know some C or C++ (you can pick C up since its relatively simple) and comfortable using a cross-platform build system, for example, CMake in Linux environments. The nice thing about CMake is that it allows you to generate build environments for those of you who are comfortable using Microsoft's Visual Studio, Apple's XCode, or some other integrated development environment. I have to admit that the examples in this book used neither of these tools.</p><div class="section" title="What this book covers"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec02"/>What this book covers</h1></div></div></div><p><a class="link" href="ch01.html" title="Chapter 1. Using OpenCL">Chapter 1</a>, <span class="emphasis"><em>Using OpenCL</em></span>, sets the stage for the reader by establishing OpenCL in its purpose and motivation. The core concepts are outlined in the recipes covering the intrinsics of devices and their interactions and also by real working code. The reader will learn about contexts and devices and how to create code that runs on those devices.</p><p><a class="link" href="ch02.html" title="Chapter 2. Understanding OpenCL Data Transfer and Partitioning">Chapter 2</a>, <span class="emphasis"><em>Understanding OpenCL Data Transfer and Partitioning</em></span>, discusses the buffer objects in OpenCL and strategies on how to partition data amongst them. Subsequently, readers will learn what work items are and how data partitioning can take effect by leveraging OpenCL abstractions.</p><p><a class="link" href="ch03.html" title="Chapter 3. Understanding OpenCL Data Types">Chapter 3</a>, <span class="emphasis"><em>Understanding OpenCL Data Types</em></span>, explains the two general data types that OpenCL offers, namely scalar and vector data types, how they are used to solve different problems, and how OpenCL abstracts native vector architectures in processors. Readers will be shown how they can effect programmable vectorization through OpenCL.</p><p><a class="link" href="ch04.html" title="Chapter 4. Using OpenCL Functions">Chapter 4</a>, <span class="emphasis"><em>Understanding OpenCL Functions</em></span>, discusses the various functionalities offered by OpenCL in solving day-to-day problems, for example, geometry, permuting, and trigonometry. It also explains how to accelerate that by using their vectorized counterparts.</p><p><a class="link" href="ch05.html" title="Chapter 5. Developing a Histogram OpenCL program">Chapter 5</a>, <span class="emphasis"><em>Developing a Histogram OpenCL program</em></span>, witnesses the lifecycle of a typical OpenCL development. It also discusses about the data partitioning strategies that rely on being cognizant of the algorithm in question. The readers will inadvertently realize that not all algorithms or problems require the same approach.</p><p><a class="link" href="ch06.html" title="Chapter 6. Developing a Sobel Edge Detection Filter">Chapter 6</a>, <span class="emphasis"><em>Developing a Sobel Edge Detection Filter</em></span>, will guide you in how to build an edge detection filter using the Sobel's method. They will be introduced into some mathematical formality including convolution theory in one-dimension and two-dimensions and its accompanying code. And finally, we introduce how profiling works in OpenCL and its application in this recipe.</p><p><a class="link" href="ch07.html" title="Chapter 7. Developing the Matrix Multiplication with OpenCL">Chapter 7</a>, <span class="emphasis"><em>Developing the Matrix Multiplication with OpenCL</em></span>, discusses parallelizing the matrix multiplication by studying its parallel form and applying the tranformation from sequential to parallel. Next, it'll optimize the matrix multiplication by discussing how to increase the computation throughput and warming the cache.</p><p><a class="link" href="ch08.html" title="Chapter 8. Developing the Sparse Matrix Vector Multiplication in OpenCL">Chapter 8</a>, <span class="emphasis"><em>Developing the Sparse Matrix-Vector Multiplication with OpenCL</em></span>, discusses the context of this computation and the conventional method used to solve it, that is, the conjugate gradient through enough math. Once that intuition is developed, readers will be shown how various storage formats for sparse matrices can affect the parallel computation and then the readers can examine the ELLPACK, ELLPACK-R, COO, and CSR.</p><p><a class="link" href="ch09.html" title="Chapter 9. Developing the Bitonic Sort with OpenCL">Chapter 9</a>, <span class="emphasis"><em>Developing Bitonic Sort Using OpenCL</em></span>, will introduce readers, to the world of sorting algorithms, and focus on the parallel sorting network also known as bitonic sort. This chapter works through the recipes, as we did in all other chapters by presenting the theory and its sequential implementation, and extracting the parallelism from the transformation, and then developing the final parallel version.</p><p><a class="link" href="ch10.html" title="Chapter 10. Developing the Radix Sort with OpenCL">Chapter 10</a>, <span class="emphasis"><em>Developing the Radix Sort with OpenCL</em></span>, will introduce a classic example of non-comparison based sorting algorithms, for example, QuickSort where it suits a GPU architecture better. The reader is also introduced to another core parallel programming technique known as reduction, and we developed the intuition of how reduction helps radix sort perform better. The radix sort recipe also demonstrates multiple kernel programming and highlights the advantages as well as the disadvantages.</p></div></div>
<div class="section" title="What you need for this book"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec03"/>What you need for this book</h1></div></div></div><p>You need to be comfortable working in a Linux environment, as the examples are tested against the Ubuntu 12.10 64-bit operating system. The following are the requirements:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">GNU GCC C/C++ compiler Version 4.6.1 (at least)</li><li class="listitem" style="list-style-type: disc">OpenCL 1.2 SDK by AMD, Intel &amp; NVIDIA</li><li class="listitem" style="list-style-type: disc">AMD APP SDK Version 2.8 with AMD Catalyst Linux Display Driver Version 13.4</li><li class="listitem" style="list-style-type: disc">Intel OpenCL SDK 2012</li><li class="listitem" style="list-style-type: disc">CMake Version 2.8 (at least)</li><li class="listitem" style="list-style-type: disc">Clang Version 3.1 (at least)</li><li class="listitem" style="list-style-type: disc">Microsoft Visual C++ 2010 (if you work on Windows)</li><li class="listitem" style="list-style-type: disc">Boost Library Version 1.53</li><li class="listitem" style="list-style-type: disc">VexCL (by Denis Demidov)</li><li class="listitem" style="list-style-type: disc">CodeXL Profiler by AMD (Optional)</li><li class="listitem" style="list-style-type: disc">At least eight hours of sleep</li><li class="listitem" style="list-style-type: disc">An open and receptive mind</li><li class="listitem" style="list-style-type: disc">A fresh brew of coffee or whatever that works</li></ul></div></div>
<div class="section" title="Who this book is for"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec04"/>Who this book is for</h1></div></div></div><p>This book is intended for software developers who have often wondered what to do with that newly bought CPU or GPU they bought other than using it for playing computer games. Having said that, this book isn't about toy algorithms that works only on your workstations at home. This book is ideally for the developers who have a working knowledge of C/C++ and who want to learn how to write parallel programs that execute in heterogeneous computing environments in OpenCL.</p></div>
<div class="section" title="Conventions"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec05"/>Conventions</h1></div></div></div><p>In this book, you will find a number of styles of text that distinguish between different kinds of information. Here are some examples of these styles, and an explanation of their meaning.</p><p>Code words in text are shown as follows: "We can include other contexts through the use of the <code class="literal">#include</code> directive."</p><p>A block of code is set as follows:</p><div class="informalexample"><pre class="programlisting">[default]
cl_uint sortOrder = 0; // descending order else 1 for ascending order
        cl_uint stages = 0;
        for(unsigned int i = LENGTH; i &gt; 1; i &gt;&gt;= 1)
            ++stages;
        clSetKernelArg(kernel, 0, sizeof(cl_mem),(void*)&amp;device_A_in);
        clSetKernelArg(kernel, 3, sizeof(cl_uint),(void*)&amp;sortOrder);
#ifdef USE_SHARED_MEM
        clSetKernelArg(kernel, 4, (GROUP_SIZE &lt;&lt; 1) *sizeof(cl_uint),NULL);
#elif def USE_SHARED_MEM_2</pre></div><p>When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold:</p><div class="informalexample"><pre class="programlisting">[default]
cl_uint sortOrder = 0; // descending order else 1 for ascending order
        cl_uint stages = 0;
        for(unsigned int i = LENGTH; i &gt; 1; i &gt;&gt;= 1)
            ++stages;
        clSetKernelArg(kernel, 0, sizeof(cl_mem),(void*)&amp;device_A_in);
        clSetKernelArg(kernel, 3, sizeof(cl_uint),(void*)&amp;sortOrder);
#ifdef USE_SHARED_MEM
        clSetKernelArg(kernel, 4, (GROUP_SIZE &lt;&lt; 1) *sizeof(cl_uint),NULL);
#elif def USE_SHARED_MEM_2</pre></div><p>Any command-line input or output is written as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong># gcc –Wall test.c –o test</strong></span>
</pre></div><p>New terms and important words are shown in bold. Words that you see on the screen, in menus or dialog boxes for example, appear in the text like this: "clicking on the <span class="strong"><strong>Next</strong></span> button moves you to the next screen".</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note01"/>Note</h3><p>Warnings or important notes appear in a box like this.</p></div></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip01"/>Tip</h3><p>Tips and tricks appear like this.</p></div></div></div>
<div class="section" title="Reader feedback"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec06"/>Reader feedback</h1></div></div></div><p>Feedback from our readers is always welcome. Let us know what you think about this book—what you liked or may have disliked. Reader feedback is important for us to develop titles that you really get the most out of.</p><p>To send us general feedback, simply send an e-mail to <code class="email">&lt;<a class="email" href="mailto:feedback@packtpub.com">feedback@packtpub.com</a>&gt;</code>, and mention the book title via the subject of your message.</p><p>If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, see our author guide on <a class="ulink" href="http://www.packtpub.com/authors">www.packtpub.com/authors</a>.</p></div>
<div class="section" title="Customer support"><div class="titlepage"><div><div><h1 class="title"><a id="ch00lvl1sec07"/>Customer support</h1></div></div></div><p>Now that you are the proud owner of a Packt book, we have a number of things to help you to get the most from your purchase.</p><div class="section" title="Downloading the example code"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec03"/>Downloading the example code</h2></div></div></div><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div><div class="section" title="Errata"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec04"/>Errata</h2></div></div></div><p>Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you find a mistake in one of our books—maybe a mistake in the text or the code—we would be grateful if you would report this to us. By doing so, you can save other readers from frustration and help us improve subsequent versions of this book. If you find any errata, please report them by visiting <a class="ulink" href="http://www.packtpub.com/submit-errata">http://www.packtpub.com/submit-errata</a>, selecting your book, clicking on the <span class="strong"><strong>errata</strong></span> <span class="strong"><strong>submission</strong></span> <span class="strong"><strong>form</strong></span> link, and entering the details of your errata. Once your errata are verified, your submission will be accepted and the errata will be uploaded on our website, or added to any list of existing errata, under the Errata section of that title. Any existing errata can be viewed by selecting your title from <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a>.</p></div><div class="section" title="Piracy"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec05"/>Piracy</h2></div></div></div><p>Piracy of copyright material on the Internet is an ongoing problem across all media. At Packt, we take the protection of our copyright and licenses very seriously. If you come across any illegal copies of our works, in any form, on the Internet, please provide us with the location address or website name immediately so that we can pursue a remedy.</p><p>Please contact us at <code class="email">&lt;<a class="email" href="mailto:copyright@packtpub.com">copyright@packtpub.com</a>&gt;</code> with a link to the suspected pirated material.</p><p>We appreciate your help in protecting our authors, and our ability to bring you valuable content.</p></div><div class="section" title="Questions"><div class="titlepage"><div><div><h2 class="title"><a id="ch00lvl2sec06"/>Questions</h2></div></div></div><p>You can contact us at <code class="email">&lt;<a class="email" href="mailto:questions@packtpub.com">questions@packtpub.com</a>&gt;</code> if you are having a problem with any aspect of the book, and we will do our best to address it.</p></div></div></body></html>