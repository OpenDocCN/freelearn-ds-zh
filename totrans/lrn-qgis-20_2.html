<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Viewing Spatial Data"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Viewing Spatial Data</h1></div></div></div><p>In this chapter, we will cover how to view spatial data from different data sources. QGIS supports many <a id="id65" class="indexterm"/>file and database formats as well as OGC Web Services. We will first see how we can load layers from these different data sources. We will then look into the basics of styling both vector and raster layers and will create our first map, which you can see in the following screenshot. We will finish this chapter with an example for loading background maps from online services.</p><div class="mediaobject"><img src="graphics/7488_02_01.jpg" alt="Viewing Spatial Data"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>For the <a id="id66" class="indexterm"/>examples in this chapter, we will be using sample data provided by the QGIS project and available for download from <a class="ulink" href="http://download.osgeo.org/qgis/data/qgis_sample_data.zip">download.osgeo.org/qgis/data/qgis_sample_data.zip</a> (20 MB). Download and unzip it.</p></div></div><div class="section" title="Loading vector data from files"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec11"/>Loading vector data from files</h1></div></div></div><p>In this<a id="id67" class="indexterm"/> section, we will talk about loading vector data from GIS formats such as Shapefiles as well as from text files.</p><p>We can load<a id="id68" class="indexterm"/> vector files using the menu entry by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Add vector layer</strong></span> and also by using the <span class="strong"><strong>Add vector layer</strong></span> toolbar button. If you like shortcuts, use <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>V</em></span>. In the <span class="strong"><strong>Add vector layer</strong></span> dialog, we find a drop-down list that allows us to specify the encoding of the input file. This option is important if we are dealing with files that contain special characters, such as German umlauts or letters from alphabets other than the default Latin one. The following screenshot shows the <span class="strong"><strong>Add vector layer</strong></span> dialog:</p><div class="mediaobject"><img src="graphics/7488_02_02.jpg" alt="Loading vector data from files"/></div><p>What we are most interested in now is the <span class="strong"><strong>Browse</strong></span> button, which opens the file-opening dialog. Note the <span class="strong"><strong>file type filter</strong></span> drop-down list on the bottom-right corner of the dialog. We can open it to see a list of the supported vector file types. This filter is useful to find specific files faster by hiding all files of a different type, but be aware that the filter settings are stored and will be applied again the next time we open the dialog. </p><p>This can be a source of confusion if we later try to find a different file and it happens to be hidden by the filter, so remember to check the filter settings if you are having trouble locating a file.</p><p>We can load more than one file in one go by selecting multiple files at once (holding down <span class="emphasis"><em>Ctrl</em></span> on Windows/Ubuntu or <span class="emphasis"><em>Cmd</em></span> on Mac). Let's give it a try.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We select <code class="literal">alaska.shp</code> and <code class="literal">airports.shp</code> from the sample data <code class="literal">vmap0_shapefiles</code> folder.</li><li class="listitem">Next, we confirm our selection by clicking on <span class="strong"><strong>Open</strong></span>, and we are taken back to the <span class="strong"><strong>Add vector layer</strong></span> dialog.</li><li class="listitem">After clicking on <span class="strong"><strong>Open</strong></span> once more, the selected files are loaded. You will notice that each vector layer is displayed in a random color. Don't worry about that now. We'll deal with layer styles later in this chapter.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip05"/>Tip</h3><p>There are multiple tricks that make loading data even faster; for example, you can simply drag and drop files from the operating system file browser into QGIS. Another way to quickly access your spatial data is by using QGIS' built-in file browser. If you set up QGIS as shown in <a class="link" href="ch01.html" title="Chapter 1. Getting Started with QGIS">Chapter 1</a>, <span class="emphasis"><em>Getting Started with QGIS</em></span>, you'll find the browser on the left-hand side, just below the layer list. Navigate to your data folder and you can again drag and drop files from the browser to the map. Additionally, you can mark a folder as favorite by right-clicking on the folder and selecting <span class="strong"><strong>Add to favorites</strong></span>. This way, your data folders will be even faster to access because they are added in the <span class="strong"><strong>Favorites</strong></span> section right at the top of the browser list.</p></div></div></li></ol></div><p>Another <a id="id69" class="indexterm"/>popular source of spatial data are delimited text (CSV) files. QGIS can load CSV files using the <span class="strong"><strong>Add Delimited Text Layer</strong></span> option available via the menu entry by going to <span class="strong"><strong>Layers</strong></span> | <span class="strong"><strong>Add Delimited Text Layer</strong></span> or<a id="id70" class="indexterm"/> the corresponding toolbar button. Click on <span class="strong"><strong>Browse</strong></span> and select <code class="literal">elevp.csv</code> from the sample data. CSVs come with all kinds of delimiters. As you can see in the following screenshot, the plugin lets you choose from the most common ones (<span class="strong"><strong>Comma</strong></span>, <span class="strong"><strong>Tab</strong></span>, and so on), but you can also specify any other plain or regular expression delimiter. If your CSV contains quotation marks such as " or ', you can use the <span class="strong"><strong>Quote</strong></span> option to have them removed. The <span class="strong"><strong>Number of header lines to discard</strong></span> option allows us to skip extra lines at the beginning of the text file. The following <span class="strong"><strong>Field options</strong></span> include functionality to trim extra spaces from field values or to redefine the decimal separator to a comma. The spatial information itself can be provided either in two columns containing coordinates of points X and Y or by using the <span class="strong"><strong>Well known text (WKT)</strong></span> format. A<a id="id71" class="indexterm"/> WKT field can contain points, lines, or polygons.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip06"/>Tip</h3><p>WKT is a very useful and flexible format. For example, a line can be specified by writing <code class="literal">LINESTRING (30 10, 10 30, 40 40)</code>. If you are unfamiliar with<a id="id72" class="indexterm"/> the concept, you can find an introduction with examples at <a class="ulink" href="http://en.wikipedia.org/wiki/Well-known_text">en.wikipedia.org/wiki/Well-known_text</a>.</p></div></div><div class="mediaobject"><img src="graphics/7488_02_03.jpg" alt="Loading vector data from files"/></div><p>After<a id="id73" class="indexterm"/> clicking on <span class="strong"><strong>OK</strong></span>, QGIS will prompt us to specify<a id="id74" class="indexterm"/> the <a id="id75" class="indexterm"/>layer's <span class="strong"><strong>coordinate reference system</strong></span> (<span class="strong"><strong>CRS</strong></span>). We will talk about handling coordinate reference systems next.</p></div></div>
<div class="section" title="Dealing with coordinate reference systems"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec12"/>Dealing with coordinate reference systems</h1></div></div></div><p>Whenever we load a data source, QGIS looks for usable CRS information; for example, in the Shapefile's <code class="literal">.prj</code> file<a id="id76" class="indexterm"/>. If QGIS <a id="id77" class="indexterm"/>cannot find any usable information, it will by default ask you to specify the CRS manually. This behavior can be changed by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Options</strong></span> | <span class="strong"><strong>CRS</strong></span> to always use either the project CRS or a default CRS.</p><p>The QGIS<a id="id78" class="indexterm"/> Coordinate Reference System Selector offers a filter that makes finding the CRS easier. It can filter by name or by ID (for example, the EPSG code). Just start typing and watch how the list of potential CRSs gets shorter. There are actually two separate lists: the upper one contains the CRSs we have recently used while the lower list is much longer and contains all available CRSs. For the <code class="literal">elevp.csv</code> file<a id="id79" class="indexterm"/>, we select <span class="strong"><strong>NAD27 / Alaska Albers</strong></span>.</p><p>If we want to check a layer's CRS, we can find this information in the layer properties' <span class="strong"><strong>General</strong></span> section, which can be accessed by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Properties</strong></span> or by double-clicking on the layer name in the layer list. If you think that QGIS picked the wrong CRS or you made<a id="id80" class="indexterm"/> a mistake specifying the CRS, you can correct the CRS settings<a id="id81" class="indexterm"/> using <span class="strong"><strong>Specify CRS</strong></span>. Note that this does not change the underlying data or reproject it. We'll talk about reprojecting vectors and raster files in <a class="link" href="ch03.html" title="Chapter 3. Data Creation and Editing">Chapter 3</a>, <span class="emphasis"><em>Data Creation and Editing</em></span>.</p><p>In QGIS, we can create a map out of multiple layers even if each dataset is stored with a different CRS. QGIS handles the necessary reprojections automatically by enabling a mechanism called on-the-fly reprojection, which can be accessed by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Project Properties</strong></span> as you can see in the following screenshot:</p><p>All layers are reprojected to the project CRS on the fly, which means that QGIS calculates these reprojections dynamically and only for the purpose of rendering the map. The underlying data is not changed and spatial analyses are not affected.</p><div class="mediaobject"><img src="graphics/7488_02_04.jpg" alt="Dealing with coordinate reference systems"/></div><p>In some cases, you might have to specify a CRS that is not available in QGIS' CRS database. You <a id="id82" class="indexterm"/>can add CRS definitions by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Custom CRS</strong></span>. <a id="id83" class="indexterm"/>Click on the <span class="strong"><strong>Add new CRS</strong></span> button to create a new entry, type in a name for the new CRS, and paste the <code class="literal">proj4</code> definition string. Just close the dialog by clicking on <span class="strong"><strong>OK</strong></span> when you are done.</p></div>
<div class="section" title="Loading raster files"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec13"/>Loading raster files</h1></div></div></div><p>Loading raster<a id="id84" class="indexterm"/> files is not much different from loading vector files. Selecting the menu entry <span class="strong"><strong>Layer</strong></span> and then clicking on <span class="strong"><strong>Add Raster Layer</strong></span>, clicking on the <span class="strong"><strong>Add Raster Layer</strong></span> button, or pressing the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>R</em></span> shortcut will take you directly to the file-opening dialog. Again, you can check the file type filter to see a list of supported file types.</p><p>Let's give it a try and load <code class="literal">landcover.img</code> from the sample data <code class="literal">raster</code> folder. Similarly, just like vector files, you can load rasters by dragging them into QGIS from the operating system or the built-in file browser.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>Support for all these different vector and raster file types in QGIS is handled by the<a id="id85" class="indexterm"/> powerful GDAL/OGR package. You <a id="id86" class="indexterm"/>can check the full list of supported formats at <a class="ulink" href="http://www.gdal.org/formats_list.html">www.gdal.org/formats_list.html</a> (for rasters) and <a class="ulink" href="http://www.gdal.org/ogr/ogr_formats.html">www.gdal.org/ogr/ogr_formats.html</a> (for vectors).</p></div></div><div class="section" title="Georeferencing raster maps"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec08"/>Georeferencing raster maps</h2></div></div></div><p>Some raster<a id="id87" class="indexterm"/> data sources, such as simple scanned maps, lack proper spatial referencing, and we have to georeference them before we can use them in a GIS. In QGIS, we can georeference rasters using the Georeferencer GDAL plugin, which can be accessed by going to <span class="strong"><strong>Raster</strong></span> | <span class="strong"><strong>Georeferencer</strong></span> (enable it by going to <span class="strong"><strong>Plugins</strong></span> | <span class="strong"><strong>Manage and Install Plugins</strong></span> if you cannot find it in the <span class="strong"><strong>Raster</strong></span> menu).</p><p>Georeferencer<a id="id88" class="indexterm"/> covers the following use cases:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">We can create a world file for a raster file without altering the original raster.</li><li class="listitem" style="list-style-type: disc">If we have a map image that contains points with known coordinates, we can set<a id="id89" class="indexterm"/> <span class="strong"><strong>ground control points</strong></span> (<span class="strong"><strong>GCPs</strong></span>) and enter the known coordinates.</li><li class="listitem" style="list-style-type: disc">Finally, if we don't know the coordinates of any points on the map, we still have the chance to place GCPs manually using a second, already georeferenced map of the same area. We can use objects that are visible in both maps to pick points in the map that we want to georeference and work out their coordinates from the reference map.</li></ul></div><p>After loading a raster into Georeferencer by going to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Open raster</strong></span> or using the <span class="strong"><strong>Open raster</strong></span> toolbar button, we are asked to specify the CRS of the ground control points we are planning to add. Next, we can start adding ground control points by going to <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Add point</strong></span>. We can use the pan and zoom tools to navigate and we can place GCPs by clicking on the map. We are then prompted to insert the coordinates of the new point or pick them from the reference map in the main QGIS window.</p><p>After placing the GCPs, we can define the transformation algorithm by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Transformation Settings</strong></span>. Which algorithm you choose depends on your input data and the level of geometric distortion you want to allow. The most commonly used algorithms are polynomial 1 to 3. A first-order polynomial transformation allows scaling, translation, and rotation only. </p><p>A second-order polynomial transformation can handle some curvature, and a third-order polynomial transformation consequently allows for even higher degrees of distortion. The thin-plate spline algorithm can handle local deformations in the map, and is therefore very useful when working with very low-quality map scans. The linear option, on the other hand, is only used to create world files, and as mentioned previously, this does not actually transform the raster.</p><p>The resampling<a id="id90" class="indexterm"/> method depends on your input data and the result you want to achieve. Cubic resampling creates smooth results, but if you don't want to change the raster values, choose the nearest neighbor method.</p><p>Before we can<a id="id91" class="indexterm"/> start the georeferencing process, we still have to specify the output file name and target CRS. Make sure that the <span class="strong"><strong>Load in QGIS when done</strong></span> option is active. Then, we can close the <span class="strong"><strong>Transformation Settings</strong></span> dialog and go to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Start Georeferencing</strong></span>. The georeferenced raster will automatically be loaded into the QGIS main map window.</p></div></div>
<div class="section" title="Loading data from databases"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Loading data from databases</h1></div></div></div><p>QGIS<a id="id92" class="indexterm"/> supports PostGIS, SpatiaLite, MSSQL, SQL Anywhere,<a id="id93" class="indexterm"/> and Oracle Spatial databases. We will cover the two open source options: PostGIS and SpatiaLite. Both are available cross-platform, just like QGIS.</p><p>
<span class="strong"><strong>SpatiaLite</strong></span>
<a id="id94" class="indexterm"/> is the spatial extension for Sqlite databases. Sqlite is a<a id="id95" class="indexterm"/> self-contained, serverless, zero-configuration, transactional SQL database <a id="id96" class="indexterm"/>engine (<a class="ulink" href="http://www.sqlite.org">www.sqlite.org</a>). This basically means that an Sqlite database, and therefore also a SpatiaLite database, doesn't need a server installation, and can be copied and exchanged just like any ordinary file.</p><p>You can <a id="id97" class="indexterm"/>download an example database from <a class="ulink" href="http://www.gaia-gis.it/spatialite-2.3.1/test-2.3.zip">www.gaia-gis.it/spatialite-2.3.1/test-2.3.zip</a>. Unzip the file; you will be able to connect to it by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Add SpatiaLite Layer</strong></span>, using the <span class="strong"><strong>Add SpatiaLite Layer</strong></span>
<a id="id98" class="indexterm"/> toolbar button, or by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>L</em></span>. Click on <span class="strong"><strong>New</strong></span> to select<a id="id99" class="indexterm"/> the database file <code class="literal">test-2.3.sqlite</code>. QGIS will save all connections and add them to the drop-down list at the top. After clicking on <span class="strong"><strong>Connect</strong></span>, you will see the list of layers stored in the database as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/7488_02_05.jpg" alt="Loading data from databases"/></div><p>Like with files, you can select one or more tables from the list and click on <span class="strong"><strong>Add</strong></span> to load them into the map. Additionally, you can use <span class="strong"><strong>Set Filter</strong></span> to load only specific features.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip07"/>Tip</h3><p>Filters in QGIS use SQL-like syntax; for example, <code class="literal">"Name" = 'EMILIA-ROMAGNA'</code> to select only the region called EMILIA-ROMAGNA, or <code class="literal">"Name" LIKE 'ISOLA%'</code> to select all regions starting with ISOLA. The filter queries are passed on to the underlying data provider (for example, Spatialite or OGR). The provider syntax for basic filter queries is consistent over different providers, but can vary when using more exotic functions. You can read up on the details of OGR SQL<a id="id100" class="indexterm"/> on <a class="ulink" href="http://www.gdal.org/ogr/ogr_sql.html">http://www.gdal.org/ogr/ogr_sql.html</a>.</p></div></div><p>
<span class="strong"><strong>PostGIS</strong></span>
<a id="id101" class="indexterm"/> is the spatial extension for the PostgreSQL database system. Installing and configuring the database is out of the scope of this book, but there are installers for Windows<a id="id102" class="indexterm"/> and packages for many Linux distributions<a id="id103" class="indexterm"/> as well as for Mac. To load data from a PostGIS database, go to <span class="strong"><strong>Layers</strong></span> | <span class="strong"><strong>Add PostGIS Layer</strong></span>, use the <span class="strong"><strong>Add PostGIS Layer</strong></span> toolbar button, or press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>D</em></span>. </p><p>When using a database for the first time, click on <span class="strong"><strong>New</strong></span> to establish a new database connection. In the following dialog, you can specify a <span class="strong"><strong>Name</strong></span>
<a id="id104" class="indexterm"/> for the new connection. Other fields that have to be filled are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Host</strong></span>: The server's IP address is inserted in this field. You can use localhost if PostGIS is<a id="id105" class="indexterm"/> running locally.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Port</strong></span>: The PostGIS default port is 5432.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Database</strong></span>: This is the name of the PostGIS database you want to connect to.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Username</strong></span> and <span class="strong"><strong>Password</strong></span>: For convenience, you can tell QGIS to save them.<div class="mediaobject"><img src="graphics/7488_02_06.jpg" alt="Loading data from databases"/></div></li></ul></div><p>The following screenshot shows the dialog to create a new connection to a database called <span class="strong"><strong>postgis</strong></span>:</p><p>After<a id="id106" class="indexterm"/> the connection is established, you can load and filter<a id="id107" class="indexterm"/> tables just like we discussed for SpatiaLite.</p></div>
<div class="section" title="Loading data from web services"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Loading data from web services</h1></div></div></div><p>More and<a id="id108" class="indexterm"/> more data providers offer access to their datasets<a id="id109" class="indexterm"/> via OGC-compliant web services such as WMS, WCS, or WFS. QGIS supports these services out-of-the-box.</p><p>You can load WMS layers by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Add WMS Layer</strong></span>, by clicking on the <span class="strong"><strong>Add WMS Layer</strong></span> button, or by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>W</em></span>. If you know a WMS server, you can connect to it by clicking on <span class="strong"><strong>New</strong></span> and filling in a name and the URL. All other fields are optional. Don't worry if you don't know of any WMS server, because we can simply click on <span class="strong"><strong>Add default servers</strong></span> to get access information about servers whose administrators collaborate with the QGIS project. One of these servers is called <span class="strong"><strong>Lizardtech server</strong></span>. Select it, or any of the other servers, from the drop-down box and click on <span class="strong"><strong>Connect</strong></span> to see the list of layers available through the server.</p><p>From<a id="id110" class="indexterm"/> the layer list, you can now select one or more layers for download. It is worth noting that the order in which you select the layers does matter<a id="id111" class="indexterm"/> because the layers will be combined on the server side, and QGIS will only receive the combined image as the resultant layer. If you want to be able to use the layers separately, you have to download them one by one. The data download starts once you click on <span class="strong"><strong>Add</strong></span>. The dialog will stay open so that you can add additional layers from the server.</p><p>Many WMS servers offer their layers in multiple different CRSs. You can check the list of available CRSs by clicking on the <span class="strong"><strong>Change</strong></span> button at the bottom of the dialog. This will open a CRS selector dialog, which is limited to the WMS server's CRS capabilities.</p><p>Loading data from WCS or WFS servers works in the same way, but public servers are rare and unreliable, and therefore no recommendation can be provided here.</p></div>
<div class="section" title="Styling raster layers"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Styling raster layers</h1></div></div></div><p>After this <a id="id112" class="indexterm"/>introduction to data sources, we can now create our first map. We will build the map from the bottom up by first loading some background rasters (hillshade and land cover), which we will then overlay with point, line, and polygon layers.</p><p>Let's start by loading land cover and hillshade from <code class="literal">landcover.img</code> and <code class="literal">SR_50M_alaska_nad.tif</code> and then opening the <span class="strong"><strong>Style</strong></span> section in layer properties (<span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Properties</strong></span> or by double-clicking on the layer name). QGIS tries to pick a reasonable default render type. The hillshade raster, <code class="literal">SR_50M_alaska_nad.tif</code>, is loaded with the <span class="strong"><strong>Singleband gray</strong></span> render type as you can see in the following screenshot. If we want to render the hillshade raster in color instead of grayscale, we can change the render type to <span class="strong"><strong>Singleband pseudocolor</strong></span>. In pseudocolor mode, we can create color maps either manually or by selecting one of the premade color ramps. But let's stick with <span class="strong"><strong>Singleband gray</strong></span> for hillshade for now.</p><p>Below the color settings, we find a section with more advanced options that control raster resampling, brightness, contrast, saturation, and hue—options you probably know from image processing software. By default, resampling is set to the fast <span class="strong"><strong>Nearest neighbour</strong></span> option. To get nice, smoother results, we can change to the <span class="strong"><strong>Bilinear</strong></span> or <span class="strong"><strong>Cubic</strong></span> method.</p><p>Click on <span class="strong"><strong>Ok</strong></span> or <span class="strong"><strong>Apply</strong></span> to confirm. In both cases, the map will be redrawn using the new layer style. <a id="id113" class="indexterm"/>If you click on <span class="strong"><strong>Apply</strong></span>, the <span class="strong"><strong>Layer Properties</strong></span> dialog stays open and you can continue to fine-tune the layer style. If you click on <span class="strong"><strong>Ok</strong></span>, the <span class="strong"><strong>Layer Properties</strong></span> dialog is closed.</p><div class="mediaobject"><img src="graphics/7488_02_07.jpg" alt="Styling raster layers"/></div><p>The <code class="literal">landcover.img</code> raster<a id="id114" class="indexterm"/> is a good example of a paletted raster. Each cell value is mapped to a specific color. To change a color, we can simply double-click on the <span class="strong"><strong>Color</strong></span> preview and a color picker will open. </p><p>The style section of a paletted raster looks like the following screenshot:</p><div class="mediaobject"><img src="graphics/7488_02_08.jpg" alt="Styling raster layers"/></div><p>If we want to combine hillshade and land cover into one aesthetically pleasing background, we can use a combination of the <span class="strong"><strong>Blending mode</strong></span> and layer <span class="strong"><strong>Transparency</strong></span>. Blending<a id="id115" class="indexterm"/> modes are another feature commonly found in image-processing software. The main advantage of blending modes over transparency is that we can avoid the usually dull, low-contrast look that results from combining rasters using transparency alone. If you haven't had any experience with blending, take some time to try the different effects. For this example, I used the <span class="strong"><strong>Darken</strong></span> blending mode, as highlighted in the previous screenshot, together with a global layer transparency of <span class="strong"><strong>50 %,</strong></span> as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/7488_02_09.jpg" alt="Styling raster layers"/></div></div>
<div class="section" title="Styling vector layers"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec17"/>Styling vector layers</h1></div></div></div><p>When<a id="id116" class="indexterm"/> we load vector layers, QGIS renders them using a default style and a random color. Of course, we want to customize these styles to better reflect our data. In the following exercises, we will style point, line, and polygon layers, and we will also get accustomed with the most common vector styling options.</p><div class="section" title="Creating point styles – an example of an airport style"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec09"/>Creating point styles – an example of an airport style</h2></div></div></div><p>Let's get<a id="id117" class="indexterm"/> started with a point layer! Load <code class="literal">airport.shp</code> <a id="id118" class="indexterm"/>from our sample data. Regardless of the layer's geometry type, we always find a drop-down list with the available style options in the upper-left corner of the <span class="strong"><strong>Style</strong></span> dialog.</p><p>The following style options are available for vector layers:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Single Symbol</strong></span>: This<a id="id119" class="indexterm"/> is the simplest<a id="id120" class="indexterm"/> option. When we use a Single Symbol style, all points are displayed with the same symbol.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Categorized</strong></span>: This<a id="id121" class="indexterm"/> is the style of choice<a id="id122" class="indexterm"/> if a layer contains points of different categories; for example, a layer containing locations of different animal sightings.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Graduated styles</strong></span>: These <a id="id123" class="indexterm"/>are great if<a id="id124" class="indexterm"/> we want to visualize numerical values; for example, temperature measurements.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Rule-based styles</strong></span>: These <a id="id125" class="indexterm"/>are the most<a id="id126" class="indexterm"/> advanced options. These styles are very flexible because they allow us to write multiple rules for one layer.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Point displacement styles</strong></span>: These <a id="id127" class="indexterm"/>are<a id="id128" class="indexterm"/> only available for point layers. These styles are useful if you need to visualize point layers with multiple points at the same coordinates; for example, students of a school living at the same address.</li></ul></div><p>Below the drop-down list we find the symbol preview, and below that there is the list of symbol layers, which shows us the different layers the symbol consists of. On the right-hand side, we find options for the symbol size and size units, color and transparency, as well as rotation. Using the <span class="strong"><strong>Data defined properties</strong></span> button<a id="id129" class="indexterm"/>, we can also tell QGIS to use the feature's attribute values to define symbol shape, size, color, and so on. Finally, the bottom-right area contains a preview area with saved symbols.</p><p>Point layers <a id="id130" class="indexterm"/>are by default displayed using a simple circle symbol. We want to use a symbol of an airplane instead. To change the symbol, select the <span class="strong"><strong>Simple marker</strong></span> entry in <span class="strong"><strong>Symbol layers</strong></span>. Notice how the right-hand side of the dialog changes. We can now see the options available for simple markers: <span class="strong"><strong>Colors</strong></span>, <span class="strong"><strong>Size</strong></span>, <span class="strong"><strong>Rotation</strong></span>, <span class="strong"><strong>Form</strong></span>, and so on. However, we are not looking for circles, stars, or square symbols—we want an airplane. That's why we need to change the <span class="strong"><strong>Symbol layer type</strong></span> option from <span class="strong"><strong>Simple marker</strong></span> to <span class="strong"><strong>SVG marker</strong></span>. Many of the options are similar, but on the bottom we now find a selection of SVG images that we can choose from. Scroll through the list and pick the airplane symbol as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/7488_02_10.jpg" alt="Creating point styles – an example of an airport style"/></div><p>Symbol<a id="id131" class="indexterm"/> layer types for point layers include the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Simple marker</strong></span>: These<a id="id132" class="indexterm"/> include geometric<a id="id133" class="indexterm"/> forms such as circles, stars, and squares</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Font marker</strong></span>: These <a id="id134" class="indexterm"/>provide access <a id="id135" class="indexterm"/>to your symbol fonts</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>SVG marker</strong></span>: Each QGIS installation comes with a collection of default SVG<a id="id136" class="indexterm"/> symbols; add your own <a id="id137" class="indexterm"/>folders containing SVG images<a id="id138" class="indexterm"/> by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Options</strong></span> | <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>SVG Paths</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Ellipse marker</strong></span>: These<a id="id139" class="indexterm"/> include customizable<a id="id140" class="indexterm"/> ellipses, rectangles, crosses, and triangles; especially useful when combined with what we set in the data defined settings option</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Vector Field marker</strong></span>: This is a <a id="id141" class="indexterm"/>customizable<a id="id142" class="indexterm"/> vector-field visualization tool</li></ul></div></div><div class="section" title="Creating line styles – an example of river or road styles"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec10"/>Creating line styles – an example of river or road styles</h2></div></div></div><p>In this exercise, we will create a river style for the <code class="literal">majriver.shp</code> file in our sample data. The goal is <a id="id143" class="indexterm"/>to create a line style with two colors: a fill color for the center of the line and an outline color. This technique is very useful because it can also be used to create road styles.</p><p>To create <a id="id144" class="indexterm"/>such a style, we combine two simple lines. The default symbol is one simple line. Click on the green <span class="strong"><strong>+</strong></span> symbol located below the <span class="strong"><strong>Symbol layers</strong></span> list to add another simple line. The lower one will be our outline and the upper one will be the fill. Select the upper simple line and change the color to blue and the width to 0.3 millimeters. Next, select the lower simple line and change its color to gray and the width to 0.6 millimeters, slightly wider than the other line. Check the preview and click on <span class="strong"><strong>Apply</strong></span> to test how the style looks when applied to the river layer.</p><p>You will notice that the style doesn't look perfect yet. That's because each line feature is drawn separately, one after the other, and this leads to a rather disconnected appearance. Luckily, that's easy to fix; we only need to enable the so-called symbol levels. To do that, select the <span class="strong"><strong>Line</strong></span> entry in the <span class="strong"><strong>Symbol layers</strong></span> list and tick the checkbox in the <span class="strong"><strong>Symbol Levels</strong></span> dialog of the <span class="strong"><strong>Advanced</strong></span> section (the button in the lower-right corner of the style dialog) as shown in the following screenshot. Click on <span class="strong"><strong>Apply</strong></span> to test the results:</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip08"/>Tip</h3><p>Whenever we create a symbol that we might want to re-use in other maps, we can save it by going to <span class="strong"><strong>Symbol</strong></span> | <span class="strong"><strong>Save in symbol library</strong></span> (the button beside the <span class="strong"><strong>Advanced</strong></span> button in the bottom-right corner). We can assign a name to the new symbol; after we save it, it will be added to the <span class="strong"><strong>Saved styles</strong></span> preview area.</p></div></div><div class="mediaobject"><img src="graphics/7488_02_11.jpg" alt="Creating line styles – an example of river or road styles"/></div><p>Symbol<a id="id145" class="indexterm"/> layer types for line layers include<a id="id146" class="indexterm"/> the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Simple line</strong></span>: These<a id="id147" class="indexterm"/> are solid or <a id="id148" class="indexterm"/>dashed lines</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Marker line</strong></span>: These<a id="id149" class="indexterm"/> lines are made <a id="id150" class="indexterm"/>out of point markers located at line <a id="id151" class="indexterm"/>vertices or in regular intervals</li></ul></div></div><div class="section" title="Creating polygon styles – an example of a landmass style"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec11"/>Creating polygon styles – an example of a landmass style</h2></div></div></div><p>In this exercise, we will create a style for the <code class="literal">alaska.shp</code> file. The goal is to create a simple fill with<a id="id152" class="indexterm"/> a blue halo. Like in the previous<a id="id153" class="indexterm"/> river style example, we will combine two symbol layers to create this style: a simple fill layer that defines the main fill color with a thin border and an additional simple line outline layer for the halo. The halo should have nice rounded corners. To achieve those, change the <span class="strong"><strong>Join style</strong></span> option to <span class="strong"><strong>Round</strong></span>. Similar to the previous example, we again enable symbol levels; to prevent this landmass style from blocking<a id="id154" class="indexterm"/> out the background map, we select the <span class="strong"><strong>Multiply</strong></span> blending mode as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/7488_02_12.jpg" alt="Creating polygon styles – an example of a landmass style"/></div><p>Symbol<a id="id155" class="indexterm"/> layer types for polygon layers include<a id="id156" class="indexterm"/> the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Simple fill</strong></span>: These<a id="id157" class="indexterm"/> define fill<a id="id158" class="indexterm"/> and outline colors as well as basic fill styles</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Centroid fill</strong></span>: These<a id="id159" class="indexterm"/> allow us<a id="id160" class="indexterm"/> to put point markers at the center of polygons</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Line/Point pattern fill</strong></span>: These <a id="id161" class="indexterm"/>support<a id="id162" class="indexterm"/> user-defined line and point patterns with flexible spacing</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>SVG fill</strong></span>: These<a id="id163" class="indexterm"/> fill the polygon<a id="id164" class="indexterm"/> using SVG patterns</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Outline</strong></span>: These<a id="id165" class="indexterm"/> make it possible<a id="id166" class="indexterm"/> to outline areas using line styles</li></ul></div></div></div>
<div class="section" title="Loading background maps"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Loading background maps</h1></div></div></div><p>Background maps are very useful for quick checks and to provide orientation, especially if you don't have access to any other base layers. Adding<a id="id167" class="indexterm"/> background maps is easy using the OpenLayers plugin. It provides access to satellite, street, and hybrid maps by Google, Yahoo!, and Bing, as well as different map types by OpenStreetMap, Stamen, and Apple.</p><p>To install the OpenLayers plugin<a id="id168" class="indexterm"/>, go to <span class="strong"><strong>Plugins</strong></span> | <span class="strong"><strong>Manage and Install Plugins | Get more</strong></span>. Wait until the list of available plugins has finished loading. Use the filter to look for the <span class="strong"><strong>OpenLayers Plugin</strong></span> option as shown in the following screenshot.<a id="id169" class="indexterm"/> Select it from the list and click on <span class="strong"><strong>Install</strong></span>. This is going to take a moment. Once it's done, you will see a short confirmation message. You can then close the installer and the <span class="strong"><strong>OpenLayers Plugin</strong></span> option should be available through the <span class="strong"><strong>Plugins</strong></span> menu.</p><div class="mediaobject"><img src="graphics/7488_02_13.jpg" alt="Loading background maps"/></div><p>Note that you have to be online to use these services. Another fact worth mentioning is that all these services provide their maps only in Pseudo Mercator (EPSG:3857). Your project CRS will automatically be changed to Pseudo Mercator when you load a background map using the <span class="strong"><strong>OpenLayers plugin</strong></span> option. </p><p>If you load the OSM Landscape layer, your <a id="id170" class="indexterm"/>map will look like the following screenshot:</p><div class="mediaobject"><img src="graphics/7488_02_14.jpg" alt="Loading background maps"/></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec19"/>Summary</h1></div></div></div><p>In this chapter, we covered how to load spatial data from files, databases, and web services. We saw how QGIS handles coordinate reference systems and had a first introduction to styling vector and raster layers, a topic we will cover in more detail in <a class="link" href="ch05.html" title="Chapter 5. Creating Great Maps">Chapter 5</a>, <span class="emphasis"><em>Creating Great Maps</em></span>. We also installed our first Python plugin, the OpenLayers plugin, and used it to load background maps into our project.</p></div></body></html>