<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Handling Your Data"><div class="titlepage" id="aid-DB7S2"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Handling Your Data</h1></div></div></div><p>In this introductory chapter, we will prepare all the necessary tools and data for the visual exploration of spatial phenomena, mapping, and analysis. After getting to know some basics about QGIS as a desktop GIS, you will learn how to install and configure it. Then, we will go through the most common spatial data sources and, in the end, aggregate them into a single spatial database that will be used for styling, mapping, and analysis in the following chapters.</p><p>In this chapter, we will go through the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">QGIS installation</li><li class="listitem">Graphical user interface (GUI), its elements, and its customization</li><li class="listitem">Loading various types of spatial data from common sources</li><li class="listitem">Projection's basics</li><li class="listitem">Assembling data into a single spatial database</li></ul></div><div class="section" title="Installing QGIS"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Installing QGIS</h1></div></div></div><p>QGIS is a free and open source desktop GIS on which development began in 2002. Since 2007, the project has been developing under the<a id="id0" class="indexterm"/> umbrella of the <span class="strong"><strong>Open Source Geospatial Foundation</strong></span> (<span class="strong"><strong>OSGeo</strong></span>). A relatively young project, QGIS<a id="id1" class="indexterm"/> is gaining more and more popularity among individual users, private companies, and organizations all over the world due to the following<a id="id2" class="indexterm"/> reasons:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Distribution under the GNU <span class="strong"><strong>General Public License</strong></span> (<span class="strong"><strong>GPL</strong></span>), which guarantees users the freedom to use, study, share, and modify the software</li><li class="listitem">Cross-platform support, which means that QGIS can run on Linux, Unix, Mac OS, Windows, and Android operating systems</li><li class="listitem">Multiple vector and raster data format support, as well as database formats and functionalities</li><li class="listitem">Permanent improvement of the core functionality, which encompasses data creation, editing, manipulation, analysis, storage, and visual representation</li><li class="listitem">Permanent growth of the external functionality available from the so-called plugins supported by the international community of developers<div class="note" title="Note"><h3 class="title"><a id="note02"/>Note</h3><p>You can find more information about <a id="id3" class="indexterm"/>QGIS from its official website at <a class="ulink" href="http://qgis.org/">http://qgis.org/</a> and its documentation chapter available at <a class="ulink" href="http://documentation.qgis.org/">http://documentation.qgis.org/</a>.</p></div></li></ul></div><p>According to the<a id="id4" class="indexterm"/> release schedule of the QGIS project, a new version of QGIS is available every 4 months. Starting from QGIS 2.8, every third release has been a long-term release (LTR). It is maintained for a year, and then the next LTR occurs. Throughout this book, an LTR of QGIS 2.8 called "Wein" is used.</p><p>Installers for the<a id="id5" class="indexterm"/> current QGIS version are available for different operating systems from the download page of the official website at <a class="ulink" href="http://download.qgis.org">http://download.qgis.org</a>. The 32-bit and 64-bit installation files for MS Windows are distributed as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>QGIS Standalone Installers</strong></span>: QGIS installation using these has no differences from the conventional software<a id="id6" class="indexterm"/> installation procedure <a id="id7" class="indexterm"/>under Windows</li><li class="listitem"><span class="strong"><strong>OSGeo4W Network Installer</strong></span>: Compared to standalone installers, this provides the following <a id="id8" class="indexterm"/>advantages:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">Aside from QGIS, it allows us to install a large number of other packages to work with spatial data (command-line utilities, libraries, and desktop and server applications)</li><li class="listitem">It ensures installation of the most up-to-date software versions being directly linked to constantly updating repositories</li><li class="listitem">Once defined, the OSGeo4W working environment is convenient to use for automatic and timely updates, package addition, or package deletion</li></ul></div></li></ul></div><p>Let's go through the installation procedure of QGIS and its components with the OSGeo4W installer in the example of the latest 32-bit version. Since the installation (especially primary) requires downloading a large number of files, it is desirable to have a high-speed Internet connection. The installation procedure is as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download the latest version of the OSGeo4W 32-bit Network Installer, and double-click on <code class="literal">osgeo4w-setup-x86.exe</code> to run the installation.</li><li class="listitem">In the installer window, select <span class="strong"><strong>Advanced Install</strong></span>, as shown in the following screenshot. From<a id="id9" class="indexterm"/> now on, just read carefully and follow the<a id="id10" class="indexterm"/> instructions.<div class="mediaobject"><img src="../Images/image00266.jpeg" alt="Installing QGIS"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">Choose <span class="strong"><strong>Install from the Internet</strong></span> with the option to keep the downloaded files for future reuse.</li><li class="listitem">Choose the directory for the OSGeo4W software suite installation. <code class="literal">C:\OSGeo4W</code> is a usual and convenient choice. If you want to use another directory, give it a proper name with a short path, excluding spaces and special symbols.</li><li class="listitem">Then, choose a directory to save the downloaded packages. You can create a new directory, <code class="literal">C:\OSGeo4W\Downloads</code>, by typing in its name manually. Keep in mind that the volume of files to be downloaded is about 200 MB and you will need enough space to keep them all.</li><li class="listitem">Configure your Internet connection parameters, if any, and click on the <span class="strong"><strong>Next</strong></span> button to proceed. After hitting the <span class="strong"><strong>Next</strong></span> button, the list of all packages is downloaded <a id="id11" class="indexterm"/>and you enter the mode of package selection, as<a id="id12" class="indexterm"/> shown in the following screenshot. The available packages are grouped into the following categories: <span class="strong"><strong>Commandline_Utilities</strong></span>, <span class="strong"><strong>Desktop</strong></span>, <span class="strong"><strong>Libs</strong></span>, and <span class="strong"><strong>Web</strong></span>.<div class="mediaobject"><img src="../Images/image00267.jpeg" alt="Installing QGIS"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">To install a package, click on the <span class="strong"><strong>+</strong></span> sign to expand the category, and choose an application by clicking on the rounded arrow beside it (the word <span class="strong"><strong>Skip</strong></span> will be replaced by the latest available version number).</li><li class="listitem">To install the latest QGIS version, choose <span class="strong"><strong>qgis: QGIS Desktop</strong></span>, and <span class="strong"><strong>grass: GRASS GIS stable release</strong></span>. GRASS is a standalone GIS application that is closely integrated into QGIS and provides advanced geoprocessing functions.</li><li class="listitem">After you've<a id="id13" class="indexterm"/> clicked on the <span class="strong"><strong>Next</strong></span> button, the installer<a id="id14" class="indexterm"/> automatically detects the necessary dependencies and proceeds to download the packages and installation, as shown in the following screenshot:<div class="mediaobject"><img src="../Images/image00268.jpeg" alt="Installing QGIS"/></div><p style="clear:both; height: 1em;"> </p><div class="note" title="Note"><h3 class="title"><a id="tip02"/>Tip</h3><p>You can also install <span class="strong"><strong>qgis-dev: QGIS nightly build of the master</strong></span>. Being under constant development, this version is considered unstable and is updated nightly. It is not recommended for workaday use, but is useful if you want to have a try at some new features and give feedback to developers.</p></div></li></ol><div style="height:10px; width: 1px"/></div><p>After the installation completes, you will find the <span class="strong"><strong>OSGeo4W</strong></span> group in the <span class="strong"><strong>Start</strong></span> menu, with the following<a id="id15" class="indexterm"/> components:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>MSYS</strong></span>: This is a set of GNU tools that ensure the creation of applications traditionally dependent<a id="id16" class="indexterm"/> on UNIX tools</li><li class="listitem"><span class="strong"><strong>OSGe4W Shell</strong></span>: This is a command-line interface for OSGeo4W utilities</li><li class="listitem"><span class="strong"><strong>QGIS Browser 2.8.1</strong></span>: This is a QGIS explorer used for navigation and data preview</li><li class="listitem"><span class="strong"><strong>QGIS Desktop 2.8.1</strong></span>: This is a QGIS desktop application</li><li class="listitem"><span class="strong"><strong>Setup</strong></span>: This is a OSGeo4W Installer launcher</li><li class="listitem"><span class="strong"><strong>GRASS GIS 7.0.0</strong></span>: This is GRASS GIS and its components</li></ul></div><p>If you want to update QGIS or expand the current installation with some new components, simply click on the <span class="strong"><strong>Setup</strong></span> shortcut from the <span class="strong"><strong>OSGeo4W</strong></span> menu folder and run the <span class="strong"><strong>Advanced installation</strong></span> procedure. The installer will check for available updates and necessary dependencies, download them, and install them.</p></div></div>
<div class="section" title="GUI elements and customization"><div class="titlepage" id="aid-E9OE2"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>GUI elements and customization</h1></div></div></div><p>When you first start<a id="id17" class="indexterm"/> QGIS, you will see the interface, as shown on the following<a id="id18" class="indexterm"/> screenshot. By definition, the QGIS interface uses the system language. For the purpose of this tutorial, you can change it in English by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Options</strong></span> | <span class="strong"><strong>Locale</strong></span> and restarting QGIS to apply your changes.</p><div class="mediaobject"><img src="../Images/image00269.jpeg" alt="GUI elements and customization"/></div><p style="clear:both; height: 1em;"> </p><p>The QGIS interface consists <a id="id19" class="indexterm"/>of five main sections:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><span class="strong"><strong>Menu bar</strong></span>: This provides access to all QGIS functions in the conventional form—drop-down<a id="id20" class="indexterm"/> menus.</li><li class="listitem"><span class="strong"><strong>Panels</strong></span>: These are<a id="id21" class="indexterm"/> windows that can be either docked or floating. By default, you can see two panels activated on the left side of the workspace.<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">The <span class="strong"><strong>Layers</strong></span> panel is designated to display a tree view list of all loaded layers.</li><li class="listitem">The <span class="strong"><strong>Browser</strong></span> panel provides quick navigation and access to the various local, server, or online data sources. You can close or shrink a panel using special buttons in its top-right corner. You can also drag and drop it to a place handily.<div class="note" title="Note"><h3 class="title"><a id="tip03"/>Tip</h3><p>Throughout this book, we will use the <span class="strong"><strong>Browser</strong></span> panel from time to time, so try to assign it a proper position instead of closing it. For example, by dragging and dropping it onto the <span class="strong"><strong>Layers</strong></span> panel, you can create two independent tabs: one for layers and the other for data source navigation. In this case, you will not have to sacrifice window the space necessary for expanding and viewing items.</p></div></li></ul></div><div class="mediaobject"><img src="../Images/image00270.jpeg" alt="GUI elements and customization"/></div><p style="clear:both; height: 1em;"> </p><p>Panels can<a id="id22" class="indexterm"/> be turned on or off by going to <span class="strong"><strong>View</strong></span> | <span class="strong"><strong>Panels</strong></span>. Similarly, you can right-click anywhere on the upper bar of the workspace, and a window <a id="id23" class="indexterm"/>with toggles will pop up. This window is divided by a horizontal line and the panels toggles are located in its upper part.</p></li><li class="listitem"><span class="strong"><strong>Toolbars</strong></span>: Menu functions are <a id="id24" class="indexterm"/>grouped into logical toolsets and placed as buttons in bars to provide handy access to all the necessary tools. By default, the following toolbars are turned on and displayed:<div class="mediaobject"><img src="../Images/image00271.jpeg" alt="GUI elements and customization"/><div class="caption"><p>File toolbar</p></div></div><p style="clear:both; height: 1em;"> </p><div class="mediaobject"><img src="../Images/image00272.jpeg" alt="GUI elements and customization"/><div class="caption"><p>Map Navigation toolbar</p></div></div><p style="clear:both; height: 1em;"> </p><div class="mediaobject"><img src="../Images/image00273.jpeg" alt="GUI elements and customization"/><div class="caption"><p>Attributes toolbar</p></div></div><p style="clear:both; height: 1em;"> </p><div class="mediaobject"><img src="../Images/image00274.jpeg" alt="GUI elements and customization"/><div class="caption"><p>Digitizing toolbar</p></div></div><p style="clear:both; height: 1em;"> </p><div class="mediaobject"><img src="../Images/image00275.jpeg" alt="GUI elements and customization"/><div class="caption"><p>Label toolbar</p></div></div><p style="clear:both; height: 1em;"> </p><div class="mediaobject"><img src="../Images/image00276.jpeg" alt="GUI elements and customization"/><div class="caption"><p>Help and Plugins toolbars</p></div></div><p style="clear:both; height: 1em;"> </p><div class="mediaobject"><img src="../Images/image00277.jpeg" alt="GUI elements and customization"/><div class="caption"><p>Manage Layers toolbar</p></div></div><p style="clear:both; height: 1em;"> </p><p>If you want to see a short tool reference, just hover your mouse pointer over the button and a yellow information window will pop up. Some buttons or toolbars are grayed out (for example, the <span class="strong"><strong>Digitizing</strong></span> toolbar and <span class="strong"><strong>Label</strong></span> toolbar), which means that they can be used only after some <a id="id25" class="indexterm"/>actions have been performed. For example, the <span class="strong"><strong>Digitizing</strong></span> toolbar's buttons become available only after editing mode is activated for some layers. Toolbars are dockable and can easily be moved around the workspace. To move a toolbar, place the mouse arrow over its border marked by perforation dots. The arrow will turn into a cross, symbolizing that the toolbar can now be dragged and dropped to any other place while holding down the left button of the mouse. You<a id="id26" class="indexterm"/> can turn the toolbars on or off by navigating to <span class="strong"><strong>View</strong></span> | <span class="strong"><strong>Toolbars,</strong></span> or from the window called by a right click on any toolbar.</p></li><li class="listitem"><span class="strong"><strong>Map area</strong></span>: This<a id="id27" class="indexterm"/> is the largest section of the interface window, and is designed for data map display and visual exploration.</li><li class="listitem"><span class="strong"><strong>Status bar</strong></span>: This briefly displays<a id="id28" class="indexterm"/> the following information about your current map overview: a progress bar of the rendering (visible only if rendering takes some time to show its progress), the mouse pointer's position coordinates, the scale, and the current coordinate reference system. It also contains toggles for switching from point position coordinates to extent, and temporarily turning off map rendering. There are also buttons used to open the coordinate reference system dialog <span class="inlinemediaobject"><img src="../Images/image00278.jpeg" alt="GUI elements and customization"/></span> and show the <span class="strong"><strong>Log Message</strong></span> panel <span class="inlinemediaobject"><img src="../Images/image00279.jpeg" alt="GUI elements and customization"/></span>.</li></ol><div style="height:10px; width: 1px"/></div><p>Advanced GUI customization is possible by navigating to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Customization</strong></span>. From this dialog, you can get complete control over all menus, panels, bars, and widgets. To start the process of customization, turn on the <span class="strong"><strong>Enable customization</strong></span> toggle. As long as you are not familiar with QGIS interface, it will be easier to enter <span class="inlinemediaobject"><img src="../Images/image00280.jpeg" alt="GUI elements and customization"/></span> <span class="strong"><strong>Switch to catching widgets in main application</strong></span> mode. In this mode, you can click on any GUI item you want to hide—a button on a toolbar or a toolbar itself. The chosen items are highlighted and the relevant customization tree item is expanded, as shown in the following screenshot. If you have<a id="id29" class="indexterm"/> chosen an item by mistake, simply click on it once again to unselect. Otherwise, you can expand the relevant item, check/uncheck some toggles, and click on <span class="strong"><strong>OK</strong></span>. The changes are applied after QGIS restarts.</p><div class="mediaobject"><img src="../Images/image00281.jpeg" alt="GUI elements and customization"/></div><p style="clear:both; height: 1em;"> </p><div class="note" title="Note"><h3 class="title"><a id="tip04"/>Tip</h3><p>As your familiarity with QGIS grows and you start using it for different tasks, it might be convenient to create a few users' GUI profiles, aimed at different use<a id="id30" class="indexterm"/> cases (for example, digitizing, working with databases or raster data, and so on). To do so, you need to adjust all the necessary settings in the <span class="strong"><strong>Customization</strong></span> dialog window, and save <span class="inlinemediaobject"><img src="../Images/image00282.jpeg" alt="GUI elements and customization"/></span> them in a <code class="literal">.ini</code> file. After that, you will be able to quickly modify the interface just by loading settings <span class="inlinemediaobject"><img src="../Images/image00283.jpeg" alt="GUI elements and customization"/></span> from a predefined customization file.</p></div><p>Some minor interface changes, such as general style, default icon size, font and more, are available from the <span class="strong"><strong>Application</strong></span> group, which can be found by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Options</strong></span> | <span class="strong"><strong>General</strong></span>.</p></div>
<div class="section" title="Extending functionality through plugins" id="aid-F8901"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Extending functionality through plugins</h1></div></div></div><p>From the very beginning, QGIS has had a modular architecture that makes it easy to add new features or functions. Most functions in QGIS are implemented in so-called plugins, which are divided into the<a id="id31" class="indexterm"/> following types:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>Core plugins</strong></span>: These are<a id="id32" class="indexterm"/> included in QGIS by default and are maintained by the development team. In order to be used, they should only be activated by a user.</li><li class="listitem"><span class="strong"><strong>External plugins</strong></span>: These are<a id="id33" class="indexterm"/> located in an external repository and are maintained by the authors. In order to be used, they should first be installed by a user. With time passing, some of the most useful and popular plugins are incorporated into the QGIS core functionality.</li></ul></div><div class="section" title="Managing plugins"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Managing plugins</h2></div></div></div><p>Plugin management<a id="id34" class="indexterm"/> implies their activation, installation, update, and removal, which are performed by navigating to <span class="strong"><strong>Plugins</strong></span> | <span class="strong"><strong>Manage and Install Plugins</strong></span>. There are several tabs in the dialog window. Clicking on an individual plugin in any of these tabs shows you detailed information: whether the plugin is experimental or not, the functionality, rating, author, version, and also some links to its <span class="strong"><strong>homepage</strong></span>, <span class="strong"><strong>code repository</strong></span>, and <span class="strong"><strong>tracker</strong></span>:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>All</strong></span>: Under this tab, you can see the full list of available plugins, both installed and not installed.</li><li class="listitem"><span class="strong"><strong>Installed</strong></span>: This tab shows the plugins that are already installed in QGIS. If you want to activate/deactivate a plugin, just check/uncheck the toggle beside it.</li><li class="listitem"><span class="strong"><strong>Not installed</strong></span>: This tab contains a list of all available plugins that are not installed in your QGIS.<p>The following tabs are not permanent and are shown only if there are plugins that satisfy some conditions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>Upgradeable</strong></span>: This tab is visible only when more recent versions of the installed plugins are available in the repositories.</li><li class="listitem"><span class="strong"><strong>Invalid</strong></span>: This tab is shown when there are installed plugins that are broken or incompatible with your QGIS version. If you click on an individual plugin from this tab, you will be shown the information about the possible cause of invalidity; so that you would be able to provide a consistent feedback to the developers.</li><li class="listitem"><span class="strong"><strong>New</strong></span>: This<a id="id35" class="indexterm"/> tab shows the not-installed plugins seen for the first time.</li></ul></div><div class="mediaobject"><img src="../Images/image00284.jpeg" alt="Managing plugins"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem"><span class="strong"><strong>Settings</strong></span>: This tab allows you to define how often updates will be checked and whether to use experimental or deprecated plugins. While it is not recommended<a id="id36" class="indexterm"/> to use experimental plugins for production purposes, you can still activate the option to explore the entire range of available tools. By default, only <span class="strong"><strong>QGIS Official Plugin Repository</strong></span> is connected, but you can connect additional repositories if you know them by clicking on the <span class="strong"><strong>Add...</strong></span> button. For example, the previous screenshot shows how to add an external Boundless plugin repository.</li></ul></div><p>To install a plugin, go back to the <span class="strong"><strong>Not installed</strong></span> tab, select the plugin you want to install, and click on <span class="strong"><strong>Install plugin</strong></span>. After that, the installation starts, and upon its completion, the message about successful installation is displayed. The installed plugin is activated by default and either appears in the <span class="strong"><strong>Plugins</strong></span> menu, or is added to another relevant menu (for example, <span class="strong"><strong>Vector</strong></span> or <span class="strong"><strong>Raster</strong></span>). Also, some plugins appear as separate toolbars and panels that can be placed and turned on or off manually.</p><p>Finding and choosing a plugin that fits your needs might be difficult because their number is over 400 and is constantly growing. To<a id="id37" class="indexterm"/> explore the world of QGIS plugins, you can start from <a class="ulink" href="http://plugins.qgis.org/">http://plugins.qgis.org/</a>, which contains information about popular and featured plugins. If you are looking for a specific function but don't know the exact plugin name, we <a id="id38" class="indexterm"/>advise you to search by using tag words in the <span class="strong"><strong>Manage and Install Plugins</strong></span> dialog window, as shown on the following screenshot:</p><div class="mediaobject"><img src="../Images/image00285.jpeg" alt="Managing plugins"/></div><p style="clear:both; height: 1em;"> </p><div class="note" title="Note"><h3 class="title"><a id="tip05"/>Tip</h3><p>By default, plugins are sorted alphabetically by name. If you want to rate them (by downloads, votes, or status), apply the additional sorting options available by right-clicking contextual menu of the list of plugins.</p></div></div></div>
<div class="section" title="Loading data into QGIS"><div class="titlepage" id="aid-G6PI2"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Loading data into QGIS</h1></div></div></div><p>The data in the GIS can be submitted as separate files, databases, or external online sources. Moreover, there are<a id="id39" class="indexterm"/> different data models used in the GIS to represent the geometry of spatial objects. The vector data model is mostly used to express discrete features, such as points (for example, separately growing trees and points of interest), lines (roads or railways), and polygons (buildings or administrative borders). Raster data is<a id="id40" class="indexterm"/> convenient for expressing continuous phenomena that are better represented by coverage than by points, lines, or polygons. The most common raster data sources are remote sensing imagery, digital elevation models, and scanned and georeferenced topographic maps.</p><p>QGIS uses the GDAL/OGR spatial data library to read and write multiple vector and raster file formats. In the following sections, we will briefly discuss the most common file formats that you can get your data in. Additionally, we will take a look at the recently widely used data sources, such as CSV files, files collected by GPS-receivers, and OpenStreetMap.</p><div class="section" title="Loading shapefiles"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Loading shapefiles</h2></div></div></div><p>Most of our data is in the ESRI shapefile format, which is one of the most common vector data file formats. There are a few alternative ways of loading a shapefile into QGIS. You can<a id="id41" class="indexterm"/> open the dialog window by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Add Layer</strong></span> | <span class="strong"><strong>Add Vector Layer</strong></span>, or by clicking on the relevant button <span class="inlinemediaobject"><img src="../Images/image00286.jpeg" alt="Loading shapefiles"/></span> on the <span class="strong"><strong>Manage Layers</strong></span> toolbar, or by using the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>V</em></span> keyboard shortcut.</p><p>In the <span class="strong"><strong>Add vector layer</strong></span> dialog window, configure the following items:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>Source type</strong></span>, which can be <span class="strong"><strong>File</strong></span>, <span class="strong"><strong>Directory</strong></span>, <span class="strong"><strong>Database</strong></span>, or <span class="strong"><strong>Protocol</strong></span>. By default, the <span class="strong"><strong>File</strong></span> source type specified is suitable for loading spatial data represented by separate files, like in our case.</li><li class="listitem">Consider the <span class="strong"><strong>Encoding</strong></span> drop-down list options if the data you work with contains special symbols or the charset of its textual attributes differs from the conventional Latin symbology. In this case, you should choose an appropriate encoding type from the drop-down list. Our data does not contain any special symbols, so we accept the default <span class="strong"><strong>System</strong></span> encoding.</li><li class="listitem">The <span class="strong"><strong>Browse</strong></span> button is meant for navigating to the work directory. There, you can choose one or several files (with the <span class="emphasis"><em>Ctrl</em></span> key) to add after hitting the <span class="strong"><strong>Open</strong></span> button.<div class="note" title="Note"><h3 class="title"><a id="tip06"/>Tip</h3><p>For the first time, you are likely to be overwhelmed by the amount and diversity of the available files. This is because in the GIS, a dataset is usually represented by several files with different extensions. For example, an ESRI shapefile consists of at least 4 files (<code class="literal">.shp</code>, <code class="literal">.shx</code>, <code class="literal">.dbf</code>, and <code class="literal">.prj</code>) that share the same name, and among them, <code class="literal">.shp</code> is what you should select to load the data into QGIS. You see all the files because the file type filter in the bottom-right corner of the window is set to <span class="strong"><strong>All files</strong></span> by default. To hide all unnecessary files, choose the <span class="strong"><strong>ESRI shapefiles</strong></span> file type. In future, don't forget to adjust the filter according to the desired file type.</p></div></li></ul></div><p>Alternatively, you can use the <span class="strong"><strong>Browser</strong></span> panel to navigate to the working directory. Select the files you want to load (either one or several, by holding down the <span class="emphasis"><em>Ctrl</em></span> key), and then just drag and drop them onto the map area. If you want to simplify the navigation, add the folder you are currently working with to <span class="strong"><strong>Favourites</strong></span> from its right-click menu shortcut.</p><div class="mediaobject"><img src="../Images/image00287.jpeg" alt="Loading shapefiles"/></div><p style="clear:both; height: 1em;"> </p><p>The loaded<a id="id42" class="indexterm"/> files are assigned random colors. Don't worry about that as of now; we will cover layer symbology in <a class="link" title="Chapter 2. Visualizing and Styling the Data" href="part0021.xhtml#aid-K0RQ1">Chapter 2</a>, <span class="emphasis"><em>Visualizing and Styling the Data</em></span>.</p></div><div class="section" title="Loading rasters"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Loading rasters</h2></div></div></div><p>The procedure of adding<a id="id43" class="indexterm"/> raster files is similar to what was described earlier, so we will briefly go through it for the example of the common raster file format <span class="strong"><strong>GeoTIFF</strong></span>:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">
You can load a raster file by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Add Layer</strong></span> | <span class="strong"><strong>Add Raster Layer</strong></span>, by clicking on the relevant button <span class="inlinemediaobject"><img src="../Images/image00288.jpeg" alt="Loading rasters"/></span> on the <span class="strong"><strong>Manage Layers</strong></span> toolbar, or by using the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>R</em></span> keyboard shortcut.
</li><li class="listitem">In the <span class="strong"><strong>Open a GDAL Supported Raster Data Source</strong></span> window, go to the work directory.</li><li class="listitem">To see<a id="id44" class="indexterm"/> available the GeoTIFF files, remember to adjust a file type filter, select one or more files (by holding down the <span class="emphasis"><em>Ctrl</em></span> key), and click on <span class="strong"><strong>Open</strong></span>. Alternatively, you can drag and drop rasters from the <span class="strong"><strong>Browser</strong></span> panel.</li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="Loading data from the Personal GeoDatabase"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Loading data from the Personal GeoDatabase</h2></div></div></div><p>ESRI Personal GeoDatabase is an original ArcGIS data format where all of the database's content is held in a single <code class="literal">.mdb</code> Microsoft Access file. It is widely used to store data in a single data file instead of multiple files of different formats.</p><p>Adding an ESRI file geodatabase<a id="id45" class="indexterm"/> to QGIS is similar to adding any other vector format:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">
Access the dialogue window by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Add Layer</strong></span> | <span class="strong"><strong>Add Vector Layer</strong></span>, or by clicking on the relevant button <span class="inlinemediaobject"><img src="../Images/image00286.jpeg" alt="Loading data from the Personal GeoDatabase"/></span> on the <span class="strong"><strong>Manage Layers</strong></span> toolbar, or with the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>V</em></span> keyboard shortcut.</li><li class="listitem">Go to the work directory, set the file type filter to <span class="strong"><strong>ESRI Personal GeoDatabase</strong></span>, and select the database file you want to import data from.</li><li class="listitem">In the <span class="strong"><strong>Select vector layers to add...</strong></span> window, you will see the available layers and their characteristics. Click on the layers to be added and hit <span class="strong"><strong>OK</strong></span>.<div class="mediaobject"><img src="../Images/image00289.jpeg" alt="Loading data from the Personal GeoDatabase"/></div><p style="clear:both; height: 1em;"> </p><div class="note" title="Note"><h3 class="title"><a id="note03"/>Note</h3><p>Raster layers contained in the database will be interpreted and loaded into QGIS as bounding-box polygons. If the data is stored in tables that do not contain any spatial features, the geometry type will be displayed as <span class="strong"><strong>Unknown</strong></span>. The tables will be loaded <a id="id46" class="indexterm"/>and available for exporting to other formats (for example, <code class="literal">.dbf</code>) or joining with spatial data layers.</p></div></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="Importing CSV files"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Importing CSV files</h2></div></div></div><p>A <span class="strong"><strong>Comma-separated values</strong></span> (<span class="strong"><strong>CSV</strong></span>) file is another popular data file format. In fact, it is just a spreadsheet <a id="id47" class="indexterm"/>with field values delimited by commas. There are various delimiters possible instead of<a id="id48" class="indexterm"/> commas (for example, tabs, spaces, colons and so on). Very often, these tables contain spatial data in the form of positional attributes represented by point longitude or latitude (<span class="emphasis"><em>XY</em></span>) coordinates, or <span class="strong"><strong>well-known text (WKT)</strong></span> geometry that describes points, lines, or polygons.</p><p>In our dataset, we have a CSV file called <code class="literal">noise.csv</code>. It contains the details of noise complaints registered mostly by the New York City Police Department. To add this file as a spatial layer, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">
Open the <span class="strong"><strong>Create a Layer from a Delimited Text File</strong></span> dialog window by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Add Layer</strong></span> | <span class="strong"><strong>Add Delimited Text Layer</strong></span>, or just click on the relevant button <span class="inlinemediaobject"><img src="../Images/image00290.jpeg" alt="Importing CSV files"/></span> in the <span class="strong"><strong>Manage Layers</strong></span> toolbar.
</li><li class="listitem">After browsing and pointing to your file, QGIS tries to parse it using the specified delimiter. By default, the comma delimiter is used, but you can specify any<a id="id49" class="indexterm"/> other delimiter using <span class="strong"><strong>Custom delimiters</strong></span> (comma, tab, space, and so on) or <span class="strong"><strong>Regular expression delimiter</strong></span>.<div class="mediaobject"><img src="../Images/image00291.jpeg" alt="Importing CSV files"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">The dialog also<a id="id50" class="indexterm"/> provides access to a number of other useful settings; for example, turning on <span class="strong"><strong>First record has field names</strong></span> creates headers for fields. After defining the geometry as <span class="strong"><strong>Point coordinates</strong></span>, <span class="strong"><strong>X field</strong></span> and <span class="strong"><strong>Y field</strong></span> containing <span class="strong"><strong>Longitude</strong></span> and <span class="strong"><strong>Latitude</strong></span> values will be loaded from the dataset automatically.</li><li class="listitem">After you have clicked on <span class="strong"><strong>OK</strong></span>, QGIS reads the data and might show a delimited text file error message similar to <span class="strong"><strong>Errors in file full_path_to_the_file/filename.csv 100 records discarded due to missing geometry definitions</strong></span>. This means that some points do not contain geographic <a id="id51" class="indexterm"/>coordinates, and so they<a id="id52" class="indexterm"/> cannot be located properly. After closing the message window, you will be prompted to specify the<a id="id53" class="indexterm"/> <span class="strong"><strong>Coordinate Reference System</strong></span> (<span class="strong"><strong>CRS</strong></span>) for the layer.<div class="mediaobject"><img src="../Images/image00292.jpeg" alt="Importing CSV files"/></div><p style="clear:both; height: 1em;"> </p><p>As we can<a id="id54" class="indexterm"/> see from the <span class="strong"><strong>Latitude</strong></span> and <span class="strong"><strong>Longitude</strong></span> column values, point coordinates were originally registered by the receiving devices of the <span class="strong"><strong>Global Position System</strong></span> (<span class="strong"><strong>GPS</strong></span>) in decimal degrees. It is also known that GPS uses the WGS 84 CRS. This is why in the <span class="strong"><strong>Coordinate Reference System Selector</strong></span> window, we enter the <span class="strong"><strong>EPSG: 4326</strong></span> code filter and specify <span class="strong"><strong>WGS 84</strong></span> under <span class="strong"><strong>Geographic Coordinate Systems</strong></span> as the initial CRS. After <a id="id55" class="indexterm"/>clicking on <span class="strong"><strong>OK</strong></span>, you will see that the data is rendered in the map canvas as points.</p><div class="note" title="Note"><h3 class="title"><a id="note04"/>Note</h3><p>QGIS uses CRS definitions based on the European Petroleum Search Group's (EPSG) Geodetic Parameter Dataset, which contains detailed structured descriptions of coordinate reference systems and transformations of global, regional, national, and local applications. The database of EPSG identifiers can be used to specify a CRS in QGIS. You can read more about the EPSG Geodetic Parameter Dataset at <a class="ulink" href="http://www.epsg-registry.org/">http://www.epsg-registry.org/</a>.</p></div></li></ol><div style="height:10px; width: 1px"/></div></div><div class="section" title="Loading GPS data"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Loading GPS data</h2></div></div></div><p>As GPS receivers became<a id="id56" class="indexterm"/> portable and relatively cheap, GPS tracking became a ubiquitous and widely used technique of collecting data during a field survey, or simply tracking your own routes while running or cycling. Depending on the receiver's capabilities, in addition to spatial coordinates, a lot of information can be registered and written—for example, time, elevation, and so on. Registered information is stored in points that represent location changes (way, track, or route points), a planned route (if it exists), and a track of movement. There are numerous formats for storing GPS data. As primary data format, QGIS uses the standard interchange <span class="strong"><strong>GPX</strong></span> (<span class="strong"><strong>GPS eXchange</strong></span>) format.</p><p>We will load the <code class="literal">nyc_marathon.gpx</code> file from our dataset. You can load a <code class="literal">.gpx</code> file as a vector layer by going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Add Layer</strong></span> | <span class="strong"><strong>Add Vector Layer</strong></span>, by clicking on the relevant button <span class="inlinemediaobject"><img src="../Images/image00286.jpeg" alt="Loading GPS data"/></span> in the <span class="strong"><strong>Manage Layers</strong></span> toolbar, or by using the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>V</em></span> keyboard shortcut. Go to the data directory and apply the <span class="strong"><strong>GPS eXchange format (GPX)</strong></span> file type filter. Select the file (or files) you want to add and click on <span class="strong"><strong>Open</strong></span>. Alternatively, you can drag and drop files from the <span class="strong"><strong>Browser</strong></span> panel.</p><div class="mediaobject"><img src="../Images/image00293.jpeg" alt="Loading GPS data"/></div><p style="clear:both; height: 1em;"> </p><p>As GPS data consists of points, routes, and tracks, the window pops up where you choose exactly which feature you want to open. You can select one or more features by clicking on a row and holding down the <span class="emphasis"><em>Ctrl</em></span> key. If you are not sure exactly which feature you need, use <span class="strong"><strong>Select All</strong></span>. Every feature type will be presented in a separate layer. By turning layers on and off, you can check whether they contain data or not; for example, the file we work with contains only tracks and track points. You can remove unnecessary empty<a id="id57" class="indexterm"/> layers by right-clicking on the layer contextual shortcut <span class="strong"><strong>Remove</strong></span>.</p><div class="note" title="Note"><h3 class="title"><a id="note05"/>Note</h3><p>Advanced options for working with GPS data are available through the <span class="strong"><strong>GPS Tools</strong></span> core plugin. After activation, the plugin functions can be accessed by navigating to <span class="strong"><strong>Vector</strong></span> | <span class="strong"><strong>GPS</strong></span> | <span class="strong"><strong>GPS Tools</strong></span>, or from the <span class="inlinemediaobject"><img src="../Images/image00294.jpeg" alt="Loading GPS data"/></span> button on the <span class="strong"><strong>Vector toolbar</strong></span> panel.</p></div></div><div class="section" title="Getting OpenStreetMap data"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>Getting OpenStreetMap data</h2></div></div></div><p><span class="strong"><strong>OpenStreetMap</strong></span> (<span class="strong"><strong>OSM</strong></span>) is a crowdsourcing<a id="id58" class="indexterm"/> project aimed at the development of an open map of the world. Worldwide, the OSM<a id="id59" class="indexterm"/> community uses high-resolution remote sensing imagery, GPS surveying, and local knowledge to make the map as accurate and detailed as possible. As the OSM data is licensed under Open Data Commons'<span class="strong"><strong> Open Database License</strong></span> (<span class="strong"><strong>ODbL</strong></span>), it has<a id="id60" class="indexterm"/> recently become a widely used source of spatial data. Understanding the importance of unrestricted access to spatial data, QGIS supports OSM, providing integrated access and support for its data.</p><p>The QGIS core functionality is available from the <span class="strong"><strong>OpenStreetMap</strong></span> menu under<span class="strong"><strong> Vector</strong></span>. Here, you can find all the required tools to download the data and export it into conventional spatial data formats, but if you are new to the QGIS and OSM data concepts, you may find the process tedious. This is why we recommend that you use external <span class="strong"><strong>QuickOSM</strong></span> plugin capabilities to download the OSM data.</p><p>After installation as <a id="id61" class="indexterm"/>described in the <span class="emphasis"><em>Extending functionality through plugins</em></span> section, the plugin's main functionality can be accessed by going to <span class="strong"><strong>Web</strong></span> | <span class="strong"><strong>QuickOSM</strong></span> | <span class="strong"><strong>QuickOSM</strong></span>. The <span class="strong"><strong>Quick query</strong></span> tab of the main window contains everything you need to perform a query and get the data into QGIS. First, define a <code class="literal">key=value</code> pair from the drop-down lists, or just type it in manually.</p><div class="note" title="Note"><h3 class="title"><a id="note06"/>Note</h3><p>It can be quite difficult to select the appropriate tags for the first time if you are not familiar with the OSM tagging system. Each tag is a <code class="literal">key=value</code> pair that describes some point, linear, or polygonal feature. The key describes a broad class (for example, amenities), while the value gives the details (bank, cinema, café, bicycle parking, and so on). Use the <span class="strong"><strong>Help with key/value</strong></span> button to know more about tagging from the<a id="id62" class="indexterm"/> OSM wiki page at <a class="ulink" href="http://wiki.openstreetmap.org/wiki/Mapfeatures">http://wiki.openstreetmap.org/wiki/Mapfeatures</a>.</p></div><p>Then, set up the area of interest extent by location name, map canvas, or layer. If the layer drop-down list is inactive, click on the <span class="inlinemediaobject"><img src="../Images/image00295.jpeg" alt="Getting OpenStreetMap data"/></span> button beside it to refresh it. In the <span class="strong"><strong>Advanced</strong></span> section, you can turn on/off different geometry types. By default, all geometry types are turned on, so all the relevant points, lines, and polygons will be downloaded. Browse to the directory you want to save the data in. In the following screenshot, you can see the example of the QuickOSM query used to download bicycle parking point data.</p><div class="mediaobject"><img src="../Images/image00296.jpeg" alt="Getting OpenStreetMap data"/></div><p style="clear:both; height: 1em;"> </p><div class="note" title="Note"><h3 class="title"><a id="tip07"/>Tip</h3><p>If you are<a id="id63" class="indexterm"/> familiar with the <span class="strong"><strong>Overpass API </strong></span>query language, you can click on <span class="strong"><strong>Show query</strong></span> or the <span class="strong"><strong>Query</strong></span> tab to modify the initial query.</p></div><p>After clicking on the <span class="strong"><strong>Run query</strong></span> button, the shapefile with the data will be loaded into the map canvas.</p></div></div>
<div class="section" title="Dealing with projections"><div class="titlepage" id="aid-H5A42"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Dealing with projections</h1></div></div></div><p>Projections define how real-world objects on the curved surface of the earth will be flattened and projected on a map-like planar surface. Different data sources are usually created and distributed<a id="id64" class="indexterm"/> in different projections, depending on acquisition techniques and the scope of application. To be able to manipulate and analyze them properly in QGIS, it is important to understand how it interprets and manages information about projections.</p><p>QGIS supports about 2,700<a id="id65" class="indexterm"/> CRS. They constitute a database, each item of which is described by an <span class="strong"><strong>ESPG identifier</strong></span>, and a description line in the format of the <span class="strong"><strong>PROJ.4</strong></span> projection library. To store and read information about projection, QGIS uses its own format stored in <code class="literal">.qpj</code> files. There are two important points to keep in mind while working with projections: a data source projection and project projection—which are not always the same.</p><div class="section" title="Data source projection"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec15"/>Data source projection</h2></div></div></div><p>When you load your<a id="id66" class="indexterm"/> data into QGIS, it tries to automatically define information about the projection from the accompanying projection description file and <a id="id67" class="indexterm"/>set it to a newly added layer. You can check the layer's projection information in the <span class="strong"><strong>Layer Properties</strong></span> dialog. To open it, double-click on the layer name in <span class="strong"><strong>Layers</strong></span> panel, or use the right-click contextual shortcut <span class="strong"><strong>Properties</strong></span>. Information about the projection is shown in the <span class="strong"><strong>Coordinate reference system</strong></span> section of the <span class="strong"><strong>General</strong></span> tab, like this:</p><div class="mediaobject"><img src="../Images/image00297.jpeg" alt="Data source projection"/></div><p style="clear:both; height: 1em;"> </p><p>There are numerous projection description file formats, and they mostly depend on the data format and origin. One of the most common among them is a <code class="literal">.prj</code> file. This file format sometimes provides information about the projection in a reduced form, and QGIS cannot define it properly. If information about the projection is absent or incomplete, you will see that the<a id="id68" class="indexterm"/> projection description is missing or looks like this: <code class="literal">USER:100000 - * Generated CRS (+proj=etc.)</code>. It means that QGIS <a id="id69" class="indexterm"/>didn't find an appropriate projection within its own database and added it as a custom CRS. If you are sure that the projection is standard but QGIS fails to interpret it properly because of a reduced description, specify it manually. There are different ways to assess the <span class="strong"><strong>Coordinate Reference System Selector</strong></span> dialog as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">
Double-click on the layer name in <span class="strong"><strong>Layers</strong></span> panel to open the <span class="strong"><strong>Layer Properties</strong></span> dialog. Under the <span class="strong"><strong>General</strong></span> tab, click on the <span class="strong"><strong>Select CRS</strong></span> button <span class="inlinemediaobject"><img src="../Images/image00298.jpeg" alt="Data source projection"/></span> to select the necessary CRS from the <span class="strong"><strong>Coordinate reference system selector</strong></span> dialog window.
</li><li class="listitem">By going to <span class="strong"><strong>Layer</strong></span> | <span class="strong"><strong>Set CRS of Layer(s)</strong></span>.</li><li class="listitem">Using the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>C</em></span> keyboard shortcut.</li><li class="listitem">By right-clicking on the layer shortcut <span class="strong"><strong>Set Layer CRS</strong></span>.</li></ul></div><p>In the <span class="strong"><strong>Coordinate reference system selector</strong></span> dialog, choose the necessary CRS from the list and click on <span class="strong"><strong>OK</strong></span>. Note that you can use a filter by key words or the EPSG code to hide unnecessary projections. With time, often used projections will be added to the list of the recently used CRS.</p><div class="note" title="Note"><h3 class="title"><a id="note07"/>Note</h3><p>If QGIS doesn't define a projection for your data automatically and you are not sure about projection name and EPSG code, use the<a id="id70" class="indexterm"/> Prj2EPSG website at <a class="ulink" href="http://prj2epsg.org/">http://prj2epsg.org/</a>. In this service, you just need to upload your <code class="literal">.prj</code> file, and well-known text projection information from it will be converted into standard EPSG code.</p></div><p>Note that specifying the projection manually from the <span class="strong"><strong>Properties</strong></span> dialog is a temporary solution; it does not persist after closing a file and/or exiting QGIS. This means that whenever you are loading this file into QGIS, you will have to specify the projection again. If you are going to work with the file in other projects, it is better to use the <span class="strong"><strong>Define Current Projection</strong></span> tool by going to<span class="strong"><strong> Vector</strong></span> | <span class="strong"><strong>Data Management Tools</strong></span> | <span class="strong"><strong>Define Current Projection</strong></span>. In this dialog, you can choose a predefined spatial reference system from the <span class="strong"><strong>Coordinate reference system Selector</strong></span> dialog or <span class="strong"><strong>Import spatial reference system from existing layer</strong></span> with a known CRS. In both the cases, the existing <code class="literal">.prj</code> file will be overwritten by QGIS with all the necessary parameters, and you will not have to adjust the projection<a id="id71" class="indexterm"/> manually next time.</p><div class="mediaobject"><img src="../Images/image00299.jpeg" alt="Data source projection"/></div><p style="clear:both; height: 1em;"> </p><p>All of this is<a id="id72" class="indexterm"/> true when you import files from external sources. If you create a shapefile in QGIS, both <code class="literal">.prj</code> and <code class="literal">.qpj</code> files are created, so you don't need to define the projection manually. The files projection will be interpreted correctly in the other GIS applications that read it from <code class="literal">.prj</code> files.</p><p>You can also maintain QGIS behavior when loading or creating a new layer that has no CRS information by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Options</strong></span> | <span class="strong"><strong>CRS</strong></span>, where three alternatives of CRS for new layers are available:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><span class="strong"><strong>Prompt for CRS</strong></span>: In this case, you will always be asked to manually specify the CRS for the layer.</li><li class="listitem"><span class="strong"><strong>Use project CRS</strong></span>: The data will be automatically assigned a CRS set for a project. This is a convenient choice if you are using files in the same projection, but if their projection differs from what is specified, you will not be able to see them.</li><li class="listitem"><span class="strong"><strong>Use default CRS displayed below</strong></span>: Conventionally, <span class="strong"><strong>EPSG:4326 - WGS 84</strong></span> is used, but you can specify your own choice.</li></ol><div style="height:10px; width: 1px"/></div><p>Working with <a id="id73" class="indexterm"/>projections can be tricky, unless you recognize the difference between the <span class="strong"><strong>specify</strong></span> and <span class="strong"><strong>define projection</strong></span> options. It's all about assigning information about the projection properly, but when you specify it, the result is<a id="id74" class="indexterm"/> temporary within a current working session. Once you define a projection, it becomes permanent unless redefined again. In both cases, if you choose the wrong projection, you will not be able to see your data on the map (at least in the area where you expect it to be). Usually it is good practice to specify the projection at first, comparing your data to the correctly projected dataset. If everything is okay, define it to make projection assignment permanent.</p></div><div class="section" title="Project projection"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec16"/>Project projection</h2></div></div></div><p>When you load QGIS, its map<a id="id75" class="indexterm"/> canvas projection is, by default, set to <span class="strong"><strong>EPSG:4326 – WGS 84</strong></span>. This behavior is defined by the global default projection, which can be changed by going to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Options</strong></span> | <span class="strong"><strong>CRS</strong></span> | <span class="strong"><strong>Always start new projects with this CRS</strong></span>.</p><p>However, when you<a id="id76" class="indexterm"/> start adding data, projection identifier automatically changes to the projection of the first loaded layer. So, by default, project projection is defined by the first loaded layer. Data source projection and project projection are not always the same. If they are different, QGIS can apply the so-called <span class="strong"><strong>on-the-fly transformation</strong></span>. This means that it reads the data projection, and if it differs, automatically aligns it with the project projection, applying the necessary transformations. There are a few ways to specify the projection for the project and enable on-the-fly transformation:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">By going to <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>Project Properties</strong></span> | <span class="strong"><strong>CRS</strong></span>.</li><li class="listitem">
Click on the <span class="strong"><strong>Current CRS</strong></span><span class="inlinemediaobject"><img src="../Images/image00278.jpeg" alt="Project projection"/></span> button on the <span class="strong"><strong>Status</strong></span> bar, and activating <span class="strong"><strong>Enable 'on the fly' CRS transformation</strong></span> in the <span class="strong"><strong>Project properties</strong></span> | <span class="strong"><strong>CRS</strong></span> window.</li><li class="listitem">Go to <span class="strong"><strong>Settings</strong></span> | <span class="strong"><strong>Options</strong></span> | <span class="strong"><strong>CRS</strong></span> | <span class="strong"><strong>Default CRS for new projects</strong></span>. Activate either <span class="strong"><strong>Automatically enable 'on the fly' reprojection if layers have different CRS</strong></span> or <span class="strong"><strong>Enable 'on the fly' reprojection by default</strong></span>.</li></ul></div><p>In the last way, the difference is very subtle and is mainly obvious when adding the first layer to the project. In the case of automatically enabled reprojection, the default map canvas CRS will be superseded by the first layer projection, and the following layers will be automatically adjusted to it too. In the case of reprojection by default, all layers will be reprojected<a id="id77" class="indexterm"/> into the project initial CRS (this is usually default global projection, unless you've changed it).</p><p>After on-the-fly transformation is enabled, you will see an <span class="strong"><strong>OTF</strong></span> abbreviation near the current CRS on<a id="id78" class="indexterm"/> the status bar, and the icon will become solid.</p><p>If you want to quickly change the project CRS according to a specific layer in the <span class="strong"><strong>Layers</strong></span> panel, right-click on a layer and choose the <span class="strong"><strong>Set Project CRS from Layer</strong></span> shortcut.</p></div></div>
<div class="section" title="Loading layers to a spatial database"><div class="titlepage" id="aid-I3QM2"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Loading layers to a spatial database</h1></div></div></div><p>Now that we have loaded all of the available data into QGIS, let's aggregate it into a single database. QGIS supports working with various database management systems and their spatial extensions (PostgreSQL/PostGIS, Oracle Spatial/GeoRaster, MSSQL Spatial, SQL Anywhere, and SQLite/SpatiaLite). Among them, PostGIS and SpatiaLite are the ones you have <a id="id79" class="indexterm"/>probably already heard about. Being common, these spatial databases are usually used for different purposes. PostGIS is an example of an enterprise solution used mostly on a server to provide spatial data maintenance and access for multiple users. SpatiaLite is a lightweight file database for personal use. Usage of SpatiaLite database has a number of advantages as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem">All of the data is stored in a single, portable file, and you don't get overwhelmed by different file types (for example, <code class="literal">.shp</code>, <code class="literal">.dbf</code>, <code class="literal">.shx</code>, <code class="literal">.prj</code>, <code class="literal">.qpj</code>, and so on)</li><li class="listitem">Shapefile limitations for size (up to 2 GB) and field name length (10 characters) can be omitted</li><li class="listitem">Built-in spatial indices allow you to perform searches for large areas faster</li><li class="listitem">This is a real relational database in a single format that allows you to use various spatial functions and SQL-based workflows</li></ul></div><p>Perform the following steps to assemble your data into a single SpatiaLite database:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">First of all, you need to create an empty spatial database to load your data into. You can do this from the <span class="strong"><strong>Browser</strong></span> panel. Right-click on the <span class="strong"><strong>SpatiaLite</strong></span> entry and choose the <span class="strong"><strong>Create database</strong></span> shortcut. Specify the folder and a <code class="literal">.sqlite</code> database file <a id="id80" class="indexterm"/>name. You will get the <span class="strong"><strong>The database has been created</strong></span> message. Now you can expand the entry and see your newly created empty database.</li><li class="listitem">
We will use the DB Manager core plugin that provides a single interface to work with different databases to load the data. The plugin functionality is accessible by going to <span class="strong"><strong>Database</strong></span> | <span class="strong"><strong>DB Manger</strong></span>. On the left side of the window, you can see a tree list of available database connections grouped by type. Once created, your database will automatically be available under the <span class="strong"><strong>SpatiaLite</strong></span> item, and you can connect to it by double-clicking. When the connection is established, you will see general information about the database or its selected items in the <span class="strong"><strong>Info</strong></span> tab on the right side of the window. To import files into the database, click on the <span class="strong"><strong>Import layer/file</strong></span> button <span class="inlinemediaobject"><img src="../Images/image00300.jpeg" alt="Loading layers to a spatial database"/></span>, or access it from the <span class="strong"><strong>Table</strong></span> menu.
<div class="mediaobject"><img src="../Images/image00301.jpeg" alt="Loading layers to a spatial database"/></div><p style="clear:both; height: 1em;"> </p></li><li class="listitem">In the opened<a id="id81" class="indexterm"/> <span class="strong"><strong>Import vector layer</strong></span> window, you should define the layer you want to import. It could be one of the already loaded layers available in the <span class="strong"><strong>Input</strong></span> drop-down list, or the layer you choose from the filesystem by clicking on the browse button <span class="strong"><strong>...</strong></span>. Then, define the <span class="strong"><strong>Output table</strong></span> name (in our case, it is <code class="literal">ny_boroughs</code>, the same as the input).<div class="mediaobject"><img src="../Images/image00302.jpeg" alt="Loading layers to a spatial database"/></div><p style="clear:both; height: 1em;"> </p><p>The following<a id="id82" class="indexterm"/> options allow you to exercise more control over your data:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><span class="strong"><strong>Primary key</strong></span>: If this is not specified, the field will be named <code class="literal">pk</code> by default</li><li class="listitem"><span class="strong"><strong>Geometry column</strong></span>: If this is not specified, the field will be named <code class="literal">geom</code> by default</li><li class="listitem"><span class="strong"><strong>Source SRID</strong></span> and <span class="strong"><strong>Target SRID</strong></span>: These are CRS EPSG codes read from the data, but you can specify them manually if the data isn't accompanied by projection files, or if you want to reproject it before loading it to the database</li><li class="listitem"><span class="strong"><strong>Encoding</strong></span>: If not specified, the dataset charset is set to <span class="strong"><strong>UTF-8</strong></span> by default</li><li class="listitem"><span class="strong"><strong>Drop existing table</strong></span>: If you import a table with the same name as a previously existing table, it will be replaced by the new table</li><li class="listitem"><span class="strong"><strong>Create single-part geometries instead of multipart</strong></span>: Multipart features will be disaggregated into single-part geometries before loading to the database</li><li class="listitem"><span class="strong"><strong>Create spatial index</strong></span>: A spatial index that allows faster spatial search and query performance will be created</li></ul></div></li></ol><div style="height:10px; width: 1px"/></div><p>After hitting <span class="strong"><strong>OK</strong></span> and waiting a little (depending on the file size, the process may take some time), you will get the <code class="literal">Import was successful</code> message. To explore the imported table click on the <span class="strong"><strong>Refresh</strong></span> button <span class="inlinemediaobject"><img src="../Images/image00303.jpeg" alt="Loading layers to a spatial database"/></span>, and you will see a geometry table in the list of database<a id="id83" class="indexterm"/> items. From the <span class="strong"><strong>Info</strong></span> tab, you can view information about table, geometry type, fields, and triggers. The <span class="strong"><strong>Table</strong></span> tab displays data in a tabular form, and the <span class="strong"><strong>Preview</strong></span> tab displays spatial geometry, if any. By right-clicking on any element, you can delete, rename, or add it to the map canvas. All other opened layers can be loaded in a similar way.</p><div class="mediaobject"><img src="../Images/image00304.jpeg" alt="Loading layers to a spatial database"/></div><p style="clear:both; height: 1em;"> </p><div class="note" title="Note"><h3 class="title"><a id="note08"/>Note</h3><p>Aside from the core functionality, there is an external plugin called <span class="strong"><strong>QSpatiaLite</strong></span> that is specially<a id="id84" class="indexterm"/> designed to support work with SpatiaLite databases. After installation, it will be available when you navigate to <span class="strong"><strong>Database</strong></span> | <span class="strong"><strong>SpatiaLite</strong></span> | <span class="strong"><strong>QSpatiaLite</strong></span>.</p></div></div>
<div class="section" title="Summary" id="aid-J2B81"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Summary</h1></div></div></div><p>For now, we have covered a few introductory topics and completed several tasks. First of all, you learned how to install QGIS, configure its interface, and extend functionalities with plugins. Then we discussed common data sources you can use to get data into QGIS. You are now capable of exploring and managing data in different projections. Last but not least, you imported all your data into a portable, lightweight SpatiaLite database file.</p><p>In the next chapter, we will move forward and reveal QGIS's potential for data visualization.</p></div></body></html>