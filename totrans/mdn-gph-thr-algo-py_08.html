<html><head></head><body>
<div id="_idContainer072" class="calibre2">
<h1 class="chapter-number" id="_idParaDest-66"><a id="_idTextAnchor066" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-67" class="calibre5"><a id="_idTextAnchor067" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.2.1">Ecological Data</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.3.1">In this chapter, we’ll introduce some methods commonly used in ecological data collection and then explore graph-theoretic clustering methods that can parse out animal populations across monitored geographic areas. </span><span class="kobospan" id="kobo.3.2">This is a very common problem within ecological research, as populations of animals migrate and overlap with other populations of animals. </span><span class="kobospan" id="kobo.3.3">In addition, parsing out healthy and unhealthy ecosystems is a common survey task for conservation and urban planning. </span><span class="kobospan" id="kobo.3.4">We’ll analyze two types of ecological data</span><a id="_idIndexMarker206" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.4.1"> with </span><strong class="bold"><span class="kobospan" id="kobo.5.1">spectral clustering</span></strong><span class="kobospan" id="kobo.6.1"> to find groups within snake capture count and ecological survey </span><span><span class="kobospan" id="kobo.7.1">text data.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.8.1">By the end of this chapter, you’ll understand how to apply spectral clustering to find groups on networks. </span><span class="kobospan" id="kobo.8.2">You’ll also see how different implementations of spectral clustering can be formulated, with some algorithms scaling better to large networks than </span><span><span class="kobospan" id="kobo.9.1">other algorithms.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.10.1">Specifically, we will cover the </span><span><span class="kobospan" id="kobo.11.1">following topics:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><span class="kobospan" id="kobo.12.1">Introduction to </span><span><span class="kobospan" id="kobo.13.1">ecological data</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.14.1">Spectral </span><span><span class="kobospan" id="kobo.15.1">graph tools</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.16.1">Let’s get started with some background on </span><span><span class="kobospan" id="kobo.17.1">ecological problems.</span></span></p>
<h1 id="_idParaDest-68" class="calibre5"><a id="_idTextAnchor068" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.18.1">Technical requirements</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.19.1">You will require Jupyter Notebook to run the practical examples in this chapter. </span></p>
<p class="calibre3"><span class="kobospan" id="kobo.20.1">The code for this chapter is available </span><span><span class="kobospan" id="kobo.21.1">here: </span></span><a href="https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.22.1">https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python</span></span></a></p>
<h1 id="_idParaDest-69" class="calibre5"><a id="_idTextAnchor069" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.23.1">Introduction to ecological data</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.24.1">Environmental </span><a id="_idIndexMarker207" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.25.1">research plays a large role in conservation strategy, climate change monitoring, and farming practices. </span><span class="kobospan" id="kobo.25.2">Data collected might include data on plant type distributions and densities, animal migration patterns, or extent of disease. </span><span class="kobospan" id="kobo.25.3">For instance, farmers may wish to track crop disease across large farms to monitor potential threats to their annual yield from various crops. </span><span class="kobospan" id="kobo.25.4">Conservationists may wish to track endangered animal populations as they migrate through a national park to deploy anti-poaching resources to areas with large native or migratory populations. </span><span class="kobospan" id="kobo.25.5">Let’s first explore some data </span><span><span class="kobospan" id="kobo.26.1">collection methods.</span></span></p>
<h2 id="_idParaDest-70" class="calibre7"><a id="_idTextAnchor070" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.27.1">Exploring methods to track animal populations across geographies</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.28.1">Animal populations </span><a id="_idIndexMarker208" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.29.1">are frequently mobile, with seasonal changes, weather events, and human interactions driving the movement of animals from one geographic location to another. </span><span class="kobospan" id="kobo.29.2">One of the largest mass migrations of animals occurs in the grasslands of East Africa, where millions of herd animals (such as wildebeests and zebras) trek from the Serengeti to Masai Mara back to the Serengeti each year as rains come and go (</span><span><em class="italic"><span class="kobospan" id="kobo.30.1">Figure 5</span></em></span><em class="italic"><span class="kobospan" id="kobo.31.1">.1</span></em><span class="kobospan" id="kobo.32.1">). </span><span class="kobospan" id="kobo.32.2">Poaching not only harms animal populations but often fuels other illegal activities, creating problems locally and internationally; understanding migration patterns on the borders of protected areas can position resources to </span><span><span class="kobospan" id="kobo.33.1">stem poaching:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer064">
<span class="kobospan" id="kobo.34.1"><img alt="Figure 5.1 – ﻿An illustration of a zebra herd as the rainy season begins" src="image/B21087_05_01.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.35.1">Figure 5.1 – An illustration of a zebra herd as the rainy season begins</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.36.1">There</span><a id="_idIndexMarker209" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.37.1"> are many ways to monitor a population’s movement across geographies. </span><span class="kobospan" id="kobo.37.2">One way involves tagging animals with satellite tracking tags that upload location data for each tagged animal. </span><span class="kobospan" id="kobo.37.3">This allows researchers to construct paths for each animal and aggregate results across tagged populations (which might include only one species or several species of interest). </span><span class="kobospan" id="kobo.37.4">For instance, in the zebra herd, perhaps a conservation team has tagged 10 of </span><a id="_idIndexMarker210" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.38.1">the zebras prior to the rainy season with tags that will track the zebras’ location each hour for a period of several weeks. </span><span class="kobospan" id="kobo.38.2">While we would expect all 10 animals to follow the same general path from one park to the next, individuals may migrate at different paces, take slightly different routes, or stop for food and water in different locations. </span><span class="kobospan" id="kobo.38.3">This data allows researchers to identify subpopulations within the herd whose behavior deviates from the </span><span><span class="kobospan" id="kobo.39.1">herd’s majority.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.40.1">Another common method to track animal populations across geographies is to use trap cameras hidden in locations that are likely to be frequented by species of interest (such as watering holes, clearings in forests, or healthy coral reefs). </span><span class="kobospan" id="kobo.40.2">For instance, suppose public health officials have noticed an increase in king cobra bites in villages near the Atrai River in Bangladesh (</span><span><em class="italic"><span class="kobospan" id="kobo.41.1">Figure 5</span></em></span><em class="italic"><span class="kobospan" id="kobo.42.1">.2</span></em><span class="kobospan" id="kobo.43.1">) and would like to understand the local king cobra population to enact policies to prevent humans and cobras </span><span><span class="kobospan" id="kobo.44.1">from interacting.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.45.1">Perhaps work hours can be adjusted to keep agricultural workers from areas frequented by king cobras at certain times of day or seasons. </span><span class="kobospan" id="kobo.45.2">Officials can set the trap cameras in areas where bites have become more common to capture images of cobras throughout the lifetime of the film used in the trap camera. </span><span class="kobospan" id="kobo.45.3">Several cameras are set throughout the area of interest according to bite densities, and species of venomous snakes, including king cobras, are tracked by time of day, species, and number of individual snakes identified by each camera. </span><span class="kobospan" id="kobo.45.4">Data then informs policies regarding population movement and snake control strategies to mitigate the threat to </span><span><span class="kobospan" id="kobo.46.1">public safety.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer065">
<span class="kobospan" id="kobo.47.1"><img alt="Figure 5.2 – ﻿An illustration of king cobra in rural Bangladesh" src="image/B21087_05_02.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.48.1">Figure 5.2 – An illustration of king cobra in rural Bangladesh</span></p>
<h2 id="_idParaDest-71" class="calibre7"><a id="_idTextAnchor071" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.49.1">Exploring methods to capture plant distributions and diseases</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.50.1">Data capture </span><a id="_idIndexMarker211" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.51.1">on plant distributions and diseases involves a different sort of approach, as plants generally are not moving across geographies. </span><span class="kobospan" id="kobo.51.2">Manual data collection requires human discernment of plant species and diseases, which may be unreliable and will take long periods of time to capture meaningful data. </span><span class="kobospan" id="kobo.51.3">However, autonomous vehicles and drones offer a way to capture images and videos of plants across wide geographic areas, which can be processed </span><a id="_idIndexMarker212" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.52.1">with </span><strong class="bold"><span class="kobospan" id="kobo.53.1">convolutional neural networks</span></strong><span class="kobospan" id="kobo.54.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.55.1">CNNs</span></strong><span class="kobospan" id="kobo.56.1">) trained on plant image data of species native to the study area. </span><span class="kobospan" id="kobo.56.2">For instance, Colombian farmers may want to identify instances of coffee rust early to avoid crop loss by running a coffee rust classifier CNN </span><a id="_idIndexMarker213" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.57.1">on drone or rover data captured weekly across their regional farms (example shown in </span><span><em class="italic"><span class="kobospan" id="kobo.58.1">Figure 5</span></em></span><em class="italic"><span class="kobospan" id="kobo.59.1">.3</span></em><span class="kobospan" id="kobo.60.1">). </span><span class="kobospan" id="kobo.60.2">Images showing potential coffee rust could trigger a system alert that provides a geographic location on the farm or plant identification number </span><span><span class="kobospan" id="kobo.61.1">to farmers.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer066">
<span class="kobospan" id="kobo.62.1"><img alt="Figure 5.3 – ﻿An illustration of a coffee plant image to scan for coffee rust on a Colombian farm" src="image/B21087_05_03.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.63.1">Figure 5.3 – An illustration of a coffee plant image to scan for coffee rust on a Colombian farm</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.64.1">However, the manual documentation of plants can be a useful tool in studies of areas with potentially new plant species to identify through fieldwork. </span><span class="kobospan" id="kobo.64.2">Much of the Congo and Amazon basins are relatively unexplored, and identifying potential new plant species may yield insights</span><a id="_idIndexMarker214" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.65.1"> into an important part of the ecosystem, possible medications to treat human diseases, or the identification of threats from an </span><span><span class="kobospan" id="kobo.66.1">invasive species.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.67.1">Invasive plants may threaten an ecosystem. </span><span class="kobospan" id="kobo.67.2">New species may herald discoveries of new chemical compounds. </span><span class="kobospan" id="kobo.67.3">Let’s consider a botanist doing fieldwork in the Amazon who comes across a new type of mushroom that she hasn’t seen before (</span><span><em class="italic"><span class="kobospan" id="kobo.68.1">Figure 5</span></em></span><em class="italic"><span class="kobospan" id="kobo.69.1">.4</span></em><span class="kobospan" id="kobo.70.1">). </span><span class="kobospan" id="kobo.70.2">To confirm that this is a new mushroom species, our botanist would take photographs, collect a sample for genetic analysis, and log the ecosystem in which she encountered </span><span><span class="kobospan" id="kobo.71.1">the mushroom.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer067">
<span class="kobospan" id="kobo.72.1"><img alt="Figure 5.4 – ﻿An illustration of a potentially new species of mushroom" src="image/B21087_05_04.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.73.1">Figure 5.4 – An illustration of a potentially new species of mushroom</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.74.1">All of these</span><a id="_idIndexMarker215" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.75.1"> data collection methods create spatial data, where some areas may or may not be physically located next to each other. </span><span class="kobospan" id="kobo.75.2">Species found in groups of geographic areas that are far from each other likely correspond to distinct populations that will be impacted by different human and environmental factors. </span><span class="kobospan" id="kobo.75.3">Treating this data as spatial data and applying a few tools from graph theory can help parse out subpopulations of interest within ecological </span><span><span class="kobospan" id="kobo.76.1">data analytics.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.77.1">In many cases, collecting</span><a id="_idIndexMarker216" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.78.1"> biological samples of plants or placing tracking tags on animals is not feasible. </span><span class="kobospan" id="kobo.78.2">However, drones and other autonomous vehicles can snap pictures of flora and fauna in a region (</span><span><em class="italic"><span class="kobospan" id="kobo.79.1">Figure 5</span></em></span><em class="italic"><span class="kobospan" id="kobo.80.1">.5</span></em><span class="kobospan" id="kobo.81.1">), allowing researchers to identify species from the images through a special type of deep learning algorithm and build a network from the deep </span><span><span class="kobospan" id="kobo.82.1">learning results.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer068">
<span class="kobospan" id="kobo.83.1"><img alt="Figure 5.5 – ﻿An illustration of a forest stream, from which flora can be identified through deep-learning algorithms" src="image/B21087_05_05.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.84.1">Figure 5.5 – An illustration of a forest stream, from which flora can be identified through deep-learning algorithms</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.85.1">Now that we know how to collect ecological data, let’s explore a few tools from graph theory that will</span><a id="_idIndexMarker217" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.86.1"> help us analyze ecological data that has been collected across different </span><span><span class="kobospan" id="kobo.87.1">geographical regions.</span></span></p>
<h1 id="_idParaDest-72" class="calibre5"><a id="_idTextAnchor072" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.88.1">Spectral graph tools</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.89.1">The </span><strong class="bold"><span class="kobospan" id="kobo.90.1">adjacency matrix</span></strong><span class="kobospan" id="kobo.91.1"> and </span><strong class="bold"><span class="kobospan" id="kobo.92.1">degree of vertices</span></strong><span class="kobospan" id="kobo.93.1"> in </span><a id="_idIndexMarker218" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.94.1">the adjacency matrix </span><a id="_idIndexMarker219" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.95.1">contain information </span><a id="_idIndexMarker220" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.96.1">about the connectivity of vertices within the network. </span><span class="kobospan" id="kobo.96.2">For an undirected network, the </span><strong class="bold"><span class="kobospan" id="kobo.97.1">Laplacian matrix</span></strong><span class="kobospan" id="kobo.98.1"> of the network is found by subtracting the adjacency matrix </span><a id="_idIndexMarker221" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.99.1">from the degree matrix (i.e., </span><em class="italic"><span class="kobospan" id="kobo.100.1">L = D - A</span></em><span class="kobospan" id="kobo.101.1">, where </span><em class="italic"><span class="kobospan" id="kobo.102.1">D</span></em><span class="kobospan" id="kobo.103.1"> is the degree matrix and </span><em class="italic"><span class="kobospan" id="kobo.104.1">A</span></em><span class="kobospan" id="kobo.105.1"> is the adjacency matrix). </span><span class="kobospan" id="kobo.105.2">This matrix contains information about many important properties of the network, including the number of connected components, the sparsest cut that can separate the network into separate components, and the strength of connection within the </span><span><span class="kobospan" id="kobo.106.1">network overall.</span></span></p>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.107.1">Connectivity</span></strong><span class="kobospan" id="kobo.108.1"> is an</span><a id="_idIndexMarker222" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.109.1"> important concept in graph theory. </span><span class="kobospan" id="kobo.109.2">A </span><strong class="bold"><span class="kobospan" id="kobo.110.1">connected network</span></strong><span class="kobospan" id="kobo.111.1"> is </span><a id="_idIndexMarker223" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.112.1">one in which there is a path between all pairs of vertices; a </span><strong class="bold"><span class="kobospan" id="kobo.113.1">disconnected network</span></strong><span class="kobospan" id="kobo.114.1"> is </span><a id="_idIndexMarker224" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.115.1">one in which some vertices do not have paths to all other vertices. </span><span class="kobospan" id="kobo.115.2">Connected networks can be separated by cutting edges; the </span><strong class="bold"><span class="kobospan" id="kobo.116.1">minimum cut set</span></strong><span class="kobospan" id="kobo.117.1"> is</span><a id="_idIndexMarker225" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.118.1"> the set of the fewest edges that need to be removed to separate a network into two pieces to disconnect a connected network. </span><span class="kobospan" id="kobo.118.2">Not only do these values connect to theoretical results in graph theory related to spreading processes and other differential equations defined on the network, but this information also tells us about how to separate groups on </span><span><span class="kobospan" id="kobo.119.1">the network.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.120.1">To obtain this information, we need to perform a decomposition on the Laplacian matrix to obtain eigenvectors and eigenvalues (the network spectrum). </span><span class="kobospan" id="kobo.120.2">Sometimes, we normalize the Laplacian matrix first; in spectral clustering, this is less of a necessity than when computing specific graph theoretic values from the spectrum. </span><span class="kobospan" id="kobo.120.3">Then, we find the Laplacian matrix’s eigenvalues and eigenvectors. </span><span class="kobospan" id="kobo.120.4">In practice, this is done through an algorithm rather than through linear algebra </span><span><span class="kobospan" id="kobo.121.1">operations directly.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.122.1">The second eigenvalue obtained from this process </span><a id="_idIndexMarker226" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.123.1">corresponds to the </span><strong class="bold"><span class="kobospan" id="kobo.124.1">Fiedler value</span></strong><span class="kobospan" id="kobo.125.1"> (also termed </span><strong class="bold"><span class="kobospan" id="kobo.126.1">algebraic connectivity</span></strong><span class="kobospan" id="kobo.127.1">); this </span><a id="_idIndexMarker227" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.128.1">value calculates how many connected components exist in the network and relates to the robustness of the network. </span><span class="kobospan" id="kobo.128.2">The corresponding eigenvector partitions the network into separate networks, thus providing a two-cluster solution to partitioning groups on the network. </span><span class="kobospan" id="kobo.128.3">In spectral clustering, this process of partitioning a network into two separate networks can be repeated until a predefined stopping point is reached (such as a total number </span><span><span class="kobospan" id="kobo.129.1">of clusters).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.130.1">Spectral clustering</span><a id="_idIndexMarker228" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.131.1"> on spatial networks constructed from ecological data allows researchers to partition out areas in which animals migrate, distinguish populations that might be isolated, and catalog differences in vegetation type or crop disease. </span><span class="kobospan" id="kobo.131.2">Let’s set up a simple example and explore different ways to compute </span><span><span class="kobospan" id="kobo.132.1">spectral clustering.</span></span></p>
<h1 id="_idParaDest-73" class="calibre5"><a id="_idTextAnchor073" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.133.1">Clustering ecological populations using spectral graph tools</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.134.1">Consider a</span><a id="_idIndexMarker229" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.135.1"> researcher in Gabon hoping to understand the interconnectivity of Gaboon viper populations in a protected </span><a id="_idIndexMarker230" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.136.1">area of Loango National Park (</span><span><em class="italic"><span class="kobospan" id="kobo.137.1">Figure 5</span></em></span><em class="italic"><span class="kobospan" id="kobo.138.1">.6</span></em><span class="kobospan" id="kobo.139.1">). </span><span class="kobospan" id="kobo.139.2">Snakes are tagged in seven regions of the park (represented by a vertex), and their tags record their location for the next month. </span><span class="kobospan" id="kobo.139.3">Snakes often will move between regions if their habitat overlaps with multiple regions. </span><span class="kobospan" id="kobo.139.4">It’s possible that multiple populations of snakes exist, giving different territories for different populations of snakes. </span><span class="kobospan" id="kobo.139.5">If the two regions share a regional population, then the two vertices corresponding to these regions will have an edge. </span><span class="kobospan" id="kobo.139.6">If no snakes migrate between regions, two vertices will not share an edge and likely represent different populations. </span><span class="kobospan" id="kobo.139.7">Isolated populations tend to be more vulnerable to climate change, poaching, and habitat loss; understanding species and individual population ranges is critical to </span><span><span class="kobospan" id="kobo.140.1">conservation efforts.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer069">
<span class="kobospan" id="kobo.141.1"><img alt="Figure 5.6 – ﻿An illustration of a ﻿Gaboon viper on the forest floor" src="image/B21087_05_06.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.142.1">Figure 5.6 – An illustration of a Gaboon viper on the forest floor</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.143.1">Let’s create </span><a id="_idIndexMarker231" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.144.1">some data on our</span><a id="_idIndexMarker232" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.145.1"> snake population movements with </span><span><strong class="source-inline"><span class="kobospan" id="kobo.146.1">Script 5.1</span></strong></span><span><span class="kobospan" id="kobo.147.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.148.1">
#create snake area network adjacency matrix
import numpy as np
import networkx as nx
np.random.seed(0)
adj_mat = [[1,1,1,0,0,0,1],
           [1,1,1,0,0,0,0],
           [1,1,1,0,0,0,0],
           [0,0,0,1,1,1,0],
           [0,0,0,1,1,1,0],
           [0,0,0,1,1,1,1],
           [1,0,0,0,0,1,1]]
adj_mat = np.array(adj_mat)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.149.1">In practice, geographic </span><a id="_idIndexMarker233" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.150.1">regions rarely share borders with all other regions in a dataset. </span><strong class="bold"><span class="kobospan" id="kobo.151.1">Spatial weighting</span></strong><span class="kobospan" id="kobo.152.1"> encodes </span><strong class="bold"><span class="kobospan" id="kobo.153.1">regional connectivity</span></strong><span class="kobospan" id="kobo.154.1">. </span><span class="kobospan" id="kobo.154.2">Geographically isolated areas are not likely to contain</span><a id="_idIndexMarker234" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.155.1"> overlapping snake populations. </span><span class="kobospan" id="kobo.155.2">However, it is possible that snakes will </span><a id="_idIndexMarker235" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.156.1">migrate across geographically isolated regions, and spatial weighting might not be appropriate in some animal </span><a id="_idIndexMarker236" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.157.1">population studies; however, Loango National Park does not include major barriers to travel like some mountainous or island geographies. </span><span class="kobospan" id="kobo.157.2">Here, we’ll add to </span><strong class="source-inline"><span class="kobospan" id="kobo.158.1">Script 5.1</span></strong><span class="kobospan" id="kobo.159.1"> spatial weighting component (weights total) to our adjacency matrix of snake overlap (</span><strong class="source-inline"><span class="kobospan" id="kobo.160.1">adj_mat</span></strong><span class="kobospan" id="kobo.161.1">) to derive a weighted adjacency </span><span><span class="kobospan" id="kobo.162.1">matrix (</span></span><span><strong class="source-inline"><span class="kobospan" id="kobo.163.1">adj_mat_w</span></strong></span><span><span class="kobospan" id="kobo.164.1">):</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.165.1">
#create spatial weight matrix
weights_total = [[1,1,1,0,0,0,1],
           [1,1,1,0,0,0,0],
           [1,1,1,0,0,0,0],
           [0,0,0,1,1,1,1],
           [0,0,0,1,1,1,1],
           [0,0,0,1,1,1,1],
           [1,0,0,1,1,1,1]]
weights_total = np.array(weights_total)
adj_mat_w=np.multiply(adj_mat,weights_total)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.166.1">We can create and explore our degree matrix, as well as our Laplacian matrix (subtracting the adjacency matrix from the degree matrix). </span><span class="kobospan" id="kobo.166.2">Let’s add this information to </span><span><strong class="source-inline"><span class="kobospan" id="kobo.167.1">Script 5.1</span></strong></span><span><span class="kobospan" id="kobo.168.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.169.1">
#explore degree and Laplacian matrices
degree_matrix=np.diag(adj_mat_w.sum(axis=1))
laplacian_matrix=degree_matrix-adj_mat_w
print(degree_matrix)
print(laplacian_matrix)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.170.1">The degree</span><a id="_idIndexMarker237" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.171.1"> matrix encodes the number of vertices connected to a given vertex and serves as a basic measure of</span><a id="_idIndexMarker238" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.172.1"> centrality. </span><span class="kobospan" id="kobo.172.2">Hubs have high degree scores, while more isolated regions might have a degree of zero or one. </span><span class="kobospan" id="kobo.172.3">Our network of snake population overlap has similar degree centrality measures across the </span><span><span class="kobospan" id="kobo.173.1">entire network:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.174.1">
[[4 0 0 0 0 0 0]
 [0 3 0 0 0 0 0]
 [0 0 3 0 0 0 0]
 [0 0 0 3 0 0 0]
 [0 0 0 0 3 0 0]
 [0 0 0 0 0 4 0]
 [0 0 0 0 0 0 3]]</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.175.1">Let’s now look at the Laplacian matrix, which encodes the connectivity information we’ll use in our spectral decomposition </span><span><span class="kobospan" id="kobo.176.1">and clustering:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.177.1">
[[ 3 -1 -1  0  0  0 -1]
 [-1  2 -1  0  0  0  0]
 [-1 -1  2  0  0  0  0]
 [ 0  0  0  2 -1 -1  0]
 [ 0  0  0 -1  2 -1  0]
 [ 0  0  0 -1 -1  3 -1]
 [-1  0  0  0  0 -1  2]]</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.178.1">There are multiple ways we can compute the Fielder vector to get our spectral clustering results. </span><span class="kobospan" id="kobo.178.2">We’ll go through two ways to compute this with Python. </span><span class="kobospan" id="kobo.178.3">You may need to replace </span><strong class="source-inline"><span class="kobospan" id="kobo.179.1">nx.from_numpy_matrix</span></strong><span class="kobospan" id="kobo.180.1"> with </span><strong class="source-inline"><span class="kobospan" id="kobo.181.1">nx.from_numpy_array</span></strong><span class="kobospan" id="kobo.182.1">, depending on your version of NetworkX. </span><span class="kobospan" id="kobo.182.2">Depending on the size of the problem, it may be easier</span><a id="_idIndexMarker239" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.183.1"> to use a linear algebra solver similar to the one we added to </span><span><span class="kobospan" id="kobo.184.1">Script 5.1:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.185.1">
#define Fiedler vector and obtain clustering
G = nx.from_numpy_matrix(adj_mat_w)
ev = nx.linalg.algebraicconnectivity.fiedler_vector(G)
labels = [0 if v &lt; 0 else 1 for v in ev]
labels
nx.draw(G,with_labels=True, node_color=labels)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.186.1">This</span><a id="_idIndexMarker240" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.187.1"> shows two distinct snake populations that converge to the sixth region of our Loango National Park sampling area (along with snakes staying in the exact same area, noted by loops), as shown in </span><span><em class="italic"><span class="kobospan" id="kobo.188.1">Figure 5</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.189.1">.7</span></em></span><span><span class="kobospan" id="kobo.190.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer070">
<span class="kobospan" id="kobo.191.1"><img alt="Figure 5.7 – Spectral clustering of snake populations" src="image/B21087_05_07.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.192.1">Figure 5.7 – Spectral clustering of snake populations</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.193.1">Scikit-learn </span><a id="_idIndexMarker241" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.194.1">provides a spectral </span><a id="_idIndexMarker242" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.195.1">clustering package, which we provide as an alternative calculation method by adding to </span><strong class="source-inline"><span class="kobospan" id="kobo.196.1">Script 5.1</span></strong><span class="kobospan" id="kobo.197.1">. </span><span class="kobospan" id="kobo.197.2">If you encounter a warning message on Windows, don’t be alarmed; it is not an error. </span><span class="kobospan" id="kobo.197.3">Let’s add to </span><strong class="source-inline"><span class="kobospan" id="kobo.198.1">Script </span></strong><span><strong class="source-inline"><span class="kobospan" id="kobo.199.1">5.1</span></strong></span><span><span class="kobospan" id="kobo.200.1"> now:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.201.1">
#perform spectral clustering with sklearn
from sklearn.cluster import SpectralClustering
from sklearn import metrics
sc = SpectralClustering(2, affinity='precomputed', n_init=100)
sp_clust=sc.fit(adj_mat_w)
sc_labels=sp_clust.labels_
nx.draw(G,with_labels=True, node_color=sc_labels)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.202.1">As expected, the</span><a id="_idIndexMarker243" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.203.1"> scikit-learn </span><a id="_idIndexMarker244" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.204.1">package produces the same partitioning of the network (</span><span><em class="italic"><span class="kobospan" id="kobo.205.1">Figure 5</span></em></span><em class="italic"><span class="kobospan" id="kobo.206.1">.8</span></em><span class="kobospan" id="kobo.207.1">) as our linear </span><span><span class="kobospan" id="kobo.208.1">algebra approach:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer071">
<span class="kobospan" id="kobo.209.1"><img alt="Figure 5.8 – Scikit-learn spectral clustering of snake populations" src="image/B21087_05_08.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.210.1">Figure 5.8 – Scikit-learn spectral clustering of snake populations</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.211.1">Spectral clustering is not limited to network data or ecological data. </span><span class="kobospan" id="kobo.211.2">Any numeric dataset can be clustered using spectral clustering. </span><span class="kobospan" id="kobo.211.3">In image and text analytics, we often don’t have</span><a id="_idIndexMarker245" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.212.1"> many instances of pre-labeled data, and manually annotating data is time consuming and can miss important classes in the dataset if they don’t happen to be in a small sample for someone to score manually. </span><span class="kobospan" id="kobo.212.2">Spectral clustering allows us to embed data through</span><a id="_idIndexMarker246" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.213.1"> tools in these fields, create a network based on nearest neighbors, and apply spectral clustering to obtain labels for a</span><a id="_idIndexMarker247" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.214.1"> dataset that can then be used to train a classification algorithm. </span><span class="kobospan" id="kobo.214.2">This process is termed </span><strong class="bold"><span class="kobospan" id="kobo.215.1">semi-supervised learning</span></strong><span class="kobospan" id="kobo.216.1">, and real-world data science in natural language processing and image analytics often relies on this methodology to build classification models from datasets. </span><span class="kobospan" id="kobo.216.2">Let’s see this in action by considering a text-based </span><span><span class="kobospan" id="kobo.217.1">ecological dataset.</span></span></p>
<h2 id="_idParaDest-74" class="calibre7"><a id="_idTextAnchor074" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.218.1">Spectral clustering on text notes</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.219.1">Let’s consider</span><a id="_idIndexMarker248" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.220.1"> a dataset of ecological notes, including five healthy and five unhealthy local parks. </span><span class="kobospan" id="kobo.220.2">While these notes are not as extensive </span><a id="_idIndexMarker249" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.221.1">as a full ecological survey, they should demonstrate how to create a semi-supervised learning pipeline to classify ecosystem health. </span><span class="kobospan" id="kobo.221.2">Here is one example of a healthy ecosystem in </span><span><span class="kobospan" id="kobo.222.1">the notes:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.223.1">
"Mangrove ecosystem. </span><span class="kobospan1" id="kobo.223.2">Numerous butterflies, lizards, and insects. </span><span class="kobospan1" id="kobo.223.3">Gumbolimbo trees. </span><span class="kobospan1" id="kobo.223.4">Soggy soil.', 'Tropical pines. </span><span class="kobospan1" id="kobo.223.5">Scat shows raccoon and coyote populations here. </span><span class="kobospan1" id="kobo.223.6">Recent controlled burn."</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.224.1">Here is an example of an unhealthy ecosystem in </span><span><span class="kobospan" id="kobo.225.1">the dataset:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.226.1">
"Small grass area. </span><span class="kobospan1" id="kobo.226.2">Some saplings. </span><span class="kobospan1" id="kobo.226.3">Gravel paths. </span><span class="kobospan1" id="kobo.226.4">Many cars parked in non-parking zones. </span><span class="kobospan1" id="kobo.226.5">Lots of run-off."</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.227.1">While we could annotate these notes ourselves, we’ll use spectral clustering to see how semi-supervised learning can be used to generate training data labels for much larger datasets where annotation might be unfeasible or unreliable. </span><span class="kobospan" id="kobo.227.2">First, we’ll import our data with </span><span><strong class="source-inline"><span class="kobospan" id="kobo.228.1">Script 5.2</span></strong></span><span><span class="kobospan" id="kobo.229.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.230.1">
#set up needed packages
import pandas as pd
import numpy as np
import os
#you may need to install sentence_transformers
#if the package is not already in your environment
#!pip install sentence_transformers
from sentence_transformers import SentenceTransformer
#import first network's data
File ="C:/users/njfar/OneDrive/Desktop/SC_Notes.csv"
pwd = os.getcwd()
os.chdir(os.path.dirname(File))
mydata = pd.read_csv(os.path.basename(File),encoding='latin1')</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.231.1">To</span><a id="_idIndexMarker250" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.232.1"> embed our data, we’ll use a </span><strong class="bold"><span class="kobospan" id="kobo.233.1">pretrained transformer model</span></strong><span class="kobospan" id="kobo.234.1">—a </span><a id="_idIndexMarker251" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.235.1">type of deep learning algorithm trained on large sets of text data that is aware of language context and can map new text samples to the learned embedding space. </span><span class="kobospan" id="kobo.235.2">While</span><a id="_idIndexMarker252" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.236.1"> the particulars of this method are beyond the scope of this book, interested readers are encouraged to explore HuggingFace models and pretrained transformer models in the literature. </span><span class="kobospan" id="kobo.236.2">Here, we use a pretrained HuggingFace model, a </span><strong class="bold"><span class="kobospan" id="kobo.237.1">Bidirectional Encoder Representations from Transformers</span></strong><span class="kobospan" id="kobo.238.1"> (</span><strong class="bold"><span class="kobospan" id="kobo.239.1">BERT</span></strong><span class="kobospan" id="kobo.240.1">) model by first filling in missing</span><a id="_idIndexMarker253" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.241.1"> data and then embedding it with the BERT model we’ve selected by adding to </span><span><strong class="source-inline"><span class="kobospan" id="kobo.242.1">Script 5.2</span></strong></span><span><span class="kobospan" id="kobo.243.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.244.1">
#prepare data
mydata['Notes']=mydata['Notes'].fillna(value=".")
#strip to text for input into BERT model
text_list=list(mydata.Notes)
#get BERT--768 vectors;
#note: you will need enough memory to load the transformer model
sbert_model1 = SentenceTransformer('all-mpnet-base-v2')
#encode data with BERT
encoded_text1=sbert_model1.encode(text_list)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.245.1">Now that we </span><a id="_idIndexMarker254" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.246.1">have embedded our data, we can create our nearest neighbors graph. </span><span class="kobospan" id="kobo.246.2">Since we have such a small sample size, we’ll consider a point’s three nearest neighbors by adding to </span><span><strong class="source-inline"><span class="kobospan" id="kobo.247.1">Script 5.2</span></strong></span><span><span class="kobospan" id="kobo.248.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.249.1">
#make nearest neighbors graph
from sklearn.neighbors import kneighbors_graph
n_adj = kneighbors_graph(encoded_text1, n_neighbors=3).toarray()</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.250.1">Now </span><a id="_idIndexMarker255" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.251.1">we’re ready to run our spectral clustering and examine how our data clusters in this algorithm. </span><span class="kobospan" id="kobo.251.2">Let’s add to </span><strong class="source-inline"><span class="kobospan" id="kobo.252.1">Script 5.2</span></strong><span class="kobospan" id="kobo.253.1"> to see this </span><span><span class="kobospan" id="kobo.254.1">in action:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.255.1">
#run spectral clustering
from sklearn.cluster import SpectralClustering
from sklearn import metrics
sc = SpectralClustering(2, affinity='precomputed', n_init=100)
sp_clust=sc.fit(n_adj)
sc_labels=sp_clust.labels_
print(sc_labels)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.256.1">From our printed labels, we can see that ecosystems </span><strong class="source-inline"><span class="kobospan" id="kobo.257.1">3</span></strong><span class="kobospan" id="kobo.258.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.259.1">7</span></strong><span class="kobospan" id="kobo.260.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.261.1">8</span></strong><span class="kobospan" id="kobo.262.1">, and </span><strong class="source-inline"><span class="kobospan" id="kobo.263.1">10</span></strong><span class="kobospan" id="kobo.264.1"> form one cluster, while ecosystems </span><strong class="source-inline"><span class="kobospan" id="kobo.265.1">1</span></strong><span class="kobospan" id="kobo.266.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.267.1">2</span></strong><span class="kobospan" id="kobo.268.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.269.1">4</span></strong><span class="kobospan" id="kobo.270.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.271.1">5</span></strong><span class="kobospan" id="kobo.272.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.273.1">6</span></strong><span class="kobospan" id="kobo.274.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.275.1">7</span></strong><span class="kobospan" id="kobo.276.1">, and </span><strong class="source-inline"><span class="kobospan" id="kobo.277.1">9</span></strong><span class="kobospan" id="kobo.278.1"> form the other. </span><span class="kobospan" id="kobo.278.2">Let’s look at our sample of notes to see how well this method found differences in tone or theme by adding to </span><span><strong class="source-inline"><span class="kobospan" id="kobo.279.1">Script 5.2</span></strong></span><span><span class="kobospan" id="kobo.280.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.281.1">
#examine notes
print(text_list)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.282.1">We can </span><a id="_idIndexMarker256" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.283.1">see that notes </span><strong class="source-inline"><span class="kobospan" id="kobo.284.1">3</span></strong><span class="kobospan" id="kobo.285.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.286.1">4</span></strong><span class="kobospan" id="kobo.287.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.288.1">7</span></strong><span class="kobospan" id="kobo.289.1">, </span><strong class="source-inline"><span class="kobospan" id="kobo.290.1">8</span></strong><span class="kobospan" id="kobo.291.1">, and </span><strong class="source-inline"><span class="kobospan" id="kobo.292.1">10</span></strong><span class="kobospan" id="kobo.293.1"> are unhealthy </span><a id="_idIndexMarker257" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.294.1">ecosystems compared to the rest of our sample. </span><span class="kobospan" id="kobo.294.2">Spectral clustering doesn’t seem to find all of these differences, but it’s possible that another type of text embedding would distinguish tone better than the one we selected. </span><span class="kobospan" id="kobo.294.3">It’s also possible that fewer neighbors or a larger sample size would provide better results. </span><span class="kobospan" id="kobo.294.4">However, we do find four of our five unhealthy ecosystems through our spectral clustering algorithm. </span><span class="kobospan" id="kobo.294.5">A human reviewing results would not have to switch many labels (20%) to generate correct training labels for this data to be used to train a classification model. </span><span class="kobospan" id="kobo.294.6">The second column of our dataset includes correct tone classification labels. </span><span class="kobospan" id="kobo.294.7">Let’s convert our BERT embeddings to a DataFrame by adding to </span><span><strong class="source-inline"><span class="kobospan" id="kobo.295.1">Script 5.2</span></strong></span><span><span class="kobospan" id="kobo.296.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.297.1">
#create training dataset for supervised learning
#turn BERT embedding into array
BERT_array1=np.array([x for x in encoded_text1])
#convert to dataframes
BERT_df1=pd.DataFrame(BERT_array1)</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.298.1">Now, let’s split our data into training and test sets (80% and 20% splits, respectively), create a </span><em class="italic"><span class="kobospan" id="kobo.299.1">k</span></em><span class="kobospan" id="kobo.300.1">-nearest neighbors classifier (which classifies points according to the labels of their two nearest neighbors with </span><em class="italic"><span class="kobospan" id="kobo.301.1">k</span></em><span class="kobospan" id="kobo.302.1"> = 2), and measure the test set error by adding to </span><span><strong class="source-inline"><span class="kobospan" id="kobo.303.1">Script 5.2</span></strong></span><span><span class="kobospan" id="kobo.304.1">:</span></span></p>
<pre class="source-code"><span class="kobospan1" id="kobo.305.1">
#create KNN classifier and test accuracy
from sklearn.neighbors import KNeighborsClassifier
from sklearn.model_selection import train_test_split
#get predictors and outcome
BERT_df1['Type']=mydata['Type']
df_train, df_test = train_test_split(BERT_df1,test_size=0.2, random_state=0)
X = df_train.iloc[:,0:767]
y = df_train.iloc[:,768]
X_test = df_test.iloc[:,0:767]
y_test = df_test.iloc[:,768]
#create KNN classifier and print accuracy
eu=KNeighborsClassifier(n_neighbors=2,metric='euclidean')
eu.fit(X,y)
print(eu.score(X_test,y_test))</span></pre> <p class="calibre3"><span class="kobospan" id="kobo.306.1">Our </span><a id="_idIndexMarker258" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.307.1">split yields an accuracy of 100%, suggesting </span><a id="_idIndexMarker259" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.308.1">no misclassification of ecosystem types. </span><span class="kobospan" id="kobo.308.2">Yours may vary given seeds and random number generators on your machine. </span><span class="kobospan" id="kobo.308.3">However, this approach seems to work well for this dataset. </span><span class="kobospan" id="kobo.308.4">Our pipeline of processing text data via embeddings, deriving a good start to label creation via spectral clustering, and then creating a classifier model yielded a high-accuracy classification system for </span><span><span class="kobospan" id="kobo.309.1">our dataset.</span></span></p>
<h1 id="_idParaDest-75" class="calibre5"><a id="_idTextAnchor075" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.310.1">Summary</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.311.1">In this chapter, we learned how to collect ecological data for a variety of data science problems. </span><span class="kobospan" id="kobo.311.2">After a brief introduction to the theory of spectral clustering, we showed how spectral clustering could parse out different animal populations through our Gaboon viper distribution example. </span><span class="kobospan" id="kobo.311.3">Finally, we explored spectral clustering of nearest neighbor networks that can be used in semi-supervised learning pipelines through an ecosystem note data example. </span><span class="kobospan" id="kobo.311.4">In </span><a href="B21087_06.xhtml#_idTextAnchor078" class="pcalibre calibre6 pcalibre1"><span><em class="italic"><span class="kobospan" id="kobo.312.1">Chapter 6</span></em></span></a><span class="kobospan" id="kobo.313.1">, we'll introduce centrality measurements and use them to find tipping points in </span><span><span class="kobospan" id="kobo.314.1">stock pricing.</span></span></p>
<h1 id="_idParaDest-76" class="calibre5"><a id="_idTextAnchor076" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.315.1">References</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.316.1">Angelici, F. </span><span class="kobospan" id="kobo.316.2">M., Effah, C., Inyang, M. </span><span class="kobospan" id="kobo.316.3">A., &amp; Luiselli, L. </span><span class="kobospan" id="kobo.316.4">(2000). </span><em class="italic"><span class="kobospan" id="kobo.317.1">A preliminary radiotracking study of movements, activity patterns and habitat use of free-ranging Gaboon vipers, Bitis gabonica</span></em><span class="kobospan" id="kobo.318.1">. </span><em class="italic"><span class="kobospan" id="kobo.319.1">Revue d’Ecologie, Terre et Vie</span></em><span class="kobospan" id="kobo.320.1">, </span><span><em class="italic"><span class="kobospan" id="kobo.321.1">55</span></em></span><span><span class="kobospan" id="kobo.322.1">(1), 45-55.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.323.1">Corrales, D. </span><span class="kobospan" id="kobo.323.2">C., Figueroa, A., Ledezma, A., &amp; Corrales, J. </span><span class="kobospan" id="kobo.323.3">C. </span><span class="kobospan" id="kobo.323.4">(2015). </span><em class="italic"><span class="kobospan" id="kobo.324.1">An empirical multi-classifier for coffee rust detection in Colombian crops</span></em><span class="kobospan" id="kobo.325.1">. </span><span class="kobospan" id="kobo.325.2">In </span><em class="italic"><span class="kobospan" id="kobo.326.1">Computational Science and Its Applications--ICCSA 2015: 15th International Conference, Banff, AB, Canada, June 22-25, 2015, Proceedings, Part I 15</span></em><span class="kobospan" id="kobo.327.1"> (pp. </span><span class="kobospan" id="kobo.327.2">60-74). </span><span class="kobospan" id="kobo.327.3">Springer </span><span><span class="kobospan" id="kobo.328.1">International Publishing.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.329.1">Froese, G. </span><span class="kobospan" id="kobo.329.2">Z., Ebang Mbélé, A., Beirne, C., Atsame, L., Bayossa, C., Bazza, B., ... </span><span class="kobospan" id="kobo.329.3">&amp; Poulsen, J. </span><span class="kobospan" id="kobo.329.4">R. </span><span class="kobospan" id="kobo.329.5">(2022). </span><em class="italic"><span class="kobospan" id="kobo.330.1">Coupling paraecology and hunter GPS self</span></em><span class="kobospan" id="kobo.331.1">‐</span><em class="italic"><span class="kobospan" id="kobo.332.1">follows to quantify village bushmeat hunting dynamics across the landscape scale</span></em><span class="kobospan" id="kobo.333.1">. </span><em class="italic"><span class="kobospan" id="kobo.334.1">African Journal of Ecology</span></em><span class="kobospan" id="kobo.335.1">, </span><em class="italic"><span class="kobospan" id="kobo.336.1">60</span></em><span class="kobospan" id="kobo.337.1"> (</span><span><span class="kobospan" id="kobo.338.1">2), 229-249.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.339.1">Mutombo, F. </span><span class="kobospan" id="kobo.339.2">K. </span><span class="kobospan" id="kobo.339.3">(2012). </span><em class="italic"><span class="kobospan" id="kobo.340.1">Long-range interactions in </span></em><span><em class="italic"><span class="kobospan" id="kobo.341.1">complex networks</span></em></span><span><span class="kobospan" id="kobo.342.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.343.1">Ng, A., Jordan, M., &amp; Weiss, Y. </span><span class="kobospan" id="kobo.343.2">(2001). </span><em class="italic"><span class="kobospan" id="kobo.344.1">On spectral clustering: Analysis and an algorithm</span></em><span class="kobospan" id="kobo.345.1">. </span><em class="italic"><span class="kobospan" id="kobo.346.1">Advances in neural information processing </span></em><span><em class="italic"><span class="kobospan" id="kobo.347.1">systems</span></em></span><span><span class="kobospan" id="kobo.348.1">, </span></span><span><em class="italic"><span class="kobospan" id="kobo.349.1">14</span></em></span><span><span class="kobospan" id="kobo.350.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.351.1">Nunez‐Mir, G. </span><span class="kobospan" id="kobo.351.2">C., Iannone III, B. </span><span class="kobospan" id="kobo.351.3">V., Pijanowski, B. </span><span class="kobospan" id="kobo.351.4">C., Kong, N., &amp; Fei, S. </span><span class="kobospan" id="kobo.351.5">(2016). </span><em class="italic"><span class="kobospan" id="kobo.352.1">Automated content analysis: addressing the big literature challenge in ecology and evolution</span></em><span class="kobospan" id="kobo.353.1">. </span><em class="italic"><span class="kobospan" id="kobo.354.1">Methods in Ecology and Evolution</span></em><span class="kobospan" id="kobo.355.1">, </span><em class="italic"><span class="kobospan" id="kobo.356.1">7</span></em><span class="kobospan" id="kobo.357.1"> (</span><span><span class="kobospan" id="kobo.358.1">11), 1262-1272.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.359.1">Qi, X., Fuller, E., Wu, Q., Wu, Y., &amp; Zhang, C. </span><span class="kobospan" id="kobo.359.2">Q. </span><span class="kobospan" id="kobo.359.3">(2012). </span><em class="italic"><span class="kobospan" id="kobo.360.1">Laplacian centrality: A new centrality measure for weighted networks</span></em><span class="kobospan" id="kobo.361.1">. </span><em class="italic"><span class="kobospan" id="kobo.362.1">Information Sciences</span></em><span class="kobospan" id="kobo.363.1">, </span><span><em class="italic"><span class="kobospan" id="kobo.364.1">194</span></em></span><span><span class="kobospan" id="kobo.365.1">, 240-253.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.366.1">Reimers, N., &amp; Gurevych, I. </span><span class="kobospan" id="kobo.366.2">(2019). </span><em class="italic"><span class="kobospan" id="kobo.367.1">Sentence-bert: Sentence embeddings using siamese bert-networks</span></em><span class="kobospan" id="kobo.368.1">. </span><em class="italic"><span class="kobospan" id="kobo.369.1">arXiv </span></em><span><em class="italic"><span class="kobospan" id="kobo.370.1">preprint arXiv:1908.10084</span></em></span><span><span class="kobospan" id="kobo.371.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.372.1">White, S., &amp; Smyth, P. </span><span class="kobospan" id="kobo.372.2">(2005, April). </span><em class="italic"><span class="kobospan" id="kobo.373.1">A spectral clustering approach to finding communities in graphs</span></em><span class="kobospan" id="kobo.374.1">. </span><span class="kobospan" id="kobo.374.2">In </span><em class="italic"><span class="kobospan" id="kobo.375.1">Proceedings of the 2005 SIAM international conference on data mining</span></em><span class="kobospan" id="kobo.376.1"> (pp. </span><span class="kobospan" id="kobo.376.2">274-285). </span><span class="kobospan" id="kobo.376.3">Society for industrial and </span><span><span class="kobospan" id="kobo.377.1">applied Mathematics.</span></span></p>
</div>
</body></html>