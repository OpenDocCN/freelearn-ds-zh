<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Apache Mahout"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Apache Mahout</h1></div></div></div><p>In the previous chapter, we discussed classification and looked into the algorithms provided by Mahout in this area. Before going to those algorithms, we need to understand Mahout and its installation. In this chapter, we will explore the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">What is Apache Mahout?</li><li class="listitem" style="list-style-type: disc">Algorithms supported in Mahout</li><li class="listitem" style="list-style-type: disc">Why is it a good choice for classification problems?</li><li class="listitem" style="list-style-type: disc">Setting up the system for Mahout development</li></ul></div><div class="section" title="Introducing Apache Mahout"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec12"/>Introducing Apache Mahout</h1></div></div></div><p>A mahout is a <a id="id58" class="indexterm"/>person who rides and controls an elephant. Most of the algorithms in Apache Mahout are implemented on top of Hadoop, which is another Apache-licensed <a id="id59" class="indexterm"/>project and has the symbol of an elephant (<a class="ulink" href="http://hadoop.apache.org/">http://hadoop.apache.org/</a>). As Apache Mahout rides over Hadoop, this name is justified.</p><p>Apache Mahout is a project of Apache Software Foundation that has implementations of machine learning algorithms. Mahout was started as a subproject of the Apache Lucene project in 2008. After some time, an open source project named <span class="strong"><strong>Taste</strong></span>, which was developed for collaborative filtering, and it was absorbed into Mahout. Mahout is written in Java and provides scalable machine learning algorithms. Mahout is the default choice for machine learning problems in which the data is too large to fit into a single machine. Mahout provides Java libraries and does not provide any user interface or server. It is a framework of tools to be used and adapted by developers.</p><div class="mediaobject"><img src="graphics/4959OS_02_01.jpg" alt="Introducing Apache Mahout"/></div><p>To sum it up, Mahout provides you with implementations of the most frequently used machine learning algorithms in the area of classification, clustering, and recommendation. Instead of spending time writing algorithms, it provides us with ready-to-consume solutions.</p><p>Mahout uses Hadoop for its algorithms, but some of the algorithms can also run without Hadoop. Currently, Mahout <a id="id60" class="indexterm"/>supports the following use cases:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Recommendation</strong></span>: This takes the user data and tries to predict items that the user might like. With this use case, you can see all the sites that are selling goods to the <a id="id61" class="indexterm"/>user. Based on your previous action, they will try to find out unknown items that could be of use. One example can be this: as soon as you select some book from Amazon, the website will show you a list of other books under the title, <span class="strong"><strong>Customers Who Bought This Item Also Bought</strong></span>. It also shows the title, <span class="strong"><strong>What Other Items Do Customers Buy After Viewing This Item?</strong></span> Another example of recommendation is that while playing videos on YouTube, it recommends that you listen to some other videos based on your selection. Mahout provides full API support to develop your own user-based or item-based recommendation engine.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Classification</strong></span>: As <a id="id62" class="indexterm"/>defined in the earlier chapter, classification decides how much an item belongs to one particular category. E-mail classification for filtering out spam is a classic example of <a id="id63" class="indexterm"/>classification. Mahout provides a rich set of APIs to build your own classification model. For example, Mahout can be used to build a document classifier or an e-mail classifier.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Clustering</strong></span>: This is a technique that tries to group items together based on some sort of <a id="id64" class="indexterm"/>similarity. Here, we find the different clusters of items based on certain properties, and we do not know the name of the cluster in advance. The main difference between clustering and classification is that in classification, we know the end class name. Clustering is <a id="id65" class="indexterm"/>useful in finding out different customer segments. Google News uses the clustering technique in order to group news. For clustering, Mahout has already implemented some of the most popular algorithms in this area, such as k-means, fuzzy k-means, canopy, and so on.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Dimensional reduction</strong></span>: As we discussed in the previous chapter, features are called dimensions. Dimensional reduction is the process of reducing the <a id="id66" class="indexterm"/>number of random variables under consideration. This makes data easy to use. Mahout provides <a id="id67" class="indexterm"/>algorithms for dimensional reduction. Singular value decomposition and Lanczos are examples of the algorithms that Mahout provides.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Topic modeling</strong></span>: Topic <a id="id68" class="indexterm"/>modeling is used to capture the abstract idea of a document. A topic model is a model that associates probability distribution with each document over topics. Given that a document is about a particular topic, one would expect particular words to appear in the document more or less frequently. "Football" and "goal" will <a id="id69" class="indexterm"/>appear more in a document about sports. <span class="strong"><strong>Latent Dirichlet Allocation</strong></span> (<span class="strong"><strong>LDA</strong></span>) is a powerful learning <a id="id70" class="indexterm"/>algorithm for topic modeling. In Mahout, collapsed variational Bayes is implemented for LDA.</li></ul></div></div></div>
<div class="section" title="Algorithms supported in Mahout"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec13"/>Algorithms supported in Mahout</h1></div></div></div><p>The implementation <a id="id71" class="indexterm"/>of algorithms in Mahout can be categorized into two groups:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Sequential algorithms</strong></span>: These algorithms are executed sequentially and do not use <a id="id72" class="indexterm"/>Hadoop scalable processing. They <a id="id73" class="indexterm"/>are usually the ones derived from Taste. For example: user-based collaborative filtering, logistic regression, Hidden Markov Model, multi-layer perceptron, singular value decomposition.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Parallel algorithms</strong></span>: These algorithms can support petabytes of data using Hadoop's <a id="id74" class="indexterm"/>map and hence reduce <a id="id75" class="indexterm"/>parallel processing. For example, Random Forest, Naïve Bayes, canopy clustering, k-means clustering, spectral clustering, and so on.</li></ul></div></div>
<div class="section" title="Reasons for Mahout being a good choice for classification"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Reasons for Mahout being a good choice for classification</h1></div></div></div><p>In machine learning <a id="id76" class="indexterm"/>systems, the more data you use, the more accurate the system built will be. Mahout, which uses Hadoop for scalability, is way ahead of others in terms of handling huge datasets. As the number of training sets increases, Mahout's performance also increases. If the input size for training examples is from 1 million to 10 million, then Mahout is an excellent choice.</p><p>For classification problems, increased data for training is desirable as it can improve the accuracy of the model. Generally, as the number of datasets increases, memory requirement also increases, and algorithms become slow, but Mahout's scalable and parallel algorithms work better with regards to the time taken. Each new machine added decreases the training time and provides higher performance.</p></div>
<div class="section" title="Installing Mahout"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Installing Mahout</h1></div></div></div><p>Now let's try the <a id="id77" class="indexterm"/>slightly challenging part of this book: Mahout installation. Based on common experiences, I have come up with the following questions or concerns that users face before installation:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">I do not know anything about Maven. How will I compile Mahout build?</li><li class="listitem" style="list-style-type: disc">How can I set up Eclipse to write my own programs in Mahout?</li><li class="listitem" style="list-style-type: disc">How can I install Mahout on a Windows system?</li></ul></div><p>So, we will install Mahout with the help of the following steps. Each step is independent from the other. You can choose any one of these:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Building Mahout code using Maven</li><li class="listitem" style="list-style-type: disc">Setting up a development environment using Eclipse</li><li class="listitem" style="list-style-type: disc">Setting up Mahout for a Windows user</li></ul></div><p>Before any of <a id="id78" class="indexterm"/>the steps, some of the prerequisites are:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You should have <a id="id79" class="indexterm"/>Java installed on your system. Wikihow is a good source for this at <a class="ulink" href="http://www.wikihow.com/Install-Java-on-Linux">http://www.wikihow.com/Install-Java-on-Linux</a></li><li class="listitem" style="list-style-type: disc">You should <a id="id80" class="indexterm"/>have Hadoop installed on your system from the <a class="ulink" href="http://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleNodeSetup.html">http://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleNodeSetup.html</a> URL</li></ul></div><div class="section" title="Building Mahout from source using Maven"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec14"/>Building Mahout from source using Maven</h2></div></div></div><p>Mahout's <a id="id81" class="indexterm"/>build and release system is based <a id="id82" class="indexterm"/>on Maven.</p><div class="section" title="Installing Maven"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec01"/>Installing Maven</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create <a id="id83" class="indexterm"/>the folder <code class="literal">/usr/local/maven</code>, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mkdir /usr/local/maven</strong></span>
</pre></div></li><li class="listitem">Download <a id="id84" class="indexterm"/>the distribution <code class="literal">apache-maven</code>-<code class="literal">x.y.z-bin.tar.gz</code> from <a id="id85" class="indexterm"/>the Maven site (<a class="ulink" href="http://maven.apache.org/download.cgi">http://maven.apache.org/download.cgi</a>) and move this to <code class="literal">/usr/local/maven</code>, as follows:<div class="informalexample"><pre class="programlisting">mv apache-maven-x.y.z-bin.tar.gz /usr/local/maven</pre></div></li><li class="listitem">Unpack to the location <code class="literal">/usr/local/maven</code>, as follows:<div class="informalexample"><pre class="programlisting">tar –xvf apache-maven-x.y.z-bin.tar.gz</pre></div></li><li class="listitem">Edit the <code class="literal">.bashrc</code> file, as follows:<div class="informalexample"><pre class="programlisting">export M2_HOME=/usr/local/apache-maven-x.y.z
export M2=$M2_HOME/bin
export PATH=$M2:$PATH
</pre></div></li></ol></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>For the Eclipse IDE, go <a id="id86" class="indexterm"/>to <span class="strong"><strong>Help</strong></span> and select <span class="strong"><strong>Install new Software</strong></span>. Click on the <span class="strong"><strong>Add</strong></span> button, and in the pop up, type the name <code class="literal">M2Eclipse</code>, provide the link <a class="ulink" href="http://download.eclipse.org/technology/m2e/releases">http://download.eclipse.org/technology/m2e/releases</a>, and click on <span class="strong"><strong>OK</strong></span>.</p></div></div></div><div class="section" title="Building Mahout code"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec02"/>Building Mahout code</h3></div></div></div><p>By default, Mahout <a id="id87" class="indexterm"/>assumes that Hadoop is already installed on the system. Mahout uses the <code class="literal">HADOOP_HOME</code> and <code class="literal">HADOOP_CONF_DIR</code> environment variables to access Hadoop cluster configurations. For setting up Mahout, execute the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download the Mahout distribution file <code class="literal">mahout-distribution-0.9-src.tar.gz</code> from <a id="id88" class="indexterm"/>the location <a class="ulink" href="http://archive.apache.org/dist/mahout/0.9/">http://archive.apache.org/dist/mahout/0.9/</a>.</li><li class="listitem">Choose an installation directory for Mahout (<code class="literal">/usr/local/Mahout</code>), and place the downloaded source in the folder. Extract the source code and ensure that the folder contains the <code class="literal">pom.xml</code> file. The following is the exact location of the source:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>tar -xvf  mahout-distribution-0.9-src.tar.gz</strong></span>
</pre></div></li><li class="listitem">Install the Mahout Maven project, and skip the test cases while installing, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mvn install -Dmaven.test.skip=true</strong></span>
</pre></div></li><li class="listitem">Set the <code class="literal">MAHOUT_HOME</code> environment variable in the <code class="literal">~/.bashrc</code> file, and update the <code class="literal">PATH</code> variable with the <code class="literal">Mahout bin</code> directory:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>export MAHOUT_HOME=/user/local/mahout/mahout-distribution-0.9</strong></span>
<span class="strong"><strong>export PATH=$PATH:$MAHOUT_HOME/bin</strong></span>
</pre></div></li><li class="listitem">To test the Mahout installation, execute the command: <code class="literal">mahout</code>. This will list the available <a id="id89" class="indexterm"/>programs within the distribution bundle, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="graphics/4959OS_02_02.jpg" alt="Building Mahout code"/></div></div></div><div class="section" title="Setting up a development environment using Eclipse"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec15"/>Setting up a development environment using Eclipse</h2></div></div></div><p>For <a id="id90" class="indexterm"/>this setup, you should have <a id="id91" class="indexterm"/>Maven installed on the system and the Maven plugin for Eclipse. Refer to the <span class="emphasis"><em>Installing Maven</em></span> step explained in the previous section. This setup can be done in the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download the <a id="id92" class="indexterm"/>Mahout distribution file <code class="literal">mahout-distribution-0.9-src.tar.gz</code> from the location <a class="ulink" href="http://archive.apache.org/dist/mahout/0.9/">http://archive.apache.org/dist/mahout/0.9/</a> and unzip this:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>tar xzf mahout-distribution-0.9-src.tar.gz</strong></span>
</pre></div></li><li class="listitem">Let's create a folder named <code class="literal">workspace</code> under <code class="literal">/usr/local/workspace</code>, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mkdir /usr/local/workspace</strong></span>
</pre></div></li><li class="listitem">Move the downloaded distribution to this folder (from the downloads folder), as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mv mahout-distribution-0.9 /usr/local/workspace/</strong></span>
</pre></div></li><li class="listitem">Move to the folder <code class="literal">/usr/local/workspace/mahout-distribution-0.9</code> and make an Eclipse project (this command can take up to an hour):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mvn eclipse:eclipse</strong></span>
</pre></div></li><li class="listitem">Set the Mahout home in the <code class="literal">.bashrc</code> file, as explained earlier in the <span class="emphasis"><em>Building Mahout code</em></span> section.</li><li class="listitem">Now <a id="id93" class="indexterm"/>open Eclipse. Select <a id="id94" class="indexterm"/>the file, import Maven, and <span class="strong"><strong>Existing Maven Projects</strong></span>. Now, navigate to the location for <span class="strong"><strong>mahout-distribution-0.9</strong></span> and click on <span class="strong"><strong>Finish</strong></span>.<div class="mediaobject"><img src="graphics/4959OS_02_03.jpg" alt="Setting up a development environment using Eclipse"/></div></li></ol></div></div><div class="section" title="Setting up Mahout for a Windows user"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec16"/>Setting up Mahout for a Windows user</h2></div></div></div><p>A Windows <a id="id95" class="indexterm"/>user can use Cygwin (a large collection <a id="id96" class="indexterm"/>of GNU and open source tools that provides functionality similar to a Linux distribution on Windows) to set up their environment. There is also another way that is easy to use, as shown in the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download <a id="id97" class="indexterm"/>Hortonworks Sandbox for virtual box on your system from the location <a class="ulink" href="http://hortonworks.com/products/hortonworks-sandbox/#install">http://hortonworks.com/products/hortonworks-sandbox/#install</a>. Hortonworks Sandbox on your system will be a pseudo-distributed mode of Hadoop.</li><li class="listitem">Log in to the console. Use <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>F5</em></span> or alternatively download Putty and provide <span class="strong"><strong>127.0.0.1</strong></span> as the hostname and <span class="strong"><strong>2222</strong></span> in the port, as shown in the following figure. Log in with the username <code class="literal">root</code> and password <code class="literal">-hadoop</code>.<div class="mediaobject"><img src="graphics/4959OS_02_04.jpg" alt="Setting up Mahout for a Windows user"/></div></li><li class="listitem">Enter <a id="id98" class="indexterm"/>the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>yum install mahout</strong></span>
</pre></div><p>Now, you will see a screen like this:</p><div class="mediaobject"><img src="graphics/4959OS_02_05.jpg" alt="Setting up Mahout for a Windows user"/></div></li><li class="listitem">Enter <code class="literal">y</code>, and your Mahout will start installing. Once this is done, you can test by typing <a id="id99" class="indexterm"/>the command <code class="literal">mahout</code> <a id="id100" class="indexterm"/>and this will show you the same screen as shown in the <span class="emphasis"><em>Setting up a development environment using Eclipse</em></span> recipe seen earlier.</li></ol></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Summary</h1></div></div></div><p>We discussed Apache Mahout in detail in this chapter. We covered  the process of installing Mahout on our system, along with setting up a development environment that is ready to execute Mahout algorithms. We have also taken a look at the reasons behind Mahout being considered a good choice for classification. Now, we move to the next where we will understand about logistic regression and learn about the process that needs to be followed to execute our first algorithm in Mahout.</p></div></body></html>