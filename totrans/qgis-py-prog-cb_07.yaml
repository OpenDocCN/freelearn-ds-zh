- en: Chapter 7. Interacting with the User
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: Using log files
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a simple message dialog
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a warning dialog
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating an error dialog
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Displaying a progress bar
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a simple text input dialog
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a file input dialog
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a combobox
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating radio buttons
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating checkboxes
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating tabs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Stepping the user through a wizard
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Keeping dialogs on top
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: QGIS has been built using the comprehensive graphical user interface framework
    called Qt. Both QGIS and Qt have Python APIs. In this chapter, we'll learn how
    to interact with the user in order to collect and display information outside
    the default QGIS interface. Qt has excellent documentation of its own, and since
    QGIS is built on top of Qt, all of this documentation applies to QGIS. You can
    find the Qt documentation at [http://qt-project.org](http://qt-project.org).
  prefs: []
  type: TYPE_NORMAL
- en: Using log files
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Log files provide a way to track exactly what is going on in a Python plugin
    or script, by creating messages that are available even if the script or QGIS
    crashes. These log messages make troubleshooting easier. In this recipe, we'll
    demonstrate two methods used for logging. One method is using actual log files
    on the filesystem, and the other is using the QGIS **Log Messages** window, which
    is available by clicking on the yellow triangle with an exclamation point at the
    bottom-right corner of the QGIS application window, or by selecting **View** menu,
    then clicking on **Panels**, and then checking **Log Messages**.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To use log files, we must configure the `QGIS_LOG_FILE` environment variable
    by performing the following steps so that QGIS knows where to write log messages:'
  prefs: []
  type: TYPE_NORMAL
- en: From the QGIS **Settings** menu, select **Options**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Options** dialog, select **System** panel.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **System** panel, scroll down to the **Environment** section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Environment** section, check the **Use custom variables** checkbox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Add** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Variable** field, enter `QGIS_LOG_FILE`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Value** field, enter `/qgis_data/log.txt` or the path to another directory
    where you have write permissions.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **OK** button to close the **Options** dialog.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Restart QGIS for the environment variable to take effect.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will write a message to our custom log file configured in the previous section,
    and then write a message to the tabbed QGIS **Log Messages** window. To do this,
    we need to perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: First, open the **Python Console** in QGIS.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, we''ll write the following log file message:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we''ll write a message to the QGIS **Log Messages** window, specifying
    the message as the first argument and a name for the tab in which the message
    will appear:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Now, open the log file and check whether the message has appeared.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, open the QGIS **Log Messages** window, click on the **Python Console**
    tab, and verify that the second log message appears.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The traditional log file provides a simple and portable way to record information
    from QGIS using Python. The **Log Messages** window is a more structured way to
    view information from many different sources, with a tabbed interface and a convenient
    timestamp on each message. In most cases, you'll probably want to use the **Log
    Messages** window because QGIS users are familiar with it. However, use it sparingly.
    It's OK to log lots of messages when testing code, but restrict logging for plugins
    or applications to serious errors only. Heavy logging — for example, logging messages
    while looping over every feature in a layer — can slow down QGIS or even cause
    it to crash.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a simple message dialog
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Message dialogs pop up to grab the user's attention and to display important
    information. In this recipe, we'll create a simple information dialog.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python** **Console** by going to the **Plugins** menu and selecting
    **Python** **Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will create a message dialog and display some text in it, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to import the GUI library:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we''ll create the message dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we''ll set the message we want to display:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, we call the execution method to display the message dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Note that we are directly using the underlying Qt framework from which QGIS
    is built. QGIS API's objects begin with `Qgs`, while Qt objects begin with just
    the letter `Q`.
  prefs: []
  type: TYPE_NORMAL
- en: There's more…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A message dialog box should also be used sparingly because it is a popup that
    can become annoying to the user or can get lost in the array of open windows and
    dialogs on a user's desktop. The preferred method for a QGIS information message
    is to use the `QgsMessageBar() method`, which is well-documented in the PyQGIS
    Developer Cookbook found at [http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/communicating.html](http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/communicating.html)
  prefs: []
  type: TYPE_NORMAL
- en: Creating a warning dialog
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sometimes, you need to notify a user when an issue is detected, which might
    lead to problems if the user continues. This situation calls for a warning dialog,
    which we will demonstrate in this recipe.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by going to the **Plugins** menu and selecting
    **Python Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this recipe, we will create a dialog, set the warning message and a warning
    icon, and display the dialog, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we import the GUI library:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we initialize the warning dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we set the warning message:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, add a warning icon to the dialog that has an enumeration index of `2`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, we call the execution method to display the dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Message dialogs should be used sparingly because they interrupt the user experience
    and can easily become annoying. However, sometimes it is important to prevent
    a user from taking an action that may cause data corruption or a program to crash.
  prefs: []
  type: TYPE_NORMAL
- en: Creating an error dialog
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can issue an error dialog box when you need to end a process due to a serious
    error. In this recipe, we'll create an example of an error dialog.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this recipe, we will create a dialog, assign an error message, set an error
    icon, and display the dialog, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to import the GUI library:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we initialize the dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we set the error message:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Subsequently, we set an icon number for the error icon:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, we execute the error dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: An important feature of modal windows is that they always stay on top of the
    application, regardless of whether the user changes the window's focus. This feature
    ensures that the user addresses the dialog before they proceed.
  prefs: []
  type: TYPE_NORMAL
- en: Displaying a progress bar
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A progress bar is a dynamic dialog that displays the percentage complete bar
    for a running process that the user must wait for before continuing. A progress
    bar is more advanced than a simple dialog because it needs to be updated continuously.
    In this recipe, we'll create a simple progress dialog based on a timer.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: No groundwork is required for this recipe.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The steps for this recipe include creating a custom class based on the `QProgressBar`,
    initializing the dialog and setting its size and title, creating a timer, connecting
    the progress bar to the timer, starting the time, and displaying the progress.
    To do this, we need to perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we must import both the GUI and QGIS core libraries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we create a custom class for our progress bar, including a method to
    increase the value of the progress bar:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we set the progress bar:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we set the progress bar''s size and title:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we initialize the timer, which will serve as the process we monitor:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Now, connect the the timer's `timeout` signal to the `increaseValue` method,
    which we created earlier. Whenever the timer finishes its countdown, it will emit
    the `timeout` signal and notify the `increaseValue` method.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we will start the timer, specifying an interval of `500` milliseconds.
    The timer will call its `timeout()` signal every 0.5 seconds:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, we show the progress bar and start the progress meter:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The progress bar will stop when its value reaches 100, but our timer will continue
    to run until the `stop()` method is called. In a more realistic implementation,
    you will need a way to determine whether the monitored process is complete. The
    indicator might be the creation of a file, or even better, a signal. The Qt framework
    uses the concept of signals and slots to connect GUI elements. A GUI is event-based,
    with multiple events occurring at different times, including user actions and
    other triggers. The signal/slot system allows you to define reactions to events
    when they occur, without writing code to continuously monitor changes. In this
    recipe, we use the predefined signal from the timer and create our own slot. A
    slot is just a method identified as a slot by passing it to a signal''s `connect()`
    method. The following screenshot shows an example of the progress bar:'
  prefs: []
  type: TYPE_NORMAL
- en: '![How it works...](img/00051.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: There's more…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In a complex GUI application such as QGIS, you will end up with multiple signals
    that trigger multiple slots simultaneously. You must take care that a rapidly
    updating element such as a progress bar doesn't slow down the application. Using
    a thread to only update the progress bar when something has truly changed is more
    efficient. For an example of this technique, take a look at [http://snorf.net/blog/2013/12/07/multithreading-in-qgis-python-plugins/](http://snorf.net/blog/2013/12/07/multithreading-in-qgis-python-plugins/).
  prefs: []
  type: TYPE_NORMAL
- en: Using the `QgsMessageBar` object is preferred to display informative messages,
    but it can also accept widgets such as the progress bar. The PyQGIS Developer
    Cookbook has an example that shows how to place the progress bar in the `QgsMessageBar`
    object ([http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/communicating.html](http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/communicating.html))
  prefs: []
  type: TYPE_NORMAL
- en: Creating a simple text input dialog
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this recipe, we'll demonstrate one of the simplest methods used for accepting
    input from a user, a text input dialog.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this recipe, we will initialize the dialog and then configure its title
    and label. We''ll set the editing mode and the default text. When you click on
    the **OK** button, the text will be printed to the **Python Console**. To do this,
    we need to perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to import the GUI library:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we initialize the dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we set the window''s title, label text, editing mode, and default text:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We configure the dialog while capturing the user input and the return code
    in variables:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: When the dialog appears, type in some text and click on the **OK** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now, we print the user input to the console:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Finally, verify that the correct text is printed to the **Python Console**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The editing mode differentiates between **normal**, which we used here, and
    **password**, to obscure typed passwords. Although we haven't used it in this
    example, the return code is a Boolean, which can be used to verify that the user
    input occurred.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a file input dialog
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The best way to get a filename from the user is to have them browse to the file
    using a dialog. You can have the user type in a filename using the text input
    dialog, but this method is prone to errors. In this recipe, we'll create a file
    dialog and print the chosen filename to the console.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this recipe, we will create and configure the dialog, browse to a file,
    and print the chosen filename, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we import the GUI library:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we initialize the file dialog and specify its window title:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we specify a path to the directory we want the file dialog to start in:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we configure the file dialog with the preceding parameters and assign
    the output to a variable:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: When the dialog appears, browse to a file, select it, and click on the **OK**
    button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Finally, we print the chosen filename to the console:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The file dialog simply provides a filename. After the user selects the file,
    you must open it or perform some other operation on it. If the user cancels the
    file dialog, the file variable is just an empty string. You can use the `QFileInfo`
    object to get the path of the selected file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: Then, you can save this path in the project settings, as demonstrated in [Chapter
    1](part0015_split_000.html#page "Chapter 1. Automating QGIS"), *Automating QGIS*.
    This way, next time when you open a file dialog, you will start in the same directory
    location as the previous file, which is usually more convenient.
  prefs: []
  type: TYPE_NORMAL
- en: There's more…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can also use the `QFileDialog() method` to get the filenames to be saved.
    You can use the `FileMode` enumeration to restrict the user to selecting directories
    as well.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a combobox
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A combobox provides a drop-down list to limit the user's selection to a defined
    set of choices. In this recipe, we'll create a simple combobox.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this recipe, we will initialize the combobox widget, add choices to it,
    resize it, display it, and then capture the user input in a variable for printing
    to the console. To do this, we need to perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Frist, we import the GUI library:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE35]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we create our combobox object:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we add the items that we want the user to choose from:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we resize the widget:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE38]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now we can display the widget to the user:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Next, we need to select an item from the list.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now, we set the user''s choice to a variable:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE40]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, we can print the selection:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Verify that the selection is printed to the console.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Items added to the combobox are a Python list. This feature makes it easy to
    dynamically generate choices using Python as the result of a database query or
    other dynamic data. You may also want the index of the object in the list, which
    you can access with the `currentIndex` property.
  prefs: []
  type: TYPE_NORMAL
- en: Creating radio buttons
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Radio buttons are good for user input when you want the user to select an exclusive
    choice from a list of options, as opposed to checkboxes, which let a user select
    many or all of the options available. For longer lists of choices, a combobox
    is a better option. Once a radio button is selected, you can unselect it only
    by choosing another radio button.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Radio buttons are easier to manage as part of a class, so we''ll create a custom
    class that also includes a textbox to view which radio button is selected. To
    do this, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we''ll import both the GUI and the core QGIS libraries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we''ll create the `RadioButton` class and set up the radio buttons and
    the textbox:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We must also define a layout to manage the placement of the widgets, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE44]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we''ll connect the toggled signal of each radio button to the methods
    you''ll define in just a moment, in order to detect when a radio button is selected:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE45]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we''ll add the radio buttons and the textbox to the layout:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE46]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we can define the layout for the custom widget we are building:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE47]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we can define the methods to indicate which radio button is selected.
    You can also define these options in a single method, but for a better understanding,
    three methods are easier:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE48]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We are now ready to initialize our class and display the radio buttons:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE49]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Finally, click on each of the three radio buttons and verify that the text in
    the textbox changes to indicate that the radio button you clicked on is selected.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Radio buttons are almost always grouped together as a single object because
    they are related options. Many GUI frameworks expose them as a single object in
    the API; however, Qt keeps them as separate objects for maximum control.
  prefs: []
  type: TYPE_NORMAL
- en: Creating checkboxes
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Checkboxes are closely related to radio buttons, in that they offer options
    around a single theme. However, unlike radio buttons, checkboxes can be selected
    or unselected. You can also select more than one checkbox at a time. In this recipe,
    we'll create a dialog with checkboxes and some textboxes to programmatically track
    which checkboxes are selected.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python** **Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this recipe, we''ll use a class to manage the checkboxes and the textbox
    widgets, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we import the GUI and QGIS core libraries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE50]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we create our custom class for the checkboxes and textboxes:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE51]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we''ll need a `layout` object to manage the placement of the widgets:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE52]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we''ll add three checkboxes and three textboxes:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE53]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we''ll connect the status signals of the checkboxes to the methods that
    we''ll define later:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE54]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we must add the widgets to the layout:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE55]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we set our custom class''s layout to the layout we created:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE56]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We then create the methods that change the textboxes each time a checkbox is
    toggled:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE57]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we are ready to initialize our custom class and display the dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE58]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Toggle the checkboxes separately and simultaneously and then verify that the
    textboxes reflect the changes.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Textboxes allow you to verify that you are programmatically catching the signal
    from the checkboxes as they are toggled. You can also use a single checkbox as
    a Boolean for an option with only two choices. When you run this recipe, the result
    should look similar to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![How it works...](img/00052.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Creating tabs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Tabs allow you to condense the information from several screens into a relatively
    small place. Tabs provide titles at the top of the window, which present an individual
    widget layout for each title when clicked. In this recipe, we'll create a simple
    tabbed interface.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python** **Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will create an overarching tab widget. Then, we''ll create three generic
    widgets to represent our tabs. We''ll set up layouts with three different GUI
    widgets and assign each layout to our tab widgets. Finally, we''ll add our tabs
    to the tab widget and display it. To do this, we need to perform the following
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to import the GUI and QGIS core libraries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE59]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we create our tab and configure its title and size:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE60]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we initialize our tab widgets:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE61]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we''ll set up a widget and a layout with a rich text input box, using
    HTML tags for bold text for our first tab:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE62]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we''ll set up a simple button for our second tab, following the same format
    as the first tab:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE63]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we''ll create the widget and the layout for our third tab with a simple
    text label:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE64]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we''ll add the tabs to the tab window:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE65]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, we''ll display the tab window:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE66]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Verify that you can click on each tab and interact with the widgets.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The key to this recipe is the `QTabWidget()`.method. Everything else is just
    arbitrary layouts and widgets, which are ultimately contained in the tab widget.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The general rule of thumb for tabs is to keep the information in them independently.
  prefs: []
  type: TYPE_NORMAL
- en: There is no way to predict how the user will interact with a tabbed interface,
    and if the information across tabs is dependent, problems will arise.
  prefs: []
  type: TYPE_NORMAL
- en: Stepping the user through a wizard
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A wizard is a series of dialogs that lead the user through a sequence of steps.
    The information on each page of a wizard might relate in some way to the information
    on other pages. In this recipe, we'll create a simple three-page wizard to collect
    some information from the user and display it back to them.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python** **Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We will create three classes, each representing a page of our wizard. The first
    two pages will collect information and the third page will display it back to
    the user. We will create a `QWizard` object to tie the page classes together.
    We will also use the concept of wizard fields to pass information among the pages.
  prefs: []
  type: TYPE_NORMAL
- en: 'To do this, we need to perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we import the GUI and QGIS core libraries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE67]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we create the class for the first page of our wizard and add a textbox
    to collect the user''s name as the `uname` variable:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE68]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we register the `uname` field so that we''ll be able to access the entered
    value later on, without having to keep track of the variable itself:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE69]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we set up the layout for the page:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE70]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we''ll set the class for our second page:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE71]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we''ll add a calendar widget to get the user''s birthday:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE72]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We''ll register the selected date as a `field`, to be accessed later on:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE73]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we''ll set up the layout for this page:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE74]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We are now ready to set up the third page, which will display the user''s information.
    We''ll use simple labels, which are dynamically populated in the next step:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE75]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we set up the initialization of the page. We will first access the fields
    registered from the previous pages to grab the user input:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE76]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, all we have to do is set those values to the text for the labels using
    Python string formatting:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE77]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, we create our wizard widget, add pages, and display the wizard:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE78]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The wizard interface shares many traits with the tab widget, with some important
    differences. The wizard only allows the user to move back and forth in a linear
    progression based on the page order. It can share information among pages if the
    information is registered as fields, which then makes the pages global to the
    scope of the wizard. However, the `field()` method is a protected method, so your
    pages must be defined as classes inherited from the `QWizardPage` object for the
    registered fields to work as expected. The following screenshot shows the calendar
    screen of the wizard:'
  prefs: []
  type: TYPE_NORMAL
- en: '![How it works...](img/00053.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Keeping dialogs on top
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: It's easy to lose track of windows that pop up in front of QGIS. As soon as
    the user changes focus to move the main QGIS application window, your dialog can
    disappear behind it, forcing the user to rearrange their whole desktop to find
    the smaller window again. Fortunately, Qt has a window setting called hint, which
    allows you to force a window to stay on top. This type of dialog is called a modal
    dialog. In this recipe, we'll create a message dialog using hint.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Open the QGIS **Python Console** by selecting the **Plugins** menu and then
    clicking on **Python** **Console**.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this recipe, we will create a simple message dialog and set it to stay on
    top, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we import the Qt GUI and QGIS core libraries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE79]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, we create the text for our message:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE80]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we create our dialog and specify the message and hint:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE81]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We can resize and show the dialog:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE82]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Click on the main QGIS application window to change the window focus and verify
    that the dialog stays on top of QGIS.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This simple technique can help to ensure that a user addresses an important
    dialog before moving on.
  prefs: []
  type: TYPE_NORMAL
