["```py\nIn[]: import sqlite3\n```", "```py\nIn[]: conn = sqlite3.connect('user_hits.db')\n```", "```py\nIn[]: import pandas as pd\n```", "```py\nIn[]: df_user_churn = pd.read_sql_query(\"SELECT * FROM tbl_user_hits;\", conn)\n```", "```py\nIn[]: df_user_churn.head()\n```", "```py\nIn[]: df_user_churn.info()\n```", "```py\nIn[]: df_user_churn.to_csv('user_hits_export.csv')\n```", "```py\nIn[]: import pandas as pd\n```", "```py\nIn[]: df_user_churn = pd.read_csv('user_hits_export.csv');\n```", "```py\nIn[]: df_user_restricted = df_user_churn[df_user_churn['userid']==1]\n```", "```py\nIn[]: df_user_restricted.head()\n```", "```py\nIn[]: df_user_restricted.sort_values(by='date')\n```", "```py\nIn[]: df_user_restricted.sort_values(by='date', ascending=False)\n```", "```py\nIn[]: df_user_churn_cleaned = pd.read_csv('user_hits_binning_import.csv', parse_dates=['date'])\n```", "```py\nIn[]: import datetime\n```", "```py\nIn[]: now = pd.to_datetime('now')\n```", "```py\nIn[]: df_user_churn_cleaned['age'] = now - df_user_churn_cleaned['date']\n\n```", "```py\nIn[]: df_usage_patterns = pd.read_csv('user_hits_import.csv')\ndf_usage_patterns.info()\n```", "```py\nIn[]: pd.isnull(df_usage_patterns)\n```", "```py\nIn[]: df_user_churn_cleaned = df_usage_patterns.dropna()\n```", "```py\nIn[]: df_user_churn_cleaned.head(10)\n```", "```py\nIn[]: import pandas as pd\n```", "```py\nIn[]: df_user_data_2017 = pd.read_csv('user_data_2017.csv')\n```", "```py\nIn[]: df_user_data_2017.head()\n```", "```py\nIn[]: df_user_data_2018 = pd.read_csv('user_data_2018.csv')\n```", "```py\nIn[]: df_user_data_2018.head()\n```", "```py\nIn[]: df_user_data_2019 = pd.read_csv('user_data_2019.csv')\n```", "```py\nIn[]: df_user_data_2019.head()\n```", "```py\nIn[]: df_user_data_combined = pd.concat([df_user_data_2017, df_user_data_2018, df_user_data_2019], ignore_index=True)\n```", "```py\nIn[]: df_user_data_combined.head(10)\n```", "```py\nIn[]: import pandas as pd\n```", "```py\nIn[]: df_user_churn_cleaned = pd.read_csv('user_hits_binning_import.csv', parse_dates=['date'])\n```", "```py\nIn[]: df_user_churn_cleaned.head(10)\n\n```", "```py\nIn[]: from datetime import datetime\n      import numpy as np\n```", "```py\nIn[]: #df_user_churn_cleaned['age'] = (datetime.now() - pd.to_datetime(df_user_churn_cleaned['date'])).dt.days\ndf_user_churn_cleaned['age'] = (datetime(2020, 2, 28)  - pd.to_datetime(df_user_churn_cleaned['date'])).dt.days\n\n```", "```py\nIn[]: df_user_churn_cleaned.head()\n```", "```py\nIn[]: df_ages = df_user_churn_cleaned.groupby('userid').max()\n```", "```py\nIn[]: df_ages['age_bin'] = pd.cut(x=df_ages['age'], bins=[1, 365, 730, 9999], labels=['< 1 year', '1 to 2 years', '> 3 years'])\n\n```", "```py\nIn[]: df_ages\n```"]