# 前言

随着软件应用越来越成为人们生活的一部分，位置和空间的概念变得越来越重要。开发者们经常发现自己不得不处理基于位置的数据。地图、地理空间数据和空间计算正日益成为日常编程技能库中的另一个组成部分。

十年前，地理空间概念和开发仅限于地理信息科学领域的专家。这些人花费数年时间与地图及其背后的复杂数学打交道。这些人通常来自大学背景，这些专家会花费数年时间熟悉特定的地理信息系统（GIS），并以此系统绘制地图和处理地理空间数据作为自己的职业。

虽然流行的谷歌地图意味着任何人都可以查看和操作地图，但更高级的定制显示和地理空间数据处理仍然局限于使用专业 GIS 系统的人。所有这些都在免费（通常是开源）的地理空间数据操作和显示工具的出现下发生了变化。现在，任何人都可以学习必要的概念，并从头开始构建自己的地图应用。开发者不再受限于谷歌地图的最小功能和限制性许可条款，现在可以构建自己的地图系统以满足自己的需求，而且没有限制可以做什么。

虽然必要的工具和库是免费可用的，但开发者仍然需要将它们组合成一个可工作的系统。通常，这是一个相当复杂的过程，需要大量理解地理空间概念，以及如何编译必要的包装器并配置工具以在特定计算机上工作。

幸运的是，现在有一个更简单的方法将地理空间编程工具和技术集成到你的 Python 应用中。得益于免费可用的 QGIS 系统的发展，现在可以轻松安装一个完整的地理空间开发环境，你可以在 Python 代码中直接使用它。无论你选择将你的应用作为 QGIS 系统的插件来构建，还是使用 QGIS 作为外部库编写独立的地图应用，你都可以在代码中使用地理空间功能方面拥有完全的灵活性。

# 本书涵盖内容

第一章，*QGIS 入门*，展示了如何安装和运行 QGIS 应用，并介绍了 Python 与 QGIS 的三种主要使用方式。

第二章, *QGIS Python 控制台*，探讨了 QGIS Python 控制台窗口，并解释了它在构建您自己的自定义映射应用程序时的作用。它还让您尝到了使用 Python 和 QGIS 可以做什么，并提高了您对 QGIS 环境的信心和熟悉度。

第三章, *学习 QGIS Python API*，介绍了可供 QGIS Python 开发者使用的 Python 库，并展示了如何使用这些库来处理地理空间数据，并基于您的地理空间数据创建有用和有趣的地图。

第四章, *创建 QGIS 插件*，介绍了 QGIS 插件的概念，并解释了如何使用 Python 编写插件。我们深入探讨了插件的工作原理，以及如何创建一个有用的地理空间应用程序作为 QGIS 插件。我们还探讨了 QGIS 插件的可能性和局限性。

第五章, *在外部应用程序中使用 QGIS*，完成了构建使用 QGIS Python 库的独立 Python 应用程序的过程。您将学习如何创建一个包装脚本以处理特定平台的依赖项，设计和构建一个简单但完整的独立映射应用程序，并了解基于 QGIS 的应用程序结构。在这个过程中，您将作为一个更熟练的 QGIS 程序员，从头开始构建自己的现成映射应用程序。

第六章, *掌握 QGIS Python API*，再次深入 PyQGIS 库，探讨了该库的一些更高级的方面，以及使用 Python 与 QGIS 交互的各种技术。

第七章, *在 PyQGIS 应用程序中选择和编辑要素*，探讨了使用 PyQGIS 构建的 Python 程序如何允许用户在地图界面中选择、添加、编辑和删除地理要素。

第八章, *使用 Python 和 QGIS 构建完整的映射应用程序*，涵盖了设计和构建一个名为"ForestTrails"的完整现成映射应用程序的过程。您将设计该应用程序，实现整体用户界面，并为应用程序构建一个合适的高分辨率基础地图。

第九章，“完成 ForestTrails 应用程序”，通过实现各种地图编辑工具以及编写在地图上两点之间查找最短路径的功能，完成了“ForestTrails”地图应用程序的实现。

# 您需要为本书准备的东西

要跟随本书中的示例，您需要在您的计算机上安装以下软件：

+   QGIS 版本 2.2 或更高版本

+   Python 版本 2.6 或更高版本（但不包括 Python 3.x）

+   GDAL/OGR 版本 1.10 或更高版本

+   PyQt4 版本 4.10 或更高版本

+   根据您的操作系统，您可能还需要安装 Qt 工具包，以便 PyQt 能够正常工作。

所有这些软件都可以免费下载，并且适用于 Mac OS X、MS Windows 和 Linux 计算机。

# 本书面向对象

本书面向有一定地图和地理空间概念知识的经验丰富的 Python 开发者。虽然必要的概念会在我们进行的过程中进行解释，但至少对投影、地理空间数据格式等内容有所了解将有所帮助。

# 习惯用法

在本书中，您将找到许多文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称按照以下方式显示：“这使用了我们之前设置的`QGIS_PREFIX`环境变量，以告诉 QGIS 其资源的位置。”

代码块按照以下方式设置：

```py
app = QApplication(sys.argv)

viewer = MapViewer("/path/to/shapefile.shp")
viewer.show()

app.exec_()
```

当我们希望将您的注意力引到代码块的一个特定部分时，相关的行或项目将以粗体显示：

```py
  def unload(self):
    self.iface.removePluginMenu("Test Plugin", self.action)
 self.iface.removeToolBarIcon(self.action)

```

任何命令行输入或输出都按照以下方式编写：

```py
export PYTHONPATH="$PYTHONPATH:/Applications/QGIS.app/Contents/Resources/python"

```

**新术语**和**重要词汇**以粗体显示。屏幕上看到的单词，例如在菜单或对话框中，在文本中显示如下：“如果您尚未安装 QGIS，请点击主 QGIS 网页上的**立即下载**按钮以下载 QGIS 软件。”

### 注意

警告或重要注意事项以如下框的形式出现。

### 小贴士

小技巧和窍门如下所示。

# 读者反馈

我们的读者反馈总是受欢迎的。请告诉我们您对本书的看法——您喜欢或不喜欢的地方。读者反馈对我们来说很重要，因为它帮助我们开发出您真正能从中获得最大价值的标题。

要发送给我们一般性的反馈，只需发送电子邮件至`<feedback@packtpub.com>`，并在邮件主题中提及本书的标题。

如果您在某个领域有专业知识，并且您有兴趣撰写或为本书做出贡献，请参阅我们的作者指南，网址为[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在您已经是 Packt 图书的骄傲拥有者，我们有一些东西可以帮助您从您的购买中获得最大价值。

## 下载示例代码

您可以从您在[`www.packtpub.com`](http://www.packtpub.com)的账户下载所有已购买的 Packt 出版物的示例代码文件。如果您在其他地方购买了这本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

## 下载本书的彩色图像

我们还为您提供了一个包含本书中使用的截图/图表彩色图像的 PDF 文件。彩色图像将帮助您更好地理解输出的变化。您可以从[`www.packtpub.com/sites/default/files/downloads/4664OS_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/4664OS_ColorImages.pdf)下载此文件。

## 错误

尽管我们已经尽一切努力确保内容的准确性，但错误仍然会发生。如果您在我们的书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。通过这样做，您可以节省其他读者的挫败感，并帮助我们改进本书的后续版本。如果您发现任何错误，请通过访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**错误提交表单**链接，并输入您的错误详情来报告它们。一旦您的错误得到验证，您的提交将被接受，错误将被上传到我们的网站或添加到该标题的错误部分下的现有错误列表中。

要查看之前提交的错误，请转到[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书籍名称。所需信息将出现在**错误**部分下。

## 海盗行为

在互联网上对版权材料的盗版是所有媒体中持续存在的问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过`<copyright@packtpub.com>`与我们联系，并提供疑似盗版材料的链接。

我们感谢您在保护我们作者和我们为您提供有价值内容的能力方面的帮助。

## 问题

如果您在这本书的任何方面遇到问题，您可以通过`<questions@packtpub.com>`联系我们，我们将尽力解决问题。
