<html><head></head><body>
        

                            
                    <h1 class="header-title">Visualizing Geographic Data</h1>
                
            
            
                
<p>For centuries, maps have been used to convey meaningful data. We are used to seeing maps representing data commonly around us, be it with Google Maps calculating distances, Uber tracking the cost and distance of locations, or weather forecasts looking at each region, and so on. In the last chapter, we learned a bit about the two standard map charts available in the <strong>Show Me</strong> menu, and how we can use these to visualize geographic data. In this chapter, we will dive deeper into the various mapping capabilities of Tableau and cover the following topics:</p>
<ul>
<li>Mapping basics</li>
<li>Map navigation – geographic search, pan and zoom, mark selection, and scaling</li>
<li>Map features – layering and custom territories</li>
<li>Modifying locations</li>
<li>Importing and managing custom geocoding</li>
<li>Connecting to spatial data</li>
<li>Using the background screenshot map</li>
<li>Creating density maps</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Technical requirements</h1>
                
            
            
                
<p>This chapter uses the following datasets:</p>
<ul>
<li>Global Superstore dataset, which can be found at <a href="http://www.tableau.com/sites/default/files/training/global_superstore.zip" target="_blank">http://www.tableau.com/sites/default/files/training/global_superstore.zip</a>.<a href="http://www.tableau.com/sites/default/files/training/global_superstore.zip" target="_blank"/></li>
<li>The London Wards dataset, which can be found at <a href="https://data.london.gov.uk/download/statistical-gis-boundary-files-london/08d31995-dd27-423c-a987-57fe8e952990/London-wards-2018.zip">https://data.london.gov.uk/download/statistical-gis-boundary-files-london/08d31995-dd27-423c-a987-57fe8e952990/London-wards-2018.zip</a>.<a href="https://data.london.gov.uk/download/statistical-gis-boundary-files-london/08d31995-dd27-423c-a987-57fe8e952990/London-wards-2018.zip" target="_blank"/></li>
<li>The 311 calls dataset, which can be found at <a href="https://data.nola.gov/City-Administration/311-Calls-Historic-Data-2012-2018-/3iz8-nghx">https://data.nola.gov/City-Administration/311-Calls-Historic-Data-2012-2018-/3iz8-nghx</a>.<a href="https://data.nola.gov/City-Administration/311-Calls-Historic-Data-2012-2018-/3iz8-nghx"/></li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Mapping basics</h1>
                
            
            
                
<p>Mapping in Tableau is very simple and based on geographic data fields that can be identified by the globe symbol next to them. To create a map, select the geographic fields and any measure, and then click on the <strong>Show Me</strong> Window. As you can see in the following screenshot, Tableau automatically highlights the symbol map as the preferred visual:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1450 image-border" src="img/87913c65-614f-4736-a18b-86833697ebc2.png" style="width:54.00em;height:25.00em;"/></p>
<p>Once you click it, it will create the following screenshot. As you can see, for each country, the symbol marks a point at the geographic center of the location:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1145 image-border" src="img/157a6486-5527-49f3-a835-54abe1de6342.png" style="width:39.33em;height:24.92em;"/></p>
<p>Symbol maps always plot marks at the geographic centers and can plot two measures at a time. Filled maps, on the other hand, use geographic locations to define the boundaries within which to fill and can only plot one measure at a time. Using the <strong>Show Me</strong> menu, if we now switch to filled maps, we can see the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1355 image-border" src="img/c8cb6d08-faf4-4cab-810b-ddf3997822f6.png" style="width:54.50em;height:28.00em;"/></p>
<p>If there are no geographic fields automatically detected by your data, right-click the field you want to display. Click <strong>Geographic Role | Appropriate Level.</strong> For example, in the following screenshot, if <kbd>Country</kbd> is not automatically detected as a geographic field, we can right-click and select <strong>Geographic Role |</strong> <strong>Country/Region</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1146 image-border" src="img/d60151dc-9a8e-431f-bd11-150816b3547b.png" style="width:29.33em;height:24.83em;"/></p>
<p>This will now turn the <kbd>Country</kbd> field into a <strong>Geographic field</strong>, which can be used in both <strong>symbol maps</strong> and <strong>filled maps</strong>. Both <strong>symbol maps</strong> and <strong>filled maps</strong> only differ in the number of measures they can show and how they visualize data. Other than that, both maps have the same shared common features and properties. From this section onward, we will use the common term <strong>map</strong> to refer to them, instead of differentiating between them. All of the properties discussed from here on apply to both map visuals. Now that we have clarified this, let's dive into the various <strong>map navigation</strong> features.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Map navigation</h1>
                
            
            
                
<p>When the mouse is anywhere on the map, you will see the <strong>Map Options</strong> menu appear by default, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1147 image-border" src="img/f16c41b1-3d7a-44ac-bd58-be0482519f1b.png" style="width:14.83em;height:14.17em;"/></p>
<p>If you do not see these options, don't worry. On the <strong>Menu Bar</strong>, click on <strong>Map | Map Options</strong> and it will show the options to add to the screen. You can see in the following screenshot that we had only the option for <strong>Show Map Scale</strong> unchecked. Go ahead and check that:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/765643b9-5607-4e52-8203-7e1f533c5f70.png" style="width:14.25em;height:17.25em;"/></p>
<p>You will notice at the bottom-right of the screen that, the map scale accuracy has appeared. The more you zoom into the map, the more your accuracy will increase. Having the distances scale easily allows us to look at distances in miles, kilometers, or any of your preferred units:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/15aef036-976e-423d-acde-4232a499ff3d.png" style="width:37.42em;height:23.67em;"/></p>
<p>Now, let's look at each of the features in detail.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Pan and zoom</h1>
                
            
            
                
<p>The pan and zoom features allow us to interact and inspect data on the map. We can focus on specific locations and move the map around to focus on key information.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Zoom in/out</h1>
                
            
            
                
<p>The <strong>Zoom In (+)</strong> or <strong>Zoom Out (-)</strong> buttons can be used to zoom into the map. You can also use your mouse to zoom in/out as you would usually do. Alternatively, you can <strong>double-click</strong> to <strong>Zoom In</strong> and press <em>Shift</em> and <strong>double-click</strong> to <strong>Zoom Out</strong>.</p>
<p>Once you zoom in/out, the map gets fixed to that area in the view. To quickly go back to the default view, click on the <strong>Reset Map</strong> pin. For example, in the following map, we are zoomed in on Europe, and the moment we click on Reset Map, it will take us back to the wider world view:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/7c05204d-54f9-4d81-874c-778aa520b4c2.png" style="width:49.67em;height:30.67em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Zoom area</h1>
                
            
            
                
<p>To zoom in to a particular area on the graph, the Zoom Area option is also available. Simply select the <strong>Zoom Area</strong> button <img src="img/77a4211f-823c-482c-a7ce-f51f36dca049.png" style="width:2.83em;height:1.58em;"/> from the toolbar and highlight the area you want to zoom into. In the following example, we are using the <strong>Zoom Area</strong> button to zoom into Canada and Alaska:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/6fb9eea1-d52e-4a33-9c5d-644fb78b1010.png" style="width:47.92em;height:29.33em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Pan</h1>
                
            
            
                
<p>The <strong>Pan</strong> option can be found right next to the Zoom Area options. <strong>Pan</strong> allows us to move the map to focus on it or show the regions the way we want. To pan, just select the <strong>Pan Option</strong> and then move the map around to suit your needs. Alternatively, you can hold down the <em>Shift</em> key and move the map. For example, in the following map, the position has been moved from the default display to show—to start with—Asia in the left and moving up to Europe and Africa on the right:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1151 image-border" src="img/4e88feb2-e5b7-4c4b-98a3-95292303ef5b.png" style="width:39.58em;height:21.67em;"/></p>
<p>For pan/zoom, use the shortcuts to navigate faster. Double-click to zoom in, press <em>Shift</em> and double-click to zoom out (alternatively, use default mouse zooming), and press <em>Shift</em> and move the map to pan. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Geographic Search</h1>
                
            
            
                
<p><strong>Geographic Search</strong> allows us to quickly search locations on the maps. For example, in our map of the countries, if we wanted to quickly look for Nigeria, we could simply use the search box and type <kbd>Nigeria</kbd> in it. As you type, a list of all relevant locations appears in the suggestions for you:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1451 image-border" src="img/3693ef90-4f4f-46d5-a111-dc4f099e20bc.png" style="width:27.75em;height:14.67em;"/></p>
<p>You can search for the following on the maps:</p>
<ul>
<li>Continent</li>
<li>Country</li>
<li>State or province</li>
<li>County</li>
<li>City</li>
<li>Postcode</li>
</ul>
<p>Once you type/select <strong>Nigeria</strong>, and press <em>Enter</em>, the map will zoom in to focus on it. You may notice that the map again gets pinned. Whenever you search/zoom/pan, the map will get pinned to that location. Just click on the reset button to reset to the default view. The following screenshot shows the result we obtain after searching for <strong>Nigeria</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1153 image-border" src="img/e483abda-d0d6-47c3-9f95-69995e318378.png" style="width:47.17em;height:26.58em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Marks selection</h1>
                
            
            
                
<p>As with all graphs, you can select marks on the maps, and perform activities such as grouping/sets creation. Beyond the usual rectangular selections, maps have two other selection features, Radial Selection and Lasso Selection, respectively:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/ee458f44-b926-40b2-b419-619df0f1ef89.png" style="width:20.75em;height:11.75em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Rectangular Selection</h1>
                
            
            
                
<p>Rectangular Selection is the default selection option available. Just drag the mouse on the screen to make a selection:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1452 image-border" src="img/802ed054-43a8-4ee2-9f70-25245b71b503.png" style="width:21.00em;height:16.67em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Radial Selection</h1>
                
            
            
                
<p>Radial Selection is a super useful feature of maps. It allows us to select locations in terms of a circular radius, which, in turn, allows us to look at the location in a radial distance of a point or to calculate distances between locations.</p>
<p>For example, we want to find the combined profit for all of the cities within a 50-mile radius of New York City, USA. We first search and zoom into New York City, USA. Then, we select <strong>Radial Search</strong>. Now, keeping New York City in the center, we zoom out 50 miles from the USA. The following screenshot shows a radial search:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/24550e08-5181-43ce-ad53-9a183492962d.png" style="width:33.92em;height:19.92em;"/></p>
<p>In case you do not see any distance marks, zoom into the location a bit more until they become visible. Once you have selected the locations, as shown in the preceding screenshot, you can see the summary for the locations selected as you would with a rectangular selection. Here, we can see the sum of profit is 79,534:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1155 image-border" src="img/4fb21a6c-f767-45d3-a2fb-90b9586f134a.png" style="width:35.50em;height:21.17em;"/></p>
<p>In this example, we used the radial select tool to define the locations which fall within a certain radius. Using the same principle, we can use this to find the radial distance between two locations. For example, if we had to search for the radial distance between San Diego and Los Angeles, we first filter on the two locations and then create a radial distance search between the two points. Choose any city as the center and extend the radius till you reach the other city. In the following screenshot, we kept Los Angeles as the center and extended the radius for 110 miles, until we reached San Diego. Hence, the radial distance between the two locations is 110 miles:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/c758bac0-7c4a-46a0-9253-270862fcae3b.png" style="width:27.75em;height:18.75em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Lasso Selection</h1>
                
            
            
                
<p>Sometimes, bounded ways of selection are not enough and we may need to select certain locations in an area but exclude others. In this case, <strong>Lasso</strong> (a freehand shape selection) is the best way to go. An example of this kind of selection can be seen in the following screenshot. Here, all western states that we want except Georgia are selected:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1156 image-border" src="img/d1194ad7-8f2b-483b-a5a1-357e9b36255d.png" style="width:27.17em;height:29.25em;"/></p>


            

            
        
    

        

                            
                    <h1 class="header-title">Scaling</h1>
                
            
            
                
<p>To change the scale of the map, go to Map | Map Options and select the <strong>Show Map Scale</strong> option. Here, you can switch the scales between the automatic, metric system, or US system. Once you set the scales, they become visible on the lower-right side of the map. </p>
<p>Read the units specified in any question related to mapping very carefully. You may need to change the scale of the map before performing the next steps. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Map features – layering and custom territories</h1>
                
            
            
                
<p>Now that we have learned how to create maps, let's look at how we can customize certain map details, such as the color of the map, what level of details it will display, and the territories shown within it.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Map Layers</h1>
                
            
            
                
<p>To view the layers that can be added or removed from the map or how it will look in the background, select <strong>Map | Map Layers</strong>. In previous versions of Tableau, you would select <strong>Map | Map Options. </strong>You will get the following screen:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1157 image-border" src="img/bb1500ee-680c-4d46-8edc-f3010169d757.png" style="width:13.58em;height:29.92em;"/></p>
<p>Here, you can select and change between the different backgrounds: <strong>Normal</strong>, <strong>Light</strong>, and <strong>Dark</strong>. Depending on the Tableau version, you may also have <strong>Street</strong>, <strong>Outdoors</strong>, and <strong>Satellite Backgrounds</strong> available:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1453 image-border" src="img/e7ab0db4-a7b0-48da-ae2f-d0a06924cc6b.png" style="width:52.08em;height:12.33em;"/></p>
<p>As shown in the following screenshot, in <strong>Map Layers</strong>, you can add the details you want to see on the map. For example, after focusing on New Jersey, the map now shows Zip Code, Metro Code, and Metro Boundaries as can be seen in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1159 image-border" src="img/8ede3123-d4ba-4cf9-a9da-ee5067d81309.png" style="width:63.83em;height:28.25em;"/></p>
<p>These layers help to add a deeper level of detail to the maps and allow you to customize what to view as per your needs. There are many map layers available for various regions. Explore each of them to see what you can add.</p>
<p>Certain map layers are only available at certain zoom levels and will appear grayed out if you are not at that level. Zoom in to reveal further layers.</p>
<p>Beyond changing the map background and layers, Tableau also has many data layers available that can be used to overlay data on the map. To add a data layer, select a layer from the <strong>Data Layers</strong> menu. For example, to understand whether <kbd>Profit</kbd> in <kbd>State</kbd> of the US is linked to the median age of the people, we can overlay <strong>Median Age</strong> on the graphs.</p>
<p>Create a symbol graph showing <kbd>Profit</kbd> by each <kbd>State</kbd>, and zoom in on the USA. Under <strong>Data Layers</strong>, select the following:</p>
<ul>
<li>Layer: Median Age</li>
<li>By: State</li>
<li><strong>Using: Blue Green Sequence</strong></li>
</ul>
<p>You will see the following graph:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1163 image-border" src="img/c9acd823-ef1d-4d1f-8da0-0648d2d9ef44.png" style="width:67.17em;height:26.42em;"/></p>
<p>As an exercise, add a few data layers and change the level to view them. This will familiarize you more with the data layer options you have available.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Custom territories</h1>
                
            
            
                
<p>Beyond defining what the map layers display, we can also create and show your own custom territory. There are two ways in which we can create our own territories:</p>
<ul>
<li>Grouping locations</li>
<li>Geocoding a field using other geographic fields</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Grouping locations</h1>
                
            
            
                
<p>Assume you are looking at data at the country level and focusing on Europe as a continent. Instead of looking at each country individually, you want to look at the data in two sections, Eastern Europe and Western Europe. To achieve this, look at the locations on the map, and use the selection tool to select the territories. Once you have them selected, click on the grouping icon, as shown in the following screenshot: </p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1164 image-border" src="img/144f6c4f-19c5-48b1-ab90-81cd7b324b90.png" style="width:52.08em;height:36.92em;"/></p>
<p>Selecting the groups will create a combined group for these locations. It will also add a <kbd>Country &amp; State</kbd> grouping to the marks shelf. All of your selected locations are now grouped and will be colored the same:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1165 image-border" src="img/9bfa89c5-d432-4c84-9f5e-b299064accf5.png" style="width:55.08em;height:33.58em;"/></p>
<p>Continue and group locations as you want. Once you are done grouping, remove the field from the Colors shelf. From Dimensions, bring <kbd>Country (group)1</kbd> to the Marks detail shelf, and move <kbd>Profit</kbd> back to colors. For example, in the following screenshot, based on Countries, two groups called Group 1 and Group 2 were created:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1166 image-border" src="img/41fac3cd-a81c-423d-8972-b070a87bfe0f.png" style="width:48.92em;height:23.08em;"/></p>
<p>Another way to create similar groups would be to right-click on the geographic field and select <strong>Create Group</strong>. Once the group is created, bring it to the details shelf and use it as you would use any other geographic field.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Geocoding using other geographic fields</h1>
                
            
            
                
<p>Another way to create custom territories is to geocode a custom location field present in the data based on other fields.</p>
<p>For example, we want to add the <kbd>Region</kbd> field to <kbd>Location Hierarchy</kbd>. To achieve this, right-click on the <kbd>Region</kbd> field. Select <strong>Geographic Role | Create From | Country.</strong> This adds the field to the location hierarchy and the globe shape denoting a geographic field appears next to it:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1167 image-border" src="img/c86f4f69-87f3-44c7-a437-02af38953c62.png" style="width:11.00em;height:6.08em;"/></p>
<p>Bring the <kbd>Region</kbd> field onto the <strong>Labels</strong> shelf. You can see the custom location on the map now appear as shown in the following screenshot: </p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1454 image-border" src="img/253cfaed-9c21-48ca-a84b-12c940f616cb.png" style="width:42.92em;height:22.92em;"/></p>
<p class="CDPAlignLeft CDPAlign">Using this method, you can view any custom territory that you have in your dataset.</p>
<p class="mce-root">Now that we have learned how to create maps and add geographic fields, we will move on to the next section where we will learn about modifying locations to help deal with erroneous or ambiguous location data.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Modifying locations</h1>
                
            
            
                
<p>Once you define a field as a geographic field, Tableau automatically detects the locations of the places. Sometimes, however, Tableau will show x Unknowns in the right-hand corner of the screen. This could be because the location can be ambiguous, that is, multiple places having the same name, or the spelling could differ from what Tableau recognizes, for example.</p>
<p>The easiest way to fix most errors is to bring other data fields into the map details as well. For example, if you are only plotting cities, many countries can have the same city names. Adding a country and state can help to rectify such errors. If there is a hierarchy of locations, then Tableau automatically uses it to remove ambiguities. If, after doing this, there are still errors remaining, you can custom edit the locations to make them match.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Editing locations</h1>
                
            
            
                
<p>To edit locations, either click on the right-hand corner on the x Unknowns value and it will open the <strong>Edit Locations</strong> window, or go to <strong>Maps |</strong> <strong>Edit Locations.</strong></p>
<p>Click on <strong>Country/Region.</strong> This will show how the country or region is getting detected. Many times, this field is set to fixed for a particular country. So, if you are in the UK, your map could be set at the fixed field for the United Kingdom. Now, if you had a dataset with states from the USA, it would not match any location. To fix it, you would need to edit the location and set either the fixed <strong>field </strong>to be the <strong>United States</strong>, or if your dataset contains a <kbd>Country</kbd> field, then set it to be matched from that field. In the following example, you can see that the <strong>Country/Region </strong>field is mapped to the <kbd>Country</kbd> geographic field, which is good:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1168 image-border" src="img/799e9fe9-f324-4859-9f0c-86a0ab1343d1.png" style="width:36.17em;height:27.17em;"/></p>
<p>Close that dialog box and look at the ambiguous values to edit. You will notice that the unmatched locations are highlighted. For example, for <strong>Lower Normandy</strong>, we know this is the state of <strong>Normandy</strong>. Search for <em>Normandy</em> in the <strong>Unrecognized</strong> box. Once you search and find it, select it. This will now match the location, as can be seen in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1169 image-border" src="img/d7c00439-99b4-4c21-9029-9228098b6661.png" style="width:33.25em;height:28.83em;"/></p>
<p>If you can't find matching names, but know the latitude and longitude of the location and when you are typing, you will see a message in the dialog box saying <kbd>Enter a Latitude and Longitude value</kbd>. If you don't see this, just type any number. Once you click on it, it will open a box where you can enter the <strong>Latitude</strong> and <strong>Longitude</strong> values alternatively, and click <strong>OK</strong>.</p>
<p>Once you are have mapped all of the locations you can, click OK. Now if you look at the lower-right corner, the number of <strong>Unknowns</strong> decreases. In this way, even if you have custom locations or different spellings, you can custom match them to appropriate locations to appear in the maps. So far, we have learned how to modify and match locations, and create custom geolocations. In the next section, we will go one step further and learn how to import custom geocoding into Tableau. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Importing and managing custom geocoding</h1>
                
            
            
                
<p>Beyond providing standard geocoding for geolocations such as City, State, Country, Country/Region, Zip Code, Postal Code, and County, Tableau also allows us to custom import their own geocoded files. Custom geocoded files are useful if we have locations that Tableau can't map, for example, a street address, or if there is a custom geographic field that we want to define, and so on. </p>
<p>To create a custom geocoding, we need a <kbd>.csv</kbd> file to import into Tableau. This file must contain <kbd>Latitude</kbd> and <kbd>Longitude</kbd> columns as real numbers, with at least one decimal point in them. Other than these two columns, the other columns will depend on whether we are extending an existing role or adding a new role.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Extending an existing role</h1>
                
            
            
                
<p>If your data contains many locations that do not get mapped easily using Tableau default hierarchies, instead of trying to correct every error manually, you can just extend the locations to include these missing values. The import file should contain the names matching the hierarchy you are extending and data for all levels above the location you are extending. For example, if you wanted to extend the <kbd>States</kbd> mapping to improve it, you will need to include the columns for <kbd>State/Province</kbd> and <kbd>Country</kbd> along with <kbd>Latitude</kbd> and <kbd>Longitude</kbd>. For example, if we want to add the following location to our data, we will first create a <kbd>.csv</kbd>, as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1170 image-border" src="img/ee613ebe-bb4d-4906-9441-f8e29541808c.png" style="width:27.08em;height:7.92em;"/></p>
<p>To import data, select <strong>Map | Geocoding</strong> | <strong>Import Custom Geocoding</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1171 image-border" src="img/518e2501-e7c4-4ac3-956f-9fedd970ae3a.png" style="width:42.50em;height:13.50em;"/></p>
<p>Select the folder where your <kbd>.csv</kbd> file is saved and click <strong>Import</strong>. Depending on the size of the default file and the geocoding to be imported, it will take a couple of minutes and then get imported.</p>
<p>Remember that, the highest level when extending geocoding is Country. There is no continent level. However, we can add new roles if we want to add geocoding up to the continent level.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Adding new roles</h1>
                
            
            
                
<p>If, for example, we wanted to create a hierarchy for locations including a <strong>Continent</strong> as a geographic field, we can create a simple dataset as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1172 image-border" src="img/96fe5416-f30a-4454-af03-8b73ab1a4590.png" style="width:23.50em;height:8.67em;"/></p>
<p>Now, click on <strong>Map | Import Custom Geocoding</strong> and find the location of the folder. Click on <strong>Import</strong>. Depending on your files for geocoding, it will take a couple of minutes for the file to be imported.</p>
<p>Now, right-click on <strong>Continent | Geographic Role</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1173 image-border" src="img/32178944-86c3-42b4-9086-0edcff2a61d9.png" style="width:31.25em;height:32.58em;"/></p>
<p>You will see that Continent appears as a role. You can select that to be the geographic type for <kbd>Continent</kbd>. To create a map from the custom mapping, select the <kbd>Latitude</kbd> and <kbd>Longitude</kbd> fields (not the generated ones) and the continent field, and create a map using the <strong>Show Me</strong> menu. Now, move the <kbd>Continent</kbd> field to <strong>Labels </strong>so you can see the labels on the <kbd>Continent</kbd> field. You should get a map like the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1455 image-border" src="img/b20857f9-7307-4040-86ef-29cbbf07091a.png" style="width:48.50em;height:25.67em;"/></p>
<p>As you can see, all of the continents are plotted where we want them to be. Beyond adding geocoding, you can also import your own spatial files to plot maps. Let's look into them in the next section.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Connecting to spatial data</h1>
                
            
            
                
<p>We can connect to, and import spatial data from, TopoJSON files, Shapefiles, MapInfo tables, GeoJSON files, KML files, and Esri File Geodatabases. Using these files, we can connect to point, linear, and polygon geometries. Currently, mixed geometries are not allowed in Tableau.</p>
<p>Each of the file sources listed earlier has certain restrictions on what the folder containing these files must include. These are listed in the following table:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>File Source</strong></p>
</td>
<td>
<p><strong>Files Required in Folder</strong></p>
</td>
</tr>
<tr>
<td>
<p>Esri Shapefiles</p>
</td>
<td>
<p><kbd>.shp</kbd>, <kbd>.shx</kbd>, <kbd>.dbf</kbd> , <kbd>.prj</kbd>, and <kbd>.zip</kbd></p>
</td>
</tr>
<tr>
<td>
<p>Esri Geodatabases</p>
</td>
<td>
<p>Either <kbd>.zip</kbd> containing <kbd>.gdb</kbd> or a <kbd>.gdb</kbd> file</p>
</td>
</tr>
<tr>
<td>
<p>KML files</p>
</td>
<td>
<p><kbd>.kml</kbd></p>
</td>
</tr>
<tr>
<td>
<p>TopoJSON</p>
</td>
<td>
<p><kbd>.topojson</kbd> or <kbd>.json</kbd></p>
</td>
</tr>
<tr>
<td>
<p>GeoJSON</p>
</td>
<td>
<p><kbd>.geojson</kbd></p>
</td>
</tr>
<tr>
<td>
<p>MapInfo</p>
</td>
<td>
<p><kbd>.MAP</kbd>, <kbd>.DAT</kbd>, <kbd>.TAB</kbd>, and <kbd>.MID</kbd>, or a <kbd>.MIF</kbd>, or <kbd>.ID</kbd> file</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>For an example of how to create maps using shapefiles, we will use the file downloaded for London Wards as an example. If you haven't already done so, download the <kbd>London-wards-2018.zip</kbd> file (<a href="https://data.london.gov.uk/download/statistical-gis-boundary-files-london/08d31995-dd27-423c-a987-57fe8e952990/London-wards-2018.zip">https://data.london.gov.uk/download/statistical-gis-boundary-files-london/08d31995-dd27-423c-a987-57fe8e952990/London-wards-2018.zip</a>) and extract it.</p>
<p>To connect the file in Tableau, go to <strong>Data | New Data Source | Spatial File</strong>. Locate the extracted folder for the London Wards Zip. Select either the Esri folder or the <kbd>Mapinfo</kbd> folder. For this example, we are loading the ESRI folder. It will ask you to select the shapefile. Select the <kbd>london_ward.shp</kbd> file.</p>
<p>Once you have imported the file, you are now ready to create maps. To create a map with all of the details for London Wards, click on the <kbd>Geometry</kbd> field. You will notice that, Tableau has automatically detected it as a Geographic field. Bring this field to the Detail Marks tab. As soon as you do this, the autogenerated <kbd>Latitude</kbd> and <kbd>Longitude</kbd> marks appear and a graph is created. Zoom out and you will see the same as the following screenshot. As you can see in the following screenshot, all of the wards for London in the UK have been plotted:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/1aa7b044-33ae-4e1e-b11b-c0011b3b7a01.png" style="width:62.00em;height:29.67em;"/></p>
<p>Now, to see the hectares per ward, bring the <kbd>Name</kbd> field in the details Marks, add the hectares field to the color, and your graph is created:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/8ecab1d3-69d1-4da3-b25d-dfc7fa35082e.png" style="width:63.42em;height:31.92em;"/></p>
<p>If you instead want to view the data at the district level, remove <kbd>Name</kbd> from detail and add <kbd>District</kbd> to the graph. In this way, you can see data at the district level. You can also make the map cleaner by removing any borders. Click on <strong>Color | Border | None.</strong> This will make the map cleaner, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1176 image-border" src="img/88a272f5-c78a-4cc1-af11-342dc876eebc.png" style="width:47.58em;height:30.83em;"/></p>
<p>Sometimes, shapefiles only contain geometric details but not the measures you want to see; for example, if you wanted to inspect a dataset about the population of each ward. Not to worry. Shapefiles function as normal files and can be joined to any other files, even other shapefiles. As an exercise, join two shapefiles and use them to create a dual-axis map.</p>
<p>In this section, we learned how to import custom geocoding to enhance mapping capabilities. For some use cases, even custom geocoding may not meet our needs. For such cases, we can use background images to plot our data. Let's learn how to do this in the next section.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Using background images to plot spatial data</h1>
                
            
            
                
<p>There may be situations when spatial data is not enough to accurately plot data on the map. In such cases, we can also use background images as a background. While this option allows for the most flexibility in how to plot, it also requires the most effort in defining the boundary and point coordinates.</p>
<p>For example, say you wanted to plot the house plan of your house and have the following data:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p>Location</p>
</td>
<td>
<p>Location ID</p>
</td>
<td>
<p>X</p>
</td>
<td>
<p>Y</p>
</td>
<td>
<p>Size</p>
</td>
</tr>
<tr>
<td>
<p>Room 3</p>
</td>
<td>
<p>1</p>
</td>
<td>
<p>15</p>
</td>
<td>
<p>20</p>
</td>
<td>
<p>100</p>
</td>
</tr>
<tr>
<td>
<p>Room 1</p>
</td>
<td>
<p>2</p>
</td>
<td>
<p>15</p>
</td>
<td>
<p>50</p>
</td>
<td>
<p>100</p>
</td>
</tr>
<tr>
<td>
<p>Room 4</p>
</td>
<td>
<p>3</p>
</td>
<td>
<p>40</p>
</td>
<td>
<p>20</p>
</td>
<td>
<p>125</p>
</td>
</tr>
<tr>
<td>
<p>Room 5</p>
</td>
<td>
<p>4</p>
</td>
<td>
<p>40</p>
</td>
<td>
<p>50</p>
</td>
<td>
<p>125</p>
</td>
</tr>
<tr>
<td>
<p>Porch</p>
</td>
<td>
<p>5</p>
</td>
<td>
<p>60</p>
</td>
<td>
<p>40</p>
</td>
<td>
<p>60</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>You also have this screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1177 image-border" src="img/6e97fed6-ca57-48ec-a34a-8c1135eb1490.png" style="width:48.92em;height:21.83em;"/></p>
<p>We add the screenshot data as the data source. To test how the appropriate positions would look, create a scatter plot with unaggregated measures. For the preceding example, plotting the <kbd>X</kbd> and <kbd>Y</kbd> values, we get the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1178 image-border" src="img/9b99ccdb-65d0-4116-af2e-7ed8b9b9ce43.png" style="width:32.17em;height:33.92em;"/></p>
<p>Once happy with where the <kbd>X</kbd> and <kbd>Y</kbd> points appear, click on <strong>Map | Background Image | Dataset</strong>. Select <strong>Add Image</strong>. Browse to where you saved the floor plan screenshot and click <strong>OK</strong>. Add in the details shown in the following screenshot: </p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1179 image-border" src="img/2ef7edb7-d370-4067-a6f4-6c0036d36c24.png" style="width:23.25em;height:22.17em;"/></p>
<p>Once you have entered the limits for <strong>X</strong> and <strong>Y</strong> and which fields denote <strong>X</strong> and <strong>Y</strong>, go to <strong>Options</strong> and select <strong>Always Show Entire Image</strong>. Click <strong>OK</strong>. You will get the points plotted on the screenshot. Now, you can see where each of the points is plotted. Change the marks type to Map and then add in the measures you want to plot. This now behaves like a map:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1180 image-border" src="img/586b0a8b-2b20-44a4-b22c-3d580cc156d6.png" style="width:48.83em;height:22.75em;"/></p>
<p>This technique can be used to plot static images from any map and plot measures on them.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating density maps</h1>
                
            
            
                
<p>Density marks were added to Tableau in version 2018.3. These marks add another way of finding patterns in areas where there is a lot of overlapping data or the concentration of data is very high. Density marks find their best use in creating density maps, making it super easy to find trends in spatial data. Density maps work best with custom geocoded files, as they allow for detailed granular data to be added. Granular and precise data in a small range, along with smooth changes in measure values is the ideal use case for using density maps. </p>
<p>For this example, we will be using the 311 calls dataset. In case you have not yet downloaded it, download it here in a <kbd>.csv</kbd> format: <a href="https://data.nola.gov/City-Administration/311-Calls-Historic-Data-2012-2018-/3iz8-nghx">https://data.nola.gov/City-Administration/311-Calls-Historic-Data-2012-2018-/3iz8-nghx</a>.</p>
<p>Now, if we want to understand the distribution of calls by <kbd>Zip Code</kbd> for <kbd>LA</kbd>, and decide to plot a <strong>Symbol Map</strong>, after much zooming in, the following screenshot shows what it would look like:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1181 image-border" src="img/2e805c81-20dd-4782-a203-adfaae082101.png" style="width:53.17em;height:32.67em;"/></p>
<p>This doesn't give us much information. Looking at the map, it looks like all locations have almost equal calls, which isn't true. In cases like this, density maps become super useful. To convert this screenshot into a density map, in the <strong>Marks</strong> menu, change the mark type from Automatic to Density. You will see a certain pattern emerging, but it isn't very clear. To enhance it, it becomes important to have a proper color scheme. Click on the <strong>Color</strong> mark, and change the color to Density Multi-Color Light. Once the color is changed, we can see the pattern more easily as in the following screenshot. You can further change the intensity and opacity of the colors in the <strong>Color</strong> menu:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1182 image-border" src="img/a25cccf2-d05f-4ff4-8ee3-82caabdb8979.png" style="width:54.58em;height:33.17em;"/></p>
<p>You can quickly see that the calls are concentrated in the center of the city and less toward the lakeshore. You can further filter and compare the different issue types and see how they differ in their concentration. You can further use the Pages shelf to see the trends across time for the issues. The density when using the pages shelf is calculated for the entire dataset, so the patterns can quickly be seen relative to time or other factors. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Summary</h1>
                
            
            
                
<p>In this chapter, we detailed how to create, navigate, and customize maps. We learned how to identify the correct locations for mapping, enhance geocoding, and create our own custom geocoding and geographic fields. Furthermore, we covered spatial files, and how they can be leveraged to create nuanced maps for specific purposes. We also looked at adding background images to maps, creating custom maps, and creating density maps.</p>
<p>All of this will give you a firm understanding of the extent of customization you can achieve with maps and how they can be a powerful analysis tool. In the next chapter, we will start by creating simple calculations that can be leveraged across the various visuals we have learned about in this chapter and the last. </p>


            

            
        
    </body></html>