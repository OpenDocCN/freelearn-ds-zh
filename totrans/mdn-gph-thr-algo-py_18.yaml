- en: '13'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Putting It All Together
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapters, we explored different data problems amenable to network
    science solutions, learned many network centrality metrics, and applied **machine
    learning** (**ML**) models to network science datasets. In this chapter, we’ll
    put together what we have learned so far to assess epidemic risk on a spatiotemporal
    dataset assessed at each time point for centrality metrics and number of Ebola
    cases. Our example will include network and other data collected on a geographic
    region of the Democratic Republic of Congo that was impacted by a large Ebola
    outbreak in 2018-2020 and several smaller outbreaks since 2020\. We’ll also introduce
    a statistical model used to model time series data much like a regression model.
  prefs: []
  type: TYPE_NORMAL
- en: 'Specifically, we will cover the following topics in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction to the problem
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction to **generalized estimating** **equations** (**GEEs**)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data transformation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Data modeling
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By the end of this chapter, you’ll understand how to solve a problem end-to-end
    with network science tools and statistical models. You’ll be able to run time
    series models in Python and interpret the results mathematically. Finally, you’ll
    end this chapter equipped to apply what you have learned in this book to data
    science problems that you face in your work.
  prefs: []
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The code for the practical examples presented in this chapter can be found
    here: [https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python](https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python)'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction to the problem
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Ebola virus is a **filovirus**, a single-stranded ribonucleic acid (RNA)
    virus enveloped with a lipid layer. It was first identified in 1976 and is **zoonotic**—spreading
    from infected animal hosts to human populations. The animal vector from which
    Ebola spreads to humans is currently unknown. However, the virus is spread from
    person to person through direct contact with bodily fluids, placing frontline
    healthcare workers and family caregivers at high risk of both contracting and
    spreading the virus.
  prefs: []
  type: TYPE_NORMAL
- en: The Ebola virus inhibits immune response, inhibits clotting, promotes renal
    and electrolyte dysfunction, and promotes acidosis. All of these contribute to
    hypovolemia, which triggers organ failure and death in many cases. It is endemic
    to several areas of Africa, including the Congo Basin, where the majority of outbreaks
    have originated. Case fatality rates are typically in the 40-50% range in known
    outbreaks, typically due to a lack of supportive care such as transfusions and
    life support in rural regions that often experience the initial cases.
  prefs: []
  type: TYPE_NORMAL
- en: 'During outbreaks, personal protective gear is critical for avoiding spread
    to and by healthcare providers. However, in many rural areas, lack of medical
    supplies limits healthcare providers’ ability to protect themselves, contributing
    to early disease spread. In addition, isolation of cases is necessary to avoid
    infecting other patients seeking care at a clinic. *Figure 13**.1* shows a doctor
    in personal protective gear at a clinic set up to isolate Ebola patients:'
  prefs: []
  type: TYPE_NORMAL
- en: "![Figure 13.1 – \uFEFFAn illustration of a doctor in personal protective gear\
    \ at a makeshift clinic to treat Ebola patients](img/B21087_13_01.jpg)"
  prefs: []
  type: TYPE_IMG
- en: Figure 13.1 – An illustration of a doctor in personal protective gear at a makeshift
    clinic to treat Ebola patients
  prefs: []
  type: TYPE_NORMAL
- en: In December 2013, the worst outbreak of the Ebola virus began in Meliandou in
    Guéckédou Prefecture, Guinea—a small town from which the virus spread through
    Guinea and its neighbors, Sierra Leone and Liberia. Eventually, cases spread to
    Italy, Mali, Nigeria, Senegal, Spain, the United Kingdom, and the United States,
    with secondary cases reported in several of these countries (mainly healthcare
    workers). By the end of the outbreak, nearly 30,000 people were infected, and
    over 10,000 died. The virus mutated multiple times by the end of the outbreak
    in 2016, and researchers developed a vaccine to extinguish the epidemic and limit
    its spread around the world and within large cities such as Conakry, Guinea. The
    reproduction number ranged from 1.20 in Liberia to 2.02 in Sierra Leone, contributing
    to the rapid spread and high infection rate in the three main countries impacted.
  prefs: []
  type: TYPE_NORMAL
- en: The 2018 Ebola virus outbreak in the Democratic Republic of Congo impacted the
    provinces of Ituri, North Kivu, and South Kivu, with cases concentrated in Beni,
    Butembo, Katwa, Kalunguta, Mabalako, and Mandima. Over 3,500 confirmed and suspected
    cases were identified by 2020, with over 2,200 deaths despite prompt intervention
    from local and international public health workers and the availability of a vaccine
    developed during the 2014 West African Ebola outbreak. From late 2018 to mid-2019,
    the reproduction number remained over 1, indicating sustained infection potential.
    In fact, most cases did occur during this time frame.
  prefs: []
  type: TYPE_NORMAL
- en: Prompt intervention limited the potential number of infected people to roughly
    16,000—rather than 16 million people living in the impacted provinces—due to the
    isolation of towns and prompt interventions by public health workers. Border surveillance
    measures limited the spread of Ebola to neighboring countries such as Burundi
    and Rwanda. However, distrust of international aid workers, the ongoing conflict
    with the M23 rebel group, and violence spilling into treatment areas complicated
    the epidemic response by local and international aid groups. Better coordination
    of response and better handling of security threats could have prevented the spread
    and led to better survival rates.
  prefs: []
  type: TYPE_NORMAL
- en: While this chapter will focus on modeling networks that facilitated the spread
    of Ebola across regions of the Democratic Republic of Congo, the methods we’ll
    use can be extended to working with any type of **partial differential equation**
    (**PDE**) model related to the spread of networks. For instance, readers interested
    in ecology and conservation might consider a network science approach to modeling
    the geographic spread of toxins that impact leafy sea dragons, Bahamian saw sharks
    or sulcata tortoise populations; they may also want to understand evasion or delays
    in predator-prey relationships. Social scientists might consider the spread of
    political ideologies across countries in a region or models where effects of behavior
    change at a population level in response to social media campaigns may involve
    delays, where change happens over longer periods of time or needs to reach a threshold
    before effects are seen. Biomedical researchers might consider chemical gradient
    models within the context of cell differentiation and morphogenesis, the spreading
    of seizures through the cerebral cortex, or even the dynamics of tumor growth
    across regions of the brain. Farmers may wish to consider spatial models that
    limit the spread of locusts or other pests that endanger crops with limited barrier
    resources.
  prefs: []
  type: TYPE_NORMAL
- en: For now, let’s return to our Ebola virus example and dive deeper into the context
    of the outbreak.
  prefs: []
  type: TYPE_NORMAL
- en: Ebola spread in the Democratic Republic of Congo – 2018-2020 outbreak
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Despite a rapid response from public health workers, the 2018 Ebola outbreak
    included waves of exponential growth. Many impacted areas included cities with
    populations over 100,000, and militant attacks on healthcare facilities prior
    to the outbreak and since the outbreak have threatened medical infrastructure
    and prompt care for patients. Due to the ongoing conflict, many at-risk populations
    in rural areas outside major cities hesitated to receive vaccines or follow public
    health advisories. Misinformation was abundant, delaying treatment for some patients
    and allowing Ebola to spread to caregivers. All these factors facilitated the
    spread of Ebola from city to city within the impacted regions.
  prefs: []
  type: TYPE_NORMAL
- en: 'However, much of Ituri, North Kivu, and South Kivu includes regions of dense
    rainforests, wildlife preserves, and sparse populations, limiting travel between
    cities that typically fuels epidemic spread across regions (see *Figure 13**.2*).
    In fact, much of the spread occurred across larger cities connected by transportation.
    This likely ameliorated the impact of this Ebola epidemic compared to the West
    African 2014 outbreak that included cities with many transportation routes:'
  prefs: []
  type: TYPE_NORMAL
- en: "![Figure 13.2 – \uFEFFAn illustration of a protected area of the Congo Basin](img/B21087_13_02.jpg)"
  prefs: []
  type: TYPE_IMG
- en: Figure 13.2 – An illustration of a protected area of the Congo Basin
  prefs: []
  type: TYPE_NORMAL
- en: Unfortunately, due to cities nested in densely forested regions where Ebola’s
    animal vectors live, the geography of the northeastern Democratic Republic of
    Congo increases the likelihood of outbreaks in the region. This increases the
    likelihood of future Ebola outbreaks in the region. Thus, it is important to study
    some of the factors that facilitate epidemic spread and vulnerability over time,
    such that quick and effective responses reach the region as soon as another outbreak
    is identified. This limits the number of people exposed and potentially lowers
    mortality rates as more people are vaccinated and treated.
  prefs: []
  type: TYPE_NORMAL
- en: Geography and logistics
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As we have seen in the prior subsections, regional geography and the logistics
    of transportation between cities play a large role in the potential spread of
    an epidemic. Within an epidemic, an isolated area with little or no population
    mixing with other regions suggests a contained epidemic. However, a transportation
    hub (such as a city with many international flights per day) poses a much greater
    risk to public health during an outbreak. In fact, this is exactly what quickly
    spread COVID-19; short incubation periods coupled with many travelers from international
    hubs traveling to other international hubs led to an explosion of cases in new
    countries and continents until borders were shut down to stem the flow of disease.
  prefs: []
  type: TYPE_NORMAL
- en: In our analysis, we’ll consider a few of the regions most impacted by the 2018
    Ebola outbreak, including network connectivity metrics based on transportation
    routes between regions, number of cases per year, number of violent incidents
    (which may displace people regionally), and number of disaster incidents (again,
    a regional displacement risk) from 2017-2021\. We hypothesize that network metrics
    derived from regional connectivity will impact the number of Ebola cases during
    the outbreak period.
  prefs: []
  type: TYPE_NORMAL
- en: Before we begin constructing our dataset, let’s first establish the necessary
    tools for our analysis—specifically, longitudinal regression modeling.
  prefs: []
  type: TYPE_NORMAL
- en: Introduction to GEEs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Regression models come with many assumptions that need to be relaxed for many
    types of real-world problems. For instance, linear regression assumes a normally
    distributed outcome. In many problems, we may wish to work with binary outcome
    data (yes/no, survived/died, recurred/did not recur…), count data (number of events
    in a period of time, such as this chapter’s outcome), or failure rates for a manufactured
    product (likelihood of failure outcome).
  prefs: []
  type: TYPE_NORMAL
- en: One of the most common outcome distributions comes from the binomial distribution,
    in which binary data is collected across a population. For example, we may have
    a sample of patients in a glioblastoma study, where we compare 6-month survival
    rates of patients across different treatment groups. Each patient will either
    survive or die (binary outcome); aggregated by group, these outcomes form binomial
    distributions, which can be compared statistically to determine if an optimal
    treatment exists for glioblastoma patients.
  prefs: []
  type: TYPE_NORMAL
- en: '**Generalized linear regression** extends linear regression to outcomes such
    as the aforementioned ones by using a link function to transform the outcome to
    that of a normal distribution using a geometry-rooted map; most types of outcomes
    fit into this framework, as they belong to an outcome family called the **exponential
    family**. Distributions in the exponential family can be mapped to each other
    using tools from geometry.'
  prefs: []
  type: TYPE_NORMAL
- en: 'However, generalized linear regression comes with many assumptions common to
    linear regression: linear independence of variables, linear relationships between
    predictor variables and the outcome, and constancy of errors across levels of
    predictor variables (technically called homoscedasticity), among others. Some
    of these assumptions—namely, independence of predictor variables—do not hold for
    time series or spatial data. Predictor variables measured at one time point likely
    depend on values of those variables measured at prior time points. In our example,
    the ability of public health workers and doctors to identify an outbreak early
    enough to stop it plays a large role in later case rates and resource needs (shown
    in *Figure 13**.3*):'
  prefs: []
  type: TYPE_NORMAL
- en: "![Figure 13.3 – \uFEFFAn illustration of doctors and epidemiologists tracking\
    \ the source of an outbreak](img/B21087_13_03.jpg)"
  prefs: []
  type: TYPE_IMG
- en: Figure 13.3 – An illustration of doctors and epidemiologists tracking the source
    of an outbreak
  prefs: []
  type: TYPE_NORMAL
- en: GEEs are one solution that mathematically transforms generalized linear models
    to data involving multiple time points or clustering within the dataset. Essentially,
    we can model dependencies across time (or clusters) using a matrix of dependency
    correlations. GEEs retain a link function, allowing them to model outcomes within
    the exponential family, such as our number of yearly Ebola cases across regions.
  prefs: []
  type: TYPE_NORMAL
- en: One of the advantages of this approach compared to other generalized linear
    model extensions for time series or clustered data is that GEEs are easier to
    compute. Many other extensions, such as generalized linear mixed models, require
    multilevel modeling, with dependencies across levels. This creates additional
    parameters and dependencies within the model (which create conditional distributions).
    GEEs do not involve conditional distribution calculations. This allows us to save
    on computational costs, even with simple time series or clustering components
    in our model.
  prefs: []
  type: TYPE_NORMAL
- en: For readers who have a more advanced mathematical background, we’ll spend a
    bit of time diving into the mathematics of generalized linear models and GEEs
    in the next section. Readers less comfortable mathematically can skip the mathematical
    formalization and go directly into the data construction part of the *Our problem
    and GEE formulation* section. However, it’s helpful to know the mathematics behind
    regression equations when using them, and those of you interested in using GEEs
    are encouraged to look through the references at the end of the chapter for more
    detailed mathematical explanations.
  prefs: []
  type: TYPE_NORMAL
- en: Mathematics of GEEs
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In **linear regression**, where the outcome is normally distributed and observations
    and predictors are independent of each other, we estimate the effect sizes of
    each predictor through estimations of matrix algebra, where the outcomes are known
    for each observation (represented as a **vector**) and the predictors are known
    for each observation (represented as a matrix of vectors associated with each
    predictor). The outcome vector equals the effect-size vector multiplied by the
    predictor matrix plus an error term to capture random errors in measurement. In
    practice, the problem is difficult to solve with matrix operations and an algorithm
    to estimate the effect sizes iteratively is used to solve it.
  prefs: []
  type: TYPE_NORMAL
- en: Generalized linear regression extends this methodology by introducing a link
    function applied to the outcome vector to transform the equation to a linear form,
    for which effect size coefficients are found by applying an algorithm. However,
    to rescale those effect sizes so that they match the scale of the original outcome
    prior to the application of the link function, we reverse the operations of the
    link function to scale the effect size appropriately. In logistic regression,
    for instance, a common link function involves log transformation. Exponentiating
    the effect sizes rescales those effect sizes so that they match the outcome’s
    scale rather than the log of the outcome.
  prefs: []
  type: TYPE_NORMAL
- en: In practice, linear and generalized linear regression models are fit using **maximum
    likelihood estimation** (**MLE**), an algorithm that iteratively adjusts estimates
    of the effect-size vector. This algorithm fits according to the assumed probability
    distribution of the outcome and the observed distribution of the predictors by
    iterative resampling. This allows for statistical inference on the estimation
    of effect sizes.
  prefs: []
  type: TYPE_NORMAL
- en: With respect to GEEs, the clustered nature of the outcomes and predictors by
    individuals in our sample over time introduces a correlation structure for each
    individual in our sample, as well as sample-based effect sizes for predictors
    based on outcomes. We define a best guess as to the structure of the correlation
    matrix within individuals, called the **autoregressive structure**, which can
    be estimated from the data, left unspecified, or defined as a specific structure
    tying observations together across time or space. In practice, leaving this unspecified
    or estimated from the data is best if the correlation structure is not known.
    After defining the autoregressive structure, we estimate the covariance matrix
    to correct for any assumption errors within the autoregression specifications.
  prefs: []
  type: TYPE_NORMAL
- en: An algorithm then estimates the effect sizes within and across individuals.
    Generally, algorithms used to fit the model rely on computing the derivatives
    of the GEE’s linear algebra formulation rather than the computation of maximum
    likelihood estimators; derivative-based methods often offer computational advantages
    over the MLE methodology. In addition, derivative-based methods yield model output
    similar to a generalized linear regression model, though not all overall model
    fit statistics can be estimated.
  prefs: []
  type: TYPE_NORMAL
- en: Those of you who are interested in the linear algebra formulation of generalized
    linear regression and GEEs can consult the references at the end of this chapter
    for detailed explanations of these models and the estimators used to find predictor
    effect sizes. The Nelder (1972) text overviews the theory of generalized linear
    models and their computation very nicely. The Hanley et al. (2003) text provides
    both a linear algebra overview of GEEs and a simple case study where estimates
    can be calculated easily by readers. It’s recommended that those of you who wish
    to understand the mathematics behind GEEs start with the mathematics and computational
    methodology of generalized linear models before tackling models derived from them,
    such as GEEs.
  prefs: []
  type: TYPE_NORMAL
- en: For now, let’s turn back to the construction of our dataset.
  prefs: []
  type: TYPE_NORMAL
- en: Our problem and GEE formulation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In our formulation of Ebola risk over time and geography in the Democratic
    Republic of Congo, we’ll look at the number of yearly Ebola cases in one of the
    following cities as our outcome:'
  prefs: []
  type: TYPE_NORMAL
- en: Mandima
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mabalako
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kangulata
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Katwa
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Butembo
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bunia
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Beni
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We’ll cluster these cities by province, including Mandima and Bunia in Ituri
    and Mandima, Mabalako, Kangulata, Katwa, Butembo, and Beni in North Kivu. Next,
    we’ll construct a network of transportation options between cities and obtain
    betweenness and degree of centrality for each city. This will provide us with
    an estimate of bridgeness and hubness within each year’s network.
  prefs: []
  type: TYPE_NORMAL
- en: We’ll also include other statistics, including the number of violent incidents
    that year involving our cities and the number of natural disasters impacting our
    cities.
  prefs: []
  type: TYPE_NORMAL
- en: For a number of Ebola cases, we’ll consolidate the `ebola-epidemic-health-zone-figures.csv`
    **Humanitarian Data Exchange** (**HDX**) dataset ([https://data.humdata.org/dataset/ebola-cases-and-deaths-drc-north-kivu](https://data.humdata.org/dataset/ebola-cases-and-deaths-drc-north-kivu))
    to include the cities of interest for our analysis. To obtain the necessary transportation,
    we’ll search the web for feasible routes between cities (biking, public transportation,
    or driving). Given that this is current data, we will also search for changes
    within the period of 2017-2021, including COVID-19 restrictions. We’ll use **ReliefWeb**
    to find incidents mentioning natural disasters ([https://reliefweb.int/disasters?list=Democratic%20Republic%20of%20the%20Congo%20Disasters&advanced-search=%28C75%29](https://reliefweb.int/disasters?list=Democratic%20Republic%20of%20the%20Congo%20Disasters&advanced-search=%28C75%29)).
    Consolidating another HDX dataset will yield information about violent incidents
    in each area ([https://data.humdata.org/dataset/ucdp-data-for-democratic-republic-of-the-congo](https://data.humdata.org/dataset/ucdp-data-for-democratic-republic-of-the-congo)).
    While this may not include all information for a region in our time period, we
    should capture major conflicts or disasters.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have our data sources, let’s explore the data and perform the needed
    transformations to coax the data into a format that will work as input to our
    GEE model.
  prefs: []
  type: TYPE_NORMAL
- en: Data transformation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As we assembled our dataset, we noticed a few caveats in data quality worth
    mentioning. Very few natural disasters hit the area during our time period of
    interest, and these were spread across a wide geography. It’s unlikely that this
    factor will impact Ebola spread, but we will keep this variable in our dataset.
  prefs: []
  type: TYPE_NORMAL
- en: The source for violent incidents appears to be missing information, as known
    attacks on aid workers and Ebola treatment sites in Katwa are not included in
    the data. This suggests an incomplete data source that may not capture violent
    incidents at the level needed for a real-world analysis of factors influencing
    Ebola spread. However, for purposes of demonstrating this method, it captures
    enough to be potentially interesting in the analysis. In projects such as this,
    data quality can be questionable, as good sources are hard to find in much of
    the developing world.
  prefs: []
  type: TYPE_NORMAL
- en: The search for transportation routes was also questionable, yielding some insight
    into direct routes but not in as much detail as would be ideal. We considered
    any route between city pairs to be viable if travel would take less than 10 hours
    by car, bus, or foot travel. Most cities yielded useable data; however, some cities
    did not show viable routes, yielding isolated vertices in our travel network.
    No major differences in routing existed across the years (no projects listed to
    create new roads or bus routes), so our network properties will not change over
    the years.
  prefs: []
  type: TYPE_NORMAL
- en: The Ebola case source data likely showed some errors, as cumulative cases were
    sometimes lower over time for certain locations. We erred on the side of retaining
    positive or zero case totals per year, given that we hope to model our outcome
    as count data. Cases can be difficult to determine in such outbreaks, as lab confirmation
    is difficult and often time-consuming when sent to another city for analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Thus, our data collection for this project highlights some of the real-world
    challenges of building datasets from scratch, particularly in areas where data
    collection may be incomplete or nonexistent with respect to open source sites.
    It is often advantageous to examine many potential sources and either merge insights
    or choose the best source. In our case, we chose the most complete sources to
    obtain our dataset.
  prefs: []
  type: TYPE_NORMAL
- en: Python wrangling
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: From our sources, we’ve assembled a `.csv` file containing year, city, region,
    conflict, disaster, and Ebola case data. However, we’ll need to compute **betweenness
    centrality** and **degree centrality** from our transportation network and add
    that to our dataset to capture transportation network properties for each city.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s get started by computing the centrality metrics for each city in our
    transportation dataset so that we can append these values to our `.csv` file.
    We’ll compute the metrics using `Script 13.1`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'This script should yield a plot showing two isolated vertices and several vertices
    connected by weighted paths with values of `1`, `2`, or `3`, as shown in *Figure
    13**.4*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.4 – A plot of the Ebola network city](img/B21087_13_04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.4 – A plot of the Ebola network city
  prefs: []
  type: TYPE_NORMAL
- en: From *Figure 13**.4*, we can see that Kalunguta and Mandima are not connected
    to other cities, while other cities seem to be connected quite densely into a
    high-traffic area. For a more comprehensive examination of travel, we might also
    consider the volume of travel between areas; within our context, this data does
    not seem to exist.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have our vectors of betweenness and degree centrality, which capture
    the bridgeness and hubness of our cities, we can attach these values to the dataset
    we’ve created to ready the dataset for analysis with a GEE.
  prefs: []
  type: TYPE_NORMAL
- en: GEE input
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Now that we’ve derived our network metrics, let’s import our collected dataset
    and attach the network metrics as additional columns by adding to `Script 13.1`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Now that we’ve assembled our full dataset, we’re ready to analyze it with our
    GEE model.
  prefs: []
  type: TYPE_NORMAL
- en: Data modeling
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: For our model, we’ll assume our outcome has a **Poisson distribution**. While
    our dataset doesn’t have a lot of zero values, it may be worth considering a zero-inflated
    Poisson or negative binomial distribution rather than a Poisson distribution.
    However, for simplicity of modeling, we will set our family to a Poisson distribution.
  prefs: []
  type: TYPE_NORMAL
- en: We’ll use a data-derived autocorrelation structure, as a best guess for correlations
    over time within towns isn’t readily apparent. In practice, it’s usually better
    to derive this structure from data than make a guess when the structure isn’t
    known well beforehand.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s get started modeling this GEE in Python.
  prefs: []
  type: TYPE_NORMAL
- en: Running the GEE in Python
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let’s first import our GEE model and define the distribution family and covariance
    structure with `Script 13.2`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Now that we have our model defined, we can fit the model to our data, including
    all of our relevant predictors by adding to `Script 13.2`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: This model should fit quickly given the small size of the dataset. Larger models
    may take a while to run, particularly those with large numbers of clusters and
    many time points considered. However, this model will run more quickly than other
    longitudinal models such as generalized linear mixed models, as it does not have
    a hierarchical structure or likelihood function derivations.
  prefs: []
  type: TYPE_NORMAL
- en: 'We can now examine our model’s parameters and fit statistics to see what is
    predictive of Ebola cases within our data by adding to `Script 13.2`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'This should give a summary similar to *Table 13.1*:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **GEE** **Regression Results** |'
  prefs: []
  type: TYPE_TB
- en: '| --- |'
  prefs: []
  type: TYPE_TB
- en: '| Dep. Variable: | Ebola_Cases | No. Observations: | 35 |'
  prefs: []
  type: TYPE_TB
- en: '| Model: | GEE | No. clusters: | 7 |'
  prefs: []
  type: TYPE_TB
- en: '| Method: | Generalized | Min. cluster size: | 5 |'
  prefs: []
  type: TYPE_TB
- en: '|  | Estimating Equations | Max. cluster size: | 5 |'
  prefs: []
  type: TYPE_TB
- en: '| Family: | Poisson | Mean cluster size: | 5.0 |'
  prefs: []
  type: TYPE_TB
- en: '| Dependence structure: | Exchangeable | Num. iterations: | 11 |'
  prefs: []
  type: TYPE_TB
- en: '| Date: | Thu, 21 Dec 2023 | Scale: | 1.000 |'
  prefs: []
  type: TYPE_TB
- en: '| Covariance type: | robust | Time: | 10:18:47 |'
  prefs: []
  type: TYPE_TB
- en: '|  | **coef** | **std err** | **Z** | **P>&#124;z&#124;** | **[****0.025**
    | **0.975]** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Intercept | 3.8291 | 0.716 | 5.345 | 0.000 | 2.425 | 5.233 |'
  prefs: []
  type: TYPE_TB
- en: '| Province[T.North_Kivu] | 1.1145 | 0.699 | 1.593 | 0.111 | -0.256 | 2.485
    |'
  prefs: []
  type: TYPE_TB
- en: '| Violent_Incidents | 0.0312 | 0.022 | 1.415 | 0.157 | -0.012 | 0.074 |'
  prefs: []
  type: TYPE_TB
- en: '| Disasters | -3.3828 | 0.323 | -10.467 | 0.000 | -4.016 | -2.749 |'
  prefs: []
  type: TYPE_TB
- en: '| Degree | -0.0098 | 0.093 | -0.105 | 0.917 | -0.192 | 0.173 |'
  prefs: []
  type: TYPE_TB
- en: '| Betweenness | -0.0806 | 0.975 | -0.083 | 0.934 | -1.991 | 1.830 |'
  prefs: []
  type: TYPE_TB
- en: '| **Skew:** | **1.7851** | **Kurtosis:** | **3.7263** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Centered skew: | 1.3387 | Centered kurtosis: | 2.2241 |'
  prefs: []
  type: TYPE_TB
- en: Table 13.1 – GEE model fit statistics
  prefs: []
  type: TYPE_NORMAL
- en: '*Table 13.1* shows that most of our predictors do not show a relationship with
    the number of Ebola cases in each town. Disasters do seem to have a negative relationship
    (*z*-value of `-10.467`, which is significant at `p<0.001`). This might relate
    to relevant resources positioned in an area to respond to a disaster that can
    be repurposed for response to the Ebola outbreak. Note that violent incidents
    reach a level of near significance statistically (*z*-value of `1.415`, which
    is a *p*-value of `0.157`), showing a potentially positive relationship with the
    number of cases. In a larger sample and with better data on violent incidents,
    it is likely that violent incidents would turn out to be predictive of Ebola cases,
    as we had hypothesized. The location of North Kivu appears to have another nearly
    significant relationship (*p*-value of `0.111`), suggesting that it is an important
    location that requires monitoring. The other potential predictors have *z*-values
    near `0`, suggesting that they are not important and likely would not play a role
    even with a larger sample size.'
  prefs: []
  type: TYPE_NORMAL
- en: We do not see either of our network metrics as a significant predictor of Ebola
    cases. It is likely that transportation does not play a large role in outbreak
    case volumes; given the relative isolation of some areas, this makes logical sense.
    Yearly travel volumes between cities, if they could be obtained, might be more
    predictive of Ebola cases over time. However, to our knowledge, this does not
    exist for the towns considered in our analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we tied together many of the tools we examined in previous
    chapters to tackle a major problem in public health: Ebola outbreaks. We constructed
    and analyzed properties of spatiotemporal data in a region recently impacted by
    an Ebola outbreak. We then fed this information into a longitudinal statistical
    model called a GEE to understand which factors may have contributed to the outbreak’s
    spread over time and geography using Python.'
  prefs: []
  type: TYPE_NORMAL
- en: In this book so far, we have overviewed many tools and now applied them on a
    final project. Next, we’ll consider nascent tools in network science that offer
    promise for future projects, including hypergraphs and quantum network science
    algorithms.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Ballinger, G. A. (2004). Using generalized estimating equations for longitudinal
    data analysis. *Organizational research methods,* *7(2), 127-150.*
  prefs: []
  type: TYPE_NORMAL
- en: 'Bolker, B. M., Brooks, M. E., Clark, C. J., Geange, S. W., Poulsen, J. R.,
    Stevens, M. H. H., & White, J. S. S. (2009). Generalized linear mixed models:
    a practical guide for ecology and evolution. *Trends in ecology & evolution,*
    *24(3), 127-135.*'
  prefs: []
  type: TYPE_NORMAL
- en: 'Breslow, N. E. (1996). Generalized linear models: checking assumptions and
    strengthening conclusions. *Statistica applicata,* *8(1), 23-41.*'
  prefs: []
  type: TYPE_NORMAL
- en: Gatherer, D. (2014). The 2014 Ebola virus disease outbreak in West Africa. *Journal
    of General Virology,* *95(8), 1619-1624.*
  prefs: []
  type: TYPE_NORMAL
- en: Groseth, A., Feldmann, H., & Strong, J. E. (2007). The ecology of Ebola virus.
    *Trends in microbiology,* *15(9), 408-416.*
  prefs: []
  type: TYPE_NORMAL
- en: 'Guetiya Wadoum, R. E., Sevalie, S., Minutolo, A., Clarke, A., Russo, G., Colizzi,
    V., ... & Montesano, C. (2021). The 2018–2020 ebola outbreak in the Democratic
    Republic of Congo: A better response had been achieved through inter-state coordination
    in Africa. *Risk management and healthcare* *policy, 4923-4930.*'
  prefs: []
  type: TYPE_NORMAL
- en: 'Hanley, J. A., Negassa, A., Edwardes, M. D. D., & Forrester, J. E. (2003).
    Statistical analysis of correlated data using generalized estimating equations:
    an orientation. *American journal of epidemiology,* *157(4), 364-375.*'
  prefs: []
  type: TYPE_NORMAL
- en: 'Holmes, E. C., Dudas, G., Rambaut, A., & Andersen, K. G. (2016). The evolution
    of Ebola virus: Insights from the 2013–2016 epidemic. *Nature,* *538(7624), 193-200.*'
  prefs: []
  type: TYPE_NORMAL
- en: Jacob, S. T., Crozier, I., Fischer, W. A., Hewlett, A., Kraft, C. S., Vega,
    M. A. D. L., ... & Kuhn, J. H. (2020). Ebola virus disease. *Nature reviews Disease
    primers,* *6(1), 13.*
  prefs: []
  type: TYPE_NORMAL
- en: Liang, K. Y., & Zeger, S. L. (1986). Longitudinal data analysis using generalized
    linear models. *Biometrika,* *73(1), 13-22.*
  prefs: []
  type: TYPE_NORMAL
- en: McKinney, W., Perktold, J., & Seabold, S. (2011). Time Series Analysis in Python
    with statsmodels. *Jarrodmillman* *Com, 96-102.*
  prefs: []
  type: TYPE_NORMAL
- en: 'Nelder, J. A., & Wedderburn, R. W. (1972). Generalized linear models. *Journal
    of the Royal Statistical Society Series A: Statistics in Society,* *135(3), 370-384.*'
  prefs: []
  type: TYPE_NORMAL
- en: Vossler, H., Akilimali, P., Pan, Y., KhudaBukhsh, W. R., Kenah, E., & Rempała,
    G. A. (2022). Analysis of individual-level data from 2018–2020 Ebola outbreak
    in Democratic Republic of the Congo. *Scientific Reports,* *12(1), 5534.*
  prefs: []
  type: TYPE_NORMAL
- en: WHO Ebola Response Team. (2014). Ebola virus disease in West Africa—the first
    9 months of the epidemic and forward projections. *New England Journal of Medicine,*
    *371(16), 1481-1495.*
  prefs: []
  type: TYPE_NORMAL
