<html><head></head><body>
        

                            
                    <h1 class="header-title">Introducing Arcade</h1>
                
            
            
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Applying prebuilt Arcade expressions</li>
<li>Creating an Arcade labeling expression</li>
<li>Creating an Arcade symbology expression</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>Over the years, Esri products have supported many different expression and scripting languages. These have included AML, Avenue, JScript, VB Script, SQL, and Python. Some of these languages were developed by Esri, such as AML and Avenue, while others were common IT industry languages, such as JScript, VB Script, Python, and SQL. Each of these were suited to specific uses on the desktop, servers, or online. However, now we find ourselves regularly having to work in all these environments at the same time. We create a map in ArcGIS Pro on our desktop, then publish to ArcGIS Enterprise, and later access it through the web on a mobile device.</p>
<p>This has begun to cause a problem as we work through these environments. Sometimes things we create that work great on the desktop do not translate to server or internet environments. This is often true for labels and symbology. So, to help bridge that gap, Esri has developed what they are calling a new expression language, Arcade.</p>
<p>Arcade is a lightweight and portable language that can be used across the ArcGIS platform. This means expressions you create in ArcGIS Pro will also work in ArcGIS Server, Portal, and ArcGIS Online. It can be used to control and display labels, perform mathematical calculations, manipulate symbology, and more. What makes Arcade unique is its inclusion of geometry types.</p>
<p>It was created from the beginning with that in mind, unlike other languages such as Python, which had to be customized to work with geometry.   </p>
<p>What is the difference between an expression language and other programming or scripting languages? The primary difference is that an expression language cannot be used to create standalone apps or add-ins. It must be used inside of another application such as ArcGIS Pro. So Arcade is not as flexible as a scripting language like Python. Having said that, the expressions you can create with Arcade can be very complex, including multiple lines of code. For this reason, you may see Arcade expressions also referred to as scripts.</p>
<p>The syntax for Arcade is similar to other scripting languages such as Python or VB Script. For example, to indicate a text string, you simply enclose the desired string in single quotes. So, if you were creating an Arcade labeling expression and were to include <kbd>Lot Number</kbd> in the expression, those words would display as part of the label, as illustrated in the following screenshot:</p>
<div><img class="alignnone size-full wp-image-984 image-border" height="620" src="img/a6dc3948-5a76-49c8-9b3e-71b02e8b61e9.png" width="1134"/></div>
<p>Sample of an Arcade expression for labeling a parcel with lot number</p>
<p>If you have ever created any labeling expressions in ArcGIS Pro or even in ArcMap, then the syntax shown in the graphic should look somewhat familiar. It is not that much different from Python or VB Script expressions. So, if you are already familiar with those, you should be able to pick up Arcade fairly quickly. </p>
<p>A few things you should know about Arcade syntax: first, it is not case sensitive, unlike Python. So a variable named Parcel is the same as parcel. To comment within your code, you can use either <kbd>//</kbd> for single-line comments or <kbd>/* */</kbd> for multiple-line comments.</p>
<p>The following is an example of a single-line comment:</p>
<pre>//Labels parcels with lot number<br/>'Lot Number: '+$feature.LOTNUM</pre>
<p>The following is an example of multiple-line comments:</p>
<pre>/*<br/>This expression was built using Arcade.<br/>It is intended for use with ArcGIS Pro 2.1 and ArcGIS Enterprise 10.5 or later versions.<br/>*/<br/>Proper($feature.NAME, 'firstword')</pre>
<p>Lastly, variables may be declared within Arcade expressions and reassigned with new values, as illustrated in the following code block:</p>
<pre>var x = 1;<br/>return x;<br/>//This will return a value of 1 for the variable x<br/>x = 5;<br/>return x;<br/>//This will return a value of 5 for the variable x.</pre>
<p>Arcade is still very new. It first came out with the release of ArcGIS 10.5 and ArcGIS Pro 1.4. With each new release of ArcGIS and ArcGIS Pro, Esri increases the capabilities of Arcade. This means you can expect to do more and more with this new expression language as time goes on. If you would like to take a deeper dive into Arcade, you may want to go to <a href="https://developers.arcgis.com/arcade/">https://developers.arcgis.com/arcade/</a>. This is Esri's primary resource for information about Arcade.</p>
<p>In this chapter, you will be introduced to Arcade and how it works in ArcGIS Pro. You will start by exploring existing expressions  and learn how you can apply them in your projects. Then you will begin creating your own Arcade expressions. You will start by creating a labeling expression. Then you will learn how to create symbology expressions.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Applying prebuilt Arcade expressions</h1>
                
            
            
                
<p>One of the nice things about creating Arcade expressions is that you can save them so that they can be used in other maps or scenes, or even with other layers in the same map. These expression files have a <kbd>.lxp</kbd> file extension. This also allows you to easily share expressions with others, so you do not have to reinvent the wheel every time you need to make use of an Arcade expression.</p>
<p>In this recipe, you will examine and apply a couple of existing Arcade expressions to layers within a map. You will start with a labeling expression that labels parcels with their <strong>parcel identification number</strong> (<strong>PIN</strong>) and the mapped acreage. Then you will examine another one that controls the visibility of a layer.  </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe will require you to access an ArcGIS Pro license and have the sample data installed. This recipe is able to be completed at all ArcGIS Pro license levels. You will also need a web browser that supports HTML 5 and JavaScript. This includes current versions of Chrome, Edge, Firefox, and Safari. Internet Explorer 11 or newer is also acceptable. Other browsers may also work but have not been tested by Esri.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>You will start by launching ArcGIS Pro and opening the Arcade project located in <kbd>C:\Student\ArcGISProCookbook\Chapter11\Arcade</kbd> using skills you have learned in previous recipes. The project should open with a map of the City of Thomaston, zoomed in to an area near the city center, as illustrated in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-985 image-border" height="886" src="img/1917f585-6e3b-42d7-a89e-8f3f53a48d18.png" width="1632"/></div>
<p>City of Thomasville map</p>
<ol start="2">
<li>In the Contents pane, select the Parcels layer so the Feature Layer contextual menu appears in the ribbon.</li>
<li>You will notice that none of the parcels in the map are labeled, so you need to turn on labeling for the layer. Click on the Labeling tab in the ribbon.</li>
<li>Click on the Label button located in the Layer group on the Labeling tab. This will turn on the labels for the parcels, as shown in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-986 image-border" height="881" src="img/16f9dff4-2cfc-443f-be55-533702b76499.png" width="1387"/></div>
<p style="padding-left: 60px">Now you can see that each parcel contains a label that identifies one attribute associated with each parcel. If you look at the setting for the Field in the Label Class group in the Label tab, you will see it is displaying the values found in the PIN field. This is the tax parcel identification number. What you want to do is label each parcel with not only its PIN but also with its mapped acreage. Luckily, someone has already created an expression file that will do just that.</p>
<div><p>You can also right-click on a layer in the Contents pane and select Label from the menu to turn labeling on and off for a specific layer.</p>
</div>
<ol start="5">
<li>In the Labeling tab, click on the Expression button located to the right of the Field option in the Label Class group, as illustrated in the following screenshot. This will open the Label Class pane where you create labeling expressions:</li>
</ol>
<div><img class="alignnone size-full wp-image-987 image-border" height="97" src="img/186bd37b-8f17-414e-84b5-75fe6f7119db.png" width="351"/></div>
<ol start="6">
<li>In the Label Class pane, set the Language to Arcade using the drop-down arrow.</li>
<li>Look at the labeling expression now. It should read $feature.PIN.</li>
</ol>
<div><p>$feature is one of two global variables used by Arcade. It allows you to access or call information associated with the features in the target layer. In this example, it is letting you access the PIN field in the attribute table. You can also use it to access geometry information such as area, length, and coordinates.</p>
</div>
<ol start="8">
<li>Below the Expression area, click on the Import button, which resembles a file folder. This will open the Import window.</li>
<li>In the Import window, navigate to <kbd>C:\Student\ArcGISProCookbook\Chapter11</kbd> and select Label Parcels with PIN and Acres.lxp. Then click OK. This will import the expression into the Expression area in the Label Class pane. Now your Label Class pane should look similar to the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-988 image-border" height="466" src="img/46de96a0-cc76-4ff7-a827-aa5227ee9e1e.png" width="506"/></div>
<p style="padding-left: 60px">Now that you have imported the expression into the Label Class pane, let’s take a look at it. This expression is set up to do a lot, as shown in the following:</p>
<div><img class="alignnone size-full wp-image-989 image-border" height="190" src="img/dea7b81d-8ef8-40a4-a8ae-d2754161abb0.png" width="542"/></div>
<p style="padding-left: 60px">The expression starts with a text string, which will be displayed in the label. This is identified by the use of the single quotes enclosing the text string. That is followed by a +, which acts as a connector to the next part of the expression. The expression then retrieves the value for each parcel found in the PIN field of the layers attribute table. That value is then displayed after the Parcel No: text string from the first part of the expression. This is then followed by the TextFormatting variable, which creates a new line so that the following parts of the expression are displayed in another line. After that, the expression displays another text string, Acreage. Lastly, the expression retrieves the values for each parcel found in the Map_AC field of the attribute table. However, it does not just display the exact value. This expression takes it a step forward and rounds the values to two decimal places. It does this by invoking the round mathematical function and limiting it to two decimal places. The two decimal place limit is applied using the value after the field name.</p>
<p style="padding-left: 60px">Now that you know how this expression is supposed to work, let’s apply it and then compare the results we see in this map to the explanation just provided.</p>
<ol start="10">
<li>Click on the Apply button at the bottom of the Label Class pane to apply the expression you just imported.</li>
<li>Notice how the labels in the map change and answer the question ahead:</li>
</ol>
<div><p><strong>Question:</strong> Did the labels change so that they now match the description of how the expression is supposed to work?</p>
<p><strong>Answer:</strong></p>
</div>
<p style="padding-left: 60px">If your map looks like the following screenshot, then yes, the expression performed exactly as described:</p>
<div><img class="alignnone size-full wp-image-990 image-border" height="364" src="img/d038af0b-a63a-489c-b2c8-311dd934ecc0.png" width="517"/></div>
<p>Results of labeling expression being applied</p>
<p style="padding-left: 60px">To a new user, this expression may seem complicated. However, it is a fairly simple one. These expressions can be much more complex, as you will find out next.</p>
<ol start="12">
<li>Close the Label Class pane and save your project.</li>
<li>Select the Streets layer in the Contents pane. Turn on the labels for this layer using skills you have learned earlier in this recipe. If you cannot remember, refer to <em>step 4</em>. The street names should appear in the map.</li>
</ol>
<p style="padding-left: 60px">Since you are working for the City, you want to make it possible to easily identify streets belonging to the City. To do this, your City streets need to be labeled in red and appear in a bold font. One of your co-workers has created an Arcade expression that will do that.</p>
<ol start="14">
<li>Click on the Expression button in the Label Class group on the Labeling tab, as you did previously in this recipe. This will open the Label Class pane.</li>
<li>In the Label Class pane, ensure the Language is set to Arcade. Then click on the Import button located near the bottom of the pane. You may remember that its icon resembles a file folder.</li>
<li>In the Import window that opens, navigate to <kbd>C:\Student\ArcGISProCookbook\Chapter11</kbd> using the skills you have learned and select the City Streets Labels Red.lxp file. Then click OK. You should now see the following expression appear in the Label Class pane:</li>
</ol>
<pre style="padding-left: 60px">var type=($feature.FEATURE_TY)<br/>if (type == "City Street"){<br/>return "&lt;BOL&gt;&lt;CLR red='255'&gt;"+$feature.ROAD_NAME+"&lt;/CLR&gt;&lt;/BOL&gt;"<br/>} else {<br/>return $feature.ROAD_NAME<br/>}</pre>
<ol start="17">
<li>Click the Apply button to apply the expression logic to the labels. Look at how the labels change. Some of the street names now appear in a bold red font. Those are the streets that belong to the City.</li>
</ol>
<p style="padding-left: 60px">Let's take a moment to examine how the expression accomplishes this. As you read this explanation, refer to the following diagram to help you better understand what is happening. It starts by defining a variable on the first line, which reads the road type from the Feature_TY field in the layer attribute table:</p>
<div><img class="alignnone size-full wp-image-991 image-border" height="106" src="img/e5aa98a5-0638-4857-a9f5-3b60d8390da1.png" width="342"/></div>
<p style="padding-left: 60px">Once the variable is defined, the expression moves into a logic block that evaluates the value from the variable. It does this using an <kbd>if</kbd> statement. If the variable value for the feature is equal to City Street, then it returns a label for the feature from the Road_Name field in the attribute table, in bold red text. Otherwise, it just labels it with the value in the Road_Name field normally. The end result is a map with labels that look like those in the following screenshot:</p>
<div><img class="alignnone size-full wp-image-992 image-border" height="630" src="img/020636dd-ddd0-4112-bd62-a2cac562bde5.png" width="1068"/></div>
<p>Results of labeling expression using if statements</p>
<p style="padding-left: 60px">As you can see, some road names appear in red and bold while others are black and normal. Those that are red and bold belong to the City.</p>
<ol start="18">
<li>Close the Label Class pane and save your project.</li>
<li>Close ArcGIS Pro.</li>
</ol>
<p>You have now explored two Arcade expressions, so hopefully you are beginning to get some idea of how it works and what you can do with it. The first expression you used was fairly simple but still powerful. It labeled the parcels in the City of Thomaston with a PIN and the acreage on two different lines. The second expression you used included logic that controlled how features would be labeled. This is a much more complex expression. This is just the tip of the iceberg.</p>
<p>As you will learn later in this chapter, Arcade not only works with labels but can also be used to control symbology. This further increases the value of Arcade.  </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating an Arcade labeling expression</h1>
                
            
            
                
<p>You have now had the opportunity to explore a couple of Arcade expressions. This has given you a chance to begin learning Arcade’s syntax as well as some of the things you can do with these expressions. Now it is time for you to start building your own.  </p>
<p>In this recipe, you will create an Arcade expression that will label the streets in Trippville with their name. This will require you to concatenate two separate fields that make up the full street name.     </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>To complete this recipe, you need to have completed the previous recipe in this chapter as well as all those in <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>. This will ensure you have the knowledge and skills needed to complete this recipe.</p>
<p>This recipe can be completed with any ArcGIS Pro license level and no extensions are required. You will need to ensure you have installed the sample data before you begin.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>To start, you will need to launch ArcGIS Pro and open the Arcade project you used in the previous recipe. This project should appear in your list of recently opened projects.</li>
</ol>
<ol start="2">
<li>When the project opens, you should see the map of the City of Thomaston you were working with in the previous recipe. Close that map by clicking on the small X located in the tab at the top of the map view. This will reduce the computer's resources being used by ArcGIS Pro since you will not be working with that map in this recipe.</li>
<li>In the Catalog pane, right-click on the City of Trippville map and select Open from the menu that appears. This will open the map you will be using for this recipe. The map should look similar to the screenshot that follows. If not, use the Trippville Labeling Streets bookmark to zoom to this area:</li>
</ol>
<div><img class="alignnone size-full wp-image-993 image-border" height="871" src="img/de3e23a9-9199-419a-939c-cfc7e90c3061.png" width="1626"/></div>
<p>The newly opened Trippville map</p>
<p style="padding-left: 60px">Notice the streets already appear to be labeled with names. However, if you look closely, you should notice the names are not complete. They are missing the street type, such as road, avenue, or court. Let's see if you can figure out why that is happening.</p>
<ol start="4">
<li>Select the Streets layer in the Contents pane. Then click on the Labeling tab that appears in the ribbon.</li>
</ol>
<ol start="5">
<li>Look at the value assigned to the Field option in the Label Class group and answer the questions:</li>
</ol>
<div><p><strong>Question</strong>: What field is being used to label the Streets layer?</p>
<p><strong>Answer</strong>:</p>
<p><strong>Question</strong>: Is this a single field or an expression?</p>
<p><strong>Answer</strong>:</p>
</div>
<p style="padding-left: 60px">As you can see, the Streets layer is only using the NAME field to label the streets in the map with their name. While this single field would appear to contain the data needed to label the streets with their name, based on what you are seeing in the map, it is not the complete name. You need to examine the attribute table next to determine if there is another field that contains the street type information.</p>
<ol start="6">
<li>Right-click on the Streets layer in the Contents pane. Then select Attribute Table from the menu that appears. This will open the Attribute Table for the Streets layer, so you can examine it.</li>
<li>Locate the NAME field in the table. Then examine the values it contains.</li>
<li>Next, examine the other fields and see if you can determine one that contains the street type. Then answer the questions:</li>
</ol>
<div><p><strong>Question</strong>: Is there a field in the Attribute Table that is used to store the street type?</p>
<p><strong>Answer</strong>:</p>
<p><strong>Question</strong>: If so, what is it?</p>
<p><strong>Answer</strong>:</p>
</div>
<p style="padding-left: 60px">After examining the table, you should have determined that the TYPE field is used to store the street type. It is not abnormal for the road name information to be broken down into separate fields. This is often true of the centerline data used as a geocoding source for E911/Emergency Response, address assignment, or general address location.</p>
<p style="padding-left: 60px">Now you know that in order to label each street with its full name, you will need to pull values from two separate fields. With that knowledge you can now create your expression.</p>
<ol start="9">
<li>Close the Attribute Table for the Streets layer. This will free up some screen real estate, so you can see more of the map.</li>
<li>If necessary, select the Streets layer in the Contents pane and click on the Labeling tab in the ribbon.</li>
<li>Click on the Expression button located next to the Field value in the Label Class group on the Label tab. This will open the Label Class pane, so you can build your expression.</li>
<li>In the Label Class pane, ensure your Language is set to Arcade using the drop-down arrow.</li>
<li>In the Expression area, you should already see the expression that is being used to label the streets based on values in the NAME field.</li>
<li>In the Expression area, add the following:</li>
</ol>
<pre style="padding-left: 60px">$feature.NAME+$feature.TYPE</pre>
<ol start="15">
<li>Once you have completed the expression, click on the Verify button at the bottom right-hand side of the Expression area. It looks like a green check mark.</li>
<li>Once you validate your expression, it should say the Expression is valid in green lettering below the Expression area. Now click the Apply button to see how the expression you created labels the streets.</li>
</ol>
<p style="padding-left: 60px">The expression you created is now indeed labeling the streets with both the name and type. However, if you look closely you will see that the two values are running together, as illustrated in the following diagram:</p>
<div><img class="alignnone size-full wp-image-994 image-border" height="196" src="img/67566028-1c9a-410d-afd9-5ed3dfa1cb04.png" width="317"/></div>
<p style="padding-left: 60px">The space between the values is missing so that they are running together. You need to adjust your expression so that it adds the space between the two values.</p>
<ol start="17">
<li>Return your attention to the Label Class pane and your expression. To add a space between the values in the two fields, you will need to add a string representing the space. Click in the expression just after the <kbd>+</kbd> and type the following: <kbd>“ “+</kbd>. There should be a space between the quotation marks. Your expression should now be:</li>
</ol>
<pre style="padding-left: 60px">$feature.NAME+" "+$feature.TYPE</pre>
<ol start="18">
<li>Validate your expression once again. If it is valid, click the Apply button to see the results of your revised expression.</li>
</ol>
<div><p>Arcade supports the use of several operators within its expressions. The operators perform basic logic functions in the expressions you create. Some of the common operators include:</p>
<ul>
<li><kbd>+</kbd>: The plus sign adds two numbers together or concatenates two fields or strings</li>
<li><kbd>-</kbd>: This subtraction or minus sign subtracts one number from another</li>
<li><kbd>==</kbd>: The double equals sign is the proper syntax for equals</li>
<li><kbd>!=</kbd>: The exclamation point with the equals sign means not equal to</li>
<li><kbd>++</kbd>: The double plus signs increment values by one</li>
<li><kbd>--</kbd>: The double minus signs decrements the values by one</li>
</ul>
<p>These are just a few of the operators you can use in Arcade. Go to <a href="https://developers.arcgis.com/arcade/guide/logic/">https://developers.arcgis.com/arcade/guide/logic/</a> to see a complete list.</p>
</div>
<p style="padding-left: 60px">You should now see that a space exists between the name and the type, as illustrated in the following diagram:</p>
<div><img class="alignnone size-full wp-image-995 image-border" height="221" src="img/24211457-fea0-40a6-90ed-60d996798e29.png" width="358"/></div>
<p style="padding-left: 60px">Congratulations on creating an Arcade expression! This is a very simple expression that concatenates the values in two fields together along with a string to create a single label. Let's take this to the next level and write another expression, which will change the color of the label based on the condition of the street. If you remember when you examined the attribute table for the Streets layer, there was a field that identified the condition of the road as either good, fair, or poor.</p>
<p style="padding-left: 60px">So, let's write a new expression, which will apply a green label to those streets in good condition, a black label to those in fair condition, and a red bold label to those in poor condition. You will start by defining two variables in your expression; one for the street name, which will use the expression you just created, and another for the condition.</p>
<ol start="19">
<li>Save your project before continuing.</li>
<li>In the Label Class pane, you will define a variable called <kbd>name</kbd>, which will use the expression you just created. In the Expression area, update your expression so it now reads:</li>
</ol>
<pre style="padding-left: 60px">var name=($feature.NAME +” “+$feature.TYPE)</pre>
<ol start="21">
<li>Press the <em>Enter</em> key to start a new code line. Then define another variable which refers to the street condition in the Condition field. Type the following on the new code line you started:</li>
</ol>
<pre style="padding-left: 60px">var cond=($feature.Condition)</pre>
<p style="padding-left: 60px">Your Label Class pane should now look like the following:</p>
<div><img class="alignnone size-full wp-image-996 image-border" height="478" src="img/05ed179d-f6c0-4596-bd17-2ae29317bb19.png" width="498"/></div>
<p style="padding-left: 60px">You have defined two variables in your expression now, name and cond. This allows you to use the variable in place of the full value the variable represents. This makes it easier for you to type and avoid syntax errors. Now it is time to add the logic that will evaluate the condition of each street and label it accordingly. You will use an <kbd>if</kbd> statement to do this, as you saw in the last expression you used in the previous recipe.</p>
<ol start="22">
<li>
<p>Return to the expression area within the Label Class pane and add the following code to your expression:</p>
</li>
</ol>
<pre style="padding-left: 60px">if (cond=="Good")<br/>  {<br/>  return "&lt;CLR green='255'&gt;"+name+"&lt;/CLR&gt;"<br/>  }<br/>if (cond=="Fair")<br/>  {<br/>  return name<br/>  }<br/>else<br/>  {<br/>  return "&lt;BOL&gt;&lt;CLR red='255'&gt;"+name+"&lt;/CLR&gt;&lt;/BOL&gt;"<br/>  }</pre>
<ol start="23">
<li>
<p>Once you have finished typing the additional code into the expression, click the Validate button to ensure your syntax is correct.</p>
</li>
</ol>
<p>As you type in each new line, you can use the Validate button to verify your syntax. The most common errors are missing quotation marks or brackets. Also, make sure to use double equals. If you have trouble writing the code, you can import the Trippville Street Name Labels with the Logic Results.lxp file located in <kbd>C:\Student\ArcGISProCookbook\Chapter11</kbd>.</p>
<ol start="24">
<li>
<p>If your expression is valid, click on the Apply button so you can see the results of your new expanded expression.</p>
</li>
</ol>
<p style="padding-left: 60px">Once you apply your expression, you should see the labels in your map are now displayed in three colors—green, black, and red—as shown in the following screenshot:</p>
<div><img class="alignnone size-full wp-image-997 image-border" height="421" src="img/6ddc826c-47a0-4038-a5ca-9957092b9414.png" width="554"/></div>
<p style="padding-left: 60px">This proves your expression is working. It is evaluating each street segment and displaying a label based on its condition and the parameters you defined for the label based on that condition.</p>
<ol start="25">
<li>
<p>Close the Label Class pane and save your project.</p>
</li>
<li>
<p>Close ArcGIS Pro.</p>
</li>
</ol>
<p>You have now created two Arcade expressions for labeling streets with their names. The first expression you created was fairly basic. You concatenated two fields and added a space between the values to create a single label which displayed the full name of the streets. This is a very common use of an Arcade expression.</p>
<p>The second expression you created was much more complex. It included logic that determined how each label would appear in the map. Using <kbd>if</kbd> statements, your expression looked at the condition of each road segment and evaluated its condition, which was either good, fair, or poor. Based on that condition, it then rendered a label accordingly. The streets in good condition were labeled with green text. Those in fair condition were labeled with a black font. Lastly, those that were in bad condition were labeled with a bold red font.  </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating an Arcade symbology expressions</h1>
                
            
            
                
<p>Arcade is not limited to use in labeling. You can also use it to control symbology. You may be thinking: why would you want to do that? ArcGIS Pro already has the ability to symbolize layers based on one or more fields of information, so that is a good question.</p>
<p>Arcade allows you to specify symbology based on values that do not exist in your database. It allows you to create symbology based on equations or functions. For example, you could have roads that have traffic count data and maximum designed traffic loads, but you want to symbolize the layers based on the current capacity—is it below, at, or over? There is no field identifying capacity. However, it can be determined by dividing the current traffic count by the design loads and multiplying by 100 to get the capacity percentage. Anything below 100 would be below capacity, anything at 100 would be at capacity, and anything above 100 would be over. Arcade allows you to build an expression that will do this. The best thing is that as the values change in the current traffic count or design traffic load data, the symbology is automatically updated and you only have two fields to maintain, not three or more.</p>
<p>In this recipe, you will symbolize the Census Block Groups for the Trippville area as either low, medium, or high population density.  The density field does not exist, so you will use an Arcade expression to determine these values and then symbolize the Block Groups accordingly. This will require you to use logic expressions similar to those you used in the last recipe.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>As with the previous recipe, you need to have completed all the previous recipes in this chapter and those in <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>. This will ensure you have the required knowledge and skills needed to complete this one. You will also need to have ArcGIS Pro installed and access to a license. This recipe can be completed with any license level of ArcGIS Pro. The sample data also needs to be installed.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>You will start this recipe by launching ArcGIS Pro and opening the Arcade project you worked with in the previous recipe. This project is located in <kbd>C:\Student\ArcGISProCookbook\Chapter11\Arcade</kbd>. The project should appear in your recently opened projects if you have been working through the entire chapter.</li>
<li>The project should open with the City of Trippville map shown in the view area. Close this map because you will be working with another one for this recipe.</li>
<li>In the Catalog pane, expand the Maps folder and right-click on the Trippville Census Data map. Select Open from the menu that appears. The new map should be displayed in the view area. It should contain four layers: City Limits, Railroads, Parcels, and Census Blocks.</li>
<li>In the Contents pane, select the Census Blocks from the list of layers. Then click on the Appearance tab in the ribbon.</li>
<li>Click on the drop-down arrow located below the Symbology button in the Drawing group on the Appearance tab. Select Unique Values from the list presented. This will open the Symbology pane.</li>
</ol>
<ol start="6">
<li>In the Symbology pane, click on the set an expression button located to the right of the Field parameter, as illustrated in the following screenshot. This will open the Expression Builder pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-998 image-border" height="432" src="img/4580d7e0-9ac1-40ce-b037-6c00d23c4666.png" width="520"/></div>
<p style="padding-left: 60px">The Expression Builder pane should look very similar to the one you used to create labels. However, unlike labels, symbology only supports the Arcade language. This pane is divided into three basic sections or areas, as shown in the following screenshot:</p>
<div><img class="alignnone size-full wp-image-999 image-border" height="383" src="img/2dee6fd7-5853-4d83-8e70-6dccb05b02c4.png" width="464"/></div>
<p>You can resize this pane to make it easier to work in. Move your mouse pointer to the edges of the pane. When your pointer becomes a double-headed arrow, you can then drag that edge of the pane in or out as desired.</p>
<p style="padding-left: 60px">The top area is the Title and Language area. Since Arcade is currently the only supported language, you do not need to worry about setting this option. The title is a name you give your expression. The fields and functions area allows you to pick fields and functions from the lists to add to your expression. This can help eliminate syntax errors. The bottom area is the Expression area where you build your expression as well as reset, validate, import, and export your expression. So let's start writing your expression.</p>
<ol start="7">
<li>
<p>At the top of the Expression Builder pane in the Language and Title Area, title your expression Population Density.</p>
</li>
<li>
<p>Now move to the Expression area in the pane to begin writing your expression. You will start by defining a variable that will calculate the population density. First delete the existing expression. Then type the following in its place:</p>
</li>
</ol>
<pre style="padding-left: 60px">var popden=($feature.POPULATION/$feature.SQMI);</pre>
<p style="padding-left: 60px">This variable calculates the population density by dividing the total population of the Census block by its area in square miles. This will generate the population per square mile. Now you need to create the logic which will evaluate the value calculated by the variable to determine if the density is low, medium, or high. You will do this with an <kbd>if</kbd>/<kbd>else</kbd> statement.</p>
<ol start="9">
<li>
<p>Continue building your expression by adding the following code:</p>
</li>
</ol>
<pre style="padding-left: 60px">if (popden&lt;=1335)<br/>  {<br/>  return "Low Density";<br/>  }<br/>else if (popden&gt;1335&amp;&amp;popden&lt;=1955)<br/>  {<br/>  return "Medium Density";<br/>  }<br/>else<br/>  {<br/>  return "High Density";<br/>  }</pre>
<p style="padding-left: 60px">The first line of your <kbd>if</kbd> statement evaluates whether the variable is less than or equal to <kbd>1335</kbd>. If it is, then it returns a value of Low Density. If the variable value does not meet that criteria, it moves to the <kbd>else if</kbd> line. The <kbd>else if</kbd> line evaluates the variable to see if it is greater than <kbd>1335</kbd> or less than or equal to <kbd>1955</kbd>. The double <kbd>&amp;&amp;</kbd> signs in the expression act as the word <em>and</em>. So, the variable values must meet both operations. If the variable value does, then the expression returns <kbd>Medium Density</kbd>. Lastly, if the variable value does not meet any of the requirements in the <kbd>if</kbd> and <kbd>else if</kbd> lines, the expression returns <kbd>High Density</kbd>.</p>
<ol start="10">
<li>
<p>Verify you have not made any syntax errors by validating your expression. Click on the Validate button at the bottom of the expression area to do this. This button looks like a green check mark.</p>
</li>
<li>
<p>If your expression is valid, click the OK button. This will apply your expression and change the symbology for the layer. The Census Block layer should now display with the three categories you defined in your expression—Low, Medium, and High Density, as illustrated:</p>
</li>
</ol>
<div><img class="alignnone size-full wp-image-1000 image-border" height="876" src="img/74bca285-815a-4cb1-a1df-cb19943a944e.png" width="1625"/></div>
<p>Results of Arcade symbology expression</p>
<p style="padding-left: 60px">The colors and scale of your map may be different, but the overall effect should be the same. You should see the three categories now shown in the Contents pane along with all other values. From this point you can make adjustments to the symbology as you would with any other layer. You can change the fill colors and patterns, change the order the values appear in within the list, and more. If you want to learn more about controlling symbology in ArcGIS Pro, we suggest you check out <em>Learning ArcGIS Pro</em> from Packt Publishing.</p>
<ol start="12">
<li>
<p>Feel free to make any adjustments you wish to the symbology assigned to the three values. Once you are done, close the Symbology pane.</p>
</li>
<li>
<p>Save your project and close ArcGIS Pro.</p>
</li>
</ol>
<p>You have now created your first symbology expression using Arcade. As you have seen, a symbology expression is the same syntax-wise as a labeling expression, the difference being in how the results of the expression are displayed. With a symbology expression, the results change how the features within the layer appear in the map. With a labeling expression, the results are displayed as text within the map. The true power of these expressions is that they provide you with the ability to display different characteristics of your data by combining data, performing mathematical functions, and more. So you are not just limited to the exact data values.</p>
<p>Esri continues to expand the capabilities of the Arcade language with each new release of ArcGIS Pro. You have only touched the tip of the iceberg in terms of how you can use this expression language. Remember, it is supported not only in ArcGIS Pro but also in ArcGIS Online, ArcGIS Enterprise, and Esri SDKs and APIs.</p>


            

            
        
    </body></html>