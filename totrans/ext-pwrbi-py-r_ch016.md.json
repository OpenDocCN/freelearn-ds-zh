["```py\ncircular_grouped_barplot(data = speakers_tbl,\n                         grp_col_name = 'Characteristics',\n                         label_col_name = 'SpeakerName',\n                         value_col_name = 'Value')\n```", "```py\nspeakers_tbl %>% \n  circular_grouped_barplot(grp_col_name = Characteristics,\n                           label_col_name = SpeakerName,\n                           value_col_name = Value)\n```", "```py\n    grp_var <- enquo(grp_col_name)\n    label_var <- enquo(label_col_name)\n    value_var <- enquo(value_col_name)\n    ```", "```py\n    data <- data %>% \n      mutate( \n        !!quo_name(grp_var) := as.factor(!!grp_var),\n        !!quo_name(label_var) := as.factor(!!label_var),\n        !!quo_name(value_var) := rescale100(!!value_var) )\n    ```", "```py\n    empty_bars <- 3\n    # Create the empty dataframe to add to the source dataframe\n    data_to_add <- data.frame(matrix(NA, empty_bars * nlevels(data[[quo_name(grp_var)]]), ncol(data)) )\n    colnames(data_to_add) <- colnames(data)\n    data_to_add[[quo_name(grp_var)]] <- rep(levels(data[[quo_name(grp_var)]]), each = empty_bars)\n    ```", "```py\n    data <- rbind(data, data_to_add)\n    # Reorder data by groups and values\n    data <- data %>% arrange(!!grp_var, !!value_var)\n    ```", "```py\n    data$id <- seq(1, nrow(data))\n    ```", "```py\n    # Get the total number of bars\n    number_of_bars <- nrow(data)\n    # Subtract 0.5 from id because the label must have the angle of the center of the bars,\n    # Not extreme right(1) or extreme left (0)\n    angles_of_bars <- 90 - 360 * (data$id - 0.5) / number_of_bars\n    ```", "```py\n    label_data <- data\n    label_data$hjust <- ifelse( angles_of_bars < -90, 1, 0)\n    label_data$angle <- ifelse( angles_of_bars < -90, angles_of_bars + 180, angles_of_bars)\n    ```", "```py\n    base_data <- data %>% \n      group_by(!!grp_var) %>% \n      summarize(start = min(id),\n                end = max(id) - empty_bars) %>% \n      rowwise() %>% \n      mutate(title = floor(mean(c(start, end)))) %>% \n      inner_join( label_data %>% select(id, angle),\n                  by = c('title' = 'id')) %>% \n      mutate( angle = ifelse( (angle > 0 & angle <= 90) |\n                             (angle > 180 & angle <= 270),\n                              angle-90, angle+90 ) )\n    ```", "```py\n    p <- data %>%\n      ggplot(aes_string(x = 'id', y = quo_name(value_var), fill = quo_name(grp_var))) +\n      # Add a barplot\n      geom_bar(stat = 'identity', alpha=0.5) +\n      # Add 100/75/50/25 indicators\n      geom_segment(data = grid_data,\n          aes(x = end, y = 100, xend = start, yend = 100),\n          colour = 'grey', alpha=1, size=0.3 ,\n          inherit.aes = FALSE ) +\n      geom_segment(data = grid_data,\n          aes(x = end, y = 80, xend = start, yend = 80),\n          colour = 'grey', alpha=1, size=0.3 ,\n          inherit.aes = FALSE ) +\n      geom_segment(data = grid_data,\n          aes(x = end, y = 60, xend = start, yend = 60),\n          colour = 'grey', alpha=1, size=0.3 ,\n          inherit.aes = FALSE ) +\n      geom_segment(data = grid_data,\n          aes(x = end, y = 40, xend = start, yend = 40),\n          colour = 'grey', alpha=1, size=0.3 ,\n          inherit.aes = FALSE ) +\n      geom_segment(data = grid_data,\n          aes(x = end, y = 20, xend = start, yend = 20),\n          colour = 'grey', alpha=1, size=0.3 ,\n          inherit.aes = FALSE ) +\n      # Add text showing the value of each 100/75/50/25 lines\n      annotate('text', x = rep(max(data$id), 5),\n               y = c(20, 40, 60, 80, 100),\n               label = c('20', '40', '60', '80', 100) ,\n               color='grey', size=3,\n               angle=0, fontface='bold', hjust=1)\n    ```", "```py\n    p <- p +\n      # The space between the x-axis and the lower edge of the figure will implicitly define the width of the empty circle inside the plot \n      ylim(-120,120) +\n      theme_minimal() +\n      theme(\n        legend.position = 'none',\n        axis.text = element_blank(),\n        axis.title = element_blank(),\n        panel.grid = element_blank(),\n        plot.margin = unit(rep(-1,4), 'cm') \n      ) +\n      # Wrap all in a circle!\n      coord_polar()\n    ```", "```py\n    p <- p +\n      # Add labels\n      geom_text(data = label_data %>% mutate( y_pos = !!value_var + 10),\n          aes_string(x = 'id', y = 'y_pos',\n                     label = quo_name(label_var),\n                     hjust = 'hjust'),\n          color = 'black', fontface = 'bold',\n          alpha = 0.6, size = 3,\n          angle = label_data$angle,\n          inherit.aes = FALSE) +\n\n      # Add base lines of groups\n      geom_segment(data = base_data,\n          aes(x = start, y = -5, xend = end, yend = -5),\n          colour = 'black', alpha=0.8,\n          size=0.6 , inherit.aes = FALSE ) +\n\n      # Add groups text\n      geom_text(data = base_data %>% mutate(y = -14),\n          aes_string(x = 'title', y = 'y',\n                     label=quo_name(grp_var),\n                     angle = 'angle'),\n          hjust = text_horiz_justification,\n          colour = 'black', alpha=0.8, size=4,\n          fontface='bold', inherit.aes = FALSE)\n    ```"]