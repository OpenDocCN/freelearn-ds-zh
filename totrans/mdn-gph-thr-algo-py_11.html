<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-88"><a id="_idTextAnchor088" class="pcalibre calibre6 pcalibre1"/>7</h1>
<h1 id="_idParaDest-89" class="calibre5"><a id="_idTextAnchor089" class="pcalibre calibre6 pcalibre1"/>Goods Prices/Sales Data</h1>
<p class="calibre3">In this chapter, we’ll combine spatial and temporal approaches to <strong class="bold">spatiotemporal data</strong>—data that includes both spatial components and time series components. To handle the time components, we’ll slice our datasets into overlapping time windows as we did with our stock data in <a href="B21087_06.xhtml#_idTextAnchor078" class="pcalibre calibre6 pcalibre1"><em class="italic">Chapter 6</em></a>. To handle the spatial components, we’ll calculate local Moran statistics based on correlations for each time slice and threshold the value to create a network for that time slice. Then, we’ll look at changes in <strong class="bold">Forman-Ricci curvature centrality</strong> and <strong class="bold">PageRank centrality</strong> across slices of time and space. Examples include the Burkina Faso millet dataset first seen in <a href="B21087_02.xhtml#_idTextAnchor028" class="pcalibre calibre6 pcalibre1"><em class="italic">Chapter 2</em></a> and a new store sales dataset.</p>
<p class="calibre3">By the end of this chapter, you’ll understand how to set up spatiotemporal data analytics with networks to capture changes over time within the spatial and temporal relationships of the datasets using <strong class="bold">igraph</strong> and different types of plots to look at spatial relationships within slices of time.</p>
<p class="calibre3">In particular, we will cover the following topics:</p>
<ul class="calibre10">
<li class="calibre11">An introduction to spatiotemporal data</li>
<li class="calibre11">Analyzing our spatiotemporal data</li>
</ul>
<h1 id="_idParaDest-90" class="calibre5"><a id="_idTextAnchor090" class="pcalibre calibre6 pcalibre1"/>Technical requirements</h1>
<p class="calibre3">You will require Jupyter Notebook to run the practical examples in this chapter. </p>
<p class="calibre3">The code for this chapter is available here: <a href="https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python" class="pcalibre calibre6 pcalibre1">https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python</a></p>
<h1 id="_idParaDest-91" class="calibre5"><a id="_idTextAnchor091" class="pcalibre calibre6 pcalibre1"/>An introduction to spatiotemporal data</h1>
<p class="calibre3">In <a href="B21087_02.xhtml#_idTextAnchor028" class="pcalibre calibre6 pcalibre1"><em class="italic">Chapter 2</em></a>, we discussed some aspects of spatial and temporal data that make such data difficult to wrangle, analyze, and scale with statistical and machine learning methods. Recall that both types of <a id="_idIndexMarker318" class="pcalibre calibre6 pcalibre1"/>data are not independent, with dependencies crossing either space or time in the dataset. Alternative approaches to prediction are needed, and representations of spatial and temporal data as a network allow analysts to leverage the tools of network science to find change points, mine for patterns, and even predict future system behavior in the case of temporal data. In the previous chapters, we’ve learned how to analyze both spatial and temporal data with network science tools such as centrality to understand important trends.</p>
<p class="calibre3">Many analytic tasks in the real world involve spatiotemporal data—including the analysis of world stock markets influenced by local policies, data mining of store data across locations for trends in customer behavior and revenue, discerning disease sources and population<a id="_idIndexMarker319" class="pcalibre calibre6 pcalibre1"/> vulnerabilities during an epidemic, tracking human behavior (such as crime, eating habits, substance use, birth rates, or terrorism) across countries or regions of a specific country, and demonstrating the effects of climate change across vulnerable countries.</p>
<p class="calibre3">Let’s get acquainted with our two datasets and problems relevant to many applications of spatiotemporal data.</p>
<h2 id="_idParaDest-92" class="calibre7"><a id="_idTextAnchor092" class="pcalibre calibre6 pcalibre1"/>The Burkina Faso market dataset</h2>
<p class="calibre3">In <a href="B21087_02.xhtml#_idTextAnchor028" class="pcalibre calibre6 pcalibre1"><em class="italic">Chapter 2</em></a>, we introduced the <a id="_idIndexMarker320" class="pcalibre calibre6 pcalibre1"/>Burkina Faso market dataset, which recorded market millet prices across the country from Quarter 2 of 2015 to Quarter 2 of 2022. During this period, world grain prices fluctuated due to COVID-19 supply<a id="_idIndexMarker321" class="pcalibre calibre6 pcalibre1"/> chain issues and the Ukraine conflict limiting food distribution and aid. Food security is a major issue in many regions of the world, and understanding what might cause prices to soar out of reach for the average person or family is critical in meeting the world’s food needs and avoiding famine.</p>
<p class="calibre3">Some regions of a country may be more vulnerable to food shortages or soaring costs of goods than others, and the spatial features in our dataset capture these for the Burkina Faso markets. We’d imagine a rural market (such as the one shown in <em class="italic">Figure 7</em><em class="italic">.1</em>) would face greater pricing and availability instability than a market in the heart of a city such as Ouagadougou. In addition, some events within a period may cause more pricing volatility than other events in that same period. Capturing the time series trends is also important to understand the causes and potential effects of events on grain prices in the region. Thus, capturing the data as spatiotemporal data allows us to analyze both trends across locations and across time.</p>
<div><div><img alt="Figure 7.1 – An illustration of a rural market in Burkina Faso" src="img/B21087_07_01.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.1 – An illustration of a rural market in Burkina Faso</p>
<p class="calibre3">To capture spatial trends, we’ll return<a id="_idIndexMarker322" class="pcalibre calibre6 pcalibre1"/> to the weight matrix introduced in <a href="B21087_02.xhtml#_idTextAnchor028" class="pcalibre calibre6 pcalibre1"><em class="italic">Chapter 2</em></a>, which connected markets located in provinces that share<a id="_idIndexMarker323" class="pcalibre calibre6 pcalibre1"/> a border. This roughly captures the geography of Burkina Faso, allowing regions that share many borders the potential to influence each other’s pricing and demonstrating the potential supply chain issues related to remote regions of the country.</p>
<p class="calibre3">Just as pricing can change over time and geography, so can sales volumes. Let’s turn to our next example and explore how sales can change across stores due to COVID-19 changes in work policies and<a id="_idIndexMarker324" class="pcalibre calibre6 pcalibre1"/> the movements of populations<a id="_idIndexMarker325" class="pcalibre calibre6 pcalibre1"/> across a city.</p>
<h2 id="_idParaDest-93" class="calibre7"><a id="_idTextAnchor093" class="pcalibre calibre6 pcalibre1"/>Store sales data</h2>
<p class="calibre3">Let’s consider a local chain of printer supply stores in a medium-sized city. As populations change near store<a id="_idIndexMarker326" class="pcalibre calibre6 pcalibre1"/> locations, it may be necessary to pivot business strategy: closing stores that are struggling to minimize real estate costs, preferentially stocking certain stores that are doing well, and opening new locations in high-volume sales areas. Perhaps work-from-home initiatives during COVID-19 have resulted in more people working from home in certain areas of the city and more people moving to certain areas as they have the freedom to live where they would like to live rather than live close to their offices. Perhaps return-to-office initiatives also impact demand for home office supplies. All these factors can impact the printer supply stores and change quickly.</p>
<p class="calibre3">To explore this further, we’ve created a simulated dataset with sales from four stores serving a single metropolitan area that mimic the population movement trends heralded by COVID-19 policies and subsequent waffling on return-to-office versus remote work policies. Let’s say Store 1 (<em class="italic">Figure 7</em><em class="italic">.2</em>) serves a population that mainly works in nursing, grocery store management, and other jobs that do not stay remote for very long. This area also has temporary school closures. We’d expect to see a bump in sales initially during COVID-19 lockdowns but a quick return-to-normal pattern of sales:</p>
<div><div><img alt="Figure 7.2 – An illustration of a printer supply store – Store 1" src="img/B21087_07_02.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.2 – An illustration of a printer supply store – Store 1</p>
<p class="calibre3">However, Store 2 is located<a id="_idIndexMarker327" class="pcalibre calibre6 pcalibre1"/> near the downtown area and serves a population of mostly mid-level technical workers, who largely don’t fall under return-to-work policies once they are fully remote. Thus, sales spike during the initial lockdown and stabilize to the new normal for that area of town.</p>
<p class="calibre3">Store 3 serves a very desirable suburb near the downtown area mainly comprised of high-earning professionals who either worked from home or went into the office regularly before COVID-19. The<a id="_idIndexMarker328" class="pcalibre calibre6 pcalibre1"/> commute is typically long, but the school system and safety of the neighborhood are excellent. During COVID-19, this suburb experienced a real estate boom as families elsewhere in the state decided to settle in that area now that they could work from home. Thus, by 2023, the area will have a large remote-worker population in need of printer supplies. Store 3 may need a larger space by 2023, as shown in <em class="italic">Figure 7</em><em class="italic">.3</em>:</p>
<div><div><img alt="Figure 7.3 – An illustration of a warehouse of printer supplies" src="img/B21087_07_03.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.3 – An illustration of a warehouse of printer supplies</p>
<p class="calibre3">Store 4, however, serves the<a id="_idIndexMarker329" class="pcalibre calibre6 pcalibre1"/> downtown area, which experiences a dramatic population loss as young families who like the convenience of a short commute move to the suburbs. Return-to-work policies don’t attract workers back to condos in the downtown areas, leaving most buildings partially empty or inhabited by seasonal <a id="_idIndexMarker330" class="pcalibre calibre6 pcalibre1"/>residents. Ideally, we’d like to avoid a pile-up of supplies and no potential clients (<em class="italic">Figure 7</em><em class="italic">.4</em>):</p>
<div><div><img alt="Figure 7.4 – An illustration of an abandoned printer supply store with no customers" src="img/B21087_07_04.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.4 – An illustration of an abandoned printer supply store with no customers</p>
<p class="calibre3">Our goal is to spot trends as they happen to pivot business strategy as quickly as possible to meet growing regional demands for supplies and to minimize real estate expenses as rents soar in our<a id="_idIndexMarker331" class="pcalibre calibre6 pcalibre1"/> metro area. Given that these stores share a geography, we’ll assume that the spatial weight matrix connects all four stores to each other. In a larger chain of stores, creating spatial weights based on demographic characteristics or distance from other stores might hone the analysis.</p>
<p class="calibre3">For now, let’s turn our attention to the code that will help us find insights into our Burkina Faso market data and our COVID-19 store sales data.</p>
<h1 id="_idParaDest-94" class="calibre5"><a id="_idTextAnchor094" class="pcalibre calibre6 pcalibre1"/>Analyzing our spatiotemporal datasets</h1>
<p class="calibre3">Our Burkina Faso market dataset is conveniently broken into quarters, and to understand quarter-by-quarter<a id="_idIndexMarker332" class="pcalibre calibre6 pcalibre1"/> changes, it makes sense to set our window size as four quarters (a year) with a three-quarter overlap (to focus on monthly changes). As we did in <a href="B21087_02.xhtml#_idTextAnchor028" class="pcalibre calibre6 pcalibre1"><em class="italic">Chapter 2</em></a>, we’ll calculate the local Moran statistic through the weight matrix and correlation metric. Let’s set up our needed packages and import our Burkina Faso Market dataset plus its weight matrix with <code>Script 7.1</code>:</p>
<pre class="source-code">
#import packages
import igraph as ig
from igraph import Graph
import numpy as np
import pandas as pd
import os
import matplotlib.pyplot as plt
#import Burkina Faso market millet prices
File="C:/users/njfar/OneDrive/Desktop/BF_Millet.csv"
pwd=os.getcwd()
os.chdir(os.path.dirname(File))
mydata=pd.read_csv(os.path.basename(File),encoding='latin1')
#import weight matrix of Burkina Faso markets
File="C:/users/njfar/OneDrive/Desktop/weights_bk.csv"
pwd=os.getcwd()
os.chdir(os.path.dirname(File))
weights=pd.read_csv(os.path.basename(File),encoding='latin1')</pre> <p class="calibre3">Now that we have our data and packages, let’s calculate the Forman-Ricci curvature and PageRank centrality and save the <a id="_idIndexMarker333" class="pcalibre calibre6 pcalibre1"/>network and overall metrics for each time slice by adding to <code>Script 7.1</code> with a correlation threshold set to <code>0.9</code> (for maximum sensitivity to major changes):</p>
<pre class="source-code">
#score in yearly sets with 3 quarter overlap
vcurv_t=[]
vcurv_ave=[]
eig_t=[]
eig_ave=[]
nets=[]
for Year in range(4,29):
    data=mydata.iloc[(Year-4):(Year),1:46]
    cor=np.corrcoef(data.transpose())
    weights_total=weights.iloc[:,1:46]
    cor[cor&gt;=0.9]=1
    cor[cor&lt;0.9]=0
    cor_weighted=np.multiply(cor,weights_total)
    bf_market_w=Graph.Adjacency(cor_weighted,diag=False)
    edge_list=bf_market_w.get_edgelist()
    self_loop=[]
    for i in range(0,46):
        self=(i,i)
        self_loop.append(self)
    to_remove=[]
    for i in edge_list:
        for j in self_loop:
            if i==j:
                to_remove.append(i)
    bf_market_w.delete_edges(to_remove)
    nets.append(bf_market_w)
    d=Graph.degree(bf_market_w)
    e=Graph.pagerank(bf_market_w)
    eig_t.append(e)
    eig_ave.append(np.mean(e))
    ecurvw=[]
    for edge in bf_market_w.es:
        s=edge.source
        t=edge.target
        ecurvw.append(2-d[s]-d[t])
    vcurvw=[]
    for vertex in bf_market_w.vs:
        inc=Graph.incident(bf_market_w,vertex)
        inc_curv=[]
        for I in inc:
            inc_curv.append(ecurvw[i])
        vcurvw.append(sum(inc_curv))
    vcurv_t.append(vcurvw)
    vcurv_ave.append(np.mean(vcurv_t))</pre> <p class="calibre3">Now that we have our metrics <a id="_idIndexMarker334" class="pcalibre calibre6 pcalibre1"/>calculated, let’s plot the results to see how PageRank and Forman-Ricci curvature centrality vary over time by adding to <code>Script 7.1</code>:</p>
<pre class="source-code">
#plot metric averages across time slices
time=range(0,25)
plt.plot(time, eig_ave, label = "PageRank Average")
plt.plot(time, vcurv_ave, label = "Forman-Ricci Curvature Average")
plt.xlabel("Time Slice")
plt.ylabel("PageRank and Forman-Ricci Curvature Averages")
plt.legend()
plt.show()</pre> <p class="calibre3">This should show a plot with very little variance in PageRank centrality but an increase and cyclical fluctuation of Forman-Ricci curvature centrality (<em class="italic">Figure 7</em><em class="italic">.5</em>). This suggests that the volatility of millet prices <a id="_idIndexMarker335" class="pcalibre calibre6 pcalibre1"/>increased over our markets, starting sometime around 2018-2019 (where volatility increased, then decreased, then increased again before leveling off at a higher volatility level) and got a bit worse during COVID-19 and the Ukraine conflict.</p>
<div><div><img alt="Figure 7.5 – A plot of average centrality metrics from 2015-2022 on the Burkina Faso market millet prices" src="img/B21087_07_05.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.5 – A plot of average centrality metrics from 2015-2022 on the Burkina Faso market millet prices</p>
<p class="calibre3">Now that we have a plot showing changes in volatility, we can investigate what our markets look like at different periods. You may wish to investigate all periods, but we’ll compare two periods—one with low volatility and one with high volatility—and show them in the following code. Let’s plot time period <code>4</code>, where volatility was low according to Forman-Ricci curvature centrality (highest centrality measurement in the dataset), and the size of each vertex is weighted by Forman-Ricci curvature for that vertex, by adding to <code>Script 7.1</code>:</p>
<pre class="source-code">
#examine different time points with Forman-Ricci
#curvature plots, fourth slice
ig.plot(nets[4],vertex_size=np.array(vcurv_t[4])*-0.5)</pre> <p class="calibre3">This should yield a plot like <em class="italic">Figure 7</em><em class="italic">.6</em>, showing very<a id="_idIndexMarker336" class="pcalibre calibre6 pcalibre1"/> few markets connected by correlation and spatial weighting and very low Forman-Ricci curvature for vertices (very small vertex sizes):</p>
<div><div><img alt="Figure 7.6 – A plot showing markets connected by correlation &gt;0.9 within the same geographical area weighted by Forman-Ricci curvature centrality" src="img/B21087_07_06.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.6 – A plot showing markets connected by correlation &gt;0.9 within the same geographical area weighted by Forman-Ricci curvature centrality</p>
<p class="calibre3"><em class="italic">Figure 7</em><em class="italic">.6</em> shows that most markets are not connected to each other, and those that are connected to each other tend to have very little mutual connectivity, yielding Forman-Ricci curvature centrality metrics near <code>0</code>. This means that prices are independent, suggesting a robust network of markets that are unlikely to be highly impacted by external factors such as COVID-19 or international trade changes. Changes that impact one or two markets are unlikely to impact all of the country’s markets, and sellers and consumers impacted by local issues (such as a dry quarter) can seek grain from a neighboring area if needed. The government can also address shortages by simply moving excess grain <a id="_idIndexMarker337" class="pcalibre calibre6 pcalibre1"/>from one province with a good supply to another with supply issues. Fixing local issues with supplies won’t take much time or money from a government perspective.</p>
<p class="calibre3">Let’s examine a period of higher volatility (the 19th period) and see how connectivity and Forman-Ricci curvature centrality compared to time period <code>4</code> by adding to <code>Script 7.1</code>:</p>
<pre class="source-code">
#examine different time points with Forman-Ricci
#curvature plots, 19th slice
ig.plot(nets[19],vertex_size=np.array(vcurv_t[19])*-0.5)</pre> <p class="calibre3">This should yield a plot like <em class="italic">Figure 7</em><em class="italic">.7</em>, where many markets are connected to each other mutually, yielding Forman-Ricci curvature centrality metrics much further from zero, suggesting highly interconnected supply chains across large regions of the country that are vulnerable to large shortages that could cause a famine in the area. Addressing these issues will cost the government much more in terms of time and cost, leaving people vulnerable to food shortages or price spikes that make grain unaffordable for consumers.</p>
<p class="callout-heading">Note</p>
<p class="calibre3">Some connected markets share many mutual connections, yielding strong curvature metrics, while some markets remain unconnected to any other market. The less-connected market prices suggest some areas are less vulnerable to widespread grain price spikes or shortages that would cause a famine.</p>
<div><div><img alt="Figure 7.7 – The 19th time period in the Burkina Faso market millet price network" src="img/B21087_07_07.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.7 – The 19th time period in the Burkina Faso market millet price network</p>
<p class="calibre3">From our analyses, we can glean some insight into our market price behaviors over time. Prior to 2017, prices <a id="_idIndexMarker338" class="pcalibre calibre6 pcalibre1"/>showed less volatility across markets. Individual markets weren’t as tightly coupled with respect to price, suggesting local impacts on pricing. However, as markets became more dependent on global forces with respect to price, the markets became more volatile and susceptible to the impact of world events, such as COVID-19 and the Ukraine conflict. Indeed, in our raw dataset, we can see prices soaring after these events. This suggests that country-wide approaches are needed to address rising food prices, rather than focus on local markets that are struggling or vulnerable to changes in local production or global aid.</p>
<p class="calibre3">Looking at historical changes through the <strong class="bold">United States Agency for International Development</strong> (<strong class="bold">USAID</strong>) database and articles found on Google, we see that 2010-2020 was a period of development and international food aid in Burkina Faso, though many in the country relied mainly on subsistence farming rather than food purchased at markets. Given the rising prices, it is not surprising that subsistence farming and food aid were necessary, as grain prices reached crisis levels.</p>
<p class="calibre3">Now that we’ve seen how to analyze spatiotemporal data to visualize trends of volatility, let’s turn our attention to the four stores impacted by work-from-home and return-to-office policies in a localized city. We’ll ignore weighting, as these stores are in the same area and include <a id="_idIndexMarker339" class="pcalibre calibre6 pcalibre1"/>only four stores. We’ll use a threshold of <code>0.9</code> again to maximize our chances of finding extremely volatile periods in the data. Let’s import our data with <code>Script 7.2</code> and get started:</p>
<pre class="source-code">
#import store sales data
File="C:/users/njfar/OneDrive/Desktop/Store_Sales.csv"
pwd=os.getcwd()
os.chdir(os.path.dirname(File))
mydata=pd.read_csv(os.path.basename(File),encoding='latin1')</pre> <p class="calibre3">We’ll calculate Forman-Ricci curvature and PageRank centrality for this network by adding to <code>Script 7.2</code>; don’t worry if you encounter a runtime warning, as it may appear for Windows machines but does not indicate a problem running your code:</p>
<pre class="source-code">
#score in yearly sets with monthly  overlap
vcurv_t=[]
vcurv_ave=[]
eig_t=[]
eig_ave=[]
nets=[]
for Month in range(2,54):
    data=mydata.iloc[(Month-2):(Month),1:6]
    cor=np.corrcoef(data.transpose())
    cor[cor&gt;=0.9]=1
    cor[cor&lt;0.9]=0
    stores=Graph.Adjacency(cor)
    edge_list=stores.get_edgelist()
    self_loop=[]
    for i in range(0,52):
        self=(i,i)
        self_loop.append(self)
    to_remove=[]
    for i in edge_list:
        for j in self_loop:
            if i==j:
                to_remove.append(i)
    stores.delete_edges(to_remove)
    nets.append(stores)
    d=Graph.degree(stores)
    e=Graph.pagerank(stores)
    eig_t.append(e)
    eig_ave.append(np.mean(e))
    ecurvw=[]
    for edge in stores.es:
        s=edge.source
        t=edge.target
        ecurvw.append(2-d[s]-d[t])
    vcurvw=[]
    for vertex in stores.vs:
        inc=Graph.incident(stores,vertex)
        inc_curv=[]
        for i in inc:
            inc_curv.append(ecurvw[i])
        vcurvw.append(sum(inc_curv))
    vcurv_t.append(vcurvw)
    vcurv_ave.append(np.mean(vcurv_t))</pre> <p class="calibre3">Again, we can plot PageRank <a id="_idIndexMarker340" class="pcalibre calibre6 pcalibre1"/>and Forman-Ricci curvature centrality to identify periods of high and low volatility by adding to <code>Script 7.2</code>:</p>
<pre class="source-code">
#plot metric averages across time slices
time=range(0,52)
plt.plot(time, eig_ave, label = "PageRank Average")
plt.plot(time, vcurv_ave, label = "Forman-Ricci Curvature Average")
plt.xlabel("Time Slice")
plt.ylabel("PageRank and Forman-Ricci Curvature Averages")
plt.legend()
plt.show()</pre> <p class="calibre3">You should see a plot similar to <em class="italic">Figure 7</em><em class="italic">.8</em>, where volatility overall is fairly constant over the time period, with a few periods of increasing or decreasing volatility marking periods where pricing may be influenced by outside factors that our store managers cannot control.</p>
<div><div><img alt="Figure 7.8 – A plot of PageRank and Forman-Ricci curvature averages" src="img/B21087_07_08.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.8 – A plot of PageRank and Forman-Ricci curvature averages</p>
<p class="calibre3">While we wouldn’t expect major changes from period to period in volatility to show up in network plots for each period, we do<a id="_idIndexMarker341" class="pcalibre calibre6 pcalibre1"/> see some differences in volatility that are worth investigating. Let’s again choose two periods to investigate (period <code>10</code> and period <code>30</code>). We’ll investigate period <code>10</code> first by adding to <code>Script 7.2</code>, weighting our vertices by Forman-Ricci curvature to visualize the interconnectivity of sales:</p>
<pre class="source-code">
#examine different time points with
#Forman-Ricci curvature plots, tenth slice
ig.plot(nets[10],vertex_size=np.array(vcurv_t[10])*-0.5)</pre> <p class="calibre3">This should show a plot like <em class="italic">Figure 7</em><em class="italic">.9</em>, where only two stores are connected to each other, suggesting a period of relative<a id="_idIndexMarker342" class="pcalibre calibre6 pcalibre1"/> stability where outside influences shouldn’t impact sales across our stores as much as in other periods that are more volatile.</p>
<div><div><img alt="Figure 7.9 – A plot of our stores from period 10" src="img/B21087_07_09.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.9 – A plot of our stores from period 10</p>
<p class="calibre3">Let’s compare this plot with period <code>30</code>’s plot by adding to <code>Script 7.2</code>:</p>
<pre class="source-code">
#examine different time points with
#Forman-Ricci curvature plots, thirtieth slice
ig.plot(nets[30],vertex_size=np.array(vcurv_t[30])*-0.5)</pre> <p class="calibre3">This code should produce a plot similar to <em class="italic">Figure 7</em><em class="italic">.10</em>, showing connectivity across all four stores (maximum possible <a id="_idIndexMarker343" class="pcalibre calibre6 pcalibre1"/>volatility), which leaves stores vulnerable to events that might impact sales across all four stores instead of impacting only one local store:</p>
<div><div><img alt="Figure 7.10 – A network plot of our store data from period 30 showing maximal volatility" src="img/B21087_07_10.jpg" class="calibre4"/>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US">Figure 7.10 – A network plot of our store data from period 30 showing maximal volatility</p>
<p class="calibre3">Taken together, our results suggest volatility is fairly constant for our stores a few months prior to COVID-19 and increases upon the work-from-home mandates, continuing more or less through return-to-work policies. From our raw simulation data, some stores benefit from this change, while other stores suffer quite a bit. As volatility changes, store managers need to focus on factors they can control regarding their individual stores, and the manager<a id="_idIndexMarker344" class="pcalibre calibre6 pcalibre1"/> overseeing all stores in the area may need to strategize on how to pivot supplies and growth needs of growing stores while considering the consolidation of buildings for those struggling stores.</p>
<p class="calibre3">Overall, these analyses provide some insight into pricing and sales vulnerability over times of crisis, allowing decision makers to pinpoint times requiring strategy pivots. Combined with other analytics (such as time series forecasting through multichannel singular spectrum analysis, for instance, or information on demographic or time-of-day differences in buying behavior), these types of analyses add insight into the timing and specific geographies that require attention to continue thriving in changing times.</p>
<h1 id="_idParaDest-95" class="calibre5"><a id="_idTextAnchor095" class="pcalibre calibre6 pcalibre1"/>Summary</h1>
<p class="calibre3">In this chapter, we extended our prior insights on temporal and spatial data to tackle analytics problems with spatiotemporal datasets, including a store sales dataset and a Burkina Faso market millet price dataset. We sliced our two datasets by time, calculated spatial statistics, and analyzed network centrality metrics to identify changepoints and periods of volatility in our data. Periods of volatility correspond to network vulnerability to crashes and spikes in prices, sales, and other metrics, as the interconnectedness of the system allows for effects on one part of the network to spill into other parts of the network. We saw this at play during COVID-19 and the Ukraine conflict for Burkina Faso’s markets, as well as the impacts of COVID-19 on the sales data. In <a href="B21087_07.xhtml#_idTextAnchor088" class="pcalibre calibre6 pcalibre1"><em class="italic">Chapter 7</em></a>, we'll look at sales and goods pricing across both time and geography to see how network science can solve problems in spatiotemporal data. In <a href="B21087_08.xhtml#_idTextAnchor097" class="pcalibre calibre6 pcalibre1"><em class="italic">Chapter 8</em></a>, we'll consider dynamic networks, where connections and even individuals can change over time, and examine how these changes impact disease spread in wildlife populations.</p>
<h1 id="_idParaDest-96" class="calibre5"><a id="_idTextAnchor096" class="pcalibre calibre6 pcalibre1"/>References</h1>
<p class="calibre3">Han, X., Zhu, G., Zhao, L., Du, R., Wang, Y., Chen, Z., ... &amp; He, S. (2023). <em class="italic">Ollivier–Ricci Curvature Based Spatio-Temporal Graph Neural Networks for Traffic Flow Forecasting</em>. <em class="italic">Symmetry</em>, <em class="italic">15</em> (5), 995.</p>
<p class="calibre3">Schlör, J., Strnad, F. M., Fröhlich, C., &amp; Goswami, B. (2022, May). <em class="italic">Identifying patterns of teleconnections, a curvature-based network analysis</em>. In <em class="italic">EGU General Assembly Conference Abstracts</em> (pp. EGU22-7256).</p>
<p class="calibre3">Shekhar, S., Jiang, Z., Ali, R. Y., Eftelioglu, E., Tang, X., Gunturi, V. M., &amp; Zhou, X. (2015). <em class="italic">Spatiotemporal data mining: A computational perspective</em>. <em class="italic">ISPRS International Journal of Geo-Information</em>, <em class="italic">4</em> (4), 2306-2338.</p>
<p class="calibre3">Wang, Y., Huang, Z., Yin, G., Li, H., Yang, L., Su, Y., ... &amp; Shan, X. (2022). <em class="italic">Applying Ollivier-Ricci curvature to indicate the mismatch of travel demand and supply in urban transit network</em>. <em class="italic">International Journal of Applied Earth Observation and Geoinformation</em>, <em class="italic">106</em>, 102666.</p>
</div>
</body></html>