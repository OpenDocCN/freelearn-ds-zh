<html><head></head><body>
		<div>
			<div id="_idContainer508" class="Content">
			</div>
		</div>
		<div id="_idContainer509" class="Content">
			<h1 id="_idParaDest-202">7. <a id="_idTextAnchor227"/>Data Analysis: Creating and Using Calculations</h1>
		</div>
		<div id="_idContainer576" class="Content">
			<p class="callout-heading">Overview</p>
			<p class="callout">In this chapter, you will learn to create and use various types of calculations, not just within an existing data source, but also across data sources. This chapter first describes the definitions and the differences between Aggregate and Non-Aggregate values. Then, you will learn about various types of calculations, such as numeric calculations, string calculations, and date calculations, as well as how to write logic statements in Tableau.</p>
			<p class="callout">By the end of this chapter, you will be able to create and use various types of calculations in Tableau.</p>
			<h1 id="_idParaDest-203"><a id="_idTextAnchor228"/>Introduction</h1>
			<p>Typically, the first step when analyzing data is to start with some questions or goals. It could be as simple as determining your most profitable customers, or more complicated, such as investigating which products are leading to losses despite high sales. After deciding on questions or goals, you would audit your data. This means identifying where data resides—whether the required fields are stored in a single or in multiple data sources and whether all fields are readily available for use. Then, you would check the integrity and validity of your data. This means checking whether the data needs any modifications in terms of cleaning, combining, or restructuring.</p>
			<p>Once data is audited, the tools in Tableau Desktop allow you to explore it visually for more streamlined analysis. This can mean building charts, adding interactivity, separating data into groups, or creating calculations to derive more meaningful insights. Once analysis is complete, the insights you gather will be ready to share with others. This chapter aims to cover all aspects of the data analysis cycle.</p>
			<p>In this chapter, you will later learn how to create and use Tableau's various types of calculation, which is an essential skill in data analysis. Differentiating Between Aggregate and Non-Aggregate</p>
			<p>To work effectively with Tableau, it is vital that you have a thorough understanding of aggregation. When adding any data, Tableau quickly classifies the data in the <strong class="source-inline">Data</strong> pane as <strong class="source-inline">Dimensions</strong> and <strong class="source-inline">Measures.</strong>  When a <strong class="source-inline">Measure</strong> enters the view, Tableau aggregates it (typically, using the <strong class="source-inline">SUM</strong> aggregation).</p>
			<p>This can be demonstrated using the <strong class="source-inline">Orders</strong> data from <em class="italic">Sample-Superstore.xlsx</em>, which can be found at <strong class="source-inline">Documents\My Tableau Repository\Datasources\</strong> or downloaded from this book's GitHub repository at the following link: <a href="https://packt.link/T9PeZ">https://packt.link/T9PeZ</a>.</p>
			<p>Once you have access to the data, drag the <strong class="source-inline">Profit</strong> field from the <strong class="source-inline">Data</strong> pane into the <strong class="source-inline">Rows</strong> shelf. Notice that the properties of the field have changed to <strong class="source-inline">SUM(Profit)</strong> and a vertical bar is generated. Refer to the following figure:</p>
			<div>
				<div id="_idContainer510" class="IMG---Figure">
					<img src="image/B16342_07_01.jpg" alt="Figure 7.1: A screenshot showing SUM(Profit)&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.1: A screenshot showing SUM(Profit)</p>
			<p>Look at the status bar at the bottom of the sheet.  Notice there is only <strong class="source-inline">1 mark</strong> and the <strong class="source-inline">SUM(Profit)</strong> is <strong class="source-inline">286,397</strong>. This is the <em class="italic">total aggregated profit of the data</em>:</p>
			<div>
				<div id="_idContainer511" class="IMG---Figure">
					<img src="image/B16342_07_02.jpg" alt="Figure 7.2: A screenshot showing SUM(Profit) in the status bar&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.2: A screenshot showing SUM(Profit) in the status bar</p>
			<p>Now, observe what happens when you disaggregate it. In order to disaggregate the <strong class="source-inline">Measure</strong>, uncheck the <strong class="source-inline">Aggregate Measures</strong> option, which is available in the <em class="italic">toolbar</em> under <strong class="source-inline">Analysis</strong>:</p>
			<div>
				<div id="_idContainer512" class="IMG---Figure">
					<img src="image/B16342_07_03.jpg" alt="Figure 7.3: A screenshot showing the Aggregate Measures option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.3: A screenshot showing the Aggregate Measures option</p>
			<p>The <strong class="source-inline">SUM(Profit)</strong> field, which was in the <strong class="source-inline">Rows</strong> shelf, has now changed to show just <strong class="source-inline">Profit</strong>. Further, the bar chart is now broken into multiple bubbles; some bubbles are on the negative axis, and the status bar now shows <strong class="source-inline">9994 marks</strong>:</p>
			<div>
				<div id="_idContainer513" class="IMG---Figure">
					<img src="image/B16342_07_04.jpg" alt="Figure 7.4: A screenshot showing disaggregated profit&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.4: A screenshot showing disaggregated profit</p>
			<p>When you uncheck the <strong class="source-inline">Aggregate Measures</strong> option, the <strong class="source-inline">Profit</strong> value becomes non-aggregated, which in turn breaks the aggregated profit bar showing the <strong class="source-inline">Sum of Profit</strong> in bubbles that represent <em class="italic">every transactional profit value in the data</em>. At any given point, you can right-click on a bubble to view the data and see the full details of a transaction:</p>
			<div>
				<div id="_idContainer514" class="IMG---Figure">
					<img src="image/B16342_07_05.jpg" alt="Figure 7.5: A screenshot showing the view data option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.5: A screenshot showing the view data option</p>
			<p>By default, the <strong class="source-inline">Aggregate Measures</strong> option is on, and all <strong class="source-inline">Measures</strong> will be <em class="italic">aggregated by default</em> (unless you choose to disaggregate them as explained above). Further, the default aggregation of <strong class="source-inline">Measures</strong> is <strong class="source-inline">SUM</strong> and this can be changed by right-clicking on a <strong class="source-inline">Measure</strong> in the <strong class="source-inline">Data</strong> pane and changing <strong class="source-inline">Aggregation</strong> under <strong class="source-inline">Default Properties</strong> from <strong class="source-inline">Sum</strong> to <strong class="source-inline">Average</strong> or <strong class="source-inline">Minimum</strong> to <strong class="source-inline">Maximum, etc.</strong>:</p>
			<div>
				<div id="_idContainer515" class="IMG---Figure">
					<img src="image/B16342_07_06.jpg" alt="Figure 7.6: A screenshot showing how to change aggregation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.6: A screenshot showing how to change aggregation</p>
			<p>From the previous example, you can conclude that when you see <strong class="source-inline">SUM(Profit)</strong> in the view, it means that Tableau is aggregating all transactional values. When you see <strong class="source-inline">Profit</strong> only, it means that Tableau is taking notice of the transactional values without aggregating them. This particular distinction is important, especially when creating calculated fields. You will further explore this point when diving deeper into creating and using calculations.</p>
			<p>In the previous example, you looked at aggregating and disaggregating <strong class="source-inline">Measures</strong>. However, when dealing with <strong class="source-inline">Dimensions</strong>, which includes all categorical data, there are additional considerations. Specifically, you should be asking yourself: <em class="italic">Which/Who?</em> and <em class="italic">How many?</em>. </p>
			<p>Taking the <strong class="source-inline">Sample-Superstore.xlsx</strong> file as an example, when analyzing <strong class="source-inline">Sub-Category</strong>, you might ask the following questions: <em class="italic">Which sub-categories are profitable?</em> or <em class="italic">How many sub-categories are profitable?</em> The first question is easy to answer as you are only concerned with data members from the <strong class="source-inline">Sub-Category</strong> field that are in profit.  When you drag a dimension into the view, you will get the list of all unique data members of that field by default. So, dragging the <strong class="source-inline">Sub-Category</strong> field into the <strong class="source-inline">Rows</strong> shelf will result in the following view:</p>
			<div>
				<div id="_idContainer516" class="IMG---Figure">
					<img src="image/B16342_07_07.jpg" alt="Figure 7.7: A screenshot showing the unique list of data members of a dimension&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.7: A screenshot showing the unique list of data members of a dimension</p>
			<p>However, for the second question, you need to find the number of sub-categories that have positive profit. This means finding the number of data members for that dimension. This is achieved by clicking on the dropdown of the <strong class="source-inline">Sub-Category</strong> field, and selecting the <strong class="source-inline">Count</strong> or <strong class="source-inline">Count(Distinct)</strong> option, available under <strong class="source-inline">Measure</strong>:</p>
			<div>
				<div id="_idContainer517" class="IMG---Figure">
					<img src="image/B16342_07_08.jpg" alt="Figure 7.8: A screenshot showing the Count and Count (Distinct) &#13;&#10;options for a dimension in the view&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.8: A screenshot showing the Count and Count (Distinct) options for a dimension in the view</p>
			<p>When selecting the <strong class="source-inline">Count</strong> or the <strong class="source-inline">Count(Distinct)</strong> option, notice that the list of sub-categories changes into a bar showing that there are a total of 17 sub-categories in the data. This method will only make the count of sub-categories available in the worksheet where they were created. However, if you need to show the same information for other visualizations across your workbook, it makes sense to have the count in your <strong class="source-inline">Data</strong> pane, so you can drag it into the view as and when required. This can be achieved in two ways:</p>
			<ul>
				<li>The first method is to change the <strong class="source-inline">Sub-Category</strong> dimension into a <strong class="source-inline">Measure</strong>, which will change the original <strong class="source-inline">Dimensions</strong> field from showing a list of data members into a <strong class="source-inline">Measure</strong> showing a distinct count of sub-categories:</li>
			</ul>
			<div>
				<div id="_idContainer518" class="IMG---Figure">
					<img src="image/B16342_07_09.jpg" alt="Figure 7.9: A screenshot showing aggregation of a dimension by converting it into a measure&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.9: A screenshot showing aggregation of a dimension by converting it into a measure</p>
			<ul>
				<li>The second way is to create a calculated field on the <strong class="source-inline">Sub-Category</strong> dimension. This will not only maintain the original dimension, but we will also have another field that can be used to get the desired output. You will learn more about creating a calculated field in the topics to come.</li>
			</ul>
			<h1 id="_idParaDest-204">Creating <a id="_idTextAnchor229"/>and Using Ad hoc / Edit in Shelf Calculations</h1>
			<p><strong class="bold">Ad hoc / Edit in Shelf calculations</strong> are the quickest and easiest way to create a new calculated field in Tableau. Ad hoc calculations can be created in the <strong class="source-inline">Rows</strong>, <strong class="source-inline">Columns</strong>, and <strong class="source-inline">Measure Values </strong>shelves, as well as in the <strong class="source-inline">Marks cards</strong>. </p>
			<p>Simply double-click on the existing field in your shelf of choice, or, alternatively you can use the <strong class="source-inline">Edit in Shelf</strong> option in the drop-down list of that field, as shown in the following figure:</p>
			<div>
				<div id="_idContainer519" class="IMG---Figure">
					<img src="image/B16342_07_10.jpg" alt="Figure 7.10: A screenshot showing how to create an ad hoc calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.10: A screenshot showing how to create an ad hoc calculation</p>
			<p>These ad hoc calculations are useful when creating quick, on-the-fly calculations that you may or may not want to save and reuse. You will explore this in the exercise below.</p>
			<h2 id="_idParaDest-205"><a id="_idTextAnchor230"/>Exercise 7.01: Creating an Ad Hoc Calculation to Highlight Loss-Making Sub-Categories</h2>
			<p>The aim of this exercise is to find out which sub-categories have negative profit and which ones have positive profit. Those with negative profit will be your loss-making sub-categories and will be color-coded orange. You will use the <strong class="source-inline">Orders</strong> data from <strong class="source-inline">Sample-Superstore.xlsx</strong> for this exercise.</p>
			<p>Perform the following steps:</p>
			<ol>
				<li>Start by creating a bar chart showing <strong class="source-inline">SUM(Sales)</strong> by <strong class="source-inline">Sub-Category</strong> with <strong class="source-inline">SUM(Profit)</strong> in the <strong class="source-inline">Color</strong> shelf, as shown in the following screenshot.</li>
			</ol>
			<div>
				<div id="_idContainer520" class="IMG---Figure">
					<img src="image/B16342_07_11.jpg" alt="Figure 7.11: A screenshot showing a bar chart of Sales by Sub-Category with profit in color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.11: A screenshot showing a bar chart of Sales by Sub-Category with profit in color</p>
			<p>The bars have a color palette of orange and blue, with shades of <em class="italic">orange indicating negative profit</em>, and shades of <em class="italic">blue indicating positive profit</em>. The shades indicate the intensity of <strong class="source-inline">Profit</strong>. However, the task at hand is to highlight the bars that are loss-making, which means those with a profit less than zero. The intensity of profit is irrelevant for this task. </p>
			<p>To address this, either double-click or use the <strong class="source-inline">Edit in Shelf</strong> option in the dropdown of the <strong class="source-inline">SUM(Profit)</strong> field in the <strong class="source-inline">Color</strong> shelf and type the following formula:</p>
			<p class="source-code">SUM(Profit) &lt; 0</p>
			<ol>
				<li value="2">Hit <em class="italic">Enter</em> to see the new ad hoc calculation. It now shows two colors instead of the previously seen diverging colors. In this case, the orange bars indicate subcategories are loss-making and the blue bars indicate subcategories are profitable. Refer to the following screenshots:</li>
			</ol>
			<div>
				<div id="_idContainer521" class="IMG---Figure">
					<img src="image/B16342_07_12.jpg" alt="Figure 7.12: Screenshots with an ad hoc calculation in the color shelf&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.12: Screenshots with an ad hoc calculation in the color shelf</p>
			<p>Further, as mentioned previously, this ad hoc calculation is an on-the-fly calculation that may be used only in this specific visualization, in which case, there isn't any need to save this calculation. </p>
			<ol>
				<li value="3">So that you can reuse this in other visualizations, save the calculation in the <strong class="source-inline">Data</strong> pane by simply dragging and dropping, as shown in the following screenshots:</li>
			</ol>
			<div>
				<div id="_idContainer522" class="IMG---Figure">
					<img src="image/B16342_07_13.jpg" alt="Figure 7.13: Screenshots showing how to save an ad hoc calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.13: Screenshots showing how to save an ad hoc calculation</p>
			<h1 id="_idParaDest-206"><a id="_idTextAnchor231"/>Creating and Using Different Types of Calculations</h1>
			<p>Tableau is a simple yet versatile tool, and the ability to create calculations gives users the flexibility to perform powerful analysis, which can help with decision-making. Most of the time, creating calculations in Tableau is a fun experience, but sometimes it can be a little frustrating as well, especially if you are coming from a different platform to Tableau and are trying to replicate some functionality. The way these tools are structured and designed is different and trying to replicate the functionality from one tool in another can make the experience frustrating. The best way to avoid frustration while creating calculations in Tableau is to start small and get acquainted with the functions that Tableau has to offer. While writing a calculation in Tableau is easy, it is recommended that, if possible, you should try to use the built-in native features first, instead of creating a new calculated field. Some examples of these features are as follows:</p>
			<ul>
				<li>The <strong class="source-inline">Split</strong> or <strong class="source-inline">Custom Split</strong> function, available under the <strong class="source-inline">Transform</strong> option when right-clicking any <strong class="source-inline">String Dimension</strong> in the <strong class="source-inline">Data</strong> pane. This is used to split the string into smaller sub-strings. For example, splitting a customer name into, for example, the first name and last name.</li>
				<li>The <strong class="source-inline">Group</strong> function, which is available under the <strong class="source-inline">Create</strong> option when right-clicking any dimension in the <strong class="source-inline">Data</strong> pane. This is used to group the data members of that dimension into higher categories, for example, grouping the data members of the geographic state field into, for example, regions.</li>
				<li>The <strong class="source-inline">Custom date</strong> function, which is available under the <strong class="source-inline">Create</strong> option when right-clicking on a <strong class="source-inline">Date Dimension</strong> in the <strong class="source-inline">Data</strong> pane. This is used to truncate dates into different granularities such as month, month-year, etc.</li>
				<li>The <strong class="source-inline">Bins</strong> function, which is available under the <strong class="source-inline">Create</strong> option when right-clicking on a <strong class="source-inline">Measure</strong> in the <strong class="source-inline">Data</strong> pane. This is used to group <strong class="source-inline">Measure</strong> values into different range buckets, for example, age bins that range from, for example &lt;10 years, 11-20 years, 21-30 years, etc.</li>
				<li>The <strong class="source-inline">Combined Field</strong> function, available under the <strong class="source-inline">Create</strong> option when selecting more than 1 <strong class="source-inline">String Dimension</strong> in the <strong class="source-inline">Data</strong> pane, and then right-clicking any selected string dimension. This is useful when combining multiple string dimensions into one field.</li>
				<li>The <strong class="source-inline">Aliases</strong> function, which is available upon right-clicking any dimension in the <strong class="source-inline">Data</strong> pane. This is useful when renaming the members of any dimension.</li>
			</ul>
			<p>A point to note is that all objectives mentioned here can be achieved by creating a calculated field from scratch, but since these native functions are readily and easily available, it is best to avoid the hassle and make use of them. Over the course of this chapter and various other chapters in this book, you will explore these functions in a little more detail.</p>
			<p>To understand the process of creating calculations, you will first create a basic calculation to find the distinct count of your order IDs. You can do this in many ways. You could change the <strong class="source-inline">Order ID</strong> dimension into a <strong class="source-inline">Measure</strong> or click the dropdown of the <strong class="source-inline">Order ID</strong> field that is shown in your view, and then click the <strong class="source-inline">Measure</strong> | <strong class="source-inline">Count (Distinct)</strong> option. Alternatively, you could even create an ad hoc calculation.</p>
			<p>In an earlier topic, you saw how to save an ad hoc calculation in the <strong class="source-inline">Data</strong> pane. However, inexplicably, when attempting this after performing basic aggregations such as sum, average, or count, you'll find that the ad hoc calculation does not save. From testing, the drag-drop method appears to fix this issue. Try it with the calculation below:</p>
			<p class="source-code">COUNTD([Order ID])*1 </p>
			<p>You will now be creating a calculation in Tableau from scratch. To do this, you will continue with the objective of getting the distinct count of order IDs. </p>
			<p>Right-click on the <strong class="source-inline">Order ID</strong> dimension in the <strong class="source-inline">Data</strong> pane and select the <strong class="source-inline">Create</strong> | <strong class="source-inline">Calculated Field</strong> option. This will open a new type in the box, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer523" class="IMG---Figure">
					<img src="image/B16342_07_14.jpg" alt="Figure 7.14: A screenshot showing components of a calculation box&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.14: A screenshot showing components of a calculation box</p>
			<p><em class="italic">Figure 7.14</em> shows the components of a calculation box. These are as follows:</p>
			<ul>
				<li><strong class="bold">1 – Calculation name</strong>: This is where you can define the name of a calculation. It is always recommended to give meaningful names to calculated fields.</li>
				<li><strong class="bold">2 – List of functions / types of functions</strong>: This is the list of all functions available in Tableau. The functions are listed in alphabetical order, and are classified as <strong class="source-inline">Number</strong>, <strong class="source-inline">String</strong>, <strong class="source-inline">Date</strong>, <strong class="source-inline">Type Conversion</strong>, <strong class="source-inline">Aggregate</strong>, <strong class="source-inline">Logical</strong>, etc. When clicking any of these functions, Tableau presents the syntax of that function, an explanation of what the function does, and an example. Refer to the following screenshot:</li>
			</ul>
			<div>
				<div id="_idContainer524" class="IMG---Figure">
					<img src="image/B16342_07_15.jpg" alt="Figure 7.15: A screenshot showing details of the selected function&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.15: A screenshot showing details of the selected function</p>
			<ul>
				<li><strong class="bold">3 – Calculation editor</strong>: This is where you will type your formula. </li>
				<li><strong class="bold">4 – Syntax validator</strong>: This will validate whether your formula and calculation are syntactically correct. If there are any issues, the text will read as <strong class="source-inline">The calculation contains errors</strong> in red font, and the calculation editor box will display a red squiggly line near the text with the error.</li>
			</ul>
			<p>Ever since you right-clicked on the <strong class="source-inline">Order ID</strong> field to create a calculation, Tableau has assumed you will be creating a calculation for that field, and because of that, it has already fetched the field into the calculation editor. </p>
			<p>Start by typing the word <strong class="source-inline">CountD</strong> before <strong class="source-inline">Order ID.</strong> As you type, Tableau starts recommending functions, as well as data fields that share characters with what you type. Now, name the calculation '<strong class="source-inline">Count of Orders'</strong>. Your calculation box should look like the following screenshot:</p>
			<div>
				<div id="_idContainer525" class="IMG---Figure">
					<img src="image/B16342_07_16.jpg" alt="Figure 7.16: A screenshot showing the formula for calculating the distinct count of Order ID&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.16: A screenshot showing the formula for calculating the distinct count of Order ID</p>
			<p>Once, you have valid calculation, you can click <strong class="source-inline">OK</strong> and proceed to use it. Clicking <strong class="source-inline">OK</strong> will save your calculation in the <strong class="source-inline">Data</strong> pane, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer526" class="IMG---Figure">
					<img src="image/B16342_07_17.jpg" alt="Figure 7.17: A screenshot showing the newly created calculated field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.17: A screenshot showing the newly created calculated field</p>
			<p>Now, that you have your calculated field available in the <strong class="source-inline">Data</strong> pane, you can start using it across the entire workbook. There are, however, a few important points to note:</p>
			<ul>
				<li>In the previous example, you right-clicked on <strong class="source-inline">Order ID</strong> and selected the <strong class="source-inline">Create | Calculated Field</strong> option, which opened the calculation editor box. This can also be made available by selecting the <strong class="source-inline">Analysis | Create Calculated Field...</strong> option in the toolbar, or by clicking on the dropdown in the <strong class="source-inline">Data</strong> pane and selecting <strong class="source-inline">Create Calculated Field...</strong>:</li>
			</ul>
			<div>
				<div id="_idContainer527" class="IMG---Figure">
					<img src="image/B16342_07_18.jpg" alt="Figure 7.18: A screenshot showing other ways to create a calculated field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.18: A screenshot showing other ways to create a calculated field</p>
			<ul>
				<li>Any field that is computed or calculated in Tableau will have <strong class="source-inline">=</strong> as a prefix, which indicates that the field was created in Tableau, and does not derive from the data itself. The = sign will be followed by either <strong class="source-inline">Abc</strong> or <strong class="source-inline">#</strong> (or something similar), which indicates the data type of that field. So, for example, <strong class="source-inline">=Abc</strong> is indicative of a computed field with a string output.</li>
				<li>To add comments to a calculation, you need to make use of two forward slashes, that is, <strong class="source-inline">//. Tableau will ignore anything that follows the //</strong>. Refer to the following screenshot:</li>
			</ul>
			<div>
				<div id="_idContainer528" class="IMG---Figure">
					<img src="image/B16342_07_19.jpg" alt="Figure 7.19: A screenshot showing how to add comments in a calculated field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.19: A screenshot showing how to add comments in a calculated field</p>
			<ul>
				<li>The functions (blue text in <em class="italic">Figure 7.19</em> in Tableau are not case-sensitive, but data fields (orange text in <em class="italic">Figure 7.19</em>) are, hence, you need to be extra careful about the case, as well as the spelling of the data field. If there are any issues, the syntax validator will give an error, and you will not be able to use the calculated field for further analysis. To overcome this, drag and drop the desired field from the <strong class="source-inline">Data</strong> pane into the calculation editor box instead of typing the text, as shown in the following screenshot:</li>
			</ul>
			<div>
				<div id="_idContainer529" class="IMG---Figure">
					<img src="image/B16342_07_20.jpg" alt="Figure 7.20: A screenshot showing dragging and dropping fields into the calculation editor&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.20: A screenshot showing dragging and dropping fields into the calculation editor</p>
			<ul>
				<li>Tableau supports all standard operators, such as multiplication (*), division (/), modulo (%), addition (+), subtraction (-), as well as all the comparisons, such as equal to (== or =), greater than (&gt;), greater than or equal to (&gt;=), less than (&lt;), less than or equal to (&lt;=), and not equal to (!= or &lt;&gt;). These operators must be typed and are not part of the list of functions in the calculation box.</li>
				<li>Since Tableau is a read-only tool, the calculated fields you are computing will not be written back to the data, thus keeping the integrity of your data intact.</li>
				<li>You can create a calculated field and use it in other calculated fields as well. </li>
			</ul>
			<p>You will now work through examples of how some of these calculations can be created and used. </p>
			<h2 id="_idParaDest-207"><a id="_idTextAnchor232"/>Creating and Using Different Types of Calculations: Numeric Calculations</h2>
			<p>Numeric calculations are used when performing mathematical/arithmetic functions on numeric data in order to return a numeric output. The <strong class="source-inline">Number</strong> functions supported by Tableau at this point in time (that is, in version 2020.1) are as follows:</p>
			<ul>
				<li><strong class="bold">Basic math functions</strong> such as the <strong class="source-inline">ABS</strong> function, which is used to return the absolute value of the number; the <strong class="source-inline">ROUND</strong> function, which is used to round the number to the specified number of decimal places; <strong class="source-inline">SQRT</strong>, which is used to return the square root of a number; and the <strong class="source-inline">ZN</strong> function, which returns zero if there are null values, or returns the value itself otherwise. </li>
				<li><strong class="bold">Trigonometric functions</strong> such as <strong class="source-inline">ASIN</strong>, <strong class="source-inline">ACOS</strong>, <strong class="source-inline">ATAN</strong>, <strong class="source-inline">SIN</strong>, <strong class="source-inline">COS</strong>, <strong class="source-inline">TAN</strong>, and others.</li>
				<li><strong class="bold">Angular functions</strong> such as <strong class="source-inline">DEGREES</strong> and <strong class="source-inline">RADIANS</strong>.</li>
				<li><strong class="bold">Mapping functions</strong> such as <strong class="source-inline">HEXBINX</strong> and <strong class="source-inline">HEXBINY</strong>.</li>
				<li><strong class="bold">Logarithmic functions</strong> such as <strong class="source-inline">LN</strong> and <strong class="source-inline">LOG</strong>.</li>
				<li><strong class="bold">Exponential and Power functions</strong> such as <strong class="source-inline">EXP</strong> and <strong class="source-inline">POWER</strong>, and others.</li>
			</ul>
			<p>As mentioned earlier, when selecting any of these functions, you will see the syntax of that function, an explanation of the purpose of that function, along with an example. Further, with these numeric functions, as well as the arithmetic operators above, you can create some immensely powerful and useful calculations.</p>
			<p>In the previous topic, you created a new calculated field called <strong class="source-inline">Count of Orders</strong>, which gave the distinct count of your order IDs. You will now use this computed field to create another calculated field to find the average order value for your sub-categories.</p>
			<h2 id="_idParaDest-208"><a id="_idTextAnchor233"/>Exercise 7.02: Creating a Numeric Calculation</h2>
			<p>The objective of this exercise is to create a numeric calculation to find the average order value of each sub-category. You will continue with the <strong class="source-inline">Orders data</strong> from the <em class="italic">Sample-Superstore.xlsx</em> file and, using the <strong class="source-inline">Sales</strong> field and the previously created <strong class="source-inline">Count of Orders</strong> field, create a new calculated field called <strong class="source-inline">Average Order Value (AOV)</strong> for each <strong class="source-inline">Sub-Category</strong> and display it in a bar chart.</p>
			<ol>
				<li value="1">First, drag your <strong class="source-inline">Sub-Category</strong> field and drop it in the <strong class="source-inline">Rows</strong> shelf. Next, drag the Sales and the <strong class="source-inline">Count of Orders</strong> field into the <strong class="source-inline">Columns</strong> shelf. Now enable the labels for your bar charts by clicking on <strong class="source-inline">Show Marks Label</strong> in the toolbar. See the following screenshot: </li>
			</ol>
			<div>
				<div id="_idContainer530" class="IMG---Figure">
					<img src="image/B16342_07_21.jpg" alt="Figure 7.21: A screenshot showing a bar chart with Sales and &#13;&#10;Count of Orders across sub-categories&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.21: A screen<a id="_idTextAnchor234"/>shot showing a bar chart with Sales and Count of Orders across sub-categories</p>
			<ol>
				<li value="2">Create a calculated field called <strong class="source-inline">Average Order Value (AOV)</strong> with the following formula:<p class="source-code">SUM([Sales])/[Count of Orders]</p></li>
			</ol>
			<p>You should see the following on your screen:</p>
			<div>
				<div id="_idContainer531" class="IMG---Figure">
					<img src="image/B16342_07_22.jpg" alt="Figure 7.22: A screenshot showing the formula for&#13;&#10; the Average Order Value (AOV) calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.22: A screenshot showing the formula for  the Average Order Value (AOV) calculation</p>
			<ol>
				<li value="3">Drag and drop the <strong class="source-inline">Average Order Value (AOV)</strong> next to the <strong class="source-inline">Count of Orders</strong> field in the <strong class="source-inline">Columns</strong> shelf. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer532" class="IMG---Figure">
					<img src="image/B16342_07_23.jpg" alt="Figure 7.23: A screenshot showing the bar chart with &#13;&#10;the Average Order Value (AOV) calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.23: A screenshot showing the bar chart with the Average Order Value (AOV) calculation</p>
			<p>As you can see in <em class="italic">Figure 7.23</em>, the <strong class="source-inline">Copiers</strong> sub-category has the <strong class="bold">highest average order value</strong> followed by <strong class="source-inline">Machines</strong>. </p>
			<p>Note that the prefix for <strong class="source-inline">Average Order Value (AOV)</strong> is <strong class="source-inline">AGG</strong>, which stands for <strong class="bold">Aggregate</strong>. This is Tableau's way of telling you that the calculation is pre-aggregated by the user (since you are using <strong class="source-inline">SUM()</strong> for sales and the count of orders field is using the <strong class="source-inline">COUNTD()</strong> function).</p>
			<p>This exercise shows an example of creating and using a numeric calculation. You have created a new calculation called <strong class="source-inline">Average Order Value (AOV)</strong> using the <strong class="source-inline">Sales</strong> field and the <strong class="source-inline">Count of Orders</strong> field. Since this <strong class="source-inline">Average Order Value (AOV)</strong> field has a numeric output, the calculation is called a numeric calculation.</p>
			<h2 id="_idParaDest-209"><a id="_idTextAnchor235"/>Creating and Using Different Types of Calculations: Logic Statements</h2>
			<p>Logic statements are typically used for criteria-based or condition-based evaluation. Some of the logical functions available in Tableau are as follows:</p>
			<ul>
				<li>Operators such as <strong class="source-inline">AND</strong>, <strong class="source-inline">OR</strong>, and <strong class="source-inline">NOT</strong>.</li>
				<li>Functions such as <strong class="source-inline">IF</strong>, <strong class="source-inline">ELSE</strong>, <strong class="source-inline">ELSEIF</strong>, <strong class="source-inline">CASE</strong>, <strong class="source-inline">IIF</strong>, <strong class="source-inline">IFNULL</strong>, <strong class="source-inline">ISNULL</strong>, <strong class="source-inline">ISDATE</strong>, etc.</li>
			</ul>
			<p><strong class="source-inline">IF…ELSE</strong>, <strong class="source-inline">IF…ELSEIF…ELSE</strong>, and <strong class="source-inline">CASE</strong> are the most commonly used logic functions and, typically, when using these logic functions, the <strong class="source-inline">THEN</strong> function is used to specify the value that needs to be displayed when the expression is true.</p>
			<p>An important point to remember here is that when using the <strong class="source-inline">IF</strong> statement or a <strong class="source-inline">CASE</strong> statement for logical evaluation, you need to terminate your logical statement with the <strong class="source-inline">END</strong> function.  </p>
			<p>You have already seen an example of a logic statement in the <strong class="bold">Creating and Using Ad Hoc / Edit in Shelf Calculations</strong> section, where you found out which sub-categories were profitable, and which were not. You created a calculation to see whether <strong class="source-inline">SUM(Profit)</strong> was greater than or less than zero. The output of this calculation was a Boolean output, with the outcome being either <strong class="source-inline">True</strong> or <strong class="source-inline">False</strong>. Boolean calculations are a  quick and easy type of logic statement. They get executed quickly and perform well compared to the other types of logic statement.</p>
			<p>Although Boolean calculations have many advantages, they could confuse an end user if they are unaware of what <strong class="source-inline">True</strong> and <strong class="source-inline">False</strong> stand for. The meaning of Booleans depends on the criteria in your calculations. In the earlier example, the outcome <strong class="source-inline">True</strong> indicates either positive or negative profit, depending on what is specified in your calculation. If the end user is unfamiliar with these criteria, the Boolean outcome will be unhelpful.</p>
			<p>To avoid confusion, it is best to use a more elaborate logic statement incorporating user-friendly tags. You will explore this by following the steps in the following exercise.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you are using a version of Tableau later than 2020.1, you may need to create Number of records to match the output of <em class="italic">Exercise 7.03</em>.</p>
			<h2 id="_idParaDest-210"><a id="_idTextAnchor236"/>Exercise 7.03: Creating a Logic Calculation</h2>
			<p>In this exercise, you will create a logic calculation to find unprofitable products. as well as to find out how many transactions for each product are unprofitable. You will use the <strong class="source-inline">CoffeeChain Query</strong> table from the <strong class="source-inline">Sample-Coffee Chain.mdb</strong> dataset. This is a <em class="italic">Microsoft Access Database</em>. The dataset can be downloaded from the following link: <a href="https://1drv.ms/u/s!Av5QCoyLTBpnmkPL8Yx_0_2KtrG4?e=rWpksB">https://1drv.ms/u/s!Av5QCoyLTBpnmkPL8Yx_0_2KtrG4?e=rWpksB</a>.</p>
			<p>First, you will connect to the <strong class="source-inline">CoffeeChain Query</strong> table from the <strong class="source-inline">Sample-Coffee Chain.mdb</strong> dataset and create a bar chart using the <strong class="source-inline">Product</strong> field and the <strong class="source-inline">Number of records</strong> field. You will then create new calculated fields, which will help find and highlight <em class="italic">unprofitable products</em>, and find out <em class="italic">how many of the transactions in each product are unprofitable</em>.</p>
			<ol>
				<li value="1">Connect to the <strong class="source-inline">CoffeeChain Query</strong> table from <strong class="source-inline">Sample-Coffee Chain.mdb</strong>. Create a bar chart by dragging the <strong class="source-inline">Product Name</strong> field into the <strong class="source-inline">Rows</strong> shelf. Then, drag <strong class="source-inline">Number of Records</strong> into the <strong class="source-inline">Columns</strong> shelf and enable the labels for these bars. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer533" class="IMG---Figure">
					<img src="image/B16342_07_24.jpg" alt="Figure 7.24: A screenshot showing the bar chart showing Number of Records by Product&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.24: A screenshot showing the bar chart showing Number of Records by Product</p>
			<p>Now, you want to find the profitability of your products. However, profitability (especially in this case) can be computed on two levels. </p>
			<p>There is the overall profitability of a product, and there is how many transactions for a product are profitable. Both these requirements are useful to know. You will begin by finding the overall profitability of your products.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Please replace the quotes around <strong class="source-inline">Profitable Product</strong> and <strong class="source-inline">Unprofitable Product</strong> after pasting the code in <em class="italic">Step 2</em> below. This will ensure the output is error-free.</p>
			<ol>
				<li value="2">Create a new calculated field called <strong class="source-inline">Overall Profitability</strong> using the <strong class="source-inline">IF…THEN…ELSE…END</strong> function. The formula will be as follows:<p class="source-code">IF SUM([Profit])&gt;0 THEN "Profitable Product" </p><p class="source-code">ELSE "Unprofitable Product"</p><p class="source-code">END </p></li>
			</ol>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer534" class="IMG---Figure">
					<img src="image/B16342_07_25.jpg" alt="Figure 7.25: A screenshot showing the formula for Overall Profitability&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.25: A screenshot showing the formula for Overall Profitability</p>
			<ol>
				<li value="3">Click <strong class="source-inline">OK</strong> and drag this new field into the <strong class="source-inline">Color</strong> shelf. Your view will update, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer535" class="IMG---Figure">
					<img src="image/B16342_07_26.jpg" alt="Figure 7.26: A screenshot showing Overall Profitability using color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.26: A screenshot showing Overall Profitability using color</p>
			<p>As you see from the color legend, the <em class="italic">blue bars</em> are the <em class="italic">profitable products</em>, and the <em class="italic">orange bars</em> are the <em class="italic">unprofitable products</em>. In the preceding screenshot, you can clearly see that green tea is the only product that is unprofitable.</p>
			<p>In the ad hoc calculation example (<em class="italic">Exercise 7.01, Creating an Ad Hoc Calculation to Highlight Loss-Making Sub-Categories</em>), when you saved the calculation in the <strong class="source-inline">Data</strong> pane, you had a Boolean output with a prefix of =T|F, whereas when you save this <strong class="source-inline">Overall Profitability</strong> calculation by clicking <strong class="source-inline">OK</strong>, you see that the output is a string with the prefix <strong class="source-inline">=Abc</strong>. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer536" class="IMG---Figure">
					<img src="image/B16342_07_27.jpg" alt="Figure 7.27: A screenshot showing the prefix for an ad hoc calculation and Overall Profitability calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.27: A screenshot showing the prefix for an ad hoc calculation and Overall Profitability calculation</p>
			<p>Now that you have found which of your products are profitable, it is time to find out how many profitable transactions there are for each product.</p>
			<ol>
				<li value="4"><strong class="bold">Duplicate</strong> the <strong class="source-inline">Overall Profitability</strong> calculation and change the code.</li>
				<li>Use the <strong class="source-inline">IF…THEN…ELSE…END</strong> function. The formula and syntax should be similar to the <strong class="source-inline">Overall Profitability</strong> calculation, except for a change in the aggregation of the <strong class="source-inline">Profit</strong> field and the displayed output string. Name this calculated field <strong class="source-inline">Transactional Profitability</strong>. The formula will be as follows:<p class="source-code">IF [Profit]&gt;0 THEN "Profitable transaction" </p><p class="source-code">ELSE "Unprofitable transaction"</p><p class="source-code">END </p></li>
			</ol>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer537" class="IMG---Figure">
					<img src="image/B16342_07_28.jpg" alt="Figure 7.28: A screenshot showing the formula for Transactional Profitability&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.28: A screenshot showing the formula for Transactional Profitability</p>
			<ol>
				<li value="6">Click <strong class="source-inline">OK</strong> and drag this new field into the <strong class="source-inline">Color</strong> shelf. Your view will update, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer538" class="IMG---Figure">
					<img src="image/B16342_07_29.jpg" alt="Figure 7.29: A screenshot showing Transactional Profitability in color&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.29: A screenshot showing Transactional Profitability in color</p>
			<p>As you see from the color legend, the <em class="italic">blue bars</em> represent <strong class="source-inline">profitable transactions</strong>, and the <em class="italic">orange bars</em> represent <strong class="source-inline">unprofitable transactions</strong>. From this, you can find some interesting outcomes. For example, it shows that all <strong class="source-inline">Decaf Espresso</strong> transactions are profitable.</p>
			<p>You have now successfully created and used logic statements to find the profitability, and profitable transactions for each of your products</p>
			<h2 id="_idParaDest-211">Creating and Using Different <a id="_idTextAnchor237"/>Types of Calculations: String Calculations</h2>
			<p>In Tableau, string calculations can be performed on any data type. Tableau converts and processes all such data types and yields a string output. You can create string calculations on <strong class="source-inline">Integer</strong> fields, as well as <strong class="source-inline">Date</strong> fields by first converting them into a string. You can use the type conversion function <strong class="source-inline">STR()</strong> in Tableau to achieve this. The various string functions supported by Tableau (in version 2020.1) are as follows: </p>
			<ul>
				<li>Functions such as <strong class="source-inline">ASCII</strong> and <strong class="source-inline">CHAR</strong> find the ASCII code of a character and the character based on the ASCII code, respectively.</li>
				<li>Case functions such as <strong class="source-inline">LOWER</strong> and <strong class="source-inline">UPPER</strong> change the casing of strings to lowercase and uppercase, respectively.</li>
				<li>Functions such as <strong class="source-inline">CONTAINS</strong>, <strong class="source-inline">STARTSWITH</strong>, <strong class="source-inline">ENDSWITH</strong>, and <strong class="source-inline">ISDATE</strong> check string or substring conditions.</li>
				<li>Functions such as <strong class="source-inline">TRIM</strong>, <strong class="source-inline">LTRIM</strong>, and <strong class="source-inline">RTRIM</strong> remove blank spaces.</li>
				<li>Functions such as <strong class="source-inline">FIND</strong> and <strong class="source-inline">FINDNTH</strong> find the position of a substring.</li>
				<li>Functions such as <strong class="source-inline">LEFT</strong>, <strong class="source-inline">RIGHT</strong>, and <strong class="source-inline">MID</strong>, return the specified number of characters in a string.</li>
				<li>Regular expressions such as <strong class="source-inline">REGEXP_EXTRACT</strong>, <strong class="source-inline">REGEXP_EXTRACT_NTH</strong>, <strong class="source-inline">REGEXP_MATCH</strong>, and <strong class="source-inline">REGEXP_REPLACE</strong> allow you to specify patterns to match, locate, and manage text.</li>
				<li>Some other string functions available in Tableau are <strong class="source-inline">LEN</strong>, which returns the length of the string; <strong class="source-inline">REPLACE</strong>, which searches for a specified substring and replaces it with a replacement substring; <strong class="source-inline">SPLIT</strong>, which returns the substring from a string based on the specified delimiter; and <strong class="source-inline">MIN</strong> and <strong class="source-inline">MAX</strong>, which return either the alphabetically minimum or maximum value for a string.</li>
			</ul>
			<p>In this section, you will further explore some of these functions.</p>
			<p>You will now continue with the <strong class="source-inline">Orders</strong> data from <em class="italic">Sample-Superstore.xlsx</em> and work with the <strong class="source-inline">Customer Name</strong> field. Currently, this field is a combination of the first names and last names of customers. First and last names are separated by a <em class="italic">space</em>. For this example, you would separate the first and last names of each customer, and then find the initial letters of the last names for your customers. </p>
			<p>After that, you create groups for names starting with letters <em class="italic">A to I</em>, <em class="italic">J to R</em>, and <em class="italic">S to Z</em> to find out how many customers fall in each group. </p>
			<p>You begin by dragging the <strong class="source-inline">Customer Name</strong> field into the <strong class="source-inline">Rows</strong> shelf. There should be 793 unique customers. </p>
			<p>To find the last name, you have to create calculations on the <strong class="source-inline">Customer Name</strong> field. Right-click on the <strong class="source-inline">Customer Name</strong> field in the <strong class="source-inline">Data</strong> pane and choose the <strong class="source-inline">Split</strong> or <strong class="source-inline">Custom Split</strong> option available under <strong class="source-inline">Transform</strong>. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer539" class="IMG---Figure">
					<img src="image/B16342_07_30.jpg" alt="Figure 7.30: A screenshot showing the Split and Custom Split options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.30: A screenshot showing the Split and Custom Split options</p>
			<p>When using the <strong class="source-inline">Split</strong> function, Tableau automatically creates two calculated fields named <strong class="source-inline">Customer Name – Split 1</strong> and <strong class="source-inline">Customer Name – Split 2.</strong> When you edit these calculated fields, you will see the following syntax for <strong class="source-inline">Split 1</strong> and <strong class="source-inline">Split 2</strong> respectively:</p>
			<p class="source-code">TRIM( SPLIT( [Customer Name], " ", 1 ) )</p>
			<p class="source-code">TRIM( SPLIT( [Customer Name], " ", 2 ) )</p>
			<p>This auto split targeted <em class="italic">delimiter</em>, which in this case was <em class="italic">space</em>, and on that basis, has split the field to give the <em class="italic">first column before the space</em>, which is customer <em class="italic">first names</em> <em class="italic">second column after the space</em>, which in this case is customer last names. </p>
			<p>The <strong class="source-inline">Custom Split</strong> option allows for more control than the auto split option. Here, for example, only the last name is needed. The first name isn't of any use at this point. So, instead of using the auto split option, you can use <strong class="source-inline">Custom Split</strong>, which brings up the following screenshot:</p>
			<div>
				<div id="_idContainer540" class="IMG---Figure">
					<img src="image/B16342_07_31.jpg" alt="Figure 7.31: A screenshot showing the Custom Split option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.31: A screenshot showing the Custom Split option</p>
			<p>Here, you can specify the separator/delimiter. You can decide whether you want the first column or the second column, and whether you want to split the columns. To get only the last name, choose <em class="italic">space</em> as the separator, and then <strong class="source-inline">Split off</strong> the <strong class="source-inline">Last</strong> <strong class="source-inline">1</strong> column. You get one new calculated field called <strong class="source-inline">Customer Name - Split 2</strong>. The syntax of this field is as follows:</p>
			<p class="source-code">TRIM(SPLIT([Customer Name], " ", -1 ))</p>
			<p><strong class="source-inline">Split</strong> and <strong class="source-inline">Custom Split</strong> are shortcut options provided by Tableau to split strings. However, you could get the same result by creating new calculated fields from scratch using some of the previously stated string functions.  You will now explore this further.</p>
			<p>First, parse the string to find the position of the space. Next, ask Tableau to give the string that follows the space. To find the position of the space, use the <strong class="source-inline">FIND</strong> function in Tableau.  The syntax of the calculated field should be as follows:</p>
			<p class="source-code">FIND([Customer Name]," ")</p>
			<p>This gives the position of the space as a numeric value. However, you need the string after the space. To identify this, use the <strong class="source-inline">MID</strong> function. The syntax should be as follows:</p>
			<p class="source-code">MID([Customer Name],FIND([Customer Name]," "))</p>
			<p>This formula gives you the string followed by the space, but this also includes the leading space. To remove this leading space, either use the <strong class="source-inline">TRIM</strong> function or the <strong class="source-inline">LTRIM</strong> function as follows:</p>
			<ol>
				<li value="1"><strong class="source-inline">TRIM</strong>:<p class="source-code">TRIM(MID([Customer Name],FIND([Customer Name]," ")))</p></li>
				<li><strong class="source-inline">LTRIM</strong>:<p class="source-code">LTRIM(MID([Customer Name],FIND([Customer Name]," ")))</p></li>
			</ol>
			<p>Either of these two functions will remove the leading space and give only the string followed by the space. However, if you don't want to use the <strong class="source-inline">TRIM</strong> or <strong class="source-inline">LTRIM</strong> function, you could even modify the calculation to tweak the <strong class="source-inline">FIND</strong> function, as shown here:</p>
			<p class="source-code">MID([Customer Name],(FIND([Customer Name]," ")+1))</p>
			<p>The <strong class="source-inline">+1</strong> in the preceding example finds the first position after the space, and thus will work similarly to the <strong class="source-inline">TRIM</strong> and <strong class="source-inline">LTRIM</strong> functions.</p>
			<p>The point of discussing all these options is to show that many string functions can be utilized differently to get the same output. Now, choose any of the preceding formulae and save your calculated field as <strong class="source-inline">Last Name</strong>. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer541" class="IMG---Figure">
					<img src="image/B16342_07_32.jpg" alt="Figure 7.32: A screenshot showing the Last Name calculated field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.32: A screenshot showing the Last Name calculated field</p>
			<p>Now, you have the <strong class="source-inline">Last Name</strong> of your customers, it is time to find the initial letter of <strong class="source-inline">Last Name</strong>. Here, again, you can use functions such as <strong class="source-inline">LEFT</strong> and <strong class="source-inline">MID</strong>. The syntax for both these functions is as follows:</p>
			<p class="source-code">LEFT([Last Name],1)</p>
			<p class="source-code">MID([Last Name],1,1)</p>
			<p>The <strong class="source-inline">LEFT</strong> function will return the <em class="italic">specified number of characters (shown as </em><strong class="source-inline">1</strong><em class="italic"> in the previous example)</em> from the start of the given string.</p>
			<p>The <strong class="source-inline">MID</strong> function will return the characters from the middle of the string, giving a <em class="italic">starting position and a length (shown as </em><strong class="source-inline">1,1</strong><em class="italic"> in the previous example)</em>. So, both the <strong class="source-inline">LEFT</strong> and the <strong class="source-inline">MID</strong> functions will give us the first character of the string.</p>
			<p>Here, you will continue with the <strong class="source-inline">MID</strong> function, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer542" class="IMG---Figure">
					<img src="image/B16342_07_33.jpg" alt="Figure 7.33: A screenshot showing the initial letter of the Last Name calculated field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.33: A screenshot showing the initial letter of the Last Name calculated field</p>
			<p>Finally, it is time for you to create your groups. You can use the following formula:</p>
			<p class="source-code">IF [Starting alphabet of Last Name] &lt;= "I" THEN "A-I"</p>
			<p class="source-code">ELSEIF [Starting alphabet of Last Name] &gt;= "S" THEN "S-Z"</p>
			<p class="source-code">ELSE "J-R"</p>
			<p class="source-code">END</p>
			<p>Name this calculation <strong class="source-inline">Groups-Starting alphabet of Last Name</strong>. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer543" class="IMG---Figure">
					<img src="image/B16342_07_34.jpg" alt="Figure 7.34: A screenshot showing the Groups-Starting alphabet &#13;&#10;of Last Name calculated field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.34: A screenshot showing the Groups-Starting alphabet of Last Name calculated field</p>
			<p>Change the <strong class="source-inline">Customer Name</strong> field in the <strong class="source-inline">Rows</strong> shelf to show the distinct count of customers. Then, drop the new calculated field into the <strong class="source-inline">Columns</strong> shelf. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer544" class="IMG---Figure">
					<img src="image/B16342_07_35.jpg" alt="Figure 7.35: A screenshot showing the bar chart of Groups-Starting letter of Last Name&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.35: A screenshot showing the bar chart of Groups-Starting letter of Last Name</p>
			<p><em class="italic">Figure 7.35</em> shows that there are more than 350 customers whose last name starts with a letter that is between <strong class="source-inline">A</strong> and <strong class="source-inline">I</strong>.</p>
			<p>Typically, when dealing with string data, the two main operations you might perform are splitting a string into substrings or concatenating two or more strings to make one long string.  You have now learned how to split strings. In the following exercise, you will be concatenating two strings together.</p>
			<h2 id="_idParaDest-212"><a id="_idTextAnchor238"/>Exercise 7.04: Creating a String Calculation</h2>
			<p>In this exercise, you will create a string calculation that will combine <strong class="source-inline">Product Type</strong>, <strong class="source-inline">Product</strong>, and the aggregated <strong class="source-inline">Sales</strong> value. You will continue using the <strong class="source-inline">CoffeeChain Query</strong> data from the <strong class="source-inline">Sample-Coffee Chain.mdb</strong> file. You will use the <strong class="source-inline">Product Type</strong> and <strong class="source-inline">Product</strong> fields, along with <strong class="source-inline">SUM(Sales)</strong>. </p>
			<ol>
				<li value="1">Start by creating a bar chart using the <strong class="source-inline">Product Type</strong>, <strong class="source-inline">Product</strong>, and <strong class="source-inline">SUM(Sales)</strong> fields, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer545" class="IMG---Figure">
					<img src="image/B16342_07_36.jpg" alt="Figure 7.36: A screenshot showing the bar chart of SUM(Sales) by Product Type and Product&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.36: A screenshot showing the bar chart of SUM(Sales) by Product Type and Product</p>
			<p>Once the bar chart is created, create a calculated field that is a combination of the first three letters of <strong class="source-inline">Product Type</strong> followed by the <strong class="source-inline">Product</strong> text and the <strong class="source-inline">SUM(Sales)</strong> value. So, for example, if <strong class="source-inline">Product Type</strong> is, <strong class="source-inline">Coffee</strong> and <strong class="source-inline">Product</strong> is <strong class="source-inline">Colombian</strong>, and if the total sales for this <strong class="source-inline">Product</strong> are <strong class="source-inline">$90,000</strong>, then the output should be <strong class="source-inline">COF-Colombian: $90000</strong>.</p>
			<p>To achieve this, you must change the Product Type to upper case, then pick only the first 3 characters. You must append the Product labels, and the SUM(Sales) value, which needs to start with a $ sign and must be rounded off to show zero decimals. You also need to add some special characters such as space, <strong class="source-inline">-</strong>, and <strong class="source-inline">:</strong>. These can be inserted using either single quotes or double quotes.  Follow along with this exercise to learn how.</p>
			<ol>
				<li value="2">Begin by creating a new calculated field called <strong class="source-inline">Concatenated string</strong> and type the following formula:<p class="source-code">LEFT(UPPER([Product Type]),3) + "-" + [Product] + " : "</p></li>
			</ol>
			<p>This gives you the first part of what the desired string should look like. So, for example, if the desired output is <strong class="source-inline">COF-Colombian: $90000</strong>, then the preceding calculation gives an output of <strong class="source-inline">COF-Colombian:</strong>.</p>
			<p>You are halfway there. Now, if you saved the calculation mid-way, you will have to right-click on this new calculated field and edit it from the <strong class="source-inline">Dimensions</strong> pane. However, if not, you can continue working in the same calculation box.</p>
			<ol>
				<li value="3">Now you must append the <strong class="source-inline">SUM(Sales)</strong> value, and this is where things start to get complicated. Firstly, <strong class="source-inline">Product Type</strong> and <strong class="source-inline">Product</strong> are <em class="italic">string values</em>, but <strong class="source-inline">SUM(Sales)</strong> is an <em class="italic">integer value</em>, so it is not possible to concatenate them, unless you convert <strong class="source-inline">SUM(Sales)</strong> to a <em class="italic">string value</em>. Further, you need the <strong class="source-inline">SUM(Sales)</strong> value to be <em class="italic">rounded off to zero decimal places</em> and it needs to have <em class="italic">$ as a prefix</em>. Keeping this in mind, amend the existing calculation as follows:<p class="source-code">LEFT(UPPER([Product Type]),3) + "-" + [Product] + " : " + STR(ROUND(SUM([Sales]),0))</p></li>
				<li>You will see that Tableau doesn't agree with this formula and gives an error indicator. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer546" class="IMG---Figure">
					<img src="image/B16342_07_37.jpg" alt="Figure 7.37: A screenshot showing the error in the calculation of Concatenated string&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.37: A screenshot showing the error in the calculation of Concatenated string</p>
			<ol>
				<li value="5">Click the error dropdown. You should see an error that reads <strong class="source-inline">Cannot mix aggregate and non-aggregate arguments with this function</strong>. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer547" class="IMG---Figure">
					<img src="image/B16342_07_38.jpg" alt="Figure 7.38: A screenshot showing the &quot;Cannot mix aggregate &#13;&#10;and non-aggregate arguments…&quot; error&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.38: A screenshot showing the "Cannot mix aggregate and non-aggr<a id="_idTextAnchor239"/>egate arguments…" error</p>
			<p>This is a <em class="italic">classic error</em> common in Tableau. It means that <strong class="source-inline">SUM(Sales)</strong> is an <em class="italic">aggregated field</em> whereas the <strong class="source-inline">Product Type</strong> and <strong class="source-inline">Product</strong> fields, being <strong class="source-inline">Dimensions</strong>, are <em class="italic">not aggregated</em> and, logically, Tableau can't work with aggregated and non-aggregated values in a calculation. So, to overcome this, you must aggregate the <strong class="source-inline">Product Type</strong> and <strong class="source-inline">Product fields</strong>. Since both the Product Type and Product fields are dimensions, you can use any of the following functions: <strong class="source-inline">MIN</strong>, <strong class="source-inline">MAX</strong>, or <strong class="source-inline">ATTR</strong>.</p>
			<p>Save your existing calculation as it is and spend a little time understanding these three functions before amending it.</p>
			<p>When aggregating the dimension using the MIN function, you get the <em class="italic">alphabetically minimum or lowest value</em>. The <strong class="source-inline">MAX</strong> function, on the other hand, gives the <em class="italic">alphabetically maximum or highest value</em>. The ATTR function gives the value of the field as is if it has a single value for all rows; otherwise, it will return an asterisk.</p>
			<ol>
				<li value="6">To demonstrate this, create a new sheet to show <strong class="source-inline">Product Type</strong> in the <strong class="source-inline">Rows</strong> shelf. Then, create a new calculated field called <strong class="source-inline">Min of Product</strong> with the following formula:<p class="source-code">MIN([Product]) </p></li>
			</ol>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer548" class="IMG---Figure">
					<img src="image/B16342_07_39.jpg" alt="Figure 7.39: A screenshot showing Min of Product calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.39: A screenshot showing Min of Product calculation</p>
			<p>Save the calculation. Notice that even though it has a string output, it is now part of the <strong class="source-inline">Measures</strong> pane. This is because it is now an aggregated field and, as discussed earlier, any aggregated field becomes part of the <strong class="source-inline">Measures</strong> pane.</p>
			<ol>
				<li value="7">Now, create another calculation called <strong class="source-inline">Max of Product</strong> with the following formula:<p class="source-code">MAX([Product]) </p></li>
			</ol>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer549" class="IMG---Figure">
					<img src="image/B16342_07_40.jpg" alt="Figure 7.40: A screenshot showing the Max of Product calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.40: A screenshot showing the Max of Product calculation</p>
			<ol>
				<li value="8">This calculation should also be in the <strong class="source-inline">Measures</strong> pane.</li>
				<li>Finally, create a calculation called <strong class="source-inline">Attribute of Product</strong> with the following formula:<p class="source-code">ATTR([Product])</p></li>
			</ol>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer550" class="IMG---Figure">
					<img src="image/B16342_07_41.jpg" alt="Figure 7.41 – A screenshot showing the Attribute of Product calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.41 – A screenshot showing the Attribute of Product calculation</p>
			<p>Now drop these three calculated fields into your sheet, right after the <strong class="source-inline">Product Type</strong> field in the <strong class="source-inline">Rows</strong> shelf.</p>
			<ol>
				<li value="10">First, drop the <strong class="source-inline">Min of Product</strong> field, followed by <strong class="source-inline">Max of Product</strong>, and finally <strong class="source-inline">Attribute of Product</strong>. You should notice that all three fields give different outputs. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer551" class="IMG---Figure">
					<img src="image/B16342_07_42.jpg" alt="Figure 7.42: A screenshot showing the output of Min, Max, and Attribute of Product calculations at the Product Type level&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.42: A screenshot showing the output of Min, Max, and Attribute of Product calculations at the Product Type level</p>
			<p>As you can see, <strong class="source-inline">Min of Product</strong> gives you <strong class="source-inline">Amaretto for Coffee</strong>, <strong class="source-inline">Caffe Latte for Espresso</strong>, <strong class="source-inline">Chamomile for Herbal Tea</strong>, and <strong class="source-inline">Darjeeling for Tea</strong>. These are the <em class="italic">alphabetically minimum values</em> of our <strong class="source-inline">Product </strong>field within that <strong class="source-inline">Product Type</strong>. Similarly, <strong class="source-inline">Max of Product</strong> is giving <strong class="source-inline">Decaf Irish Cream for Coffee</strong>, <strong class="source-inline">Regular Espresso for Espresso</strong>, <strong class="source-inline">Mint for Herbal Tea</strong>, and <strong class="source-inline">Green Tea for Tea</strong>. These are the <em class="italic">alphabetically maximum values</em> of your <strong class="source-inline">Product</strong> field within that <strong class="source-inline">Product</strong> Type. Further, <strong class="source-inline">Attribute of Product</strong> is giving <em class="italic">neither the minimum nor the maximum</em>; instead, it is giving an <em class="italic">asterisk</em>. This means there is more than 1 <strong class="source-inline">Product</strong> under that <strong class="source-inline">Product Type</strong> and since Tableau can't display all the values, it is showing the asterisk to indicate there is more than 1 <strong class="source-inline">Product</strong> under each Product Type. </p>
			<ol>
				<li value="11">Now drag the <strong class="source-inline">Product</strong> field from the <strong class="source-inline">Dimensions</strong> pane and drop it after <strong class="source-inline">Product Type</strong> in the <strong class="source-inline">Rows</strong> shelf. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer552" class="IMG---Figure">
					<img src="image/B16342_07_43.jpg" alt="Figure 7.43: A screenshot showing the output of Min, Max, and Attribute of Product calculations at the Product level&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.43: A screenshot showing the output of Min, Max, and Attribute of Product calculations at the Product level</p>
			<p>As you see, when the <strong class="source-inline">Product</strong> field is in the view, all three calculations give the same value. This is because the <strong class="source-inline">Min</strong> or <strong class="source-inline">Max</strong> of a <strong class="source-inline">Product</strong> at the <strong class="source-inline">Product</strong> level is the <strong class="source-inline">Product</strong> itself (that is, the <em class="italic">Min or Max for Colombian will be Colombian itself</em>). Similarly, for the <strong class="source-inline">Attribute</strong> function, since there is only one row of <strong class="source-inline">Product</strong> under each <strong class="source-inline">Product</strong>, you get the output as that <strong class="source-inline">Product</strong> itself, and not an <em class="italic">asterisk</em>. However, the minute you remove the granularity of the <strong class="source-inline">Product</strong>, you start getting different results. So, keep in mind that if the dimension being aggregated is in the view, all three of these functions will give the same output.</p>
			<ol>
				<li value="12">Now you have seen the various options for aggregating dimensions, you will now go back and amend your <strong class="source-inline">Concatenated string</strong> calculation. Since you have two dimensions, namely, <strong class="source-inline">Product Type</strong> and <strong class="source-inline">Product</strong>, you must aggregate both. Since both dimensions are in the view, you can use any of the functions discussed. For this, use the <strong class="source-inline">MIN</strong> function. Your formula should update as follows:<p class="source-code">MIN(LEFT(UPPER([Product Type]),3)) + "-" + MIN([Product]) + " : $" + STR(ROUND(SUM([Sales]),0))</p></li>
			</ol>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer553" class="IMG---Figure">
					<img src="image/B16342_07_44.jpg" alt="Figure 7.44: A screenshot showing the error-free calculation of Concatenated string&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.44: A screenshot showing the error-free calculation of Concatenated string</p>
			<ol>
				<li value="13">Click <strong class="source-inline">OK</strong> and go back to the sheet where you created a bar chart showing <strong class="source-inline">Product Type</strong>, <strong class="source-inline">Product</strong>, and <strong class="source-inline">SUM(Sales)</strong>. Drop this new field, which is now found under the <strong class="source-inline">Measures</strong> pane, into the <strong class="source-inline">Rows</strong> shelf just after <strong class="source-inline">Product</strong>. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer554" class="IMG---Figure">
					<img src="image/B16342_07_45.jpg" alt="Figure 7.45 – A screenshot showing the output of the Concatenated string calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.45 – A screenshot showing the output of the Concatenated string calculation</p>
			<p>You have now created and used string functions in Tableau. You created a concatenated string using dimensions and aggregated <strong class="source-inline">Measures</strong>. You saw how to typecast an integer of a float value into a string, and how to aggregate a dimension using either the <strong class="source-inline">MIN</strong>, <strong class="source-inline">MAX</strong>, or <strong class="source-inline">ATTR</strong> functions to get rid of the <strong class="source-inline">Cannot mix aggregate and non-aggregate arguments…</strong> error. Now you know how to manipulate string fields, it is time to explore date functions.</p>
			<h2 id="_idParaDest-213"><a id="_idTextAnchor240"/>Creating and Using Different Types of Calculations: Date Calculations</h2>
			<p>When manipulating <strong class="source-inline">Date</strong> fields, you can use the various <strong class="source-inline">Date</strong> functions supported by Tableau. At this point in time (that is, in version 2020.1), these are as follows:</p>
			<ul>
				<li><strong class="source-inline">DATENAME</strong>, <strong class="source-inline">DATEPART</strong>, <strong class="source-inline">DATETRUNC</strong>, <strong class="source-inline">YEAR</strong>, <strong class="source-inline">QUARTER</strong>, <strong class="source-inline">MONTH</strong>, <strong class="source-inline">WEEK</strong>, <strong class="source-inline">DAY</strong>, <strong class="source-inline">ISOYEAR</strong>, <strong class="source-inline">ISOQUARTER</strong>, <strong class="source-inline">ISOWEEK</strong>, and <strong class="source-inline">ISOWEEKDAY</strong>, which can be used to find the date part of the <strong class="source-inline">Date</strong> field.</li>
				<li><strong class="source-inline">DATEDIFF</strong> and <strong class="source-inline">DATEADD</strong>, used to find the difference between two dates or to generate a new <strong class="source-inline">Date</strong> field based on an incremental interval.</li>
				<li><strong class="source-inline">TODAY</strong> and <strong class="source-inline">NOW</strong>, which give the current date or date and time.</li>
				<li><strong class="source-inline">ISDATE</strong>, used to find out whether a given field is a <strong class="source-inline">Date</strong> field.</li>
			</ul>
			<p>You will now use a <strong class="source-inline">Date</strong> calculation to find out how many months it has been sinc<a id="_idTextAnchor241"/>e your customers last made a purchase.</p>
			<h2 id="_idParaDest-214"><a id="_idTextAnchor242"/>Exercise 7.05: Creating a Date Calculation</h2>
			<p>The objective of this exercise is to create a <strong class="source-inline">Date</strong> calculation to find the number of months since the last purchase for your customers. You will continue using your <strong class="source-inline">Orders</strong> data from <strong class="source-inline">Sample-Superstore.xlsx</strong> and use the <strong class="source-inline">Customer Name</strong> and the <strong class="source-inline">Order Date</strong> fields.</p>
			<p>Perform the following steps:</p>
			<ol>
				<li value="1">Start by dragging <strong class="source-inline">Customer Name</strong> into the Rows shelf. Then, right-click drag and drop the <strong class="source-inline">Order Date</strong> field into the <strong class="source-inline">Rows</strong> shelf, which should create a <strong class="source-inline">Menu</strong>. Select <strong class="source-inline">MDY(Order Date)</strong>. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer555" class="IMG---Figure">
					<img src="image/B16342_07_46.jpg" alt="Figure 7.46: A screenshot showing the right-click drag-drop menu for Order Date&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.46: A screenshot showing the right-click drag-drop menu for Order Date</p>
			<p>Now you can see all order dates at the customer level. There is no point looking at all transactional dates for every customer. You are only interested in the last purchase date, and how many months it has been since it occurred.</p>
			<ol>
				<li value="2">To achieve this, first create a calculation called <strong class="source-inline">Last purchase date</strong> with the following formula:<p class="source-code">MAX([Order Date])</p></li>
			</ol>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer556" class="IMG---Figure">
					<img src="image/B16342_07_47.jpg" alt="Figure 7.47: A screenshot showing the Last purchase date calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.47: A screenshot showing the Last purchase date calculation</p>
			<ol>
				<li value="3">Since this calculation will be computed on the fly, the <strong class="source-inline">Max</strong> date is dependent on the dimensions in the view. If you drag and drop this new field into your <strong class="source-inline">Rows</strong> shelf, you should notice that the values are the same as for the <strong class="source-inline">MDY(Order Date)</strong>. This won't work for you; you want the Max date for each customer, and hence you must remove the <strong class="source-inline">MDY(Order Date)</strong> granularity. This will update your view, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer557" class="IMG---Figure">
					<img src="image/B16342_07_48.jpg" alt="Figure 7.48: A screenshot showing the Last purchase date for each customer&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.48: A screenshot showing the Last purchase date for each customer</p>
			<p>Now you have your <strong class="source-inline">Last purchase date</strong> field, it is time to find out how many months it has been since the customers last made a purchase. This can be achieved by finding the difference between two dates, that is, <strong class="source-inline">Last purchase date</strong> and, ideally, <strong class="source-inline">Today</strong>. However, since your data is not daily-updating, you will consider the end date as December 31, 2019, which is the last date in the data.</p>
			<ol>
				<li value="4">Create a new calculated field called <em class="italic">Months since last purchase</em> and use the following formula:<p class="source-code">DATEDIFF('month', [Last purchase date], #2019-12-31#)</p></li>
			</ol>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer558" class="IMG---Figure">
					<img src="image/B16342_07_49.jpg" alt="Figure 7.49: A screenshot showing the Months since last purchase calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.49: A screenshot showing the Months since last purchase calculation</p>
			<ol>
				<li value="5">After you save this calculation, you can drag it into the <strong class="source-inline">Text</strong> shelf, and should get the desired output. This calculation finds the difference in months between <strong class="source-inline">Last purchase date</strong> and December 31, 2019. A point to remember is that when you need to enter a hardcoded date, it will start and end with a <em class="italic">hash</em> (<strong class="source-inline">#</strong>), as shown above. Further, if this data was daily-updating and you wanted to find the difference with respect to <strong class="source-inline">Today</strong>, that is, the current date, then you could use the <strong class="source-inline">Today()</strong> function, and the calculation would update as shown here:<p class="source-code">DATEDIFF('month', [Last purchase date], Today())</p></li>
			</ol>
			<div>
				<div id="_idContainer559" class="IMG---Figure">
					<img src="image/B16342_07_50.jpg" alt="Figure 7.50: A screenshot showing the final output of the Date calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.50: A screenshot showing the final output of the Date calculation</p>
			<p>In this exercise, you used the <strong class="source-inline">DATEDIFF()</strong> function to find how many months it has been since customers last made a purchase. In the next section, you'll see what to do when the value of data for a product is returned as null. </p>
			<h1 id="_idParaDest-215"><a id="_idTextAnchor243"/>Handling Null Values while Creating and Using Calculations</h1>
			<p>Often, you might deal with data containing null values. These could be genuine entries in the data. For example, there may not be any <strong class="source-inline">Sales</strong> value to report against a particular product—even though it is part of the inventory, it may not have been sold yet. These nulls could also be because of some data entry errors. Most likely, you would identify and take care of these nulls at the data preparation stage. However, that may not always be the case. At times, you may need to tackle them within Tableau Desktop using calculations. Null values tend to pose a problem when used in calculated fields, simply because when doing arithmetic operations on fields, it may result in the output being null in Tableau. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer560" class="IMG---Figure">
					<img src="image/B16342_07_51.jpg" alt="Figure 7.51 – A screenshot showing the Excel data and the output &#13;&#10;of the calculation on fields with null values&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.51 – A screenshot showing the Excel data and the output of the calculation on fields with null values</p>
			<p>The preceding screenshot is a quick mockup to show the Excel data on the left and the Tableau display on the right. You can see that both fields (that is, <strong class="source-inline">Value of Product A</strong> and <strong class="source-inline">Value of Product B</strong>) have <em class="italic">null values</em> in certain months. Now, when you want to find the total value in each month, you add the values of product A and product B. However, since both of these fields have null values in certain months, the calculated field only shows the output for months with values in both columns. For months where either of the values are missing, the calculated field gives null output. This is simply because you can't do math on null values without getting a null output.</p>
			<p>To overcome this, you will use functions such as <strong class="source-inline">ZN</strong>, <strong class="source-inline">IFNULL</strong>, and <strong class="source-inline">ISNULL</strong>.</p>
			<p>The data for this section is available for download using this link: <a href="https://packt.link/k59i9">https://packt.link/k59i9</a>.</p>
			<p>Refer to the <strong class="source-inline">Handling Null Values in Tableau.xlsx</strong> data file for this section. Begin by connecting to this data in Tableau and creating a quick tabular view showing <strong class="source-inline">Month</strong> and <strong class="source-inline">Value of Product A</strong> and <strong class="source-inline">Value of Product B</strong>. Create a calculated field called <strong class="source-inline">Value of Product A + B</strong>. The formula is as follows:</p>
			<p class="source-code">SUM([Value of Product A]) + SUM([Value of Product B])</p>
			<p>Add this calculated field to the view. It should update as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer561" class="IMG---Figure">
					<img src="image/B16342_07_52.jpg" alt="Figure 7.52: A screenshot showing the output of calculation on fields with null values&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.52: A screenshot showing the output of calculation on fields with null values</p>
			<p>As you see, the calculated field needs some tweaking. The best way to handle these null values when doing mathematical operations is to <em class="italic">convert them to zero</em>. You will use either the <strong class="source-inline">ZN</strong>, <strong class="source-inline">IFNULL</strong>, or <strong class="source-inline">ISNULL</strong> function.  </p>
			<p>First, try the <strong class="source-inline">ZN</strong> function. <strong class="source-inline">ZN</strong> stands for <em class="italic">Zero if Null</em>, and that is exactly what this function does; it <em class="italic">replaces the nulls with zero</em>. Since both fields contain null at some point, you need to use the <strong class="source-inline">ZN</strong> function for both fields. Tweak your calculation to use the following formula:</p>
			<p class="source-code">ZN(SUM([Value of Product A])) + ZN(SUM([Value of Product B]))</p>
			<p>Once you update the calculation, your view will update as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer562" class="IMG---Figure">
					<img src="image/B16342_07_53.jpg" alt="Figure 7.53: A screenshot showing the output of the calculated field using the ZN function&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.53: A screenshot showing the output of the calculated field using the ZN function</p>
			<p>You now get values for every single <strong class="source-inline">Month</strong>, despite the <em class="italic">nulls</em> because Tableau is now <em class="italic">converting these nulls to zero</em> before adding them up.</p>
			<p>You will now look at the <strong class="source-inline">IFNULL</strong> function. Amend your calculated field to <em class="italic">comment out</em> the formula using the <strong class="source-inline">ZN</strong> function, and instead use the <strong class="source-inline">IFNULL</strong> formula as follows:</p>
			<p class="source-code">IFNULL(SUM([Value of Product A]),0) + IFNULL(SUM([Value of Product B]),0)</p>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer563" class="IMG---Figure">
					<img src="image/B16342_07_54.jpg" alt="Figure 7.54: A screenshot showing the syntax of the IFNULL function&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.54: A screenshot showing the syntax of the IFNULL function</p>
			<p>Once you click <strong class="source-inline">OK</strong>, you will see that you still get output for each <strong class="source-inline">Month</strong>. The <strong class="source-inline">IFNULL</strong> function returns the expression if it is not null; otherwise, it returns the alternate expression that is defined: zero, in this case.</p>
			<p>Now you understand the <strong class="source-inline">ZN</strong> and the <strong class="source-inline">IFNULL</strong> functions, you will look at the <strong class="source-inline">ISNULL</strong> function. The <strong class="source-inline">ISNULL</strong> function returns <strong class="source-inline">True</strong> if the expression contains a null value; otherwise, it returns <strong class="source-inline">False</strong>. In other words, the <strong class="source-inline">ISNULL</strong> function gives us a <em class="italic">Boolean output as either True or False</em>. If you wish to specify some criteria for when a null condition is <strong class="source-inline">True</strong>, you should use the <strong class="source-inline">ISNULL</strong> function with either a <strong class="source-inline">CASE</strong> statement or an <strong class="source-inline">IF</strong> statement. Edit your existing calculated field to comment out the <strong class="source-inline">IFNULL</strong> formula and use the following formula:</p>
			<p class="source-code">IF ISNULL(SUM([Value of Product A])) THEN 0 ELSE SUM([Value of Product A]) END</p>
			<p class="source-code">+</p>
			<p class="source-code">IF ISNULL(SUM([Value of Product B])) THEN 0 ELSE SUM([Value of Product B]) END </p>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer564" class="IMG---Figure">
					<img src="image/B16342_07_55.jpg" alt="Figure 7.55: A screenshot showing the syntax of the ISNULL function&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.55: A screenshot showing the syntax of the ISNULL function</p>
			<p>Once you click <strong class="source-inline">OK</strong>, you see that you still get output for each <strong class="source-inline">Month</strong>. The <strong class="source-inline">ISNULL</strong> function, when used in the <strong class="source-inline">IF</strong> statement, will return <strong class="source-inline">Zero if it the Null condition is True</strong>; otherwise, it returns the <strong class="source-inline">False condition, which is the field that we have specified</strong>.</p>
			<h1 id="_idParaDest-216"><a id="_idTextAnchor244"/>Creating Calculations across Data Sources</h1>
			<p>In earlier sections of this chapter, you have seen how to create and use calculations, but all these calculations were done within the same data source. Having all your data in one source would be an idealistic scenario; however, that may not always be the case, and you may have to deal with data coming from multiple sources. This means you may have to compute calculations across data sources, too. </p>
			<p>In this section, you will focus on how to create calculations across data sources using data blending. You will also look at how to create and use calculated fields to join data. You have already seen the data blending and join functionality in previous chapters, and you will use that knowledge to create and use calculations across data sources.</p>
			<p>You will use the <strong class="source-inline">Modified CoffeeChain</strong> data along with <strong class="source-inline">Budget Sales for CofeeChain.xlsx</strong>. These can be downloaded at the following links:</p>
			<ul>
				<li><a href="https://packt.link/EK3uu">https://packt.link/EK3uu</a>.</li>
				<li><a href="https://packt.link/Pqpah">https://packt.link/Pqpah</a>.</li>
			</ul>
			<p>Once downloaded, load the files into Tableau Desktop.  Use the <strong class="source-inline">Microsoft Access</strong> option to connect to the <em class="italic">CoffeeChain Query</em> table from the <strong class="source-inline">Modified_CoffeeChain.mdb</strong> data. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer565" class="IMG---Figure">
					<img src="image/B16342_07_56.jpg" alt="Figure 7.56: A screenshot showing the preview of the Modified CoffeeChain data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.56: A screenshot showing the preview of the Modified CoffeeChain data</p>
			<p>Look at this data preview. Notice that the <strong class="source-inline">Date</strong> field is of a <strong class="source-inline">DATETIME</strong> data type, even though the timestamp is 00:00:00. Once you familiarize yourself with this dataset, you will try to get the <strong class="source-inline">Budget</strong> data as well. To achieve this, click on the <strong class="source-inline">Add</strong> button in the left-hand side section of this data connection window and select the <strong class="source-inline">Microsoft Excel</strong> option to select <strong class="source-inline">Budget Sales for CoffeeChain.xlsx</strong>. This should create a cross-database join between the two. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer566" class="IMG---Figure">
					<img src="image/B16342_07_57.jpg" alt="Figure 7.57 – A screenshot showing the preview of a cross-database join&#13;&#10; of CoffeeChain data and Budget Sales&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.57 – A screenshot showing the preview of a cross-database join  of CoffeeChain data and Budget Sales</p>
			<p>Something has gone wrong with the join, indicated by the <em class="italic">red exclamation mark</em> and the lack of data to preview. This is because the <strong class="source-inline">Date</strong> field in the <strong class="source-inline">Access</strong> database is a <strong class="source-inline">DATETIME</strong><em class="italic"> field</em> whereas, the <strong class="source-inline">Date</strong> field in the Excel data is a <strong class="source-inline">DATE</strong><em class="italic"> field</em>. To use the <strong class="source-inline">Date</strong> field as a common linking field between both these datasets, it will have to be of the same data type. So, change the <strong class="source-inline">DATETIME</strong> field to a <strong class="source-inline">DATE</strong> field and then try to enable the join. Changing the datatype could be done in many ways; however, here, you will use the calculation method and will use this calculation to create a join between the two data sources. </p>
			<p>Begin by clicking the <em class="italic">red exclamation mark</em> and then clicking the dropdown under the left column in the window where you are defining the join criteria. Select the <strong class="source-inline">Create Join Calculation...</strong> option. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer567" class="IMG---Figure">
					<img src="image/B16342_07_58.jpg" alt="Figure 7.58: A screenshot showing the Create Join Calculation option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.58: A screenshot showing the Create Join Calculation option</p>
			<p>Type the following formula:</p>
			<p class="source-code">DATE([Date])</p>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer568" class="IMG---Figure">
					<img src="image/B16342_07_59.jpg" alt="Figure 7.59: A screenshot showing the Create Join Calculation formula &#13;&#10;for typecasting the Date field&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.59: A screenshot showing the Create Join Calculation formula for typecasting the Date field</p>
			<p>Since the <strong class="source-inline">Date</strong> field in the Budget Sales data is already a <strong class="source-inline">DATE</strong><em class="italic"> data type</em>, select the <strong class="source-inline">Date (Budget Sale)</strong> field from the dropdown. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer569" class="IMG---Figure">
					<img src="image/B16342_07_60.jpg" alt="Figure 7.60: A screenshot showing the Date field in the Budget Sales data &#13;&#10;being used for joining&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.60: A screenshot showing the Date field in the Budget Sales data being used for joining</p>
			<p>You should see that the <strong class="source-inline">Join</strong> condition is resolved, and your dataset is now ready for use. The output of this join will be a single combined dataset and you can then create other calculations using this combined dataset.</p>
			<p>You will now use a calculation across data sources using data blending, where you first connect to these datasets independently and then combine them on the fly as and when required. </p>
			<p>So, you have the <strong class="source-inline">Modified CoffeeChain</strong> data and <strong class="source-inline">Budget Sales for CoffeeChain</strong> data, and you want to use these independently across your workbook. This won't present issues until you need to get data from both these data sources in one single sheet. For example, imagine you want to find the percentage of a target you have achieved across months of a year. You have the <strong class="source-inline">Sales</strong> field in the <strong class="source-inline">Modified CoffeeChain</strong> data and <strong class="source-inline">Budget Sales</strong> in the <strong class="source-inline">Budget Sales for CoffeeChain</strong> data; to find the percentage of the target achieved across those months, you need to create a new calculated field.  Name this new calculated field <strong class="source-inline">% Target Achieved</strong>. </p>
			<p>Begin by connecting to the <strong class="source-inline">Modified CoffeeChain</strong> data independently and then connect to the <strong class="source-inline">Budget Sales for CoffeeChain</strong> data. You should get two separate data sources in your <strong class="source-inline">Data</strong> pane. Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer570" class="IMG---Figure">
					<img src="image/B16342_07_61.jpg" alt="Figure 7.61: A screenshot showing Budget Sales and Modified CoffeChain &#13;&#10;as separate and independent data sources&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.61: A screenshot showing Budget Sales and Modified CoffeChain as separate and independent data sources</p>
			<p>Once you have both these data sources within Tableau Desktop, drag the <strong class="source-inline">Date</strong> field from the <strong class="source-inline">Modified CoffeeChain</strong> data into the <strong class="source-inline">Rows</strong> shelf, then drop the <strong class="source-inline">Product</strong> field from the same data source into the <strong class="source-inline">Rows</strong> shelf just after <strong class="source-inline">YEAR(Date)</strong>. Next, double-click on <strong class="source-inline">Sales</strong> from the <strong class="source-inline">Measures</strong> pane of the <strong class="source-inline">Modified CoffeeChain</strong> data.   Then click on the <strong class="source-inline">Budget Sales for CoffeeChain</strong> data in the <strong class="source-inline">Data</strong> pane to enable the dimensions and <strong class="source-inline">Measures</strong> for that data source. You should now notice the blending link enabled for the <strong class="source-inline">Date</strong> field, as well as the <strong class="source-inline">Product</strong> field.  Keep these links as is, then double-click the <strong class="source-inline">Budget Sales</strong> field from the <strong class="source-inline">Measures</strong> pane of the <strong class="source-inline">Budget Sales for CoffeeChain</strong> data. The view updates, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer571" class="IMG---Figure">
					<img src="image/B16342_07_62.jpg" alt="Figure 7.62: A screenshot showing the results of data blending&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.62: A screenshot showing the results of data blending</p>
			<p>Now, create a new calculated field called <strong class="source-inline">% Target Achieved</strong> in your <strong class="source-inline">Budget Sales for CoffeeChain</strong> data. Drag the <strong class="source-inline">Sales</strong> field from the <strong class="source-inline">Modified CoffeeChain</strong> data into the calculation box and divide this by <strong class="source-inline">SUM([Budget Sales])</strong>. The formula is as follows:</p>
			<p class="source-code">SUM([Sheet1 (Modified CoffeeChain)].[Sales]) </p>
			<p class="source-code">/</p>
			<p class="source-code">SUM(Budget Sales [Budget Sales])</p>
			<p>Refer to the following screenshot:</p>
			<div>
				<div id="_idContainer572" class="IMG---Figure">
					<img src="image/B16342_07_63.jpg" alt="Figure 7.63: A screenshot showing the formula of the % Target Achieved calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.63: A screenshot showing the formula of the % Target Achieved calculation</p>
			<p>The field <strong class="source-inline">Sales</strong> is shown as <strong class="source-inline">[Sheet1 (Modified CoffeeChain)].[Sales]</strong>, which shows that the field is coming from the <strong class="source-inline">Modified CoffeeChain</strong> data. Click <strong class="source-inline">OK</strong> and save this calculation. Change <strong class="source-inline">Default Properties</strong> to format this new field to show <strong class="source-inline">Percentage with 2 decimals</strong>. This can be done by using the <strong class="source-inline">Default Properties</strong> &gt; <strong class="source-inline">Number Format</strong> option, which is available when right-clicking on the field in the <strong class="source-inline">Measures</strong> pane. Now, drop this new calculated field in the view and your view should update, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer573" class="IMG---Figure">
					<img src="image/B16342_07_64.jpg" alt="Figure 7.64: A screenshot showing the output of the % Target Achieved calculation&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.64: A screenshot showing the output of the % Target Achieved calculation</p>
			<p>As you see in the preceding screenshot, there are some products where the <strong class="source-inline">% Target Achieved</strong> is less than 100%, and there are certain products where the <strong class="source-inline">% Target Achieved</strong> is more than 100%. You have now learned to create calculations across data sources. A point to remember here, is that when you do this, the fields you use always need to be aggregated.</p>
			<p>You will now try some activities based on what you have learned so far.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Now, even though we have tried to cover a lot of the Tableau functions, we still haven't been able to go through all the functions that Tableau has to offer. If you wish to know more about all the functions that Tableau has to offer, then you can look at the following links:</p>
			<p class="callout"><a href="https://help.tableau.com/current/pro/desktop/en-us/functions_all_categories.htm">https://help.tableau.com/current/pro/desktop/en-us/functions_all_categories.htm</a></p>
			<p class="callout"><a href="https://help.tableau.com/current/pro/desktop/en-us/functions_all_alphabetical.htm">https://help.tableau.com/current/pro/desktop/en-us/functions_all_alphabetical.htm</a></p>
			<h2 id="_idParaDest-217"><a id="_idTextAnchor245"/>Activity 7.01: Calculating the Profit Margin</h2>
			<p>As a data analyst, you may encounter a scenario where you are required to compute profit margins using the <strong class="source-inline">Profit and Sales</strong> field and filter this <strong class="source-inline">Profit Margin</strong> below a certain threshold. The aim of this activity is to calculate the <strong class="source-inline">Profit Margin</strong>, which is computed by dividing <strong class="source-inline">Profit</strong> by <strong class="source-inline">Sales</strong>. Once you have the <strong class="source-inline">Profit Margin</strong> computed, you want to filter products and only display the <strong class="source-inline">Profit Margin</strong> for the <strong class="source-inline">Xerox</strong> product. Finally, you want to filter the <strong class="source-inline">Xerox</strong> products, and only look at those where the <strong class="source-inline">Profit Margin</strong> is more than 45%. </p>
			<p>Steps for completion:</p>
			<ol>
				<li value="1">For this activity, use the <strong class="source-inline">Orders</strong> data from the <em class="italic">Sample-Superstore.xlsx</em> file.</li>
				<li>Create a table/tabular view to show <strong class="source-inline">Product Name</strong>, <strong class="source-inline">Profit</strong>, and <strong class="source-inline">Sales</strong>.</li>
				<li>Create a calculated field on <strong class="source-inline">Product Name</strong> to identify the <strong class="source-inline">Xerox</strong> products and group the rest of the products as <strong class="source-inline">Others</strong>.</li>
				<li>Use this new calculated field to filter the table to show only the <strong class="source-inline">Xerox</strong> products.</li>
				<li>Then create another calculated field to compute the <strong class="source-inline">Profit Margin</strong>, which will be derived by dividing the <strong class="source-inline">Profit</strong> values by the <strong class="source-inline">Sales</strong> values.</li>
				<li>Add this new calculated field into the view and make sure to change the number format to show percentages with two decimals.</li>
				<li>Use this new calculated field to filter the view to show the <strong class="source-inline">Profit Margin</strong> above 45% and sort the final output in ascending order of <strong class="source-inline">Profit Margin</strong>. Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer574" class="IMG---Figure">
					<img src="image/B16342_07_65.jpg" alt="Figure 7.65: A screenshot showing the expected output of Activity 7.01&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.65: A screenshot showing the expected output of Activity 7.01</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The solution to this activity can be found here: <a href="https://packt.link/CTCxk">https://packt.link/CTCxk</a>.</p>
			<h2 id="_idParaDest-218"><a id="_idTextAnchor246"/>Activity 7.02: Calculating the Percentage Achievement with Respect to Budget Sales</h2>
			<p>As data analysts, you may often be required to compare actual sales with budgeted sales, to determine performance. In this activity, you will find out what percentage of budget sales targets have been achieved for the year 2012. You will use the <em class="italic">CoffeeChain Query</em> table from the <strong class="source-inline">Sample-Coffee Chain.mdb</strong> dataset. The data can be downloaded from the following link for this activity: <a href="https://1drv.ms/u/s!Av5QCoyLTBpnmkPL8Yx_0_2KtrG4?e=TrYFWQ">https://1drv.ms/u/s!Av5QCoyLTBpnmkPL8Yx_0_2KtrG4?e=TrYFWQ</a>.</p>
			<ol>
				<li value="1">Use the <strong class="source-inline">Sample-Coffee Chain.mdb</strong> data.</li>
				<li>Create a bar chart to show <strong class="source-inline">Sales</strong> across <strong class="source-inline">Products</strong> for the year 2012.</li>
				<li>Create a calculated field to find out the percentage <strong class="source-inline">Achievement of Actual Sales</strong> with respect to the <strong class="source-inline">Budget Sales</strong> for all the <strong class="source-inline">Products</strong> displayed in the view.</li>
				<li>Color code the bars with respect to <strong class="source-inline">% Achievement</strong> in such a way that <strong class="source-inline">Products</strong> with less than 95% <strong class="source-inline">Achievement</strong> are called <strong class="source-inline">&lt;95% of Target achieved</strong> (color-coded orange). Those with more than 100% <strong class="source-inline">Achievement</strong> are called <strong class="source-inline">&gt;100% Target achieved</strong> (color-coded gray).  Those between 95% and 100% <strong class="source-inline">Achievement</strong> are called <strong class="source-inline">Between 95% to 100% Target</strong> achieved (color-coded blue). Refer to the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer575" class="IMG---Figure">
					<img src="image/B16342_07_66.jpg" alt="Figure 7.66: A screenshot showing the expected output of Activity 7.02&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.66: A screenshot showing the expected output of Activity 7.02</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The solution to this activity can be found here: <a href="https://packt.link/CTCxk">https://packt.link/CTCxk</a>. </p>
			<h1 id="_idParaDest-219"><a id="_idTextAnchor247"/>Summary</h1>
			<p>In this chapter, you explored some important aspects involved in creating and using calculations in Tableau and studied the difference between aggregate and non-aggregate fields. You looked at numeric, string, and date calculations, and learned to write logic statements and handle null values. Finally, you looked at how to use these calculations across data sources. </p>
			<p>In upcoming chapters, you will move on to more advanced table and level of detail calculations, which will allow you to do even more with your data.</p>
		</div>
	</body></html>