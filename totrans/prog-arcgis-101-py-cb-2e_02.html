<html><head></head><body>
  <div><div><div><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Writing Basic Geoprocessing Scripts with ArcPy</h1></div></div></div><p>In this chapter, we will cover the following recipes:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Using the ArcGIS Python window</li><li class="listitem" style="list-style-type: disc">Accessing ArcPy with Python</li><li class="listitem" style="list-style-type: disc">Executing tools from a script</li><li class="listitem" style="list-style-type: disc">Using ArcGIS Desktop help</li><li class="listitem" style="list-style-type: disc">Using variables to store data</li><li class="listitem" style="list-style-type: disc">Accessing ArcPy modules with Python</li></ul></div><div><div><div><div><h1 class="title"><a id="ch02lvl1sec12"/>Introduction</h1></div></div></div><p>Geoprocessing tasks <a id="id143" class="indexterm"/>tend to be time consuming and repetitive, and often need to be run on a periodic basis. Frequently, many data layers and functions are involved. The ArcPy Python site package<a id="id144" class="indexterm"/> for ArcGIS provides a set of tools and execution environments that can be used to transform your data into meaningful results. Using scripts you can automate your geoprocessing tasks and schedule them to run when it is most convenient for your organization.</p><p>ArcGIS<a id="id145" class="indexterm"/> provides a geoprocessing framework for the purpose of automating your repetitive GIS tasks through a set of tools and execution environments for these tools. All tools operate on an input dataset, which you supply and transform in some way (depending upon the nature of the tool used) to produce a new output dataset. This new output dataset can then, if necessary, be used as the input dataset to additional geoprocessing tools in a larger workflow for your tasks. There are many tools provided by the ArcGIS geoprocessing framework, each designed to provide specific functionality.</p><p>While there are many different environments that you can use to write your geoprocessing scripts with Python, this book will focus on the use of the built-in ArcGIS Python window<a id="id146" class="indexterm"/> and the Python IDLE editor<a id="id147" class="indexterm"/>.</p></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch02lvl1sec13"/>Using the ArcGIS Python window</h1></div></div></div><p>In this recipe<a id="id148" class="indexterm"/>, you'll learn how to use the ArcGIS Python window. In <a class="link" href="ch01.html" title="Chapter 1. Fundamentals of the Python Language for ArcGIS">Chapter 1</a>, <em>Fundamentals of the Python Language for ArcGIS</em>, you learned how to use the IDLE development environment for Python, so this chapter will give you an alternative for writing your geoprocessing scripts. Either development environment can be used but it is common for people to start writing scripts with the ArcGIS Desktop Python window and then move on to IDLE when scripts become more complex. I should also mention that there are many other development environments that you may want to consider, including PythonWin<a id="id149" class="indexterm"/>, Wingware<a id="id150" class="indexterm"/>, Komodo<a id="id151" class="indexterm"/>, and others. The development environment you choose is really a matter of preference.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec18"/>Getting ready</h2></div></div></div><p>The new Python window is an embedded, interactive Python window in ArcGIS Desktop 10, that is ideal for testing small blocks of code, learning Python basics, building quick and easy workflows, and executing geoprocessing tools. However, as your scripts become more complex, you'll quickly find the need for a more robust development environment. By default, IDLE is installed with ArcGIS Desktop, so this is a logical next choice for many. For new programmers, though, the ArcGIS Python window is a great place to start!</p><p>The ArcGIS Python window has a number of capabilities in addition to being the location for writing your code. You can save the content of the window to a Python script file on a disk or load an existing Python script into the window. The window can be either pinned or floating. While floating, the window can be expanded or contracted as you wish. The window can also be pinned to various parts of the ArcGIS display. You can also format the font and text colors displayed in the window by right-clicking on the window and selecting <strong>Format</strong>.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec19"/>How to do it…</h2></div></div></div><p>The Python window can be opened by clicking on the Python window button on the main ArcGIS Desktop toolbar.</p><div><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">c:\ArcpyBook\Ch2\Crime_Ch2.mxd</code> with ArcMap.<div><div><h3 class="title"><a id="note03"/>Note</h3><p>You don't have to specifically open <code class="literal">Crime_Ch2.mxd</code>. Any map document file can be used with the Python window.</p></div></div></li><li class="listitem">Click on the Python window button from the main <strong>ArcMap</strong> toolbar. The Python window<a id="id152" class="indexterm"/> will be displayed as shown in the following screenshot. This is a floating window, so you can resize as needed and also dock it at various places on the <strong>ArcMap</strong> interface:<div><img src="img/4445_02_1.jpg" alt="How to do it…"/></div><p>The Python window is essentially a shell window that allows you to type in statements one line at a time, just after the line input characters <code class="literal">&gt;&gt;&gt;</code>. On the right-hand side of the divider, you will find a help window.</p></li><li class="listitem">Load an existing script by right-clicking inside the Python window and selecting <strong>Load</strong> from the menu. Navigate to the <code class="literal">c:\ArcpyBook\Ch2</code> directory and select <code class="literal">ListFields.py</code> to load a sample script.<p>You can also format the font and text colors displayed in the window by right-clicking<a id="id153" class="indexterm"/> on the window and selecting <strong>Format</strong>. You will be provided with White and Black themes; you can select fonts and colors individually:</p><div><img src="img/4445_02_10.jpg" alt="How to do it…"/></div></li></ol></div><p>Click on the <strong>Set Black Theme</strong> button to see an example. If you spend a lot of time writing code, you may find that darker themes are easier on your eyes:</p><div><img src="img/4445_02_11.jpg" alt="How to do it…"/></div></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Accessing ArcPy with Python</h1></div></div></div><p>Before you can<a id="id154" class="indexterm"/> take advantage of all the geoprocessing functionality provided by ArcPy, you must first import the package into your script. This <a id="id155" class="indexterm"/>will always be the first line of code in every geoprocessing script that you write.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec20"/>Getting ready</h2></div></div></div><p>ArcPy<a id="id156" class="indexterm"/> is a Python site package that is part of the ArcGIS 10 release, and fully encompasses the functionality provided with the <code class="literal">arcgis scripting</code> module<a id="id157" class="indexterm"/> at ArcGIS 9.2, which further enhances its capabilities. With ArcPy you have access to the geoprocessing tools, extensions, functions, and classes for working with ESRI GIS data.  ArcPy provides code-completion and integrated documentation for the modules, classes, and functions. ArcPy can also be integrated with other Python modules to widen the scope of its capabilities. All ArcGIS geoprocessing scripts<a id="id158" class="indexterm"/> that you write with Python must first provide a reference to ArcPy.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec21"/>How to do it…</h2></div></div></div><p>Follow these steps to import the <code class="literal">arcpy</code> site package into the ArcGIS Python window:</p><div><ol class="orderedlist arabic"><li class="listitem">Open the <code class="literal">c:\ArcpyBook\Ch2\Crime_Ch2.mxd</code> file with ArcMap.</li><li class="listitem">Click on the Python window button to display a shell window where you can write the Python code.</li><li class="listitem">In the Python window, import the <code class="literal">arcpy</code> package and press the <em>Enter</em> key on your keyboard. After each statement that you enter in the Python window, you will press the <em>Enter</em> key. You will include this line of code in every single script that you write, so get used to it! This <code class="literal">import</code> statement is what gives you access to all the functionality provided by ArcPy.<div><div><h3 class="title"><a id="note04"/>Note</h3><p>Technically, you don't have to include the <code class="literal">import arcpy</code> statement when working inside the ArcMap Python window. It's inherent to this window. However, it is required when creating standalone scripts in IDLE, PythonWin, or any other integrated development environment. It's also a good habit to get into as many of your scripts will ultimately be run as standalone scripts.</p></div></div><div><img src="img/4445_02_2.jpg" alt="How to do it…"/></div></li><li class="listitem">ArcPy also provides code-completion functionality that makes your life as a programmer<a id="id159" class="indexterm"/> much easier. On the second line, begin by typing <code class="literal">arcpy</code> and then a dot. ArcPy is an object-oriented<a id="id160" class="indexterm"/> package, which means that you access the properties and methods of an object using the dot notation. Notice that a drop-down list of available items is provided. These are the tools, functions, classes, and extensions that are available on this particular object. All objects have their own associated items, so the list of items presented will differ depending on the object that you have currently selected:<div><img src="img/4445_02_3.jpg" alt="How to do it…"/></div></li><li class="listitem">This is an auto-filtering list, so as you begin typing the name of the tool, function, class, or extension, the list will be filtered by what you have typed:<div><img src="img/4445_02_4.jpg" alt="How to do it…"/></div></li><li class="listitem">You can choose to have the Python window auto-complete the text for you by selecting an item from the list using your mouse or by using the arrow keys <a id="id161" class="indexterm"/>to highlight your choice, and then using the <em>Tab</em> key to enter the command. This auto-completion feature makes you a faster, more efficient programmer. Not only is it easy to use, but it also dramatically cuts down the number of typos in your code.</li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec22"/>How it works…</h2></div></div></div><p>Once the ArcPy module <a id="id162" class="indexterm"/>has been imported, you get access to the geoprocessing tools, extensions, functions, and classes for working with ESRI GIS data. One of the most important aspects of ArcPy is that it provides access to all of the geoprocessing tools available, based on the license level of ArcGIS Desktop currently in use. The tools available to your script will vary depending upon whether you are using the ArcGIS Basic, Standard, or Advanced license level, with the Basic level providing the fewest tools and the Advanced level providing a complete set of tools.</p></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Executing tools from a script</h1></div></div></div><p>As an ArcGIS user,<a id="id163" class="indexterm"/> you have almost certainly used the many available tools in ArcToolbox<a id="id164" class="indexterm"/> to accomplish your geoprocessing tasks. Some examples include Clip, Buffer, Feature Class to Feature Class, <a id="id165" class="indexterm"/>Add Field, and many more. Your scripts can execute any of the tools found in ArcToolbox. Remember that the tools available to you as a programmer are dependent upon the license level of ArcGIS Destkop<a id="id166" class="indexterm"/> that you are using. These tasks can be automated through the creation of a Python script that executes these tools programmatically.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec23"/>How to do it…</h2></div></div></div><div><ol class="orderedlist arabic"><li class="listitem">Follow these steps to learn how to execute a geoprocessing tool from your script. Open c<code class="literal">:\ArcpyBook\Ch2\TravisCounty.mxd</code> with ArcMap.</li><li class="listitem">Open the Python window.</li><li class="listitem">Import the <code class="literal">arcpy</code> package:<div><pre class="programlisting">import arcpy</pre></div></li><li class="listitem">Set the workspace. We haven't discussed the <code class="literal">env</code> class yet. Environment settings for ArcGIS are exposed as properties of this <code class="literal">env</code> class, which is a part of <code class="literal">arcpy</code>. One of the properties of the <code class="literal">env</code> class is workspace, which defines the current working directory for data input and output. In this case, it will be the directory where we'll write the output dataset from our tool:<div><pre class="programlisting">arcpy.env.workspace = "c:/ArcpyBook/data/"</pre></div></li><li class="listitem">We're going to use the <a id="id167" class="indexterm"/><strong>Buffer</strong> tool<a id="id168" class="indexterm"/> from the <strong>Analysis Tools</strong> toolbox to buffer the <strong>Streams</strong> layer <a id="id169" class="indexterm"/>seen in the active data frame in ArcMap. Open ArcToolbox and find this tool, as shown in the following screenshot:<div><img src="img/4445_02_5.jpg" alt="How to do it…"/></div></li><li class="listitem">Double-click on the <strong>Buffer</strong> tool to display the interface shown in the following screenshot. Most tools have one or more input parameters that must be supplied for the tool to execute. Whether you're running the tool from the user interface or from a Python script, you must always supply these required parameters:<div><img src="img/4445_02_6.jpg" alt="How to do it…"/></div></li><li class="listitem">Close the <strong>Buffer</strong> tool.</li><li class="listitem">Execute the <strong>Buffer</strong> tool in the Python window. Use the code-completion feature of<a id="id170" class="indexterm"/> the Python window to help you as well as the tool help displayed in the window on the right. <div><img src="img/4445_02_7.jpg" alt="How to do it…"/></div><p>This will buffer the <strong>Streams</strong> layer by 50 meters to create a new <code class="literal">Streams_Buff</code> polygon layer:</p><div><pre class="programlisting">arcpy.Buffer_analysis("Streams", "Streams_Buff", "50 Meters")</pre></div></li><li class="listitem">Use your ArcMap <strong>zoom</strong> and <strong>pan</strong> tools<a id="id171" class="indexterm"/> to get a better look at the output dataset, as shown in the following screenshot:<div><img src="img/4445_02_8.jpg" alt="How to do it…"/></div></li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec24"/>How it works…</h2></div></div></div><p>All geoprocessing tools<a id="id172" class="indexterm"/> available to your script are defined as dynamic functions from the main <code class="literal">arcpy</code> object. Each tool that you execute from a script must follow a specific syntax that first defines the tool name, followed by an underscore, and then the alias for the toolbox name. In our example, the <strong>Buffer</strong> tool is located in the <strong>Analysis Tools</strong> toolbox<a id="id173" class="indexterm"/>, which has an alias of <code class="literal">analysis</code>. This is done because it is possible for more than one tool to have the same name. A unique reference for each tool is generated using the syntax <code class="literal">&lt;toolname&gt;_&lt;toolbox_alias&gt;</code>.</p><p>Getting the toolbox alias is easy in ArcGIS Desktop. Find the toolbox associated with the tool and right-click on the toolbox name. Select <strong>Properties</strong>. In the <strong>Properties</strong> dialog box that is displayed, find the <strong>Alias</strong> textbox. You will see the following alias when referring to a particular tool in your geoprocessing scripts:</p><div><img src="img/4445_02_12.jpg" alt="How it works…"/></div><p>In addition to the dynamic functions that represent geoprocessing tools, there are many additional functions<a id="id174" class="indexterm"/> available on the <code class="literal">arcpy</code> class that are not geoprocessing tools. Functions for creating cursors, listing datasets, describing datasets, working with environment settings, messaging, and many others are provided. We'll cover many of these functions as we move through the book.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec25"/>There's more…</h2></div></div></div><p>Geoprocessing workflows<a id="id175" class="indexterm"/> often require multiple steps that require the use of one or more geoprocessing tools. You can more efficiently and effectively develop scripts by first creating an outline for your script. This outline will help you consider the task at hand and identify the geoprocessing tools that will be used. Outlines don't have to be complex undertakings. You can simply draw a diagram of the workflow and then implement your code based on this workflow. The point is to do some planning ahead of time before you actually start coding.</p></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Using ArcGIS Desktop help</h1></div></div></div><p>The ArcGIS Desktop help system<a id="id176" class="indexterm"/> is an excellent resource for obtaining information about any available tool. Each tool is described in detail on a unique page. The help system is available through ArcGIS Desktop or online.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec26"/>Getting ready</h2></div></div></div><p>In addition to containing basic descriptive information about each tool, the help system also includes information of interest to Python programmers, including syntax and code examples that provide detailed information about how the tool can be used in your scripts. In this recipe, you will learn how to access the ArcGIS Desktop help system to obtain syntax information and code examples.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec27"/>How to do it...</h2></div></div></div><p>Follow these steps<a id="id177" class="indexterm"/> to learn how to use the ArcGIS Desktop help system to access syntax information about a tool as well as a code example showing how the tool is used in a script.</p><div><ol class="orderedlist arabic"><li class="listitem">If necessary, open ArcMap and select <strong>Help</strong> | <strong>ArcGIS Desktop Help</strong> from the main menu.</li><li class="listitem">Select the <strong>Contents</strong> tab.</li><li class="listitem">Select <strong>Geoprocessing</strong> | <strong>Tool reference</strong>. The tools are grouped according to toolbox just as they are in ArcToolbox.</li><li class="listitem">Select <strong>Analysis toolbox</strong> and then <strong>Proximity toolset</strong>.</li><li class="listitem">Click on the <strong>Buffer</strong> tool. You should see the <strong>Buffer</strong> tool help displayed, as shown in the following screenshot:<div><img src="img/4445_02_13.jpg" alt="How to do it..."/></div></li><li class="listitem">Scroll down<a id="id178" class="indexterm"/> to the <strong>Syntax</strong> section, as shown in the following screenshot:<div><img src="img/4445_02_14.jpg" alt="How to do it..."/></div></li><li class="listitem">This section <a id="id179" class="indexterm"/>defines the syntax for how the tool should be called from your script. In this case, the syntax is as follows:<div><pre class="programlisting">Buffer_analysis (in_features, out_feature_class, buffer_distance_or_field, {line_side}, {line_end_type}, {dissolve_option}, {dissolve_field})</pre></div></li><li class="listitem">Scroll down to the <strong>Code Sample</strong> section. Here, you will find one or more code samples showing you how the tool can be used in your scripts. I always recommend taking a look at these samples before writing your scripts.</li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec28"/>How it works...</h2></div></div></div><p>The help system for each <a id="id180" class="indexterm"/>tool contains several sections including a summary, illustration, usage, syntax, code sample, environments, related topics, and licensing information. As a programmer, you will primarily be interested in the syntax and code sample sections.</p><p>When looking at the syntax section, notice that you call each tool using a combination of the name followed by an underscore and finally the alias for the toolbox where the tool resides. We discussed this briefly in a recipe earlier in this chapter.</p><p>Tools typically accept<a id="id181" class="indexterm"/> one or more parameters, which are passed into the tool inside parentheses. Parameters can be either required or optional. In this case, the <strong>Buffer</strong> tool includes three required parameters: the input feature, an output feature class, and a distance. Required parameters are listed first and are not enclosed by any special characters. Optional parameters, on the other hand, are enclosed by curly braces and will follow any required parameters. The <strong>Buffer</strong> tool contains several optional parameters including the line side, line end type, dissolve option, and dissolve field. Notice that each of these parameters is enclosed by curly braces. You do not have to include these parameters when calling a tool for it to execute.</p><p>You should also examine the syntax information in greater detail to determine the data-type that should be passed in for each parameter. For example, the <code class="literal">buffer_distance_or_field</code> parameter<a id="id182" class="indexterm"/> can accept a data-type that is either a linear unit or a field. Therefore, you can supply a numeric value for this parameter or a <code class="literal">Field</code> object that represents an attribute field containing distance information.</p><p>Always review the syntax for each tool before using it in your code to make sure that you have the right parameters in the right order and of the right data type.</p><p>I recommend taking a look at the code samples as well since they will frequently give you a starting point for your script. Often you will find that you can copy and paste at least a portion of the sample into your own script and then alter the script to suit your needs. This can make you a more efficient programmer and for learning purposes it is helpful to take a look at other scripts and examine the script line-by-line to determine how the script works.</p></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch02lvl1sec17"/>Using variables to store data</h1></div></div></div><p>In <a class="link" href="ch01.html" title="Chapter 1. Fundamentals of the Python Language for ArcGIS">Chapter 1</a>, <em>Fundamentals of the Python Language for ArcGIS</em>, we covered the topic of variables, so you <a id="id183" class="indexterm"/>should have a basic understanding of these structures. Variables are given a name and assigned a data value in your scripts. These named <a id="id184" class="indexterm"/>variables occupy space in your computer's memory and the data contained within these structures can change while a script is running. After the script has finished the memory space occupied by these variables is then released and can be used for other operations.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec29"/>Getting ready</h2></div></div></div><p>When writing geoprocessing scripts with Python there will be many times when you will need to create variables to hold data of one type or another. This data can then be used in your script as <a id="id185" class="indexterm"/>input parameters for tools and functions, as intermediate<a id="id186" class="indexterm"/> data for internal processing, to hold paths to datasets, and for other reasons. In addition, many of the ArcPy functions and tools also return data that can be stored in a variable for further use in your script. In this recipe, you will learn the basic techniques for creating variables and assigning data to them.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec30"/>How to do it...</h2></div></div></div><p>Follow these steps to create a script that contains variables that are hardcoded with values and that are returned from a function:</p><div><ol class="orderedlist arabic"><li class="listitem">Open IDLE and create a new script window.</li><li class="listitem">Save the script to <code class="literal">c:\ArcpyBook\Ch2\WorkingWithVariables.py</code>.</li><li class="listitem">Import the <code class="literal">arcpy</code> package:<div><pre class="programlisting">import arcpy</pre></div></li><li class="listitem">Create a variable called <code class="literal">path</code> and assign a value to it:<div><pre class="programlisting">path = "c:/ArcpyBook/data"</pre></div></li><li class="listitem">Use the newly-created variable to set the workspace:<div><pre class="programlisting">arcpy.env.workspace = path</pre></div></li><li class="listitem">Call the <code class="literal">ListFields()</code> function<a id="id187" class="indexterm"/> and assign the returned value to a new variable called <code class="literal">fields</code>:<div><pre class="programlisting">fields = arcpy.ListFields("Building_Permits.shp")</pre></div></li><li class="listitem">Start a <code class="literal">for</code> loop to process each of the field objects contained within the <code class="literal">fields</code> variable:<div><pre class="programlisting">for fld in fields:</pre></div></li><li class="listitem">Print the name of each field:<div><pre class="programlisting">print fld.name</pre></div></li><li class="listitem">The entire script should appear as follows:<div><pre class="programlisting">import arcpy
path = "c:/ArcpyBook/data"

arcpy.env.workspace = path
fields = arcpy.ListFields("Building_Permits.shp")
for fld in fields:
       print fld.name</pre></div></li><li class="listitem">Save the script.</li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec31"/>How it works...</h2></div></div></div><p>We created three<a id="id188" class="indexterm"/> variables in this script. The first variable, <code class="literal">path</code>, was created and assigned a hard-coded value with a data path. This is an example of a literal variable, meaning that they literally mean exactly what they say. They are distinguished from variables, whose values are not directly determined by their name. The second variable, <code class="literal">fields</code>, is created from the returned value of the <code class="literal">ListFields()</code> function and is a Python <code class="literal">list</code> object containing one or more <code class="literal">Field</code> objects. Each <code class="literal">Field</code> represents a field from the attribute table of a feature class or a standalone table. The final variable is a dynamic variable called <code class="literal">fld</code>. As the <code class="literal">for</code> loop cycles through the list returned by the <code class="literal">ListFields()</code> function, each <code class="literal">Field</code> is assigned to the <code class="literal">fld</code> variable. The name of each field is then printed to the screen.</p></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Accessing ArcPy modules with Python</h1></div></div></div><p>Up to this point, <a id="id189" class="indexterm"/>we have covered some basic concepts related to ArcPy. In addition to the basic ArcPy site package, there are a number of modules that you can use to access specific functionality. These modules must be specifically imported into your scripts before you can use the functionality provided. In this recipe, you will learn how to import these modules.</p><div><div><div><div><h2 class="title"><a id="ch02lvl2sec32"/>Getting ready</h2></div></div></div><p>In addition to <a id="id190" class="indexterm"/>
<a id="id191" class="indexterm"/>
<a id="id192" class="indexterm"/>
<a id="id193" class="indexterm"/>
<a id="id194" class="indexterm"/>providing access to tools, functions, and classes, ArcPy also provides several modules. <strong>Modules</strong>
<a id="id195" class="indexterm"/> are purpose-specific Python libraries containing functions and classes. The modules include a Mapping module<a id="id196" class="indexterm"/> (<code class="literal">arcpy.mapping</code>), <a id="id197" class="indexterm"/>a Data Access module<a id="id198" class="indexterm"/> (<code class="literal">arcpy.da</code>), <a id="id199" class="indexterm"/>a Spatial Analyst module<a id="id200" class="indexterm"/> (<code class="literal">arcpy.sa</code>), a <a id="id201" class="indexterm"/>Geostatistical module<a id="id202" class="indexterm"/> (<code class="literal">arcpy.ga</code>), a <a id="id203" class="indexterm"/>Network Analyst module<a id="id204" class="indexterm"/> (<code class="literal">arcpy.na</code>), and a Time module<a id="id205" class="indexterm"/> (<code class="literal">arcpy.time</code>). <a id="id206" class="indexterm"/>To use the functions and classes included with each of these modules you must specifically import their associated libraries.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec33"/>How to do it…</h2></div></div></div><p>Follow these steps to learn how to use the functions and classes provided by the <code class="literal">arcpy.mapping</code> module<a id="id207" class="indexterm"/>:</p><div><ol class="orderedlist arabic"><li class="listitem">Open <code class="literal">c:\ArcpyBook\Ch2\Crime_Ch2.mxd</code> with ArcMap.</li><li class="listitem">Open the Python window.</li><li class="listitem">Import the <code class="literal">arcpy.mapping</code> module:<div><pre class="programlisting">import arcpy.mapping as mapping</pre></div></li><li class="listitem">Get a reference to the current map document (<code class="literal">Crime_Ch2.mxd</code>):<div><pre class="programlisting">mxd = mapping.MapDocument("CURRENT")</pre></div></li><li class="listitem">Call the <code class="literal">arcpy.mapping.ListLayers</code> function<a id="id208" class="indexterm"/>:<div><pre class="programlisting">print mapping.ListLayers(mxd)</pre></div><p>This will return a list of all layers in the map document and print these to the shell window:</p><div><pre class="programlisting">
<strong>[&lt;map layer u'City of Austin Bldg Permits'&gt;, &lt;map layer u'Hospitals'&gt;, &lt;map layer u'Schools'&gt;, &lt;map layer u'Streams'&gt;, &lt;map layer u'Streets'&gt;, &lt;map layer u'Streams_Buff'&gt;, &lt;map layer u'Floodplains'&gt;, &lt;map layer u'2000 Census Tracts'&gt;, &lt;map layer u'City Limits'&gt;, &lt;map layer u'Travis County'&gt;]</strong>
</pre></div></li></ol></div><p>Access to all the <a id="id209" class="indexterm"/>functions and objects available in the Mapping module is done in the same way.</p></div><div><div><div><div><h2 class="title"><a id="ch02lvl2sec34"/>How it works…</h2></div></div></div><p>Each of the modules provided by ArcPy gives access to functionality that fills a specific purpose. For example, the ArcPy Mapping module provides access to functions that allow you to manage map documents and layer files. The functions and objects in this module all relate in some way to managing these files.</p></div></div></div>
</body></html>