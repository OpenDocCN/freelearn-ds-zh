<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Understanding Simple Calculations in Tableau</h1>
                </header>
            
            <article>
                
<p>In the previous chapters, you have learned much about visualizing data in various forms in Tableau. It is common to have cases where the data you want to visualize is not directly present in your dataset but can easily be obtained by applying transformations on the dataset or even aggregating the data in the dataset. For example, you may have the full address for a <span>placed </span><span>order, and you want to obtain only the country or city where the order came from. Alternatively, you may have data for each individual sale and you want to know the average of all sales. This and the subsequent two chapters will focus on calculations and how you can use these to answer such questions. This chapter will introduce calculations and cover simple calculations, while the next two will look at more advanced calculations.</span></p>
<p><span>The following topics will be covered in this chapter:</span></p>
<ul>
<li>Calculation basics</li>
<li>Creating calculations and understanding their components</li>
<li>Building arithmetic calculations</li>
<li>Building string calculations</li>
<li>Building date calculations</li>
<li>Building logical statements</li>
<li>Building grand totals and subtotals</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>This chapter uses the following dataset:</p>
<ul>
<li>The Global Superstore dataset, which can be found at <a href="http://www.tableau.com/sites/default/files/training/global_superstore.zip">http://www.tableau.com/sites/default/files/training/global_superstore.zip</a>.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Calculation basics</h1>
                </header>
            
            <article>
                
<p>Calculations allow us to obtain more data points from the existing dataset and allow us to enhance our visualizations and analysis. Creating calculations in Tableau enables you to analyze data on the fly, without having to create overheads by transforming your original datasets every time you have a new idea about how you can analyze your data even further.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">When to use calculations</h1>
                </header>
            
            <article>
                
<p>Before we dive into calculations and how to create them, it is equally important to understand when to create calculations. Some examples of when calculations are useful are as follows:</p>
<ul>
<li><strong>Changing datatypes</strong>: For example, you have data that is being represented as a string value.</li>
<li><strong>Performing mathematical calculations</strong>: For example, you want to divide two fields to obtain ratios or percentages or subtract fields.</li>
<li><strong>To create logical groupings/labels</strong>: For example, if you want to group people in those who can drive or not, you can create a calculation saying: if you are older than 18 and have a valid driving license, you can drive.</li>
<li><strong>To create new fields from existing data</strong>: For example, you want to create a country field by extracting a part of the address or a new date field from another date field.</li>
<li><strong>Aggregating data</strong>: For example, you want to view the sum, average, and median of distribution or subtotals and totals at the country and city levels for sales.</li>
</ul>
<p>Now that we understand when to use calculations, we can discuss the three types of calculations available in Tableau.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Types of calculations</h1>
                </header>
            
            <article>
                
<ul>
<li><strong>Simple calculations</strong>: These calculations allow you to create new fields at either the same level of granularity as your dataset (row-level) or aggregate data at the granularity of the visual.</li>
<li><strong>Level Of Detail (LOD) expressions</strong>: LOD calculations are an extension of simple calculations but allow you to have more control over the granularity of the data you are working on. You have options to work to specify a FIXED level of granularity or INCLUDE data fields to the visualization granularity or EXCLUDE them.</li>
<li><strong>Table calculations</strong>: Table calculations only work at the level of granularity of the visuals. These allow you to build calculations at visual levels of top of your existing data or simple calculations.</li>
</ul>
<div class="packt_tip">The type of calculation you require will depend on the use case of your problem. If you already have all of the data you want to answer the questions, then you need table calculations. If you do not have all of the data you need, but the data needed will be at the same granularity as your dataset, you will need a basic calculation. Otherwise, it will be a LOD calculation.</div>
<p>Do not worry if you are a bit confused about the types of calculations. We will cover each type in detail in separate chapters. This chapter will cover simple calculations in detail while the next two will cover the other two calculation types. So, let's look at how to create simple calculations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating calculations</h1>
                </header>
            
            <article>
                
<p>To create a calculation, click on <strong>Analysis</strong> | <strong>Create Calculated Field</strong>. Alternatively, you can scroll to the end of dimensions/measures tabs and right-click in the white space there.</p>
<p>You should see the following calculations window:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1216 image-border" src="assets/14c57d5b-0278-4d24-a661-b18a0da00be4.png" style="width:37.25em;height:26.42em;"/></p>
<p>The top of the window, where it says <kbd>Calculation1</kbd>, is where you enter the name of your calculated field. The blank area underneath is where you enter your calculation. To the right side, you have a list of all of the available functions you can use and their syntax to quickly help you out. The tiny triangle icon to the right of the calculation editor can be used to toggle the functions window in/out.</p>
<p>Let's create a very simple calculation to see what our total profit would be if the average profit increased four times, and name this calculation <kbd>4x Profit</kbd>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1217 image-border" src="assets/2154dc36-c4f1-4c5e-941f-30dd72111f41.png" style="width:36.67em;height:21.17em;"/></p>
<p>You will see, at the bottom of the calculation, the message: <strong>The calculation is valid</strong>. This means we can now click <strong>OK</strong> and the field will be created. The error checker in Tableau quickly displays error messages below if the calculation is invalid, allowing for easy troubleshooting.</p>
<p>Once you click <strong>OK</strong>, you will notice the field appears under <strong>Measures</strong>. Now, you can use this calculation as you would any other measure. Let's use it to show the results per <strong>Segment</strong>:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1218 image-border" src="assets/a29046db-8ca1-4507-9b62-a4153a30226a.png" style="width:24.00em;height:21.00em;"/></p>
<p>Like the previously discussed calculation, all calculations in Tableau can be a combination of six basic elements. These elements are described in the following table:</p>
<table style="width: 100%;border-collapse: collapse" border="1">
<tbody>
<tr>
<td style="width: 10%">
<p><strong>Components</strong></p>
</td>
<td style="width: 66.8926%">
<p><strong>Description</strong></p>
</td>
<td style="width: 20.1074%">
<p><strong>Example</strong></p>
</td>
</tr>
<tr>
<td style="width: 10%">
<p>Functions</p>
</td>
<td style="width: 66.8926%">
<p>Functions are used to transform the values or members of a field. There are many types of functions available in Tableau such as <kbd>Number</kbd>, <kbd>String</kbd>, <kbd>Date</kbd>, and <kbd>User</kbd>. Different functions have different syntax, inputs/data type expected, and so on.</p>
</td>
<td style="width: 20.1074%">
<p>In our example, <kbd>AVG()</kbd> was an example of a function.</p>
</td>
</tr>
<tr>
<td style="width: 10%">
<p>Fields</p>
</td>
<td style="width: 66.8926%">
<p>Fields represent the dimensions or measures (columns) from our data source.</p>
</td>
<td style="width: 20.1074%">
<p><kbd>[Profit]</kbd> was the field used by us.</p>
</td>
</tr>
<tr>
<td style="width: 10%">
<p>Operators</p>
</td>
<td style="width: 66.8926%">
<p>Operators are symbols that denote some kind of operation. Operators can be one of the following: +, -, *, /, %, ==, =, &gt;, &lt;, &gt;=, &lt;=, !=, &lt;&gt;, ^, AND, OR, NOT, and ( ).</p>
</td>
<td style="width: 20.1074%">
<p>* in our example was the operator.</p>
</td>
</tr>
<tr>
<td style="width: 10%">
<p>Literal expressions</p>
</td>
<td style="width: 66.8926%">
<p>These are constant values that do not change. These can be either Numeric, String, Date, Boolean, or Null.</p>
</td>
<td style="width: 20.1074%">
<p>4 was the literal used by us.</p>
</td>
</tr>
<tr>
<td style="width: 10%">
<p>Parameters</p>
</td>
<td style="width: 66.8926%">
<p>Parameters, as we know, are dynamic values that can replace literals. These too can be used in the calculations.</p>
</td>
<td style="width: 20.1074%"/>
</tr>
<tr>
<td style="width: 10%">
<p>Comments</p>
</td>
<td style="width: 66.8926%">
<p>Comments are simple descriptions that you can add to the calculation fields. These are informational only and do not affect the actual calculation. The <kbd>//</kbd> <span>symbols</span><span> </span><span>are used to add comments.</span></p>
</td>
<td style="width: 20.1074%">
<p>We didn't add a comment to our example, but we could have added something like <kbd>// To create 4 times profit value</kbd>.</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>Using the preceding combination of six elements, all calculations are created. Now that we understand the components better, we can look at the syntax of each component in detail in the following sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Functions syntax</h1>
                </header>
            
            <article>
                
<p>There are many types of functions available in Tableau, such as <kbd>Number</kbd>, <kbd>String</kbd>, <kbd>Date</kbd>, and <kbd>User</kbd>. Different functions have different syntax and require different inputs for them to work. The list of all of the functions available to you in Tableau is available in the side tab of the calculated field window. Select <kbd>AVG()</kbd> from the functions list. Once you select any function, you will see three elements in the help window:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1219 image-border" src="assets/bfbd0dcc-45fd-4a84-a6f7-52ee74cf4010.png" style="width:20.33em;height:23.00em;"/></p>
<p>These elements are as follows:</p>
<ul>
<li>Syntax of the function: For <kbd>AVG</kbd>, it shows <strong>AVG(expression)</strong>, meaning that, to obtain the average, you need to write AVG(expression here).</li>
<li>Explanation: Below the syntax, there is an explanation of what the function does.</li>
<li>Example: This is an example of how the function can be used.</li>
</ul>
<div class="packt_tip">If you are unsure of how to use a function, copy and paste the example, and then replace the fields in it with your own fields. This ensures that the syntax remains correct.</div>
<p>You can use more than one function in a calculation and even nest them inside one another as long as they meet the syntax requirements. We will learn about some of the common types of functions later in this chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Fields syntax</h1>
                </header>
            
            <article>
                
<p>Fields are the columns in the data (and can be calculated fields too). A field should always be surrounded by square brackets, <kbd>[]</kbd>, if they contain spaces or are not unique in name. It is best practice to surround fields with <kbd>[]</kbd>. Fields are shown in orange in Tableau. You can drag and drop the field directly into the calculation from the <strong>Dimension</strong> or <strong>Measures</strong> tabs. Alternatively, you can start typing the field name and Tableau will show you options to autocomplete fields, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1220 image-border" src="assets/29da1d43-a473-4afe-9c49-f80356ab1984.png" style="width:12.83em;height:18.33em;"/></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Operator syntax</h1>
                </header>
            
            <article>
                
<p>Operators are symbols that denote some kind of operation. Operators can be of the following types:</p>
<ul>
<li>Mathematical operators: Mathematical operators are used for performing mathematical calculations. The operators are as follows: 
<ul>
<li><strong>+ (plus)</strong>: Plus can be used for addition (numeric and date fields) and string concatenation. For example, <kbd>4+2</kbd> will return <kbd>6</kbd> while <kbd>Abc</kbd> + <kbd>Def</kbd> will return <kbd>AbcDef</kbd>. We can use addition for dates as well, for example, adding <kbd>#23-04-2019#+4</kbd> will give <kbd>#27-04-2019#</kbd>.</li>
<li><strong>- (minus)</strong><span><span>: Minus can be used for the subtraction of dates and numeric fields, in a similar way to the + operator.</span></span></li>
<li><strong>* (multiplication)</strong> and <strong>/ (division)</strong><span>: This is used to multiply or divide numeric fields.</span></li>
<li><strong>% (modulo)</strong><span>: This returns the remainder of a division operator, for example, </span><kbd>5%2=1</kbd>.</li>
<li><strong>^ (power/exponent):</strong> <span>This returns the exponent value, for example,</span> <kbd>2^3 =8</kbd>.</li>
</ul>
</li>
<li>Relational operators: These are used for comparing expressions and return <kbd>TRUE</kbd>, <kbd>FALSE</kbd>, or <kbd>NULL</kbd> values. Each operator can be used to compare numbers, dates, or strings. The operators are as follows:
<ul>
<li><strong>== or = (equals)</strong></li>
<li><strong>&gt; ( greater than) </strong></li>
<li><strong>&lt; (less than)</strong></li>
<li><strong>&gt;= (greater than or equal to)</strong></li>
<li><strong>&lt;= (less than or equal to)</strong></li>
<li><strong>!=</strong> <span>and</span> <strong>&lt;&gt; (not equal to)</strong></li>
</ul>
</li>
<li>Logical operators: Logical operators compare both sides of the expression and return <kbd>TRUE</kbd>, <kbd>FALSE</kbd>, or <kbd>NULL</kbd> values. The logical operators are as follows: 
<ul>
<li><strong>AND</strong>: If both expression 1 and expression 2 are <kbd>TRUE</kbd>, then it returns <kbd>TRUE</kbd>; otherwise, it returns <kbd>FALSE</kbd>. If any of the expressions are <kbd>NULL</kbd>, then it returns <kbd>NULL</kbd>. <kbd>AND</kbd> follows the following rules for output:</li>
</ul>
</li>
</ul>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>Expression 1</strong></p>
</td>
<td>
<p><strong>Expression 2</strong></p>
</td>
<td>
<p><strong>Output</strong></p>
</td>
</tr>
<tr>
<td style="width: 103.2px">
<p><kbd>TRUE</kbd></p>
</td>
<td style="width: 103.2px">
<p><kbd>TRUE</kbd></p>
</td>
<td style="width: 103.2px">
<p><kbd>TRUE</kbd></p>
</td>
</tr>
<tr>
<td style="width: 103.2px">
<p><kbd>TRUE</kbd></p>
</td>
<td style="width: 103.2px">
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
<td style="width: 103.2px">
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
</tr>
<tr>
<td style="width: 103.2px">
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
<td style="width: 103.2px">
<p><kbd>TRUE</kbd></p>
</td>
<td style="width: 103.2px">
<p class="CDPAlignLeft CDPAlign"><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
</tr>
<tr>
<td style="width: 103.2px">
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
<td style="width: 103.2px">
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
<td style="width: 103.2px">
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>OR:</strong> <kbd>OR</kbd> returns <kbd>FALSE</kbd> only if both the expressions are <kbd>FALSE</kbd>; otherwise, it will return <kbd>TRUE</kbd>. It returns <kbd>NULL</kbd> only if both values are <kbd>NULL</kbd>. It follows the following rules for output:</li>
</ul>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>Expression 1</strong></p>
</td>
<td>
<p><strong>Expression 2</strong></p>
</td>
<td>
<p><strong>Output</strong></p>
</td>
</tr>
<tr>
<td>
<p><kbd>TRUE</kbd></p>
</td>
<td>
<p><kbd>TRUE</kbd></p>
</td>
<td>
<p><kbd>TRUE</kbd></p>
</td>
</tr>
<tr>
<td>
<p><kbd>TRUE</kbd></p>
</td>
<td>
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
<td>
<p><kbd>TRUE</kbd></p>
</td>
</tr>
<tr>
<td>
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
<td>
<p><kbd>TRUE</kbd></p>
</td>
<td>
<p><kbd>TRUE</kbd></p>
</td>
</tr>
<tr>
<td>
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
<td>
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
<td>
<p><kbd>FALSE</kbd>/<kbd>NULL</kbd></p>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>NOT:</strong> <kbd>NOT</kbd> is used to negate other Booleans or expressions. It follows the following rules of output:</li>
</ul>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>Expression 1</strong></p>
</td>
<td>
<p><strong>Expression 2</strong></p>
</td>
</tr>
<tr>
<td>
<p><kbd>TRUE</kbd></p>
</td>
<td>
<p><kbd>FALSE</kbd></p>
</td>
</tr>
<tr>
<td>
<p><kbd>FALSE</kbd></p>
</td>
<td>
<p><kbd>TRUE</kbd></p>
</td>
</tr>
</tbody>
</table>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Order of precedence of operators</h1>
                </header>
            
            <article>
                
<p>The operators get evaluated in the following order of precedence:</p>
<ol>
<li><kbd>–</kbd> (negate)</li>
<li><kbd>^</kbd> (power)</li>
<li><kbd>*</kbd>, <kbd>/</kbd>, <kbd>%</kbd></li>
<li><kbd>+</kbd>, <kbd>–</kbd></li>
<li><kbd>==</kbd>, <kbd>&gt;</kbd>, <kbd>&lt;</kbd>, <kbd>&gt;=</kbd>, <kbd>&lt;=</kbd>, <kbd>!=</kbd></li>
<li><kbd>NOT</kbd></li>
<li><kbd>AND</kbd></li>
<li><kbd>OR</kbd></li>
</ol>
<p>To change the order of precedence, we can use the final operator called parentheses, <kbd>()</kbd>. If you put something in parentheses, it gets executed first. If there are nested parentheses, then the innermost gets executed first and so on, f<span><span>or example, if we had the following expression to get evaluated: </span></span><kbd>(1+2*5) = 11 , (1+(2*5)/2) = (1+10/2) =6</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Literal expressions syntax</h1>
                </header>
            
            <article>
                
<p>Literal expressions are constant values that are represented as is. Literals are of the following types:</p>
<ul>
<li><strong>Numeric literals</strong>: Numbers or floats such as <kbd>4.2</kbd> and <kbd>2</kbd> </li>
<li><strong>String literals</strong>: Constant strings such as <kbd>Hello</kbd></li>
<li><strong>Date literals</strong>: Represent dates as constants, such as <kbd>#20-05-2019#</kbd></li>
<li><strong>Boolean literals</strong>: Represent Boolean values of <kbd>TRUE</kbd> or <kbd>FALSE</kbd></li>
<li><strong>Null literals</strong>: Used to assign or compare against <kbd>NULL</kbd></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Parameter syntax</h1>
                </header>
            
            <article>
                
<p>Parameters are simply placeholder variables. Parameters are represented with the color purple in Tableau. They can represent numbers, floats, strings, date/date-time values, or Booleans.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Comments syntax</h1>
                </header>
            
            <article>
                
<p>Comments are represented using <kbd>//</kbd>. To add multiline comments, add <kbd>//</kbd> in every line.</p>
<p>Now that we understand all about the basic elements of what constitutes calculated fields and how to create them, let's dive into some calculations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Building arithmetic calculations</h1>
                </header>
            
            <article>
                
<p>To work with arithmetic calculations in Tableau, we can either use operators as discussed in the last section, work with one of the many <strong>number functions</strong> that are present, or make use of some of the <strong>aggregation options</strong>. This section will cover some of the important functions but it is not an exhaustive list. The <em>Further reading</em> section contains links to an A-Z list of functions maintained by Tableau. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Aggregation options</h1>
                </header>
            
            <article>
                
<p>Aggregation options define how your data values are combined or aggregated. Simple aggregation works at the level of visual granularity.</p>
<p>What this means is the data is aggregated at the level of the dimensions in the visual. Without even studying it, we have used this logic in the previous chapters when we created visuals. Whenever we wanted to see the total <strong>SUM(Sales)</strong>, we would only bring the <strong>SUM(Sales)</strong> measure to our visual window. However, if we wanted to see the sales per segment, we would add the <strong>Segment</strong> dimension to our window and our sales would split up, as can be seen in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1221 image-border" src="assets/2754ca91-c279-4005-8160-28ab086f57c9.png" style="width:52.42em;height:25.08em;"/></p>
<p class="CDPAlignLeft CDPAlign">This same principle works with all the aggregations. To see the aggregation levels available, right-click on the measured field, select <strong>Measure</strong> (aggregation level) and it will show you what other options are available. For example, by right-clicking on the <strong>SUM(Sales)</strong> measure field, the following aggregation levels are available:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1222 image-border" src="assets/1933a496-7590-44a0-a4e9-9d507129ac4c.png" style="width:25.58em;height:26.92em;"/></p>
<p>Similarly, if you want to use a dimension field to represent a measure value, you can bring it into the visual and right-click and select <strong>Measure</strong>, and then it will show the aggregation options available for the dimension.</p>
<p>Assuming a column in our dataset looks like <kbd>1, 1, 1, 2, 2, 3, 4</kbd>, the various aggregation options and their results are as follows:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>Sum</strong></p>
</td>
<td>
<p>This adds the measure values, calculated by adding values = <kbd>1+1+1+2+2+3+4 = 14</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Average</strong></p>
</td>
<td>
<p>This is the average of the measure values, calculated by adding values divided by the count of values = <kbd>14/7 = 2</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Median</strong></p>
</td>
<td>
<p>This is the central value = <kbd>2</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Count</strong></p>
</td>
<td>
<p>This simply counts the number of elements = <kbd>7</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Count</strong> <strong>(Distinct)</strong></p>
</td>
<td>
<p>This is the count of distinct values, so no same value is counted more than once = <kbd>4</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Minimum</strong></p>
</td>
<td>
<p>This the least value = <kbd>1</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Maximum</strong></p>
</td>
<td>
<p>This is the highest value = <kbd>4</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Percentile</strong></p>
</td>
<td>
<p>This shows what percentage of the values are less than this value. It has further options to look at the 5, 10, 25, 50, 75, 90, and 95 percentiles. Here, the 25<sup>th</sup> percentile would be 1, the 75<sup>th</sup> percentile would be 3, and so on.</p>
</td>
</tr>
<tr>
<td>
<p><strong>Standard Deviation</strong>, <strong>Standard Deviation(Pop)</strong></p>
</td>
<td>
<p>Standard deviation defines how much of the members are differing from the mean value. If you have an entire dataset, use the standard deviation population; if it is a sample, then use standard deviation. <strong>Standard deviation (Pop) </strong>= <kbd>1.07</kbd></p>
</td>
</tr>
<tr>
<td>
<p><strong>Variance</strong>, <strong>Variance (Pop)</strong></p>
</td>
<td>
<p>Variance is the square of standard deviation, so depending on population or sample, we use variance = <kbd>1.14</kbd> for this case.</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>The aggregations calculated in Tableau are sent back to the databases for querying. So, the general rule of thumb is if the database doesn't support a particular aggregation, Tableau will not be able to support it either. However, if you create extracts of the same data, then the aggregation will be supported.</p>
<p>As an exercise, look at all of the aggregation options for the <kbd>Profit</kbd> <span>measure</span><span> </span><span>and the </span><kbd>Customer Name</kbd><span> </span><span>dimension</span><span>.</span></p>
<p>By simply using a combination of the preceding aggregation options and operators, many important calculations can be done. For example, <kbd>Cost</kbd> can be determined as <kbd>[Sales]-[Profit]</kbd>. Then, the average cost can be found with <kbd>AVG(Cost)</kbd>.</p>
<p>We can also calculate the <kbd>Profit to Sales</kbd> ratio as <kbd>SUM(Profit)/SUM(Sales)</kbd>. This will show up in decimals. To see it as a percentage, one way would be to multiply the calculation by 100. However, this will not show the <kbd>%</kbd> sign. To show the percentage sign, we need to format the results as a percentage. To do this, right-click on <strong>Measure</strong> and select <strong>Format</strong>. A side window will appear. Here, under <strong>Default</strong>, click on <strong>Numbers</strong> and then <strong>Percentage</strong>.</p>
<p>You can also include other things such as a suffix/prefix by using custom options. Once you are happy, you can close the side window.</p>
<p>Beyond the aggregations and operator use, we can look at other number functions available. They can be logically grouped into the following categories:</p>
<p><strong>Trigonometric functions</strong>: These include the following:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="width: 11.4325%">
<p><kbd>PI</kbd></p>
</td>
<td style="width: 87.741%">
<p>This returns the numeric constant value for pi, as 3.141592…., up to 16 decimal places. <kbd>PI()</kbd> is generally used within other trigonometric functions to specify the angles in radians.</p>
</td>
</tr>
<tr>
<td style="width: 11.4325%">
<p><kbd>SIN</kbd></p>
</td>
<td style="width: 87.741%">
<p>This returns the sine of an angle. The angle must be specified in radians, for example, <kbd>SIN(-PI()/4) =-0.7071</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 11.4325%">
<p><kbd>ASIN</kbd></p>
</td>
<td style="width: 87.741%">
<p>This returns the arc sine of a number in radians. This is the inverse of <kbd>SIN</kbd>, for example, <kbd>ASIN(-0.7071)=-0.7854</kbd> (which is <em>-pi/4</em>).</p>
</td>
</tr>
<tr>
<td style="width: 11.4325%">
<p><kbd><span>ATAN2</span></kbd></p>
</td>
<td style="width: 87.741%">
<p><span>This takes the two coordinate positions </span><em>y</em><span> and </span><em>x</em><span> as input and returns the </span>arc<span> tangent of two numbers in radians, for example, </span><kbd>ATAN2(1,1) = 0.7854 i.e pi/4</kbd></p>
</td>
</tr>
<tr>
<td style="width: 11.4325%">
<p><kbd><span>DEGREE</span></kbd></p>
</td>
<td style="width: 87.741%">This converts radians into degrees, so <kbd>DEGREE(0.7854) =45</kbd>..</td>
</tr>
</tbody>
</table>
<p> </p>
<p class="mce-root">** The<span> COS, ACOS, TAN, ATAN, and COT functions are similar to SIN and ASIN.</span></p>
<p><strong>Logarithmic and exponential functions</strong>: <span>These include the following:</span></p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="width: 13.7548%">
<p><kbd>EXP</kbd></p>
</td>
<td style="width: 84.2452%">
<p>This returns <em>e</em> raised to the power of a number, for example, <kbd>EXP(2) = e^2</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 13.7548%">
<p><kbd>LN</kbd></p>
</td>
<td style="width: 84.2452%">
<p>This returns the natural logarithm of the number. The value is null for all zero and negative values, for example, <kbd>LN(2) = 0.69</kbd> or <kbd>LN(EXP(2))=2</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 13.7548%">
<p><kbd>LOG</kbd></p>
</td>
<td style="width: 84.2452%">
<p>This returns a logarithmic value to the base of another number. If no base is specified, then it returns a logarithmic value to the base of 100, for example, <kbd>LOG(1000) = 3</kbd> and <kbd>LOG( 4,2) = 2</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 13.7548%">
<p><kbd>POWER</kbd></p>
</td>
<td style="width: 84.2452%">
<p>This returns a value to the power of another, for example, <kbd>POWER (2,3) =2^3= 8</kbd>.</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p><strong>Other mathematical functions</strong>: <span>These include the following:</span></p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td style="width: 15.7025%">
<p><kbd>SQUARE</kbd></p>
</td>
<td style="width: 83.4711%">
<p>This returns the square of a number and is equivalent to <kbd>Power (number, 2)</kbd>, for example, <kbd>SQUARE(5) = 25</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>SQRT</kbd></p>
</td>
<td style="width: 83.4711%">
<p>This returns the square root of a number and is equivalent to <kbd>Power (number, 0.5)</kbd>, for example, <kbd>SQRT(25) =5</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>ABS</kbd></p>
</td>
<td style="width: 83.4711%">
<p>This returns the absolute value of a number, for example, <kbd>ABS(-7) =7</kbd>. It's very useful when you work with quantities or deviations where the actual values are more important than the sign of the numbers.</p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>CEILING</kbd></p>
</td>
<td style="width: 83.4711%">
<p>This rounds a number to the nearest integer greater or equal to the number. This is useful when doing capacity planning kind of problems, for example, if you had to assign resources to a project to get work completed and the result was <kbd>3.2</kbd>. If you simply round the number, your result would be <kbd>3</kbd>. But you actually have more work, so it makes more sense to have four resources than three and plan based on that, for example, <kbd>CEILING(3.2) = 4</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>FLOOR</kbd></p>
</td>
<td style="width: 83.4711%">
<p><kbd>FLOOR</kbd> does the reverse of <kbd>CEILING</kbd>. It returns the greatest integer smaller or equal to the given number, for example, <kbd>FLOOR(3.2) =3</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>ROUND</kbd></p>
</td>
<td style="width: 83.4711%">
<p>This rounds the number to the nearest integer or the specified decimal values, for example, <kbd>ROUND (3.2)=3</kbd>, <kbd>ROUND(3.7) = 4</kbd>, and <kbd>ROUND(3.1421,2) = 3.14</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>SIGN</kbd></p>
</td>
<td style="width: 83.4711%">
<p>This returns the sign of the number, 1 if positive, 0 if zero, and -1 if negative, for example, <kbd>SIGN(-3)=-1</kbd> and <kbd>SIGN(4) =1</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>ZN</kbd></p>
</td>
<td style="width: 83.4711%">
<p>This returns the expression if it is not null; otherwise, it will return 0. This is useful if we want to calculate averages, without ignoring <kbd>NULL</kbd> or to display 0s instead of nulls. </p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>DIV</kbd></p>
</td>
<td style="width: 83.4711%">
<p>This returns the quotient of a division operation, for example, <kbd>DIV(7,2) =3</kbd>.</p>
</td>
</tr>
<tr>
<td style="width: 15.7025%">
<p><kbd>HEXBINX</kbd>, <kbd>HEXBINY</kbd></p>
</td>
<td style="width: 83.4711%"><span>Both of these functions are used to map an <em>x</em>, <em>y</em> coordinate to the nearest hexagonal bin. <kbd>HENBINX</kbd> maps to the nearest <em>x </em>coordinate while <kbd>HEXBINY</kbd> maps the nearest <em>y </em>coordinate. The bins have side length 1, so the inputs need to be scaled accordingly. </span></td>
</tr>
</tbody>
</table>
<p> </p>
<p>Now that we are familiar with the various aggregation options and number functions that can be used to create numeric calculations, let's move on to the next section where we will learn about string calculations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Building string calculations</h1>
                </header>
            
            <article>
                
<p>Similar to numeric calculations, many string functions exist to allow for various calculations. Let's look at some of the key string calculations and how they can be used.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Functions related to obtaining substrings from a string</h1>
                </header>
            
            <article>
                
<p>One of the most common use cases when dealing with strings is that we want only parts of the string and not all. Many functions help us to do that. Let's have a look at what functions we can use. </p>
<p><kbd>LEFT</kbd>: This follows the syntax <kbd>LEFT (string, num_chars)</kbd>.</p>
<p>Using <span><kbd>LEFT</kbd>, </span>the <kbd>num_chars</kbd> specified starting from the start of a string is returned. This becomes very useful for grouping.</p>
<p>For example, we want to find the customers who have ordered the most, based on what letter their name starts with. We could create a calculation as follows: <kbd>LEFT([Customer Name,1)</kbd>. This will return only the first character of the string. We can then use this and count the number of orders to clearly see which category ordered the most:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1223 image-border" src="assets/4b5a7abc-05f4-48b0-818c-8fbcd7ee0068.png" style="width:39.58em;height:27.33em;"/></p>
<p><kbd>RIGHT</kbd>: This follows the syntax <kbd>RIGHT(string, num_chars)</kbd>.</p>
<p>Using <span><kbd>RIGHT</kbd>,</span> the <kbd>num_chars</kbd> specified starting from the end of a string is returned.</p>
<p>Similar to the first example, if you wanted to find the last letter of the names of the people who ordered, you would use <kbd>RIGHT([Customer Name,1).</kbd></p>
<p><kbd>MID</kbd>: This follows the syntax <kbd>MID (string, start, [length])</kbd>.</p>
<p>It returns the characters from <kbd>string</kbd>, starting from the position specified by the start value. The first character of the string has the starting position of 1. <kbd>length</kbd> is optional to specify, and if it is specified, it will return up to that many characters.</p>
<p>Look at the following example:</p>
<pre>MID("Hello",2) = ello<br/>MID("Hello",2,3) = ell</pre>
<p><kbd>SPLIT</kbd>: This follows the syntax <kbd>SPLIT (string, delimiter, token number)</kbd>.</p>
<p>Sometimes, we don't know the exact position we want to create a substring from but might have a delimiter to specify it.</p>
<p>For example, in our dataset, we have a customer full name, so what if we only wanted to obtain the first name? We know the names are in the format of <strong>First Name</strong> followed by space character and then <strong>Middle</strong> + <strong>Last</strong> <strong>Name</strong>. So, our delimiter is <kbd>" "</kbd>. Based on the delimiter, your string is divided into equal tokens.</p>
<p>For example, if the string was <kbd>Alex Young</kbd>, your string would be broken by the delimiter into two strings. Token 1 would be <kbd>Alex</kbd>, and Token 2 would be <kbd>Young</kbd>. So, <kbd>SPLIT<span>("Alex Young", " ",1)</span></kbd> would return <kbd>Alex</kbd>, while <kbd>SPLIT ("Alex Young"," ",2)</kbd> would return <kbd>Young</kbd>. If you use negative numbers, it counts from the right in a string. So, <kbd>SPLIT("Alex Young"," ", -1)</kbd> would be <kbd>Young</kbd>, and <kbd><span>SPLIT ("Alex Young"," ",-2)</span></kbd> would be <kbd>Alex</kbd>.</p>
<p>Now, back to our example—if we wanted to find the <strong>First Name</strong> of our customers, we would create a calculation as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1224 image-border" src="assets/abe84fbe-c819-4809-b979-1fae83f4e336.png" style="width:49.92em;height:21.25em;"/></p>
<p>Now, we count the people with that as their first names, to find the most popular names, as shown here:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1225 image-border" src="assets/596825ed-0941-487d-98f8-abb5882193b5.png" style="width:30.83em;height:25.33em;"/></p>
<p><span><span>This first logical subset of string functions allows us to obtain substrings from a string. In the next section, we shall learn about functions that deal with the position of occurrence or existence of a substring within a string.</span></span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Functions related to finding a substring within a string</h1>
                </header>
            
            <article>
                
<p>Sometimes, we don't want to obtain substrings, but just check whether certain substrings exist in strings or even obtain their position of occurrence. For this, the following functions are useful:</p>
<ul>
<li><kbd>CONTAINS</kbd>:<span> </span>This follows the syntax <kbd>CONTAINS(string, substring)</kbd>. <span><kbd>CONTAINS</kbd> </span>returns true if the string contains the substring within it, for example, <kbd>CONTAINS("Tableau", "Table") = TRUE</kbd>. For example, to find how many people have names containing the letter <kbd>E</kbd>, we can then create the calculation as <kbd>CONTAINS([Customer Name],"e")</kbd> and see the count of <kbd>TRUE</kbd>.</li>
<li><kbd>ENDSWITH</kbd>:<strong><span> </span></strong>This follows the syntax <kbd>ENDSWITH(string, substring)</kbd>. This returns true if the string ends with the substring provided, and trailing white spaces are ignored, for example, <kbd>ENDSWITH("hello", <span>"</span>lo")=TRUE</kbd>.</li>
<li><kbd>FIND</kbd>: <span>This f</span>ollows the syntax <kbd>FIND (string, substring, [start])</kbd>. It will return the position of the string within a substring. If a start position is specified, then it starts searching for the substring after the start position. For example, <kbd>FIND("hello",<span>"</span>lo")</kbd> would return <kbd>4</kbd>.</li>
<li><kbd>FINDNTH</kbd>:<strong><span> </span></strong>This follows the syntax <kbd>FINDNTH(string, substring, occurrence)</kbd> and returns the <em>n</em><sup>th</sup> position of the <em>n</em><sup>th</sup><span> </span>occurrence of a substring with a string. For example, if a string is <kbd>abcabcabc</kbd> and we want to find the third occurrence of <kbd>abc</kbd> in the string, we would find it using <kbd>FINDNTH("abcabcabc".<span>"</span>abc",3)</kbd>. It will return <kbd>7</kbd>.</li>
<li><kbd>STARTSWITH</kbd>:<span> T</span>his follows the syntax <kbd>STARTSWITH(string, substring)</kbd>, similar to <kbd>ENDSWITH</kbd>. This displays true if the string starts with the other substring, for example, <kbd>STARTSWITH("hello",<span>"</span>he")=TRUE</kbd>.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Functions related to formatting/standardizing a string</h1>
                </header>
            
            <article>
                
<p>Often, strings do not all follow a consistent format. There could be leading or trailing spaces in strings or them having different cases. All of these will lead to the strings to be considered distinct and separate. For example, if there was a string called <kbd>book</kbd> and another string called <kbd>BOOK</kbd>, they would be considered different. Using the following functions, we can standardize the string in our dataset:</p>
<ul>
<li><kbd>LOWER</kbd>:<span> </span>This follows the syntax <kbd>LOWER(string)</kbd>. It will return the string in all lowercase, for example, <kbd>LOWER("Book") = book</kbd>.</li>
<li><kbd>UPPER</kbd>: This follows the syntax <kbd>UPPER(string)</kbd>. It will return the strings in all uppercase, for example, <kbd>UPPER("Book")= BOOK</kbd>.</li>
<li><kbd>TRIM</kbd>:<span> </span>This follows the syntax <kbd>TRIM(string)</kbd> and removes both leading and trailing spaces from a string, for example, <kbd>TRIM("    Book    ") = Book</kbd>.</li>
</ul>
<p>Similar to <kbd>TRIM</kbd>, there are <kbd>LTRIM</kbd> and <kbd>RTRIM</kbd>, which follow the same syntax but only remove spaces from the left of the string or the right of the string.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Other important string functions</h1>
                </header>
            
            <article>
                
<ul>
<li><kbd>LEN</kbd>: This follows the syntax <kbd>LEN(string)</kbd>. Length is used to find the number of characters in a string. It counts the number of spaces as a character within a string. For example, <kbd>LEN("Hi There")</kbd> <span>is 8: 2 for</span> <kbd>Hi</kbd><span>, 1 for space, and 5 for</span> <kbd>There</kbd><span>.</span></li>
<li><kbd>REPLACE</kbd>: This follows the syntax <kbd>REPLACE(string, substring, replacement)</kbd>. <kbd>REPLACE</kbd> is used to replace every occurrence of the substring in a string with the replacement, for example, to replace occurrences of special characters such as <kbd>/</kbd> or <kbd>'</kbd> in the string, such as <kbd>Replace([Customer Name],"/","")</kbd>.</li>
</ul>
<p>Another example would be if someone changed their name. You could replace their name with the new one. Let's replace Aaron Bergman's name with <kbd>Aaron B</kbd>. Create a new calculation using <kbd>REPLACE</kbd> as follows: <kbd>REPLACE([Customer Name], "Aaron Bergman", "Aaron B")</kbd>. The result of this calculation can be seen in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1226 image-border" src="assets/390e1bee-9ce8-4c9a-beff-7a6a87442834.png" style="width:21.00em;height:10.92em;"/></p>
<p>Now that we have made ourselves familiar with the important string calculations, let's look at date calculations in the next section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Building date calculations</h1>
                </header>
            
            <article>
                
<p>Date calculations allow us to perform operations on dates, such as adding or subtracting dates and obtaining parts of dates. Let's look at some of the key functions in the following sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Obtaining the current date/time</h1>
                </header>
            
            <article>
                
<p><kbd>Today()</kbd> returns the current date in Tableau and <kbd>NOW()</kbd> can be used to return the current date-time. A common use case of this is to find the time taken between an event occurrence and today.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Obtaining parts of a date</h1>
                </header>
            
            <article>
                
<ul>
<li><kbd>DAY()</kbd>, <kbd>MONTH()</kbd> and <kbd>YEAR()</kbd>: The<span>y s</span><span>hare the syntax of function (date). </span>They <span>can be used for obtaining the day, month, and year part of the date as integers respectively</span><span>. </span>For example, <kbd>DAY(#24-05-2019#)</kbd> <span>returns <kbd>24</kbd>.</span></li>
<li><kbd>DATEPART</kbd>:<strong><span> </span></strong>It follows the syntax: <kbd>DATEPART(date_part,date,[start_of_week])</kbd>. If the start of the week is not mentioned, then it is determined based on the start day defined in the data source. For example, <kbd>DATEPART(week,#24-05-2019#)</kbd> <span>returns <kbd>21</kbd>.</span></li>
<li><kbd>DATENAME</kbd>:<strong><span> </span></strong>The syntax remains the same as <kbd>DATENAME</kbd> as <kbd>DATEPART(date_part,date,[start_of_week])</kbd>. It is very similar to <kbd>DATEPART</kbd><span>. The key difference is that it will return the values as a string. </span>For example, <kbd>DATENAME("month",#24-05-2019#)</kbd> <span>returns <kbd>May</kbd>.</span></li>
<li><kbd>DATETRUNC</kbd>: <span>T</span><span>he syntax is the same as <kbd>DATEPART</kbd> and <kbd>DATENAME</kbd>, as follows: <kbd>DATETRUNC(date_part, date,[start_of_week])</kbd>. </span>It allows us to not just obtain a <kbd>date_part</kbd> but rather truncate the date to that <kbd>date_part</kbd>. The syntax is the same as <kbd>DATEPART</kbd> <span>and</span> <kbd>DATENAME</kbd>, <span>as follows:</span> <kbd>DATETRUNC(date_part, date,[start_of_week])</kbd><span>. </span>For example, <kbd>DATETRUNC("month",#24-05-2019#)</kbd> <span>returns <kbd>01-05-2019 00:00:00</kbd></span>.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Other date calculations</h1>
                </header>
            
            <article>
                
<ul>
<li><kbd>ISDATE</kbd>: This follows the syntax <kbd>ISDATE(string)</kbd>. It returns <kbd>TRUE</kbd> if the string is a date otherwise, it returns <kbd>FALSE</kbd>, for example, <kbd>ISDATE("24-05-2019")= TRUE</kbd>.</li>
<li><kbd>DATEPARSE</kbd>: This follows the syntax <kbd>DATEPARSE(format, string)</kbd>. It is used to convert a string into <kbd>DATE</kbd> in the format specified. For example, <kbd>DATEPARSE("dd-MM-yyyy","24-05-2019)</kbd> <span><span>returns <kbd>24-05-2019</kbd> as a date.</span></span></li>
<li><kbd>DATEADD</kbd>: This follows the syntax <kbd>DATEADD(date_part, interval, date)</kbd>. It adds the interval to <kbd>date_part</kbd> specified of the date. <kbd>DATEADD</kbd> is one of the most commonly used date functions.</li>
</ul>
<p>Suppose there was an issue in the system and all of the order dates captured were wrong. They were actually a month before they are showing in the calculation. To get the right order dates, we create a calculation for <kbd>Correct Order Date</kbd> as <kbd>DATEADD("month",-1,[Order Date])</kbd>. <span><span>Now, if we place the dates next to each other, we will obtain the following:</span></span></p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1227 image-border" src="assets/e09da0b5-97f8-403b-95c9-1dd43e761607.png" style="width:32.42em;height:35.67em;"/></p>
<ul>
<li><kbd>DATEDIFF</kbd>:<strong> </strong>This follows the syntax <kbd>DATEDIFF(date_part, start_date,end_date,[start_of_week])</kbd>. It returns the difference between the two dates in terms of the units of <kbd>date_part</kbd>. For example, if we wanted to calculate the time to ship orders after they are ordered in months, we can calculate <kbd>Shipping Time</kbd> <span>as</span> <kbd>DATEDIFF("month", [Order Date],[Ship Date])</kbd>. <span>Once created, if we look at the total time spent in months across all shipping categories, we get the following:</span></li>
</ul>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1228 image-border" src="assets/4e1898db-aedb-4bb5-90c6-207558a0a6cf.png" style="width:48.50em;height:12.42em;"/></p>
<p>As you can see, same-day delivery is super-fast, so even after combining all of the orders, shipping only took 2 months. On the other hand, 4,489 months was spent in shipping orders by standard class.</p>
<p>In the past few sections, we have covered numeric, string, and date calculations. In the next section, we will focus on building logical statements. Logical statements work with numbers, strings, and dates and can be used in combination with the calculations we have learned so far. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Building logical statements</h1>
                </header>
            
            <article>
                
<p>Logical functions allow you to check conditions and see whether they are true or false. We will take a look at the various categories of logical functions over the coming sections.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Case statements</h1>
                </header>
            
            <article>
                
<p>Case statements make use of the following syntax: <kbd>CASE &lt;expression&gt; WHEN &lt;value1&gt; THEN &lt;return1&gt; WHEN &lt;value2&gt; THEN &lt;return2&gt; ... ELSE &lt;default return&gt; END</kbd>.</p>
<p>In case statements, the value of the expression is matched to each of the values and whenever a match is found, the return value corresponding to it is returned. If no value matches the expression, then the default else value is returned. If there is no default value, null values will be returned.</p>
<p>Case statements are very useful when you have to compare the same expression against multiple values. An example would be if we wanted to assign numbers to some of the markets. We can create a calculation as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1229 image-border" src="assets/a5a1ed5e-f31e-46f5-872f-b25501705a18.png" style="width:23.75em;height:14.00em;"/></p>
<p>Now, if we place both <span class="packt_screen">Market</span> and <span class="packt_screen">Market Number</span> next to one another, we can see the groups:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1230 image-border" src="assets/a77c50cb-7172-4988-b529-9e79847920c5.png" style="width:20.33em;height:20.25em;"/></p>
<p> As an independent exercise, create a case statement giving each day of the week a number.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">IF statement</h1>
                </header>
            
            <article>
                
<p>An IF statement has the following syntax: <kbd>IF &lt;expr&gt; THEN &lt;then&gt; [ELSEIF &lt;expr2&gt; THEN &lt;then2&gt;...] [ELSE &lt;else&gt;] END</kbd>.</p>
<p>Using an <kbd>IF</kbd> statement, we can test a series of conditions, and based on whether the condition is true, the values are returned; <span><span>otherwise, </span></span>the next condition is tested. This continues until no condition is true, in which case, the default condition's value is represented; otherwise, it is returned. If there is no default condition, then null is returned.</p>
<p>Within <kbd>IF</kbd> statements, multiple conditions can also be combined using <kbd>OR</kbd> and <kbd>AND</kbd> operators.</p>
<p>For example, if we wanted to group sales into categories of high, medium, and low, we could create a calculation such as the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1231 image-border" src="assets/1e0c8024-46df-42fe-aa0d-4934d877f743.png" style="width:33.42em;height:17.83em;"/></p>
<p>Here, you can see we have grouped any sales that are greater than 0 and less than 1,000 dollars as being in the category of low, anything up to 2,000 dollars is medium, from 2,000-10,000 is high, and all other values we assume are potential errors, either from the sales value being too high or being under 0, which we might need to recheck.</p>
<p>Now, counting the number of order IDs by each <strong>Sales Group</strong>, we can see that the bulk of the orders are for the <strong>Low</strong> category, followed by the <strong>High</strong> category, and there are only five potential error cases, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1232 image-border" src="assets/8c4b3983-6726-4654-9ea4-7358e8b6f37a.png" style="width:30.75em;height:22.83em;"/></p>
<p>As an exercise, create similar calculations for the profit ranges.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">IIF</h1>
                </header>
            
            <article>
                
<p><kbd>IIF</kbd> is similar to <span><span><kbd>IF</kbd> </span></span>for one condition. It follows the syntax: <kbd>IIF(test, then, else, [unknown])</kbd>. Here, it will test a condition and if the condition is true, the statement returns the then value; otherwise, it returns the else value. If the else value is not specified, <kbd>NULL</kbd> will be returned, for example, <kbd>IIF([Sales]&gt;0,"Valid","Invalid")</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">IFNULL and ISNULL</h1>
                </header>
            
            <article>
                
<p> Both <kbd>IFNULL</kbd> and <kbd>ISNULL</kbd> are used to test whether an expression is null or not.</p>
<p><strong>IFNULL</strong>: It follows the syntax: <kbd>IFNULL(expr1,expr2)</kbd>, and it returns expression 1 if the value is null and expression 2 if it is not. For example, <kbd>IFNULL([Sales],0)</kbd> will return the value of <kbd>Sales</kbd> where it is not null, else return 0.</p>
<p><strong>ISNULL</strong>: <kbd>ISNULL</kbd> follows the syntax: <kbd>ISNULL(expr)</kbd>. It returns <kbd>TRUE</kbd> if the expression is <kbd>NULL</kbd>. For example, <kbd>ISNULL([Sales])</kbd> will return true if <kbd>Sales</kbd> is null.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Other functions</h1>
                </header>
            
            <article>
                
<p>Beyond the functions discussed so far, there are some other important functions that are useful and available in Tableau. One of those is the type conversion functions. Type conversion functions are useful for converting one data type into another, for example, from an integer into a string or from a float into an integer.</p>
<p>All of the following functions follow the common syntax of <kbd>Function(expression)</kbd>:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><kbd>DATE</kbd></p>
</td>
<td>
<p>It is used to obtain a date from numbers or strings or date expressions, for example, <kbd>DATE("25/05/2019")</kbd> returns <kbd>#25-05-2019#</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>DATETIME</kbd></p>
</td>
<td>
<p>Very similar to <kbd>DATE</kbd>, this function returns the date and time, for example, <kbd>DATETIME("25 May 2019 13:40:00")</kbd> returns <kbd>#25-05-2019 13:40:00#</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>FLOAT</kbd></p>
</td>
<td>
<p>This is used to cast to floating-point numbers, for example, <kbd>FLOAT(2)=2.000</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>INT</kbd></p>
</td>
<td>
<p>This is used to cast its argument to integers, for example <kbd>INT("22")=22</kbd> or <kbd>INT(22.2)=22</kbd>.</p>
</td>
</tr>
<tr>
<td>
<p><kbd>STR</kbd></p>
</td>
<td>
<p>This is used to cast values to a string, for example, <kbd>STR(22)</kbd> results in a string, <kbd>22</kbd>.</p>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p><span>For example, if there is number field <kbd>12</kbd> and another number field, <kbd>22</kbd></span>, <span>and we want to obtain the concatenated field <kbd>1222</kbd>, we can convert them into strings and back into numbers as <kbd>INT( (STR(12)+STR(22))</kbd> and it will return <kbd>1222</kbd> as a number. </span>Type conversions can help many times when we need to create complex calculations and need the output of one field to be in the correct format to be the input of another.</p>
<p>User functions are another set of useful Tableau functions. These are useful to create row-level filters and security to limit the fields that are visible if your dashboard is published to Tableau Online or Server. Tableau also allows for some regular expression functionalities in functions such as <kbd>REGEXP_MATCH</kbd> or <kbd>REGEXP_EXTRACT</kbd>, which can be used to create some advanced string matching. Also, in the next chapter, we will study some advanced table calculation functions that haven't been discussed so far.</p>
<p>One last thing we will discuss in this chapter will be totals and subtotals and how they can be used.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Building grand totals and subtotals</h1>
                </header>
            
            <article>
                
<p>Beyond showing the values from calculations, sometimes, we also want to show the values of the totals or subtotals in the same window as these values.</p>
<p>For instance, we have the following graph for <span class="packt_screen">SUM(Sales)</span> split by <span class="packt_screen">Category</span> and <span class="packt_screen">Sub-Category</span> across segments:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1233 image-border" src="assets/61d70d88-a643-4f54-9b81-2b630fd05756.png" style="width:43.25em;height:32.92em;"/></p>
<p>Now, if we want to add the subtotals and the grand totals for both rows and columns, we can do the following:</p>
<ol>
<li>Go to <strong>Analysis</strong> &gt; <strong>Totals</strong>.</li>
<li>Select <span class="packt_screen">Show Row Totals | Show Column Totals</span>. This will show the graph as follows:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1234 image-border" src="assets/8f31b197-3b98-4a23-a315-2f98a7f8f769.png" style="width:37.17em;height:36.58em;"/></p>
<ol start="3">
<li>Now if we want to see the subtotals too, we can select <strong>Add All Subtotals</strong> from <span class="packt_screen">Analysis | Tools</span>. This will show the following:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1235 image-border" src="assets/8f29d18d-1f37-4483-b521-3d6475698c23.png" style="width:45.67em;height:37.50em;"/></p>
<p>If there is more than one dimension for which the subtotals are being calculated, then we can right-click on the dimensions to select or unselect, depending on whether we want the totals to be calculated or not.</p>
<p>For example, adding city to the previous and adding all subtotals creates the following:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1236 image-border" src="assets/c7d6ebcc-5732-46a2-81b0-b2cddb6dfdc7.png" style="width:55.42em;height:39.08em;"/></p>
<p>Now, if we do not want to see the subtotals at the level of <span class="packt_screen">Categories</span>, then right-click on <span class="packt_screen">Category</span> in the <span class="packt_screen">Rows</span> shelf and uncheck <span class="packt_screen">Subtotals</span>, as shown in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-1237 image-border" src="assets/573c7b54-98d5-4c4a-940e-066e3e267868.png" style="width:22.50em;height:25.42em;"/></p>
<p>This will remove the subtotals from the level of <span class="packt_screen">Category</span>. Another way to create totals and subtotals is to use the <strong>Analytics Window | Totals.</strong></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we have learned how to create simple calculations. We looked at the format and syntax requirements for the various elements of calculations. Following that, we looked in detail at some of the important functions and examples of number, string, date, and logical functions. Lastly, we also learned how to add totals and subtotals to our calculations. In the next chapter, we will learn about more advanced table calculations, where we will use the results of the calculations learned in this chapter to build on further calculations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<p>To look at a list of all available functions in Tableau, go to the following link: <a href="https://help.tableau.com/current/pro/desktop/en-us/functions_all_categories.htm">https://help.tableau.com/current/pro/desktop/en-us/functions_all_categories.htm</a>.</p>


            </article>

            
        </section>
    </body></html>