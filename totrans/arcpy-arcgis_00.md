# 前言

**ArcGIS**，来自行业领导者ESRI的GIS软件，允许分析和展示地理空间数据。

将Python集成到ArcGIS中使得ArcPy模块成为GIS学生和专业人士的重要工具。ArcPy模块提供了一种强大的方式来提高进行地理空间分析时的生产力。从基本的Python脚本编写到高级的ArcPy方法和属性，ArcPy和其他Python模块将提高任何GIS工作流程的速度和可重复性。

本书将指导您从基本的Python脚本编写到高级脚本工具。它专注于地理空间分析脚本编写，并涉及自动化地图输出。到本书结束时，您将能够创建可重用模块，将可重复分析作为脚本工具添加到ArcToolbox中，并自动导出地图。通过将GIS的耗时性质从几天减少到几小时，一位GIS专业人士可以变得像整个团队一样强大。

# 本书涵盖内容

[第1章](ch01.html "第1章. ArcGIS的Python简介"), *ArcGIS的Python简介*，快速介绍了Python的基础知识，包括编程语言的其他用途。它涵盖了Python数据类型和本书中使用的的重要模块。

[第2章](ch02.html "第2章. 配置Python环境"), *配置Python环境*，介绍了Python的工作原理：其文件夹结构、可执行文件和模块。它还解释了将模块导入脚本、内置模块，并涵盖了集成开发环境（IDE），这些是强大的编程辅助工具。

[第3章](ch03.html "第3章. 编写第一个Python脚本"), *编写第一个Python脚本*，展示了如何使用ArcGIS ModelBuilder来建模第一个分析，然后将其导出为Python脚本。还介绍了字符串操作以及如何在Python中使用文件路径。

[第4章](ch04.html "第4章. 复杂的ArcPy脚本和泛化函数"), *复杂的ArcPy脚本和泛化函数*，探讨了如何执行分析并生成使用ModelBuilder无法实现的结果。通过使用函数或可重用代码块，避免了重复代码。

[第5章](ch05.html "第5章. ArcPy游标 – 搜索、插入和更新"), *ArcPy游标 – 搜索、插入和更新*，涵盖了ArcPy数据访问游标及其如何用于在要素类和表中搜索、更新或插入记录。它解释了使用游标迭代的怪癖，以及如何仅选择或更新感兴趣的记录。

[第6章](ch06.html "第6章. 使用ArcPy几何对象"), *使用ArcPy几何对象*，探讨了ArcPy几何对象及其如何与游标结合以执行空间分析。它展示了如何使用数据游标和Arcpy几何类型进行缓冲、裁剪、重投影等操作，而不使用ArcToolbox。

[第7章](ch07.html "第7章。创建脚本工具"), *创建脚本工具*，解释了如何将脚本转换为在ArcToolbox中出现的工具，并且这些工具是动态的。它解释了工具和脚本如何通信，以及如何设置ArcTool对话框以正确传递参数给脚本。

[第8章](ch08.html "第8章。ArcPy映射简介"), *ArcPy映射简介*，探讨了强大的Arcpy.Mapping模块以及如何修复损坏的图层链接、开启和关闭图层、动态调整标题和文本。它展示了如何根据地理空间分析创建动态地图输出。

[第9章](ch09.html "第9章。更多ArcPy映射技术"), *更多ArcPy映射技术*，介绍了图层对象及其方法和属性。它演示了如何控制数据帧的地图比例和范围，并涵盖了自动地图导出。

[第10章](ch10.html "第10章。高级几何对象方法"), *高级几何对象方法*，扩展了ArcPy几何对象的方法和属性。它还解释了如何创建模块以保存代码，以便在后续脚本中重复使用，并演示了如何创建包含地理空间分析结果的Excel电子表格。

[第11章](ch11.html "第11章。使用ArcPy进行网络分析和空间分析"), *使用ArcPy进行网络分析和空间分析*，介绍了使用ArcGIS for Desktop网络分析器和空间分析扩展进行高级地理空间分析的基本方法。

[第12章](ch12.html "第12章。起点结束"), *起点结束*，涵盖了需要理解的其他重要主题，以便全面掌握ArcPy。这些主题包括环境设置、XY值和Z和M分辨率、空间参考系统（投影）、Describe函数等。

# 您需要这本书的内容

您需要ArcGIS 10.1/10.2/10.3的专有版或免费版。为了支持您的环境，您需要2GB RAM、32位或64位机器硬件配置，以及Windows 7/8。需要Python 2.7来进行编程，并且它将与ArcGIS一起安装。

# 这本书面向的对象

这本书旨在为需要了解如何使用ArcPy来减少重复性任务和提高分析速度的GIS学生和专业人员提供帮助。对于希望了解如何使用行业标准ArcGIS软件及其ArcPy模块来自动化地理空间分析的Python程序员来说，这也是一本有价值的书。

# 惯例

在这本书中，您将找到多种文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟URL、用户输入和Twitter用户名如下所示："这两个数据片段，BusStopID和`averatePop`变量随后被添加到一个列表中。"

代码块应如下设置：

[PRE0]

任何命令行输入或输出都应如下所示：

[PRE1]

**新术语**和**重要词汇**将以粗体显示。您在屏幕上看到的单词，例如在菜单或对话框中，将以如下方式显示：“通过单击它，然后单击**编辑**按钮来选择它。”

### 注意

警告或重要提示将以如下框中的形式出现。

### 小贴士

小技巧和窍门将以如下形式出现。

# 读者反馈

我们始终欢迎读者的反馈。请告诉我们您对这本书的看法——您喜欢什么或可能不喜欢什么。读者反馈对我们开发您真正能从中受益的标题非常重要。

要向我们发送一般性反馈，只需发送电子邮件至 `<[feedback@packtpub.com](mailto:feedback@packtpub.com)>`，并在邮件主题中提及书名。

如果你在某个领域有专业知识，并且对撰写或参与一本书籍感兴趣，请参阅我们的作者指南，网址为 [www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在您已经是Packt书籍的骄傲拥有者，我们有一些事情可以帮助您从您的购买中获得最大收益。

## 下载示例代码

您可以从您在 [http://www.packtpub.com](http://www.packtpub.com) 的账户中下载您购买的所有Packt书籍的示例代码文件。如果您在其他地方购买了这本书，您可以访问 [http://www.packtpub.com/support](http://www.packtpub.com/support) 并注册，以便将文件直接通过电子邮件发送给您。

## 下载本书的颜色图像

我们还为您提供了一个包含本书中使用的截图/图表的颜色图像的PDF文件。这些颜色图像将帮助您更好地理解输出的变化。您可以从 [http://www.packtpub.com/sites/default/files/downloads/8662OS_ColorImages.pdf](http://www.packtpub.com/sites/default/files/downloads/8662OS_ColorImages.pdf) 下载此文件。

## 错误清单

尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在我们的书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。这样做可以帮助其他读者避免挫败感，并帮助我们改进本书的后续版本。如果您发现任何错误清单，请通过访问 [http://www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**错误提交表单**链接，并输入您的错误详情。一旦您的错误清单得到验证，您的提交将被接受，错误清单将被上传到我们的网站或添加到该标题的错误部分下的现有错误清单中。

要查看之前提交的错误清单，请访问 [https://www.packtpub.com/books/content/support](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书名。所需信息将出现在**错误清单**部分下。

## 侵权

互联网上对版权材料的盗版是一个跨所有媒体的持续问题。在Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，无论形式如何，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过链接[<版权@packtpub.com](mailto:copyright@packtpub.com)>与我们联系，提供疑似盗版材料的链接。

我们感谢您在保护我们作者以及为我们提供有价值内容的能力方面的帮助。

## 问题

如果您在本书的任何方面遇到问题，请通过链接[<问题@packtpub.com](mailto:questions@packtpub.com)>与我们联系，我们将尽力解决。
