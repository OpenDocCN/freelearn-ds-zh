# 前言

**ArcGIS**，来自行业领导者 ESRI 的 GIS 软件，允许分析和展示地理空间数据。

将 Python 集成到 ArcGIS 中使得 ArcPy 模块成为 GIS 学生和专业人士的重要工具。ArcPy 模块提供了一种强大的方式来提高进行地理空间分析时的生产力。从基本的 Python 脚本编写到高级的 ArcPy 方法和属性，ArcPy 和其他 Python 模块将提高任何 GIS 工作流程的速度和可重复性。

本书将指导您从基本的 Python 脚本编写到高级脚本工具。它专注于地理空间分析脚本编写，并涉及自动化地图输出。到本书结束时，您将能够创建可重用模块，将可重复分析作为脚本工具添加到 ArcToolbox 中，并自动导出地图。通过将 GIS 的耗时性质从几天减少到几小时，一位 GIS 专业人士可以变得像整个团队一样强大。

# 本书涵盖内容

第一章, *ArcGIS 的 Python 简介*，快速介绍了 Python 的基础知识，包括编程语言的其他用途。它涵盖了 Python 数据类型和本书中使用的的重要模块。

第二章, *配置 Python 环境*，介绍了 Python 的工作原理：其文件夹结构、可执行文件和模块。它还解释了将模块导入脚本、内置模块，并涵盖了集成开发环境（IDE），这些是强大的编程辅助工具。

第三章, *编写第一个 Python 脚本*，展示了如何使用 ArcGIS ModelBuilder 来建模第一个分析，然后将其导出为 Python 脚本。还介绍了字符串操作以及如何在 Python 中使用文件路径。

第四章, *复杂的 ArcPy 脚本和泛化函数*，探讨了如何执行分析并生成使用 ModelBuilder 无法实现的结果。通过使用函数或可重用代码块，避免了重复代码。

第五章, *ArcPy 游标 – 搜索、插入和更新*，涵盖了 ArcPy 数据访问游标及其如何用于在要素类和表中搜索、更新或插入记录。它解释了使用游标迭代的怪癖，以及如何仅选择或更新感兴趣的记录。

第六章, *使用 ArcPy 几何对象*，探讨了 ArcPy 几何对象及其如何与游标结合以执行空间分析。它展示了如何使用数据游标和 Arcpy 几何类型进行缓冲、裁剪、重投影等操作，而不使用 ArcToolbox。

第七章, *创建脚本工具*，解释了如何将脚本转换为在 ArcToolbox 中出现的工具，并且这些工具是动态的。它解释了工具和脚本如何通信，以及如何设置 ArcTool 对话框以正确传递参数给脚本。

第八章, *ArcPy 映射简介*，探讨了强大的 Arcpy.Mapping 模块以及如何修复损坏的图层链接、开启和关闭图层、动态调整标题和文本。它展示了如何根据地理空间分析创建动态地图输出。

第九章, *更多 ArcPy 映射技术*，介绍了图层对象及其方法和属性。它演示了如何控制数据帧的地图比例和范围，并涵盖了自动地图导出。

第十章, *高级几何对象方法*，扩展了 ArcPy 几何对象的方法和属性。它还解释了如何创建模块以保存代码，以便在后续脚本中重复使用，并演示了如何创建包含地理空间分析结果的 Excel 电子表格。

第十一章, *使用 ArcPy 进行网络分析和空间分析*，介绍了使用 ArcGIS for Desktop 网络分析器和空间分析扩展进行高级地理空间分析的基本方法。

第十二章, *起点结束*，涵盖了需要理解的其他重要主题，以便全面掌握 ArcPy。这些主题包括环境设置、XY 值和 Z 和 M 分辨率、空间参考系统（投影）、Describe 函数等。

# 您需要这本书的内容

您需要 ArcGIS 10.1/10.2/10.3 的专有版或免费版。为了支持您的环境，您需要 2GB RAM、32 位或 64 位机器硬件配置，以及 Windows 7/8。需要 Python 2.7 来进行编程，并且它将与 ArcGIS 一起安装。

# 这本书面向的对象

这本书旨在为需要了解如何使用 ArcPy 来减少重复性任务和提高分析速度的 GIS 学生和专业人员提供帮助。对于希望了解如何使用行业标准 ArcGIS 软件及其 ArcPy 模块来自动化地理空间分析的 Python 程序员来说，这也是一本有价值的书。

# 惯例

在这本书中，您将找到多种文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 用户名如下所示："这两个数据片段，BusStopID 和`averatePop`变量随后被添加到一个列表中。"

代码块应如下设置：

```py
with arcpy.da.SearchCursor(Intersect71Census, ["STOPID","POP10"]) as cursor:
    for row in cursor:
        busStopID = row[0]
        pop10 = row[1]
        if busStopID not in dataDictionary.keys():
            dataDictionary[busStopID] = [pop10]
        else:
            dataDictionary[busStopID].append(pop10)
```

任何命令行输入或输出都应如下所示：

```py
>>> aString = "This is a string"
>>> bString = " and this is another string"
>>> aString + bString 

```

**新术语**和**重要词汇**将以粗体显示。您在屏幕上看到的单词，例如在菜单或对话框中，将以如下方式显示：“通过单击它，然后单击**编辑**按钮来选择它。”

### 注意

警告或重要提示将以如下框中的形式出现。

### 小贴士

小技巧和窍门将以如下形式出现。

# 读者反馈

我们始终欢迎读者的反馈。请告诉我们您对这本书的看法——您喜欢什么或可能不喜欢什么。读者反馈对我们开发您真正能从中受益的标题非常重要。

要向我们发送一般性反馈，只需发送电子邮件至 `<feedback@packtpub.com>`，并在邮件主题中提及书名。

如果你在某个领域有专业知识，并且对撰写或参与一本书籍感兴趣，请参阅我们的作者指南，网址为 [www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在您已经是 Packt 书籍的骄傲拥有者，我们有一些事情可以帮助您从您的购买中获得最大收益。

## 下载示例代码

您可以从您在 [`www.packtpub.com`](http://www.packtpub.com) 的账户中下载您购买的所有 Packt 书籍的示例代码文件。如果您在其他地方购买了这本书，您可以访问 [`www.packtpub.com/support`](http://www.packtpub.com/support) 并注册，以便将文件直接通过电子邮件发送给您。

## 下载本书的颜色图像

我们还为您提供了一个包含本书中使用的截图/图表的颜色图像的 PDF 文件。这些颜色图像将帮助您更好地理解输出的变化。您可以从 [`www.packtpub.com/sites/default/files/downloads/8662OS_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/8662OS_ColorImages.pdf) 下载此文件。

## 错误清单

尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在我们的书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。这样做可以帮助其他读者避免挫败感，并帮助我们改进本书的后续版本。如果您发现任何错误清单，请通过访问 [`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**错误提交表单**链接，并输入您的错误详情。一旦您的错误清单得到验证，您的提交将被接受，错误清单将被上传到我们的网站或添加到该标题的错误部分下的现有错误清单中。

要查看之前提交的错误清单，请访问 [`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书名。所需信息将出现在**错误清单**部分下。

## 侵权

互联网上对版权材料的盗版是一个跨所有媒体的持续问题。在 Packt，我们非常重视我们版权和许可证的保护。如果您在互联网上发现我们作品的任何非法副本，无论形式如何，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过链接<版权@packtpub.com>与我们联系，提供疑似盗版材料的链接。

我们感谢您在保护我们作者以及为我们提供有价值内容的能力方面的帮助。

## 问题

如果您在本书的任何方面遇到问题，请通过链接<问题@packtpub.com>与我们联系，我们将尽力解决。
