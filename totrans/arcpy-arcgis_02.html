<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Configuring the Python Environment"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Configuring the Python Environment</h1></div></div></div><p>In this chapter, we will configure both Python and our computer to work together to execute Python scripts. Path variables and environment variables will be configured to ensure that import statements work as expected, and that scripts run when they are clicked on. The structure of the Python folder will be discussed, as will the location of the ArcPy module within the ArcGIS folder structure. We will also discuss <span class="strong"><strong>Integrated Development Environments</strong></span> (<span class="strong"><strong>IDEs</strong></span>), programs designed to assist in code creation and code execution, and compare and contrast existing IDEs to determine what benefits each IDE can offer when scripting Python code.</p><p>This chapter will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The location of the Python interpreter, and how it is called to execute a script</li><li class="listitem" style="list-style-type: disc">Adjusting the computer's environment variables to ensure correct code execution</li><li class="listitem" style="list-style-type: disc">Integrated Development Environments</li><li class="listitem" style="list-style-type: disc">Python's folder structure, with a focus on where modules are stored</li></ul></div><div class="section" title="What is a Python script?"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec12"/>What is a Python script?</h1></div></div></div><p>Let's start<a id="id75" class="indexterm"/> with the very basics of writing and executing a Python script. What is a Python script? It is a simple text file that contains a series of organized commands written in a formalized language. The text file has the extension <code class="literal">.py</code>, but other than that, there is nothing to distinguish it from any other text file. It can be opened using a text editor such as Notepad or Wordpad, but the magic that is Python does not reside in a Python script. Without the Python interpreter, a Python script cannot be run and the commands it contains cannot be executed.</p><div class="section" title="How Python executes a script"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec21"/>How Python executes a script</h2></div></div></div><p>Understanding how Python works to interpret a script and then execute the commands within is as important as understanding the Python language itself. Hours of debugging and error<a id="id76" class="indexterm"/> checking can be avoided by taking the time to set up Python correctly. The interpretive nature of Python means that a script will have to be first converted into bytecode before it can be executed. We will cover the steps that Python takes to achieve our goal of automating GIS analysis.</p></div></div></div>
<div class="section" title="What is the Python interpreter?"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec13"/>What is the Python interpreter?</h1></div></div></div><p>The Python<a id="id77" class="indexterm"/> interpreter, on a Windows environment, is a program that has been compiled into a Windows executable, which has the extension <code class="literal">.exe</code>. The Python interpreter, <code class="literal">python.exe</code>, has been written in C, an older and extensively used programming language with a more difficult syntax.</p><p>Programs written in C, which are also initially written as text files, must be converted into executables by a compiler, a specialized program that converts the text commands into machine code to create executable programs. This is a slow process that can make producing simple programs in C a laborious process. The benefit is that the programs produced are standalone programs capable of running without any dependencies. Python, on the other hand, interprets and executes the Python commands quickly, which makes it a great scripting language, but the scripts must be run through an interpreter and cannot be executed by themselves.</p><p>The Python interpreter, as its name implies, interprets commands contained within a Python script. When a Python script is run, or executed, the syntax is first checked to make sure that it conforms to the rules of Python (for example, indentation rules are followed and the variables follow naming conventions). Then, if the script is valid, the commands contained within are converted into bytecode, a specialized code that is executed by the bytecode interpreter, a virtual machine written in C. The bytecode interpreter further converts the bytecode (which is contained within files that end with the extension <code class="literal">.pyc</code>) into the correct machine code for the computer being used, and then the CPU executes the script. This is a complex process, which allows Python to maintain a semblance of simplicity.</p><p>There are other versions of the Python interpreter that have been written in Java (known as Jython) and in .NET (known as IronPython); these variants are used to write Python scripts in other computing environments and will not be addressed in this book. The ArcGIS installer includes the standard implementation of Python, which is also called CPython to distinguish it from these variants.</p><div class="section" title="Where is the Python interpreter located?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec22"/>Where is the Python interpreter located?</h2></div></div></div><p>The location<a id="id78" class="indexterm"/> of the Python interpreter within the folder structure of a computer is an important detail to master. Python is often downloaded directly from <a class="ulink" href="http://www.python.org">www.python.org</a> and installed separately from ArcGIS. However, each ArcGIS version will require a specific version of Python; given this requirement, the inclusion of Python within the ArcGIS installation package is helpful. For this book, we will be using ArcGIS 10.2, and this will require Python 2.7.</p><p>On a Windows<a id="id79" class="indexterm"/> machine, the Python folder structure is placed directly on the C: drive, unless it is explicitly loaded on another drive. The installation process for ArcGIS 10.2 will create a folder at <code class="literal">C:\Python27</code>, which will contain another folder called either <code class="literal">ArcGIS10.2</code> or <code class="literal">ArcGIS10.2x64</code>, depending on the operating system and the version of ArcGIS that has been installed. For this book, I will be using the 32-bit version of ArcGIS, so the final folder path will be at <code class="literal">C:\Python27\ArcGIS10.2</code>.</p><p>Within this folder are a number of subfolders, as well as <code class="literal">python.exe</code> (the Python interpreter). Also included is a second version of the interpreter called <code class="literal">pythonw.exe</code>. <code class="literal">Pythonw.exe</code> will execute a script without a terminal window with program feedback appearing. Both <code class="literal">python.exe</code> and <code class="literal">pythonw.exe</code> contain complete copies of all Python commands and can be used to execute a script.</p></div><div class="section" title="Which Python interpreter should be used?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec23"/>Which Python interpreter should be used?</h2></div></div></div><p>The general <a id="id80" class="indexterm"/>rule to execute a script directly using the Python interpreters is to use <code class="literal">pythonw.exe</code>, as no terminal window will appear. When there is a need to test code snippets, or to see the output within a terminal window, start <code class="literal">python.exe</code> by double-clicking on the executable.</p><p>When <code class="literal">python.exe</code> is started, a Python interpreter console will appear:</p><div class="mediaobject"><img src="graphics/8662OS_02_01.jpg" alt="Which Python interpreter should be used?"/></div><p>Note the distinctive three chevrons (<span class="strong"><strong>&gt;&gt;&gt;</strong></span>) that appear below the header explaining version information. That is the Python prompt, where code is entered to be executed line by line, instead of in a completed script. This direct access to the interpreter is useful to test code snippets and understand syntax. A version of this interpreter, the Python Window, has been built into ArcMap and ArcCatalog since ArcGIS 10. It will be discussed more in later chapters.</p></div><div class="section" title="How does the computer know where the interpreter is?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec24"/>How does the computer know where the interpreter is?</h2></div></div></div><p>To be able <a id="id81" class="indexterm"/>to execute Python scripts directly (that is, to make the scripts run by double-clicking on them), the computer will also need to know where the interpreter sits within its folder structure. To accomplish this requires both administrative account access and advanced knowledge of how Windows searches for a program. We will have to adjust an environment variable within the advanced system settings dialogue to register the interpreter with the system path.</p><p>On a Windows 7 machine, click on the start menu and right-click on <span class="strong"><strong>Computer</strong></span>, then select <span class="strong"><strong>Properties</strong></span> from the menu. On a Windows 8 machine, click on <span class="strong"><strong>Windows explorer</strong></span> and right click on <span class="strong"><strong>This PC</strong></span>, and select <span class="strong"><strong>Properties</strong></span> from the menu. These commands are shortcuts to get to the <span class="strong"><strong>Control Panel's System</strong></span> and <span class="strong"><strong>Security/System</strong></span> menus. Select <span class="strong"><strong>Advanced system</strong></span> <span class="strong"><strong>settings</strong></span> from the panel on the left. Click on the <span class="strong"><strong>Environment Variables </strong></span>button at the bottom of the <span class="strong"><strong>System Properties</strong></span> menu that appears. In the lower portion of the <span class="strong"><strong>Environment Variables</strong></span> menu, scroll through the <span class="strong"><strong>System variables</strong></span> window until the <span class="strong"><strong>Path </strong></span>variable appears. Select it by clicking on it, and then clicking on the <span class="strong"><strong>Edit</strong></span> button. The following window will appear:</p><div class="mediaobject"><img src="graphics/8662OS_02_02.jpg" alt="How does the computer know where the interpreter is?"/></div><p>This variable has two components: <span class="strong"><strong>Variable name</strong></span> (path) and <span class="strong"><strong>Variable value</strong></span>. The value is a series of folder paths separated by semicolons. This is the path that is searched when Windows looks for specific executables that have been associated with a file extension. In our case, we will be adding the folder path that contains the Python interpreter. Type <code class="literal">C:\Python27\ArcGIS10.2</code> (or the equivalent on your machine) into the <span class="strong"><strong>Variable value </strong></span>field, making sure to separate it from the value before it with a semicolon. Click on <span class="strong"><strong>OK</strong></span> to exit the <span class="strong"><strong>Edit</strong></span> dialogue, and <span class="strong"><strong>OK</strong></span> to exit the <span class="strong"><strong>Environment Variables</strong></span> menu, and <span class="strong"><strong>OK</strong></span> to exit the <span class="strong"><strong>System Properties</strong></span> menu. The machine will now know where the Python interpreter is, as it will search all folders contained within the Path variable to look for an executable called Python. To test that the path adjustment worked correctly, open up a command window (Start menu/run <code class="literal">cmd</code>) and type <code class="literal">python</code>. The interpreter should directly run in the command window:</p><div class="mediaobject"><img src="graphics/8662OS_02_03.jpg" alt="How does the computer know where the interpreter is?"/></div><p>If the <a id="id82" class="indexterm"/>Python header with version information and the triple chevron appears, the path adjustment has worked correctly.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>If there is no admin access available, there is a work around. In a command-line window, pass the entire path to the Python interpreter (<code class="literal">C:\Python27\ArcGIS10.2\python.exe</code>) to start the interpreter.</p></div></div></div></div>
<div class="section" title="Make Python scripts executable when clicked on"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Make Python scripts executable when clicked on</h1></div></div></div><p>The final step in making the scripts run when double-clicked (which also means they can  run outside of the ArcGIS environment, saving lots of memory overhead) is to associate files with the <code class="literal">.py</code> extension with the Python interpreter. If the scripts have not already been associated with the interpreter, they will appear as files of an unknown type or as a text file.</p><p>To change this, right-click on a <span class="strong"><strong>Python</strong></span> script. Select <span class="strong"><strong>Open With</strong></span>, and then select <span class="strong"><strong>Choose Default Program</strong></span>. If <code class="literal">python.exe</code> or <code class="literal">pythonw.exe</code> does not appear as a choice, navigate to the folder that holds them (<code class="literal">C:\Python27\ArcGIS10.2</code>, in this case) and select either <code class="literal">python.exe</code> or <code class="literal">pythonw.exe</code>. Again, the difference between the two is the appearance of a terminal window when the scripts are run using <code class="literal">python.exe</code>, which will contain any output from the script (but this window will disappear when the script is done). I recommend using <code class="literal">pythonw.exe</code> when executing scripts, and <code class="literal">python.exe</code> to test code.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>Python scripts can also explicitly call <code class="literal">pythonw.exe</code> by adjusting the extension to <code class="literal">.pyw</code> instead of <code class="literal">.py</code>.</p></div></div></div>
<div class="section" title="Integrated Development Environments (IDEs)"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Integrated Development Environments (IDEs)</h1></div></div></div><p>The Python interpreter contains <a id="id83" class="indexterm"/>everything that is needed to execute a Python script or to test Python code by interacting with the Python interpreter. However, writing scripts requires a text editor. There are usually at least two simple text editors included on a Windows machine (Notepad and Wordpad) and they work in an emergency to edit a script or even write a whole script. Unfortunately, they are very simple and do not allow the user functionality that would make it easier to write multiple scripts or very long scripts.</p><p>To bridge <a id="id84" class="indexterm"/>the gap, a series of programs collectively known as Integrated Development Environments have been developed. IDEs exist for all programming languages, and include functions such as variable listing, code assist, and more, that make them ideal to craft programming scripts. We will review a few of them to assess their usefulness to write Python scripts. The three discussed as follows are all free and well-established within different Python communities.</p><div class="section" title="IDLE"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec25"/>IDLE</h2></div></div></div><p>Python includes<a id="id85" class="indexterm"/> an IDE when it is installed. The IDE is called IDLE, which is a<a id="id86" class="indexterm"/> word play on both IDE and the name of a prominent member of Monty Python, Eric Idle. It can be started in Windows 7 by going to the Start menu and finding the ArcGIS folder within the <span class="strong"><strong>Programs</strong></span> menu. Within the <code class="literal">Python</code> folder, IDLE will be one of the choices within that folder. Select it to start<span class="strong"><strong> IDLE</strong></span>.</p><div class="mediaobject"><img src="graphics/8662OS_02_04.jpg" alt="IDLE"/></div><p>IDLE contains an interactive interpreter (i.e. the triple chevron) and the ability to run complete Python scripts. It is also written using Python's built-in GUI module, called <span class="strong"><strong>Tkinter</strong></span>, so<a id="id87" class="indexterm"/> it has the advantage of being written in the same language that it executes.</p><p>Another advantage of using IDLE over the Python console (<code class="literal">python.exe</code>) is that any print statements or other script output is directed to the IDLE interactive window, which does not disappear after executing the script. IDLE is also lightweight with respect to memory use. Scripts are opened using a file dialogue contained within the <span class="strong"><strong>File</strong></span> menu, and recently run scripts are listed within the <span class="strong"><strong>File</strong></span> menu's, <span class="strong"><strong>Recent Files</strong></span>.</p><p>Disadvantages of IDLE include a limited code assist (or code auto-complete), a useful IDE tool, and having no way to organize scripts into logical projects. There is no way to find all variables contained within a script, another useful feature of other IDEs. Also, the <span class="strong"><strong>Recent Files</strong></span> menu<a id="id88" class="indexterm"/> has a limit on the number of scripts that it will list, making it harder to find a<a id="id89" class="indexterm"/> script that has not been run in months (which is a common occurrence, believe me!). IDLE is a passable IDE that is useful if no other programs can be installed on the machine. It is also very useful for rapid testing of code snippets. While it is not my main IDE, I find myself using IDLE almost daily.</p></div><div class="section" title="PythonWin"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec26"/>PythonWin</h2></div></div></div><p>PythonWin (short for Python for Windows) is available at <a class="ulink" href="http://sourceforge.net/projects/pywin32/files/pywin32">http://sourceforge.net/projects/pywin32/files/pywin32</a>, and includes both an IDE <a id="id90" class="indexterm"/>and helpful modules to use Python in a Windows environment. Select<a id="id91" class="indexterm"/> the newest build of <span class="strong"><strong>PythonWin</strong></span>, and then select the correct <a id="id92" class="indexterm"/>version 32 module based on the installed version of Python (for my machine, I selected <code class="literal">pywin32-218.win32-py2.7.exe</code>, the correct version for my 32-bit Python 2.7 installation). Run the executable, and if the correct version has been downloaded, the installation GUI will recognize Python 2.7 in the system registry and will install itself.</p><p>PythonWin includes an Interactive Window where the user can directly interact with the Python interpreter. Scripts can also be opened within PythonWin, and it includes a set of tiling commands in the Windows menu that allows the user to organize the display of all open scripts and the Interactive Window.</p><p>Another nice advantage that PythonWin has over IDLE is the ability to display different portions of a script within the same script window. If a script has grown too long, it can be a pain to scroll up and down the script when editing. PythonWin allows the user to pull down from the top of the script to create a second script window, which can focus on a separate part of the script. Also, on the left side, another window can be opened that will list Python classes and variables, making it easier to navigate to a particular section of the script.</p><div class="mediaobject"><img src="graphics/8662OS_02_05.jpg" alt="PythonWin"/></div><p>One small<a id="id93" class="indexterm"/> but helpful feature built into PythonWin's Interactive <a id="id94" class="indexterm"/>Window is the ability to search through previously entered code statements. At the triple chevron prompt, hold down the <span class="emphasis"><em>Ctrl</em></span>  key and use the up and down arrow keys to navigate through the lines to find one of interest. This saves a lot of time when testing a particular snippet of code.</p><p>All in all, PythonWin is a useful and easy-to-use IDE, and most ArcGIS professionals who create Python scripts use PythonWin. The drawbacks I find with PythonWin include its lack of ability to organize scripts into projects, and its lack of a list of variables that exist within the script, which can be very helpful when navigating larger scripts.</p></div><div class="section" title="Aptana Studio 3"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec27"/>Aptana Studio 3</h2></div></div></div><p>Sometimes the<a id="id95" class="indexterm"/> tools of the greater programming community <a id="id96" class="indexterm"/>can seem daunting to new scripters, who are more focused on simply creating a script that will save time on a GIS analysis than using the correct tool for programming daily. It reminds me of inexperienced computer users, who don't feel like they need the full power of a top-of-the-line computer because they only want to browse the internet and send e-mails.</p><p>However, the exact opposite is true: the computer adverse is better off having an easier to use top-of-the-line computer, while an experienced computer user could make do with a net book.</p><p>The same<a id="id97" class="indexterm"/> can be said for programmers and scripters. Sometimes, it's better <a id="id98" class="indexterm"/>to have an over-the-top IDE that will actually make a scripter more productive, while an experienced programmer could make do with Notepad. All of the bells and whistles included in an IDE such as Aptana Studio 3 will save scripters time and take remarkably little time to learn.</p><p>Aptana Studio 3<a id="id99" class="indexterm"/> is available at <a class="ulink" href="http://aptana.com">http://aptana.com</a>. Download and run the installer provided to install it. Choose a default main project folder that can contain all of the scripts projects; for this book, I created a folder called <code class="literal">C:\Projects</code>. For each project created, Aptana will create a project file holding information about each project. When using Aptana Studio at work, using a network folder can be useful as others can then access the projects with their respective Aptana installations.</p><p>Once it has been installed, the next step is to create a <code class="literal">PyDev</code> project. Go to the <span class="strong"><strong>File</strong></span> menu and select <span class="strong"><strong>New</strong></span>, and then select <span class="strong"><strong>PyDev</strong></span> project. When creating this first project, Python Interpreter will have to be added to Aptana's Python path. Aptana can support more than one interpreter; for our purposes, one will do. Go to the bottom of the PyDev project menu and click on <span class="strong"><strong>Click here</strong></span> to configure an interpreter. When the <span class="strong"><strong>Preferences/Python Interpreters</strong></span> menu appears, make sure to select <span class="strong"><strong>Interpreter-Python</strong></span> on the left, and then click on <span class="strong"><strong>New</strong></span> in the top-right menu.</p><div class="mediaobject"><img src="graphics/8662OS_02_06.jpg" alt="Aptana Studio 3"/></div><p>Once <span class="strong"><strong>New</strong></span> has been<a id="id100" class="indexterm"/> selected, a small dialog will appear asking for a <a id="id101" class="indexterm"/>name for the interpreter and the path to the executable. Click on <span class="strong"><strong>browse</strong></span> and navigate to the folder with <code class="literal">python.exe</code>. No terminal window will be generated when running a Python script using Aptana Studio as all output is redirected to the Aptana Studio console. Select <code class="literal">python.exe</code> and click on <span class="strong"><strong>OK</strong></span>. Next, click on <span class="strong"><strong>OK</strong></span> in the <span class="strong"><strong>Select Interpreter</strong></span> menu, and then click on <span class="strong"><strong>OK</strong></span> in the <span class="strong"><strong>Preferences</strong></span> menu. Back in the <span class="strong"><strong>PyDev Project</strong></span> menu, give the project a name, and either use the default workspace location or a custom one (for example, <code class="literal">C:\Projects</code>).</p><p>All of this configuration only has to happen the first time; once that is done, creating a <span class="strong"><strong>PyDev</strong></span> project will only require giving a name and location. Now, all of the scripts associated with that project will always be listed in the left menu (<span class="strong"><strong>PyDev Package Explorer</strong></span>), which is a very powerful way to organize projects and scripts.</p><p>Making sure that Aptana Studio is in the PyDev perspective (in the <span class="strong"><strong>Windows/Open Perspective/Other</strong></span> menu, choose <span class="strong"><strong>PyDev</strong></span>) will give three main windows–<span class="strong"><strong>Package Explorer</strong></span> on the left, <span class="strong"><strong>Script window</strong></span> in the middle, and <span class="strong"><strong>Outline window</strong></span> on the right, where variables contained within a script are listed. Clicking on one of the variables on the right will move the script window to that section of the code, making script navigation fast. Also, I like to add the Console window in the middle below the Script window, where the output of the script can be displayed.</p><p>Open <a id="id102" class="indexterm"/>scripts each have a tab within the Script window, making it<a id="id103" class="indexterm"/> easy to switch between the scripts. Also, the windows can be closed to give more room to the Script window as needed. Hovering over a variable within a script will call up a pop-up menu that describes where the variable was first created, which can be a lifesaver as it is easy to forget at times which variable is which (unless, of course, they are clearly named according to the rules described in the previous chapter; even then, it can be a pain at times).</p></div><div class="section" title="IDE summary"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec28"/>IDE summary</h2></div></div></div><p>There are<a id="id104" class="indexterm"/> many other IDEs, both commercial and free, available for coding in Python. In the end, each GIS analyst must choose the tool that makes them feel productive and comfortable. This may change as programming becomes a bigger part of their daily work flow. Be sure to test out a few different IDEs to find one that is easy to use and intuitive.</p></div></div>
<div class="section" title="Python folder structure"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Python folder structure</h1></div></div></div><p>Python's folder <a id="id105" class="indexterm"/>structure holds more than just the Python Interpreter. Within the subfolders reside a number of important scripts, digital link libraries, and even C language modules. Not all of the scripts are used all the time, but each has a role in making the Python programming environment possible. The most important folder to know about is the <span class="strong"><strong>site-packages</strong></span> folder, where most modules that will be imported in Python scripts are contained.</p><div class="mediaobject"><img src="graphics/8662OS_02_07.jpg" alt="Python folder structure"/></div><div class="section" title="Where modules reside"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec29"/>Where modules reside</h2></div></div></div><p>Within<a id="id106" class="indexterm"/> every Python folder is a folder called <code class="literal">Lib</code>, and <a id="id107" class="indexterm"/>within that folder is a folder called <code class="literal">site-packages</code>. On my machine, the folder sits at <code class="literal">C:\Python27\ArcGIS10.2\Lib\site-packages.</code> Almost all third-party modules are copied into this folder to be imported as needed. The main exception to this rule, for<a id="id108" class="indexterm"/> our <a id="id109" class="indexterm"/>purposes, is the ArcPy module, which is stored within the <code class="literal">ArcGIS</code> folder in the <code class="literal">Program Files</code> folder (for example, <code class="literal">C:\Program Files (x86)\ArcGIS\Desktop10.2\arcpy</code>). To make that possible, the ArcGIS installer adjusts the Python system path (using the sys module) to make the arcPy module importable.</p></div><div class="section" title="Using Python's sys module to add a module"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec30"/>Using Python's sys module to add a module</h2></div></div></div><p>Python's <a id="id110" class="indexterm"/>sys module is a <a id="id111" class="indexterm"/>module that allows the user to take advantage <a id="id112" class="indexterm"/>of system tools built into the Python Interpreter. One of the most useful of the functions in the sys module is <code class="literal">sys.path</code>. It is a list of file paths, which the user can modify to adjust where Python will look for a module to import, without needing administrative access.</p><p>When Python 2.7 is installed by the ArcGIS 10.2 installer, the installer takes advantage of the <code class="literal">sys.path</code> functions to add <code class="literal">C:\Program Files (x86)\ArcGIS\Desktop10.2\arcpy</code> to the system path. To test this, start the Python Interpreter or an IDE and type the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>&gt;&gt;&gt; import sys</strong></span>
<span class="strong"><strong>&gt;&gt;&gt; print sys.path</strong></span>
</pre></div><p>The output is as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>['', 'C:\\WINDOWS\\SYSTEM32\\python27.zip', 'C:\\Python27\\ArcGIS10.2\\Dlls', 'C:\\Python27\\ArcGIS10.2\\lib', 'C:\\Python27\\ArcGIS10.2\\lib\\plat-win', 'C:\\Python27\\ArcGIS10.2\\lib\\lib-tk', 'C:\\Python27\\ArcGIS10.2\\Lib\\site-packages\\pythonwin', 'C:\\Python27\\ArcGIS10.2', 'C:\\Python27\\ArcGIS10.2\\lib\\site-packages', 'C:\\Program Files (x86)\\ArcGIS\\Desktop10.2\\bin', 'C:\\Program Files (x86)\\ArcGIS\\Desktop10.2\\arcpy', 'C:\\Program Files (x86)\\ArcGIS\\Desktop10.2\\ArcToolbox\\Scripts', 'C:\\Python27\\ArcGIS10.2\\lib\\site-packages\\win32', 'C:\\Python27\\ArcGIS10.2\\lib\\site-packages\\win32\\lib']</strong></span>
</pre></div><p>The system path (stored in the variable <code class="literal">sys.path</code>) includes all of the folders that ArcPy requires to automate ArcGIS. The system path incorporates all directories listed in the PYTHONPATH environment variable (if one has been created); this is separate from the Windows path environment variable discussed previously. The two separate path variables work together to help Python locate modules.</p></div></div>
<div class="section" title="The sys.path.append() method"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec17"/>The sys.path.append() method</h1></div></div></div><p>The <code class="literal">sys.path</code> function<a id="id113" class="indexterm"/> is a list (did you notice the square brackets in the preceding code output?) and as such can be appended or extended to include new file paths that will point to modules the user wants to import. To avoid the need to adjust <code class="literal">sys.path</code>, copy the module into the site-packages folder. When this is <a id="id114" class="indexterm"/>not possible, use the <code class="literal">sys.path.append()</code> method instead:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>&gt;&gt;&gt; sys.path.append("C:\\Projects\\Requests")</strong></span>
<span class="strong"><strong>&gt;&gt;&gt; sys.path</strong></span>
<span class="strong"><strong>['', 'C:\\WINDOWS\\SYSTEM32\\python27.zip',</strong></span>
<span class="strong"><strong>  'C:\\Python27\\ArcGIS10.2\\Dells',</strong></span>
<span class="strong"><strong>  'C:\\Python27\\ArcGIS10.2\\lib',</strong></span>
<span class="strong"><strong>..'C:\\Python27\\ArcGIS10.2\\lib\\plat-win',</strong></span>
<span class="strong"><strong>..'C:\\Python27\\ArcGIS10.2\\lib\\lib-tk',</strong></span>
<span class="strong"><strong>..'C:\\Python27\\ArcGIS10.2\\Lib\\site-packages\\pythonwin',</strong></span>
<span class="strong"><strong>..'C:\\Python27\\ArcGIS10.2', ..'C:\\Python27\\ArcGIS10.2\\lib\\site-packages', 'C:\\Program</strong></span>
<span class="strong"><strong>..Files (x86)\\ArcGIS\\Desktop10.2\\bin', 'C:\\Program Files</strong></span>
<span class="strong"><strong>..(x86)\\ArcGIS\\Desktop10.2\\arcpy', 'C:\\Program Files</strong></span>
<span class="strong"><strong>..(x86)\\ArcGIS\\Desktop10.2\\ArcToolbox\\Scripts',</strong></span>
<span class="strong"><strong>..'C:\\Python27\\ArcGIS10.2\\lib\\site-packages\\win32',</strong></span>
<span class="strong"><strong>..'C:\\Python27\\ArcGIS10.2\\lib\\site-packages\\win32\\lib',</strong></span>
<span class="strong"><strong>..'C:\\Projects\\Requests']</strong></span>
</pre></div><p>When the <code class="literal">sys.path.append()</code> method is used, the adjustment is temporary. Adjust the PYTHONPATH environment variable in the <span class="strong"><strong>Windows System Properties</strong></span> menu (discussed in the path environment variable section) to make a permanent change (and create the PYTHONPATH if it has not been created).</p><p>One last note is that to import a module without adjusting the system path or copying the module into the site-packages folder, place the module in the folder with the script that is importing it. As long as the module is configured correctly, it will work normally. This is useful when there is no administrative access available to a machine.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Summary</h1></div></div></div><p>In this chapter, we covered a lot about how Python works to execute scripts and commands, and about development environments used to craft scripts. In particular, we discussed how a Python script is read and executed by the Python Interpreter, where the Python Interpreter is located within the Python folder structure, and what the different Python script extensions mean (<code class="literal">.py</code>,<code class="literal"> .pyc</code>,<code class="literal">.pyw</code>). We also covered Integrated Development Environments and how they compare and contrast.</p><p>In the next chapter, we will cover how to use ModelBuilder to convert a modeled analysis into a Python script, and how to make it more powerful than the exported version.</p></div></body></html>