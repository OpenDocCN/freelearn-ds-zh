- en: Using Desktop Clients
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Adding PostGIS layers – QGIS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using the Database Manager plugin – QGIS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding PostGIS layers – OpenJUMP GIS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Running database queries – OpenJUMP GIS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding PostGIS layers – gvSIG
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding PostGIS layers – uDig
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: At a minimum, desktop GIS programs allow you to visualize data from a PostGIS
    database. This relationship gets more interesting with the ability to edit and
    manipulate data outside of the database and in a dynamic *play* environment.
  prefs: []
  type: TYPE_NORMAL
- en: Make a change, see a change! For this reason, visualizing the data stored in
    PostGIS is often critical for effective spatial database management—or at least
    as a now-and-again sanity check. This chapter will demonstrate both dynamic and
    static relationships between your database and desktop clients.
  prefs: []
  type: TYPE_NORMAL
- en: Regardless of your experience level or role in the geospatial community, you
    should find at least one of the four GIS programs serviceable as a potential intermediate
    staging environment between your PostGIS database and end product.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will connect to PostGIS using the following desktop GIS
    programs: **QGIS**, **OpenJUMP GIS**, **gvSIG**, and **uDig**.'
  prefs: []
  type: TYPE_NORMAL
- en: Once connected to PostGIS, extra emphasis will be placed on some of the more
    sophisticated functionalities offered by `QGIS` and `OpenJUMP GIS` using the **Database
    Manager** (**DB Manager**) plugin and data store queries, respectively.
  prefs: []
  type: TYPE_NORMAL
- en: Adding PostGIS layers – QGIS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this recipe, we will establish a connection to our PostGIS database in order
    to add a table as a layer in **QGIS** (formerly known as **Quantum GIS**). Viewing
    tables as layers is great for creating maps or simply working on a copy of the
    database outside the database.
  prefs: []
  type: TYPE_NORMAL
- en: 'Please navigate to the following site to install the latest version LTR of
    QGIS (2.18 – Las Palmas at the time of writing):'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://qgis.org/en/site/](http://qgis.org/en/site/)'
  prefs: []
  type: TYPE_NORMAL
- en: On this page, click on Download Now and you will be able to choose a suitable
    operating system and the relevant settings. QGIS is available for Android, Linux,
    macOS X, and Windows. You might also be inclined to click on Discover QGIS to
    get an overview of basic information about the program along with features, screenshots,
    and case studies.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To begin, create the schema for this chapter as `chp11`; then, download data
    from the U.S. Census Bureau''s FTP site:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://ftp2.census.gov/geo/tiger/TIGER2012/EDGES/tl_2012_39035_edges.zip](http://ftp2.census.gov/geo/tiger/TIGER2012/EDGES/tl_2012_39035_edges.zip)'
  prefs: []
  type: TYPE_NORMAL
- en: The shapefile is `All Lines` for Cuyahoga county in Ohio, which consist of roads
    and streams among other line features.
  prefs: []
  type: TYPE_NORMAL
- en: 'Extract the ZIP file to your working directory and then load it into your database
    using `shp2pgsql`. Be sure to specify the spatial reference system, EPSG/SRID:
    4269\. When in doubt about using projections, use the service provided by the
    folks at OpenGeo at the following website:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://prj2epsg.org/search](http://prj2epsg.org/search)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Use the following command to generate the SQL to load the shapefile in a table
    of the `chp11` schema:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Now it''s time to give the data we downloaded a look using QGIS. We must first
    create a connection to the database in order to access the table. Get connected
    and add the table as a layer by following the ensuing steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the Add PostGIS Layers icon:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b26071bf-5890-4d16-8b5b-b3b19495070a.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on the New button below the Connections drop-down menu.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Create a new PostGIS connection. After the Add PostGIS Table(s) window opens,
    create a name for the connection and fill in a few parameters for your database,
    including Host, Port, Database, Username, and Password:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/831f624c-973a-413d-baf5-803c1d3e7aca.png)'
  prefs: []
  type: TYPE_IMG
- en: Once you have entered all of the pertinent information for your database, click
    on the Test Connection button to verify that the connection is successful. If
    the connection is not successful, double-check for typos and errors. Additionally,
    make sure you are attempting to connect to a PostGIS-enabled database.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the connection is successful, go ahead and check the Save Username and Save
    Password checkboxes. This will prevent you from having to enter your login information
    multiple times throughout the exercise.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on OK at the bottom of the menu to apply the connection settings. Now
    you can connect!
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Make sure the name of your PostGIS connection appears in the drop-down menu
    and then click on the Connect button. If you choose not to store your username
    and password, you will be asked to submit this information every time you try
    to access the database.
  prefs: []
  type: TYPE_NORMAL
- en: Once connected, all schemas within the database will be shown and the tables
    will be made visible by expanding the target schema.
  prefs: []
  type: TYPE_NORMAL
- en: 'Select the table(s) to be added as a layer by simply clicking on the table
    name or anywhere along its row. Selection(s) will be highlighted in blue. To deselect
    a table, click on it a second time and it will no longer be highlighted. Select
    the `tl_2012_39035_edges` table that was downloaded at the beginning of the chapter
    and click on the Add button, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6a7a27fd-eafb-4886-9a54-78dc4ad9434c.png)'
  prefs: []
  type: TYPE_IMG
- en: A subset of the table can also be added as a layer. This is accomplished by
    double-clicking on the desired table name.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The Query Builder window will open, which aids in creating simple SQL `WHERE`
    clause statements. Add the roads by selecting the records where `roadflg = Y`.
    This can be done by typing a query or using the buttons within Query Builder:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c48c8e0a-9196-4fc7-8869-33b2db5b8a1f.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on the OK button followed by the Add button. A subset of the table is
    now loaded into QGIS as a layer. The layer is strictly a static, temporary copy
    of your database. You can make whatever changes you like to the layer and not
    affect the database table.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The same holds true the other way around. Changes to the table in the database
    will have no effect on the layer in QGIS.
  prefs: []
  type: TYPE_NORMAL
- en: If needed, you can save the temporary layer in a variety of formats, such as
    DXF, GeoJSON, KML, or SHP. Simply right-click on the layer name in the Layers
    panel and click on Save As. This will then create a file, which you can recall
    at a later time or share with others.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the Cuyahoga county road network:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/89438422-74c2-4263-b088-2eb5b2e3f8d9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You may also use the QGIS Browser Panel to navigate through the now connected
    PostGIS database and list the schemas and tables. This panel allows you to double-click
    to add spatial layers to the current project, providing a better user experience
    not only of connected databases, but on any directory of your machine:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/db0b2deb-982a-4532-bca1-d8b3863eb625.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You have added a PostGIS layer into QGIS using the built-in Add PostGIS Table
    GUI. This was achieved by creating a new connection and entering your database
    parameters.
  prefs: []
  type: TYPE_NORMAL
- en: Any number of database connections can be set up simultaneously. If working
    with multiple databases is more common for your workflows, saving all of the connections
    into one XML file (see the tip in the preceding section) would save time and energy
    when returning to these projects in QGIS.
  prefs: []
  type: TYPE_NORMAL
- en: Using the Database Manager plugin – QGIS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Database Manager** (**DB Manager**) allows for a more sophisticated relationship
    with PostGIS by allowing users to interact with the database in a variety of ways.
    The plugin mimics some of the core functionality of pgAdmin with the added benefit
    of data visualization.'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this recipe, we will use DB Manager to create, modify, and delete items
    within the database and then tinker with the SQL window. By the end of this section,
    you will be able to do the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the DB Manager menu
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create, modify, and delete database schemas and tables
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Run SQL queries to add new QGIS layers or create new tables in the database
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: QGIS needs to be installed for this recipe. Please refer to the first recipe
    in this chapter for information on where to download the installer.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let's make sure the plugin is enabled and connected to the database.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the Plugins menu located on the QGIS menu bar and select Manage and Install Plugins
    from the drop-down menu, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/626a2bfb-e4c1-4f20-9def-3f62101c2c0d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The QGIS Plugin Manager window will open. Search for DB Manager in the list
    of plugins and make sure it is checked (enabled), as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ed24d00a-75b3-4bb7-97b4-235340cfbcad.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now that DB Manager is enabled, let us open the plugin and check the status
    of the database connection. Open DB Manager by navigating to Database | DB Manager
    from the QGIS menu bar, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b911de78-2e8c-4c98-97a3-473be68c91d6.png)'
  prefs: []
  type: TYPE_IMG
- en: Expand the PostGIS directory within the Tree window of DB Manager. The PostGIS
    connection created in the last recipe will appear. Expand the connection to view
    your schema(s) and table(s). You will be asked for a username and password if
    you opted not to save your credentials.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'On the Info tab above the main window, you can view information about the data,
    such as spatial reference, geometry type, field names, field types, and much more,
    as in the following screenshot:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![](img/92bc79fe-2f35-44e1-876b-ba67f076a342.png)'
  prefs: []
  type: TYPE_IMG
- en: A PostGIS connection is not in place if you are unable to expand the PostGIS
    menu. If you need to establish a connection, refer to *steps 1* to *4* in the
    *Adding **PostGIS **layers – QGIS* recipe. The connection must be established
    before using DB Manager.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Navigate to the DB Manager menu and carry out the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Select the `tl_2012_39035_edges` table in the Tree window.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, click on the Table tab to view the actual data table, as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b3ad86db-2f95-47d5-9047-9a16165d967f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The final tab, Preview, is for visualizing the data, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/4cdf1aec-89e7-4189-8cb5-079dc27871f8.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To create, modify, and delete database schemas and tables, follow the ensuing
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, create a new schema in the database to store data for this chapter.
    Select Schema | Create schema from the menu bar, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/eafbf5f7-0ea6-4509-9f66-d2c7f33f8bb5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Enter `new_schema` as the schema name and then click on OK. If you do not see
    the `new_schema` in the list, you may need to select the database connection in
    the Tree window and click on the Refresh button or press *F5* (see the following
    screenshot):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/af0a05bd-3fc5-406e-8799-0f978720e04f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Your new, empty schema will now be visible in the Tree window:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/e1de2df4-8281-44ee-b186-00bd860f1cc0.png)'
  prefs: []
  type: TYPE_IMG
- en: Now let's continue to work with our chp11 schema containing the `tl_2012_39035_edges`
    table. Let's modify the table name to something more generic. How about `lines`?
    You can change the table name by clicking on the table in the Tree window. As
    soon as the text is highlighted and the cursor flashes, you can delete the existing
    name and enter the new name, `lines`.
  prefs: []
  type: TYPE_NORMAL
- en: 'Right now, our `lines` table''s data is using degrees as the unit of measurement
    for its current projection (*EPSG: 4269*). Let''s add a new geometry column using
    EPSG: 3734, which is a State Plane Coordinate system that measures projections
    in feet. To run SQL queries, follow the ensuing steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the SQL window button in the DB Manager or press *F2*, as shown in
    the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/04652e6b-8dfe-4956-8172-ff3b8c54486e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Copy the following query into the SQL window and then click on Execute:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The query creates a new geometry column named `geom_sp` and then updates the
    geometry information by transforming the original geometry (`geom`) from EPSG
    4269 to 3734, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d2b1a29e-7fb7-40c7-9209-0d0592283342.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Refresh the `chp11` schema and you''ll notice that the table in the database
    now has two geometry columns that are treated independently in the Tree window:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/03963bf6-a3ae-4ad9-bdb6-9cebb91af65c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The preceding screenshot shows the original geometry. The following screenshot
    shows the created geometry:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/512da5fb-a351-433f-8031-a1c2aa6cb010.png)'
  prefs: []
  type: TYPE_IMG
- en: 'For our next query, let us take a subset of the `lines` table. Similar to what
    we did in the preceding section, we will only look at the data about roads. However,
    this time, we can limit the columns that we want to load with the layer, as well
    as perform more complicated spatial queries. We''ll apply a buffer of 10 feet
    using the new geometry column (`geom_sp`) by executing the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Check the Load as new layer checkbox and then select gid as the unique ID and
    geom as the geometry. Create a name for the layer and then click on Load Now!,
    and what you''ll see is shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/afd51f5d-8b22-476e-a114-b635509c5f7c.png)'
  prefs: []
  type: TYPE_IMG
- en: The query adds the result in QGIS as a temporary layer.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now let us modify the query to create a table in the database, rather than
    load the query as a layer, by executing the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the Cuyahoga county road network:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9524b601-f99f-4484-a7cb-03fea31b84a1.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Connecting to a PostGIS database (see the *Adding PostGIS layers – QGIS* recipe
    in this chapter) allows you to utilize the DB Manager plugin. Once DB Manager
    was enabled, we were able to toggle between the Info, Table, and Preview tabs
    to efficiently view metadata, tabular data, and data visualization.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we made changes to the database through the query window, running on the
    table lines of schema `chp11` in order to transform the projection. Note the autocomplete
    feature in the SQL Window, which makes writing queries a breeze.
  prefs: []
  type: TYPE_NORMAL
- en: Changes to the database were made visible in DB Manager by refreshing the database
    connection.
  prefs: []
  type: TYPE_NORMAL
- en: Adding PostGIS layers – OpenJUMP GIS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will connect to PostGIS with OpenJUMP GIS (OpenJUMP) in
    order to add spatial tables as layers. Next, we will edit the temporary layer
    and update it in a new table in the database.
  prefs: []
  type: TYPE_NORMAL
- en: 'The **JUMP** in OpenJUMP stands for **Java Unified Mapping Platform**. To learn
    more about the program, or if you need to install the latest version, go to:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://www.openjump.org/](http://www.openjump.org/)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the Download latest version link ([http://sourceforge.net/projects/jump-pilot/files/OpenJUMP/1.12/](http://sourceforge.net/projects/jump-pilot/files/OpenJUMP/1.12/))
    on the page to view the list of installers. Select the version that suits your
    operating system (`.exe` for Windows and `.jar` for Linux and mac OS). Detailed
    directions for installing OpenJUMP along with other documentation and information
    can be found on the OpenJUMP Wiki page at the following link:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://ojwiki.soldin.de/index.php?title=Main_Page](http://ojwiki.soldin.de/index.php?title=Main_Page)'
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We will be reusing and building upon data used in the *Adding PostGIS layers
    – QGIS* recipe. If you skipped over this recipe, you will want to do the following:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Download the following ZIP file from the U.S. Census Bureau''s FTP site:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[ftp://ftp2.census.gov/geo/tiger/TIGER2012/EDGES/tl_2012_39035_edges.zip](ftp://ftp2.census.gov/geo/tiger/TIGER2012/EDGES/tl_2012_39035_edges.zip)'
  prefs: []
  type: TYPE_NORMAL
- en: The shapefile is `All Lines` for Cuyahoga county in Ohio, which consist of roads
    and streams, among other line features.
  prefs: []
  type: TYPE_NORMAL
- en: 'Extract the ZIP file to your working directory and then load it into your database
    using `shp2pgsql`. Be sure to specify the spatial reference system, which is *EPSG:
    4269*, and name the table `lines`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The data source layer can be added by performing the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on the Open (folder) icon or go to File | Open.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select Data Store Layer from the left-hand-side menu, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/029250d9-fbdc-4950-bc8d-aaf2aa7904d7.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on the icon to the right of the Connection dropdown to open the connection
    manager.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click on the Add button. This will prompt a new window to appear in which you
    must enter your database parameters:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/686b004e-4f57-4ed4-a6f0-4df78ebe5d33.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Enter a name for the connection and then enter values for the following database
    parameters:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Server/Host
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: Port
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Database
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Username
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Password
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Then click on OK. You are now connected to the database.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Check for typos and errors if a connection error message appears. If the connection
    is successful, select the connection and click on OK.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now you can select the lines table to add, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/abf16c6d-9278-49e7-aa68-52a750e30f60.png)'
  prefs: []
  type: TYPE_IMG
- en: If multiple geometry columns exist, you may choose the one you want to use.
    Add the data's state plane coordinator geometry (`geom_sp`), as shown in the *Using
    the Database Manager plugin – QGIS* recipe.
  prefs: []
  type: TYPE_NORMAL
- en: Simple SQL `WHERE` clause statements can be used if only a subset of a table
    is needed.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on Finish to load the dataset into the main window, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6dee57d2-c618-4dc4-ba0f-1c71a6072fe6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now make a quick edit to the temporary layer and save it back to the database.
    Select the Editing Toolbox button. When the toolbox is loaded, click on the Select Features Tool
    button (to the top-left corner of the screen), as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/55fcbe8d-3b95-43a2-81a8-4a3ff96e8c2d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Select some of the lines, as shown in the following screenshot, that look out
    of place on the map. In particular, the lines to the North of the county; these
    actually jet out into Lake Erie. You can select multiple lines by clicking and
    dragging a rectangle with the cursor or by holding *Shift* while clicking on line
    segments. Hit the *Delete* key (or *Fn* + *Delete* on macOS) once you have selected
    some lines to remove them from the data:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/9efc1ef2-1b6c-420d-b097-328f0f90b6c9.png)'
  prefs: []
  type: TYPE_IMG
- en: Save the changes made to the layer and replace the existing table in the database
    with the edited copy. Right-click on the layer name on the left panel and then
    select Save Dataset As.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select your PostGIS connection with the Connection drop-down menu, choose the
    appropriate table name, and then make sure that the Create new or replace existing table
    option is selected, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/62a54645-3a02-468e-b6bf-7d247383a221.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on OK; you have now successfully edited a PostGIS table in OpenJUMP.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We added a PostGIS layer in OpenJUMP using the Open Data Store Layer menu. This
    was achieved after creating a new connection and entering our database parameters.
  prefs: []
  type: TYPE_NORMAL
- en: In the example, census data was added which included the boundary of Cuyahoga
    county. Part of the boundary advances into Lake Erie to the International Boundary
    with Canada. While technically correct, the water boundary is typically not used
    for practical mapping purposes. In this case, it's easy to visualize which data
    needs to be removed.
  prefs: []
  type: TYPE_NORMAL
- en: OpenJUMP allows us to easily see and delete records that should be deleted from
    the table. The selected lines were deleted, and the table was saved to the database.
  prefs: []
  type: TYPE_NORMAL
- en: Running database queries – OpenJUMP GIS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Executing ad hoc queries in OpenJUMP is simple and offers a couple of unique
    features. Queries can be run on specific data selections, allowing for the manual
    control of the queried area without considering the attribution. Similarly, temporary
    fences (areas) can be drawn on the fly and the geometry of the surface can be
    used in queries. In this recipe, we will explore each of those cases.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Refer to the preceding recipe if you need to install OpenJUMP or require assistance
    connecting to a database.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Carry out the following steps to run the data store query:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to File | Run Datastore Query. Choose the PostGIS connection from the
    Connection drop-down menu or use the Connection Manager utility if you are not
    linked to the database.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'We''ll create and name a polygon layer of the main streams in the region by
    executing the following query:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The preceding query is shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/36774018-4013-4df8-9048-67eff2866ea8.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The preceding query selects the lines on the map that represent hydrology units
    such as `"hydroflg" = ''Y''` and streams. The selected stream lines (which use
    the State Plane geometry) are buffered by 75 feet, which should yield a result
    like that shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4c7f1a46-5c72-4472-a90f-ac11ae8cf4b5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The `ST_Buffer` function uses the units of the data projection for buffering.
    So, if your data still has the original spatial reference *EPSG: 4269*, you will
    be buffering the lines by 75 degrees, and this will lead to very strange results
    indeed! Modify the following SQL query to transform your geometry:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: You'll then want to go back to *step 2* in order to create the buffer measured
    in feet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next, pan and zoom on the map and find two, separate polygons that are near
    each other.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select the Fence icon on the main menu, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6c0f9e38-2199-4436-8527-70881ad927c2.png)'
  prefs: []
  type: TYPE_IMG
- en: Draw a connection (overlapping a connection is fine) between the two unconnected
    polygons using the Fence tool. Click once on the Fence button to create a vertex
    and double-click on it once your polygon is complete.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Switch over to the Select Features Tool, as shown in the following screenshot,
    and select the polygons that you drew on either side of the Fence bridge; select
    multiple features by holding down the *Shift* key:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ead4d152-0d8a-460b-b7b8-3e5bbbb2d13c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You should now have a fence junction between the selected polygons. You should
    see something similar to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/079369ca-f78e-4fc4-975d-a8aa575db4c2.png)'
  prefs: []
  type: TYPE_IMG
- en: Navigate to File | Run Datastore Query again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This time, we will utilize the buttons to the right-hand side of the window
    to connect.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Run `ST_UNION` on the selection and fence together so that the gap is filled.
    We do this with the following query:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Use the Selection and Fence buttons in place of `geom1` and `geom2` so that
    your query looks as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/8f03cb87-d1d6-4789-aefd-738e015f0c59.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click on OK and view the query result by turning off the Main Streams and Fence
    layers, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/44d5f8e8-b118-49f1-864a-e615dc3f6166.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We added a buffered subset of a PostGIS layer in OpenJUMP using the Run Datastore
    Query menu. We took lines from a database table and converted them to polygons
    to view them in OpenJUMP.
  prefs: []
  type: TYPE_NORMAL
- en: We then manually selected an area of interest that had two representative stream
    polygons disjointed from one another, the idea being that the streams would be,
    or are, connected in a natural state.
  prefs: []
  type: TYPE_NORMAL
- en: The Fence tool was used to draw a freehand polygon between the streams. A `union`
    query was then performed to combine the two stream polygons and the fences. Fences
    allow us to create temporary tables for use in spatial queries executed against
    a database table.
  prefs: []
  type: TYPE_NORMAL
- en: Adding PostGIS layers – gvSIG
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: gvSIG is a GIS package developed for the **Generalitat Valenciana** (**gv**)
    in Spain. SIG is the Spanish equivalent of GIS. Intended for use all over the
    world, gvSIG is available in more than a dozen languages.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Installers, documentation, and more details for gvSIG can be found at the following
    website:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://www.gvsig.org/web/](http://www.gvsig.org/web/)'
  prefs: []
  type: TYPE_NORMAL
- en: To download gvSIG, click on the latest version (gvSIG 2.0 at the time of writing).
    The all-included version is recommended on the gvSIG site. Be careful while selecting
    the `.exe` or `.bin` versions; otherwise, you may download the program in a language
    that you don't understand.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The GeoDB layer can be added by following the ensuing steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Select View as the document type in the Project manager section and then click
    on the New button. A blank view (canvas) will open.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click on the Add Layer button on the menu bar, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a5e2c537-3cae-46dd-a336-acd3587bf4f7.png)'
  prefs: []
  type: TYPE_IMG
- en: Next, select the GeoDB tab and click on the button to the right of the Choose connection
    drop-down menu.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Enter the values in Connection parameters and make sure to select PostgreSQLExplorer
    as the value for Driver, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1d20a043-6a48-4c94-94e0-fb83260c2083.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click on OK. All of your tables should appear in Choose table. One or many
    tables can be added at a time. You can also do the following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the columns you want to add in each layer
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Select the geometry column to be used in the event of multiple geometries being
    present
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Give each layer a unique name
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Perform SQL `WHERE` clause queries to load a subset of a dataset
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can see these steps performed in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/305fb5c1-1470-4063-9a0c-7a302b824ead.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click on OK when you''re ready. The data will load in the new view that was
    created, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/44f295be-29df-4a8e-a4a5-200d9857c26e.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: PostGIS layers were added to gvSIG using the Add Layer menu. The GeoDB tab allowed
    us to set the PostGIS connection. After choosing a table, many options are afforded
    with gvSIG. The layer name can be aliased to something more meaningful and unnecessary
    columns can be omitted from the table.
  prefs: []
  type: TYPE_NORMAL
- en: Adding PostGIS layers – uDig
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'A hallmark of the **User-friendly Desktop Internet GIS** (**uDig**) program
    built with **Eclipse** is that it can be used as a standalone application or a
    plugin for existing applications. Details on the uDig project as well as installers
    can be found at the following website:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://udig.refractions.net/](http://udig.refractions.net/)'
  prefs: []
  type: TYPE_NORMAL
- en: Click on Downloads at the preceding website to view the list of versions and
    installers. At the time of writing, 2.0.0.RC1 is the latest stable version. uDig
    is supported by Windows, macOS X, and Linux.
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will quickly connect to a PostGIS database and then add a
    layer to uDig.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Carry out the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Navigate to File | New Layer from the main menu, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/813d5203-fb25-40e6-81ae-8f1217d1d59f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Select PostGIS as the data source and click on the Next button to continue,
    as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b59fcf07-0181-4a1a-bc28-4ceb0dd852d0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Fill in your PostGIS connection parameters and then click on the Next button,
    as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ab3814b1-b945-4942-a94a-c67388985bfc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Select the target database in the Database drop-down menu. Click on the List
    button to view all of the tables from the database that have valid geometries.
    Then, check the checkboxes for one or more tables to add them as layers, as shown
    in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3a716ed5-9842-4fbe-9384-85f423e66fa4.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on Finish and your data will be loaded in the Map window.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6607cb6b-ae14-45c9-955c-8210a672a2ef.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The New Layer menu in uDig generates a hefty list of possible sources that can
    be added. PostGIS was set as the database and your database parameters were entered.
    uDig was then connected to the database. Clicking on List displays the total number
    of tables available in the connected database. Any number of tables can be added
    at once.
  prefs: []
  type: TYPE_NORMAL
