["```py\n      postgis_cookbook=# create schema chp12;\n```", "```py\n      postgis_cookbook=# CREATE OR REPLACE \n      FUNCTION chp12.rand(radius numeric, the_geom geometry) \n      returns geometry as $$\n      BEGIN\n        return st_Project(the_geom, random()*radius, \n                          radians(random()*360));\n      END;\n      $$\n      LANGUAGE plpgsql;\n```", "```py\n      postgis_cookbook=# CREATE OR REPLACE FUNCTION chp12.nrand(n integer, \n        radius numeric, the_geom geometry) \n      returns geometry as $$\n      DECLARE\n        tempdist numeric;\n        maxdist numeric;\n      BEGIN\n        tempdist := 0;\n        maxdist := 0;\n        FOR i IN 1..n\n        LOOP\n          tempdist := random()*radius;\n          IF maxdist < tempdist THEN\n            maxdist := tempdist;\n          END IF;\n        END LOOP;\n\n        return st_Project(the_geom,maxdist, radians(random()*360));\n      END;\n      $$\n      LANGUAGE plpgsql;\n```", "```py\n      postgis_cookbook=# CREATE OR REPLACE FUNCTION chp12.pinwheel\n        (theta numeric, radius numeric, the_geom geometry) \n      returns geometry as $$\n      DECLARE\n      angle numeric;\n      BEGIN\n        angle = random()*360;\n        return st_Project(the_geom,mod(\n          CAST(angle as integer), theta)/theta*radius, radians(angle));\n      END;\n      $$\n      LANGUAGE plpgsql;\n```", "```py\n      postgis_cookbook=# CREATE TABLE chp12.rk_track_points\n      (\n        fid serial NOT NULL,\n        the_geom geometry(Point,4326),\n        ele double precision,\n        \"time\" timestamp with time zone,\n        CONSTRAINT activities_pk PRIMARY KEY (fid)\n      );\n```", "```py\n      CREATE OR REPLACE FUNCTION __trigger_rk_track_points_before_insert(\n      ) RETURNS trigger AS $__$\n      DECLARE\n      maxdist integer;\n      n integer; \n      BEGIN\n        maxdist = 500;\n        n = 4;\n        NEW.the_geom  = chp12.nrand(n, maxdist, NEW.the_geom);\n        RETURN NEW;\n      END;\n\n      $__$ LANGUAGE plpgsql;\n      CREATE TRIGGER rk_track_points_before_insert \n      BEFORE INSERT ON chp12.rk_track_points FOR EACH ROW \n      EXECUTE PROCEDURE __trigger_rk_track_points_before_insert();\n```", "```py\n        #!/bin/bash \n        for f in `find runkeeper_gpx -name \\*.gpx -printf \"%f\\n\"` \n        do \n          echo \"Importing gpx file $f to chp12.rk_track_points \n            PostGIS table...\" #, ${f%.*}\" \n          ogr2ogr -append -update  -f PostgreSQL \n          PG:\"dbname='postgis_cookbook' user='me' password='mypassword'\"\n          runkeeper_gpx/$f -nln chp12.rk_track_points \n          -sql \"SELECT ele, time FROM track_points\" \n        done \n```", "```py\n        @echo off \n        for %%I in (runkeeper_gpx\\*.gpx*) do ( \n          echo Importing gpx file %%~nxI to chp12.rk_track_points \n            PostGIS table... \n          ogr2ogr -append -update -f PostgreSQL \n          PG:\"dbname='postgis_cookbook' user='me' password='mypassword'\"\n          runkeeper_gpx/%%~nxI -nln chp12.rk_track_points \n          -sql \"SELECT ele, time FROM track_points\" \n        )\n```", "```py\n      $ chmod 775 import_gpx.sh\n      $ ./import_gpx.sh\n      Importing gpx file 2012-02-26-0930.gpx to chp12.rk_track_points \n        PostGIS table...\n      Importing gpx file 2012-02-29-1235.gpx to chp12.rk_track_points \n        PostGIS table...\n      ...\n      Importing gpx file 2011-04-15-1906.gpx to chp12.rk_track_points \n        PostGIS table...\n```", "```py\n      > import_gpx.bat\n```", "```py\n      select ST_ASTEXT(rk.the_geom), ST_ASTEXT(rk2.the_geom)\n      from chp03.rk_track_points as rk, chp12.rk_track_points as rk2 \n      where rk.fid = rk2.fid\n      limit 10;\n```", "```py\n      CREATE TABLE chp12.rk_points_rand_500 AS (\n        SELECT chp12.rand(500, the_geom)\n        FROM chp12.rk_track_points\n      );\n\n      CREATE TABLE chp12.rk_points_rand_1000 AS (\n        SELECT chp12.rand(1000, the_geom)\n        FROM chp12.rk_track_points\n      );\n```", "```py\nID(Lat_Nth, Lon_Nth) = (((Lat_Nth + 1) * (Lon_Nth + 1)) mod p) - 1\n```", "```py\n CREATE TABLE chp12.supermarkets (\n sup_id serial,\n the_geom geometry(Point,4326),\n latitude numeric,\n longitude numeric,\n PRIMARY KEY (sup_id)\n );\n CREATE TABLE chp12.supermarkets_mapir (\n sup_id int REFERENCES chp12.supermarkets (sup_id),\n cellid int,\n levelid int\n );\n```", "```py\n CREATE OR REPLACE FUNCTION __trigger_supermarkets_after_insert(\n ) RETURNS trigger AS $__$\n DECLARE\n tempcelliD integer;\n BEGIN\n FOR i IN -2..6\n LOOP\n tempcellid = mod((mod(CAST(TRUNC(ABS(NEW.latitude)*POWER(10,i))\n as int),10)+1) * (mod(CAST(TRUNC(ABS(NEW.longitude)*POWER(10,i))\n as int),10)+1), 11)-1;\n INSERT INTO chp12.supermarkets_mapir (sup_id, cellid, levelid) \n VALUES (NEW.sup_id, tempcellid, i);\n END LOOP;\n Return NEW;\n END;\n $__$ LANGUAGE plpgsql;\n CREATE TRIGGER supermarkets_after_insert \n      AFTER INSERT ON chp12.supermarkets FOR EACH ROW \n      EXECUTE PROCEDURE __trigger_supermarkets_after_insert ();\n```", "```py\n INSERT INTO chp12.supermarkets (the_geom, longitude, latitude) VALUES\n (ST_GEOMFROMTEXT('POINT(-76.304202 3.8992)',4326),\n          -76.304202, 3.8992),\n        (ST_GEOMFROMTEXT('POINT(-76.308476 3.894591)',4326),\n          -76.308476, 3.894591),\n        (ST_GEOMFROMTEXT('POINT(-76.297893 3.890615)',4326),\n          -76.297893, 3.890615),\n        (ST_GEOMFROMTEXT('POINT(-76.299017 3.901726)',4326),\n          -76.299017, 3.901726),\n        (ST_GEOMFROMTEXT('POINT(-76.292027 3.909094)',4326),\n          -76.292027, 3.909094),\n        (ST_GEOMFROMTEXT('POINT(-76.299687 3.888735)',4326),\n          -76.299687, 3.888735),\n        (ST_GEOMFROMTEXT('POINT(-76.307102 3.899181)',4326), \n          -76.307102, 3.899181),\n        (ST_GEOMFROMTEXT('POINT(-76.310342 3.90145)',4326),\n          -76.310342, 3.90145),\n        (ST_GEOMFROMTEXT('POINT(-76.297366 3.889721)',4326), \n          -76.297366, 3.889721),\n        (ST_GEOMFROMTEXT('POINT(-76.293296 3.906171)',4326),\n          -76.293296, 3.906171),\n        (ST_GEOMFROMTEXT('POINT(-76.300154 3.901235)',4326),\n          -76.300154, 3.901235),\n        (ST_GEOMFROMTEXT('POINT(-76.299755 3.899361)',4326),\n          -76.299755, 3.899361),\n        (ST_GEOMFROMTEXT('POINT(-76.303509 3.911253)',4326),\n          -76.303509, 3.911253),\n        (ST_GEOMFROMTEXT('POINT(-76.300152 3.901175)',4326),\n          -76.300152, 3.901175),\n        (ST_GEOMFROMTEXT('POINT(-76.299286 3.900895)',4326), \n          -76.299286, 3.900895),\n        (ST_GEOMFROMTEXT('POINT(-76.309937 3.912021)',4326),\n          -76.309937, 3.912021);\n```", "```py\n SELECT * FROM supermarkets_mapir WHERE sup_id = 8;\n```", "```py\n SELECT sm.the_geom AS the_geom\n FROM chp12.supermarkets_mapir AS smm, chp12.supermarkets AS sm\n WHERE smm.levelid = 2 AND smm.cellid = 9 AND smm.sup_id = sm.sup_id;\n```"]