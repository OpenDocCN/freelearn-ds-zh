<html><head></head><body><div><div><h1 class="header-title">Preface</h1>
                
            
            
                
<p>Greetings and salutations! This text is an introductory guide to GPU programming with Python and CUDA. <strong>GPU</strong> may stand for <strong>Graphics Programming Unit</strong>, but we should be clear that this book is <em>not</em> about graphics programming—it is essentially an introduction to <strong>General-Purpose GPU Programming</strong>, or <strong>GPGPU</strong> <strong>Programming</strong> for short. Over the last decade, it has become clear that GPUs are well suited for computations besides rendering graphics, particularly for parallel computations that require a great deal of computational throughput. To this end, NVIDIA released the CUDA Toolkit, which has made the world of GPGPU programming all the more accessible to just about anyone with some C programming knowledge.</p>
<p>The aim of <em>Hands-On GPU Programming with Python and CUDA</em> is to get you started in the world of GPGPU programming as quickly as possible. We have strived to come up with fun and interesting examples and exercises for each chapter; in particular, we encourage you to type in these examples and run them from your favorite Python environment as you go along (Spyder, Jupyter, and PyCharm are all suitable choices). This way, you will eventually learn all of the requisite functions and commands, as well as gain an intuition of how a GPGPU program should be written.</p>
<p>Initially, GPGPU parallel programming seems very complex and daunting, especially if you've only done CPU programming in the past. There are so many new concepts and conventions you have to learn that it may seem like you're starting all over again at zero. During these times, you'll have to have some faith that your efforts to learn this field are not for naught. With a little bit of initiative and discipline, this subject will seem like second nature to you by the time you reach the end of the text.</p>
<p>Happy programming!</p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Who this book is for</h1>
                
            
            
                
<p>This book is aimed at one person in particular—that is, myself in the year 2014, when I was trying to develop a GPU-based simulation for my doctoral studies in math. I was poring over multiple books and manuals on GPU programming, trying to make the slightest sense of the field; most texts seemed happy to throw an endless parade of hardware schematics and buzzwords at the reader on every page, while the actual <em>programming</em> took a back seat.</p>
<p>This book is primarily aimed at those who want to actually <em>do</em> <em>GPU programming</em>, but without getting bogged down with gritty technical details and hardware schematics. We will program the GPU in proper C/C++ (CUDA C) in this text, but we will write it <em>inline</em> within Python code by way of the PyCUDA module. PyCUDA allows us to only write the necessary low-level GPU code that we need, while it automatically handles all of the redundancies of compiling, linking, and launching code onto a GPU for us.</p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">What this book covers</h1>
                
            
            
                
<p><a href="f9c54d0e-6a18-49fc-b04c-d44a95e011a2.xhtml">Chapter 1</a>, <em>Why GPU Programming?</em>, gives us some motivations as to why we should learn this field, and how to apply Amdahl's Law to estimate potential performance improvements from translating a serial program to making use of a GPU.</p>
<p><a href="4c7f89ab-7136-4cc1-b168-12cb78d97a6a.xhtml">Chapter 2</a>, <em>Setting Up Your GPU Programming Environment</em>, explains how to set up an appropriate Python and C++ development environment for CUDA under both Windows and Linux.</p>
<p><a href="6ab0cd69-e439-4cfb-bf1a-4247ec58c94e.xhtml">Chapter 3</a>, <em>Getting Started with PyCUDA</em>, shows the most essential skills we will need for programming GPUs from Python. We will notably see how to transfer data to and from a GPU using PyCUDA's gpuarray class, and how to compile simple CUDA kernels with PyCUDA's ElementwiseKernel function.</p>
<p><a href="5a5f4317-50c7-4ce6-9d04-ac3be4c6d28b.xhtml">Chapter 4</a>, <em>Kernels, Threads, Blocks, and Grids</em>, teaches the fundamentals of writing effective CUDA kernels, which are parallel functions that are launched on the GPU. We will see how to write CUDA device functions ("serial" functions called directly by CUDA kernels), and learn about CUDA's abstract grid/block structure and the role it plays in launching kernels.</p>
<p><a href="ea648e20-8c72-44a9-880d-11469d0e291f.xhtml">Chapter 5</a>, <em>Streams, Events, Contexts, and Concurrency</em>, covers the notion of CUDA Streams, which is a feature that allows us to launch and synchronize many kernels onto a GPU concurrently. We will see how to use CUDA Events to time kernel launches, and how to create and use CUDA Contexts.</p>
<p><a href="6d1c808f-1dc2-4454-b0b8-d0a36bc3c908.xhtml">Chapter 6</a>, <em>Debugging and Profiling Your CUDA Code</em>, fill in some of the gaps we have in terms of pure CUDA C programming, and shows us how to use the NVIDIA Nsight IDE for debugging and development, as well as how to use the NVIDIA profiling tools.</p>
<p><a href="55146879-4b7e-4774-9a8b-cc5c80c04ed8.xhtml">Chapter 7</a>, <em>Using the CUDA Libraries with Scikit-CUDA</em>, gives us a brief tour of some of the important standard CUDA libraries by way of the Python Scikit-CUDA module, including cuBLAS, cuFFT, and cuSOLVER.</p>
<p class="mce-root"/>
<p><a href="d374ea77-f9e5-4d38-861d-5295ef3e3fbf.xhtml">Chapter 8</a>, <em>The CUDA Device Function Libraries and Thrust</em>, shows us how to use the cuRAND and CUDA Math API libraries in our code, as well as how to use CUDA Thrust C++ containers.</p>
<p><a href="3562f1e0-a53d-470f-9b4d-94fa41b1b2fa.xhtml">Chapter 9</a>, <em>Implementation of a Deep Neural Network</em>, serves as a capstone in which we learn how to build an entire deep neural network from scratch, applying many of the ideas we have learned in the text.</p>
<p><a href="5383b46f-8dc6-4e17-ab35-7f6bd35f059f.xhtml">Chapter 10</a>, <em>Working with Compiled GPU Code</em>, shows us how to interface our Python code with pre-compiled GPU code, using both PyCUDA and Ctypes.</p>
<p><a href="e853faad-3ee4-4df7-9cdb-98f74e435527.xhtml">Chapter 11</a>, <em>Performance Optimization in CUDA</em>, teaches some very low-level performance optimization tricks, especially in relation to CUDA, such as warp shuffling, vectorized memory access, using inline PTX assembly, and atomic operations.</p>
<p><a href="2d464c61-de29-49fa-826a-a7437c368d6a.xhtml">Chapter 12</a>, <em>Where to Go from Here</em>, is an overview of some of the educational and career paths you will have that will build upon your now-solid foundation in GPU programming.</p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">To get the most out of this book</h1>
                
            
            
                
<p>This is actually quite a technical subject. To this end, we will have to make a few assumptions regarding the reader's programming background. To this end, we will assume the following:</p>
<ul>
<li>You have an intermediate level of programming experience in Python.</li>
<li>You are familiar with standard Python scientific packages, such as NumPy, SciPy, and Matplotlib.</li>
<li>You have an intermediate ability in any C-based programming language (C, C++, Java, Rust, Go, and so on). </li>
<li>You understand the concept of dynamic memory allocation in C (particularly how to use the C <kbd>malloc</kbd> and <kbd>free</kbd> functions.)</li>
</ul>
<p>GPU programming is mostly applicable to fields that are very scientific or mathematical in nature, so many (if not most) of the examples will make use of some math. For this reason, we are assuming that the reader has some familiarity with first or second-year college mathematics, including:</p>
<ul>
<li>Trigonometry (the sinusoidal functions: sin, cos, tan …)</li>
<li>Calculus (integrals, derivatives, gradients)</li>
<li>Statistics (uniform and normal distributions)</li>
<li>Linear Algebra (vectors, matrices, vector spaces, dimensionality). </li>
</ul>
<p>Don't worry if you haven't learned some of these topics, or if it's been a while, as we will try to review some of the key programming and math concepts as we go along.</p>
<p>We will be making another assumption here. Remember that we will be working only with CUDA in this text, which is a proprietary programming language for NVIDIA hardware. We will, therefore, need to have some specific hardware in our possession before we get started. So, I will assume that the reader has access to the following:</p>
<ul>
<li>A 64-bit x86 Intel/AMD-based PC</li>
<li>4 Gigabytes (GB) of RAM or more</li>
<li>An entry-level NVIDIA GTX 1050 GPU (Pascal Architecture) or better</li>
</ul>
<p>The reader should know that most older GPUs will probably work fine with most, if not all, examples in this text, but the examples in this text have only been tested on a GTX 1050 under Windows 10 and a GTX 1070 under Linux. Specific instructions regarding setup and configuration are given in <a href="4c7f89ab-7136-4cc1-b168-12cb78d97a6a.xhtml">Chapter 2</a>, <em>Setting Up Your GPU Programming Environment</em>.</p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Download the example code files</h1>
                
            
            
                
<p>You can download the example code files for this book from your account at <a href="http://www.packt.com" target="_blank">www.packt.com</a>. If you purchased this book elsewhere, you can visit <a href="http://www.packt.com/support" target="_blank">www.packt.com/support</a> and register to have the files emailed directly to you.</p>
<p>You can download the code files by following these steps:</p>
<ol>
<li>Log in or register at <a href="http://www.packt.com" target="_blank">www.packt.com</a>.</li>
<li>Select the SUPPORT tab.</li>
<li>Click on Code Downloads &amp; Errata.</li>
<li>Enter the name of the book in the Search box and follow the onscreen instructions.</li>
</ol>
<p>Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:</p>
<ul>
<li>WinRAR/7-Zip for Windows</li>
<li>Zipeg/iZip/UnRarX for Mac</li>
<li>7-Zip/PeaZip for Linux</li>
</ul>
<p>The code bundle for the book is also hosted on GitHub at <a href="https://github.com/PacktPublishing/Hands-On-GPU-Programming-with-Python-and-CUDA">https://github.com/PacktPublishing/Hands-On-GPU-Programming-with-Python-and-CUDA</a>. In case there's an update to the code, it will be updated on the existing GitHub repository.</p>
<p>We also have other code bundles from our rich catalog of books and videos available at <strong><a href="https://github.com/PacktPublishing/" target="_blank">https://github.com/PacktPublishing/</a></strong>. Check them out!<br/></p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Download the color images</h1>
                
            
            
                
<p>We also provide a PDF file that has color images of the screenshots/diagrams used in this book. You can download it here: <a href="http://www.packtpub.com/sites/default/files/downloads/9781788993913_ColorImages.pdf">http://www.packtpub.com/sites/default/files/downloads/9781788993913_ColorImages.pdf</a>.</p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Conventions used</h1>
                
            
            
                
<p>There are a number of text conventions used throughout this book.</p>
<p><kbd>CodeInText</kbd>: Indicates code words in text, database table names, folder names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter handles. Here is an example: "We can now use the <kbd>cublasSaxpy</kbd> function."</p>
<p>A block of code is set as follows:</p>
<pre>cublas.cublasDestroy(handle)<br/>print 'cuBLAS returned the correct value: %s' % np.allclose(np.dot(A,x), y_gpu.get())</pre>
<p>When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold:</p>
<pre>def compute_gflops(precision='S'):<br/><br/><strong>if precision=='S':</strong><br/>    float_type = 'float32'<br/>elif precision=='D':<br/>    float_type = 'float64'<br/>else:<br/>    return -1</pre>
<p>Any command-line input or output is written as follows:</p>
<pre><strong>$ run cublas_gemm_flops.py</strong></pre>
<p><strong>Bold</strong>: Indicates a new term, an important word, or words that you see on screen. For example, words in menus or dialog boxes appear in the text like this.</p>
<p>Warnings or important notes appear like this.</p>
<p>Tips and tricks appear like this.</p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Get in touch</h1>
                
            
            
                
<p>Feedback from our readers is always welcome.</p>
<p class="mce-root"><strong>General feedback</strong>: If you have questions about any aspect of this book, mention the book title in the subject of your message and email us at <kbd>customercare@packtpub.com</kbd>.</p>
<p><strong>Errata</strong>: Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you have found a mistake in this book, we would be grateful if you would report this to us. Please visit <a href="http://www.packt.com/submit-errata" target="_blank">www.packt.com/submit-errata</a>, selecting your book, clicking on the Errata Submission Form link, and entering the details.</p>
<p><strong>Piracy</strong>: If you come across any illegal copies of our works in any form on the internet, we would be grateful if you would provide us with the location address or website name. Please contact us at <kbd>copyright@packt.com</kbd> with a link to the material.</p>
<p class="mce-root"><strong>If you are interested in becoming an author</strong>: If there is a topic that you have expertise in, and you are interested in either writing or contributing to a book, please visit <a href="http://authors.packtpub.com/" target="_blank">authors.packtpub.com</a>.</p>


            

            
        
    </div></div>
<div><div><h1 class="header-title">Reviews</h1>
                
            
            
                
<p>Please leave a review. Once you have read and used this book, why not leave a review on the site that you purchased it from? Potential readers can then see and use your unbiased opinion to make purchase decisions, we at Packt can understand what you think about our products, and our authors can see your feedback on their book. Thank you!</p>
<p>For more information about Packt, please visit <a href="http://www.packt.com/" target="_blank">packt.com</a>.<a href="https://www.packtpub.com/" target="_blank"/></p>


            

            
        
    </div></div></body></html>