<html><head></head><body>
        

                            
                    <h1 class="header-title">Proximity Analysis</h1>
                
            
            
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Selecting features within a specific distance</li>
<li>Creating Buffers</li>
<li>Determining the nearest feature using the Near tool</li>
<li>Calculating how far features are using the Generate Near Table tool</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>If you have been working through the previous chapters in this book, you have learned how to access, visualize, convert, and maintain data using ArcGIS Pro. While these capabilities alone would make ArcGIS Pro a very powerful tool, those are by no means the limits of what you can accomplish with ArcGIS Pro.</p>
<p>ArcGIS Pro is capable of performing some amazing analysis. These capabilities are generally broken down into four categories: overlay, proximity, network, and statistical. These can be further specialized as well. As was pointed out in <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>, there are two things that determine what tools are available to you, license level and extensions. The license level will determine what core tools are available to you. The extensions will determine what specialized tools you will be able to access. So, it is always important to know what license level you are using and what extensions you have access to. Review <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>, for more information about license levels.</p>
<p>Let’s now focus on proximity analysis in ArcGIS Pro. Proximity analysis is simply determining how far or close features are from one another. This could be as simple as selecting features that are within a specified distance from other features, or as complex as calculating the distances between features in one or more layers. Examples of proximity analysis include creating a buffer around selected features to show the area around those features at a set distance. It might be calculating how far features in one layer are from features in another layer and writing those values to a data table. It might be determining which feature in one layer is the closest to a feature in another layer.</p>
<p>In this chapter, you will get some first-hand experience of performing various types of proximity analysis. This will include creating buffers, selecting features based on distance, determining the nearest feature, and calculating how far features are from other features. Some of these recipes will require you to have an Advanced license for ArcGIS Pro.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Selecting features within a specific distance</h1>
                
            
            
                
<p>For this recipe, the roads superintendent has told you he will be starting a new project along Sloan St. and needs to notify those living and working near the street. He has asked you to generate a list of all the parcels located within 500 feet of Sloan Street, so he can notify them of the upcoming work.</p>
<p>In this recipe, you will use the Select by Location tool to select all the parcels within 500 feet of Sloan Street, and then export the selected parcels to an Excel spreadsheet to give to the superintendent. Before you can use the Select by Location tool, you will need to select all the road centerline segments that make up Sloan Street. You will use the Select by Attribute tool to do that.    </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe does require the sample data be installed on the computer. It is recommended that you complete the recipes in <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>, or have some experience working with ArcGIS Pro before you start this recipe in order to ensure you have the required foundational skills and knowledge needed to successfully complete this recipe. You can complete this recipe with any ArcGIS Pro licensing level.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>The first step is to launch ArcGIS Pro. You can do this, several ways depending on how your computer is set up. You can go through the Start menu and All Programs. Then to ArcGIS and ArcGIS Pro.</li>
<li>In the ArcGIS Pro start window, click on Open another project:</li>
</ol>
<div><img height="356" src="img/b7126901-cbc9-4d7a-b926-afeb34a10d96.png" width="497"/></div>
<ol start="3">
<li>Select Computer from the Open window and then click Browse in the area on the right.</li>
<li>Navigate to <kbd>C:\Student\ArcGISProCookbook\Chapter8\Proximity Analysis</kbd> by clicking on <kbd>C:\</kbd> in the area on the left of the Open Project window. Then double-click on Student, ArcGISProCookbook, Chapter8, and Proximity Analysis folders.</li>
</ol>
<ol start="5">
<li>Select the Proximity Analysis.aprx project file and click OK.</li>
</ol>
<p style="padding-left: 60px">The project will open with the Select in a distance map. This is an existing map that already contains the layers you will need to work with in this recipe.</p>
<ol start="6">
<li>Click on the Bookmarks button in the Navigate group in the Map tab on the ribbon.</li>
<li>Select the Sloan St bookmark, as illustrated in the following. This will zoom you to the work area for this recipe:</li>
</ol>
<div><img class="alignnone size-full wp-image-890 image-border" height="188" src="img/cd087aa1-ded3-4f69-af74-b79338fb6cce.png" width="389"/></div>
<ol start="8">
<li>Now you need to select all the segments which form Sloan St. You will use the Select by Attribute tool to do this. Click on the Select by Attributes tool located in the Selection group on the Map toolbar. This will open the Select Layers by Attributes tool in the Geoprocessing pane.</li>
<li>Click on the drop-down menu for the Layer Name or Table view. Select Street Centerlines from the list that appears.</li>
<li>Ensure the Selection type is set to New selection.</li>
<li>Click on the Add Clause button to start building your query.</li>
<li>Set the Field to ST_NAME using the drop-down arrow.</li>
<li>Ensure the operator is set to is Equal to.</li>
<li>Type <kbd>SLOAN ST</kbd> into the values cell. It should start to auto-populate as you begin typing.</li>
<li>Verify that your query looks like the following, and click the Add button:</li>
</ol>
<div><img class="alignnone size-full wp-image-891 image-border" height="68" src="img/5330ad2d-848b-470c-bfe8-23c0152fc2bd.png" width="391"/></div>
<ol start="16">
<li>Verify your Select Layer by Attribute tool looks like the following image and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-892 image-border" height="246" src="img/4fad3013-4105-4e42-8706-90dbedca46df.png" width="420"/></div>
<ol start="17">
<li>If you look at the lower-right corner of the ArcGIS Pro interface, you should see that three features are selected. Close the Geoprocessing pane once you have verified that you have three features selected.</li>
</ol>
<div><p>Since Sloan St. is such a short road, you could have simply selected them from the map using the Select tool.</p>
</div>
<p style="padding-left: 60px">You have just selected the road segments that make up Sloan Street within your GIS data. Now, you need to select the parcels that are within 500 feet, so you can create the notification list to give to the superintendent.</p>
<ol start="18">
<li>With the Sloan Street segments selected, click on the Select by Location tool in the Selection group on the Map tab in the ribbon. This will open the Select Layers by Location tool in the Geoprocessing pane.</li>
<li>Set the Input Feature Layer to Parcels by clicking on the drop-down arrow and selecting the layer from the list.</li>
<li>Set the Relationship to Within a distance using the drop-down arrow and selecting the option from the list.</li>
</ol>
<ol start="21">
<li>Set the Selecting Features to Street Centerlines from the list presented to you when you click on the drop-down arrow.</li>
<li>Type <kbd>500</kbd> in the Search Distance cell and ensure the units are set to feet.</li>
<li>Verify that the Selection type is set to New selection.</li>
<li>Review whether your Select Layer by Location tool looks like the following screenshot, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-893 image-border" height="244" src="img/e9f73f25-06ee-47a8-b5dd-7f837ffd9fc0.png" width="418"/></div>
<div><p>The Select Layer by Location tool automatically uses only selected features in the Selecting Features layer because it is a geoprocessing tool. Geoprocessing tools automatically run using selected features for any input layers or tables. So, unlike the Select by Location tool in ArcMap, you are not required to tell ArcGIS Pro to use selected features.</p>
<p>The Select Layer by Location tool is not limited to only selecting features within a specified distance. It can be used to select features based on several types of spatial relationships, including intersect, are contained by, share a boundary, and more. This makes it a very powerful tool when you need to select features based on their spatial relationship.</p>
</div>
<p style="padding-left: 60px">When the tool finishes, you should end up with 107 total selected features. That includes three selected Street Centerline segments and 104 parcels. Now, all that is left is to export the selected parcels to an Excel spreadsheet.</p>
<ol start="25">
<li>In the Geoprocessing pane, click on the Back button located in the upper-left corner of the pane, as indicated in the following image. This will take you back to the general Geoprocessing pane:</li>
</ol>
<div><img height="268" src="img/43e2c3e6-1fbc-4a29-aa33-3d36d3e4003e.png" width="420"/></div>
<ol start="26">
<li>Click on the Toolboxes tab at the top of the Geoprocessing pane.</li>
<li>Expand the Conversion Tools toolbox and the Excel toolset.</li>
<li>Click on the Table to Excel tool. This will open the tool in the Geoprocessing pane.</li>
<li>Set the Input table to Parcels using the drop-down arrow and selecting the layer from the list that appears.</li>
<li>Click the Browse button for the Output Excel File.</li>
<li>In the Save As window that appears, click on This PC or My Computer in the panel on the left.</li>
<li>In the panel on the right, double-click on the C:\ drive located under Devices and drives. It should be labeled OS or Local Drive.</li>
<li>Scroll down in the right panel and double-click on the Student folder.</li>
<li>Continue this same process until you have navigated to <kbd>C:\Student\ArcGISProCookbook\MyProjects</kbd>.</li>
<li>Type <kbd>Parcels_near_SloanDr</kbd> in the File Name cell, then click Save.</li>
</ol>
<ol start="36">
<li>Verify that your Table to Excel tool looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-894 image-border" height="249" src="img/01a2b5ca-1016-464e-b312-3330a5202299.png" width="426"/></div>
<p style="padding-left: 60px">When the tool is complete it will have exported a copy of all the attribute information linked to the selected parcels to a Microsoft Excel spreadsheet.</p>
<ol start="37">
<li>In the Selection group on the Map tab in the ribbon, click on the Clear button to deselect all selected features.</li>
<li>Save your project.</li>
<li>If you are not continuing to the next recipe you can close ArcGIS Pro. If you are continuing, keep ArcGIS Pro open.</li>
</ol>
<p>So, in this recipe, you needed to create a list that the roads superintendent could use to notify all those that live or work near Sloan Street of an upcoming project. To do this you first had to select all the segments that made up Sloan Street in the GIS database. You performed an attribute query using the Select by Attributes tool. You then used this selection in the Select by Location tool to select all parcels within 500 feet of the selected segments of Sloan Street. Lastly, you exported the selected parcels that were near Sloan Street to a spreadsheet. The roads superintendent will then be able to use it to notify all those near the upcoming road project.</p>
<p>This recipe has not only shown you how to select features that are within a specified distance of other features, it has also illustrated that analysis is often a multiple step process. It requires you to use a range of tools and skills to arrive at an answer.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Creating buffers</h1>
                
            
            
                
<p>Buffers allow you to see what features are within a specific distance of other features. It generates polygons around the buffered features that provide the visual reference of the specified distance. These polygons can then be used to perform additional analysis or select features that are within, or intersect, the buffers.   </p>
<p>In this recipe, you will create a buffer around the creeks and streams in the City of Trippville that will represent a protective zone where special permits are required to perform work. This is due to a recent ordinance passed by the city council to protect water quality in and around the city.   </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe does require the sample data be installed on the computer. It is recommended that you complete the recipes in <em><a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a></em>, <em>ArcGIS Pro Capabilities and Terminology</em>, as well as the other recipes in this chapter before you start this recipe. This will ensure that you have the skills required to successfully complete the steps in this recipe. You can complete this recipe with any ArcGIS Pro licensing level.  </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>If you closed ArcGIS Pro before starting this recipe, you will need to start ArcGIS Pro and open the <kbd>Proximity Analysis.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter8\Proximity Analysis</kbd>, using the skills you have learned in past recipes.</li>
<li>In the Catalog pane, expand the Maps folder. Then right-click on the Buffer map and select Open from the menu that appears. This will open a map that contains the layers you need to perform the work you will be doing in the remainder of the recipe.</li>
<li>Click on the Analysis tab in the ribbon.</li>
<li>Click on the Buffer tool in the Tool group. This will open the Buffer tool in the Geoprocessing pane.</li>
<li>Set the Input Features to Creeks and Streams by clicking on the drop-down arrow and selecting the layer from the list.</li>
<li>Accept the default Output Feature Class.</li>
</ol>
<div><p>While the input for the Buffer tool can be any feature type (point, line, or polygon), the output will always be a polygon.</p>
</div>
<ol start="7">
<li>Type <kbd>60</kbd> into the Distance value and select Feet from the units drop-down list.</li>
<li>You will also accept the defaults for the Side Type and End Type. The Side Type should be Full and the End Type should be Round.</li>
</ol>
<div><p>You are only able to access and change these options if you have an Advanced license.</p>
</div>
<ol start="9">
<li>Because the protective zone is consistent for all creeks and streams, you will set the Buffer tool to Dissolve all output features into a single feature class by clicking on the drop-down arrow for the Dissolve Type. This will create a single buffer that takes less space and is easier to manage.</li>
<li>Verify that your Buffer tool looks like the following, and click the Run button:</li>
</ol>
<div><img class="alignnone size-full wp-image-895 image-border" height="299" src="img/b484c9c6-2ca6-4caf-bd18-a967f1a7ff39.png" width="430"/></div>
<ol start="11">
<li>When the Buffer tool completes, a new layer will appear in your Contents pane. This is the buffer feature class you just created. Close the Geoprocessing pane to free up screen space. </li>
<li>Save your project.</li>
</ol>
<p>You have just created a new feature class in the project geodatabase, that represents the protective area around the creeks and streams. You can easily see the areas that are impacted by this new protective zone. You could also use this layer to perform various analyses. For example, you could use the Select by Location tool to select all parcels that intersect the protective buffer. This will allow you to know exactly which parcels would need a permit for any work they do near one of the creeks or streams. You could use the Union geoprocessing tool to calculate how much of each parcel is within the protective zone and how much is outside.</p>
<p>Challenge:<br/>
Using the skills you learned in this recipe and in the Selecting Features within a distance recipe, select all the parcels that are intersected by the new protective zone buffer you just created, then export the selected parcels to an Excel spreadsheet.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There’s more…</h1>
                
            
            
                
<p>You have just learned how to create a single buffer around features using the Buffer tool. But what if you need to create several buffers at various distances around a set of features or a single layer? You could just use the buffer tool multiple times. However, there is an easier way.</p>
<p>The fire chief for the city of Trippville is working on a fire protection study and needs your help to determine the level of protection provided by the fire hydrants within the city. He needs to know how much of each parcel is 100, 200, and 300 feet from each hydrant. You will use the Multiple Ring Buffer tool to accomplish this:</p>
<ol>
<li>First we will clean up the Buffer map you have been using. Right-click on the Natwtr_Stream_Buffer layer and select Remove from the menu that appears.</li>
<li>Repeat this process for the Creeks, Streams, Lakes and Rivers layers.</li>
<li>In the Catalog pane, expand the Databases folder so you can see its contents.</li>
<li>Expand the Trippville_GIS.gdb geodatabase.</li>
<li>Expand the Water feature dataset and right-click on the fire_hyd feature class. Select Add to Current Map from the menu that appears.</li>
<li>Save your project.</li>
<li>Click on the Analysis tab in the ribbon.</li>
<li>Click on the Tools button in the Geoprocessing group to open the Geoprocessing pane.</li>
<li>Click on the Toolboxes tab near the top of the Geoprocessing pane.</li>
<li>Expand the Analysis toolbox and the Proximity toolset.</li>
<li>Click on the Multiple Ring Buffer tool to open it in the Geoprocessing pane. Notice that it has a different icon from all the other tools. That is because this tool is actually a Python script.</li>
</ol>
<div><p>Python is the primary scripting language for ArcGIS. It allows you to create custom tools that help automate tasks. These can then be scheduled to run automatically, at specified times, or run manually. To learn more about creating Python scripts for ArcGIS, you may want to check out Programming ArcGIS with Python by Eric Pimpler, at <a href="https://www.packtpub.com/application-development/programming-arcgis-python-cookbook-second-edition">https://www.packtpub.com/application-development/programming-arcgis-python-cookbook-second-edition</a>.</p>
</div>
<ol start="12">
<li>Set the Input Features to the fire_hyd layer you just added by clicking on the drop-down arrow and selecting it from the list.</li>
<li>Accept the default value for the Output Feature Class.</li>
<li>Type <kbd>100</kbd> in the cell under Distances and press the <em>Enter</em> key. Another cell should appear.</li>
<li>Type <kbd>200</kbd> in the new cell that appears and press the <em>Enter</em> key. Again, another cell should appear.</li>
<li>Type <kbd>300</kbd> in the new cell that appears and press the <em>Enter</em> key.</li>
<li>Set the Buffer Units to Feet using the drop-down arrow.</li>
<li>Accept the provided default for the Field Name.</li>
<li>Set the Dissolve Option to Non-overlapping (Rings) or All depending on your ArcGIS Pro version. This will allow the fire chief to know how much coverage he has at each distance.</li>
</ol>
<div><p>The Dissolve Option determines whether you create rings/donuts or disks. The Non-overlapping or All options will generate rings that resemble donuts. The overlapping area from the other specified distances is cut out. So in this example, you will get a single ring that extends out to 100 feet. The next ring will cover from 100 to 200 feet. The last ring will cover from 200 to 300 feet.</p>
<p>The Overlapping (disks) or None option creates solid disks that overlap. Using this recipe as an example, you will have one disk that extends out to 100 feet. You will have a second disk that extends out to 200 feet and overlaps the first disk. The last disk will extend out to 300 feet and overlap the other two disks.</p>
<p>You are not required to set your buffer distances to equal intervals. They can be any distance you wish. To learn more about the Multiple Ring Buffer tool, go to <a href="http://pro.arcgis.com/en/pro-app/tool-reference/analysis/multiple-ring-buffer.htm">http://pro.arcgis.com/en/pro-app/tool-reference/analysis/multiple-ring-buffer.htm</a>.</p>
</div>
<ol start="20">
<li>Verify that your Multiple Ring Buffer tool looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-896 image-border" height="261" src="img/2b20a900-9e85-4abe-807a-73fcc947f40e.png" width="358"/></div>
<p style="padding-left: 60px">The new layer should appear in the Content pane, which shows the results of the Multiple Ring Buffer tool. Now let’s verify the results.</p>
<ol start="21">
<li>Select the fire_hyd_MultipleRingBuffer layer in the Contents pane.</li>
<li>Click on the Appearance tab in the Feature Layer contextual menu in the ribbon.</li>
<li>Click on the Import button in the Drawing group.</li>
<li>Verify that the Input Layer is set to fire_hyd_MultipleRingBuffer.</li>
<li>Click on the Browse button for the Symbology Layer. Then select the Folders folder under Project in the left panel of the Symbology Layer window.</li>
</ol>
<ol start="26">
<li>Double-click on the Proximity Analysis folder in the right panel.</li>
<li>Select the Distance_from_Hydrant.lyrx and click Ok.</li>
<li>Verify that your Apply Symbology from Layer looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-897 image-border" height="320" src="img/ba8d6bbc-1512-4fc7-b47f-58a741513bc3.png" width="436"/></div>
<p style="padding-left: 60px">The symbology should change for the multiple ring buffer layer you created. Now you can see each ring.</p>
<ol start="29">
<li>Close the Geoprocessing pane.</li>
<li>Save your project.</li>
<li>Click on the Map tab and the Bookmarks button. Select the Hydrant bookmark to zoom in closer to the Hydrants.</li>
<li>Ensure that the layer is still selected in the Contents pane, and click on the drop-down arrow below the Symbology button in the Drawing group on the Appearance tab in the ribbon. Select Unique Values from the menu that appears, as illustrated in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-898 image-border" height="338" src="img/4bff80c6-9d3e-46ed-9106-94a131e6023f.png" width="491"/></div>
<p style="padding-left: 60px">The Symbology pane should open.</p>
<ol start="33">
<li>In the grid that displays the three distances, right-click on the row for 200 Feet and select Remove. This will remove the area from 100 to 200 feet from the map so you can see how the rings work.</li>
</ol>
<div><p>Removing values from the symbology grid does not remove them from the actual data source. It just removes those features from the display. You can always add the removed value back.</p>
</div>
<ol start="34">
<li>Click on the Undo button in the Quick Access toolbar located in the upper-left corner of the ArcGIS Pro interface. This will return the 200 value symbology.</li>
<li>Save your project and close ArcGIS Pro.</li>
</ol>
<p>So, you have just created a new layer that represents distances around the fire hydrants in the city. This will allow the fire chief to easily determine how much protection the fire hydrants provide the citizens and businesses. Using this data, he can determine if any new fire hydrants should be installed to improve the fire protection in the city.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Determining the nearest feature using the Near tool</h1>
                
            
            
                
<p>You have seen how we can use buffers to show areas that are within a specified distance from features. This allows us to see if other features are within that area. We can also use those areas to perform additional analysis. However, these are all general measurements. They do not tell us which feature is the closest to another feature. How do we determine which feature is closest to another feature?</p>
<p>If you have an advanced license for ArcGIS Pro, this is pretty easy. The Near tool will determine the closest feature for you. Not only will it determine which feature is closest, but it also has options to calculate the distance, direction, coordinates, and more of the closest features. The Near tool works with points, lines, and polygons. You can also specify that it only searches for the closest feature within a specified distance. So lets put this tool into action. </p>
<p>In this recipe, you will continue to assist the Fire Chief. He is still working on his fire protection study. He wants to know which fire hydrant is closest to each parcel, so the department will know exactly which hydrant they should connect to when responding to a given location. You will use the Near tool to calculate which hydrant is closest to each parcel.  </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>You will need to make sure you have an Advanced license for ArcGIS Pro to complete this recipe. You will not be able to do it with a Basic or Standard license. If you are not sure what license level you have or how to determine it, refer to <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>, and the recipe entitled <em>Determining your ArcGIS Pro license level</em>.  That recipe outlines the steps required to determine your license level, if you do not remember.</p>
<p>If you are limited to a Basic or Standard license, then please read through this recipe and then proceed with the <em>There’s more...</em> section, which can be completed with a lower license level.</p>
<p>It is also recommended, you complete the other recipes in this chapter before starting this one. This will ensure that you have a good basic understanding of proximity analysis within ArcGIS Pro.</p>
<p>You will also need to ensure the sample data is installed before you continue.  </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>To begin, launch  ArcGIS Pro using the same method you have in previous recipes, and then launch the <kbd>Nearest Feature.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter8\Proximity Analysis</kbd> using the skills you have learned in past recipes.</li>
<li>It should open with the Trippville Fire Protection Map. Verify that this map contains the Fire Hydrant and Parcels layers at a minimum. It should look like the following. Your scale may be different depending on the size of your monitor and what panes you have open:</li>
</ol>
<div><img class="alignnone size-full wp-image-899 image-border" height="1004" src="img/e4d1c9e5-2078-421a-bfa8-db4873e37147.png" width="1910"/></div>
<ol start="3">
<li>Right-click on the Parcels layer in the Contents pane and select Attribute Table from the menu that appears.</li>
<li>Review the available fields and answer the following question:</li>
</ol>
<div><p><strong>Question</strong>: What fields are associated with the parcels in the attribute table?</p>
<p><strong>Answer</strong>:</p>
</div>
<p style="padding-left: 60px">As you can see, there are only a few fields associated with the parcels. The attribute table is currently storing the ObjectID, Shape, LOTNUM, STNUMBER, STNAME, STSUFFIX, Shape_Length, Shape_Area, and Acres. There is nothing here that tells you which fire hydrant is closest to each parcel. You are about to change that.  </p>
<ol start="5">
<li>Close the Parcels attribute table by clicking the small X next to the table name in the tab at the top of the table view. This will free up more screen real estate.</li>
</ol>
<div><p>If you have multiple monitors, or a really large one, you could also undock and drag the table pane to a different monitor or location as well. This would free up space for viewing the map, but also allow you to continue to view the table. Also, ArcGIS Pro lets you display each table in its own window if you desire, unlike ArcMap, which forces all tables into a single window.</p>
</div>
<ol start="6">
<li>Click on the Analysis tab in the ribbon, then click on the Tools button in the Geoprocessing group. This opens the Geoprocessing pane.</li>
<li>Click on the Toolboxes tab at the top of the Geoprocessing pane.</li>
<li>Expand the Analysis Tools toolbox and the Proximity toolset.</li>
<li>Click on the Near tool in the Proximity toolset.</li>
<li>Set the Input Features to Parcels by clicking on the drop-down arrow and selecting the layer from the list presented.</li>
<li>Set the Near Features to Fire Hydrants using the drop-down arrow and selecting it from the list.</li>
</ol>
<div><p>You can set more than one layer or feature class as the Near Features. Also, Input Features and Near Features can be the same if you are looking for the nearest feature in the same layer.  </p>
</div>
<ol start="12">
<li>Set the Search Radius to 300 feet by typing in <kbd>300</kbd> and ensuring the units are feet. The Fire Chief has indicated that any parcel over 300 feet from a hydrant is considered to not be adequately protected.</li>
<li>Go ahead and click on the Location and Angle boxes. This will provide additional information for the closest Hydrant.</li>
</ol>
<div><p>The Location option will add the <em>x</em> and <em>y</em> coordinates for the nearest hydrant to the Parcel attribute table. The Angle option will add the angle to the nearest hydrant based on grid north.</p>
<p>It should be noted that the Near tool is one of the few geoprocessing tools that actually edits existing data. In the case of the Near tool, it will add new fields to the Parcels attribute table since the Parcels layer is set as the Input Features. For more information on the Near tool, go to <a href="http://pro.arcgis.com/en/pro-app/tool-reference/analysis/near.htm">http://pro.arcgis.com/en/pro-app/tool-reference/analysis/near.htm</a>.</p>
</div>
<ol start="14">
<li>Ensure the Method is set to Planar.</li>
<li>Verify that your Near tool looks like the following, and then click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-900 image-border" height="233" src="img/dac83c96-aed8-4b14-a5b2-7fd211fe4c08.png" width="391"/></div>
<p style="padding-left: 60px">Notice, this time no new layers were added to your map unlike the Buffer and Multiple Ring Buffer. That is because the Near tool does not create a new feature class or table. Instead, it adds new fields to the Input Features attribute table. Lets see what fields were added by the Near tool to the Parcels layer.   </p>
<div><p>You must also have edit permissions to the Input Features layer in order to use this tool.</p>
</div>
<ol start="16">
<li>Close the Geoprocessing pane to free up screen space.</li>
<li>Open the Attribute table for the Parcel using the same method you did earlier in this recipe. Then answer the following question:</li>
</ol>
<div><p><strong>Question</strong>: What fields have been added to the Parcels Attribute table by the Near tool?</p>
<p><strong>Answer</strong>:</p>
</div>
<p style="padding-left: 60px">As you can see, several new fields now appear in the Parcels attribute table. This includes the Near_FID, Near_Dist, Near_X, Near_Y, and Near_Angle, as shown in the following screenshot:</p>
<div><img class="alignnone size-full wp-image-901 image-border" height="441" src="img/672c0873-60ba-44a6-bf6f-7da628b86d27.png" width="1206"/></div>
<p style="padding-left: 60px">Those parcels with a -1 value in the fields are not within the 300 foot search radius you specified when your ran the Near tool. So those are easily identified as not having adequate fire protection. Those parcels that were within 300 feet of a hydrant now have the hydrants' feature ID (Near_FID), distance to the hydrant (Near_Dist), angle to the hydrant (Near_Angle), and X,Y coordinates (Near_X and Near_Y) assigned to each parcel. This allows you to learn which hydrant is closest to each parcel.</p>
<p style="padding-left: 60px">The Near_FID is the ObjectID for the nearest fire hydrant. You could use those two fields to join, relate, or create a relationship class between the two layers. This would allow you to access even more information.</p>
<ol start="18">
<li>Close the Parcels attribute table when you are done reviewing it.</li>
<li>Save your project.</li>
</ol>
<p>Challenge:<br/>
Try linking the Parcels layer to the Fire Hydrants layer using a Join or Relate. Refer to <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <em>Linking Data together</em>, using a Join or Relate. Determine which you should use, a Join or a Relate. (Hint: The cardinality between the tables is a many to one.) Then, link them using the best method. Verify your choice by opening the Parcels attribute table and seeing if you can see or access the linked information from the nearest Fire Hydrant. Remember, those with a -1 will not have linked information.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There’s more…</h1>
                
            
            
                
<p>The Near tool requires you to have an advanced license to determine which feature is the closest. What happens if you only have a basic or standard license? Is it possible to determine the closest feature without an advanced license?</p>
<p>Yes, you can, although it is not as straightforward and does produce a new feature class. You can use the Spatial Join tool. Let’s see how it works. This will assume that you have not been able to complete the recipe up to this point because you did not have an advanced license.</p>
<ol>
<li>Click on the Analysis tab in the ribbon.</li>
<li>Click on the Spatial Join tool in the Tools group on the Analysis tab. This will open the Spatial Join tool in the Geoprocessing pane.</li>
</ol>
<div><p>You can also find this tool in the Overlay analysis toolset in the Analysis Tools toolbox. The Spatial Join allows you to join layers or feature classes together based on many spatial relationships.</p>
</div>
<ol start="3">
<li>Set the Target Features to the Parcels layer using the drop-down arrow and selecting it from the list.</li>
<li>Set the Join Features to Fire Hydrants, also using the drop-down arrow.</li>
<li>Accept the default Output Feature Class, which should be something similar to Parcels_SpatialJoin.</li>
</ol>
<div><p>Unlike the Near tool, the Spatial Join tool creates a completely new feature class. It does not simply add new fields to an existing layer. This means that your original Parcels layer is left unchanged.</p>
</div>
<ol start="6">
<li>Set the Join Operation to Join one to one using the drop-down arrow. You are using the one to one option because only one hydrant should be the closest to each parcel.</li>
<li>Ensure the Keep All Target Features checkbox is checked. This will ensure the resulting output feature class will contain all the parcels, even if they do not have a fire hydrant nearby.</li>
<li>Scroll down to the Match Option and select Closest using the drop-down arrow. This is the spatial relationship that ArcGIS Pro will use to join the data. Closest is near the bottom of the list. Take the time to see what other options are available.</li>
<li>Set the Search Radius to 300 feet, as we did when using the Near tool. This limits the search for the closest fire hydrant to 300 feet.</li>
<li>Verify that your Spatial Join tool looks like the following, then click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-902 image-border" height="438" src="img/06495873-cf42-46ca-a0f8-df522f2b48a7.png" width="379"/></div>
<p>Depending on your computer, this tool may take a few minutes to run. So don’t be worried if it takes some time. This analysis requires a lot of processing to complete.</p>
<ol start="11">
<li>A new layer should appear in your Contents pane. This new layer is the result of the Spatial Join tool. Close the Geoprocessing pane.</li>
<li>Right-click on the new layer that was just added. Select Attribute table from the menu that appears.</li>
<li>The attribute table contains information from both the Parcels and Fire Hydrants layer. Take a moment to review the results.</li>
</ol>
<p style="padding-left: 60px">The Join_Count field tells you how many fire hydrants were joined to the parcels. Because you chose the Join one to one option, this number should either be a 1 or a 0. The Target_FID is the ObjectID for the closest fire hydrant to the parcel. The FireHyd_ID, X, Y, Picture, and Picture 2 fields all come from the closest fire hydrant to the parcel. The remaining fields all came from the parcels layer.</p>
<ol start="14">
<li>Close the attribute table when you are done.</li>
<li>Save your project and close ArcGIS Pro.</li>
</ol>
<p>So, you now have two ways to calculate the nearest feature in ArcGIS Pro. If you have an advanced license you can use either method. If you only have a basic or standard, then you must use the Spatial Join. If you can use either, which is best? That depends on what you need to do with the resulting data. The Spatial Join is best when you are creating data that is intermediate to a large process and will not be needed later. Otherwise, it creates yet another layer you must maintain. The Near tool does not create more data for you to manage. It only adds to an existing layer of information that you are already maintaining.  </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Calculating how far features are using the Generate Near Table tool</h1>
                
            
            
                
<p>You now know a couple of different ways to find the closest feature. What if you want to calculate the distance from one group of features to another group? Not just looking for the closest. The Generate Near Table tool can do this.</p>
<p>The Generate Near Table tool will create a new database table that lists how far the features in the input are from those in the near feature layer.</p>
<p>Like the Near tool, you have the option to include additional fields for location and angle as well. This tool also requires an advanced license.</p>
<p>The city of Trippville has several water quality monitoring stations that monitor the quality of the water in the creeks, streams, and rivers in the city. Recently, several of them have been reporting poor or bad water quality.</p>
<p>It is believed that this might be due to run off from an industrial site in the city.</p>
<p>In this recipe, you will use the Generate Near Table tool to identify all industrial parcels located near the stations reporting bad water quality. These will be the ones you need to inspect first to see if they are the cause of the bad water quality.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>You will need to make sure you have an advanced license for ArcGIS Pro to complete this recipe. You will not be able to do it with a basic or standard license. If you are not sure what license level you have or how to determine it, refer to <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>, and the recipe entitled <em>Determining your ArcGIS Pro license level</em>. That recipe will tell you how to determine your license level.</p>
<p>If you are limited to a basic or standard license, then please read through this recipe and then proceed with the <em>There’s more...</em> section, which can be completed with a lower license level.</p>
<p>It is also recommended that you complete the other recipes in this chapter before starting this one. This will ensure that you have a good basic understanding of proximity analysis within ArcGIS Pro.</p>
<p>You will also need to ensure the sample data is installed before you continue.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>You will start by launching ArcGIS Pro. Then open the <kbd>Near Table.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter8\Proximity Analysis</kbd> using the skills you have learned in past recipes. The project should open with the Trippville map. You will start by selecting the industrial-zoned parcels.</li>
<li>Activate the Map tab in the ribbon and select the Select by Attributes tool in the Selection group. The Select Layer by Attributes tool will open in the Geoprocessing pane.</li>
<li>Set the Layer Name or Table View to Zoning using the drop-down arrow and selecting it from the list.</li>
<li>Ensure the Selection Type is set to New selection.</li>
<li>Click on the Add Clause button to begin building your query.</li>
<li>Set the Field to ZONING using the drop-down arrow.</li>
<li>Make sure the operator is set to is Equal to.</li>
<li>The value should be set to HI using the drop-down arrow.</li>
<li>Verify that your query looks like the following, and click the Add button:</li>
</ol>
<div><img class="alignnone size-full wp-image-903 image-border" height="68" src="img/bd6aab47-bbe2-4adc-9f96-e0d0f35cf541.png" width="386"/></div>
<ol start="10">
<li>Click the Add Clause button again. The clause you just added will only select those parcels that are in the <strong>Heavy Industrial</strong> (<strong>HI</strong>) zone. You also need to select those that are <strong>Light Industrial</strong> (<strong>LI</strong>).</li>
<li>Where it says And, click the drop-down arrow and select Or.</li>
</ol>
<div><p>And and Or are clause connectors. They determine how clauses in a query work together. If you had left the query with And, then the selection would have to meet both clauses. Since a parcel cannot be zoned both heavy and light industrial, that means nothing would be selected. Or means it only has to meet the requirements of one of the two clauses. So in this case, the query will select all features that are zoned either light or heavy industrial. </p>
</div>
<ol start="12">
<li>Set the Field to ZONING, the operator to is Equal to, and the value to LI. Then, click Add once you verify it looks like the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-904 image-border" height="86" src="img/beb19731-5e09-4113-aa09-7b55e68ae682.png" width="368"/></div>
<ol start="13">
<li>Your Select Layer by Attributes tool should now contain two SQL Where clauses. This will select all the parcels that are zoned either light or heavy industrial. Verify that your tool looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-905 image-border" height="231" src="img/85c8851b-a75f-428d-81a5-b5fb4f491e36.png" width="365"/></div>
<p style="padding-left: 60px">When you run the query, approximately 152 parcels should be selected within the map. All of them should be zoned either light or heavy industrial. Next, you need to select the Water Quality Stations that are reporting bad water quality. You will do this with another Select by Attribute query.</p>
<ol start="14">
<li>If you closed the Geoprocessing pane with the Select Layer by Attribute tool, click on the Select by Attributes button in the Selection group on the Map tab. If it is still open, go to the next step.</li>
<li>In the Geoprocessing pane, ensure the Select Layer by Attribute tool is still active.</li>
<li>Set the Layer Name or Table View to Water Quality Station using the drop-down arrow. If your old query is still present in the expression, an error may appear when you make this change. You can ignore it for now as you will be creating a new query soon.</li>
<li>Ensure the Selection type is still set to New selection.</li>
<li>Click on the Clear Expression button located below the query expression. It looks like a small eraser, as illustrated in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-906 image-border" height="300" src="img/64709735-ee36-438e-9ef9-a112eb6b93d6.png" width="398"/></div>
<ol start="19">
<li>If you do not see the Add Clause button, click on the Switch to Edit Clause Mode button near the top of the expression area and below the word Expression, as illustrated in the following:</li>
</ol>
<div><img class="alignnone size-full wp-image-907 image-border" height="265" src="img/ca458fc3-f987-435c-ba1a-d46b18168815.png" width="409"/></div>
<ol start="20">
<li>Click on the Add Clause button.</li>
<li>Set the Field to Current Status, the operator to is Equal to, and the value to Bad, all using the drop-down arrows.</li>
<li>Verify that your expression looks like the following, then click the Add button:</li>
</ol>
<div><img class="alignnone size-full wp-image-908 image-border" height="124" src="img/58e8481d-5fb9-4ea7-a409-28d15e24373c.png" width="491"/></div>
<ol start="23">
<li>Verify that your Select Layer by Attribute tool looks like the following, and then click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-909 image-border" height="328" src="img/c92c7856-c4f1-4279-94b2-62924269ab34.png" width="502"/></div>
<ol start="24">
<li>In the Contents pane, click on the List by Selection button. It is the third one from the left. You should now have approximately two Water Quality Stations and 151 Zoning polygons selected.</li>
</ol>
<p style="padding-left: 60px">Now that you have selected the appropriately zoned parcels and water quality stations, you need to create the table that lists which of the selected parcels is near the selected water quality stations. You will limit your search to a 1,500 feet radius around the water quality stations.</p>
<ol start="25">
<li>Click on the Analysis tab in the ribbon.</li>
<li>Click on the Generate Near Table tool in the Tools group. If you don’t see the tool, click on the arrows located on the right side of the group to navigate up and down in the list of tools in the group.</li>
<li>The Generate Near Table tool will appear in the Geoprocessing pane. Set the Input Features to Water Quality Station using the drop-down arrow.</li>
<li>Set the Near Features to Zoning using the drop-down arrow on the far-right side.</li>
<li>Accept the default value ArcGIS Pro generates for the Output Table.</li>
</ol>
<div><p>This tool is creating a new table. By default, the table is being stored in the Project Geodatabase. This happens to be the Proximity Analysis geodatabase.</p>
</div>
<ol start="30">
<li>Set the Search Radius to 1,500 feet by typing <kbd>1500</kbd> and verifying the units.</li>
<li>Uncheck the Find only closest feature if it is checked. You want to find all industrial zoned-parcels within 1500 feet of the water quality monitoring stations that are reporting bad quality, not just the closest one. Leave the maximum number of closest matches to 0. This will ensure all matches within 1500 feet are returned.</li>
<li>The Method should be set to Planar.</li>
</ol>
<ol start="33">
<li>Verify that your Generate Near Table tool looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-910 image-border" height="328" src="img/a3972452-82dd-40bf-b5f6-d26c8e5d8d71.png" width="431"/></div>
<p style="padding-left: 60px">When the tool finishes, a new standalone table should appear in your Contents pane. This table is the results of the tool you just ran. Let’s take a look at the results.</p>
<ol start="34">
<li>Close the Geoprocessing pane.</li>
<li>Right-click on the new table you just created, which was added to the Contents pane. Select Open from the menu that appears.</li>
</ol>
<div><p>As we have mentioned before, geoprocessing tools, such as the Create Near Table tool, only use selected features automatically. Since you selected specific features in the Water Quality Stations and Zoning layers, this tool only used those selected features to run its analysis.</p>
</div>
<ol start="36">
<li>Review the newly created table.</li>
</ol>
<p style="padding-left: 60px">In the new table, you should see several fields. The IN_FID field contains the object id for the Water Quality Station. You should see a value of 3 or 4 which matches the object id for those stations in the attribute table for the Water Quality Stations that have a current status of Bad. The Near_FID field contains the object id of the nearby industrial-zoned parcel. Each water quality station should be paired with multiple parcels. The Near_Rank field identifies which is closest to each water quality station. This helps you prioritize which parcels you should begin with.</p>
<ol start="37">
<li>Close the table and save your project.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">There’s more…</h1>
                
            
            
                
<p>So, can you do this without an advanced license of ArcGIS Pro? The answer is yes. You can use the Spatial Join tool to accomplish something very similar. However, the result is not a table. It is a new feature class that will contain many overlapping features. If you just want a table, you can then export the records from the results of the Spatial Join tool to a new table. Here is how all that works:</p>
<ol>
<li>If you still have the features selected from the Water Quality Station and Zoning layers, proceed to the next step. If you do not, repeat <em>steps 2-24</em> from the recipe. You should have two Water Quality Stations and 151 Zoning polygons selected.</li>
<li>Click on the Analysis tab in the ribbon. Then select the Spatial Join tool in the Tools group. This will open the tool in the Geoprocessing window.</li>
<li>Set the Target Features to Water Quality Station using the drop-down arrow.</li>
<li>Set the Join Features to Zoning using the drop-down arrow.</li>
<li>Click the Browse button to set the Output Feature Class.</li>
<li>Select databases from the panel on the left. Then double-click on the Proximity Analysis.gdb geodatabase in the panel on the right.</li>
<li>Type <kbd>WaterQual_IndustZoned_SpatialJoin</kbd> into the Name and click Save.</li>
<li>Set the Join Operation to Join one to many. This will ensure the result has all the industrial-zoned parcels within 1,500 feet of the water quality stations reporting bad quality.</li>
<li>Set the Match Option to Within a distance using the drop-down arrow.</li>
<li>Set the Search Radius to 1,500 feet.</li>
</ol>
<ol start="11">
<li>Verify that your Spatial Join tool looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-911 image-border" height="442" src="img/ed89edfa-f094-4328-b51f-ae9ce3acb816.png" width="367"/></div>
<ol start="12">
<li>A new layer will appear in your Contents pane. This is the results of the Spatial Join tool. Close the Geoprocessing pane.</li>
<li>Select the List by Draw Order in the Contents pane. It is the first button at the top-left of the pane.</li>
<li>Click on the Map tab in the ribbon. Then click on the Clear button in the Selection group. You should now be able to see what looks like two new features that overlap the two Water Quality Stations that had bad water quality. Time to verify how many features are actually in those locations.</li>
<li>Right-click on the new layer and select Zoom to Layer.</li>
<li>Select the new layer in the Contents pane.</li>
</ol>
<ol start="17">
<li>Click on the drop-down arrow located below the Explore tool and select Selected in Contents. Now click on one of the two new features. The information popup should appear when you click on one of the features.</li>
<li>Look at the lower-left corner of the information popup to see how many features are actually in the location you selected. If you clicked on the northernmost location, you should have about 30 features. If you clicked on the southernmost location, you should have about 14 features. This is illustrated in the following:</li>
</ol>
<div><img class="alignnone size-full wp-image-912 image-border" height="433" src="img/79e98985-70e3-4333-b411-4e8d7636d92f.png" width="785"/></div>
<ol start="19">
<li>Right-click on the new layer and select Attribute Table to look at the resulting attributes. Review the table and see if you can identify what the fields mean and where they came from.</li>
<li>Close the attribute table and save your project.</li>
<li>Close ArcGIS Pro.</li>
</ol>
<p>As you can see, you have created another new feature class. If you wanted to export this as a standalone table, you could right-click on the layer and go to Data. Then select Export Table. If you wanted to export it to an Excel spreadsheet you could use the Table to Excel tool you have used in past recipes.</p>


            

            
        
    </body></html>