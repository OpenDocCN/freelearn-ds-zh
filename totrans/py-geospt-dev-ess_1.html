<html><head></head><body>
  <div id="sbo-rt-content"><div class="chapter" title="Chapter 1. Preparing to Build Your Own GIS Application"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Preparing to Build Your Own GIS Application</h1></div></div></div><p>You are here because you love Python programming and are interested in making your own <span class="strong"><strong>Geographic Information Systems</strong></span> (<span class="strong"><strong>GIS</strong></span>) application. You want to create a desktop application, in other words, a user interface, that helps you or others create, process, analyze, and visualize geographic data. This book will be your step-by-step guide toward that goal.</p><p>We assume that you are someone who <a id="id0" class="indexterm"/>enjoys programming and being creative but are not necessarily a computer science guru, Python expert, or seasoned GIS analyst. To successfully proceed with this book, it is recommended that you have a basic introductory knowledge of Python programming that includes classes, methods, and<a id="id1" class="indexterm"/> the <span class="strong"><strong>Tkinter</strong></span> toolkit, as well as some core GIS concepts. If you are a newcomer to some of these, we will still cover some of the basics, but you will need to have the interest and ability to follow along at a fast pace.</p><p>In this introductory chapter, you will cover the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Learn some of the benefits of creating a GIS application from scratch</li><li class="listitem" style="list-style-type: disc">Set up your computer, so you can follow the book instructions.</li><li class="listitem" style="list-style-type: disc">Become familiar with the roadmap toward creating our application.</li></ul></div><div class="section" title="Why reinvent the wheel?"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Why reinvent the wheel?</h1></div></div></div><p>The first step in preparing ourselves for this book is in convincing ourselves why we want to make our own GIS application, as well as to be clear about our motives. Spatial analysis and GIS have been popular for decades and there is plenty of GIS software out there, so why go through the trouble of reinventing the wheel? Firstly, we aren't really reinventing the wheel, since Python can be extended with plenty of third-party libraries that take care of most of our geospatial needs (more on that later).</p><p>For me, the main motivation stems from the problem that most of today's GIS applications are aimed <a id="id2" class="indexterm"/>at highly capable and technical users who are well-versed in GIS or computer science, packed with a dizzying array of buttons and options that will scare off many an analyst. We believe that there is a virtue in trying to create a simpler and more user-friendly software for beginner GIS users or even the broader public, without having to start completely from scratch. This way, we also add more alternatives for users to choose from, as supplements to the current GIS market dominated by a few major giants, notably ArcGIS and QGIS, but also others such as GRASS, uDig, gvSIG, and more.</p><p>Another particularly exciting reason to create your own GIS from scratch is to make your own domain-specific special purpose<a id="id3" class="indexterm"/> software for any task you can imagine, whether it is a water flow model GIS, an ecological migrations GIS, or even a GIS for kids. Such specialized tasks that would usually require many arduous steps in an ordinary GIS, could be greatly simplified into a single button and accompanied with suitable functionality, design layout, icons, and colors. One such <a id="id4" class="indexterm"/>example is the <span class="strong"><strong>Crime Analytics for Space-Time</strong></span> (<span class="strong"><strong>CAST</strong></span>) software produced by the GeoDa Center at Arizona State University, seen in the following picture:</p><div class="mediaobject"><img src="images/5407OS_01_01.jpg" alt="Why reinvent the wheel?"/></div><p>Also, by creating your GIS from scratch, it is possible to have greater control of the size and portability of your application. This can enable you to go small—letting your application have faster startup time, and travel the Internet or on a USB-stick easily. Although storage space itself is not as much of an issue these days, from a user's perspective, installing a 200 MB application is still a greater psychological investment with a greater toll in terms of willingness to try it than a mere 30 MB application (all else being equal). This is particularly true in the realm of smartphones and tablets, a very exciting market for special-purpose<a id="id5" class="indexterm"/> geospatial apps. While the specific application we make in this book will not be able to run on iOS or Android devices, it will run on Windows 8-based hybrid tablets, and can be rebuilt around a different GUI toolkit in order to support iOS or Android (we will mention some very brief suggestions for this in <a class="link" href="ch08.html" title="Chapter 8. Looking Forward">Chapter 8</a>, <span class="emphasis"><em>Looking Forward</em></span>).</p><p>Finally, the utility and philosophy of free and open source software may be an important motivation for some of you. Many people today, learn to appreciate open source GIS after losing access to subscription-based applications like ArcGIS when they complete their university education or change their workplace. By developing your own open source GIS application and sharing with others, you can contribute back to and become part of the community that once helped you.</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Setting up your computer"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Setting up your computer</h1></div></div></div><p>In this book, we follow steps on how to make an application that is developed in a Windows environment. This does not mean that the application cannot be developed on Mac OS X or Linux, but<a id="id6" class="indexterm"/> those platforms may have slightly different installation instructions and may require compiling of the binary code that is outside the scope of this book. Therefore, we leave that choice up to the reader. In this book, which focuses on Windows, we avoid the problem of compiling it altogether, using precompiled versions where possible (more on this later).</p><p>The development process itself will be done using Python 2.7, specifically the 32-bit version, though 64-bit can theoretically be used as well (note that this is the bit version of your Python installation and has nothing to do with the bit version of your operating system). Although there exists many newer versions, version 2.7 is the most widely supported in terms of being able to use third-party packages. It has also been reported that the version 2.7 will continue to be actively developed and promoted until the year 2020. It will still be possible to use after support has ended. If you do not already have version 2.7, install it now, by following these<a id="id7" class="indexterm"/> steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <a class="ulink" href="https://www.python.org/">https://www.python.org/</a>.</li><li class="listitem">Under <span class="strong"><strong>Downloads</strong></span> click on download the latest 32-bit version of Python 2.7 for Windows, which at the time of this writing is Python 2.7.9.</li><li class="listitem">Download and run the installation program.</li></ol></div><p>For the actual code writing and editing, we will be using the built-in <span class="strong"><strong>Python Interactive Development Environment</strong></span> (<span class="strong"><strong>IDLE</strong></span>), but you<a id="id8" class="indexterm"/> may of course use any code editor you want. The IDLE lets you write long scripts that can be saved to files and offers an interactive shell window to execute one line at a time. There should be a desktop or start-menu link to Python IDLE after installing Python.</p></div></div>


  <div id="sbo-rt-content"><div class="section" title="Installing third-party packages"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Installing third-party packages</h1></div></div></div><p>In order to make <a id="id9" class="indexterm"/>our application, we will have to rely on the rich and varied ecosystem of third-party packages that already exists for GIS usage.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p><span class="strong"><strong>The Python Package Index</strong></span> (<span class="strong"><strong>PyPI</strong></span>) website currently<a id="id10" class="indexterm"/> lists more than 240 packages tagged <span class="strong"><strong>Topic :: Scientific/Engineering :: GIS</strong></span>. For a less overwhelming overview of the more popular GIS-related Python libraries, check out the catalogue at the <span class="emphasis"><em>Python-GIS-Resources</em></span> website created<a id="id11" class="indexterm"/> by the author:</p><p><a class="ulink" href="http://pythongisresources.wordpress.com/">http://pythongisresources.wordpress.com/</a></p></div></div><p>We will have to define which packages to use and install, and this depends on the type of application we are making. What we want to make in this book is a lightweight, highly portable, extendable, and general-purpose GIS application. For these reasons, we avoid heavy packages like GDAL, NumPy, Matplotlib, SciPy, and Mapnik (weighing in at about 30 MB each or about 150-200 MB if we combine them all together). Instead, we focus on lighter third-party packages specialized for each specific functionality.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>Dropping these heavy packages is a bold decision, as they contain a lot of functionality, and are reliable, efficient, and a dependency for many other packages. If you decide that you want to use them in an application where size is not an issue, you may want to begin now by installing the multipurpose NumPy and possibly SciPy, both of which have easy-to-use installers from their official websites. The other heavy packages will be briefly revisited in later chapters.</p></div></div><p>Specific installation instructions are given for each package in the chapter where they are relevant (see the following table for an overview) so that if you do not want certain functionalities, you can ignore those installations. Due to our focus to make a basic and lightweight application, we will only be installing a small number of packages. However, we will provide suggestions throughout the book about other relevant packages that you may wish to add later on.</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Chapter</p>
</th><th style="text-align: left" valign="bottom">
<p>Installation</p>
</th><th style="text-align: left" valign="bottom">
<p>Purpose</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>1</p>
</td><td style="text-align: left" valign="top">
<p>Python</p>
</td><td style="text-align: left" valign="top"> </td></tr><tr><td style="text-align: left" valign="top">
<p>1</p>
</td><td style="text-align: left" valign="top">
<p>PIL</p>
</td><td style="text-align: left" valign="top">
<p>Raster data, management, and analysis</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>1</p>
</td><td style="text-align: left" valign="top">
<p>Shapely</p>
</td><td style="text-align: left" valign="top">
<p>Vector management and analysis</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>2</p>
</td><td style="text-align: left" valign="top">
<p>PyShp</p>
</td><td style="text-align: left" valign="top">
<p>Data</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>2</p>
</td><td style="text-align: left" valign="top">
<p>PyGeoj</p>
</td><td style="text-align: left" valign="top">
<p>Data</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>2</p>
</td><td style="text-align: left" valign="top">
<p>Rtree</p>
</td><td style="text-align: left" valign="top">
<p>Vector data speedup</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>4</p>
</td><td style="text-align: left" valign="top">
<p>PyAgg</p>
</td><td style="text-align: left" valign="top">
<p>Visualization</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>7</p>
</td><td style="text-align: left" valign="top">
<p>Py2exe</p>
</td><td style="text-align: left" valign="top">
<p>Application distribution</p>
</td></tr></tbody></table></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>The typical way to install Python packages is using <code class="literal">pip</code> (included with Python 2.7), which downloads and installs packages directly from the Python Package Index website. <code class="literal">Pip</code> is used in<a id="id12" class="indexterm"/> the following way:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Step 1—open your<a id="id13" class="indexterm"/> operating system's command line (not the Python IDLE). On Windows, this is done by searching your system for <code class="literal">cmd.exe</code> and running it.</li><li class="listitem" style="list-style-type: disc">Step 2—in the black screen window that pops up, one simply types <code class="literal">pip install packagename</code>. This will only work if <code class="literal">pip</code> is on your system's environment path. If this is not the case, a quick fix is to simply type the full path to the <code class="literal">pip</code> script <code class="literal">C:\Python27\Scripts\pip</code> instead of just <code class="literal">pip</code>.</li></ul></div><p>For C or C++ based packages, it is becoming increasingly popular to make them available as precompiled <span class="strong"><strong>wheel</strong></span> files<a id="id14" class="indexterm"/> ending in <code class="literal">.whl</code>, which has caused some confusion on how to install them. Luckily, we can use <code class="literal">pip</code> to install these wheel files as well, by simply downloading the wheel and pointing <code class="literal">pip</code> to its file path.</p></div></div><p>Since some of our dependencies have multiple purposes and are not unique to just one chapter, we will install these ones now. One of them is the <span class="strong"><strong>Python Imaging Library</strong></span> (<span class="strong"><strong>PIL</strong></span>), which we will use for the raster data model <a id="id15" class="indexterm"/>and for visualization. Let's go ahead and install PIL for Windows now:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <a class="ulink" href="https://pypi.python.org/pypi/Pillow/2.6.1">https://pypi.python.org/pypi/Pillow/2.6.1</a>.</li><li class="listitem">Click on the latest <code class="literal">.exe</code> file link for our 32-bit Python 2.7 environment to download the PIL installer, which is currently <code class="literal">Pillow-2.6.1.win32-py2.7.exe</code>.</li><li class="listitem">Run the installation file.</li><li class="listitem">Open the IDLE interactive shell and type <code class="literal">import PIL</code> to make sure it was installed correctly.</li></ol></div><p>Another central package we will be using is Shapely, used for location testing and geometric manipulation. To install it on <a id="id16" class="indexterm"/>Windows, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <a class="ulink" href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#shapely">http://www.lfd.uci.edu/~gohlke/pythonlibs/#shapely</a>.</li><li class="listitem">Download the Shapely wheel file that fits our system, looking something like <code class="literal">Shapely‑1.5.7‑cp27‑none‑win32.whl</code>.</li><li class="listitem">As described earlier, open a command line window and type <code class="literal">C:\Python27\Scripts\pip install path\to\Shapely‑1.5.7‑cp27‑none‑win32.whl</code> to unpack the precompiled binaries.</li><li class="listitem">To make sure it was<a id="id17" class="indexterm"/> installed correctly, open the IDLE interactive shell and type <code class="literal">import shapely</code>.</li></ol></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Imagining the roadmap ahead"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Imagining the roadmap ahead</h1></div></div></div><p>Before we begin developing our application, it is important that we create a vision of how we want to structure <a id="id18" class="indexterm"/>our application. In Python terms, we will be creating a multilevel package with various subpackages and submodules to take care of different parts of our functionality, independently of any user interface. Only on top of this underlying functionality do we create the visual user interface as a way to access and run that underlying code. This way, we build a solid system, and allow power-users to access all the same functionality via Python scripting for greater automation and efficiency, as exists for ArcGIS and QGIS.</p><p>To setup the main Python package behind our application, create a new folder called <code class="literal">pythongis</code> anywhere on your computer. For Python to be able to interpret the folder <code class="literal">pythongis</code> as an importable package, it needs to find a file named <code class="literal">__init__.py</code> in that folder. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <span class="strong"><strong>Python IDLE</strong></span> from the Windows start menu.</li><li class="listitem">The first window to pop up is the interactive shell. To open the script editing window click on <span class="strong"><strong>File</strong></span> and <span class="strong"><strong>New</strong></span>.</li><li class="listitem">Click on <span class="strong"><strong>File</strong></span> and then <span class="strong"><strong>Save As</strong></span>.</li><li class="listitem">In the dialog window that pops up, browse into the <code class="literal">pythongis</code> folder, type <code class="literal">__init__.py</code> as the filename, and click on <span class="strong"><strong>Save</strong></span>.</li></ol></div><p>There are two main types of GIS data: <span class="strong"><strong>vector</strong></span> (coordinate-based <a id="id19" class="indexterm"/>geometries such as points, lines, and polygons) and <span class="strong"><strong>raster</strong></span> (a regularly spaced out grid of data points or cells, similar to<a id="id20" class="indexterm"/> an image and its pixels).</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>For a more detailed introduction to the differences between vector and raster data, and other basic GIS concepts, we refer the reader to the book <span class="emphasis"><em>Learning Geospatial Analysis with Python</em></span>, by<a id="id21" class="indexterm"/> Joel Lawhead. You can find this book at:</p><p><a class="ulink" href="https://www.packtpub.com/application-development/learning-geospatial-analysis-python">https://www.packtpub.com/application-development/learning-geospatial-analysis-python</a></p></div></div><p>Since vector and raster data are so fundamentally different in all regards, we split our package in two, one for vector and one for raster. Using the same method as earlier, we create two new subpackage<a id="id22" class="indexterm"/> folders within the <code class="literal">pythongis</code> package; one called <code class="literal">vector</code> and one called <code class="literal">raster</code> (each with the same aforementioned empty <code class="literal">__init__.py</code> file). Thus, the structure of our package will look as follows (note that <code class="literal">: package</code> is not part of the folder name):</p><div class="mediaobject"><img src="images/5407OS_01_02.jpg" alt="Imagining the roadmap ahead"/></div><p>To make our new <code class="literal">vector</code> and <code class="literal">raster</code> subpackages importable by our top level <code class="literal">pythongis</code> package, we need to add the following relative import statements in <code class="literal">pythongis/__init__.py</code>:</p><div class="informalexample"><pre class="programlisting">from . import vector
from . import raster</pre></div><p>Throughout the course of this book, we will build the functionality of these two data types as a set of Python modules in their respective folders. Eventually, we want to end up with a GIS application that has only the most basic of geospatial tools so that we will be able to load, save, manage, visualize, and overlay data, each of which will be covered in the following chapters.</p><p>As far as our final product goes, since we focus on clarity and simplicity, we do not put too much effort into making it fast or memory efficient. This comes from an often repeated saying among programmers, an example of which is found in <span class="emphasis"><em>Structured Programming with go to Statements</em></span>, ACM, Computing Surveys 6 (4):</p><div class="blockquote"><table border="0" width="100%" cellspacing="0" cellpadding="0" class="blockquote" summary="Block quote"><tr><td valign="top"> </td><td valign="top"><p><span class="emphasis"><em>premature optimization is the root of all evil</em></span></p></td><td valign="top"> </td></tr><tr><td valign="top"> </td><td colspan="2" align="right" valign="top" style="text-align: center">--<span class="attribution"><span class="emphasis"><em>Donald E. Knuth</em></span></span></td></tr></table></div><p>This leaves us with software that works best with small files, which in most cases is good enough. Once you have a working application and you feel that you need support for larger or faster files, then it's up to you if you want to put in the extra effort of optimization.</p><p>The GIS application you end up with at the end of the book is simple but functional, and is meant to serve as a framework that you can easily build on. To leave you with some ideas to pick up on, we placed various information boxes throughout the book with ways that you can optimize or <a id="id23" class="indexterm"/>extend your application. For any of the core topics and features that we were not able to cover earlier in the book, we give a broader discussion of missing functionality and future suggestions in the final chapter.</p></div></div>


  <div id="sbo-rt-content"><div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Summary</h1></div></div></div><p>In this chapter, you learned about why you want to create a GIS application using Python, set up our programming environment, installed some recurring packages, and created your application structure and framework.</p><p>In the next chapter, you will take the first step toward making a geospatial application, by creating a simple yet powerful module for loading and saving some common geospatial data formats from scratch.</p></div></div>
</body></html>