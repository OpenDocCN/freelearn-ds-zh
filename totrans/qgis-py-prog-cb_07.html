<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;7.&#xA0;Interacting with the User"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07" class="calibre1"/>Chapter 7. Interacting with the User</h1></div></div></div><p class="calibre9">In this chapter, we will cover the following recipes:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Using log files</li><li class="listitem">Creating a simple message dialog</li><li class="listitem">Creating a warning dialog</li><li class="listitem">Creating an error dialog</li><li class="listitem">Displaying a progress bar</li><li class="listitem">Creating a simple text input dialog</li><li class="listitem">Creating a file input dialog</li><li class="listitem">Creating a combobox</li><li class="listitem">Creating radio buttons</li><li class="listitem">Creating checkboxes</li><li class="listitem">Creating tabs</li><li class="listitem">Stepping the user through a wizard</li><li class="listitem">Keeping dialogs on top</li></ul></div></div>

<div class="book" title="Chapter&#xA0;7.&#xA0;Interacting with the User">
<div class="book" title="Introduction"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch07lvl1sec120" class="calibre1"/>Introduction</h1></div></div></div><p class="calibre9">QGIS has been built using the comprehensive graphical user interface framework called Qt. Both QGIS and Qt have Python APIs. In this chapter, we'll learn how to interact with the user in order to collect and display information outside the default QGIS interface. Qt has excellent documentation of its own, and since QGIS is built on top of Qt, all of this documentation applies to QGIS. You can find the <a id="id571" class="calibre1"/>Qt documentation at <a class="calibre1" href="http://qt-project.org">http://qt-project.org</a>.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Using log files"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec121" class="calibre1"/>Using log files</h1></div></div></div><p class="calibre9">Log files <a id="id572" class="calibre1"/>provide a way to track exactly what is going on in a Python plugin or script, by creating messages that are available even if the script or QGIS crashes. These log messages make troubleshooting easier. In this recipe, we'll demonstrate two methods used for logging. One method is using actual log files on the filesystem, and the other is using the QGIS <span class="strong"><strong class="calibre2">Log Messages</strong></span> window, which is available by clicking on the yellow triangle with an exclamation point at the bottom-right corner of the QGIS application window, or by selecting <span class="strong"><strong class="calibre2">View</strong></span> menu, then clicking on <span class="strong"><strong class="calibre2">Panels</strong></span>, and then checking <span class="strong"><strong class="calibre2">Log Messages</strong></span>.</p></div>

<div class="book" title="Using log files">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec348" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">To use log files, we<a id="id573" class="calibre1"/> must configure the <code class="literal">QGIS_LOG_FILE</code> environment variable by performing the following steps so that QGIS knows where to write log messages:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">From the QGIS <span class="strong"><strong class="calibre2">Settings</strong></span> menu, select <span class="strong"><strong class="calibre2">Options</strong></span>.</li><li class="listitem" value="2">In the <span class="strong"><strong class="calibre2">Options</strong></span> dialog, select <span class="strong"><strong class="calibre2">System</strong></span> panel.</li><li class="listitem" value="3">In the <span class="strong"><strong class="calibre2">System</strong></span> panel, scroll down to the <span class="strong"><strong class="calibre2">Environment</strong></span> section.</li><li class="listitem" value="4">In the <span class="strong"><strong class="calibre2">Environment</strong></span> section, check the <span class="strong"><strong class="calibre2">Use custom variables</strong></span> checkbox.</li><li class="listitem" value="5">Click on the <span class="strong"><strong class="calibre2">Add</strong></span> button.</li><li class="listitem" value="6">In the <span class="strong"><strong class="calibre2">Variable</strong></span> field, enter <code class="literal">QGIS_LOG_FILE</code>.</li><li class="listitem" value="7">In the <span class="strong"><strong class="calibre2">Value</strong></span> field, enter <code class="literal">/qgis_data/log.txt</code> or the path to another directory where you have write permissions.</li><li class="listitem" value="8">Click on the <span class="strong"><strong class="calibre2">OK </strong></span>button to close the <span class="strong"><strong class="calibre2">Options</strong></span> dialog.</li><li class="listitem" value="9">Restart QGIS for the environment variable to take effect.</li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Using log files">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec349" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">We will write a message to our custom log file configured in the previous section, and then write a message to the tabbed QGIS <span class="strong"><strong class="calibre2">Log Messages</strong></span> window. To do this, we need to perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, open the <span class="strong"><strong class="calibre2">Python Console</strong></span> in QGIS.</li><li class="listitem" value="2">Next, we'll write the following log file message:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">QgsLogger.logMessageToFile("This is a message to a log file.")</strong></span>
</pre></div></li><li class="listitem" value="3">Then, we'll write a message to the QGIS <span class="strong"><strong class="calibre2">Log Messages</strong></span> window, specifying the message as the first argument and a name for the tab in which the message will appear:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">QgsMessageLog.logMessage("This is a message from the Python Console", "Python Console")</strong></span>
</pre></div></li><li class="listitem" value="4">Now, open the log file and check whether the message has appeared.</li><li class="listitem" value="5">Finally, open<a id="id574" class="calibre1"/> the QGIS <span class="strong"><strong class="calibre2">Log Messages</strong></span> window, click on the <span class="strong"><strong class="calibre2">Python Console</strong></span> tab, and verify that the second log message appears.</li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Using log files">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec350" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">The traditional log file<a id="id575" class="calibre1"/> provides a simple and portable way to record information from QGIS using Python. The <span class="strong"><strong class="calibre2">Log Messages</strong></span> window is a more structured way to view information from many different sources, with a tabbed interface and a convenient timestamp on each message. In most cases, you'll probably want to use the <span class="strong"><strong class="calibre2">Log Messages</strong></span> window because QGIS users are familiar with it. However, use it sparingly. It's OK to log lots of messages when testing code, but restrict logging for plugins or applications to serious errors only. Heavy logging — for example, logging messages while looping over every feature in a layer — can slow down QGIS or even cause it to crash.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating a simple message dialog"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec122" class="calibre1"/>Creating a simple message dialog</h1></div></div></div><p class="calibre9">Message dialogs<a id="id576" class="calibre1"/> pop up to grab the user's attention and to display important information. In this recipe, we'll create a simple information dialog.</p></div>

<div class="book" title="Creating a simple message dialog">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec351" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python</strong></span> <span class="strong"><strong class="calibre2">Console</strong></span> by going to the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and selecting <span class="strong"><strong class="calibre2">Python</strong></span> <span class="strong"><strong class="calibre2">Console</strong></span>.</p></div></div>

<div class="book" title="Creating a simple message dialog">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec352" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">We will create a message dialog and display some text in it, as follows:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we need to import the GUI library:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Then, we'll create the message dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg = QMessageBox()</strong></span>
</pre></div></li><li class="listitem" value="3">Next, we'll set the message we want to display:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg.setText("This is a simple information message.")</strong></span>
</pre></div></li><li class="listitem" value="4">Finally, we call the execution method to display the message dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg.show()</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating a simple message dialog">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec353" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">Note that we are <a id="id577" class="calibre1"/>directly using the underlying Qt framework from which QGIS is built. QGIS API's objects begin with <code class="literal">Qgs</code>, while Qt objects begin with just the letter <code class="literal">Q</code>.</p></div></div>

<div class="book" title="Creating a simple message dialog">
<div class="book" title="There's more…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch07lvl2sec354" class="calibre1"/>There's more…</h2></div></div></div><p class="calibre9">A message dialog box should also be used sparingly because it is a popup that can become annoying to the user or can get lost in the array of open windows and dialogs on a user's desktop. The preferred method for a QGIS information message is to use the <code class="literal">QgsMessageBar() method</code>, which is well-documented in the <a id="id578" class="calibre1"/>PyQGIS Developer Cookbook found at <a class="calibre1" href="http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/communicating.html">http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/communicating.html</a>
</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating a warning dialog"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec123" class="calibre1"/>Creating a warning dialog</h1></div></div></div><p class="calibre9">Sometimes, you<a id="id579" class="calibre1"/> need to notify a user when an issue is detected, which might lead to problems if the user continues. This situation calls for a warning dialog, which we will demonstrate in this recipe.</p></div>

<div class="book" title="Creating a warning dialog">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec355" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS<span class="strong"><strong class="calibre2"> Python Console</strong></span> by going to the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and selecting <span class="strong"><strong class="calibre2">Python Console</strong></span>.</p></div></div>

<div class="book" title="Creating a warning dialog">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec356" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">In this recipe, we will create a dialog, set the warning message and a warning icon, and display the dialog, as follows:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we import the GUI library:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we initialize the warning dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg = QMessageBox()</strong></span>
</pre></div></li><li class="listitem" value="3">Then, we set the warning message:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg.setText("This is a warning...")</strong></span>
</pre></div></li><li class="listitem" value="4">Now, add a warning icon to the dialog that has an enumeration index of <code class="literal">2</code>:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg.setIcon(QMessageBox.Warning)</strong></span>
</pre></div></li><li class="listitem" value="5">Finally, we call the execution method to display the dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg.show()</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating a warning dialog">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec357" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">Message dialogs should<a id="id580" class="calibre1"/> be used sparingly because they interrupt the user experience and can easily become annoying. However, sometimes it is important to prevent a user from taking an action that may cause data corruption or a program to crash.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating an error dialog"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec124" class="calibre1"/>Creating an error dialog</h1></div></div></div><p class="calibre9">You can<a id="id581" class="calibre1"/> issue an error dialog box when you need to end a process due to a serious error. In this recipe, we'll create an example of an error dialog.</p></div>

<div class="book" title="Creating an error dialog">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec358" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console</strong></span> by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python Console</strong></span>.</p></div></div>

<div class="book" title="Creating an error dialog">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec359" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">In this recipe, we will create a dialog, assign an error message, set an error icon, and display the dialog, as follows:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we need to import the GUI library:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we initialize the dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg = QMessageBox()</strong></span>
</pre></div></li><li class="listitem" value="3">Then, we set the error message:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg.setText("This is an error!")</strong></span>
</pre></div></li><li class="listitem" value="4">Subsequently, we set an icon number for the error icon:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg.setIcon(QMessageBox.Critical)</strong></span>
</pre></div></li><li class="listitem" value="5">Finally, we execute the error dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg.show()</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating an error dialog">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec360" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">An important feature <a id="id582" class="calibre1"/>of modal windows is that they always stay on top of the application, regardless of whether the user changes the window's focus. This feature ensures that the user addresses the dialog before they proceed.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Displaying a progress bar"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec125" class="calibre1"/>Displaying a progress bar</h1></div></div></div><p class="calibre9">A progress bar<a id="id583" class="calibre1"/> is a dynamic dialog that displays the percentage complete bar for a running process that the user must wait for before continuing. A progress bar is more advanced than a simple dialog because it needs to be updated continuously. In this recipe, we'll create a simple progress dialog based on a timer.</p></div>

<div class="book" title="Displaying a progress bar">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec361" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">No groundwork is required for this recipe.</p></div></div>

<div class="book" title="Displaying a progress bar">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec362" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">The steps for this<a id="id584" class="calibre1"/> recipe include creating a custom class based on the <code class="literal">QProgressBar</code>, initializing the dialog and setting its size and title, creating a timer, connecting the progress bar to the timer, starting the time, and displaying the progress. To do this, we need to perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we must import both the GUI and QGIS core libraries:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
<span class="strong"><strong class="calibre2">from PyQt4.QtCore import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we create a custom class for our progress bar, including a method to increase the value of the progress bar:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">class Bar(QProgressBar):</strong></span>
<span class="strong"><strong class="calibre2">  value = 0</strong></span>
<span class="strong"><strong class="calibre2">  def increaseValue(self):</strong></span>
<span class="strong"><strong class="calibre2">    self.setValue(self.value)</strong></span>
<span class="strong"><strong class="calibre2">    self.value = self.value+1</strong></span>
</pre></div></li><li class="listitem" value="3">Now, we set the progress bar:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">bar = Bar()</strong></span>
</pre></div></li><li class="listitem" value="4">Next, we set the progress bar's size and title:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">bar.resize(300,40)</strong></span>
<span class="strong"><strong class="calibre2">bar.setWindowTitle('Working...')</strong></span>
</pre></div></li><li class="listitem" value="5">Then, we initialize the timer, which will serve as the process we monitor:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">timer = QTimer()</strong></span>
</pre></div></li><li class="listitem" value="6">Now, connect the the timer's <code class="literal">timeout</code> signal to the <code class="literal">increaseValue</code> method, which we created earlier. Whenever the timer finishes its countdown, it will emit the <code class="literal">timeout</code> signal and notify the <code class="literal">increaseValue</code> method.<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">timer.timeout.connect(bar.increaseValue)</strong></span>
</pre></div></li><li class="listitem" value="7">Now, we <a id="id585" class="calibre1"/>will start the timer, specifying an interval of <code class="literal">500</code> milliseconds. The timer will call its <code class="literal">timeout()</code> signal every 0.5 seconds:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">timer.start(500)</strong></span>
</pre></div></li><li class="listitem" value="8">Finally, we show the progress bar and start the progress meter:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">bar.show()</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Displaying a progress bar">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec363" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">The progress bar will stop when its value reaches 100, but our timer will continue to run until the <code class="literal">stop()</code> method is called. In a more realistic implementation, you will need a way to determine whether the monitored process is complete. The indicator might be the creation of a file, or even better, a signal. The Qt framework uses the concept of signals and slots to connect GUI elements. A GUI is event-based, with multiple events occurring at different times, including user actions and other triggers. The signal/slot system allows you to define reactions to events when they occur, without writing code to continuously monitor changes. In this recipe, we use the predefined signal from the timer and create our own slot. A slot is just a method identified as a slot by passing it to a signal's <code class="literal">connect()</code> method. The following screenshot shows an example of the progress bar:</p><div class="mediaobject"><img src="../images/00051.jpeg" alt="How it works..." class="calibre11"/></div><p class="calibre12"> </p></div></div>

<div class="book" title="Displaying a progress bar">
<div class="book" title="There's more…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch07lvl2sec364" class="calibre1"/>There's more…</h2></div></div></div><p class="calibre9">In a complex GUI application such as QGIS, you will end up with multiple signals that trigger multiple slots simultaneously. You must take care that a rapidly updating element such as a progress bar doesn't slow down the application. Using a thread to only update the progress bar when something has truly changed is more efficient. For an example of this technique, take a look at <a class="calibre1" href="http://snorf.net/blog/2013/12/07/multithreading-in-qgis-python-plugins/"> http://snorf.net/blog/2013/12/07/multithreading-in-qgis-python-plugins/</a>.</p><p class="calibre9">Using the <code class="literal">QgsMessageBar</code> object is <a id="id586" class="calibre1"/>preferred to display informative messages, but it can also accept widgets such as the progress bar. The PyQGIS Developer Cookbook has an example that shows how to place the progress bar in the <code class="literal">QgsMessageBar</code> object (<a class="calibre1" href="http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/communicating.html">http://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/communicating.html</a>)</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating a simple text input dialog"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec126" class="calibre1"/>Creating a simple text input dialog</h1></div></div></div><p class="calibre9">In this<a id="id587" class="calibre1"/> recipe, we'll demonstrate one of the simplest methods used for accepting input from a user, a text input dialog.</p></div>

<div class="book" title="Creating a simple text input dialog">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec365" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console</strong></span> by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python Console</strong></span>.</p></div></div>

<div class="book" title="Creating a simple text input dialog">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec366" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">In this recipe, we will initialize the dialog and then configure its title and label. We'll set the editing mode and the default text. When you click on the <span class="strong"><strong class="calibre2">OK</strong></span> button, the text will be printed to the <span class="strong"><strong class="calibre2">Python Console</strong></span>. To do this, we need to perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we need to import the GUI library:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we initialize the dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">qid = QInputDialog()</strong></span>
</pre></div></li><li class="listitem" value="3">Now, we set the window's title, label text, editing mode, and default text:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">title = "Enter Your Name"</strong></span>
<span class="strong"><strong class="calibre2">label = "Name: "</strong></span>
<span class="strong"><strong class="calibre2">mode = QLineEdit.Normal</strong></span>
<span class="strong"><strong class="calibre2">default = "&lt;your name here&gt;"</strong></span>
</pre></div></li><li class="listitem" value="4">We configure the dialog while capturing the user input and the return code in variables:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">text, ok = QInputDialog.getText(qid, title, label, mode, default)</strong></span>
</pre></div></li><li class="listitem" value="5">When the dialog appears, type in some text and click on the <span class="strong"><strong class="calibre2">OK</strong></span> button.</li><li class="listitem" value="6">Now, we print the user input to the console:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">print text</strong></span>
</pre></div></li><li class="listitem" value="7">Finally, verify that the correct text is printed to the <span class="strong"><strong class="calibre2">Python Console</strong></span>.</li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating a simple text input dialog">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec367" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">The editing mode <a id="id588" class="calibre1"/>differentiates between <a id="id589" class="calibre1"/>
<span class="strong"><strong class="calibre2">normal</strong></span>, which we used here, and <a id="id590" class="calibre1"/>
<span class="strong"><strong class="calibre2">password</strong></span>, to obscure typed passwords. Although we haven't used it in this example, the return code is a Boolean, which can be used to verify that the user input occurred.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating a file input dialog"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec127" class="calibre1"/>Creating a file input dialog</h1></div></div></div><p class="calibre9">The<a id="id591" class="calibre1"/> best way to get a filename from the user is to have them browse to the file using a dialog. You can have the user type in a filename using the text input dialog, but this method is prone to errors. In this recipe, we'll create a file dialog and print the chosen filename to the console.</p></div>

<div class="book" title="Creating a file input dialog">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec368" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console</strong></span> by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python Console</strong></span>.</p></div></div>

<div class="book" title="Creating a file input dialog">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec369" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">In this recipe, we will create and configure the dialog, browse to a file, and print the chosen filename, as follows:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we import the GUI library:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we initialize the file dialog and specify its window title:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">qfd = QFileDialog()</strong></span>
<span class="strong"><strong class="calibre2">title = 'Open File'</strong></span>
</pre></div></li><li class="listitem" value="3">Now, we specify a path to the directory we want the file dialog to start in:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">path = "/Users/joellawhead/qgis_data"</strong></span>
</pre></div></li><li class="listitem" value="4">Then, we configure the file dialog with the preceding parameters and assign the output to a variable:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">f = QFileDialog.getOpenFileName(qfd, title, path)</strong></span>
</pre></div></li><li class="listitem" value="5">When the dialog appears, browse to a file, select it, and click on the <span class="strong"><strong class="calibre2">OK</strong></span> button.</li><li class="listitem" value="6">Finally, we print the chosen filename to the console:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">print f</strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating a file input dialog">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec370" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">The file dialog <a id="id592" class="calibre1"/>simply provides a filename. After the user selects the file, you must open it or perform some other operation on it. If the user cancels the file dialog, the file variable is just an empty string. You can use the <code class="literal">QFileInfo</code> object to get the path of the selected file:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtCore import *path = QFileInfo(f).path()</strong></span>
</pre></div><p class="calibre9">Then, you can save this path in the project settings, as demonstrated in <a class="calibre1" title="Chapter 1. Automating QGIS" href="part0015_split_000.html#page">Chapter 1</a>, <span class="strong"><em class="calibre10">Automating QGIS</em></span>. This way, next time when you open a file dialog, you will start in the same directory location as the previous file, which is usually more convenient.</p></div></div>

<div class="book" title="Creating a file input dialog">
<div class="book" title="There's more…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch07lvl2sec371" class="calibre1"/>There's more…</h2></div></div></div><p class="calibre9">You can also use the <code class="literal">QFileDialog() method</code> to get the filenames to be saved. You can use the <code class="literal">FileMode</code> enumeration to restrict the user to selecting directories as well.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating a combobox"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec128" class="calibre1"/>Creating a combobox</h1></div></div></div><p class="calibre9">A combobox<a id="id593" class="calibre1"/> provides a drop-down list to limit the user's selection to a defined set of choices. In this recipe, we'll create a simple combobox.</p></div>

<div class="book" title="Creating a combobox">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec372" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console</strong></span> by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python Console</strong></span>.</p></div></div>

<div class="book" title="Creating a combobox">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec373" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">In this recipe, we will <a id="id594" class="calibre1"/>initialize the combobox widget, add choices to it, resize it, display it, and then capture the user input in a variable for printing to the console. To do this, we need to perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">Frist, we import the GUI library:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Now, we create our combobox object:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">cb = QComboBox()</strong></span>
</pre></div></li><li class="listitem" value="3">Next, we add the items that we want the user to choose from:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">cb.addItems(["North", "South", "West", "East"])</strong></span>
</pre></div></li><li class="listitem" value="4">Then, we resize the widget:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">cb.resize(200,35)</strong></span>
</pre></div></li><li class="listitem" value="5">Now we can display the widget to the user:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">cb.show()</strong></span>
</pre></div></li><li class="listitem" value="6">Next, we need to select an item from the list.</li><li class="listitem" value="7">Now, we set the user's choice to a variable:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">text = cb.currentText()</strong></span>
</pre></div></li><li class="listitem" value="8">Finally, we can print the selection:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">print text</strong></span>
</pre></div></li><li class="listitem" value="9">Verify that the selection is printed to the console.</li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating a combobox">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec374" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">Items added<a id="id595" class="calibre1"/> to the combobox are a Python list. This feature makes it easy to dynamically generate choices using Python as the result of a database query or other dynamic data. You may also want the index of the object in the list, which you can access with the <code class="literal">currentIndex</code> property.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating radio buttons"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec129" class="calibre1"/>Creating radio buttons</h1></div></div></div><p class="calibre9">Radio buttons are <a id="id596" class="calibre1"/>good for user input when you want the user to select an exclusive choice from a list of options, as opposed to checkboxes, which let a user select many or all of the options available. For longer lists of choices, a combobox is a better option. Once a radio button is selected, you can unselect it only by choosing another radio button.</p></div>

<div class="book" title="Creating radio buttons">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec375" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console</strong></span> by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python Console</strong></span>.</p></div></div>

<div class="book" title="Creating radio buttons">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec376" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">Radio buttons are easier to<a id="id597" class="calibre1"/> manage as part of a class, so we'll create a custom class that also includes a textbox to view which radio button is selected. To do this, perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we'll import both the GUI and the core QGIS libraries:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtCore import *</strong></span>
<span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we'll create the <code class="literal">RadioButton</code> class and set up the radio buttons and the textbox:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">class RadioButton(QWidget):</strong></span>
<span class="strong"><strong class="calibre2">  def __init__(self, parent=None):</strong></span>
<span class="strong"><strong class="calibre2">      QWidget.__init__(self, parent)</strong></span>
</pre></div></li><li class="listitem" value="3">We must<a id="id598" class="calibre1"/> also define a layout to manage the placement of the widgets, as follows:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">self.layout = QVBoxLayout()</strong></span>
<span class="strong"><strong class="calibre2">self.rb1 = QRadioButton('Option 1')</strong></span>
<span class="strong"><strong class="calibre2">self.rb2 = QRadioButton('Option 2')</strong></span>
<span class="strong"><strong class="calibre2">self.rb3 = QRadioButton('Option 3')</strong></span>
<span class="strong"><strong class="calibre2">self.textbox = QLineEdit()</strong></span>
</pre></div></li><li class="listitem" value="4">Now, we'll connect the toggled signal of each radio button to the methods you'll define in just a moment, in order to detect when a radio button is selected:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">self.rb1.toggled.connect(self.rb1_active)</strong></span>
<span class="strong"><strong class="calibre2">self.rb2.toggled.connect(self.rb2_active)</strong></span>
<span class="strong"><strong class="calibre2">self.rb3.toggled.connect(self.rb3_active)</strong></span>
</pre></div></li><li class="listitem" value="5">Then, we'll add the radio buttons and the textbox to the layout:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">self.layout.addWidget(self.rb1)</strong></span>
<span class="strong"><strong class="calibre2">self.layout.addWidget(self.rb2)</strong></span>
<span class="strong"><strong class="calibre2">self.layout.addWidget(self.rb3)</strong></span>
<span class="strong"><strong class="calibre2">self.layout.addWidget(self.textbox)</strong></span>
</pre></div></li><li class="listitem" value="6">Now, we can define the layout for the custom widget we are building:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">      self.setLayout(self.layout)</strong></span>
</pre></div></li><li class="listitem" value="7">Next, we can define the methods to indicate which radio button is selected. You can also define these options in a single method, but for a better understanding, three methods are easier:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">def rb1_active(self, on):</strong></span>
<span class="strong"><strong class="calibre2">      if on:</strong></span>
<span class="strong"><strong class="calibre2">          self.textbox.setText('Option 1 selected')</strong></span>
<span class="strong"><strong class="calibre2">def rb2_active(self, on):</strong></span>
<span class="strong"><strong class="calibre2">      if on:</strong></span>
<span class="strong"><strong class="calibre2">          self.textbox.setText('Option 2 selected')</strong></span>
<span class="strong"><strong class="calibre2">def rb3_active(self, on):</strong></span>
<span class="strong"><strong class="calibre2">      if on:</strong></span>
<span class="strong"><strong class="calibre2">         self.textbox.setText('Option 3 selected')</strong></span>
</pre></div></li><li class="listitem" value="8">We are now ready to initialize our class and display the radio buttons:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">buttons = RadioButton()</strong></span>
<span class="strong"><strong class="calibre2">buttons.show()</strong></span>
</pre></div></li><li class="listitem" value="9">Finally, click<a id="id599" class="calibre1"/> on each of the three radio buttons and verify that the text in the textbox changes to indicate that the radio button you clicked on is selected.</li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating radio buttons">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec377" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">Radio buttons are almost always grouped together as a single object because they are related options. Many GUI frameworks expose them as a single object in the API; however, Qt keeps them as separate objects for maximum control.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating checkboxes"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec130" class="calibre1"/>Creating checkboxes</h1></div></div></div><p class="calibre9">Checkboxes are <a id="id600" class="calibre1"/>closely related to radio buttons, in that they offer options around a single theme. However, unlike radio buttons, checkboxes can be selected or unselected. You can also select more than one checkbox at a time. In this recipe, we'll create a dialog with checkboxes and some textboxes to programmatically track which checkboxes are selected.</p></div>

<div class="book" title="Creating checkboxes">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec378" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console</strong></span> by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python</strong></span> <span class="strong"><strong class="calibre2">Console</strong></span>.</p></div></div>

<div class="book" title="Creating checkboxes">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec379" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">In this recipe, we'll use a class to<a id="id601" class="calibre1"/> manage the checkboxes and the textbox widgets, as follows:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we import the GUI and QGIS core libraries:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtCore import *</strong></span>
<span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we create our custom class for the checkboxes and textboxes:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">class CheckBox(QWidget):</strong></span>
<span class="strong"><strong class="calibre2">  def __init__(self, parent=None):</strong></span>
<span class="strong"><strong class="calibre2">      QWidget.__init__(self, parent)</strong></span>
</pre></div></li><li class="listitem" value="3">Next, we'll need a <code class="literal">layout</code> object to manage the placement of the widgets:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">self.layout = QVBoxLayout()</strong></span>
</pre></div></li><li class="listitem" value="4">Now, we'll add three checkboxes and three textboxes:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">      self.cb1 = QCheckBox('Option 1')</strong></span>
<span class="strong"><strong class="calibre2">      self.cb2 = QCheckBox('Option 2')</strong></span>
<span class="strong"><strong class="calibre2">      self.cb3 = QCheckBox('Option 3')</strong></span>
<span class="strong"><strong class="calibre2">      self.textbox1 = QLineEdit()</strong></span>
<span class="strong"><strong class="calibre2">      self.textbox2 = QLineEdit()</strong></span>
<span class="strong"><strong class="calibre2">      self.textbox3 = QLineEdit()</strong></span>
</pre></div></li><li class="listitem" value="5">Then, we'll connect <a id="id602" class="calibre1"/>the status signals of the checkboxes to the methods that we'll define later:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">      self.cb1.toggled.connect(self.cb1_active)</strong></span>
<span class="strong"><strong class="calibre2">      self.cb2.toggled.connect(self.cb2_active)</strong></span>
<span class="strong"><strong class="calibre2">      self.cb3.toggled.connect(self.cb3_active)</strong></span>
</pre></div></li><li class="listitem" value="6">Next, we must add the widgets to the layout:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">      self.layout.addWidget(self.cb1)</strong></span>
<span class="strong"><strong class="calibre2">      self.layout.addWidget(self.cb2)</strong></span>
<span class="strong"><strong class="calibre2">      self.layout.addWidget(self.cb3)</strong></span>
<span class="strong"><strong class="calibre2">      self.layout.addWidget(self.textbox1)</strong></span>
<span class="strong"><strong class="calibre2">      self.layout.addWidget(self.textbox2)</strong></span>
<span class="strong"><strong class="calibre2">      self.layout.addWidget(self.textbox3)</strong></span>
</pre></div></li><li class="listitem" value="7">Now, we set our custom class's layout to the layout we created:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">      self.setLayout(self.layout)</strong></span>
</pre></div></li><li class="listitem" value="8">We then create the methods that change the textboxes each time a checkbox is toggled:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">  # First checkbox</strong></span>
<span class="strong"><strong class="calibre2">  def cb1_active(self, on):</strong></span>
<span class="strong"><strong class="calibre2">      if on:</strong></span>
<span class="strong"><strong class="calibre2">          self.textbox1.setText('Option 1 selected')</strong></span>
<span class="strong"><strong class="calibre2">      else: self.textbox1.setText('') </strong></span>
<span class="strong"><strong class="calibre2">  # Second checkbox  </strong></span>
<span class="strong"><strong class="calibre2">  def cb2_active(self, on):</strong></span>
<span class="strong"><strong class="calibre2">      if on:</strong></span>
<span class="strong"><strong class="calibre2">          self.textbox2.setText('Option 2 selected')</strong></span>
<span class="strong"><strong class="calibre2">      else: self.textbox2.setText('') </strong></span>
<span class="strong"><strong class="calibre2">  # Third checkbox      </strong></span>
<span class="strong"><strong class="calibre2">  def cb3_active(self, on):</strong></span>
<span class="strong"><strong class="calibre2">      if on:</strong></span>
<span class="strong"><strong class="calibre2">          self.textbox3.setText('Option 3 selected')</strong></span>
<span class="strong"><strong class="calibre2">      else: self.textbox3.setText('')</strong></span>
</pre></div></li><li class="listitem" value="9">Now, we <a id="id603" class="calibre1"/>are ready to initialize our custom class and display the dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">buttons = CheckBox()</strong></span>
<span class="strong"><strong class="calibre2">buttons.show()</strong></span>
</pre></div></li><li class="listitem" value="10">Toggle the checkboxes separately and simultaneously and then verify that the textboxes reflect the changes.</li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating checkboxes">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec380" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">Textboxes<a id="id604" class="calibre1"/> allow you to verify that you are programmatically catching the signal from the checkboxes as they are toggled. You can also use a single checkbox as a Boolean for an option with only two choices. When you run this recipe, the result should look similar to the following screenshot:</p><div class="mediaobject"><img src="../images/00052.jpeg" alt="How it works..." class="calibre11"/></div><p class="calibre12"> </p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating tabs"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec131" class="calibre1"/>Creating tabs</h1></div></div></div><p class="calibre9">Tabs allow<a id="id605" class="calibre1"/> you to condense the information from several screens into a relatively small place. Tabs provide titles at the top of the window, which present an individual widget layout for each title when clicked. In this recipe, we'll create a simple tabbed interface.</p></div>

<div class="book" title="Creating tabs">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec381" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console </strong></span>by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python</strong></span> <span class="strong"><strong class="calibre2">Console</strong></span>.</p></div></div>

<div class="book" title="Creating tabs">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec382" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">We will create an <a id="id606" class="calibre1"/>overarching tab widget. Then, we'll create three generic widgets to represent our tabs. We'll set up layouts with three different GUI widgets and assign each layout to our tab widgets. Finally, we'll add our tabs to the tab widget and display it. To do this, we need to perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we need to import the GUI and QGIS core libraries:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtCore import *</strong></span>
<span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we create our tab and configure its title and size:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">qtw = QTabWidget()</strong></span>
<span class="strong"><strong class="calibre2">qtw.setWindowTitle("PyQGIS Tab Example")</strong></span>
<span class="strong"><strong class="calibre2">qtw.resize(400,300)</strong></span>
</pre></div></li><li class="listitem" value="3">Now, we initialize our tab widgets:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">tab1 = QWidget()</strong></span>
<span class="strong"><strong class="calibre2">tab2 = QWidget()</strong></span>
<span class="strong"><strong class="calibre2">tab3 = QWidget()</strong></span>
</pre></div></li><li class="listitem" value="4">Then, we'll set up a widget and a layout with a rich text input box, using HTML tags for bold text for our first tab:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">layout1 = QVBoxLayout()</strong></span>
<span class="strong"><strong class="calibre2">layout1.addWidget(QTextEdit("&lt;b&gt;Type text here&lt;/b&gt;"))</strong></span>
<span class="strong"><strong class="calibre2">tab1.setLayout(layout1)</strong></span>
</pre></div></li><li class="listitem" value="5">Now, we'll set up a simple button for our second tab, following the same format as the first tab:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">layout2 = QVBoxLayout()</strong></span>
<span class="strong"><strong class="calibre2">layout2.addWidget(QPushButton("Button"))</strong></span>
<span class="strong"><strong class="calibre2">tab2.setLayout(layout2)</strong></span>
</pre></div></li><li class="listitem" value="6">Next, we'll create the widget and the layout for our third tab with a simple text label:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">layout3 = QVBoxLayout()</strong></span>
<span class="strong"><strong class="calibre2">layout3.addWidget(QLabel("Label text example"))</strong></span>
<span class="strong"><strong class="calibre2">tab3.setLayout(layout3)</strong></span>
</pre></div></li><li class="listitem" value="7">Then, we'll<a id="id607" class="calibre1"/> add the tabs to the tab window:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">qtw.addTab(tab1, "First Tab")</strong></span>
<span class="strong"><strong class="calibre2">qtw.addTab(tab2, "Second Tab")</strong></span>
<span class="strong"><strong class="calibre2">qtw.addTab(tab3, "Third Tab")</strong></span>
</pre></div></li><li class="listitem" value="8">Finally, we'll display the tab window:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">qtw.show()</strong></span>
</pre></div></li><li class="listitem" value="9">Verify that you can click on each tab and interact with the widgets.</li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Creating tabs">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec383" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">The key to this recipe is the <code class="literal">QTabWidget()</code>.method. Everything else is just arbitrary layouts and widgets, which are ultimately contained in the tab widget.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note08" class="calibre1"/>Note</h3><p class="calibre9">The general rule of thumb for tabs is to keep the information in them independently.</p></div><p class="calibre9">There is no way to predict how the user will interact with a tabbed interface, and if the information across tabs is dependent, problems will arise.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Stepping the user through a wizard"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec132" class="calibre1"/>Stepping the user through a wizard</h1></div></div></div><p class="calibre9">A wizard is<a id="id608" class="calibre1"/> a series of dialogs that lead the user through a sequence of steps. The information on each page of a wizard might relate in some way to the information on other pages. In this recipe, we'll <a id="id609" class="calibre1"/>create a simple three-page wizard to collect some information from the user and display it back to them.</p></div>

<div class="book" title="Stepping the user through a wizard">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec384" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console</strong></span> by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python</strong></span> <span class="strong"><strong class="calibre2">Console</strong></span>.</p></div></div>

<div class="book" title="Stepping the user through a wizard">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec385" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">We will create three classes, each representing a page of our wizard. The first two pages will collect information and the third page will display it back to the user. We will create a <code class="literal">QWizard</code> object to tie the page classes together. We will also use the concept of wizard fields to pass information<a id="id610" class="calibre1"/> among the pages.</p><p class="calibre9">To do this, we need to perform the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we import the GUI and QGIS core libraries:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtCore import *</strong></span>
<span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we create the class for the first page of our wizard and add a textbox to collect the user's name as the <code class="literal">uname</code> variable:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">class Page1(QWizardPage):</strong></span>
<span class="strong"><strong class="calibre2">    def __init__(self, parent=None):</strong></span>
<span class="strong"><strong class="calibre2">        super(Page1, self).__init__(parent)</strong></span>
<span class="strong"><strong class="calibre2">        self.setTitle("What's Your Name?")</strong></span>
<span class="strong"><strong class="calibre2">        self.setSubTitle("Please enter your name.")</strong></span>
<span class="strong"><strong class="calibre2">        self.label = QLabel("Name:")</strong></span>
<span class="strong"><strong class="calibre2">        self.uname = QLineEdit("&lt;enter your name&gt;")</strong></span>
</pre></div></li><li class="listitem" value="3">Now, we register the <code class="literal">uname</code> field so that we'll be able to access the entered value later on, without having to keep track of the variable itself:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">        self.registerField("uname", self.uname)</strong></span>
</pre></div></li><li class="listitem" value="4">Then, we set up the layout for the page:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">        layout = QVBoxLayout()</strong></span>
<span class="strong"><strong class="calibre2">        layout.addWidget(self.label)</strong></span>
<span class="strong"><strong class="calibre2">        layout.addWidget(self.uname)</strong></span>
<span class="strong"><strong class="calibre2">        self.setLayout(layout)</strong></span>
</pre></div></li><li class="listitem" value="5">Next, we'll set the class for our second page:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">class Page2(QWizardPage):</strong></span>
<span class="strong"><strong class="calibre2">    def __init__(self, parent=None):</strong></span>
<span class="strong"><strong class="calibre2">        super(Page2, self).__init__(parent)</strong></span>
<span class="strong"><strong class="calibre2">        self.setTitle("When's Your Birthday?")</strong></span>
<span class="strong"><strong class="calibre2">        self.setSubTitle("Select Your Birthday.")</strong></span>
</pre></div></li><li class="listitem" value="6">Then, we'll add a calendar widget to get the user's birthday:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">        self.cal = QCalendarWidget()</strong></span>
</pre></div></li><li class="listitem" value="7">We'll register the selected date as a <code class="literal">field</code>, to be accessed later on:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">        self.registerField("cal", self.cal, "selectedDate")</strong></span>
</pre></div></li><li class="listitem" value="8">Then, we'll set up<a id="id611" class="calibre1"/> the layout for this page:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">        layout = QVBoxLayout()</strong></span>
<span class="strong"><strong class="calibre2">        layout.addWidget(self.cal)</strong></span>
<span class="strong"><strong class="calibre2">        self.setLayout(layout)</strong></span>
</pre></div></li><li class="listitem" value="9">We are now ready to set up the third page, which will display the user's information. We'll use simple labels, which are dynamically populated in the next step:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">class Page3(QWizardPage):</strong></span>
<span class="strong"><strong class="calibre2">    def __init__(self, parent=None):</strong></span>
<span class="strong"><strong class="calibre2">        super(Page3, self).__init__(parent)</strong></span>
<span class="strong"><strong class="calibre2">        self.setTitle("About You")</strong></span>
<span class="strong"><strong class="calibre2">        self.setSubTitle("Here is Your Information:")</strong></span>
<span class="strong"><strong class="calibre2">        self.name_lbl = QLabel()</strong></span>
<span class="strong"><strong class="calibre2">        self.date_lbl = QLabel()</strong></span>
<span class="strong"><strong class="calibre2">        layout = QVBoxLayout()</strong></span>
<span class="strong"><strong class="calibre2">        layout.addWidget(self.name_lbl)</strong></span>
<span class="strong"><strong class="calibre2">        layout.addWidget(self.date_lbl)</strong></span>
<span class="strong"><strong class="calibre2">        self.setLayout(layout)</strong></span>
</pre></div></li><li class="listitem" value="10">Now, we set up the initialization of the page. We will first access the fields registered from the previous pages to grab the user input:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">    def initializePage(self):</strong></span>
<span class="strong"><strong class="calibre2">        uname = self.field("uname")</strong></span>
<span class="strong"><strong class="calibre2">        date = self.field("cal").toString()</strong></span>
</pre></div></li><li class="listitem" value="11">Then, all we have to do is set those values to the text for the labels using Python string formatting:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">        self.name_lbl.setText("Your name is %s" % uname)</strong></span>
<span class="strong"><strong class="calibre2">        self.date_lbl.setText("Your birthday is %s" % date)</strong></span>
</pre></div></li><li class="listitem" value="12">Finally, we create our wizard widget, add pages, and display the wizard:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">wiz = QWizard()</strong></span>
<span class="strong"><strong class="calibre2">wiz.addPage(Page1())</strong></span>
<span class="strong"><strong class="calibre2">wiz.addPage(Page2())</strong></span>
<span class="strong"><strong class="calibre2">wiz.addPage(Page3())</strong></span>
<span class="strong"><strong class="calibre2">wiz.show() </strong></span>
</pre></div></li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Stepping the user through a wizard">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec386" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">The wizard interface <a id="id612" class="calibre1"/>shares many traits with the tab widget, with some important differences. The wizard only allows the user to move back and forth in a linear progression based on the page order. It can share information among pages if the information is registered as fields, which then makes the pages global to the scope of the wizard. However, the <code class="literal">field() </code>method is a protected method, so your pages must be defined as classes inherited from the <code class="literal">QWizardPage</code> object for the registered fields to work as expected. The following screenshot shows the calendar screen of the wizard:</p><div class="mediaobject"><img src="../images/00053.jpeg" alt="How it works..." class="calibre11"/></div><p class="calibre12"> </p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Keeping dialogs on top"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch07lvl1sec133" class="calibre1"/>Keeping dialogs on top</h1></div></div></div><p class="calibre9">It's easy to lose track of windows that pop up in front of QGIS. As soon as the user changes focus to move the main QGIS application window, your dialog can disappear behind it, forcing the user to rearrange their whole desktop to find the smaller window again. Fortunately, Qt has a window setting called hint, which allows you to force a window to stay on top. This<a id="id613" class="calibre1"/> type of dialog is called a modal dialog. In this recipe, we'll create a message dialog using hint.</p></div>

<div class="book" title="Keeping dialogs on top">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch07lvl2sec387" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre9">Open the QGIS <span class="strong"><strong class="calibre2">Python Console</strong></span> by selecting the <span class="strong"><strong class="calibre2">Plugins</strong></span> menu and then clicking on <span class="strong"><strong class="calibre2">Python</strong></span> <span class="strong"><strong class="calibre2">Console</strong></span>.</p></div></div>

<div class="book" title="Keeping dialogs on top">
<div class="book" title="How to do it..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch07lvl2sec388" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre9">In this recipe, we <a id="id614" class="calibre1"/>will create a simple message dialog and set it to stay on top, as follows:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we import the Qt GUI and QGIS core libraries:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">from PyQt4.QtGui import *</strong></span>
<span class="strong"><strong class="calibre2">from PyQt4.QtCore import *</strong></span>
</pre></div></li><li class="listitem" value="2">Next, we create the text for our message:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">msg = "   This window will always stay on top."</strong></span>
</pre></div></li><li class="listitem" value="3">Now, we create our dialog and specify the message and hint:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">lbl = QLabel(msg, None, Qt.WindowStaysOnTopHint)</strong></span>
</pre></div></li><li class="listitem" value="4">We can resize and show the dialog:<div class="informalexample"><pre class="programlisting"><span class="strong"><strong class="calibre2">lbl.resize(400,400)</strong></span>
<span class="strong"><strong class="calibre2">lbl.show()</strong></span>
</pre></div></li><li class="listitem" value="5">Click on the main QGIS application window to change the window focus and verify that the dialog stays on top of QGIS.</li></ol><div class="calibre14"/></div></div></div>

<div class="book" title="Keeping dialogs on top">
<div class="book" title="How it works..."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch07lvl2sec389" class="calibre1"/>How it works...</h2></div></div></div><p class="calibre9">This simple technique can help to ensure that a user addresses an important dialog before moving on.</p></div></div></body></html>