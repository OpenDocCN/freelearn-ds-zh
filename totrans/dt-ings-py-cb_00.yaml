- en: Preface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Welcome to *Data Ingestion with Python Cookbook*. I hope you are excited as
    me to enter the world of data engineering.
  prefs: []
  type: TYPE_NORMAL
- en: '*Data Ingestion with Python Cookbook* is a practical guide that will empower
    you to design and implement efficient data ingestion pipelines. With real-world
    examples and renowned open-source tools, this book addresses your queries and
    hurdles head-on.'
  prefs: []
  type: TYPE_NORMAL
- en: Beginning with designing pipelines, you’ll explore working with and without
    data schemas, constructing monitored workflows using Airflow, and embracing data
    observability principles while adhering to best practices. Tackling the challenges
    of reading diverse data sources and formats, you’ll gain a comprehensive understanding
    of all these.
  prefs: []
  type: TYPE_NORMAL
- en: Our journey continues with essential insights into error logging, identification,
    resolution, data orchestration, and effective monitoring. You’ll discover optimal
    approaches for storing logs, ensuring easy access and references for them in the
    future.
  prefs: []
  type: TYPE_NORMAL
- en: By the end of this book, you’ll possess a fully automated setup to initiate
    data ingestion and pipeline monitoring. This streamlined process will seamlessly
    integrate into the subsequent stages of the **Extract, Transform, and Load** (**ETL**)
    process, propelling your data integration capabilities to new heights. Get ready
    to embark on an enlightening and transformative data ingestion journey.
  prefs: []
  type: TYPE_NORMAL
- en: Who this book is for
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This comprehensive book is specifically designed for Data Engineers, Data Integration
    Specialists, and passionate data enthusiasts seeking a deeper understanding of
    data ingestion processes, data flows, and the typical challenges encountered along
    the way. It provides valuable insights, best practices, and practical knowledge
    to enhance your skills and proficiency in handling data ingestion tasks effectively.
  prefs: []
  type: TYPE_NORMAL
- en: Whether you are a beginner in the data world or an experienced developer, this
    book will suit you. It is recommended to know the Python programming fundamentals
    and have basic knowledge of Docker to read and run this book’s code.
  prefs: []
  type: TYPE_NORMAL
- en: What this book covers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[*Chapter 1*](B19453_01.xhtml#_idTextAnchor022), *Introduction to Data Ingestion,*
    introduces you to data ingestion best practices and the challenges of working
    with diverse data sources. It explains the importance of the tools covered in
    the book, presents them, and provides installation instructions.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 2*](B19453_02.xhtml#_idTextAnchor064), *Data Access Principals –
    Accessing your Data,* explores data access concepts related to data governance,
    covering workflows and management of familiar sources such as SFTP servers, APIs,
    and cloud providers. It also provides examples of creating data access policies
    in databases, data warehouses, and the cloud.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 3*](B19453_03.xhtml#_idTextAnchor108), *Data Discovery – Understanding
    Our Data Before Ingesting It,* teaches you the significance of carrying out the
    data discovery process before data ingestion. It covers manual discovery, documentation,
    and using an open-source tool, OpenMetadata, for local configuration.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 4*](B19453_04.xhtml#_idTextAnchor127), *Reading CSV and JSON Files
    and Solving Problems,* introduces you to ingesting CSV and JSON files using Python
    and PySpark. It demonstrates handling varying data volumes and infrastructures
    while addressing common challenges and providing solutions.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 5*](B19453_05.xhtml#_idTextAnchor161), *Ingesting Data from Structured
    and Unstructured Databases,* covers fundamental concepts of relational and non-relational
    databases, including everyday use cases. You will learn how to read and handle
    data from these models, understand vital considerations, and troubleshoot potential
    errors.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 6*](B19453_06.xhtml#_idTextAnchor195), *Using PySpark with Defined
    and Non-Defined Schemas,* delves deeper into common PySpark use cases, focusing
    on handling defined and non-defined schemas. It also explores reading and understanding
    complex logs from Spark (PySpark core) and formatting techniques for easier debugging.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 7*](B19453_07.xhtml#_idTextAnchor227), *Ingesting Analytical Data,*
    introduces you to analytical data and common formats for reading and writing.
    It explores reading partitioned data for improved performance and discusses Reverse
    ETL theory with real-life application workflows and diagrams.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 8*](B19453_08.xhtml#_idTextAnchor280), *Designing Monitored Data
    Workﬂows,* covers logging best practices for data ingestion, facilitating error
    identification, and debugging. Techniques such as monitoring file size, row count,
    and object count enable improved monitoring of dashboards, alerts, and insights.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 9*](B19453_09.xhtml#_idTextAnchor319), *Putting Everything Together
    with Airﬂow,* consolidates the previously presented information and guides you
    in building a real-life data ingestion application using Airflow. It covers essential
    components, configuration, and issue resolution in the process.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 10*](B19453_10.xhtml#_idTextAnchor364), *Logging and Monitoring Your
    Data Ingest in Airflow,* explores advanced logging and monitoring in data ingestion
    with Airflow. It covers creating custom operators, setting up notifications, and
    monitoring for data anomalies. Configuration of notifications for tools such as
    Slack is also covered to stay updated on the data ingestion process.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 11*](B19453_11.xhtml#_idTextAnchor402), *Automating Your Data Ingestion
    Pipelines,* focuses on automating data ingests using previously learned best practices,
    enabling reader autonomy. It addresses common challenges with schedulers or orchestration
    tools and provides solutions to avoid problems in production clusters.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 12*](B19453_12.xhtml#_idTextAnchor433)*,* *Using Data Observability
    for Debugging, Error Handling, and Preventing Downtime,* explores data observability
    concepts, popular monitoring tools such as Grafana, and best practices for log
    storage and data lineage. It also covers creating visualization graphs to monitor
    data source issues using Airflow configuration and data ingestion scripts.'
  prefs: []
  type: TYPE_NORMAL
- en: To get the most out of this book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To execute the code in this book, you must have at least a basic knowledge of
    Python. We will use Python as the core language to execute the code. The code
    examples have been tested using Python 3.8\. However, it is expected to still
    work with future language versions.
  prefs: []
  type: TYPE_NORMAL
- en: Along with Python, this book uses Docker to emulate data systems and applications
    in our local machine, such as PostgreSQL, MongoDB, and Airflow. Therefore, a basic
    knowledge of Docker is recommended to edit container image files and run and stop
    containers.
  prefs: []
  type: TYPE_NORMAL
- en: Please, remember that some command-line commands may need adjustments depending
    on your local settings or operating system. The commands in the code examples
    are based on the Linux command-line syntax and might need some adaptations to
    run on Windows PowerShell.
  prefs: []
  type: TYPE_NORMAL
- en: '| **Software/Hardware covered in** **the book** | **OS Requirements** |'
  prefs: []
  type: TYPE_TB
- en: '| Python 3.8 or higher | Windows, Mac OS X, and Linux (any) |'
  prefs: []
  type: TYPE_TB
- en: '| Docker Engine 24.0 / Docker Desktop 4.19 | Windows, Mac OS X, and Linux (any)
    |'
  prefs: []
  type: TYPE_TB
- en: '*For almost all recipes in this book, you can use a Jupyter Notebook to execute
    the code. Even though it is not mandatory to install it, this tool can help you
    to test the code and try new things on the code due to the* *friendly interface.*'
  prefs: []
  type: TYPE_NORMAL
- en: '**If you are using the digital version of this book, we advise you to type
    the code yourself or access the code via the GitHub repository (link available
    in the next section). Doing so will help you avoid any potential errors related
    to the copying and pasting** **of code.**'
  prefs: []
  type: TYPE_NORMAL
- en: Download the example code files
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: You can download the example code files for this book from GitHub at [https://github.com/PacktPublishing/Data-Ingestion-with-Python-Cookbook](https://github.com/PacktPublishing/Data-Ingestion-with-Python-Cookbook).
    In case there’s an update to the code, it will be updated on the existing GitHub
    repository.
  prefs: []
  type: TYPE_NORMAL
- en: We also have other code bundles from our rich catalog of books and videos available
    at [https://github.com/PacktPublishing/](https://github.com/PacktPublishing/).
    Check them out!
  prefs: []
  type: TYPE_NORMAL
- en: Download the color images
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We also provide a PDF file that has color images of the screenshots/diagrams
    used in this book. You can download it here: [https://packt.link/xwl0U](https://packt.link/xwl0U)'
  prefs: []
  type: TYPE_NORMAL
- en: Conventions used
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are a number of text conventions used throughout this book.
  prefs: []
  type: TYPE_NORMAL
- en: '`Code in text`: Indicates code words in text, database table names, folder
    names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter
    handles. Here is an example: “Then we proceeded with the `with` `open` statement.”'
  prefs: []
  type: TYPE_NORMAL
- en: 'A block of code is set as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Any command-line input or output is written as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '`showString at NativeMethodAccessorImpl.java:0`, which redirected us to the
    **Stages** page.”'
  prefs: []
  type: TYPE_NORMAL
- en: Tips or important notes
  prefs: []
  type: TYPE_NORMAL
- en: Appear like this.
  prefs: []
  type: TYPE_NORMAL
- en: Sections
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this book, you will find several headings that appear frequently (*Getting
    ready*, *How to do it...*, *How it works...*, *There’s more...*, and *See also*).
  prefs: []
  type: TYPE_NORMAL
- en: 'To give clear instructions on how to complete a recipe, use these sections
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This section tells you what to expect in the recipe and describes how to set
    up any software or any preliminary settings required for the recipe.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This section contains the steps required to follow the recipe.
  prefs: []
  type: TYPE_NORMAL
- en: How it works…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This section usually consists of a detailed explanation of what happened in
    the previous section.
  prefs: []
  type: TYPE_NORMAL
- en: There’s more…
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This section consists of additional information about the recipe in order to
    make you more knowledgeable about the recipe.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This section provides helpful links to other useful information for the recipe.
  prefs: []
  type: TYPE_NORMAL
- en: Get in touch
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Feedback from our readers is always welcome.
  prefs: []
  type: TYPE_NORMAL
- en: '**General feedback**: If you have questions about any aspect of this book,
    mention the book title in the subject of your message and email us at [customercare@packtpub.com](mailto:customercare@packtpub.com).'
  prefs: []
  type: TYPE_NORMAL
- en: '**Errata**: Although we have taken every care to ensure the accuracy of our
    content, mistakes do happen. If you have found a mistake in this book, we would
    be grateful if you would report this to us. Please visit [www.packtpub.com/support/errata](http://www.packtpub.com/support/errata),
    selecting your book, clicking on the Errata Submission Form link, and entering
    the details.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Piracy**: If you come across any illegal copies of our works in any form
    on the Internet, we would be grateful if you would provide us with the location
    address or website name. Please contact us at [copyright@packt.com](mailto:copyright@packt.com)
    with a link to the material.'
  prefs: []
  type: TYPE_NORMAL
- en: '**If you are interested in becoming an author**: If there is a topic that you
    have expertise in and you are interested in either writing or contributing to
    a book, please visit [authors.packtpub.com](http://authors.packtpub.com).'
  prefs: []
  type: TYPE_NORMAL
- en: Share Your Thoughts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once you’ve read *Data Ingestion with Python Cookbook*, we’d love to hear your
    thoughts! Please [click here to go straight to the Amazon review page](https://packt.link/r/183763260X)
    for this book and share your feedback.
  prefs: []
  type: TYPE_NORMAL
- en: Your review is important to us and the tech community and will help us make
    sure we’re delivering excellent quality content.
  prefs: []
  type: TYPE_NORMAL
- en: Download a free PDF copy of this book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Thanks for purchasing this book!
  prefs: []
  type: TYPE_NORMAL
- en: Do you like to read on the go but are unable to carry your print books everywhere?
  prefs: []
  type: TYPE_NORMAL
- en: Is your eBook purchase not compatible with the device of your choice?
  prefs: []
  type: TYPE_NORMAL
- en: Don’t worry, now with every Packt book you get a DRM-free PDF version of that
    book at no cost.
  prefs: []
  type: TYPE_NORMAL
- en: Read anywhere, any place, on any device. Search, copy, and paste code from your
    favorite technical books directly into your application.
  prefs: []
  type: TYPE_NORMAL
- en: The perks don’t stop there, you can get exclusive access to discounts, newsletters,
    and great free content in your inbox daily
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow these simple steps to get the benefits:'
  prefs: []
  type: TYPE_NORMAL
- en: Scan the QR code or visit the link below
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/B19453_QR_Free_PDF.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '[https://packt.link/free-ebook/9781837632602](https://packt.link/free-ebook/9781837632602)'
  prefs: []
  type: TYPE_NORMAL
- en: Submit your proof of purchase
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: That’s it! We’ll send your free PDF and other benefits to your email directly
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Part 1: Fundamentals of Data Ingestion'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this part, you will be introduced to the fundamentals of data ingestion and
    data engineering, passing through the basic definition of an ingestion pipeline,
    the common types of data sources, and the technologies involved.
  prefs: []
  type: TYPE_NORMAL
- en: 'This part has the following chapters:'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 1*](B19453_01.xhtml#_idTextAnchor022), *Introduction to Data Ingestion*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Chapter 2*](B19453_02.xhtml#_idTextAnchor064), *Principals of Data Access
    – Accessing Your Data*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Chapter 3*](B19453_03.xhtml#_idTextAnchor108), *Data Discovery – Understanding
    Our Data Before Ingesting It*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Chapter 4*](B19453_04.xhtml#_idTextAnchor127), *Reading CSV and JSON Files
    and Solving Problems*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Chapter 5*](B19453_05.xhtml#_idTextAnchor161), *Ingesting Data from Structured
    and Unstructured Databases*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Chapter 6*](B19453_06.xhtml#_idTextAnchor195), *Using PySpark with Deﬁned
    and Non-Deﬁned Schemas*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[*Chapter 7*](B19453_07.xhtml#_idTextAnchor227), *Ingesting Analytical Data*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
