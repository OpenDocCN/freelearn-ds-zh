["```py\nimport pandas as pd\ndf=pd.read_csv('scooter.csv')\n```", "```py\ndf.columns\nIndex(['month', 'trip_id', 'region_id', 'vehicle_id', \n'started_at', 'ended_at', 'DURATION', \n'start_location_name', 'end_location_name', \n       'user_id', 'trip_ledger_id'],\n      dtype='object')\ndf.dtypes\nmonth                  object\ntrip_id                 int64\nregion_id               int64\nvehicle_id              int64\nstarted_at             object\nended_at               object\nDURATION               object\nstart_location_name    object\nend_location_name      object\nuser_id                 int64\ntrip_ledger_id          int64\n```", "```py\ndf.head()\n  month  trip_id  ...   user_id  trip_ledger_id\n0   May  1613335  ...   8417864         1488546\n1   May  1613639  ...   8417864         1488838\n2   May  1613708  ...   8417864         1488851\n3   May  1613867  ...   8417864         1489064\n4   May  1636714  ...  35436274         1511212\n[5 rows x 11 columns]\n```", "```py\npd.set_option('display.max_columns', 500)\n```", "```py\ndf['DURATION']\n0        0:07:03\n1        0:04:57\n2        0:01:14\n3        0:06:58\n4        0:03:06\n          ...   \n34221    0:14:00\n34222    0:08:00\n34223    1:53:00\n34224    0:12:00\n34225    1:51:00\n```", "```py\ndf[['trip_id','DURATION','start_location_name']]     \n       trip_id DURATION     start_location_name\n0      1613335  0:07:03       1901 Roma Ave NE, Albuquerque, NM \n                              87106, USA\n1      1613639  0:04:57  1 Domenici Center en Domenici Center, \n                           Albuquer...\n2      1613708  0:01:14  1 Domenici Center en Domenici Center, \n                           Albuquer...\n3      1613867  0:06:58  Rotunda at Science & Technology Park, \n                         801 Univ...\n4      1636714  0:03:06          401 2nd St NW, Albuquerque, NM\n                                 87102, USA\n...        ...      ...                                     ...\n34221  2482235  0:14:00     Central @ Broadway, Albuquerque, NM \n                            87102, USA\n34222  2482254  0:08:00     224 Central Ave SW, Albuquerque, NM \n                            87102, USA\n34223  2482257  1:53:00     105 Stanford Dr SE, Albuquerque, NM \n                            87106, USA\n34224  2482275  0:12:00   100 Broadway Blvd SE, Albuquerque, NM \n                          87102, USA\n34225  2482335  1:51:00     105 Stanford Dr SE, Albuquerque, NM \n                            87106, USA\n```", "```py\ndf.sample(5)\n     month  trip_id  ...   user_id  trip_ledger_id\n4974   June  1753394  ...  35569540         1624088\n18390  June  1992655  ...  42142022         1857395\n3132    May  1717574  ...  37145791         1589327\n1144    May  1680066  ...  36146147         1553169\n21761  June  2066449  ...  42297442         1929987\n```", "```py\ndf[:10]  \n     month  trip_id  ...   user_id  trip_ledger_id\n0      May  1613335  ...   8417864         1488546\n1      May  1613639  ...   8417864         1488838\n2      May  1613708  ...   8417864         1488851\n3      May  1613867  ...   8417864         1489064\n4      May  1636714  ...  35436274         1511212\n5      May  1636780  ...  34352757         1511371\n6      May  1636856  ...  35466666         1511483\n7      May  1636912  ...  34352757         1511390\n8      May  1637035  ...  35466666         1511516\n9      May  1637036  ...  34352757         1511666\n```", "```py\ndf[10:] \n```", "```py\ndf[3:9]\n  month  trip_id  ...   user_id  trip_ledger_id\n3   May  1613867  ...   8417864         1489064\n4   May  1636714  ...  35436274         1511212\n5   May  1636780  ...  34352757         1511371\n6   May  1636856  ...  35466666         1511483\n7   May  1636912  ...  34352757         1511390\n8   May  1637035  ...  35466666         1511516\n```", "```py\ndf.loc[34221]\nmonth                                                      July\ntrip_id                                                 2482235\nregion_id                                                   202\nvehicle_id                                              2893981\nstarted_at                                      7/21/2019 23:51\nended_at                                         7/22/2019 0:05\nDURATION                                                0:14:00\nstart_location_name  Central @ Broadway, Albuquerque, NM 87102,\n                                                            USA\nend_location_name    1418 4th St NW, Albuquerque, NM 87102, USA\nuser_id                                                42559731\ntrip_ledger_id                                          2340035\n```", "```py\ndf.at[2,'DURATION']\n'0:01:14'\n```", "```py\nuser=df.where(df['user_id']==8417864)\nuser\n      month    trip_id  ...    user_id  trip_ledger_id\n0       May  1613335.0  ...  8417864.0       1488546.0\n1       May  1613639.0  ...  8417864.0       1488838.0\n2       May  1613708.0  ...  8417864.0       1488851.0\n3       May  1613867.0  ...  8417864.0       1489064.0\n4       NaN        NaN  ...        NaN             NaN\n...     ...        ...  ...        ...             ...\n34221   NaN        NaN  ...        NaN             NaN\n34222   NaN        NaN  ...        NaN             NaN\n34223   NaN        NaN  ...        NaN             NaN\n34224   NaN        NaN  ...        NaN             NaN\n34225   NaN        NaN  ...        NaN             NaN\n```", "```py\ndf[(df['user_id']==8417864)]\n```", "```py\none=df['user_id']==8417864\ntwo=df['trip_ledger_id']==1488838\ndf.where(one & two)\n      month    trip_id  ...    user_id  trip_ledger_id\n0       NaN        NaN  ...        NaN             NaN\n1       May  1613639.0  ...  8417864.0       1488838.0\n2       NaN        NaN  ...        NaN             NaN\n3       NaN        NaN  ...        NaN             NaN\n4       NaN        NaN  ...        NaN             NaN\n```", "```py\ndf[(one)&(two)]\n  month  trip_id  ...  user_id  trip_ledger_id\n1   May  1613639  ...  8417864         1488838\n```", "```py\ndf.describe()\n           trip_id  region_id    vehicle_id       user_id  trip_ledger_id\ncount  3.422600e+04    34226.0  3.422600e+04  3.422600e+04    3.422600e+04\nmean   2.004438e+06      202.0  5.589507e+06  3.875420e+07    1.869549e+06\nstd    2.300476e+05        0.0  2.627164e+06  4.275441e+06    2.252639e+05\nmin    1.613335e+06      202.0  1.034847e+06  1.080200e+04    1.488546e+06\n25%    1.813521e+06      202.0  3.260435e+06  3.665710e+07    1.683023e+06\n50%    1.962520e+06      202.0  5.617097e+06  3.880750e+07    1.827796e+06\n75%    2.182324e+06      202.0  8.012871e+06  4.222774e+07    2.042524e+06\nmax    2.482335e+06      202.0  9.984848e+06  4.258732e+07    2.342161e+06\n```", "```py\ndf['start_location_name'].describe()\ncount                                               34220\nunique                                               2972\ntop       1898 Mountain Rd NW, Albuquerque, NM 87104, USA\nfreq                                                 1210\n```", "```py\ndf['DURATION'].value_counts()\n0:04:00    825\n0:03:00    807\n0:05:00    728\n0:06:00    649\n0:07:00    627\n```", "```py\ndf['DURATION'].value_counts(normalize=True)\n0:04:00    0.025847\n0:03:00    0.025284\n0:05:00    0.022808\n0:06:00    0.020333\n0:07:00    0.019644\n```", "```py\ndf['end_location_name'].value_counts(dropna=False)\nNaN                                                2070\n1898 Mountain Rd NW, Albuquerque, NM 87104, USA     802\nCentral @ Tingley, Albuquerque, NM 87104, USA       622\n330 Tijeras Ave NW, Albuquerque, NM 87102, USA      529\n2550 Central Ave NE, Albuquerque, NM 87106, USA     478\n... \n507 Bridge Blvd SW, Albuquerque, NM 87102, USA        1\n820 2nd St NW, Albuquerque, NM 87102, USA             1\n909 Alcalde Pl SW, Albuquerque, NM 87104, USA         1\n817 Slate Ave NW, Albuquerque, NM 87102, USA          1\n```", "```py\ndf.isnull().sum()\nmonth                     0\ntrip_id                   0\nregion_id                 0\nvehicle_id                0\nstarted_at                0\nended_at                  0\nDURATION               2308\nstart_location_name       6\nend_location_name      2070\nuser_id                   0\ntrip_ledger_id            0\n```", "```py\ndf['trip_id'].value_counts(bins=10)\n(1787135.0, 1874035.0]      5561\n(1700235.0, 1787135.0]      4900\n(1874035.0, 1960935.0]      4316\n(1960935.0, 2047835.0]      3922\n(2047835.0, 2134735.0]      3296\n(2221635.0, 2308535.0]      2876\n(2308535.0, 2395435.0]      2515\n(2134735.0, 2221635.0]      2490\n(2395435.0, 2482335.0]      2228\n(1612465.999, 1700235.0]    2122\n```", "```py\ndf.drop(columns=['region_id'], inplace=True)\n```", "```py\ndf.drop(index=[34225],inplace=True)\n```", "```py\ndf['start_location_name'][(df['start_location_name'].isnull())]\n26042    NaN\n26044    NaN\n26046    NaN\n26048    NaN\n26051    NaN\n26053    NaN\n```", "```py\ndf.dropna(subset=['start_location_name'],inplace=True)\n```", "```py\ndf['start_location_name'][(df['start_location_name'].isnull())]\nSeries([], Name: start_location_name, dtype: object)\n```", "```py\nthresh=int(len(df)*.25)\n```", "```py\ndf.fillna(value='00:00:00',axis='columns')\n9201     00:00:00\n9207     00:00:00\n9213     00:00:00\n9219     00:00:00\n9225     00:00:00\n```", "```py\nstartstop=df[(df['start_location_name'].isnull())&(df['end_location_name'].isnull())]\nvalue={'start_location_name':'Start St.','end_location_name':'Stop St.'}\nstartstop.fillna(value=value)\nstartstop[['start_location_name','end_location_name']]\n      start_location_name end_location_name\n26042           Start St.          Stop St.\n26044           Start St.          Stop St.\n26046           Start St.          Stop St.\n26048           Start St.          Stop St.\n26051           Start St.          Stop St.\n26053           Start St.          Stop St.\n```", "```py\nmay=df[(df['month']=='May')]\nmay\n     month  trip_id  ...   user_id trip_ledger_id\n0      May  1613335  ...   8417864        1488546\n1      May  1613639  ...   8417864        1488838\n2      May  1613708  ...   8417864        1488851\n3      May  1613867  ...   8417864        1489064\n4      May  1636714  ...  35436274        1511212\n...    ...      ...  ...       ...            ...\n4220   May  1737356  ...  35714580        1608429\n4221   May  1737376  ...  37503537        1608261\n4222   May  1737386  ...  37485128        1608314\n4223   May  1737391  ...  37504521        1608337\n4224   May  1737395  ...  37497528        1608342\n```", "```py\ndf.drop(index=may.index,inplace=True)\n```", "```py\ndf['month'].value_counts()\nJune    20259\nJuly     9742\n```", "```py\ndf.columns=[x.lower() for x in df.columns] print(df.columns)\nIndex(['month', 'trip_id', 'region_id', 'vehicle_id', 'started_at', 'ended_at','duration', 'start_location_name', 'end_location_name', 'user_id', 'trip_ledger_id'], dtype='object')\n```", "```py\ndf.columns=[x.upper() for x in df.columns] print(df.columns)\nIndex(['MONTH', 'TRIP_ID', 'REGION_ID', 'VEHICLE_ID', 'STARTED_AT', 'ENDED_AT', 'DURATION', 'START_LOCATION_NAME', 'END_LOCATION_NAME', 'USER_ID', 'TRIP_LEDGER_ID'], dtype='object')\n```", "```py\ndf.rename(columns={'DURATION':'duration'},inplace=True)\n```", "```py\ndf.rename(columns={'DURATION':'duration','region_id':'region'},inplace=True)\n```", "```py\ndf['month']=df['month'].str.upper()\ndf['month'].head()\n0    MAY\n1    MAY\n2    MAY\n3    MAY\n4    MAY\n```", "```py\nfor i,r in df.head().iterrows():\n    if r['trip_id']==1613335:\n        df.at[i,'new_column']='Yes'\n    else:\n        df.at[i,'new_column']='No'\ndf[['trip_id','new_column']].head()\n   trip_id new_column\n0  1613335        Yes\n1  1613639         No\n2  1613708         No\n3  1613867         No\n4  1636714         No\n```", "```py\ndf.loc[df['trip_id']==1613335,'new_column']='1613335'\ndf[['trip_id','new_column']].head()\n   trip_id new_column\n0  1613335    1613335\n1  1613639         No\n2  1613708         No\n3  1613867         No\n4  1636714         No\n```", "```py\nd['started_ad=df[['trip_id','started_at']].head()\nd['started_at'].str.split()\nd\n   trip_id          started_at\n0  1613335  [5/21/2019, 18:33]\n1  1613639  [5/21/2019, 19:07]\n2  1613708  [5/21/2019, 19:13]\n3  1613867  [5/21/2019, 19:29]\n4  1636714  [5/24/2019, 13:38]\n```", "```py\nnew=d['started_at'].str.split(expand=True)\nnew\n           0      1\n0  5/21/2019  18:33\n1  5/21/2019  19:07\n2  5/21/2019  19:13\n3  5/21/2019  19:29\n4  5/24/2019  13:38\nd['date']=new[0]\nd['time']=new[1]\nd\n   trip_id       started_at       date   time\n0  1613335  5/21/2019 18:33  5/21/2019  18:33\n1  1613639  5/21/2019 19:07  5/21/2019  19:07\n2  1613708  5/21/2019 19:13  5/21/2019  19:13\n3  1613867  5/21/2019 19:29  5/21/2019  19:29\n4  1636714  5/24/2019 13:38  5/24/2019  13:38\n```", "```py\nwhen = '2019-05-23'\nx=df[(df['started_at']>when)]\nlen(x)\n34226\n```", "```py\nd['started_at']=pd.to_datetime(df['started_at'],format='%m/%d/%Y %H:%M')\nd.dtypes\ntrip_id                int64\nstarted_at    datetime64[ns]\n```", "```py\nwhen = '2019-05-23'\nd[(d['started_at']>when)]\n   trip_id          started_at\n4  1636714 2019-05-24 13:38:00\n```", "```py\nnew=pd.DataFrame(df['start_location_name'].value_counts().head())\nnew.reset_index(inplace=True)\nnew.columns=['address','count']\nnew\n                            address  \t\t\tcount\n0  1898 Mountain Rd NW, Albuquerque, NM 87104, USA   1210\n1    Central @ Tingley, Albuquerque, NM 87104, USA    920\n2  2550 Central Ave NE, Albuquerque, NM 87106, USA    848\n3  2901 Central Ave NE, Albuquerque, NM 87106, USA    734\n4   330 Tijeras Ave NW, Albuquerque, NM 87102, USA    671\n```", "```py\nn=new['address'].str.split(pat=',',n=1,expand=True)\nreplaced=n[0].str.replace(\"@\",\"and\")\nnew['street']=n[0]\nnew['street']=replaced\nnew\n                                           address  count               street\n0  1898 Mountain Rd NW, Albuquerque, NM 87104, USA   1210  1898 Mountain Rd NW\n1    Central @ Tingley, Albuquerque, NM 87104, USA    920  Central and Tingley\n2  2550 Central Ave NE, Albuquerque, NM 87106, USA    848  2550 Central Ave NE\n3  2901 Central Ave NE, Albuquerque, NM 87106, USA    734  2901 Central Ave NE\n4   330 Tijeras Ave NW, Albuquerque, NM 87102, USA    671   330 Tijeras Ave NW\n```", "```py\ngeo=pd.read_csv('geocodedstreet.csv')\ngeo\n                street           x          y\n0  1898 Mountain Rd NW -106.667146  35.098104\n1  Central and Tingley -106.679271  35.091205\n2  2550 Central Ave NE -106.617420  35.080646\n3  2901 Central Ave NE -106.612180  35.081120\n4   330 Tijeras Ave NW -106.390355  35.078958\n5       nothing street -106.000000  35.000000\n```", "```py\njoined=new.join(other=geo,how='left',lsuffix='_new',rsuffix='_geo')\njoined[['street_new','street_geo','x','y']]\n            street_new           street_geo           x          y\n0  1898 Mountain Rd NW  1898 Mountain Rd NW -106.667146  35.098104\n1  Central and Tingley  Central and Tingley -106.679271  35.091205\n2  2550 Central Ave NE  2550 Central Ave NE -106.617420  35.080646\n3  2901 Central Ave NE  2901 Central Ave NE -106.612180  35.081120\n4   330 Tijeras Ave NW   330 Tijeras Ave NW -106.390355  35.078958\n```", "```py\nmerged=pd.merge(new,geo,on='street')\nmerged.columns\nIndex(['address', 'count', 'street', 'x', 'y'], dtype='object')\n```", "```py\nimport datetime as dt\nfrom datetime import timedelta\nfrom airflow import DAG\nfrom airflow.operators.bash_operator import BashOperator\nfrom airflow.operators.python_operator import PythonOperator\nimport pandas as pd\ndefault_args = {\n    'owner': 'paulcrickard',\n    'start_date': dt.datetime(2020, 4, 13),\n    'retries': 1,\n    'retry_delay': dt.timedelta(minutes=5),\n}\n```", "```py\ndef cleanScooter():\n    df=pd.read_csv('scooter.csv')\n    df.drop(columns=['region_id'], inplace=True)\n    df.columns=[x.lower() for x in df.columns]\n    df['started_at']=pd.to_datetime(df['started_at'],\n                                   format='%m/%d/%Y %H:%M')\n    df.to_csv('cleanscooter.csv')\n```", "```py\ndef filterData():\n    df=pd.read_csv('cleanscooter.csv')\n    fromd = '2019-05-23'\n    tod='2019-06-03'\n    tofrom = df[(df['started_at']>fromd)&\n                (df['started_at']<tod)]\n    tofrom.to_csv('may23-june3.csv')\t\n```", "```py\nwith DAG('CleanData',\n         default_args=default_args,\n         schedule_interval=timedelta(minutes=5),      \n         # '0 * * * *',\n         ) as dag:\n    cleanData = PythonOperator(task_id='clean',\n                                 python_callable=cleanScooter)\n\n    selectData = PythonOperator(task_id='filter',\n                                 python_callable=filterData)\n```", "```py\ncopyFile = BashOperator(task_id='copy',\n                                 bash_command='cp /home/paulcrickard/may23-june3.csv /home/paulcrickard/Desktop')\n```", "```py\ncleanData >> selectData >> copyFile\n```", "```py\nairflow webserver\nairflow scheduler\n```"]