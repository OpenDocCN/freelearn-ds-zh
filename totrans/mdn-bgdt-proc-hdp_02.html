<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Hadoop Life Cycle Management</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will understand the following topics:</p>
<ul>
<li style="font-weight: 400">Data wrangling</li>
<li style="font-weight: 400">Data masking</li>
<li style="font-weight: 400">Data security</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data wrangling</h1>
                </header>
            
            <article>
                
<p>If you have some experience working on data of some sort, you will recollect that most of the time data needs to be preprocessed so that we can further use it as part of a bigger analysis. This process is called <strong>data wrangling</strong>.</p>
<p>Let's see what the typical flow in this process looks like:</p>
<ul>
<li style="font-weight: 400">Data acquisition</li>
<li style="font-weight: 400">Data structure analysis</li>
<li style="font-weight: 400">Information extraction</li>
<li style="font-weight: 400">Unwanted data removal</li>
<li style="font-weight: 400">Data transformation</li>
<li style="font-weight: 400">Data standardization</li>
</ul>
<p>Let's try to understand these in detail.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data acquisition</h1>
                </header>
            
            <article>
                
<p>Even though not a part of data wrangling, this phase deals with the process of acquiring data from somewhere. Typically, all data is generated and stored in a central location or is available in files located on some shared storage.</p>
<p>Having an understanding of this step helps us to build an interface or use existing libraries to pull data from the acquired data source location.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data structure analysis</h1>
                </header>
            
            <article>
                
<p>Once data is acquired, we have to understand the structure of the data. Remember that the data we are getting can be in any of the following forms:</p>
<ul>
<li style="font-weight: 400">Text data:
<ul style="padding-left: 1px">
<li style="font-weight: 400">Structured data</li>
<li style="font-weight: 400">Unstructured data</li>
</ul>
</li>
<li style="font-weight: 400">Binary data</li>
</ul>
<p>This is where we need certain tools to help us understand the structure of the data.</p>
<p>Once we have a thorough understanding of the data we are dealing with, the next task is to understand the bits and pieces we need to extract from this structure. Sometimes, depending on the complexity and size of the data we are dealing with, it might take time for us to really find and extract the information we are looking for.</p>
<p>Once we know what we are looking for and also have a solid understanding of the structure of the data, it becomes easier for us to come up with simple algorithms to extract the required information from the input data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Information extraction</h1>
                </header>
            
            <article>
                
<p>In this phase, we are interested in extracting the necessary details from the input data. In the previous phase, we already identified the necessary pieces that are of interest to us. Here is where we can adopt the following techniques for information extraction:</p>
<ul>
<li style="font-weight: 400">Identify and locate where the text is present
<ul>
<li style="font-weight: 400">Analyze and come up with the best method of information extraction:</li>
<li style="font-weight: 400">Tokenize and extract information</li>
<li style="font-weight: 400">Go to offset and extract information</li>
<li style="font-weight: 400">Regular expression-based information extraction</li>
<li style="font-weight: 400">Complex algorithm-based information extraction</li>
</ul>
</li>
</ul>
<p>Depending on the complexity of the data, we might have to adopt one or more of the aforementioned techniques to extract the information from the target data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Unwanted data removal</h1>
                </header>
            
            <article>
                
<p>This phase can occur before the information extraction step or after the information extraction step. It depends on which one is easier (shortening the text or the extraction of information). This is a design choice the analyst can make.</p>
<p>In this phase, we are removing unwanted data from the information or input data so that the data is further distilled and can easily <span>be </span>consumed for our business needs.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data transformation</h1>
                </header>
            
            <article>
                
<p>This is also a very important phase, where we enforce the standards defined by the enterprise to define the final data output. For example, an organization can suggest that all the country codes should be in ISO 3166-1 alpha-2 format. In order to adhere to this standard, we might have to transform the input data, which can contain countries with their full names. So a mapping and transformation has to be done.</p>
<p>Many other transformations can be performed on the input data to make the final data consumable by anyone in the organization in a well-defined form and as per the organizations standards.</p>
<p>This step also gives some importance to having an enterprise level standard to improve collaboration.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data standardization</h1>
                </header>
            
            <article>
                
<p>Once the information extraction is complete and any necessary cleanup is done, we need to decide how we <span>are </span>going to save the outcome of this process. Typically, we can use a simple <strong>CSV</strong> (<strong>comma separated value</strong>) format for this data. If we are dealing with a complicated output format, we can choose <strong>XML</strong> (<strong>Extensible Markup Language</strong>) or <strong>JSON</strong> (<strong>javascript object notation</strong>) formats.</p>
<p>These formats are very much standard and almost all the technologies that we have today understand these very easily. But to keep things simple at first, it's good to start with CSV format.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data masking</h1>
                </header>
            
            <article>
                
<p>Businesses that deal with customer data have to make sure that the <strong>PII</strong> (<strong>personally identifiable information</strong>) of these customers is not moving freely around the entire data pipeline. This criterion is applicable <span>not only </span>to customer data but also to any other type of data that is considered classified, as per standards such as GDPR, SOX, and so on. In order to make sure that we protect the privacy of customers, employees, contractors, and vendors, we need to take the necessary precautions to ensure that when the data goes through several pipelines, users of the data see only anonymized data. The level of anonymization we do depends upon the standards the company adheres to and also the prevailing country standards.</p>
<p>So, data masking can be called the process of hiding/transforming portions of original data with other data without losing the meaning or context.</p>
<p>In this section, we will understand various techniques that are available to accomplish this:</p>
<ul>
<li style="font-weight: 400">Substitution:
<ul style="padding-left: 1px">
<li style="font-weight: 400">Static</li>
<li style="font-weight: 400">Dynamic:
<ul style="padding-left: 1px">
<li style="font-weight: 400">Encryption</li>
<li style="font-weight: 400">Hashing</li>
</ul>
</li>
</ul>
</li>
<li style="font-weight: 400">Hiding</li>
<li style="font-weight: 400">Erasing</li>
<li style="font-weight: 400">Truncation</li>
<li style="font-weight: 400">Variance</li>
<li style="font-weight: 400">Shuffling</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Substitution</h1>
                </header>
            
            <article>
                
<p>Substitution is the process of replacing portions of data with computed data. It can be mathematically be defined as:</p>
<div class="CDPAlignCenter CDPAlign"><img class="fm-editor-equation" src="assets/c470b3b9-8183-41c9-b435-60a02375f6f7.png" style="width:4.92em;height:1.50em;"/></div>
<p>Where <em>x</em> is the source and <em>y</em> is the output from this function.</p>
<p>In order to choose the correct substitution mechanism, we need to understand how this data is going to be used, the target audience, and the data flow environment as well. Let's look at the various available substitution mechanisms.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Static </h1>
                </header>
            
            <article>
                
<p>In this method, we have a Lookup table; it consists of all possible substitutions for a given set of inputs. This Lookup table can be visualized like this:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Source Text (y)</strong></p>
</td>
<td>
<p><strong>Substituted Text (y)</strong></p>
</td>
</tr>
<tr>
<td>
<p>Steve Jobs</p>
</td>
<td>
<p>AAPL-1</p>
</td>
</tr>
<tr>
<td>
<p>Cat</p>
</td>
<td>
<p>123456789</p>
</td>
</tr>
<tr>
<td>
<p>Tennis</p>
</td>
<td>
<p>Cricket</p>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>This table illustrates how a Lookup table can be constructed for substituting source text with a different text. This method scales well when there is a predefined quantity of substitutions available.</p>
<p>Another example of this Lookup table-based substitution is when we follow a naming standard for country codes, for example, ISO-8661:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Source Text (x)</strong></p>
</td>
<td>
<p><strong>Substituted Text (y)</strong></p>
</td>
</tr>
<tr>
<td>
<p>Egypt</p>
</td>
<td>
<p>EG</p>
</td>
</tr>
<tr>
<td>
<p>India</p>
</td>
<td>
<p>IN</p>
</td>
</tr>
<tr>
<td>
<p>Saint Vincent and Grenadines</p>
</td>
<td>
<p>VN</p>
</td>
</tr>
<tr>
<td>
<p>United Kingdom</p>
</td>
<td>
<p>GB</p>
</td>
</tr>
<tr>
<td>
<p>United States of America</p>
</td>
<td>
<p>US</p>
</td>
</tr>
</tbody>
</table>
</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Dynamic</h1>
                </header>
            
            <article>
                
<p>These substitution techniques are useful when there are a large number of possibilities and we want to change the data using some algorithms. These methods can be classified into two types.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Encryption</h1>
                </header>
            
            <article>
                
<p>This is the process of changing a given text to some other form by using some form of secret. These are mathematically defined functions:</p>
<div class="CDPAlignCenter CDPAlign"><img class="fm-editor-equation" src="assets/9891878e-37f3-416b-b943-034b45a84acb.png" style="width:12.92em;height:1.33em;"/></div>
<p>As you can see, these functions take an input and a secret and generate data that can be decrypted using the same secret and the output:</p>
<div class="CDPAlignCenter CDPAlign"><img class="fm-editor-equation" src="assets/38b93fdb-fc83-4469-9583-b27b217d37b4.png" style="width:13.75em;height:1.42em;"/></div>
<p>If we observe carefully, it is the secret that is playing an important role here. In cryptography, there are two types of algorithms that are available based on this secret. The usage of these depends on the situation and the secret transportation challenges.</p>
<p>Without going too deep into cryptography, let's try to understand what these methods are:</p>
<ul>
<li style="font-weight: 400">Symmetric key encryption</li>
<li style="font-weight: 400">Asymmetric key encryption</li>
</ul>
<p>The basic difference between the two is that in the first one, we use the same secret for both encryption and decryption. But in the latter, we use two different keys for encryption and decryption.</p>
<p>Let's take a look at a few examples of symmetric key encryption in action:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Algorithm</strong></p>
</td>
<td>
<p><strong>Input Data</strong></p>
</td>
<td>
<p><strong>Output Data</strong></p>
</td>
<td>
<p><strong>Method</strong></p>
</td>
</tr>
<tr>
<td>
<p>ROT13</p>
</td>
<td>
<p><kbd>hello</kbd></p>
</td>
<td>
<p><kbd>uryyb</kbd></p>
</td>
<td>
<p>Encryption</p>
</td>
</tr>
<tr>
<td/>
<td>
<p><kbd>uryyb</kbd></p>
</td>
<td>
<p><kbd>hello</kbd></p>
</td>
<td>
<p>Decryption</p>
</td>
</tr>
<tr>
<td>
<p>DES</p>
</td>
<td>
<p><kbd>hello</kbd></p>
</td>
<td>
<p><kbd>yOYffF4rl8lxCQ4HS2fpMg==</kbd></p>
</td>
<td>
<p>Encryption (secret is <kbd>hello</kbd>)</p>
</td>
</tr>
<tr>
<td/>
<td>
<p><kbd>yOYffF4rl8lxCQ4HS2fpMg==</kbd></p>
</td>
<td>
<p><kbd>hello</kbd></p>
</td>
<td>
<p>Decryption (secret is <kbd>hello</kbd>)</p>
</td>
</tr>
<tr>
<td>
<p>RIJNDAEL-256</p>
</td>
<td>
<p><kbd>hello</kbd></p>
</td>
<td>
<p><kbd>v8QbYPszQX/TFeYKbSfPL/</kbd><br/>
<kbd>rNJDywBIQKtxzOzWhBm16/</kbd><br/>
<kbd>VSNN4EtlgZi3/</kbd><br/>
<kbd>iPqJZpCiXXzDu0sKmKSl6IxbBKhYw==</kbd></p>
</td>
<td>
<p>Encryption (secret is <kbd>hello</kbd>)</p>
</td>
</tr>
<tr>
<td/>
<td>
<p><kbd>v8QbYPszQX/TFeYKbSfPL/</kbd><br/>
<kbd>rNJDywBIQKtxzOzWhBm16/</kbd><br/>
<kbd>VSNN4EtlgZi3/</kbd><br/>
<kbd>iPqJZpCiXXzDu0sKmKSl6IxbBKhYw==</kbd></p>
</td>
<td>
<p><kbd>hello</kbd></p>
</td>
<td>
<p>Encryption (secret is <kbd>hello</kbd>)</p>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>As you can see, the data that is generated varies in <span>both</span><span> </span><span>complexity and length depending on the encryption algorithm we use. It also depends on the secret key that is used for encryption.</span></p>
<p>Encryption poses a challenge of more computational requirements and storage space. We need to plan our system accordingly if we want to use encryption as one of the methods in the masking process.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Hashing</h1>
                </header>
            
            <article>
                
<p>This is also a cryptography-based technique where the original data is converted to an irreversible form. Let's see the mathematical form for this:</p>
<div class="CDPAlignCenter CDPAlign"><img class="fm-editor-equation" src="assets/70ba8a6e-dc2c-42bd-b83f-28678beefdfb.png" style="width:9.33em;height:1.33em;"/></div>
<p>Here, unlike in the case of encryption, we cannot use the output to discover what the input is.</p>
<p>Let's see a few examples to understand this better:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Input</strong></p>
</td>
<td>
<p><strong>Output</strong></p>
</td>
<td>
<p><strong>Method</strong></p>
</td>
</tr>
<tr>
<td>
<p><kbd>10-point</kbd></p>
</td>
<td>
<p><kbd>7d862a9dc7b743737e39dd0ea3522e9f</kbd></p>
</td>
<td>
<p>MD5</p>
</td>
</tr>
<tr>
<td>
<p><kbd>10th</kbd></p>
</td>
<td>
<p><kbd>8d9407b7f819b7f25b9cfab0fe20d5b3</kbd></p>
</td>
<td>
<p>MD5</p>
</td>
</tr>
<tr>
<td>
<p><kbd>10-point</kbd></p>
</td>
<td>
<p><kbd>c10154e1bdb6ea88e5c424ee63185d2c1541efe1bc3d4656a4c3c99122ba9256</kbd></p>
</td>
<td>
<p>SHA256</p>
</td>
</tr>
<tr>
<td>
<p><kbd>10th</kbd></p>
</td>
<td>
<p><kbd>5b6e8e1fcd052d6a73f3f0f99ced4bd54b5b22fd4f13892eaa3013ca65f4e2b5</kbd></p>
</td>
<td>
<p>SHA256</p>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>We can see that depending upon the encryption algorithm we have used, the output size varies. Another thing to note is that a given hash function produces the same output size irrespective of the input size.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Hiding</h1>
                </header>
            
            <article>
                
<p>In this approach, the data is considered too sensitive even to reveal it to the original owners. So, to protect the confidentiality of the data, certain portions of the text are masked with a predefined character, say X (or anything), so that only the person with complete knowledge about those pieces can extract the necessary information.</p>
<p><strong>Examples</strong>: Credit card information is considered highly confidential and should never be revealed to anyone. If you have some experience of purchasing online on websites such as Amazon and so on, you would have seen that your full credit card information is not shown; only the last four digits are shown. Since I am the genuine owner of such a credit card, I can easily identify it and continue with the transaction.</p>
<p>Similarly, when there is a need for portions of data to be seen by analysts, it's important to mask significant pieces of it so that the end users will not get the complete picture but will use this data <span>at the same time </span>for any analysis that they are doing.</p>
<p>Let's see a few examples to understand this better:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Data type</strong></p>
</td>
<td>
<p><strong>Input</strong></p>
</td>
<td>
<p><strong>Output</strong></p>
</td>
<td>
<p><strong>Network</strong></p>
</td>
</tr>
<tr>
<td>
<p>Creditcard</p>
</td>
<td>
<p>4485 <strong>4769 3682</strong> 9843</p>
</td>
<td>
<p>4485 <strong>XXXX XXXX</strong> 9843</p>
</td>
<td>
<p>Visa</p>
</td>
</tr>
<tr>
<td>
<p>Creditcard</p>
</td>
<td>
<p>5402 <strong>1324 5087</strong> 3314</p>
</td>
<td>
<p>5402 <strong>XXXX XXXX</strong> 3314</p>
</td>
<td>
<p>Mastercard</p>
</td>
</tr>
<tr>
<td>
<p>Creditcard</p>
</td>
<td>
<p>3772 <strong>951960</strong> 72673</p>
</td>
<td>
<p>3772 <strong>XXXXXX</strong> 72673</p>
</td>
<td>
<p>American Express</p>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>In the preceding examples, these numbers follow a predefined algorithm and size. So a simple technique of masking digits at fixed locations can work better.</p>
<p>Let's take up another example of hiding out portions of email addresses which vary in both size and complexity. In this case we have to follow different techniques to hide the characters to not reveal complete information:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Data type</strong></p>
</td>
<td>
<p><strong>Input</strong></p>
</td>
<td>
<p><strong>Output</strong></p>
</td>
<td>
<p><strong>Method</strong></p>
</td>
</tr>
<tr>
<td>
<p>Email</p>
</td>
<td>
<p><kbd>hello@world.com</kbd></p>
</td>
<td>
<p><kbd>h.l.o@w.r.d.com</kbd></p>
</td>
<td>
<p>Even Hide</p>
</td>
</tr>
<tr>
<td/>
<td>
<p><kbd>simple@book.com</kbd></p>
</td>
<td>
<p><kbd>.i.p.e@.o.k.c.m</kbd></p>
</td>
<td>
<p>Odd Hide</p>
</td>
</tr>
<tr>
<td/>
<td>
<p><kbd>something@something.com</kbd></p>
</td>
<td>
<p><kbd>s...th.ng@..me...com</kbd></p>
</td>
<td>
<p>Complex Hide</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>The techniques can be as simple as:</p>
<ul>
<li><strong>Even Hide</strong>: In this technique, we hide the every character that is in the even position</li>
<li><strong>Odd Hide</strong>: We hide every odd character in the input data</li>
<li><strong>Complex Hide</strong>: In this technique, we understand the data we are dealing with using NLP and then try to apply an algorithm that doesn't reveal too much information that would allow any intelligent person to decode</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Erasing</h1>
                </header>
            
            <article>
                
<p>As the name suggests, this causes data loss when applied to the input data. Depending on the significance of the data we are dealing with, we need to apply this technique. Typical examples of this technique is to set a <kbd>NULL</kbd> value for all the records in a column. Since this null data cannot be used to infer anything that is meaningful, this technique helps in making sure that confidential data is not sent to the other phases of data processing.</p>
<p>Let's take few examples of erasing:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Input Data</strong></p>
</td>
<td>
<p><strong>Output Data</strong></p>
</td>
<td>
<p><strong>What's erased</strong></p>
</td>
</tr>
<tr>
<td>
<p>NULL earns 1000 INR per month</p>
</td>
<td>
<p>Ravi earns NULL per month</p>
</td>
<td>
<p>Salary and name</p>
</td>
</tr>
<tr>
<td>
<p>NULL mobile number is 0123456789</p>
</td>
<td>
<p>Ravi's mobile number is NULL</p>
</td>
<td>
<p>Mobile number and name</p>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>From the examples, you might be wondering: why do we nullify these values? This technique is useful when we are not really interested in the PII but interested in a summary of how many salary records or mobile number records are there in our database/input.</p>
<p>This concept can be extended to other use cases as well.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Truncation</h1>
                </header>
            
            <article>
                
<p>Another variant of erasing is truncation, where we make all the input data a uniform size. This is useful when we are pretty sure that information loss is accepted in the further processing of the pipelines.</p>
<p>This can also be an intelligent truncation where we are aware of the data we are dealing with. Let's see this example of email addresses:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Input</strong></p>
</td>
<td>
<p><strong>Output</strong></p>
</td>
<td>
<p><strong>What's truncated</strong></p>
</td>
</tr>
<tr>
<td>
<p><kbd>alice@localhost.com</kbd></p>
</td>
<td>
<p><kbd>alice</kbd></p>
</td>
<td>
<p><kbd>@localhost.com</kbd></p>
</td>
</tr>
<tr>
<td>
<p><kbd>bob@localhost.com</kbd></p>
</td>
<td>
<p><kbd>bob</kbd></p>
</td>
<td>
<p><kbd>@localhost.com</kbd></p>
</td>
</tr>
<tr>
<td>
<p><kbd>rob@localhost.com</kbd></p>
</td>
<td>
<p><kbd>rob</kbd></p>
</td>
<td>
<p><kbd>@localhost.com</kbd></p>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>From the preceding examples, we can see that all the domain portions from the email are truncated as all of them belong to the same domain. This technique saves storage space.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Variance</h1>
                </header>
            
            <article>
                
<p>This technique is useful for data types that are numeric in nature. It can also be applied to Date/Time values.</p>
<p>This follows a statistical approach where we try to algorithmically vary the input data by a factor of +/- X percent. The value of X purely depends on the analysis we are doing and shouldn’t have an overall impact on understanding the business figures.</p>
<p>Let's see a few examples:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>Input Data</strong></p>
</td>
<td>
<p><strong>Output Data</strong></p>
</td>
<td>
<p><strong>Method</strong></p>
</td>
<td><strong>Explanation</strong></td>
</tr>
<tr>
<td>
<p>100</p>
</td>
<td>
<p>110</p>
</td>
<td>
<p>Fixed variance</p>
</td>
<td>
<p>Increase by 10%</p>
</td>
</tr>
<tr>
<td>
<p>-100</p>
</td>
<td>
<p>90</p>
</td>
<td>
<p>Fixed variance</p>
</td>
<td>
<p>Decrease by 10%</p>
</td>
</tr>
<tr>
<td>
<p>1-Jan-2000</p>
</td>
<td>
<p>1-Feb-2000</p>
</td>
<td>
<p>Fixed variance</p>
</td>
<td>
<p>Add 1 month</p>
</td>
</tr>
<tr>
<td>
<p>1-Aug-2000</p>
</td>
<td>
<p>1-Jul-2000</p>
</td>
<td>
<p>Fixed variance</p>
</td>
<td>
<p>Reduce by 1 month</p>
</td>
</tr>
<tr>
<td>
<p>100</p>
</td>
<td>
<p>101</p>
</td>
<td>
<p>Dynamic variance</p>
</td>
<td>
<p>1% to 5% increase or decrease</p>
</td>
</tr>
<tr>
<td>
<p>100</p>
</td>
<td>
<p>105</p>
</td>
<td>
<p>Dynamic</p>
</td>
<td>
<p>1% to 5% increase or decrease</p>
</td>
</tr>
</tbody>
</table>
</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Shuffling</h1>
                </header>
            
            <article>
                
<p>This is also considered one of the standard techniques of achieving anonymity of data. This process is more applicable where we have records of data with several attributes (columns in database terminology). In this technique, the data in the records is shuffled around a column so as to make sure that the record-level information is changed. But statistically, the data value remains the same in that column.</p>
<p><strong>Example</strong>: When doing an analysis on the salary ranges of an organization, we can actually do a shuffle of the entire salary column, where the salaries of all the employees never match reality. But we can use this data to do an analysis on the ranges.</p>
<p>Complex methods can also be employed in this case, where we can do a shuffle based on other fields such as seniority, geography, and so on. The ultimate objective of this technique is to preserve the meaning of the data and, at the same time, make it impossible to discover the original owners of these attributes.</p>
<p>Let's see this with some example data:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/652dfb7b-645d-4f3e-9723-81b5c6a68dc7.png" style="width:35.42em;height:22.08em;"/></div>
<p>There are five sample employee records with their salary information. The top table has original salary details and the table below has shuffled salary records. Look at the data carefully and you will understand. Remember that while shuffling, a random algorithm can be applied to increase the complexity of discovering the truth.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data security</h1>
                </header>
            
            <article>
                
<p>Data has become a very important asset for businesses when making very critical decisions. As the complexity of the infrastructure that generates and uses this data, its very important to have some control over the access patterns of this data. In the Hadoop ecosystem, we have Apache Ranger, which is another open source project that helps in managing the security of big data.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">What is Apache Ranger?</h1>
                </header>
            
            <article>
                
<p>Apache Ranger is an application that enables data architects to implement security policies on a big data ecosystem. The goal of this project is to provide a unified way for all Hadoop applications to adhere to the security guidelines that are defined.</p>
<p>Here are some of the features of Apache Ranger:</p>
<ul>
<li style="font-weight: 400">Centralized administration</li>
<li style="font-weight: 400">Fine grained authorization</li>
<li style="font-weight: 400">Standardized authorization</li>
<li style="font-weight: 400">Multiple authorization methods</li>
<li style="font-weight: 400">Centralized auditing</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Apache Ranger installation using Ambari</h1>
                </header>
            
            <article>
                
<p>In this section, we will install Ranger using Apache Ambari. This section assumes that there is already a running Ambari instance.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Ambari admin UI</h1>
                </header>
            
            <article>
                
<p>Open the Ambari web interface running on master node; then click on <span class="packt_screen">Add Service</span>, as shown in the screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/688e0308-9b80-4fd8-87a0-9c9240265967.png" style="width:25.50em;height:29.83em;"/></div>
<p>This will open a modal window, <span class="packt_screen">Add Service Wizard</span>, which will take us through several steps for a complete installation of Apache Ambari.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Add service</h1>
                </header>
            
            <article>
                
<p>Once the modal window is in view, select the <span class="packt_screen">Apache Ranger</span> service from the list and click on <span class="packt_screen">Next</span> on the screen.</p>
<p>This is shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2be2832c-2753-4d1d-814c-5d4c8a883777.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Service placement</h1>
                </header>
            
            <article>
                
<p>Once the service is selected, we are presented the next step in the UI where we need to chose the servers on which this service is going to be installed and run.</p>
<p>I have selected <span class="packt_screen">node-3</span> for Ranger (see the green labels):</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/87b67475-da9f-4b66-a0f9-6182ebf9b456.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Screenshot showing how to choose <span>servers on which this services is going to be installed and run</span></div>
<p>After this, select <span class="packt_screen">N</span><span class="packt_screen">ext</span>, which is at the bottom of the page.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Service client placement</h1>
                </header>
            
            <article>
                
<p>In this step, we can choose where the clients for this service can be installed. Use the checkboxes to mark your preferences.</p>
<p>They look something like this:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/65982a2c-18c6-4bd3-9665-fe8f2374398d.png"/></div>
<p>Click on <span class="packt_screen">Next</span> when your choices are made.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Database creation on master</h1>
                </header>
            
            <article>
                
<p>We have installed the MySQL database server on the master node. Before we continue to the next step in the Ambari wizard, we have to create a new database and assign a few privileges:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/bfe9ba4f-aeca-4c63-b308-b9ce5518efe0.png"/></div>
<p>We also have to register the JDBC driver using the <kbd>ambari-server setup</kbd> command:</p>
<pre><strong>bash-$</strong> sudo ambari-server setup --jdbc-db=mysql --jdbc-driver=/usr/share/java/mysql-connector-java.jar<br/>Using python /usr/bin/python<br/>Setup ambari-server<br/>Copying /usr/share/java/mysql-connector-java.jar to /var/lib/ambari-server/resources<br/>If you are updating existing jdbc driver jar for mysql with mysql-connector-java.jar. Please remove the old driver jar, from all hosts. Restarting services that need the driver, will automatically copy the new jar to the hosts.<br/>JDBC driver was successfully initialized.<br/>Ambari Server 'setup' completed successfully.</pre>
<p>After this step, we can go back to the Ambari wizard.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Ranger database configuration</h1>
                </header>
            
            <article>
                
<p>In the wizard, we are prompted with the database name, username, and password. Please fill them according to the choices we made in the previous step:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/fbc737cb-de1e-4504-b1c5-54eb414da55b.png"/></div>
<p>Once the settings are added, please click on <span class="packt_screen">Test Connection</span>. This will save lot of time later.</p>
<p>If there are any errors, please go back to the previous step; see whether there are any spelling mistakes and rerun those.</p>
<p>Click on <span class="packt_screen">Next</span> when done with the changes.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuration changes</h1>
                </header>
            
            <article>
                
<p>Since we are adding Ranger a service, Ambari shows a list of configuration changes that are required for Ranger to work correctly. Mostly leave these on default.</p>
<p>These changes look like the following screenshot. Once the changes look good, click on <span class="packt_screen">OK</span> to continue:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/2c1fa6d2-5325-419e-8540-7c7215002dec.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuration review</h1>
                </header>
            
            <article>
                
<p>In this step, we are shown the list of changes that we have made so far in the wizard, and are shown choices to print a changes summary and deploy Ranger.</p>
<p>Only when we click on <span class="packt_screen">Deploy</span> will the Ranger software get installed. Until then, it is all kept in the browser cache.</p>
<p>The screen looks like this:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5ffb2278-f6c4-4dd6-b8a8-35c2e512af9c.png"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Deployment progress</h1>
                </header>
            
            <article>
                
<p>Once the installation of Ranger starts, it should look something like the one in the screenshot. There should not be any failures as we have set up all the configurations correctly. If there is any failure, check the logs and review the configuration by clicking on the <span class="packt_screen">Back</span> button:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/dd1a49f5-1b3c-47b2-aeb4-fc93c599e8c7.png" style="width:39.25em;height:19.33em;"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Application restart</h1>
                </header>
            
            <article>
                
<p>Once the deployment is complete, we need to restart all the affected Hadoop components, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/faa744da-eb8f-4af1-98e2-e1698c0d0d7a.png" style="width:43.75em;height:17.83em;"/></div>
<p>Once all the components are restarted, the Ambari dashboard looks pretty healthy and we are done with the Apache Ranger installation.</p>
<p>In the next step, we will see how to use Apache Ranger for handling our data security.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Apache Ranger user guide</h1>
                </header>
            
            <article>
                
<p>Once the deployment of Apache Ranger is complete, we can manage our entire Hadoop infrastructure security using the web interface provided by Apache Ranger.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Login to UI</h1>
                </header>
            
            <article>
                
<p>If you have not changed the default settings, Ranger runs on port <kbd>6080</kbd> by default in non-SSL Mode. Open up a web browser on the server where its installed on port <kbd>6080</kbd> (<kbd>http://&lt;server-ip&gt;:6080</kbd>) and you will be prompted with a screen like this:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/3475861b-dcd2-49b7-a19f-3b8f96b964eb.png" style="width:25.33em;height:23.17em;"/></div>
<p>Log in with the default username <kbd>admin</kbd> and password <kbd>admin</kbd> (please change the password after you log in for the first time, for security reasons).</p>
<p>Once the login is successful, we are taken to the <em>Access manager</em> section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Access manager</h1>
                </header>
            
            <article>
                
<p>Access manager lets us define policies based on services and tags. This screenshot shows the default list of services and the configured policies:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/c8e951c5-5dc0-493b-a140-bc425ed0a609.png"/></div>
<p>As you can see, there is already a policy defined for <span class="packt_screen">HDFS</span> service and <span class="packt_screen">KAFKA</span> service as they are already installed in the Ambari setup.</p>
<p>When we want to define a new service, we can click on the <span class="packt_screen">+</span> icon and define the service details.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Service details</h1>
                </header>
            
            <article>
                
<p>Before we start defining the authorization rules for the service, we need to define a service and then add authorization policies to the service. These are the mandatory properties which are needed to define a service from the UI:</p>
<div>
<table>
<tbody>
<tr>
<td>
<p><strong>UI Element name</strong></p>
</td>
<td>
<p><strong>Description</strong></p>
</td>
</tr>
<tr>
<td>
<p>Service Name</p>
</td>
<td>
<p>Name of the service as defined in agent configuration</p>
</td>
</tr>
<tr>
<td>
<p>Username</p>
</td>
<td>
<p>Name of the service user</p>
</td>
</tr>
<tr>
<td>
<p>Password</p>
</td>
<td>
<p>Password for the service user</p>
</td>
</tr>
<tr>
<td>
<p>Namenode URL</p>
</td>
<td>
<p>URL to the namenode</p>
</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<p>A new service can be defined by clicking on the <span class="packt_screen">+</span> icon below the application (for example, <kbd>HDFS</kbd>, <kbd>Kafka</kbd>, and so on)</p>
<p>After that, the service definition screen looks like this:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/58f05368-f783-4656-83a1-21cf9fdcea1e.png" style="width:41.83em;height:44.50em;"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Screenshot of the service definition screen after defining new services</div>
<p>We need to fill in all the necessary values for our service definition and hit save. Later, we need to add policies to this service to access enforcement and auditing.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Policy definition and auditing for HDFS</h1>
                </header>
            
            <article>
                
<p>For every service in Ranger, we can associate different policies to the resources in the service. In case of HDFS, the resources will be the file/directory paths.</p>
<p>In this section, we will define a new policy for an HDFS path called projects for three users: <kbd>hdfs-alice</kbd>, <kbd>hdfs-bob</kbd>, and <kbd>hdfs-tom</kbd>. Where only <kbd>hdfs-alice</kbd> is allowed all permissions and rest of the users have only read access.</p>
<p>We will see how Ranger enforces access restrictions once the policy is in place.</p>
<p>Let's see the screen for the policy creation:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/e5aa0907-08ff-4ed9-87c2-d1ab9cca6a94.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Screenshot showing how Ranger enforces access restrictions</div>
<p>Once we hit the <span class="packt_screen">Add</span> button, this policy is registered and added under the current service.</p>
<p>Now, let's get back to the Unix terminal and see how Ranger enforces the policies.</p>
<p>This screen shows how <kbd>hdfs</kbd> and <kbd>hdfs-alice</kbd> users are allowed to create directories <kbd>/projects</kbd> and <kbd>/projects/1</kbd>, but how this is denied for <kbd>hdfs-tom</kbd>:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/45c42baf-d515-49e0-8d9c-b93f6498473a.png"/></div>
<p>Apache Ranger also has an audit section in the web interface, where we can see these access patterns.</p>
<p>This screen shows that <kbd>hdfs-tom</kbd> is denied and <kbd>hdfs-alice</kbd> is granted access by the policy:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/eeb6ddc0-5791-44e6-ad9a-3ea16271fbb3.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Screenshot showing access denied to hdfs-tom and access granted to hdfs-alice by the policy</div>
<p>Like this, we can define our own policies and customize how <kbd>hdfs</kbd> should allow/deny access to several resources.</p>
<p>The power and flexibility of Ranger comes from the its configurability. There is no need for any configuration files and restarts of applications for the access control to play a significant role.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we learned about the different data life cycle stages, including when data is created, shared, maintained, archived, retained, and deleted.</p>
<p>This chapter gave you a detailed understanding of how big data is managed, considering the fact that it is either unstructured or semi-structured and it has a fast arrival rate and large volume.</p>
<p>As the complexity of the infrastructure that generates and uses data in business organizations has increased drastically, it has become imperative to secure your data properly. This chapter further covered data security tools, such as Apache Ranger, and patterns to help us learn how to have control over the access patterns of data.</p>
<p>In the next chapter, we will take a look at Hadoop installation, its architecture and key components.</p>


            </article>

            
        </section>
    </body></html>