- en: Chapter 4. Publishing the Map Online
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 4 章。在线发布地图
- en: In this chapter, we will cover the QGIS Cloud service, a powerful map hosting
    platform, and you will learn how to use it to share your maps with others by publishing
    them on the Internet. We will cover all the necessary steps, such as creating
    a QGIS Cloud account, preparing your maps for publishing, filling metadata, restricting
    access to information, and publishing the map. Also, you will learn how to use
    this published map from a web browser, QGIS, and other desktop GISes.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍 QGIS Cloud 服务，这是一个强大的地图托管平台，您将学习如何通过在互联网上发布地图与他人共享您的地图。我们将涵盖所有必要的步骤，例如创建
    QGIS Cloud 账户、准备地图以供发布、填写元数据、限制信息访问以及发布地图。此外，您还将学习如何从网络浏览器、QGIS 和其他桌面 GIS 中使用已发布的地图。
- en: 'In this chapter, we will go through the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Registering for the QGIS Cloud service
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册 QGIS Cloud 服务
- en: The QGIS Cloud plugin
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: QGIS Cloud 插件
- en: Creating a database
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建数据库
- en: Publishing the map
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发布地图
- en: Viewing your map in QGIS and a browser
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 QGIS 和浏览器中查看您的地图
- en: Deleting unused maps
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除未使用的地图
- en: Registering for the QGIS Cloud service
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 注册 QGIS Cloud 服务
- en: QGIS Cloud is a cloud hosting service, developed and maintained by Sourcepole
    AG. Using this service, we can easily publish maps, share them with others, and
    even modify data—all this without any special knowledge, such as server setup
    and administration.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS Cloud 是由 Sourcepole AG 开发和维护的云托管服务。使用此服务，我们可以轻松发布地图、与他人共享地图，甚至修改数据——这一切都不需要任何特殊知识，例如服务器设置和管理。
- en: QGIS Cloud is built using open source technologies. To store vector data, it
    uses PostgreSQL/PostGIS databases, maps rendered with the QGIS server, and a web
    viewer based on QGIS Web Client. As a result, it integrates very well with desktop
    QGIS. Layers stored on the cloud can be loaded and edited with QGIS. A published
    map will have the same look and feel as a local map created in QGIS.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS Cloud 是使用开源技术构建的。为了存储矢量数据，它使用 PostgreSQL/PostGIS 数据库、由 QGIS 服务器渲染的地图以及基于
    QGIS Web 客户端的网络查看器。因此，它与桌面 QGIS 集成得非常好。存储在云上的图层可以用 QGIS 加载和编辑。发布的地图将与在 QGIS 中创建的本地地图具有相同的外观和感觉。
- en: 'First, we need to create an account. This can be done with these simple steps:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要创建一个账户。这可以通过以下简单步骤完成：
- en: Open your browser and go to [https://qgiscloud.com](https://qgiscloud.com).
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开您的浏览器并访问 [https://qgiscloud.com](https://qgiscloud.com)。
- en: Click on the **Sign Up** button on the main page.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击主页上的 **注册** 按钮。
- en: Fill in and submit the registration form. You will need to provide a valid e-mail
    address and password.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写并提交注册表格。您需要提供一个有效的电子邮件地址和密码。
- en: After submitting the form, you will get a confirmation e-mail, with confirmation
    instructions. Confirm your account by visiting the link given in the e-mail.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在提交表格后，您将收到一封确认电子邮件，其中包含确认说明。通过访问电子邮件中提供的链接来确认您的账户。
- en: That's all! Now you have a QGIS Cloud account with a free plan. This plan allows
    you to publish an unlimited number of public maps, create five PostGIS databases,
    and upload up to 50 MB of data.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 就这些了！现在您拥有了一个带有免费计划的 QGIS Cloud 账户。此计划允许您发布无限数量的公共地图，创建五个 PostGIS 数据库，并上传高达
    50 MB 的数据。
- en: Note
  id: totrans-18
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If you need more space for data, want to restrict access to your maps, or need
    some other special features, consider switching to one of the paid plans available.
    These plans, and the options they provide, are listed at [https://qgiscloud.com/en/pages/plans](https://qgiscloud.com/en/pages/plans).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要更多空间来存储数据，想要限制对您地图的访问，或者需要一些其他特殊功能，请考虑切换到可用的付费计划之一。这些计划及其提供的选项列在 [https://qgiscloud.com/en/pages/plans](https://qgiscloud.com/en/pages/plans)。
- en: You can also open the QGIS Cloud sign-up page directly from the QGIS Cloud plugin,
    if it is already installed. Just activate the plugin and click on the **Signup**
    link under the **Account** or **Services** tab. The corresponding page will open
    in your web browser.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 QGIS Cloud 插件已经安装，您也可以直接从 QGIS Cloud 插件打开注册页面。只需激活插件，然后在 **账户** 或 **服务**
    选项卡下点击 **注册** 链接。相应的页面将在您的网络浏览器中打开。
- en: The QGIS Cloud plugin
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: QGIS Cloud 插件
- en: The **QGIS Cloud plugin** provides a user-friendly interface for publishing
    your data and maps with QGIS Cloud hosting. As it is a third-party plugin, we
    first need to install it.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '**QGIS Cloud 插件** 为您提供了使用 QGIS Cloud 托管发布数据和地图的用户友好界面。由于它是一个第三方插件，我们首先需要安装它。'
- en: 'If you have a proxy server, it is necessary to configure it first. **Plugin
    Manager** uses the same proxy settings as QGIS, so all you need to do is to go
    to **Settings** | **Options** and set up a proxy in the **Network** tab:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有代理服务器，则需要先进行配置。**插件管理器**使用与QGIS相同的代理设置，因此您只需转到**设置** | **选项**，在**网络**标签页中设置代理即可：
- en: Start QGIS and open **Plugin Manager** by going to **Plugins** | **Manage and
    Install Plugins**. Wait while QGIS receives a list of plugins from the repository.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动QGIS，通过转到**插件** | **管理并安装插件**来打开**插件管理器**。等待QGIS从存储库接收插件列表。
- en: Switch to the **All** tab and start typing `cloud` in the **Search** field in
    order to filter the list of plugins, as shown in this screenshot:![The QGIS Cloud
    plugin](img/image00410.jpeg)
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到**全部**标签页，并在**搜索**字段中开始键入`cloud`以过滤插件列表，如图所示：![QGIS Cloud插件](img/image00410.jpeg)
- en: Then, select the plugin and click on the **Install plugin** button. The download
    will take some time, so be patient. When it completes, you will see a message
    bar with the confirmation of the download, and you can now close **Plugin Manager**.
    More information about installing plugins can be found in the *Extending functionality
    through plugins* section of [Chapter 1](part0014.xhtml#aid-DB7S2 "Chapter 1. Handling
    Your Data"), *Handling Your Data*.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，选择插件并点击**安装插件**按钮。下载可能需要一些时间，请耐心等待。下载完成后，您将看到一个消息栏，显示下载确认，现在您可以关闭**插件管理器**。有关安装插件的更多信息，请参阅[第1章](part0014.xhtml#aid-DB7S2
    "第1章. 处理您的数据")中*通过插件扩展功能*部分，*处理您的数据*。
- en: After installing, the QGIS Cloud plugin will be available in the **Plugins**
    menu. QGIS Cloud plugin also puts button ![The QGIS Cloud plugin](img/image00411.jpeg)
    in the **Plugins** toolbar and creates a **QGIS Cloud** floating panel. By default,
    this panel is docked on the left side of QGIS's main window.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 安装后，QGIS Cloud插件将在**插件**菜单中可用。QGIS Cloud插件还在**插件**工具栏中放置了一个按钮![QGIS Cloud插件](img/image00411.jpeg)，并创建了一个**QGIS
    Cloud**浮动面板。默认情况下，此面板停靠在QGIS主窗口的左侧。
- en: 'Let''s look at the plugin''s interface:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看插件界面：
- en: '![The QGIS Cloud plugin](img/image00412.jpeg)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![QGIS Cloud插件](img/image00412.jpeg)'
- en: 'The plugin panel has four tabs:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 插件面板有四个标签页：
- en: '**Services**: This is used to publish maps and update already published maps.
    Initially, this tab contains a short description of the plugin and the service
    itself, with links to the hosting website and its sign-up page. After publishing
    the map, you will find here links to the just published map (both desktop and
    mobile viewers) and the URL of the WMS service with your map.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务**：此标签页用于发布地图和更新已发布的地图。最初，此标签页包含插件及其服务的简短描述，以及到托管网站和注册页面的链接。发布地图后，您将在这里找到指向刚刚发布的地图（包括桌面和移动查看器）的链接以及带有您地图的WMS服务URL。'
- en: '**Upload Data**: This allows you to upload local data to the QGIS Cloud database
    and publish the map. Here, we can select the database to be used, adjust the table
    names before publishing, and upload our local data to QGIS Cloud.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**上传数据**：这允许您将本地数据上传到QGIS Cloud数据库并发布地图。在这里，我们可以选择要使用的数据库，在发布前调整表名，并将我们的本地数据上传到QGIS
    Cloud。'
- en: '**Account**: This is used for authentication and account management. With this
    tab, you can register for QGIS Cloud if you have no account yet. Also we can create
    databases and delete them here, if necessary.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**账户**：此标签页用于身份验证和账户管理。使用此标签页，如果您还没有账户，可以注册QGIS Cloud。此外，我们还可以在这里创建和删除数据库（如果需要）。'
- en: '**About**: Here, you will find information about the plugin''s authors, QGIS
    Cloud support contacts, and the plugin version. This information will be useful
    in the event of problems.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**关于**：在这里，您可以找到有关插件作者、QGIS Cloud支持联系人和插件版本的信息。在出现问题时，这些信息将非常有用。'
- en: Now, switch to the **Account** tab of the **QGIS Cloud** panel, click on **Login**,
    and use your user name and password to log in. This may take some time, as the
    plugin needs to interact with the QGIS Cloud server. After a successful login,
    a message bar pops up, and you will see in the plugin panel information about
    your current plan, used/free disk space (if you already have databases), and a
    list of existing databases, if any.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，切换到**QGIS Cloud**面板的**账户**标签页，点击**登录**，并使用您的用户名和密码登录。这可能需要一些时间，因为插件需要与QGIS
    Cloud服务器交互。登录成功后，会弹出一个消息栏，您将在插件面板中看到您当前的计划信息、已用/可用磁盘空间（如果您已有数据库），以及现有数据库列表（如果有）。
- en: Creating a database
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建数据库
- en: QGIS Cloud stores all your geodata in PostgreSQL/PostGIS databases, so it is
    necessary to create at least one database for your data before uploading any layers
    and publishing the map.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS Cloud 将所有您的地理数据存储在 PostgreSQL/PostGIS 数据库中，因此在上传任何图层和发布地图之前，您至少需要为您的数据创建一个数据库。
- en: 'To create a new database, perform the following steps:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个新的数据库，请执行以下步骤：
- en: Start QGIS and activate the QGIS Cloud plugin, if it is not yet activated.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 QGIS 并激活 QGIS Cloud 插件，如果尚未激活。
- en: Switch to the **Account** tab in the **QGIS Cloud** panel and log in using your
    username and password.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到 **QGIS Cloud** 面板中的 **账户** 选项卡，并使用您的用户名和密码登录。
- en: Click on the **Create database** button at the bottom of the **Account** tab
    and wait until the operation completes.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **账户** 选项卡底部的 **创建数据库** 按钮，等待操作完成。
- en: Database creation is a time-consuming operation, so be patient. When it's done,
    you will see a new database with a random name in the list of available databases.
    Also, the plugin registered this database in QGIS, so it can be used like any
    other PostGIS database, for example, for loading and editing layers from it in
    QGIS.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库创建是一个耗时的操作，所以请耐心等待。完成后，您将在可用数据库列表中看到一个随机命名的新的数据库。此外，插件已将此数据库注册到 QGIS 中，因此它可以像任何其他
    PostGIS 数据库一样使用，例如，在 QGIS 中从中加载和编辑图层。
- en: Note
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'If you are behind a firewall and/or have problems with creating the database,
    contact QGIS Cloud support via e-mail: `<[support@qgiscloud.com](mailto:support@qgiscloud.com)>`.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你位于防火墙后面并且/或者创建数据库时遇到问题，请通过电子邮件联系 QGIS Cloud 支持：`<[support@qgiscloud.com](mailto:support@qgiscloud.com)>`。
- en: In the event that this PostGIS connection—which is created by the plugin—is
    removed from QGIS by accident, it can be restored manually. Just log in to QGIS
    Cloud using the plugin and hold the cursor over the database name. In the tooltip,
    you will find all of the information (host, port number, database username, and
    password) needed for creating the connection. We can also use this information
    to connect to the database with other PostgreSQL clients, such as psql or pgAdmin.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 如果意外地通过插件从 QGIS 中删除了此 PostGIS 连接，可以手动恢复。只需使用插件登录到 QGIS Cloud，并将光标悬停在数据库名称上。在工具提示中，您将找到创建连接所需的所有信息（主机、端口号、数据库用户名和密码）。我们还可以使用这些信息通过其他
    PostgreSQL 客户端连接到数据库，例如 psql 或 pgAdmin。
- en: Unfortunately, you cannot rename the database to something meaningful, so keep
    a list somewhere with information about which data is stored in each database,
    for future reference. Also, you can examine the database's content with the DB
    Manager.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，你不能将数据库重命名为有意义的名称，所以请在一个地方保留一个列表，记录每个数据库中存储的数据信息，以备将来参考。此外，你可以使用 DB 管理员检查数据库的内容。
- en: For convenience, we recommend that you keep each map/project in separate databases.
    This introduces some disk usage overhead, as each empty database is about 11 MB
    in size, but such an approach also simplifies things a lot. For example, you can
    easily remove an unused map without losing data used in another map that is also
    stored in the same database. Of course, it is possible to keep many layers in
    a single database and use them in different maps, but this will lead to some complexity
    when you decide to remove some maps or layers.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 为了方便起见，我们建议您将每个地图/项目保存在单独的数据库中。这样做会引入一些磁盘使用开销，因为每个空数据库的大小约为 11 MB，但这种方法也大大简化了事情。例如，您可以轻松删除未使用的地图，而不会丢失存储在同一数据库中的另一个地图中使用的数据。当然，您也可以将许多图层保存在单个数据库中并在不同的地图中使用它们，但这在您决定删除某些地图或图层时会导致一些复杂性。
- en: Remember that you cannot create more databases than what is allowed by your
    plan; the same applies to using disk storage. If you need more space or databases,
    upgrade to another plan.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，你创建的数据库数量不能超过你的计划允许的数量；使用磁盘存储也是如此。如果你需要更多空间或数据库，请升级到另一个计划。
- en: Publishing the map
  id: totrans-49
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 发布地图
- en: Now, when a new database is created, we can publish the map designed in [Chapter
    2](part0021.xhtml#aid-K0RQ1 "Chapter 2. Visualizing and Styling the Data"), *Visualizing
    and Styling the Data*, on the Internet.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，当创建一个新的数据库时，我们可以在互联网上发布在 [第 2 章](part0021.xhtml#aid-K0RQ1 "第 2 章。可视化和样式化数据")
    中设计的地图，*可视化和样式化数据*。
- en: Let's look at our project first; it contains raster and vector layers. There
    are several composers as well. Before publishing the data and map, we need to
    decide which information should be published and what we want to keep hidden.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先看看我们的项目；它包含栅格和矢量图层。还有几个作曲家。在发布数据和地图之前，我们需要决定哪些信息应该发布，以及我们想要隐藏什么。
- en: By default, all vector layers are published with all their attributes available
    for both WMS and WFS services. All composers available in the project will be
    published too.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，所有矢量图层都会发布，其所有属性都可用于 WMS 和 WFS 服务。项目中的所有可用作曲者也会被发布。
- en: If you need to keep some attributes of the layer (or layers) unpublished, it
    is necessary to adjust the properties of the corresponding layer (or layers).
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要保留图层（或图层组）的一些属性不发布，那么就需要调整相应图层（或图层组）的属性。
- en: Note
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Later, in the *WMS settings* section of this chapter, you will learn how to
    exclude entire layers and composers from publishing.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的 *WMS 设置* 部分中，你将学习如何排除整个图层和作曲者不进行发布。
- en: 'To do this, select a layer from the QGIS layer tree, right-click to open the
    context menu, and select **Properties**. In the **Layer Properties** dialog, go
    to the **Fields** tab, as shown in the following screenshot:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 要这样做，从 QGIS 图层树中选择一个图层，右键单击以打开上下文菜单，然后选择 **属性**。在 **图层属性** 对话框中，转到 **字段** 选项卡，如下面的截图所示：
- en: '![Publishing the map](img/image00413.jpeg)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![发布地图](img/image00413.jpeg)'
- en: Here, we see a table with all the layer attributes, including additional information
    about them (data type, field length, precision, and so on). The last two columns,
    **WMS** and **WFS**, control attributes' visibility when the layer is published
    as WMS and/or WFS layer. If you don't want to publish some attributes, just deactivate
    the corresponding checkboxes. Then, click on the **OK** button to save the changes
    and close the dialog. Note that the same attribute can be published with WMS and
    not be available via WFS, and vice versa. Go through all the vector layers, examine
    their attributes, and hide them if necessary.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们看到一个包含所有图层属性以及它们附加信息的表格（数据类型、字段长度、精度等）。最后两列，**WMS** 和 **WFS**，控制当图层作为
    WMS 和/或 WFS 图层发布时属性的可见性。如果你不想发布某些属性，只需取消选中相应的复选框。然后，点击 **OK** 按钮保存更改并关闭对话框。请注意，同一个属性可以通过
    WMS 发布，但通过 WFS 则不可用，反之亦然。检查所有矢量图层，查看它们的属性，并在必要时隐藏它们。
- en: Now it is time to think about raster layers. Unfortunately, QGIS Cloud currently
    allows you to upload only local vector layers; local raster layer support is not
    available yet. But don't be discouraged! You can use WMS services and basemaps
    instead.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是时候考虑光栅图层了。不幸的是，QGIS Cloud 目前只允许你上传本地矢量图层；本地光栅图层支持尚不可用。但不要气馁！你可以使用 WMS 服务和底图来代替。
- en: If our raster layers are also available as a WMS service, we can safely replace
    the local files with WMS layers, and our map will be published without losing
    any data. The already added WMS layers will be published as well.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们的光栅图层也作为 WMS 服务可用，我们可以安全地将本地文件替换为 WMS 图层，并且我们的地图将发布而不会丢失任何数据。已添加的 WMS 图层也将被发布。
- en: But what to do if the raster data is available only as local files and you really
    need a background map? Fortunately, QGIS allows you to add basemaps; all you need
    is to install the **OpenLayers plugin**. Once this plugin is installed, go to
    **Web** | **OpenLayers plugin** and add the desired background maps from the available
    list. It is possible to add several background maps, for example, OpenStreetMap
    and Bing, so that after publishing the project, users will be able to switch between
    them.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 但如果只有光栅数据作为本地文件可用，而你又真的需要一个底图怎么办呢？幸运的是，QGIS 允许你添加底图；你只需要安装 **OpenLayers 插件**。一旦安装了此插件，请转到
    **Web** | **OpenLayers 插件**，并从可用列表中添加所需的底图。可以添加多个底图，例如 OpenStreetMap 和 Bing，这样在发布项目后，用户将能够在它们之间切换。
- en: Note that it is possible to have both the types of layers in the same map—WMS
    and background maps. Remember, however, that the WMS layer will overlay the background
    map and may cover it completely. If you want to see the background map under the
    WMS layer, don't forget to set the transparency for the WMS layers before publishing.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，可以在同一张地图中同时拥有这两种类型的图层——WMS 和底图。然而，请记住，WMS 图层将覆盖底图，并可能完全覆盖它。如果你想在 WMS 图层下看到底图，发布前别忘了设置
    WMS 图层的透明度。
- en: Our map contains only one raster layer—the digital elevation model—which has
    been loaded from a local file and, as a result, cannot be published. Let's add
    some other raster data that will be available from the published map.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们地图中只有一个光栅图层——数字高程模型，它已从本地文件加载，因此无法发布。让我们添加一些其他光栅数据，这些数据将可以从发布的地图中获取。
- en: 'As our map contains a DEM layer, it will be good to find a suitable replacement
    for it. Fortunately, USGS provides access to some maps, including shaded relief,
    via WMS. Of course, this layer is not as detailed as our DEM, but for online maps,
    it is more than enough. First, we need to create a new WMS connection by following
    these steps:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们的地图包含一个DEM图层，因此找到合适的替代品将很好。幸运的是，USGS通过WMS提供对一些地图的访问，包括阴影地形。当然，此图层不如我们的DEM详细，但对于在线地图来说，这已经足够了。首先，我们需要通过以下步骤创建一个新的WMS连接：
- en: Click on the **Add WMS/WMTS Layer** button in the **Layers** toolbar, or go
    to **Layer** | **Add Layer** | **Add WMS/WMTS Layer**. In the **Add Layer(s) from
    a WM(T)S Server** dialog, click on **New** to create a new connection. Enter `USGS
    Relief (base)` as **Name** and [http://basemap.nationalmap.gov/arcgis/services/USGSShadedReliefOnly/MapServer/WMSServer?request=GetCapabilities&service=WMS](http://basemap.nationalmap.gov/arcgis/services/USGSShadedReliefOnly/MapServer/WMSServer?request=GetCapabilities&service=WMS)
    as **URL**, and click on **OK**. Select the newly added connection from the combobox
    and click on the **Connect** button.
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**图层**工具栏中单击**添加WMS/WMTS图层**按钮，或转到**图层** | **添加图层** | **添加WMS/WMTS图层**。在**从WM(T)S服务器添加图层**对话框中，单击**新建**以创建新的连接。将**名称**输入为`USGS
    Relief (base)`，将[http://basemap.nationalmap.gov/arcgis/services/USGSShadedReliefOnly/MapServer/WMSServer?request=GetCapabilities&service=WMS](http://basemap.nationalmap.gov/arcgis/services/USGSShadedReliefOnly/MapServer/WMSServer?request=GetCapabilities&service=WMS)作为**URL**，然后单击**确定**。从组合框中选择新添加的连接，然后单击**连接**按钮。
- en: From the layers tree, select the first node, called **USGS Shaded Relief...**.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从图层树中选择第一个节点，称为**USGS阴影地形...**。
- en: In the **Coordinate Reference Systems** group, click on **Change**, find and
    select **WGS 84 / Pseudo Mercator (EPSG:3857)**, and click on **OK**.
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**坐标参考系统**组中，单击**更改**，找到并选择**WGS 84 /伪墨卡托（EPSG:3857）**，然后单击**确定**。
- en: Click on **Add** and close the WMS dialog.
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击**添加**并关闭WMS对话框。
- en: Finally, move the added layer below all the vector layers, so that it will be
    at the bottom of the QGIS layer tree.
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，将添加的图层移至所有矢量图层之下，使其位于QGIS图层树的底部。
- en: Note
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'Note that this shaded relief layer contains data for a scale of 1:18000 or
    smaller. If you want to display relief on more detailed scales, it will be necessary
    to add one more layer using another WMS URL: [http://services.nationalmap.gov/arcgis/services/USGSShadedReliefLarge/MapServer/WMSServer?request=GetCapabilities&service=WMS](http://services.nationalmap.gov/arcgis/services/USGSShadedReliefLarge/MapServer/WMSServer?request=GetCapabilities&service=WMS).'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，此阴影地形图层包含1:18000或更小比例尺的数据。如果您想在更详细的尺度上显示地形，则必须添加另一个使用另一个WMS URL的图层：[http://services.nationalmap.gov/arcgis/services/USGSShadedReliefLarge/MapServer/WMSServer?request=GetCapabilities&service=WMS](http://services.nationalmap.gov/arcgis/services/USGSShadedReliefLarge/MapServer/WMSServer?request=GetCapabilities&service=WMS)。
- en: You may have noticed that we added the layer in **EPSG:3857** while all our
    vector layers are in EPSG:2263\. As a result, we now have "on-the-fly" reprojection
    enabled, and the project CRS is EPSG:3857\. This is because we will also add a
    background Bing map, which is available only in EPSG:3857\. If you don't need
    a background map, it is better to use a CRS that matches the CRS of your vector
    data or a well-known CRS, such as **WGS 84** and **WGS 84 / Pseudo Mercator**.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能已经注意到，我们在**EPSG:3857**中添加了图层，而所有矢量图层都在EPSG:2263中。因此，我们现在启用了“即时”重投影，项目坐标参考系统是EPSG:3857。这是因为我们还将添加一个背景Bing地图，该地图仅在EPSG:3857中可用。如果您不需要背景地图，最好使用与您的矢量数据坐标参考系统匹配的CRS或知名CRS，例如**WGS
    84**和**WGS 84 /伪墨卡托**。
- en: Now, we will add a background map with Bing aerial images.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将添加带有Bing航空图像的背景地图。
- en: Note
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Note that using some background maps may violate the terms of service of those
    maps. Before adding any background map, check whether you are allowed to use that
    service with your online map and redistribute maps that contain data from that
    service.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，使用某些背景地图可能会违反这些地图的服务条款。在添加任何背景地图之前，请检查您是否允许使用该服务与您的在线地图，并重新分发包含该服务数据的地图。
- en: 'To do this, perform the following steps:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 要这样做，请执行以下步骤：
- en: Install and activate the **OpenLayers plugin** (see the *Extending functionality
    through plugins* section of [Chapter 1](part0014.xhtml#aid-DB7S2 "Chapter 1. Handling
    Your Data"), *Handling Your Data*, for more details).
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装并激活**OpenLayers插件**（有关更多详细信息，请参阅[第1章](part0014.xhtml#aid-DB7S2 "第1章。处理您的数据")中的*通过插件扩展功能*部分，*处理您的数据*），*处理您的数据*）。
- en: Go to **Web** | **OpenLayers plugin** | **Bing Maps** | **Bing Aerial**.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**Web** | **OpenLayers插件** | **Bing Maps** | **Bing Aerial**。
- en: Move the newly added layer to the bottom of the QGIS layer tree, so that it
    will be below all other layers.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新添加的图层移动到QGIS图层树的底部，这样它就会位于所有其他图层之下。
- en: If necessary, you can add more WMS layers and/or background maps, but don't
    overload your map by additional layers without the need to do so. Also choose
    which raster will be visible by default and turn the other raster layers off in
    order to speed up map loading. Save the project when all the changes have been
    implemented.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要，您可以添加更多WMS图层和/或背景地图，但不要在没有必要的情况下通过额外的图层超载您的地图。同时选择默认可见的栅格，并关闭其他栅格图层以加快地图加载速度。在实施所有更改后保存项目。
- en: Now that our data is ready for publishing, our next step is project preparation.
    Of course, you can publish a map as is, but it is better to spend some time and
    make your map more user friendly and professional looking, especially if you plan
    to share it with others.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已准备好发布数据，我们的下一步是项目准备。当然，您可以原样发布地图，但花些时间使您的地图更易于用户使用且看起来更专业，尤其是如果您计划与他人分享它。
- en: General settings
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**一般设置**'
- en: 'First, we fill in some metadata that will help users find our map and provide
    some information about it. To do this, open the **Project Properties** dialog
    by pressing *Ctrl* + *Shift* + *P*, or go to **Project** | **Project Properties...**
    and switch to the **OWS Server** tab. This tab allows us to configure the way
    in which our project will be processed by QGIS Server. There are many different
    settings here; right now, we will look at the **Service capabilities** group:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们填写一些元数据，这将帮助用户找到我们的地图，并提供一些关于它的信息。为此，通过按*Ctrl* + *Shift* + *P*打开**项目属性**对话框，或者转到**项目**
    | **项目属性...**并切换到**OWS服务器**选项卡。此选项卡允许我们配置QGIS服务器将如何处理我们的项目。这里有许多不同的设置；目前，我们将查看**服务能力**组：
- en: '![General settings](img/image00414.jpeg)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![一般设置](img/image00414.jpeg)'
- en: 'Here, we need to fill in this metadata:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，我们需要填写以下元数据：
- en: '**Title**: This is the title of the map. We select `Brooklyn (New York) demo
    map`.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标题**：这是地图的标题。我们选择`布鲁克林（纽约）演示地图`。'
- en: '**Organization**: Here, we specify the map author or owner. Enter your name
    here.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**组织**：在这里，我们指定地图的作者或所有者。请在这里输入您的名字。'
- en: '**Online resource**: Here, we specify the URL that should be used to access
    our map. Right now, we can leave it empty because the map is not published, which
    is why we don''t know its URL. But if you are curious, here is the convention
    used for URL generation in QGIS Cloud: `http://qgiscloud.com/<user_name>/<map_name>/wms`.
    In this, `<user_name>` is your QGIS Cloud login and `<map_name>` is the filename
    of the published project without extension. So, suppose your login is alex and
    the project will be saved after uploading the data as `brooklyn_demo.qgs`. Then,
    the URL will be `http://qgiscloud.com/alex/brooklyn_demo/wms`.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在线资源**：在这里，我们指定用于访问我们地图的URL。目前，我们可以将其留空，因为地图尚未发布，这就是我们不知道其URL的原因。但如果您好奇，以下是QGIS
    Cloud中用于URL生成的约定：`http://qgiscloud.com/<user_name>/<map_name>/wms`。在这里，`<user_name>`是您的QGIS
    Cloud登录名，`<map_name>`是已发布项目的文件名，不带扩展名。所以，假设您的登录名是alex，项目在数据上传后将被保存为`brooklyn_demo.qgs`。那么，URL将是`http://qgiscloud.com/alex/brooklyn_demo/wms`。'
- en: '**Person**: This is the name of the person who is responsible for the published
    map. It is mainly used as support contact. In our case, this is the same person
    as specified in **Organization** field.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**人员**：这是负责已发布地图的人员的姓名。它主要用于支持联系。在我们的情况下，这与**组织**字段中指定的人员相同。'
- en: '**E-Mail** and **Phone**: These are the contact details of the responsible
    person. We can leave them empty or fill in only one field so that users will be
    able to contact the creator of the map if they have any questions or problems.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电子邮件**和**电话**：这是负责人的联系详情。我们可以将其留空或只填写一个字段，以便用户在有任何问题或问题时能够联系地图的创作者。'
- en: '**Abstract**: This is a brief description of our map and used data. It is important
    information, as it helps users understand the purpose and coverage of the map.
    Such information can also be used by metadata catalogs for the purpose of indexing
    and searching maps. Here is our description; you can use it as is or modify it
    according to your tastes:'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**摘要**：这是我们地图和所使用数据的简要描述。这是重要信息，因为它帮助用户了解地图的目的和覆盖范围。此类信息还可以由元数据目录用于索引和搜索地图的目的。以下是我们的描述；您可以直接使用它，或者根据您的喜好进行修改：'
- en: A demo map of the Brooklyn district of the New York city based on the official
    open data from the New York open data portal [https://data.cityofnewyork.us/](https://data.cityofnewyork.us/).
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 基于纽约市布鲁克林区的官方开放数据门户[https://data.cityofnewyork.us/](https://data.cityofnewyork.us/)的纽约市布鲁克林区演示地图。
- en: Map created for Packt Publishing *QGIS by Example* book.
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为Packt Publishing的*QGIS实例*书籍创建的地图。
- en: '**Fees**: This shows information about the fees. It can be ignored if map does
    not use fees.'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**费用**: 这显示了关于费用的信息。如果地图不使用费用，则可以忽略。'
- en: '**Access constraints**: This describes the restrictions on and legal requirements
    for using this map. For example, it can be "For internal use only" or some copyright
    notice. For public maps, this field usually is empty.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**访问限制**: 这描述了使用此地图的约束和法律要求。例如，可以是“仅限内部使用”或某些版权声明。对于公共地图，此字段通常为空。'
- en: '**Keyword list**: This is a list of keywords or short phrases that describe
    the map. This information helps in searching and indexing. For our map, we use
    these keywords; feel free to adjust them to suit your tastes:'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**关键词列表**: 这是一个描述地图的关键词或短语列表。这些信息有助于搜索和索引。对于我们的地图，我们使用这些关键词；请随意调整以适应您的口味：'
- en: '`New York, Brooklyn, QGIS by Example, demo.`'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`纽约，布鲁克林，QGIS实例，演示。`'
- en: It is good practice to fill in metadata not only for the map but also for each
    layer in it, so that when the user looks for the available WMS or WFS layers,
    they will see the layers' descriptions and easily understand that a particular
    layer is suitable for them. Anyone will agree that working with a WMS server where
    layers have a title and an abstract is more comfortable than working with a server
    without such information.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 填写元数据不仅是地图，还包括其中的每个图层，这是一个好习惯，这样当用户查找可用的WMS或WFS图层时，他们将看到图层的描述，并容易理解某个图层是否适合他们。任何人都会同意，与具有标题和摘要的WMS服务器一起工作比与没有此类信息的服务器更舒适。
- en: To edit the layer's metadata, select it from the QGIS layer tree, right-click
    to open the context menu, and choose **Properties**. In the **layer properties**
    dialog, go to the **Metadata** tab. The most important pieces of metadata to fill
    in are **Title**, **Abstract**, and **Keyword list**. After editing the metadata,
    click on **OK** to close the dialog and save the project.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 要编辑图层的元数据，从QGIS图层树中选择它，右键单击以打开上下文菜单，并选择**属性**。在**图层属性**对话框中，转到**元数据**选项卡。需要填写的重要元数据包括**标题**、**摘要**和**关键词列表**。编辑元数据后，单击**确定**以关闭对话框并保存项目。
- en: WMS settings
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: WMS设置
- en: 'Now look at the **WMS Capabilities** group, which allows you to tune the WMS
    service that will be created from our map, as shown in this screenshot:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 现在看看**WMS功能**组，它允许您调整从我们的地图创建的WMS服务，如图中所示：
- en: '![WMS settings](img/image00415.jpeg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![WMS设置](img/image00415.jpeg)'
- en: By default, the entire map will be published. If you want to make only a part
    of your map available via WMS, check the **Advertised extent** box and define
    the allowed extent by entering its minimum and maximum coordinates. Click on the
    **Use Current Canvas Extent** button to restrict the available extent to the current
    map extent.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，整个地图将被发布。如果您只想通过WMS发布地图的一部分，请勾选**广告范围**框，并通过输入其最小和最大坐标来定义允许的范围。单击**使用当前画布范围**按钮以将可用范围限制为当前地图范围。
- en: 'QGIS Server, used by QGIS Cloud, implements a special extension to the WMS
    standard: the **GetPrint** request. This allows you to create printed maps using
    one of the composers available in the project. By default, all available composers
    will be published and advertised for printing. If you don''t need this functionality
    at all or want to hide some composers from users, activate the **Exclude composers**
    group and add the composers that need to be excluded to this list using the **+**
    button.'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS Server，由QGIS Cloud使用，实现了WMS标准的特殊扩展：**GetPrint**请求。这允许您使用项目中的可用作曲家之一创建打印地图。默认情况下，所有可用的作曲家都将发布并广告用于打印。如果您根本不需要此功能或想隐藏一些作曲家供用户使用，请激活**排除作曲家**组，并使用**+**按钮将需要排除的作曲家添加到此列表。
- en: Similarly, you can hide some layers if you don't want to publish all of them.
    To do this, activate the **Exclude layers** group and add layers to exclude using
    the **+** button.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，如果您不想发布所有图层，可以隐藏一些图层。为此，激活**排除图层**组，并使用**+**按钮添加要排除的图层。
- en: Note
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Of course, we can just remove the layers, save the project with a different
    name, and then publish this new project. But in this case, we will lose one major
    advantage—the ability to use the same project for offline and online maps.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们可以简单地删除图层，用不同的名称保存项目，然后发布这个新项目。但在这个情况下，我们将失去一个主要优势——使用同一项目进行离线和在线地图的能力。
- en: Imagine that after publishing a map, you need to change the symbology of a layer.
    In the case of two different projects, you will need to keep them in sync. It
    is much simpler to have a single project and hide the layers by changing the settings.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 想象一下，在发布地图后，您需要更改图层的符号。在两个不同项目的情况下，您需要保持它们同步。拥有一个单一的项目并通过更改设置隐藏图层要简单得多。
- en: The next important setting is **CRS restrictions**. By default, every layer
    can be loaded in any QGIS-supported **coordinate reference systems** (**CRS**).
    As a result, the service capabilities document becomes very large, especially
    when the map contains many layers. This in turn causes slow map loading in web-based
    viewer and desktop clients, as they have to download and parse much more data.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个重要的设置是**CRS 限制**。默认情况下，每个图层都可以在任何 QGIS 支持的**坐标参考系统**（**CRS**）中加载。因此，服务能力文档变得非常大，尤其是在地图包含许多图层时。这反过来又导致基于网络的查看器和桌面客户端加载地图变慢，因为它们必须下载和解析更多的数据。
- en: In real-life applications, only a small subset of coordinate reference systems
    is required. So, we can safely restrict the list of available CRSes without any
    drawbacks, and moreover speed up the loading of our map. To do this, activate
    **CRS restrictions** and add all the necessary CRSes. The **Used** button allows
    us to add the current project's CRS to the list in just one click.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在实际应用中，通常只需要很少一部分坐标参考系统。因此，我们可以安全地限制可用的 CRS 列表，而不会带来任何缺点，并且还能加快我们地图的加载速度。为此，激活**CRS
    限制**并添加所有必要的 CRS。**使用**按钮允许我们只需单击一下就将当前项目的 CRS 添加到列表中。
- en: If you want to enable feature highlighting on identification, don't forget to
    select the **Add geometry to feature response** checkbox. It is also possible
    to limit coordinate precision by adjusting its value in the **GetFeatureInfo geometry
    precision (decimal places)** field.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想在识别时启用特征高亮显示，别忘了勾选**添加几何形状到特征响应**复选框。您还可以通过调整**GetFeatureInfo 几何精度（小数位数）**字段中的值来限制坐标精度。
- en: Finally, you can limit the size of the image returned by the GetMap request
    by defining the width and height in the **Maximums for GetMap** request and adjusting
    **Quality for JPEG images**.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，您可以通过在**GetMap 请求的最大值**中定义宽度和高度以及调整**JPEG 图像质量**来限制由 GetMap 请求返回的图像大小。
- en: WFS settings
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: WFS 设置
- en: 'If you want to make your data available not only as rasters but also as vectors,
    it is necessary to configure **WFS capabilities**, which are shown in the following
    screenshot:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想使数据不仅作为栅格数据可用，还作为矢量数据可用，您需要配置**WFS 功能**，如下面的截图所示：
- en: '![WFS settings](img/image00416.jpeg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![WFS 设置](img/image00416.jpeg)'
- en: 'All you need to do is select the layers that should be available via WFS by
    selecting the corresponding checkboxes in the **Published** column. If the layer
    needs to be editable, it is necessary to specify the supported operations by activating
    the checkboxes in the corresponding columns:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要做的就是通过在**已发布**列中勾选相应的复选框来选择应通过 WFS 可用的图层。如果图层需要可编辑，您需要通过在相应的列中激活复选框来指定支持的操作：
- en: '**Update**: The user can edit existing features (both geometry and attributes)
    in layers with this capability'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**更新**：用户可以使用此功能在具有此功能的图层中编辑现有特征（包括几何形状和属性）'
- en: '**Insert**: The user can add new features to layers with this capability'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**插入**：用户可以使用此功能向图层添加新特征'
- en: '**Delete**: This allows the user to delete existing features from a layer'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**删除**：此功能允许用户从图层中删除现有特征'
- en: Note
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Remember that with the QGIS Cloud free plan, your map will be publicly available,
    and anyone will be able to edit your layers. If you need to restrict access, either
    consider switching to other plans or don't enable editing via WFS.
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 记住，使用 QGIS Cloud 的免费计划时，您的地图将公开可用，任何人都可以编辑您的图层。如果您需要限制访问，请考虑切换到其他计划或不要通过 WFS
    启用编辑功能。
- en: Being the map owner, you can always edit published vector layers by connecting
    to the corresponding QGIS Cloud database via QGIS.
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 作为地图所有者，您可以通过连接到相应的 QGIS Cloud 数据库来始终通过 QGIS 编辑已发布的矢量图层。
- en: When you are satisfied with all the settings, click on the **Apply** button
    to save your changes and then close the **Project Properties** dialog.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 当您对所有设置满意时，点击**应用**按钮保存您的更改，然后关闭**项目属性**对话框。
- en: Now, we can publish our map. Activate the QGIS Cloud plugin, if it has not already
    been activated. Switch to the **Account** tab in the **QGIS Cloud** panel and
    log in using your username and password. First, we need to create the database
    where all our layers will be saved. Database creation is covered in detail in
    the *Creating a database* section of this chapter; return to it if necessary.
    We will assume that a new empty database already exists.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以发布我们的地图。如果尚未激活，请激活QGIS Cloud插件。切换到**QGIS Cloud**面板中的**账户**选项卡，并使用您的用户名和密码登录。首先，我们需要创建一个数据库，所有图层都将保存在该数据库中。数据库创建在本章的*创建数据库*部分有详细说明；如有必要，请返回该部分。我们将假设一个全新的空数据库已经存在。
- en: Switch to the **Upload data** tab. From the **Database** combobox, select the
    database created previously. In the table below this combobox, you will see all
    the layers supported by QGIS Cloud that can be uploaded. If there are no layers,
    click on **Refresh layers**. If necessary, you can adjust the name of the database
    table used to store layer data by editing the text in the **Table name** column.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 切换到**上传数据**选项卡。从**数据库**下拉菜单中选择之前创建的数据库。在此下拉菜单下方的表格中，您将看到所有由QGIS Cloud支持的、可以上传的图层。如果没有图层，请点击**刷新图层**。如有必要，您可以通过编辑**表名**列中的文本来调整用于存储图层数据的数据库表名称。
- en: Note
  id: totrans-126
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Note that while all other columns are editable too, you should not edit them.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，尽管所有其他列也可以编辑，但您不应编辑它们。
- en: Also verify that all the layers listed in this table have the correct CRS assigned.
    QGIS Cloud supports the CRSes available in the EPSG database only, so if some
    layers have a user-defined CRS, it is necessary to reproject them before publishing.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 还要验证表中列出的所有图层都分配了正确的CRS。QGIS Cloud仅支持EPSG数据库中可用的CRS，因此如果某些图层有用户定义的CRS，在发布之前必须重新投影它们。
- en: If **Replace local layers in project** is checked, the plugin will update the
    project by replacing all local vector layers with uploaded layers. So, your project
    will contain layers from the QGIS Cloud database, and you can easily edit them
    from QGIS. All changes in these layers will be immediately visible in the published
    map.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 如果勾选了**替换项目中的本地图层**，插件将通过用上传的图层替换所有本地矢量图层来更新项目。因此，您的项目将包含来自QGIS Cloud数据库的图层，您可以从QGIS中轻松编辑它们。这些图层的所有更改将立即在发布的地图中可见。
- en: To start the data upload, click on the **Upload data** button. The upload will
    take some time, depending on the data size and speed of your Internet connection.
    When it completes, you will be prompted to save the updated project. We recommend
    that you save the published project with a different name so that you will have
    the project with the local data unchanged.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始数据上传，点击**上传数据**按钮。上传所需时间取决于数据大小和您的互联网连接速度。完成上传后，系统会提示您保存更新后的项目。我们建议您使用不同的名称保存已发布的项目，以便您将拥有未更改本地数据的原始项目。
- en: Tip
  id: totrans-131
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: QGIS Cloud uses the name of the project file as the map name, so choose the
    filename of your project carefully; it's better to use something meaningful.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS Cloud使用项目文件名作为地图名称，因此请仔细选择项目文件名；使用有意义的名称会更好。
- en: After successful data upload, a new **Publish Map** button will be shown. Click
    on it to publish your map. That's all! Now your map is available on the Internet.
    Switch to the **Services** tab to get the URLs of standard and mobile viewers,
    the WMS service (the same link can be used for WFS), and the web interface admin
    panel.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 数据上传成功后，将显示一个新的**发布地图**按钮。点击它以发布您的地图。这就完成了！现在您的地图可在互联网上访问。切换到**服务**选项卡以获取标准查看器、移动查看器、WMS服务（同一链接可用于WFS）和Web界面管理面板的URL。
- en: 'If necessary, we can easily update the published map; for example, we can change
    layer symbology, or hide or show some attributes or composers, and so on. To do
    this, just open your project containing the Cloud-based layers, make necessary
    changes, and then publish the map by following these steps:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要，我们可以轻松地更新已发布的地图；例如，我们可以更改图层符号，或隐藏或显示一些属性或作曲家，等等。为此，只需打开包含基于云图层的项目，进行必要的更改，然后按照以下步骤发布地图：
- en: Activate the QGIS Cloud plugin, if it is not activated yet.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果尚未激活，请激活QGIS Cloud插件。
- en: Switch to the **Account** tab in the **QGIS Cloud** panel and log in using your
    username and password.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到**QGIS Cloud**面板中的**账户**选项卡，并使用您的用户名和密码登录。
- en: Now switch to the **Services** tab and press the **Publish Map** button to publish
    the updated map.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在切换到**服务**选项卡，然后点击**发布地图**按钮以发布更新后的地图。
- en: There is no need to upload the data again, as all of the data was uploaded previously,
    and our project now contains layers from the QGIS Cloud database instead of local
    files.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 没有必要再次上传数据，因为所有数据都已在前一次上传，并且我们的项目现在包含来自 QGIS Cloud 数据库的图层，而不是本地文件。
- en: Viewing your map in QGIS and a browser
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 QGIS 和浏览器中查看您的地图
- en: A published map can be viewed in QGIS and a browser. Depending on your needs,
    it is better to use one or the other. A web-based viewer is a good choice if all
    you need is viewing and some basic GIS functionality, such as map navigation,
    feature identification, and printing. Also, a web-based viewer is a great way
    to share your map with others.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 已发布的地图可以在 QGIS 和浏览器中查看。根据您的需求，使用其中一个可能更好。如果您只需要查看地图和一些基本的 GIS 功能，例如地图导航、要素识别和打印，基于网页的查看器是一个不错的选择。此外，基于网页的查看器也是与他人共享您地图的绝佳方式。
- en: Working with a map from a browser
  id: totrans-141
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在浏览器中处理地图
- en: 'QGIS Cloud provides two web viewers: one for mobile devices (smartphones or
    tablets), and another for desktop. Both viewers provide the same basic functionality
    such as map navigation and changing layer visibility. Let''s take a closer look
    at them.'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS Cloud 提供了两个网页查看器：一个用于移动设备（智能手机或平板电脑），另一个用于桌面。这两个查看器都提供了相同的基本功能，例如地图导航和更改图层可见性。让我们更详细地了解一下它们。
- en: 'The standard desktop viewer is based on QGIS Web Client and it looks like a
    simple GIS application that runs in the browser, as seen in the following screenshot:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 标准桌面查看器基于 QGIS Web 客户端，它看起来像是一个在浏览器中运行的简单 GIS 应用程序，如下面的截图所示：
- en: '![Working with a map from a browser](img/image00417.jpeg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![在浏览器中处理地图](img/image00417.jpeg)'
- en: There is a layer tree on the left side, where you can change the layer's visibility
    and enable or disable background maps, if any. On the right-hand side, we can
    find the **Attribute Data** panel (hidden by default), which is used to display
    information about the identified feature. The rest of the space is occupied by
    the map view itself.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 左侧有一个图层树，您可以在其中更改图层的可见性，如果有的话，还可以启用或禁用背景地图。在右侧，我们可以找到**属性数据**面板（默认情况下隐藏），它用于显示有关已识别要素的信息。其余的空间由地图视图本身占据。
- en: In the preceding screenshot, you can see a toolbar with navigation buttons,
    the identify tool, tools for measuring length and/or area, and the **Print Map**
    button. The navigation, identify, and measuring tools work similar to the corresponding
    tools from QGIS.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，您可以看到一个带有导航按钮的工具栏、识别工具、测量长度和/或面积的工具体，以及**打印地图**按钮。导航、识别和测量工具的工作方式与 QGIS
    中的相应工具类似。
- en: 'The most interesting feature of the standard viewer is map printing. If published
    project contains composers, they can be used for producing printed maps. They
    can be used to produce printed maps. To create such a map, zoom to the area of
    interest using the navigation tools, and then click on **Print Map** button. A
    **Print Settings** dialog will appear, and a selection rectangle will be shown
    on the map, like this:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 标准查看器最有趣的功能是地图打印。如果发布的项目包含作曲家，它们可以用于制作打印地图。要创建此类地图，使用导航工具将视图缩放到感兴趣的区域，然后点击**打印地图**按钮。将出现一个**打印设置**对话框，并在地图上显示一个选择矩形，如下所示：
- en: '![Working with a map from a browser](img/image00418.jpeg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![在浏览器中处理地图](img/image00418.jpeg)'
- en: Define the boundaries of the region you want to print by moving and resizing
    the rectangle. Then use the floating **Print Settings** panel to select the desired
    map layout, scale, and resolution. Define the map rotation, if necessary. When
    all the settings are made, click on the **Print** button to generate a PDF file
    containing your map. The generated map will be opened in a new browser window,
    and can be saved on the disk for further usage.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 通过移动和调整矩形的大小来定义您想要打印的区域边界。然后使用浮动的**打印设置**面板选择所需的地图布局、比例尺和分辨率。如果需要，定义地图旋转。当所有设置完成后，点击**打印**按钮以生成包含您地图的
    PDF 文件。生成的地图将在新的浏览器窗口中打开，并可以保存到磁盘以供进一步使用。
- en: The mobile viewer, as the name implies, is optimized for usage with mobile devices,
    such as tablets or smartphones.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 如同其名，移动查看器针对使用移动设备（如平板电脑或智能手机）进行了优化。
- en: '![Working with a map from a browser](img/image00419.jpeg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![在浏览器中处理地图](img/image00419.jpeg)'
- en: All of the available screen area is used to display the map. The buttons on
    touchscreens are large and easy to use. To access the layer tree, press the button
    in the bottom-left corner. The buttons in the top-right corner allow you to enable
    location tracking and set up some other options such as map rotation, scalebar
    display and so on. With the mobile viewer, you have no access to the print map
    capability. Nonetheless, it is possible to use the map for navigation. The viewer
    will track your position and update the map when it changes. If necessary, it
    is also possible to activate map rotation so that the map can be rotated to match
    its north to the actual north.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 所有的可用屏幕区域都用于显示地图。触摸屏上的按钮大且易于使用。要访问图层树，请按左下角的按钮。右上角的按钮允许您启用位置跟踪并设置一些其他选项，例如地图旋转、比例尺显示等。使用移动查看器，您无法访问打印地图功能。尽管如此，您仍然可以使用地图进行导航。查看器将跟踪您的位置并在位置改变时更新地图。如果需要，您还可以激活地图旋转，以便地图可以旋转以使其北方指向实际北方。
- en: Working with a map in QGIS
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在QGIS中处理地图
- en: Web-based viewers are good if all you need is read-only access to data. A published
    map, when used from QGIS, gives you more functionality and flexibility.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您只需要对数据进行只读访问，基于Web的查看器就很好。当使用QGIS查看已发布的地图时，您将获得更多功能和灵活性。
- en: Note
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: You can use published maps not only from QGIS but also from any WMS or WFS client.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用发布的地图，不仅限于QGIS，还可以使用任何WMS或WFS客户端。
- en: By default, every published map is available via the **Web Map Service** (**WMS**)
    protocol. So, it is possible to use a layer from it as a background layer in another
    map or embed it in a web page with the help of libraries such as OpenLayers and
    Leaflet.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，每个发布的地图都可通过**Web地图服务**（**WMS**）协议访问。因此，您可以使用它作为另一个地图的背景图层，或者借助OpenLayers和Leaflet等库将其嵌入网页中。
- en: 'To add a layer from a published map as a WMS layer to QGIS, perform the following
    steps:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 要将发布地图中的图层作为WMS图层添加到QGIS中，请执行以下步骤：
- en: Open the **Add Layer(s) from a WM(T)S Server** dialog using the corresponding
    button on the **Manage Layers** toolbar, or from the **Layer** menu (**Layer**
    | **Add Layer** | **Add WMS/WMTS Layer...**). Add a **New** connection.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**管理图层**工具栏上的相应按钮或从**图层**菜单（**图层** | **添加图层** | **添加WM(T)S服务器图层...**）打开**从WM(T)S服务器添加图层(s)**对话框。添加一个**新**连接。
- en: Enter a connection name (it's best to use something meaningful) and the URL
    of the map.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入连接名称（最好使用有意义的名称）和地图的URL。
- en: Select the created connection from the list and click on **Connect**. A list
    of available published layers will appear. If the map layers have metadata filled
    in, you will see their titles and descriptions.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从列表中选择创建的连接并点击**连接**。将出现可用发布的图层列表。如果地图图层已填写元数据，您将看到它们的标题和描述。
- en: Select the necessary layers and add them to your project.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择必要的图层并将它们添加到您的项目中。
- en: Note that you can add only layers created from your local data. Background maps,
    and WMS layers used in published map are not available. If you need a background
    map and/or WMS layers, add them by using the corresponding plugins or the QGIS
    core functionality.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，您只能添加由本地数据创建的图层。背景地图和用于发布地图的WMS图层不可用。如果您需要背景地图和/或WMS图层，请使用相应的插件或QGIS核心功能添加它们。
- en: 'Also, if enabled by the author, a map can be accessed via the **Web Feature
    Service** (**WFS**) and even modified with the **Web Feature Service Transactional**
    (**WFS-T**) protocols. To access a map via WFS**-**T with QGIS, perform the following
    steps:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，如果作者允许，地图可以通过**Web要素服务**（**WFS**）访问，甚至可以通过**Web要素服务事务**（**WFS-T**）协议进行修改。要使用QGIS通过WFS**-**T访问地图，请执行以下步骤：
- en: Open the **Add WFS Layer from a Server** dialog using the corresponding button
    in the **Manage Layers** toolbar, or from the **Layer** menu (**Layer** | **Add
    Layer** | **Add WFS Layer...**).
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**管理图层**工具栏中的相应按钮或从**图层**菜单（**图层** | **添加图层** | **添加WFS图层...**）打开**从服务器添加WFS图层**对话框。
- en: Add a **New** connection.
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个**新**连接。
- en: Enter a connection name (it's best to use something meaningful) and the URL
    of the map.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入连接名称（最好使用有意义的名称）和地图的URL。
- en: Select the created connection from the list and click on **Connect**. A list
    of available published layers will appear.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从列表中选择创建的连接并点击**连接**。将出现可用发布的图层列表。
- en: Select the necessary layers and add them to your project.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择必要的图层并将它们添加到您的项目中。
- en: If the selected layers have update, delete, and insert capabilities, you can
    edit them with QGIS just as would do with any other layer. All changes will be
    visible in the published map immediately.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 如果选定的图层具有更新、删除和插入功能，你可以使用 QGIS 编辑它们，就像编辑任何其他图层一样。所有更改将立即在发布的地图中可见。
- en: Deleting unused maps
  id: totrans-171
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 删除未使用的地图
- en: With the passage of time, some maps become unnecessary for various reasons.
    If you don't need some maps and data, you will be pleased to know that it is possible
    to remove them and, as a result, free some disk space for new projects.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 随着时间的推移，由于各种原因，一些地图变得不再必要。如果你不需要某些地图和数据，你会很高兴地知道，你可以删除它们，从而为新项目释放一些磁盘空间。
- en: 'There are several ways of removing unused data: with the QGIS Cloud plugin,
    from the QGIS Cloud web interface, and by using DB Manager or any other PostgreSQL/PostGIS
    client. They work differently and complement each other.'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种删除未使用数据的方法：使用 QGIS Cloud 插件、从 QGIS Cloud 网络界面以及使用 DB Manager 或任何其他 PostgreSQL/PostGIS
    客户端。它们工作方式不同，互为补充。
- en: Deleting layers with DB Manager
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 DB Manager 删除图层
- en: As we mentioned previously, QGIS Cloud uses PostgreSQL/PostGIS to store spatial
    data. So, we can easily connect to the database with **DB Manager** or any other
    PostgreSQL client (for example, pgAdmin) and delete unused tables.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们之前提到的，QGIS Cloud 使用 PostgreSQL/PostGIS 来存储空间数据。因此，我们可以轻松地使用 **DB Manager**
    或任何其他 PostgreSQL 客户端（例如，pgAdmin）连接到数据库并删除未使用的表。
- en: 'Assuming that a connection to the QGIS Cloud database is already created, here
    are the necessary steps that we need to perform in order to delete layers, using
    the **DB Manager** plugin:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 假设已经创建了 QGIS Cloud 数据库的连接，以下是使用 **DB Manager** 插件删除图层的必要步骤：
- en: Start the **DB Manager** plugin. As this is a core plugin and is activated by
    default, you can find it by going to **Database** | **DB Manager**. If the **Database**
    menu does not exist, make sure that the **DB Manager** plugin is enabled. More
    information about using QGIS plugins can be found in the *Extending functionality
    through plugins* section of [Chapter 1](part0014.xhtml#aid-DB7S2 "Chapter 1. Handling
    Your Data"), *Handling Your Data*.
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 **DB Manager** 插件。由于这是一个核心插件，默认情况下已激活，你可以通过转到 **数据库** | **DB Manager** 来找到它。如果
    **数据库** 菜单不存在，请确保已启用 **DB Manager** 插件。有关使用 QGIS 插件的信息，请参阅 [第 1 章](part0014.xhtml#aid-DB7S2
    "第 1 章。处理你的数据") 的 *通过插件扩展功能* 部分，*处理你的数据*。
- en: Expand the **PostGIS** item in the database tree and find your database.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在数据库树中展开 **PostGIS** 项，找到你的数据库。
- en: Expand the **public** schema and find the table you want to delete.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 展开公共模式，找到你想要删除的表。
- en: Select the table and right-click to open the context menu. Select **Remove**
    to delete this table from database.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择表，然后右键单击以打开上下文菜单。选择 **删除** 以从数据库中删除此表。
- en: Note that you also need to delete or update the corresponding maps after deleting
    tables. See the *Deleting maps from the web interface* section later in this chapter
    for more information on this.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，你还需要在删除表后删除或更新相应的地图。有关此信息的更多信息，请参阅本章后面的 *从网络界面删除地图* 部分。
- en: Deleting databases from the QGIS Cloud plugin
  id: totrans-182
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 从 QGIS Cloud 插件中删除数据库
- en: 'The QGIS Cloud plugin allows you to not only create a database and publish
    data and maps, but also remove unused databases. To remove an existing database,
    simply follow these steps:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS Cloud 插件不仅允许你创建数据库并发布数据和地图，还可以删除未使用的数据库。要删除现有数据库，只需按照以下步骤操作：
- en: Start QGIS and activate the QGIS Cloud plugin, if it is not activated.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 QGIS 并激活 QGIS Cloud 插件，如果尚未激活。
- en: Switch to the **Account** tab in the **QGIS Cloud** panel, and log in using
    your username and password.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 切换到 **QGIS Cloud** 面板中的 **账户** 选项卡，并使用你的用户名和密码登录。
- en: In the **Databases** list, find the database you want to remove and select it.
    Click on the **Delete database** button and wait while the operation completes.
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **数据库** 列表中找到你想要删除的数据库并选择它。单击 **删除数据库** 按钮，等待操作完成。
- en: Note
  id: totrans-187
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Be careful! Currently, the QGIS Cloud plugin allows you to remove only an entire
    database, so you will lose all of the data from other maps that are stored in
    the deleted database. Make sure you have backups, or look at the previous section
    to learn how to delete separate layers.
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意！目前，QGIS Cloud 插件允许你删除整个数据库，因此你将丢失存储在已删除数据库中的所有其他地图数据。请确保你有备份，或者查看本章前面的部分以了解如何删除单独的图层。
- en: Note that the plugin deletes the entire database, with all of the data in it.
    Maps created using data from this deleted database will still be listed in your
    account, but they will be empty. To delete these maps, we need to use the QGIS
    Cloud web interface, as described in the next section.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，插件会删除整个数据库，包括其中的所有数据。使用此已删除数据库创建的地图仍将列在您的账户中，但它们将是空的。要删除这些地图，我们需要使用下一节中描述的QGIS
    Cloud Web界面。
- en: Deleting maps from the web interface
  id: totrans-190
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 删除Web界面中的地图
- en: Using the web interface, we can remove only unused maps. All of the data associated
    with them will be kept. So, this is a supplementary method and it should be used
    with the methods already described.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Web界面，我们只能删除未使用的地图。与它们相关的所有数据都将保留。因此，这是一个补充方法，应该与已描述的方法一起使用。
- en: 'To remove an unused map, follow these steps:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 要删除未使用的地图，请按照以下步骤操作：
- en: Open the browser and go to the QGIS Cloud site at [https://qgiscloud.com](https://qgiscloud.com).
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开浏览器并访问QGIS Cloud网站[https://qgiscloud.com](https://qgiscloud.com)。
- en: Log in to your account using your username and password.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用您的用户名和密码登录您的账户。
- en: Click on the **Maps** link in the menu at the top.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击顶部菜单中的**地图**链接。
- en: Locate the map that should be removed and click on **Destroy**. Confirm your
    action in the confirmation dialog.
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定位要删除的地图，然后点击**销毁**。在确认对话框中确认您的操作。
- en: Remember that you've deleted only the map. The data used in this map is still
    available in the database (provided that you haven't deleted the database first).
    So, if you don't need this data, it is necessary to delete the database too, unless
    it is being used by other maps. If you are using the same database to store data
    for different maps, you can delete separate layers with any PostgreSQL client,
    as described in the *Deleting layers with DB Manager* section.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，您只删除了地图。用于此地图的数据仍然在数据库中可用（前提是您没有首先删除数据库）。因此，如果您不需要这些数据，则需要删除数据库，除非它被其他地图使用。如果您使用相同的数据库来存储不同地图的数据，您可以使用如*使用DB
    Manager删除图层*部分所述的任何PostgreSQL客户端删除单独的图层。
- en: Summary
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we covered how to publish our maps online using QGIS Cloud
    hosting from QGIS. We saw how to prepare projects for publishing, including specifying
    project metadata, restricting access to some layers and composers, hiding layer
    attributes, and defining allowed actions. Also, you learned how to access a published
    map from different programs and how to manage your QGIS Cloud account.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了如何使用QGIS Cloud托管从QGIS在线发布我们的地图。我们看到了如何为发布准备项目，包括指定项目元数据、限制对某些图层和编者访问、隐藏图层属性以及定义允许的操作。此外，您还学习了如何从不同的程序访问已发布的地图以及如何管理您的QGIS
    Cloud账户。
- en: In the next chapter, you will start getting familiarized with the analysis capabilities
    of QGIS. The first analysis type you will get to know is density analysis.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，您将开始熟悉QGIS的分析功能。您将了解的第一种分析类型是密度分析。
