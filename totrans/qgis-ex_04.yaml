- en: Chapter 4. Publishing the Map Online
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we will cover the QGIS Cloud service, a powerful map hosting
    platform, and you will learn how to use it to share your maps with others by publishing
    them on the Internet. We will cover all the necessary steps, such as creating
    a QGIS Cloud account, preparing your maps for publishing, filling metadata, restricting
    access to information, and publishing the map. Also, you will learn how to use
    this published map from a web browser, QGIS, and other desktop GISes.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will go through the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Registering for the QGIS Cloud service
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The QGIS Cloud plugin
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating a database
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Publishing the map
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Viewing your map in QGIS and a browser
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Deleting unused maps
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Registering for the QGIS Cloud service
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: QGIS Cloud is a cloud hosting service, developed and maintained by Sourcepole
    AG. Using this service, we can easily publish maps, share them with others, and
    even modify data—all this without any special knowledge, such as server setup
    and administration.
  prefs: []
  type: TYPE_NORMAL
- en: QGIS Cloud is built using open source technologies. To store vector data, it
    uses PostgreSQL/PostGIS databases, maps rendered with the QGIS server, and a web
    viewer based on QGIS Web Client. As a result, it integrates very well with desktop
    QGIS. Layers stored on the cloud can be loaded and edited with QGIS. A published
    map will have the same look and feel as a local map created in QGIS.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to create an account. This can be done with these simple steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Open your browser and go to [https://qgiscloud.com](https://qgiscloud.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Sign Up** button on the main page.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Fill in and submit the registration form. You will need to provide a valid e-mail
    address and password.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After submitting the form, you will get a confirmation e-mail, with confirmation
    instructions. Confirm your account by visiting the link given in the e-mail.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: That's all! Now you have a QGIS Cloud account with a free plan. This plan allows
    you to publish an unlimited number of public maps, create five PostGIS databases,
    and upload up to 50 MB of data.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: If you need more space for data, want to restrict access to your maps, or need
    some other special features, consider switching to one of the paid plans available.
    These plans, and the options they provide, are listed at [https://qgiscloud.com/en/pages/plans](https://qgiscloud.com/en/pages/plans).
  prefs: []
  type: TYPE_NORMAL
- en: You can also open the QGIS Cloud sign-up page directly from the QGIS Cloud plugin,
    if it is already installed. Just activate the plugin and click on the **Signup**
    link under the **Account** or **Services** tab. The corresponding page will open
    in your web browser.
  prefs: []
  type: TYPE_NORMAL
- en: The QGIS Cloud plugin
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The **QGIS Cloud plugin** provides a user-friendly interface for publishing
    your data and maps with QGIS Cloud hosting. As it is a third-party plugin, we
    first need to install it.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you have a proxy server, it is necessary to configure it first. **Plugin
    Manager** uses the same proxy settings as QGIS, so all you need to do is to go
    to **Settings** | **Options** and set up a proxy in the **Network** tab:'
  prefs: []
  type: TYPE_NORMAL
- en: Start QGIS and open **Plugin Manager** by going to **Plugins** | **Manage and
    Install Plugins**. Wait while QGIS receives a list of plugins from the repository.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Switch to the **All** tab and start typing `cloud` in the **Search** field in
    order to filter the list of plugins, as shown in this screenshot:![The QGIS Cloud
    plugin](img/image00410.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Then, select the plugin and click on the **Install plugin** button. The download
    will take some time, so be patient. When it completes, you will see a message
    bar with the confirmation of the download, and you can now close **Plugin Manager**.
    More information about installing plugins can be found in the *Extending functionality
    through plugins* section of [Chapter 1](part0014.xhtml#aid-DB7S2 "Chapter 1. Handling
    Your Data"), *Handling Your Data*.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After installing, the QGIS Cloud plugin will be available in the **Plugins**
    menu. QGIS Cloud plugin also puts button ![The QGIS Cloud plugin](img/image00411.jpeg)
    in the **Plugins** toolbar and creates a **QGIS Cloud** floating panel. By default,
    this panel is docked on the left side of QGIS's main window.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s look at the plugin''s interface:'
  prefs: []
  type: TYPE_NORMAL
- en: '![The QGIS Cloud plugin](img/image00412.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'The plugin panel has four tabs:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Services**: This is used to publish maps and update already published maps.
    Initially, this tab contains a short description of the plugin and the service
    itself, with links to the hosting website and its sign-up page. After publishing
    the map, you will find here links to the just published map (both desktop and
    mobile viewers) and the URL of the WMS service with your map.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Upload Data**: This allows you to upload local data to the QGIS Cloud database
    and publish the map. Here, we can select the database to be used, adjust the table
    names before publishing, and upload our local data to QGIS Cloud.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Account**: This is used for authentication and account management. With this
    tab, you can register for QGIS Cloud if you have no account yet. Also we can create
    databases and delete them here, if necessary.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**About**: Here, you will find information about the plugin''s authors, QGIS
    Cloud support contacts, and the plugin version. This information will be useful
    in the event of problems.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now, switch to the **Account** tab of the **QGIS Cloud** panel, click on **Login**,
    and use your user name and password to log in. This may take some time, as the
    plugin needs to interact with the QGIS Cloud server. After a successful login,
    a message bar pops up, and you will see in the plugin panel information about
    your current plan, used/free disk space (if you already have databases), and a
    list of existing databases, if any.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a database
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: QGIS Cloud stores all your geodata in PostgreSQL/PostGIS databases, so it is
    necessary to create at least one database for your data before uploading any layers
    and publishing the map.
  prefs: []
  type: TYPE_NORMAL
- en: 'To create a new database, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Start QGIS and activate the QGIS Cloud plugin, if it is not yet activated.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Switch to the **Account** tab in the **QGIS Cloud** panel and log in using your
    username and password.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Create database** button at the bottom of the **Account** tab
    and wait until the operation completes.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Database creation is a time-consuming operation, so be patient. When it's done,
    you will see a new database with a random name in the list of available databases.
    Also, the plugin registered this database in QGIS, so it can be used like any
    other PostGIS database, for example, for loading and editing layers from it in
    QGIS.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'If you are behind a firewall and/or have problems with creating the database,
    contact QGIS Cloud support via e-mail: `<[support@qgiscloud.com](mailto:support@qgiscloud.com)>`.'
  prefs: []
  type: TYPE_NORMAL
- en: In the event that this PostGIS connection—which is created by the plugin—is
    removed from QGIS by accident, it can be restored manually. Just log in to QGIS
    Cloud using the plugin and hold the cursor over the database name. In the tooltip,
    you will find all of the information (host, port number, database username, and
    password) needed for creating the connection. We can also use this information
    to connect to the database with other PostgreSQL clients, such as psql or pgAdmin.
  prefs: []
  type: TYPE_NORMAL
- en: Unfortunately, you cannot rename the database to something meaningful, so keep
    a list somewhere with information about which data is stored in each database,
    for future reference. Also, you can examine the database's content with the DB
    Manager.
  prefs: []
  type: TYPE_NORMAL
- en: For convenience, we recommend that you keep each map/project in separate databases.
    This introduces some disk usage overhead, as each empty database is about 11 MB
    in size, but such an approach also simplifies things a lot. For example, you can
    easily remove an unused map without losing data used in another map that is also
    stored in the same database. Of course, it is possible to keep many layers in
    a single database and use them in different maps, but this will lead to some complexity
    when you decide to remove some maps or layers.
  prefs: []
  type: TYPE_NORMAL
- en: Remember that you cannot create more databases than what is allowed by your
    plan; the same applies to using disk storage. If you need more space or databases,
    upgrade to another plan.
  prefs: []
  type: TYPE_NORMAL
- en: Publishing the map
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now, when a new database is created, we can publish the map designed in [Chapter
    2](part0021.xhtml#aid-K0RQ1 "Chapter 2. Visualizing and Styling the Data"), *Visualizing
    and Styling the Data*, on the Internet.
  prefs: []
  type: TYPE_NORMAL
- en: Let's look at our project first; it contains raster and vector layers. There
    are several composers as well. Before publishing the data and map, we need to
    decide which information should be published and what we want to keep hidden.
  prefs: []
  type: TYPE_NORMAL
- en: By default, all vector layers are published with all their attributes available
    for both WMS and WFS services. All composers available in the project will be
    published too.
  prefs: []
  type: TYPE_NORMAL
- en: If you need to keep some attributes of the layer (or layers) unpublished, it
    is necessary to adjust the properties of the corresponding layer (or layers).
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Later, in the *WMS settings* section of this chapter, you will learn how to
    exclude entire layers and composers from publishing.
  prefs: []
  type: TYPE_NORMAL
- en: 'To do this, select a layer from the QGIS layer tree, right-click to open the
    context menu, and select **Properties**. In the **Layer Properties** dialog, go
    to the **Fields** tab, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Publishing the map](img/image00413.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Here, we see a table with all the layer attributes, including additional information
    about them (data type, field length, precision, and so on). The last two columns,
    **WMS** and **WFS**, control attributes' visibility when the layer is published
    as WMS and/or WFS layer. If you don't want to publish some attributes, just deactivate
    the corresponding checkboxes. Then, click on the **OK** button to save the changes
    and close the dialog. Note that the same attribute can be published with WMS and
    not be available via WFS, and vice versa. Go through all the vector layers, examine
    their attributes, and hide them if necessary.
  prefs: []
  type: TYPE_NORMAL
- en: Now it is time to think about raster layers. Unfortunately, QGIS Cloud currently
    allows you to upload only local vector layers; local raster layer support is not
    available yet. But don't be discouraged! You can use WMS services and basemaps
    instead.
  prefs: []
  type: TYPE_NORMAL
- en: If our raster layers are also available as a WMS service, we can safely replace
    the local files with WMS layers, and our map will be published without losing
    any data. The already added WMS layers will be published as well.
  prefs: []
  type: TYPE_NORMAL
- en: But what to do if the raster data is available only as local files and you really
    need a background map? Fortunately, QGIS allows you to add basemaps; all you need
    is to install the **OpenLayers plugin**. Once this plugin is installed, go to
    **Web** | **OpenLayers plugin** and add the desired background maps from the available
    list. It is possible to add several background maps, for example, OpenStreetMap
    and Bing, so that after publishing the project, users will be able to switch between
    them.
  prefs: []
  type: TYPE_NORMAL
- en: Note that it is possible to have both the types of layers in the same map—WMS
    and background maps. Remember, however, that the WMS layer will overlay the background
    map and may cover it completely. If you want to see the background map under the
    WMS layer, don't forget to set the transparency for the WMS layers before publishing.
  prefs: []
  type: TYPE_NORMAL
- en: Our map contains only one raster layer—the digital elevation model—which has
    been loaded from a local file and, as a result, cannot be published. Let's add
    some other raster data that will be available from the published map.
  prefs: []
  type: TYPE_NORMAL
- en: 'As our map contains a DEM layer, it will be good to find a suitable replacement
    for it. Fortunately, USGS provides access to some maps, including shaded relief,
    via WMS. Of course, this layer is not as detailed as our DEM, but for online maps,
    it is more than enough. First, we need to create a new WMS connection by following
    these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on the **Add WMS/WMTS Layer** button in the **Layers** toolbar, or go
    to **Layer** | **Add Layer** | **Add WMS/WMTS Layer**. In the **Add Layer(s) from
    a WM(T)S Server** dialog, click on **New** to create a new connection. Enter `USGS
    Relief (base)` as **Name** and [http://basemap.nationalmap.gov/arcgis/services/USGSShadedReliefOnly/MapServer/WMSServer?request=GetCapabilities&service=WMS](http://basemap.nationalmap.gov/arcgis/services/USGSShadedReliefOnly/MapServer/WMSServer?request=GetCapabilities&service=WMS)
    as **URL**, and click on **OK**. Select the newly added connection from the combobox
    and click on the **Connect** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From the layers tree, select the first node, called **USGS Shaded Relief...**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Coordinate Reference Systems** group, click on **Change**, find and
    select **WGS 84 / Pseudo Mercator (EPSG:3857)**, and click on **OK**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Add** and close the WMS dialog.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finally, move the added layer below all the vector layers, so that it will be
    at the bottom of the QGIS layer tree.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Note that this shaded relief layer contains data for a scale of 1:18000 or
    smaller. If you want to display relief on more detailed scales, it will be necessary
    to add one more layer using another WMS URL: [http://services.nationalmap.gov/arcgis/services/USGSShadedReliefLarge/MapServer/WMSServer?request=GetCapabilities&service=WMS](http://services.nationalmap.gov/arcgis/services/USGSShadedReliefLarge/MapServer/WMSServer?request=GetCapabilities&service=WMS).'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: You may have noticed that we added the layer in **EPSG:3857** while all our
    vector layers are in EPSG:2263\. As a result, we now have "on-the-fly" reprojection
    enabled, and the project CRS is EPSG:3857\. This is because we will also add a
    background Bing map, which is available only in EPSG:3857\. If you don't need
    a background map, it is better to use a CRS that matches the CRS of your vector
    data or a well-known CRS, such as **WGS 84** and **WGS 84 / Pseudo Mercator**.
  prefs: []
  type: TYPE_NORMAL
- en: Now, we will add a background map with Bing aerial images.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Note that using some background maps may violate the terms of service of those
    maps. Before adding any background map, check whether you are allowed to use that
    service with your online map and redistribute maps that contain data from that
    service.
  prefs: []
  type: TYPE_NORMAL
- en: 'To do this, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Install and activate the **OpenLayers plugin** (see the *Extending functionality
    through plugins* section of [Chapter 1](part0014.xhtml#aid-DB7S2 "Chapter 1. Handling
    Your Data"), *Handling Your Data*, for more details).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to **Web** | **OpenLayers plugin** | **Bing Maps** | **Bing Aerial**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Move the newly added layer to the bottom of the QGIS layer tree, so that it
    will be below all other layers.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If necessary, you can add more WMS layers and/or background maps, but don't
    overload your map by additional layers without the need to do so. Also choose
    which raster will be visible by default and turn the other raster layers off in
    order to speed up map loading. Save the project when all the changes have been
    implemented.
  prefs: []
  type: TYPE_NORMAL
- en: Now that our data is ready for publishing, our next step is project preparation.
    Of course, you can publish a map as is, but it is better to spend some time and
    make your map more user friendly and professional looking, especially if you plan
    to share it with others.
  prefs: []
  type: TYPE_NORMAL
- en: General settings
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'First, we fill in some metadata that will help users find our map and provide
    some information about it. To do this, open the **Project Properties** dialog
    by pressing *Ctrl* + *Shift* + *P*, or go to **Project** | **Project Properties...**
    and switch to the **OWS Server** tab. This tab allows us to configure the way
    in which our project will be processed by QGIS Server. There are many different
    settings here; right now, we will look at the **Service capabilities** group:'
  prefs: []
  type: TYPE_NORMAL
- en: '![General settings](img/image00414.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Here, we need to fill in this metadata:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Title**: This is the title of the map. We select `Brooklyn (New York) demo
    map`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Organization**: Here, we specify the map author or owner. Enter your name
    here.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Online resource**: Here, we specify the URL that should be used to access
    our map. Right now, we can leave it empty because the map is not published, which
    is why we don''t know its URL. But if you are curious, here is the convention
    used for URL generation in QGIS Cloud: `http://qgiscloud.com/<user_name>/<map_name>/wms`.
    In this, `<user_name>` is your QGIS Cloud login and `<map_name>` is the filename
    of the published project without extension. So, suppose your login is alex and
    the project will be saved after uploading the data as `brooklyn_demo.qgs`. Then,
    the URL will be `http://qgiscloud.com/alex/brooklyn_demo/wms`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Person**: This is the name of the person who is responsible for the published
    map. It is mainly used as support contact. In our case, this is the same person
    as specified in **Organization** field.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**E-Mail** and **Phone**: These are the contact details of the responsible
    person. We can leave them empty or fill in only one field so that users will be
    able to contact the creator of the map if they have any questions or problems.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Abstract**: This is a brief description of our map and used data. It is important
    information, as it helps users understand the purpose and coverage of the map.
    Such information can also be used by metadata catalogs for the purpose of indexing
    and searching maps. Here is our description; you can use it as is or modify it
    according to your tastes:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A demo map of the Brooklyn district of the New York city based on the official
    open data from the New York open data portal [https://data.cityofnewyork.us/](https://data.cityofnewyork.us/).
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Map created for Packt Publishing *QGIS by Example* book.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Fees**: This shows information about the fees. It can be ignored if map does
    not use fees.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Access constraints**: This describes the restrictions on and legal requirements
    for using this map. For example, it can be "For internal use only" or some copyright
    notice. For public maps, this field usually is empty.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Keyword list**: This is a list of keywords or short phrases that describe
    the map. This information helps in searching and indexing. For our map, we use
    these keywords; feel free to adjust them to suit your tastes:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`New York, Brooklyn, QGIS by Example, demo.`'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: It is good practice to fill in metadata not only for the map but also for each
    layer in it, so that when the user looks for the available WMS or WFS layers,
    they will see the layers' descriptions and easily understand that a particular
    layer is suitable for them. Anyone will agree that working with a WMS server where
    layers have a title and an abstract is more comfortable than working with a server
    without such information.
  prefs: []
  type: TYPE_NORMAL
- en: To edit the layer's metadata, select it from the QGIS layer tree, right-click
    to open the context menu, and choose **Properties**. In the **layer properties**
    dialog, go to the **Metadata** tab. The most important pieces of metadata to fill
    in are **Title**, **Abstract**, and **Keyword list**. After editing the metadata,
    click on **OK** to close the dialog and save the project.
  prefs: []
  type: TYPE_NORMAL
- en: WMS settings
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Now look at the **WMS Capabilities** group, which allows you to tune the WMS
    service that will be created from our map, as shown in this screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![WMS settings](img/image00415.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: By default, the entire map will be published. If you want to make only a part
    of your map available via WMS, check the **Advertised extent** box and define
    the allowed extent by entering its minimum and maximum coordinates. Click on the
    **Use Current Canvas Extent** button to restrict the available extent to the current
    map extent.
  prefs: []
  type: TYPE_NORMAL
- en: 'QGIS Server, used by QGIS Cloud, implements a special extension to the WMS
    standard: the **GetPrint** request. This allows you to create printed maps using
    one of the composers available in the project. By default, all available composers
    will be published and advertised for printing. If you don''t need this functionality
    at all or want to hide some composers from users, activate the **Exclude composers**
    group and add the composers that need to be excluded to this list using the **+**
    button.'
  prefs: []
  type: TYPE_NORMAL
- en: Similarly, you can hide some layers if you don't want to publish all of them.
    To do this, activate the **Exclude layers** group and add layers to exclude using
    the **+** button.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Of course, we can just remove the layers, save the project with a different
    name, and then publish this new project. But in this case, we will lose one major
    advantage—the ability to use the same project for offline and online maps.
  prefs: []
  type: TYPE_NORMAL
- en: Imagine that after publishing a map, you need to change the symbology of a layer.
    In the case of two different projects, you will need to keep them in sync. It
    is much simpler to have a single project and hide the layers by changing the settings.
  prefs: []
  type: TYPE_NORMAL
- en: The next important setting is **CRS restrictions**. By default, every layer
    can be loaded in any QGIS-supported **coordinate reference systems** (**CRS**).
    As a result, the service capabilities document becomes very large, especially
    when the map contains many layers. This in turn causes slow map loading in web-based
    viewer and desktop clients, as they have to download and parse much more data.
  prefs: []
  type: TYPE_NORMAL
- en: In real-life applications, only a small subset of coordinate reference systems
    is required. So, we can safely restrict the list of available CRSes without any
    drawbacks, and moreover speed up the loading of our map. To do this, activate
    **CRS restrictions** and add all the necessary CRSes. The **Used** button allows
    us to add the current project's CRS to the list in just one click.
  prefs: []
  type: TYPE_NORMAL
- en: If you want to enable feature highlighting on identification, don't forget to
    select the **Add geometry to feature response** checkbox. It is also possible
    to limit coordinate precision by adjusting its value in the **GetFeatureInfo geometry
    precision (decimal places)** field.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, you can limit the size of the image returned by the GetMap request
    by defining the width and height in the **Maximums for GetMap** request and adjusting
    **Quality for JPEG images**.
  prefs: []
  type: TYPE_NORMAL
- en: WFS settings
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'If you want to make your data available not only as rasters but also as vectors,
    it is necessary to configure **WFS capabilities**, which are shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![WFS settings](img/image00416.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'All you need to do is select the layers that should be available via WFS by
    selecting the corresponding checkboxes in the **Published** column. If the layer
    needs to be editable, it is necessary to specify the supported operations by activating
    the checkboxes in the corresponding columns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Update**: The user can edit existing features (both geometry and attributes)
    in layers with this capability'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Insert**: The user can add new features to layers with this capability'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Delete**: This allows the user to delete existing features from a layer'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: Remember that with the QGIS Cloud free plan, your map will be publicly available,
    and anyone will be able to edit your layers. If you need to restrict access, either
    consider switching to other plans or don't enable editing via WFS.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Being the map owner, you can always edit published vector layers by connecting
    to the corresponding QGIS Cloud database via QGIS.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: When you are satisfied with all the settings, click on the **Apply** button
    to save your changes and then close the **Project Properties** dialog.
  prefs: []
  type: TYPE_NORMAL
- en: Now, we can publish our map. Activate the QGIS Cloud plugin, if it has not already
    been activated. Switch to the **Account** tab in the **QGIS Cloud** panel and
    log in using your username and password. First, we need to create the database
    where all our layers will be saved. Database creation is covered in detail in
    the *Creating a database* section of this chapter; return to it if necessary.
    We will assume that a new empty database already exists.
  prefs: []
  type: TYPE_NORMAL
- en: Switch to the **Upload data** tab. From the **Database** combobox, select the
    database created previously. In the table below this combobox, you will see all
    the layers supported by QGIS Cloud that can be uploaded. If there are no layers,
    click on **Refresh layers**. If necessary, you can adjust the name of the database
    table used to store layer data by editing the text in the **Table name** column.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Note that while all other columns are editable too, you should not edit them.
  prefs: []
  type: TYPE_NORMAL
- en: Also verify that all the layers listed in this table have the correct CRS assigned.
    QGIS Cloud supports the CRSes available in the EPSG database only, so if some
    layers have a user-defined CRS, it is necessary to reproject them before publishing.
  prefs: []
  type: TYPE_NORMAL
- en: If **Replace local layers in project** is checked, the plugin will update the
    project by replacing all local vector layers with uploaded layers. So, your project
    will contain layers from the QGIS Cloud database, and you can easily edit them
    from QGIS. All changes in these layers will be immediately visible in the published
    map.
  prefs: []
  type: TYPE_NORMAL
- en: To start the data upload, click on the **Upload data** button. The upload will
    take some time, depending on the data size and speed of your Internet connection.
    When it completes, you will be prompted to save the updated project. We recommend
    that you save the published project with a different name so that you will have
    the project with the local data unchanged.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: QGIS Cloud uses the name of the project file as the map name, so choose the
    filename of your project carefully; it's better to use something meaningful.
  prefs: []
  type: TYPE_NORMAL
- en: After successful data upload, a new **Publish Map** button will be shown. Click
    on it to publish your map. That's all! Now your map is available on the Internet.
    Switch to the **Services** tab to get the URLs of standard and mobile viewers,
    the WMS service (the same link can be used for WFS), and the web interface admin
    panel.
  prefs: []
  type: TYPE_NORMAL
- en: 'If necessary, we can easily update the published map; for example, we can change
    layer symbology, or hide or show some attributes or composers, and so on. To do
    this, just open your project containing the Cloud-based layers, make necessary
    changes, and then publish the map by following these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Activate the QGIS Cloud plugin, if it is not activated yet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Switch to the **Account** tab in the **QGIS Cloud** panel and log in using your
    username and password.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now switch to the **Services** tab and press the **Publish Map** button to publish
    the updated map.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There is no need to upload the data again, as all of the data was uploaded previously,
    and our project now contains layers from the QGIS Cloud database instead of local
    files.
  prefs: []
  type: TYPE_NORMAL
- en: Viewing your map in QGIS and a browser
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A published map can be viewed in QGIS and a browser. Depending on your needs,
    it is better to use one or the other. A web-based viewer is a good choice if all
    you need is viewing and some basic GIS functionality, such as map navigation,
    feature identification, and printing. Also, a web-based viewer is a great way
    to share your map with others.
  prefs: []
  type: TYPE_NORMAL
- en: Working with a map from a browser
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'QGIS Cloud provides two web viewers: one for mobile devices (smartphones or
    tablets), and another for desktop. Both viewers provide the same basic functionality
    such as map navigation and changing layer visibility. Let''s take a closer look
    at them.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The standard desktop viewer is based on QGIS Web Client and it looks like a
    simple GIS application that runs in the browser, as seen in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Working with a map from a browser](img/image00417.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: There is a layer tree on the left side, where you can change the layer's visibility
    and enable or disable background maps, if any. On the right-hand side, we can
    find the **Attribute Data** panel (hidden by default), which is used to display
    information about the identified feature. The rest of the space is occupied by
    the map view itself.
  prefs: []
  type: TYPE_NORMAL
- en: In the preceding screenshot, you can see a toolbar with navigation buttons,
    the identify tool, tools for measuring length and/or area, and the **Print Map**
    button. The navigation, identify, and measuring tools work similar to the corresponding
    tools from QGIS.
  prefs: []
  type: TYPE_NORMAL
- en: 'The most interesting feature of the standard viewer is map printing. If published
    project contains composers, they can be used for producing printed maps. They
    can be used to produce printed maps. To create such a map, zoom to the area of
    interest using the navigation tools, and then click on **Print Map** button. A
    **Print Settings** dialog will appear, and a selection rectangle will be shown
    on the map, like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Working with a map from a browser](img/image00418.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Define the boundaries of the region you want to print by moving and resizing
    the rectangle. Then use the floating **Print Settings** panel to select the desired
    map layout, scale, and resolution. Define the map rotation, if necessary. When
    all the settings are made, click on the **Print** button to generate a PDF file
    containing your map. The generated map will be opened in a new browser window,
    and can be saved on the disk for further usage.
  prefs: []
  type: TYPE_NORMAL
- en: The mobile viewer, as the name implies, is optimized for usage with mobile devices,
    such as tablets or smartphones.
  prefs: []
  type: TYPE_NORMAL
- en: '![Working with a map from a browser](img/image00419.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: All of the available screen area is used to display the map. The buttons on
    touchscreens are large and easy to use. To access the layer tree, press the button
    in the bottom-left corner. The buttons in the top-right corner allow you to enable
    location tracking and set up some other options such as map rotation, scalebar
    display and so on. With the mobile viewer, you have no access to the print map
    capability. Nonetheless, it is possible to use the map for navigation. The viewer
    will track your position and update the map when it changes. If necessary, it
    is also possible to activate map rotation so that the map can be rotated to match
    its north to the actual north.
  prefs: []
  type: TYPE_NORMAL
- en: Working with a map in QGIS
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Web-based viewers are good if all you need is read-only access to data. A published
    map, when used from QGIS, gives you more functionality and flexibility.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You can use published maps not only from QGIS but also from any WMS or WFS client.
  prefs: []
  type: TYPE_NORMAL
- en: By default, every published map is available via the **Web Map Service** (**WMS**)
    protocol. So, it is possible to use a layer from it as a background layer in another
    map or embed it in a web page with the help of libraries such as OpenLayers and
    Leaflet.
  prefs: []
  type: TYPE_NORMAL
- en: 'To add a layer from a published map as a WMS layer to QGIS, perform the following
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the **Add Layer(s) from a WM(T)S Server** dialog using the corresponding
    button on the **Manage Layers** toolbar, or from the **Layer** menu (**Layer**
    | **Add Layer** | **Add WMS/WMTS Layer...**). Add a **New** connection.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter a connection name (it's best to use something meaningful) and the URL
    of the map.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the created connection from the list and click on **Connect**. A list
    of available published layers will appear. If the map layers have metadata filled
    in, you will see their titles and descriptions.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the necessary layers and add them to your project.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note that you can add only layers created from your local data. Background maps,
    and WMS layers used in published map are not available. If you need a background
    map and/or WMS layers, add them by using the corresponding plugins or the QGIS
    core functionality.
  prefs: []
  type: TYPE_NORMAL
- en: 'Also, if enabled by the author, a map can be accessed via the **Web Feature
    Service** (**WFS**) and even modified with the **Web Feature Service Transactional**
    (**WFS-T**) protocols. To access a map via WFS**-**T with QGIS, perform the following
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the **Add WFS Layer from a Server** dialog using the corresponding button
    in the **Manage Layers** toolbar, or from the **Layer** menu (**Layer** | **Add
    Layer** | **Add WFS Layer...**).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add a **New** connection.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter a connection name (it's best to use something meaningful) and the URL
    of the map.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the created connection from the list and click on **Connect**. A list
    of available published layers will appear.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the necessary layers and add them to your project.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the selected layers have update, delete, and insert capabilities, you can
    edit them with QGIS just as would do with any other layer. All changes will be
    visible in the published map immediately.
  prefs: []
  type: TYPE_NORMAL
- en: Deleting unused maps
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With the passage of time, some maps become unnecessary for various reasons.
    If you don't need some maps and data, you will be pleased to know that it is possible
    to remove them and, as a result, free some disk space for new projects.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are several ways of removing unused data: with the QGIS Cloud plugin,
    from the QGIS Cloud web interface, and by using DB Manager or any other PostgreSQL/PostGIS
    client. They work differently and complement each other.'
  prefs: []
  type: TYPE_NORMAL
- en: Deleting layers with DB Manager
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As we mentioned previously, QGIS Cloud uses PostgreSQL/PostGIS to store spatial
    data. So, we can easily connect to the database with **DB Manager** or any other
    PostgreSQL client (for example, pgAdmin) and delete unused tables.
  prefs: []
  type: TYPE_NORMAL
- en: 'Assuming that a connection to the QGIS Cloud database is already created, here
    are the necessary steps that we need to perform in order to delete layers, using
    the **DB Manager** plugin:'
  prefs: []
  type: TYPE_NORMAL
- en: Start the **DB Manager** plugin. As this is a core plugin and is activated by
    default, you can find it by going to **Database** | **DB Manager**. If the **Database**
    menu does not exist, make sure that the **DB Manager** plugin is enabled. More
    information about using QGIS plugins can be found in the *Extending functionality
    through plugins* section of [Chapter 1](part0014.xhtml#aid-DB7S2 "Chapter 1. Handling
    Your Data"), *Handling Your Data*.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Expand the **PostGIS** item in the database tree and find your database.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Expand the **public** schema and find the table you want to delete.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the table and right-click to open the context menu. Select **Remove**
    to delete this table from database.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note that you also need to delete or update the corresponding maps after deleting
    tables. See the *Deleting maps from the web interface* section later in this chapter
    for more information on this.
  prefs: []
  type: TYPE_NORMAL
- en: Deleting databases from the QGIS Cloud plugin
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The QGIS Cloud plugin allows you to not only create a database and publish
    data and maps, but also remove unused databases. To remove an existing database,
    simply follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Start QGIS and activate the QGIS Cloud plugin, if it is not activated.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Switch to the **Account** tab in the **QGIS Cloud** panel, and log in using
    your username and password.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Databases** list, find the database you want to remove and select it.
    Click on the **Delete database** button and wait while the operation completes.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: Be careful! Currently, the QGIS Cloud plugin allows you to remove only an entire
    database, so you will lose all of the data from other maps that are stored in
    the deleted database. Make sure you have backups, or look at the previous section
    to learn how to delete separate layers.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Note that the plugin deletes the entire database, with all of the data in it.
    Maps created using data from this deleted database will still be listed in your
    account, but they will be empty. To delete these maps, we need to use the QGIS
    Cloud web interface, as described in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: Deleting maps from the web interface
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Using the web interface, we can remove only unused maps. All of the data associated
    with them will be kept. So, this is a supplementary method and it should be used
    with the methods already described.
  prefs: []
  type: TYPE_NORMAL
- en: 'To remove an unused map, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the browser and go to the QGIS Cloud site at [https://qgiscloud.com](https://qgiscloud.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Log in to your account using your username and password.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Maps** link in the menu at the top.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Locate the map that should be removed and click on **Destroy**. Confirm your
    action in the confirmation dialog.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Remember that you've deleted only the map. The data used in this map is still
    available in the database (provided that you haven't deleted the database first).
    So, if you don't need this data, it is necessary to delete the database too, unless
    it is being used by other maps. If you are using the same database to store data
    for different maps, you can delete separate layers with any PostgreSQL client,
    as described in the *Deleting layers with DB Manager* section.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we covered how to publish our maps online using QGIS Cloud
    hosting from QGIS. We saw how to prepare projects for publishing, including specifying
    project metadata, restricting access to some layers and composers, hiding layer
    attributes, and defining allowed actions. Also, you learned how to access a published
    map from different programs and how to manage your QGIS Cloud account.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, you will start getting familiarized with the analysis capabilities
    of QGIS. The first analysis type you will get to know is density analysis.
  prefs: []
  type: TYPE_NORMAL
