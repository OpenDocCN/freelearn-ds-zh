<html><head></head><body>
		<div><div></div>
		</div>
		<div><h1 id="_idParaDest-29">2. <a id="_idTextAnchor028"/>Data Preparation: Using Tableau Desktop</h1>
		</div>
		<div><p class="callout-heading">Overview</p>
			<p class="callout">In this chapter, you will learn to use various tools for data preparation in Tableau Desktop and join different data sources using various options. This will equip you with the knowledge required to perform data manipulation activities, data transformation, and data blending, and provide options to manage various data sources. By the end of this chapter, you will be able to extract and filter data and use aliases for the clean presentation of data.</p>
			<h1 id="_idParaDest-30"><a id="_idTextAnchor029"/>Introduction</h1>
			<p>Often, the data sources required for Tableau visualizations are stored in separate tables or files. A very common example is that of an online order on an e-commerce website. The order information and the customer information are stored separately within the website database. However, when suggestions are provided based on previous purchases, the website might combine the information to show a unified view. This is a very simple example of a data join, which is one of the most common scenarios that can be fulfilled using data preparation techniques. In addition to data joining, there is often a need to perform data manipulation activities such as grouping and adding calculations on the data being used. In this chapter, you will learn about using all such techniques to pull the data into Tableau for effective analysis and visualization.</p>
			<h1 id="_idParaDest-31"><a id="_idTextAnchor030"/>Connecting to a Data Source</h1>
			<p>For any visualization, you need to have an underlying data source that contains all the information you wish to show. This is the first step of any data visualization task.</p>
			<p>The very first thing that you will see when you open Tableau Desktop is the <code>Connect</code> pane. Here, you can connect to a variety of data sources and perform various tasks related to data handling, which you will study in this chapter. The following figure shows the screen that comes up when you start Tableau Desktop:</p>
			<div><div><img src="img/B16342_02_01.jpg" alt="Figure 2.1: Start screen on launching Tableau Desktop&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.1: Start screen on launching Tableau Desktop</p>
			<p>Depending on the version, this screen might look slightly different, but it should remain this way for the most part: you can observe that you can connect to multiple file options such as Excel, text, and JSON files. You can also connect to server-based data sources such as MySQL and Oracle. <code>Saved Data Sources</code> provides sample data sources that are available with Tableau Desktop.</p>
			<p>In the following exercise, you will connect to an Excel file named <code>Sample - Superstore</code>, which is available with Tableau Desktop. This file contains an <code>Orders</code> sheet, which consists of information for various orders, based on attributes such as order ID, order category, ship mode, and customer details. It also has a <code>Returns</code> sheet, which consists of orders that were returned. You will use all of this data to perform various operations throughout this chapter, and visualize the data in Tableau Desktop.</p>
			<h2 id="_idParaDest-32"><a id="_idTextAnchor031"/>Exercise 2.01: Connecting to an Excel File</h2>
			<p>In this exercise, you will connect to your very first data source in Tableau, the <code>Sample - Superstore</code> Excel file. This file is automatically accessible to you if you have installed Tableau as mentioned in <em class="italic">Chapter 1</em>, <em class="italic">Introduction to Tableau</em>. It contains three sheets, comprising order-level information stored in the <code>Orders</code> sheet, customer information stored in the <code>People</code> sheet, and order returns stored in the <code>Returns</code> sheet, and can be quickly downloaded from the GitHub repository for this chapter at <a href="https://packt.link/14u86">https://packt.link/14u86</a>. Make sure to download this file on your system before proceeding with the exercise.</p>
			<p>Perform the following steps to complete this exercise:</p>
			<ol>
				<li>Under the <code>Connect</code> pane, select the <code>Microsoft Excel</code> option.</li>
			</ol>
			<div><div><img src="img/B16342_02_02.jpg" alt="Figure 2.2: Connecting to Microsoft Excel&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.2: Connecting to Microsoft Excel</p>
			<ol>
				<li value="2">This will open up the file menu where you can select the Excel file from the file explorer. Navigate to the location where you have saved this file locally and then select to open the <code>Sample-Superstore.xls</code> file. You will see the following screen once the file is loaded: </li>
			</ol>
			<div><div><img src="img/B16342_02_03.jpg" alt=" Figure 2.3: File import screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption"> Figure 2.3: File import screen</p>
			<ol>
				<li value="3">Hover over the table to get the <code>View data</code> option (as highlighted in the following figure) and preview the data:</li>
			</ol>
			<div><div><img src="img/B16342_02_04.jpg" alt="Figure 2.4: View data for the underlying sheet&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.4: View data for the underlying sheet</p>
			<p>The following figure shows the data preview:</p>
			<p> </p>
			<div><div><img src="img/B16342_02_05.jpg" alt="Figure 2.5: View Data window showing the data preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.5: View Data window showing the data preview</p>
			<ol>
				<li value="4">Now, drag the <code>Orders</code> sheet onto the <code>Drag sheets here</code> area. This is also known as the canvas.</li>
				<li>The sheet should now have been imported into Tableau. Preview the data, as shown in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_06.jpg" alt="Figure 2.6: Data preview of the imported sheet&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.6: Data preview of the imported sheet</p>
			<p>You have thus connected and imported the data in Tableau.</p>
			<ol>
				<li value="6">Hovering over <code>Sheet 1</code>, you can see the active <code>Go to Worksheet</code> option, which means that you can navigate to <code>Sheet 1</code> and start creating visualizations.</li>
			</ol>
			<div><div><img src="img/B16342_02_07.jpg" alt="Figure 2.7: Go to Worksheet popup&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.7: Go to Worksheet popup</p>
			<p>Once the data is imported, you can start the visualization development by clicking on that option, as you will see later in the course. </p>
			<p>In this exercise, you saw how you can connect to an Excel file. Tableau also allows you to connect to data that is stored on servers. In the next section, you will learn how this can be done. </p>
			<h2 id="_idParaDest-33"><a id="_idTextAnchor032"/>Connecting to a Server Data Source</h2>
			<p>Here, you will be connecting with Microsoft SQL Server, available under the server-based data sources. Note that the concept of installing and maintaining server-based data sources is beyond the scope of this chapter. However, ideally, in a business project, data would mostly be stored on servers. For this reason, it is important to know how to connect to these data sources.</p>
			<p>The following steps will help you connect to a server-based data source:</p>
			<ol>
				<li value="1">Under the <code>Connect</code> pane, select the <code>Microsoft SQL Server</code> option, as can be seen in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_08.jpg" alt="Figure 2.8: Server connection input screen&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.8: Server connection input screen</p>
			<p>Here, you need to enter the information required, such as the server name and the authentication method. These details would be available from your database administrator.</p>
			<ol>
				<li value="2">Click <code>Sign In</code>. You will get a similar preview screen as you saw in <em class="italic">Figure 2.5</em>. All the steps afterward are the same as you do for an Excel-based connection. <p class="callout-heading">Note</p><p class="callout">One of the most commonly occurring issues here is that sometimes the drivers to connect to the data source are not installed. This can be easily resolved by downloading and installing the drivers from <a href="https://www.tableau.com/support/drivers">https://www.tableau.com/support/drivers</a>.</p></li>
			</ol>
			<p>In this section, you connected to a server-based data source. The next section covers the different kinds of joins in Tableau to combine the data from multiple data sources.</p>
			<h1 id="_idParaDest-34"><a id="_idTextAnchor033"/>Various Joins in Tableau</h1>
			<p>Quite often, the data that you're using will be stored as separate tables for efficiency purposes. There might be some fields that are common between tables and can be used to join the data sources together. </p>
			<p>For example, suppose you, as a bank loan manager, would like to evaluate the best-suited customer profiles for granting a loan. Here, based on the customer-provided information, such as salary details and work experience, you would also need to access their financial history information, such as previous loans, outstanding loans, or any defaults. This kind of information can be fetched from their Experian score using the customer PAN as common information between the various data sources. This is how joins are commonly used in a lot of daily scenarios. You will learn about these joins and the different types in Tableau.</p>
			<h2 id="_idParaDest-35"><a id="_idTextAnchor034"/>Different Types of Joins</h2>
			<p>Tableau offers four types of joins, which are listed as follows:</p>
			<ul>
				<li><strong class="bold">Inner</strong>: In an inner join between two tables, you can combine only the values that match among the two tables into the resulting table. For example, consider the following tables. When you join table A and table B using an inner join, only the common values will be a part of the resulting table:</li>
			</ul>
			<div><div><img src="img/B16342_02_09.jpg" alt="Figure 2.9: Inner Join Between Tables A and B&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.9: Inner Join Between Tables A and B</p>
			<ul>
				<li><strong class="bold">Left</strong>: A left join combines all the values from the left table along with only the matching values from the right table. If there are no matching values, those rows will contain null values in the resulting table. In the following example, when you join table A and table B using a left join, all the values from table A and only the common values of table B will be a part of the resulting table:</li>
			</ul>
			<div><div><img src="img/B16342_02_10.jpg" alt="Figure 2.10: Left Join Between Tables A and B&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.10: Left Join Between Tables A and B</p>
			<ul>
				<li><strong class="bold">Right</strong>: This is the opposite of the left join. A right join combines all the values from the right table along with only the matching values from the left table. If there are no matching values, those rows will contain null values in the resulting table. Consider the following tables. When you join table A and table B using a right join, all the values from table B and only the common value from table A will be part of the resulting table:</li>
			</ul>
			<div><div><img src="img/B16342_02_11.jpg" alt="Figure 2.11: Right Join Between Tables A and B&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.11: Right Join Between Tables A and B</p>
			<ul>
				<li><strong class="bold">Full outer</strong>: In a full outer join between two tables, you can combine all the values from the left and right tables into one resulting table. If values don't match in any of the tables, those rows will contain null values in the resulting table. </li>
			</ul>
			<p>Consider the following tables. Here, when you join table A and table B using an inner join, only the common values will be a part of the resulting table:</p>
			<div><div><img src="img/B16342_02_12.jpg" alt="Figure 2.12: Full Outer Join Between Tables A and B&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.12: Full Outer Join Between Tables A and B</p>
			<ul>
				<li><strong class="bold">Union</strong>: In a union, you combine two or more tables with similar column structures into a single resulting table. Union is performed when instead of joining you just want to append the data below other data with similar columns. A very common example of union is when you have two tables containing similar columns but maintained separately in different years, for example, combining order information for multiple years into a consolidated dataset.</li>
				<li>Consider the following tables, for example. Here, when you create a union of tables A and A1, you get a single table that will contain values for both A and A1:</li>
			</ul>
			<div><div><img src="img/B16342_02_13.jpg" alt="Figure 2.13: Union Between Tables A and B&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.13: Union Between Tables A and B</p>
			<p>You will learn more about these join types in detail in the following exercises.</p>
			<h2 id="_idParaDest-36"><a id="_idTextAnchor035"/>Exercise 2.02: Creating an Inner Join Dataset</h2>
			<p>As an analyst, you might come across scenarios in which you need to display the common records between two tables. This exercise aims to show how to join two different sheets into a single data source in Tableau. </p>
			<p>You will join the <code>Orders</code> table with the <code>People</code> table using an inner join. By doing so, you will be able to identify the customer records present in the <code>People</code> table along with the order information from the <code>Orders</code> table, which will help you to understand customers' buying preferences.</p>
			<p>Perform the following steps to complete this exercise:</p>
			<ol>
				<li value="1">Load the <code>Sample – Superstore</code> dataset into your Tableau instance as you did in <em class="italic">Exercise 2.01</em>.</li>
				<li>Drag the <code>Orders</code> table first, followed by the <code>People</code> table, from the <code>Sheets</code> area to the <code>Drag Sheets here</code> area. Alternatively, to add these sheets, you can double-click on them, and they will be added automatically to the canvas area. Tableau will auto-join the two tables using an inner join, as shown in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_14.jpg" alt="Figure 2.14: Data joining using an inner join&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.14: Data joining using an inner join</p>
			<ol>
				<li value="3">Click on the <code>Join</code> symbol to open the <code>Join</code> menu:</li>
			</ol>
			<div><div><img src="img/B16342_02_15.jpg" alt="Figure 2.15: Inner join properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.15: Inner join properties</p>
			<p>Note the various ways to join data. By default, Tableau performs an inner join on the common field names:</p>
			<div><div><img src="img/B16342_02_16.jpg" alt="Figure 2.16: Various join options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.16: Various join options</p>
			<p class="callout-heading">Note</p>
			<p class="callout">These instructions and images are based on Tableau version 2020.1. If you are using a later version of Tableau, such as 2021.4, this process may look quite different and even require an extra step. You can find additional guidance for this at the following URL: <a href="https://help.tableau.com/v2021.4/pro/desktop/en-gb/datasource_relationships_learnmorepage.htm">https://help.tableau.com/v2021.4/pro/desktop/en-gb/datasource_relationships_learnmorepage.htm</a></p>
			<ol>
				<li value="4">If there are no common names, select the columns manually to enable the join. Since you are joining the <code>Orders</code> and <code>People</code> tables, join on <code>Customer Name</code> from <code>Orders</code> and <code>Person</code> from <code>People</code>. First, de-select <code>Region</code>, which is auto-selected by Tableau. To do this, click on <code>Region</code> and select <code>Customer Name</code> from the dropdown, as you can see in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_17.jpg" alt="Figure 2.17: Changing the join column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.17: Changing the join column</p>
			<div><div><img src="img/B16342_02_18.jpg" alt="Figure 2.18: Final result of the inner join&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.18: Final result of the inner join</p>
			<ol>
				<li value="5">Repeat the same for the <code>People</code> table and select <code>Person</code> as the joining column. Your joined columns should be as follows:</li>
			</ol>
			<div><div><img src="img/B16342_02_19.jpg" alt="Figure 2.19: Data preview of the Order and People tables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.19: Data preview of the Order and People tables</p>
			<p>Now it's time to validate the results. This can be observed in the data grid screen in the bottom section.</p>
			<p>You can see that you get only <code>58</code> rows in the joined dataset. Here, only the values from the <code>Orders</code> table's <code>Customer Name</code> column that match with values from the <code>People</code> table's <code>Person</code> column will be returned in the final dataset. Since the <code>Person</code> table has only four values, only those values from the <code>Customer Name</code> column that match these four are returned from the <code>Orders</code> table.</p>
			<p>In this exercise, you used inner join and analyzed the results returned by using this join type. Next, you will learn about the left join type.</p>
			<h2 id="_idParaDest-37"><a id="_idTextAnchor036"/>Exercise 2.03: Creating a Left Join Dataset</h2>
			<p>In this exercise, you will join the <code>Orders</code> table with the <code>People</code> table in a left join. The objective of the left join is to verify how much customer information is present in the <code>People</code> table. This will help identify and update the <code>People</code> table so that you can expand the customer database, to drive better sales:</p>
			<div><div><img src="img/B16342_02_20.jpg" alt="Figure 2.20: Join screen for the Orders and People tables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.20: Join screen for the Orders and People tables</p>
			<ol>
				<li value="1">Repeat the same step from the previous exercise of dragging the <code>Orders</code> and <code>People</code> tables to the canvas. Once done, you should see the join options, as follows:</li>
				<li>Change the join type to <code>Left</code>: </li>
			</ol>
			<div><div><img src="img/B16342_02_21.jpg" alt="Figure 2.21: Selecting the Left join&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.21: Selecting the Left join</p>
			<ol>
				<li value="3">Now, in the data preview (as shown in the following figure), scroll toward the right side. You will see two columns from the <code>People</code> table, <code>Person</code> and <code>Region</code>. Use the <code>Sort</code> icon to sort the values, as highlighted in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_22.jpg" alt="Figure 2.22: Analyzing the left join results&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.22: Analyzing the left join results</p>
			<ol>
				<li value="4">Scroll down to see what happens if the <code>Customer</code> names do not match any values in the <code>Person</code> column.</li>
			</ol>
			<div><div><img src="img/B16342_02_23.jpg" alt="Figure 2.23: Nulls in the join result&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.23: Nulls in the join result</p>
			<p>You will observe that the rows where a match is not found are replaced by a <code>null</code> value, which means the <code>Person</code> table does not contain information for these customers. This means that you can add this customer information to the <code>People</code> table to improve the data quality.</p>
			<p>In this exercise, you learned how to perform a left join and how data is matched between the two tables. Next, you will learn about the right join type.</p>
			<h2 id="_idParaDest-38"><a id="_idTextAnchor037"/>Exercise 2.04: Creating a Right Join Dataset</h2>
			<p>In this exercise, you will join the <code>Orders</code> table with the <code>People</code> table in a right join. Consider a scenario wherein the <code>People</code> table consists of all the customers who have previously bought your company's products, and you want to fetch a complete list of the products a customer has bought, using information from the <code>Orders</code> table. This will help you understand the buying habits of customers based on their past purchases.</p>
			<p>The steps to complete this exercise are as follows:</p>
			<ol>
				<li value="1">Drag the <code>Orders</code> and <code>People</code> tables similar to how you did in the previous exercises so that you can see the following on your screen:</li>
			</ol>
			<p> </p>
			<div><div><img src="img/B16342_02_24.jpg" alt="Figure 2.24: Join screen for the Orders and People tables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.24: Join screen for the Orders and People tables</p>
			<ol>
				<li value="2">Select the <code>Right</code> join, as shown in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_25.jpg" alt="Figure 2.25: Selecting the Right join&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.25: Selecting the Right join</p>
			<ol>
				<li value="3">Now, in the data preview, scroll toward the right side. You will see the <code>Person</code> and <code>Region</code> columns from the <code>People</code> table. Use the <code>Sort</code> icon to sort the values, as highlighted in the following figure:</li>
				<li><div><img src="img/B16342_02_26.jpg" alt="Figure 2.26: Analyzing the right join results&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">Figure 2.26: Analyzing the right join results</p>
			<p>You will observe that the rows from the <code>People</code> table contain information about customers with past orders. This can now help you to analyze what products a person tends to buy often, and accordingly, you can suggest similar products to them, for a better-targeted sales strategy.</p>
			<p>In this exercise, you performed a right join on two tables and saw how to use the right join results to analyze data. Next, you will learn about a full outer join.</p>
			<p>A full outer join would combine the results of both the joining tables into a single dataset. To do that in Tableau, you can use the join properties and change the join type to <code>Full Outer</code>. </p>
			<div><div><img src="img/B16342_02_27.jpg" alt="Figure 2.27: Selecting the Full Outer join&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.27: Selecting the Full Outer join</p>
			<p>The next thing to cover is the union operation. In a union, the new table will be appended below the previous table in the final dataset. Usually, unions are used when you want to combine datasets with a common structure of columns. For example, order information for 2021 can be combined using a union with the order information for 2020 to get a unified dataset.</p>
			<p>In the next exercise, you will learn how to implement a union in Tableau.</p>
			<h2 id="_idParaDest-39"><a id="_idTextAnchor038"/>Exercise 2.05: Creating a Combined Dataset Using Union</h2>
			<p>Consider a scenario related to a large retailer such as Walmart or Amazon, operating in multiple regions. In such a case, it makes more sense to store the data at the regional level so that it can contain products customized to that specific region. If you were to compare how the different regions perform among each other, you would need to combine these different data sources into one. This is where the concept of a union comes into play. </p>
			<p>In this exercise, you will use the <code>Orders</code> table, which is split by region. The files for different regions follow a similar column structure as the <code>Orders</code> table but are segregated into different sheets based on their regions, as you can see from the following figure:</p>
			<div><div><img src="img/B16342_02_28.jpg" alt="Figure 2.28: Input data for the Orders table preview stored as different tabs&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.28: Input data for the Orders table preview stored as different tabs</p>
			<p>You have the data for two regions: <code>Central</code> and <code>West</code>. You can implement a union to combine these two regions into a single dataset, as outlined in the following steps:</p>
			<ol>
				<li value="1">Save the files on your local machine. Load the <code>Union</code> Excel file using the <code>Connect</code> option from the location where the files are saved, as done for the previous exercises. Once the file is imported, you should see the following screen:</li>
			</ol>
			<p> </p>
			<div><div><img src="img/B16342_02_29.jpg" alt="Figure 2.29: Orders table for the Central and West regions&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.29: Orders table for the Central and West regions</p>
			<ol>
				<li value="2">Double-click on the <code>New Union</code> option to open the <code>Union</code> popup, as shown in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_30.jpg" alt="Figure 2.30: New Union popup&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.30: New Union popup</p>
			<ol>
				<li value="3">Drag the two order tables onto the <code>Union</code> popup, as follows:</li>
			</ol>
			<div><div><img src="img/B16342_02_31.jpg" alt="Figure 2.31: Adding tables in a union&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.31: Adding tables in a union</p>
			<ol>
				<li value="4">Click on <code>OK</code> to add the union to the data grid. </li>
			</ol>
			<p>You can now preview the data in the bottom section. Tableau will combine the data from both tables into a single data source. </p>
			<div><div><img src="img/B16342_02_32.jpg" alt="Figure 2.32: Union data preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.32: Union data preview</p>
			<ol>
				<li value="5">Scroll to the right side of the data preview. You will see two additional columns—namely <code>Sheet</code> and <code>Table Name</code>. <code>Sheet</code> signifies which Excel file sheet this data belongs to and <code>Table Name</code> refers to the table names in Tableau. This can be used to quickly identify which columns come from which sheets and tables.</li>
			</ol>
			<div><div><img src="img/B16342_02_33.jpg" alt="Figure 2.33: Table identification columns in the union result&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.33: Table identification columns in the union result</p>
			<p>In this exercise, you learned how to perform a union of multiple data sources. </p>
			<p>In all the preceding exercises, you joined on only two data sources. It is possible to add more than two data sources. You will just need to specify in the join connection how the tables join to each other.</p>
			<div><div><img src="img/B16342_02_34.jpg" alt="Figure 2.34: Joining with more than two tables&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.34: Joining with more than two tables</p>
			<p>The preceding figure shows an example join on the <code>Orders</code> table with the <code>People</code> and <code>Returns</code> tables. If there were a common field between the <code>Returns</code> and <code>People</code> tables, you could also join these two tables as per your requirements.</p>
			<p>This completes the various ways you can join multiple tables in Tableau and concludes the discussion on the various ways to combine data from multiple sources together. The following sections will deal with preparing your data for your desired task. </p>
			<h1 id="_idParaDest-40"><a id="_idTextAnchor039"/>Data Transformation in the Data Pane</h1>
			<p>Once you finish combining the data, you may also need to make some data adjustments, such as renaming certain columns or limiting the data to use in your visualizations. These are some common examples of data transformation. </p>
			<p>Data transformations are a key step in preparing data for effective visualization. In this section, you will learn about some commonly used ways of transforming data. In particular, you will learn about the following:</p>
			<ul>
				<li>Data Interpreter</li>
				<li>Renaming data sources</li>
				<li>Live and extract connections </li>
				<li>Filters</li>
				<li>Data grid options</li>
				<li>Custom SQL</li>
			</ul>
			<p>The following sections will define these one by one. </p>
			<h2 id="_idParaDest-41"><a id="_idTextAnchor040"/>Data Interpreter</h2>
			<p>Data Interpreter is an option available within Tableau that extracts only the actual rows and columns by removing titles, headers, and extra empty rows from the Excel data source.</p>
			<p>You may sometimes add extra rows describing what kind of data the sheet contains, or some empty columns to improve the readability of the sheet. Consider the following example. Suppose you add certain comments to your <code>Sample - Superstore</code> file, as follows:</p>
			<div><div><img src="img/B16342_02_35.jpg" alt="Figure 2.35: Understanding Data Interpreter&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.35: Understanding Data Interpreter</p>
			<p>From a data visualization point of view, rows 1 to 3 are meaningless as they don't belong to the actual data and are simply headers. Tableau can automatically remove these rows by using Data Interpreter.</p>
			<p>Data Interpreter can be enabled by selecting the <code>Use Data Interpreter</code> option.:</p>
			<div><div><img src="img/B16342_02_36.jpg" alt="Figure 2.36: Enabling Data Interpreter&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.36: Enabling Data Interpreter</p>
			<p>Once enabled, Data Interpreter will give you an option, <code>Review the results</code>. Clicking on <code>Review the results</code> will open up an Excel sheet of all the changes made by Data Interpreter, as can be seen in the following figure:</p>
			<div><div><img src="img/B16342_02_37.jpg" alt="Figure 2.37: Reviewing the results of Data Interpreter&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.37: Reviewing the results of Data Interpreter</p>
			<h2 id="_idParaDest-42"><a id="_idTextAnchor041"/>Renaming the Data Source</h2>
			<p>The data source can be renamed on the <code>Connect</code> screen just by clicking on it and entering the name of your choice. </p>
			<p> </p>
			<div><div><img src="img/B16342_02_38.jpg" alt="Figure 2.38: Renaming a data source&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.38: Renaming a data source</p>
			<p>When working with data sources, you want to quickly identify the tables you are working with. Renaming tables allows you to give custom names so that it becomes easier to work with them.</p>
			<h2 id="_idParaDest-43"><a id="_idTextAnchor042"/>Live and Extract Connections</h2>
			<p>This is a very important concept for data visualization in Tableau. This option decides how the data is connected to the visualizations.</p>
			<p>Live connections allow Tableau worksheets to be updated in real time based on any changes made in the underlying data sources. This may be a good solution when the data must be updated on a real-time basis, such as stock market data.</p>
			<p>However, when developing the visualizations in a live connection, the database will be queried for any changes performed in the view related to the data. This may consume more time.</p>
			<p><strong class="bold">Tableau Data Extracts</strong> (<strong class="bold">TDEs</strong>), or <strong class="bold">extracts</strong>, are a compressed and optimized way to bring all the source data into Tableau's memory. TDEs improve the efficiency of the data query, which tends to increase the speed of executions while working with the data in the visualizations and performing user interactive activities such as filtering and sorting over the data.</p>
			<p>When developing the visualizations in an extract connection, the database is also extracted into Tableau's local memory. Thus, any visualization development will be much faster compared to a live connection.</p>
			<h2 id="_idParaDest-44"><a id="_idTextAnchor043"/>Exercise 2.06: Creating an Extract for Data</h2>
			<p>In the preceding exercises, you connected to the data using a live connection. Now, you will create an extract for it. The following steps should be performed to create a data extract for the <code>Orders</code> table:</p>
			<ol>
				<li value="1">Load the <code>Sample – Superstore</code> dataset in your Tableau instance as done in the previous exercises.</li>
				<li>Drag the <code>Orders</code> table to the canvas.</li>
				<li>Choose the <code>Extract</code> option, as shown in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_39.jpg" alt="Figure 2.39: Creating an extract&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.39: Creating an extract</p>
			<ol>
				<li value="4">Once done, click on <code>Sheet 1</code> at the bottom of the page to navigate to that sheet.<div><img src="img/B16342_02_40.jpg" alt="Figure 2.40: Navigating to a worksheet&#13;&#10;"/></div></li>
			</ol>
			<p class="figure-caption">Figure 2.40: Navigating to a worksheet</p>
			<ol>
				<li value="5">This will open a popup to save the extract locally. Select a destination of your choice to save the extract.</li>
			</ol>
			<div><div><img src="img/B16342_02_41.jpg" alt="Figure 2.41: Extract creation and save&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.41: Extract creation and save</p>
			<p>Clicking on <code>Save</code> will create the extract and save it at the specified location. There is also the <code>Edit</code> option, which can be used to edit the properties of the extract. You will study these in the next section.</p>
			<ol>
				<li value="6">Refresh your extracts using the <code>Edit</code> or <code>Refresh</code> option if your data changes, as shown in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_42.jpg" alt="Figure 2.42: Extract Edit and Refresh options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.42: Extract Edit and Refresh options</p>
			<p>In this exercise, you created an extract using Tableau Desktop.</p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor044"/>Extract Properties</h2>
			<p>To access the extract properties, you can click on the <code>Edit</code> option next to <code>Extract</code>, as shown in <em class="italic">Figure 2.42</em>, to open the following window:</p>
			<div><div><img src="img/B16342_02_43.jpg" alt="Figure 2.43: Extract edit properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.43: Extract edit properties</p>
			<p>The following sections will describe this window and its fields in detail.</p>
			<h3 id="_idParaDest-46"><a id="_idTextAnchor045"/>The Data Storage field</h3>
			<p>If you have multiple tables, the <code>Multiple tables</code> option will be enabled. For now, since you have a single table, the <code>Single table</code> option is enabled.</p>
			<h3 id="_idParaDest-47"><a id="_idTextAnchor046"/>The Filters field</h3>
			<p>You can restrict the data in the extract using filters. For example, suppose you want only the data for the <code>Central</code> and <code>East</code> regions; you can easily do that using the <code>Add…</code> option. Select <code>Region</code> as the column to filter and select the <code>Central</code> and <code>East</code> values to add them as the filter condition. </p>
			<div><div><img src="img/B16342_02_44.jpg" alt="Figure 2.44: Adding a filter condition&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.44: Adding a filter condition</p>
			<p>As shown in the following figure, <code>Central</code> and <code>East</code> regions should be selected:</p>
			<div><div><img src="img/B16342_02_45.jpg" alt="Figure 2.45: Selecting Central and East regions&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.45: Selecting Central and East regions</p>
			<div><div><img src="img/B16342_02_46.jpg" alt="Figure 2.46: Creating extract filters using the Region column&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.46: Creating extract filters using the Region column</p>
			<p>You will learn more about these filters as you progress through this chapter.</p>
			<h3 id="_idParaDest-48"><a id="_idTextAnchor047"/>The Aggregation Field</h3>
			<p>You can also change the granularity of the data using this option. If you have dates in the dataset on a <code>Day</code> level, you can roll them up or aggregate them to a higher level using a different option, such as <code>Month</code> or <code>Year</code>. You will learn more about aggregations later in the book.</p>
			<div><div><img src="img/B16342_02_47.jpg" alt="Figure 2.47: Transforming the data aggregation level&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.47: Transforming the data aggregation level</p>
			<h3 id="_idParaDest-49"><a id="_idTextAnchor048"/>The Number of Rows Field</h3>
			<p>Using this option, you can choose the number of rows the extract should contain. <code>All rows</code> will include all the rows, <code>Top</code> will include only the specified number of rows, and <code>Sample</code> will contain a sample of specified rows. This is useful when you are working on a very large dataset, but for development purposes, you just need a sample of the data.</p>
			<div><div><img src="img/B16342_02_48.jpg" alt="Figure 2.48: Sample selection using the number of rows&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.48: Sample selection using the number of rows</p>
			<p>On selecting <code>All rows</code>, you will also get an option called <code>Incremental refresh</code>. Instead of refreshing the data every day, you can use this option to specify which field can be used to identify new rows so that only the specified section of the data is refreshed. This option is helpful when you have a very large dataset that updates at regular intervals wherein the old data does not change.</p>
			<p>Consider the case of banking transactions. The bank will never modify the old data but would keep adding new data to maintain the historic data. In this case, an incremental refresh would be very helpful during extract refreshes.</p>
			<div><div><img src="img/B16342_02_49.jpg" alt="Figure 2.49: Identifying the column for performing refresh&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.49: Identifying the column for performing refresh</p>
			<p>Now that you understand what values to add in these fields, you'll review what factors to determine when choosing the type of connection.</p>
			<h3 id="_idParaDest-50"><a id="_idTextAnchor049"/>Which Connection Is Better – Live or Extract?</h3>
			<p>Ideally, in most projects, an extract is the ideal approach, but there may be a need to showcase live data as in the example you saw before. The following points should be considered before choosing an extract or a live connection:</p>
			<ul>
				<li><strong class="bold">Updated or delayed data</strong>: If you have a requirement for which you need the most up-to-date information whenever you view the dashboard, you would need a live connection. Otherwise, if you are comfortable with some delay in the latest data, an extract is a better choice.</li>
				<li><strong class="bold">Data volume</strong>: If your data volume is very large, it is ideal to use a data extract instead of a live connection as it might take a lot of time to develop dashboards on live connections.</li>
			</ul>
			<p>With these points in mind, you can choose the right type of connection for your project.</p>
			<h2 id="_idParaDest-51"><a id="_idTextAnchor050"/>Filters</h2>
			<p>This option is similar to the <code>Extract Filter</code> property you learned about before. These filters are also known as data source filters because they filter data at the source. You will further study various filters later in the book.</p>
			<p>Consider the example of a large retailer such as Amazon, where the data has a large volume. Suppose you want to analyze the data for a specific region. In this case, it is not prudent to pull the whole data in Tableau as it would make the dashboard slower, and also, you would not have any use for the data other than that for your target region. </p>
			<p>For such a case, you can use the <code>Data Source Filter</code> option. This would restrict the data at the source itself and only bring in the required data based on the filtering criterion specified.</p>
			<h2 id="_idParaDest-52"><a id="_idTextAnchor051"/>Exercise 2.07: Adding a Region Filter on the Orders Table</h2>
			<p>Consider that you want to add a <code>Region</code> filter on the <code>Orders</code> table, to bring the data for the <code>Central</code> and <code>East</code> regions only. You can do so by following these steps:</p>
			<ol>
				<li value="1">Load the <code>Sample - Superstore</code> dataset in your Tableau instance.</li>
				<li>Drag the <code>Orders</code> table onto the canvas.</li>
				<li>To add a filter, click on the <code>Filters</code> | <code>Add</code> option to open the popup:</li>
			</ol>
			<div><div><img src="img/B16342_02_50.jpg" alt="Figure 2.50: Data source filter properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.50: Data source filter properties</p>
			<ol>
				<li value="4">Click on <code>Add…</code> to open the columns list. Select <code>Region</code> as the column:</li>
			</ol>
			<div><div><img src="img/B16342_02_51.jpg" alt="Figure 2.51: Column filter selection&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.51: Column filter selection</p>
			<ol>
				<li value="5">Select <code>Central</code> and <code>East</code> as the regions that will be kept in the data. Click <code>OK</code> to add the filter, as follows:</li>
			</ol>
			<div><div><img src="img/B16342_02_52.jpg" alt="Figure 2.52: Selecting the filter values&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.52: Selecting the filter values</p>
			<p>You can similarly add more filters by clicking on the <code>Add…</code> option and repeating the previous steps.</p>
			<ol>
				<li value="6">You can also edit and remove the existing filters. To do that, select the filter you want to edit or remove and then select the required option, as shown in the following figure:</li>
			</ol>
			<div><div><img src="img/B16342_02_53.jpg" alt="Figure 2.53: Filter preview&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.53: Filter preview</p>
			<ol>
				<li value="7">Once you have added the filter, preview the data in the data grid. You will observe that you only have data for the <code>Central</code> and <code>East</code> regions, as expected.</li>
			</ol>
			<div><div><img src="img/B16342_02_54.jpg" alt="Figure 2.54: Data preview post filter application&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.54: Data preview post filter application</p>
			<p>In this exercise, you learned how to apply a filter and the various properties associated with a data source filter. In the next section, you will learn how to transform data using the data grid.</p>
			<h2 id="_idParaDest-53"><a id="_idTextAnchor052"/>Data Grid Options</h2>
			<p>The data grid allows you to preview data. You have been using it so far just to check the number of rows the data contains, but it also contains several other options to transform data before you start with the visualization development. In this section, you will learn about these options and how to use them to better understand the data transformations.</p>
			<p><strong class="bold">Data preview</strong>: You can use this to preview the data. You can also select the number of rows to be displayed, by specifying the number in the box on the right, as can be seen in the following figure:</p>
			<div><div><img src="img/B16342_02_55.jpg" alt="Figure 2.55: Data preview toggle&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.55: Data preview toggle</p>
			<p><strong class="bold">Metadata</strong>: Metadata provides information about the source, such as the table name. Toggling to the metadata view, you can see all the metadata about the data. You can view the various columns, the table they come from, and the remote field name. </p>
			<p>If you rename a field here, the remote field name will show the original field name pulled from the data.</p>
			<div><div><img src="img/B16342_02_56.jpg" alt="Figure 2.56: Changing to the list view representation to show &#13;&#10;input data source metadata properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.56: Changing to the list view representation to show input data source metadata properties</p>
			<p class="callout-heading">Note</p>
			<p class="callout">In Tableau version 2021.4, the metadata is automatically available beside the preview, and you will not have to choose between these options.</p>
			<p>The <code>Sort fields</code> option will sort the data as per the option you select. You can try changing these options and observe how the data preview changes.</p>
			<div><div><img src="img/B16342_02_57.jpg" alt="Figure 2.57: Sorting the data grid column values&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.57: Sorting the data grid column values</p>
			<p>Now, consider the following data transformation options.</p>
			<p><code>Abc</code> icon (see the following figure), you can select the required data type from the drop-down box for the column. A common example is the <code>Customer ID</code> field being stored as a number where you might want it to be a string:</p>
			<div><div><img src="img/B16342_02_58.jpg" alt="Figure 2.58: Data type change options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.58: Data type change options</p>
			<p><strong class="bold">Data transformation</strong>: When you click on the drop-down icon, as shown in the following figure, you can see the options to transform the data, such as creating calculated fields on existing columns and creating groups. All these options are also available after you load the data. These will be covered in detail later in the book:</p>
			<div><div><img src="img/B16342_02_59.jpg" alt="Figure 2.59: Data transformation menu options&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.59: Data transformation menu options</p>
			<p>The <code>Rename</code> option allows you to rename the column. You can also hide a column if it's not required in the data visualization. You can select the <code>Show hidden fields</code> checkbox to view any hidden columns. Hidden columns are grayed out in the view, as indicated in the following figure:</p>
			<div><div><img src="img/B16342_02_60.jpg" alt="Figure 2.60: Show hidden fields&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.60: Show hidden fields</p>
			<p>Hidden columns cannot be used in the visualization. If you want to use a column after hiding it, you need to first unhide the column to use it in the visualization. This can be done by clicking on the dropdown and selecting the <code>Unhide</code> option.</p>
			<div><div><img src="img/B16342_02_61.jpg" alt="Figure 2.61: Hiding/unhiding columns from the input data source&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.61: Hiding/unhiding columns from the input data source</p>
			<p><strong class="bold">Aliases</strong>: Aliases are a very effective way to present data in the visualization with a different name. </p>
			<p>Observe the <code>Ship Mode</code> column in the data preview. You can see that the word <code>Class</code> is repeated for the different <code>Ship Mode</code> values, and it does not add any value; so you can exclude this word from all the values. This can be done using the <code>Aliases</code> option, which will help you to display the values as a different name. To add aliases on the column, click on the dropdown and select <code>Aliases…</code>, as shown in the following figure:</p>
			<div><div><img src="img/B16342_02_62.jpg" alt="Figure 2.62: Setting a column value alias&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.62: Setting a column value alias</p>
			<p>This will open the popup to rename the values. Remove the word <code>Class</code>. Click on <code>OK</code> to add it to the data. You can also clear the aliases using the <code>Clear Aliases</code> option.</p>
			<div><div><img src="img/B16342_02_63.jpg" alt="Figure 2.63: Edit Aliases properties&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.63: Edit Aliases properties</p>
			<p>You can use the <code>Show aliases</code> toggle to switch between the original names and the aliases. Aliases are generally used to rename null records to blank or columns containing long value names.</p>
			<div><div><img src="img/B16342_02_64.jpg" alt="Figure 2.64: Enabling aliases in the data preview using the Show aliases option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.64: Enabling aliases in the data preview using the Show aliases option</p>
			<p>All these options are also accessible after you load the data in the worksheet. </p>
			<p>In this view, you learned how to perform data transformations before pulling the data in the worksheets.</p>
			<p>In all the exercises previously, you just joined on two data sources. But it is also possible to add more than two data sources. You will just need to specify in the join connection how the tables join to each other.</p>
			<p>This completes the various ways you can join multiple tables in Tableau. Next, you will learn about the custom SQL option. </p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor053"/>Custom SQL</h2>
			<p>Custom SQL, as the name suggests, is used for writing custom SQL queries to pull only the selected columns based on the conditions applied instead of pulling the entire database. This option is not available with Excel and text files, so you might not see this option. </p>
			<p>This option will appear in the <code>Connect</code> pane once the database is connected. When you connect a database, you will see the <code>New Custom SQL</code> option below all the tables listed.</p>
			<div><div><img src="img/B16342_02_65.jpg" alt="Figure 2.65: New Custom SQL option&#13;&#10;"/>
				</div>
			</div>
			<p> </p>
			<p class="figure-caption">Figure 2.65: New Custom SQL option</p>
			<p>You can drag this option onto the canvas, type in your query, and click <code>OK</code>. Once done, Tableau will pull the required data based on the query specified.</p>
			<p>Custom SQL can be used to reduce the size of data by adding only the required columns in the data source, adding a union across the tables, and recasting fields to join multiple data sources together.</p>
			<p>Until now, you have learned about the various data transformation steps that can be performed before pulling the data in the worksheet. In the next section, you will learn about data blending, which is another way of joining the data but with a difference.</p>
			<h1 id="_idParaDest-55"><a id="_idTextAnchor054"/>Data Blending</h1>
			<p>There might be times when the linking fields vary between the different worksheets. Also, if the data sources are too large, joining them with the conventional joins might be very time consuming. In that case, you can perform a data blend instead of joining the data. </p>
			<p>In data blending, you query the data between the two data sources and then combine the result at the aggregation level defined in the worksheet of the primary data source. The primary data source will be the one from which the first dimension or measure is added in the view. Also, the results would be similar to a left join since all the records from the primary data will appear in the worksheet.</p>
			<h2 id="_idParaDest-56"><a id="_idTextAnchor055"/>Exercise 2.08: Creating a Data Blend Using the Orders and People Tables</h2>
			<p>In this exercise, you will learn how to create a data blend for the <code>Orders</code> table with the <code>People</code> table. The following steps will help you complete this exercise:</p>
			<ol>
				<li value="1">Load the <code>Sample – Superstore</code> dataset in your Tableau instance.</li>
				<li>Connect to the <code>Orders</code> table and go to <code>Sheet 1</code>.</li>
			</ol>
			<div><div><img src="img/B16342_02_66.jpg" alt="Figure 2.66: Adding the Orders table in Tableau&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.66: Adding the Orders table in Tableau</p>
			<ol>
				<li value="3">In a data blend, create the linking at the worksheet level and not at the data source level. Inside the worksheet, you will be able to see the <code>Orders</code> table and its columns. Add a new data source, as follows (see the highlighted option):</li>
			</ol>
			<div><div><img src="img/B16342_02_67.jpg" alt="Figure 2.67: Adding data option inside a worksheet&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.67: Adding data option inside a worksheet</p>
			<ol>
				<li value="4">This should lead to the same menu that you get for connecting to a data source. Click on <code>Microsoft Excel</code>, navigate to the location of the <code>Sample – Superstore.xls</code> Excel file, and click on <code>Open</code> to open the <code>Connect</code> pane.</li>
			</ol>
			<div><div><img src="img/B16342_02_68.jpg" alt="Figure 2.68: Adding another data source in Tableau&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.68: Adding another data source in Tableau</p>
			<ol>
				<li value="5">Now, drag the <code>People</code> table to the canvas and go to <code>Sheet 1</code> like before:</li>
			</ol>
			<div><div><img src="img/B16342_02_69.jpg" alt="Figure 2.69: Adding the People data to Tableau&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.69: Adding the People data to Tableau</p>
			<p>Now, you will be able to see the two data sources, as follows:</p>
			<div><div><img src="img/B16342_02_70.jpg" alt="Figure 2.70: Data sources listed inside the worksheet&#13;&#10;"/>
				</div>
			</div>
			<p> </p>
			<p class="figure-caption">Figure 2.70: Data sources listed inside the worksheet</p>
			<ol>
				<li value="6">Add a relationship between these data sources to use them. To do that, click on <code>Data</code> | <code>Edit Relationships…</code> to open the popup.<p class="callout-heading">Note</p><p class="callout">If you are using a Tableau version later than 2020.1, this may be called <code>Edit Blend Relationships...</code> to differentiate between relationships made directly in the <code>Data Source</code> tab.</p></li>
			</ol>
			<div><div><img src="img/B16342_02_71.jpg" alt="Figure 2.71: Edit data properties window&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.71: Edit data properties window</p>
			<ol>
				<li value="7">Based on the field names, the relationship can be set to <code>Automatic</code> by default. To change it, click on <code>Custom</code> and add the relationship. Edit the relationship to <code>Customer Name</code> and <code>Person</code>, as highlighted in the following figure. Select <code>Region</code> and then <code>Edit…</code> before making the selections in the popup. Click <code>OK</code> to add the relationship:</li>
			</ol>
			<div><div><img src="img/B16342_02_72.jpg" alt="Figure 2.72: Selecting the matching columns between the two data sources&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.72: Selecting the matching columns between the two data sources</p>
			<p>Thus, you have successfully blended the two data sources and can visualize your data in the next exercise.</p>
			<h2 id="_idParaDest-57"><a id="_idTextAnchor056"/>Exercise 2.09: Visualizing Data Created from a Data Blend</h2>
			<p>In the previous exercise, you learned how to perform data blending between two data sources. In this exercise, you will create a visualization on the blended data to understand the application of a data blend – again, you will continue using the <code>Orders</code> table and the <code>People</code> table for this purpose. Note that a blend will only be active if you use the fields from these two data sources; otherwise, it will remain inactive.</p>
			<p>Perform the following steps to complete this exercise:</p>
			<ol>
				<li value="1">On the <code>Orders</code> data, click and drag <code>Customer Name</code> to <code>Rows</code>.<p class="callout-heading">Note</p><p class="callout">Tableau versions later than 2020.1 may give a warning at this step that the field may contain more than 1000 rows. If this is the case, select <code>Add all members</code> to proceed.</p></li>
			</ol>
			<div><div><img src="img/B16342_02_73.jpg" alt="Figure 2.73: Adding the primary data source&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.73: Adding the primary data source</p>
			<p>This will now become your primary data source, indicated by the blue tick on the data source.</p>
			<ol>
				<li value="2">Repeat the step for the <code>People</code> data source.</li>
			</ol>
			<div><div><img src="img/B16342_02_74.jpg" alt="Figure 2.74: Adding the secondary data source&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.74: Adding the secondary data source</p>
			<p>This will become your secondary data source, indicated by the orange tick on the data source. Also, notice the red linking icon that is used to link the two data sources.</p>
			<div><div><img src="img/B16342_02_75.jpg" alt="Figure 2.75: Primary and secondary data source icons&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.75: Primary and secondary data source icons</p>
			<ol>
				<li value="3">When you filter on <code>Person</code> for the four people that you have in the <code>People</code> data, you will see that you have linked these values between these data sources. Click on the <code>Person</code> column dropdown and then <code>Filter…</code>, uncheck the <code>Null</code> value, and click <code>OK</code> to add the filter.</li>
			</ol>
			<div><div><img src="img/B16342_02_76.jpg" alt="Figure 2.76: Filtering to remove unmatched values&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.76: Filtering to remove unmatched values</p>
			<p>You will get the following output, which shows the customer name matching <code>Person</code>:</p>
			<div><div><img src="img/B16342_02_77.jpg" alt="Figure 2.77: Data blend output&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.77: Data blend output</p>
			<p>Using data blending, you can display data from various sources at multiple aggregation levels in different sheets. For instance, in one sheet, you can blend the data at the <code>Year</code> aggregation level, while in the other you can blend at the <code>Month</code> level.</p>
			<p>This is possible because, in a data blend, the data sources are not joined at the input source. This provides the flexibility to have large data sources and blend only in certain sheets where required. This can help make the dashboard render faster.</p>
			<h2 id="_idParaDest-58"><a id="_idTextAnchor057"/>Limitations of Data Blending</h2>
			<p>Data blending does not work with certain aggregation levels, such as <code>MEDIAN</code> and <code>COUNTD</code> (count distinct).</p>
			<p>You cannot publish the blended data sources on Tableau Server directly. First, you need to publish the data sources individually on the server and then blend the published data sources in your Tableau Desktop instance. Publishing data sources means uploading your data and directly storing it on Tableau Server.</p>
			<p>Another limitation is that the data used from the secondary data source must be at a higher aggregation level compared to the primary data source. If the aggregation level is not correct, an asterisk (<code>*</code>) will appear in the visualizations, indicating a one-to-many join aggregation level. You can swap the data sources to resolve this error.</p>
			<p>This concludes the theory sections of this lesson. Next, you will put all you have learned into practice in the following activities. </p>
			<h2 id="_idParaDest-59"><a id="_idTextAnchor058"/>Activity 2.01: Identifying the Returned Orders</h2>
			<p>As an analyst, you may encounter a situation where you would like to assess business performance by sales. It is therefore important to understand how many orders are fulfilled and how many are returned. If certain products are being returned frequently, it is a point of investigation as it can have serious consequences on the business. </p>
			<p>Usually, order information is kept separate from returns information. Hence, to bring this information together, you need to join the two data sources. </p>
			<p>For this activity, you will use the <code>Orders</code> and <code>Returns</code> tables from the <code>Sample - Superstore</code> Excel file. You are already aware of the <code>Orders</code> table. </p>
			<p>The <code>Returns</code> table consists of the <code>Order ID</code> and <code>Returned</code> columns. <code>Order ID</code> is the ID that would match with the <code>Orders</code> table. The <code>Returned</code> column indicates <code>Yes</code> for the order ID.</p>
			<div><div><img src="img/B16342_02_78.jpg" alt="Figure 2.78: Returns sheet columns&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.78: Returns sheet columns</p>
			<p>The objective is to identify the returned orders after combining them with the main <code>Orders</code> table so that you may determine which orders were both fulfilled and returned.</p>
			<p>The steps are as follows:</p>
			<ol>
				<li value="1">Open the <code>Sample - Superstore</code> dataset in your Tableau instance.</li>
				<li>Rename the data source to <code>Activity 1</code>.</li>
				<li>Drag the <code>Orders</code> table onto the canvas.</li>
				<li>Repeat the same steps for the <code>Returns</code> table.</li>
				<li>You need to bring all the <code>Orders</code> and <code>Returns</code> table values into the combined dataset. Can you identify the correct join based on the requirement? Remember that for an order to be returned, it should always be completed first. What can be interpreted if you change the join types to left, right, or full outer in this case?</li>
				<li>Identify how many products were returned from the data grid. (An order can have multiple products clubbed in it.)</li>
			</ol>
			<p><strong class="bold">Final Output Expected:</strong></p>
			<div><div><img src="img/B16342_02_79.jpg" alt="Figure 2.79: Choose the correct join&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.79: Choose the correct join</p>
			<p>In this activity, you strengthened your knowledge of various joins and their outputs. You also learned how to interpret the results by changing the join types.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The solution to this activity can be found here: <a href="https://packt.link/CTCxk">https://packt.link/CTCxk</a>.</p>
			<h2 id="_idParaDest-60"><a id="_idTextAnchor059"/>Activity 2.02: Preparing Data for Visualization</h2>
			<p>Now that you have joined the data, the next step is to make sure that the data is ready for visualization. This involves performing data transformation activities such as cleaning the data by removing the null values. You may also be required to rename certain columns or add aliases, split the columns, and so on.</p>
			<p>In this activity, you will perform some data transformation steps based on the left join output of the previous activity.</p>
			<p>This activity will help you to strengthen the concepts of data transformation in Tableau. This is a very important process in any Tableau project. Hence, it becomes crucial that you are well experienced in doing these in Tableau.</p>
			<p>The objective of this activity is to transform the data into a cleaned form for visualization. You need to first create an extract for this data source. Then you need to display the data only for the <code>Furniture</code> and <code>Office Supplies</code> categories. Is there a way to do this using the extract properties? You will also clean up the final data by changing any nulls to blanks. Let's also remove repeated terms such as <code>Class</code> from the <code>Ship Mode</code> column. </p>
			<p>Once done, your data should be ready for visualization.</p>
			<p>Continuing from Activity 2.01, the following steps will help you complete this activity:</p>
			<ol>
				<li value="1">Open the <code>Sample - Superstore</code> dataset in your Tableau instance.</li>
				<li>Create a data extract for this data.</li>
				<li>Add a filter on the data to pull the <code>Furniture</code> and <code>Office Supplies</code> categories. Check the row count.</li>
				<li>Transform the data by aliasing a few columns.</li>
				<li>Alias the null values from the columns of the <code>Returns</code> table to blanks.</li>
				<li>Remove the word <code>Class</code> from the <code>Ship Mode</code> column.</li>
			</ol>
			<p>Once completed, you should get the following output:</p>
			<p><strong class="bold">Final Output Expected</strong>:</p>
			<div><div><img src="img/B16342_02_80.jpg" alt="Figure 2.80: Final output for the activity&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 2.80: Final output for the activity</p>
			<p>In this activity, you learned how to extract the data. You also added filters for the <code>Category</code> column to just pull the selected categories. Many times, you will work on projects that require the data to be segregated at the beginning, such as regional data. These filters help you to achieve exactly this. You also transformed the data using aliases, making it much cleaner by removing repeated words and nulls.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The solution to this activity can be found here: <a href="https://packt.link/CTCxk">https://packt.link/CTCxk</a>.</p>
			<h1 id="_idParaDest-61"><a id="_idTextAnchor060"/>Summary</h1>
			<p>In this chapter, you learned how to connect to various data sources, which is the foremost step in data analysis in Tableau. Next, you learned about the various join options that Tableau provides and data transformation options to optimize the data for the final visualization. Joining tables is one of the most common requirements in practical data analysis. For instance, if you have two tables for employee details and department details, to find the number of employees per department, you would use a join key to get the required information.</p>
			<p>You also learned about some advanced data joining options of blending and custom SQL. The key takeaway from this chapter is how to connect data most efficiently based on the requirements and also how to transform the data so that it becomes more suitable for the visualization activity. The next chapter continues with the topic of data preparation in Tableau Prep.</p>
		</div>
		<div><div></div>
		</div>
	</body></html>