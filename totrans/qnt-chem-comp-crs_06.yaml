- en: 'Chapter 6: Beyond Born-Oppenheimer'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: “The first principle is that you must not fool yourself – and you are the easiest
    person to fool.”
  prefs: []
  type: TYPE_NORMAL
- en: – Richard Feynman
  prefs: []
  type: TYPE_NORMAL
- en: “Scientific progress is measured in units of courage, not intelligence.”
  prefs: []
  type: TYPE_NORMAL
- en: – Paul Dirac
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.1 – Dr. Keeper Sharkey imagining molecular vibrations of a diatomic
    molecule [authors]
  prefs: []
  type: TYPE_NORMAL
- en: Determining molecular structure and vibrational spectra computationally are
    two essential goals of modern computational chemistry that have applications in
    many areas, from astrochemistry to biochemistry and climate change mitigation.
    The computational complexity grows exponentially when the number of atoms and/or
    identical particles increases linearly. There is additional complexity associated
    when there are significant couplings between rotational and vibrational degrees
    of freedom, and at high energy states, including near the dissociation and ionization
    limit. Innovative computational methods and new quantum computing technology are
    actively being developed to address these hurdles [Sawaya].
  prefs: []
  type: TYPE_NORMAL
- en: Computational methods that can achieve next-generation accuracy will go beyond
    the standard approximations present in this book. This chapter focuses on introducing
    how non-Born-Oppenheimer (non-BO) calculations include the effects that are needed
    to make better predictions of chemical states at above ground state vibrations
    [Adamowicz_1][Adamowicz_2]. Other beyond BO-type approaches are being pursued
    to overcome the limitations of the BO approximation, however are not fully non-BO,
    such as pre-BO [Schiffer_1] [Schiffer_2][Mátyus][D4.1 VA Beta].
  prefs: []
  type: TYPE_NORMAL
- en: As an example of the benefits of utilizing vibrational states, we point to a
    team of physicists at the Massachussets Institute of Technology's Research Laboratory
    of Electronics that has demonstrated a new quantum register of fermion pairs where
    information is stored in the vibrational motion of atom pairs held in a superposition
    of two vibrational states [Hartke]. The common and relative motion of each atom
    pair is protected by exchange symmetry, enabling long-lived and robust motional
    coherence. They say *“Thus fermion anti-symmetry and strong interactions, the
    core challenges for classical computations of many-fermion behavior, may offer
    decisive solutions for protecting and processing quantum information.”* Their
    achievement paves the way to building programmable quantum simulators of many-fermion
    behavior and digital computing using fermion pairs.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Section 6.1, Non-Born-Oppenheimer molecular Hamiltonian*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Section 6.2, Vibrational frequency analysis calculations*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Section 6.3, Vibrational spectra for ortho-para isomerization of hydrogen
    molecule*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'A companion Jupyter notebook for this chapter can be downloaded from GitHub
    at [https://github.com/PacktPublishing/Quantum-Chemistry-and-Computing-for-the-Curious](https://github.com/PacktPublishing/Quantum-Chemistry-and-Computing-for-the-Curious),
    which has been tested in the Google Colab environment, which is free and runs
    entirely in the cloud, and in the IBM Quantum Lab environment. Please refer to
    [*Appendix B*](B18268_Appendix_B_ePub.xhtml#_idTextAnchor313) *– Leveraging Jupyter
    Notebooks in the Cloud*, for more information. The companion Jupyter notebook
    automatically installs the following list of libraries:'
  prefs: []
  type: TYPE_NORMAL
- en: NumPy [NumPy], an open-source Python library that is used in almost every field
    of science and engineering
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SciPy [SciPy], a free and open-source Python library used for scientific computing
    and technical computing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The companion Jupyter notebook does not include the installation of the Psi4
    free and open source software for high-throughput quantum chemistry [Psi4_0],
    which we used to perform a simple calculation of the vibrational frequency analysis
    of the carbon dioxide (CO2) molecule. We refer the reader interested in installing
    this package to the “Get Started with Psi4” [Psi4_1] documentation and to the
    article Ref. [Psi4_3].
  prefs: []
  type: TYPE_NORMAL
- en: Installing NumPy, SimPy, and math modules
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Install NumPy with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Install SciPy with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Import NumPy with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Import Matplotlib, a comprehensive library for creating static, animated, and
    interactive visualizations in Python with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Import the SciPy special Hermite polynomials with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Import the math `factorial` function with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 6.1\. Non-Born-Oppenheimer molecular Hamiltonian
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Recall from *Section 4.1, Born-Oppenheimer approximation,* the expression of
    the Hamiltonian in the laboratory frame coordinates ![](img/Formula_06_001.png):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_002.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'where in atomic units, the mass of the electron and the reduced Planck constant
    (![](img/Formula_06_003.png)) are set to the value 1\. The LAB Hamiltonian comprises
    the sum of the kinetic energy of all particles and the potential energy between
    all particles with the following definitions:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_004.png)and ![](img/Formula_06_005.png) are the second derivative
    operator with respect to the position coordinates for electrons and nuclei, that
    is, ![](img/Formula_06_006.png) and likewise for the ![](img/Formula_06_007.png)electron.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/Formula_06_008.png), ![](img/Formula_06_009.png), and ![](img/Formula_06_010.png)
    are the distances between electrons ![](img/Formula_06_011.png) and ![](img/Formula_06_012.png),
    electron ![](img/Formula_06_013.png) and nucleus ![](img/Formula_06_014.png),
    and nuclei ![](img/Formula_06_015.png) and ![](img/Formula_06_016.png) determined
    by the Euclidean norm.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The list of the operators of the LAB Hamiltonian has been presented in *Figure
    4.3*.
  prefs: []
  type: TYPE_NORMAL
- en: In the LAB Hamiltonian, the energy of the molecular system is continuous, not
    discrete. The **center-of-mass** (**COM**) motion does not yield any change to
    the energy of the internal states of the system and can be factored out. The internal
    states are quantized and invariant to translations. These states are not affected
    by translational and rotational motions in free space. The nuclei can still move
    around the COM through vibrations and internal rotations.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the BO approximation, we assume that the motions of the nuclei are uncoupled
    from the motions of the electrons, that is, a product of nuclear equations (rotational
    and vibrational) and electronic equations:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_017.png)'
  prefs: []
  type: TYPE_IMG
- en: where ![](img/Formula_06_018.png) are the nuclear coordinates, ![](img/Formula_06_019.png)
    are the electron coordinates, ![](img/Formula_06_020.png) are the spin coordinates,
    and the electronic wave function (![](img/Formula_06_021.png)) is conditioned
    on the nuclear coordinates (![](img/Formula_06_022.png)).
  prefs: []
  type: TYPE_NORMAL
- en: In the non-BO method, the total wave function is still separable in terms of
    rotations and vibrations and electronic energy levels; however, all energy levels
    are dependent on the variables for electrons and nuclei, spatial and spin.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_023.png)'
  prefs: []
  type: TYPE_IMG
- en: In the BO approximation, solving for only the electronic equation with fixed
    position of the nuclei can be iterated to account for the vibrations and internal
    rotations of the nuclei. For each iteration, the nuclei of the atoms are fixed
    in space and not moving and can be thought of as a violation of the Heisenberg
    uncertainty principle, introduced in *Section 1.4, Light and energy*. The more
    you know exactly where a particle is, the less you know about its momentum. In
    general, the internal coordinate system can be placed at the heaviest atom in
    the molecule or at the COM. This approximation has limitations that we will cover,
    specifically through vibrational spectra energy.
  prefs: []
  type: TYPE_NORMAL
- en: The non-BO method presented in this chapter exploits the effectiveness and predictive
    power of all-particle explicit correlation utilizing **explicitly correlated Gaussian
    basis functions** (**ECGs**) [Adamowicz_4] to describe atomic and molecular phenomena
    [Sharkey]. This method can be used to model a small number of particles, that
    is, three nuclei or no more than seven electrons, as well as determining highly
    accurate ionization energies of atoms, Rydberg states, and rotational and vibrationally
    excited states to an arbitrary level [Sharkey]. Furthermore, this method is very
    amenable to an effective parallelization.
  prefs: []
  type: TYPE_NORMAL
- en: Internal Hamiltonian operator
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We consider a general non-relativistic atomic system consisting of ![](img/Formula_06_024.png)
    particles, that is, ![](img/Formula_06_025.png) electrons and a nucleus. Converting
    from the laboratory frame Hamiltonian to the internal Hamiltonian involves rigorously
    separating the COM motion from the laboratory frame. We define an internal Cartesian
    coordinate frame (CCF) where all particles are treated on equal footing and all
    particles are allowed to roam space freely without any constraints. The change
    of coordinates from laboratory CCF to internal CCF is illustrated in *Figure 6.2*.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.2.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.2 – Internal CCF and laboratory CCF
  prefs: []
  type: TYPE_NORMAL
- en: 'The resulting internal Hamiltonian is used to calculate bound states of the
    system:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_026.jpg)'
  prefs: []
  type: TYPE_IMG
- en: For clarity, we list the terms of the internal Hamiltonian in *Figure 6.3*.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.3.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.3 – Terms of the internal Hamiltonian operator for a molecule
  prefs: []
  type: TYPE_NORMAL
- en: We now present the all-particle explicit correlation approach.
  prefs: []
  type: TYPE_NORMAL
- en: Explicitly correlated all-particle Gaussian functions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The ECGs that are used in the non-BO method are shown in *Figure 6.4*.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.4.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.4 – ECGs
  prefs: []
  type: TYPE_NORMAL
- en: The non-BO method uses the variational principle that was introduced in [*Chapter
    5*](B18268_05_ePub.xhtml#_idTextAnchor208)*, Variational Quantum Eigensolver (VQE)
    Algorithm,* and specifically includes an energy minimization procedure.
  prefs: []
  type: TYPE_NORMAL
- en: Energy minimization
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To obtain the eigenvalues of the LAB Hamiltonian ![](img/Formula_06_048.png)
    , we use the Rayleigh-Ritz variational scheme based on the minimization of the
    Rayleigh quotient:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_049.png)'
  prefs: []
  type: TYPE_IMG
- en: where ![](img/Formula_06_050.png) and ![](img/Formula_06_051.png) are the Hamiltonian
    and overlap ![](img/Formula_06_052.png) matrices, respectively. ![](img/Formula_06_053.png)
    and ![](img/Formula_06_054.png) are functions of the nonlinear parameters contained
    in the basis-set of ECGs. We write ![](img/Formula_06_055.png) for the set of
    these parameters and ![](img/Formula_06_056.png) for the vector of the linear
    expansion coefficients of the wave function in terms of basis functions.
  prefs: []
  type: TYPE_NORMAL
- en: 'We derive and implement the analytic gradient of the energy with respect to
    the nonlinear parameters of the Gaussians, starting with the secular equation
    ![](img/Formula_06_057.png):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_058.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Multiplying this equation by ![](img/Formula_06_059.png) from the left, we
    obtain the well-known Hellmann-Feynman theorem:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_060.jpg)'
  prefs: []
  type: TYPE_IMG
- en: To obtain this expression, we utilize the secular equation, and we assume that
    the wave function is normalized, that is, ![](img/Formula_06_061.png). The expression
    for ![](img/Formula_06_062.png) involves ![](img/Formula_06_063.png) and ![](img/Formula_06_064.png),
    which depend on the first derivatives of the Hamiltonian and overlap integrals
    with respect to the Gaussian nonlinear parameters.
  prefs: []
  type: TYPE_NORMAL
- en: The method employs explicitly correlated all-particle Gaussian functions for
    expanding the wave function of the system. The nonlinear parameters of the Gaussians
    are variationally optimized with an approach employing an analytical energy gradient
    determined with respect to these parameters.
  prefs: []
  type: TYPE_NORMAL
- en: 6.2\. Vibrational frequency analysis calculations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Within the BO approximation, the total energy of a molecule is the sum of the
    electronic, vibrational, and rotational energy:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_065.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Molecular vibrations can be modeled like the motion of particles connected by
    springs, representing atoms connected by chemical bonds of variable lengths. In
    the harmonic oscillator approximation, the force required to extend the spring
    is proportional to the extension (Hooke's law). When the vibrational energy is
    high, the harmonic oscillator approximation is no longer valid, and neither is
    the concept of normal mode. We now consider the simple case of a diatomic molecule.
  prefs: []
  type: TYPE_NORMAL
- en: Modeling the vibrational-rotational levels of a diatomic molecule
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The rotational energies of a diatomic molecule are represented by a series
    of discrete values:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_066.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'where:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_067.png) is the angular momentum quantum number.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/Formula_06_068.png) is the equilibrium distance.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/Formula_06_069.png) is the reduced Planck constant.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/Formula_06_070.png) is the reduced mass of the two atoms, ![](img/Formula_06_071.png).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'For a non-rotating diatomic molecule, the rotational quantum number ![](img/Formula_06_072.png)is
    zero. The potential energy ![](img/Formula_06_073.png) can be approximated by
    a quadratic function of the displacement ![](img/Formula_06_074.png) around the
    equilibrium position ![](img/Formula_06_075.png), which corresponds to the equilibrium
    distance ![](img/Formula_06_076.png) between the two nuclei:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_077.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'where ![](img/Formula_06_078.png) is the restoring force constant (Hooke''s
    law). For such a parabolic potential, the vibrating molecule is a quantum harmonic
    oscillator. The energy levels are a simple function of the integer vibrational
    quantum number ![](img/Formula_06_079.png):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_080.png)'
  prefs: []
  type: TYPE_IMG
- en: where ![](img/Formula_06_081.png) depends on the constant ![](img/Formula_06_082.png)
    and the reduced mass ![](img/Formula_05_077.png) of the two atoms.
  prefs: []
  type: TYPE_NORMAL
- en: 'The normalized wave functions of the quantum harmonic oscillator are:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_084.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The Hermite polynomial of order ![](img/Formula_06_085.png) is defined by the
    generation equation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_086.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Hermite polynomials are computed using the following recursion relation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_087.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The first three Hermite polynomials are:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_088.jpg)![](img/Formula_06_089.jpg)![](img/Formula_06_090.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'We define the `N(v)` function, which computes the normalization factor:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_091.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'We define the `Psi(v, x)` function, which uses the special `hermite()` SciPy
    function and computes a function with the same form as the normalized wave functions
    of the quantum harmonic oscillator defined previously:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'We now define a function called `plot(n)` that plots the potential energy as
    a parabola (black) and spatial probabilities ![](img/Formula_06_092.png) (color)
    of the normalized quantum Harmonic oscillator wave functions for the integer vibrational
    quantum number ![](img/Formula_06_093.png) to ![](img/Formula_06_094.png). Here
    is the code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'We now call the `plot(5)` function. *Figure 6.5* shows the result:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.5.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.5 – Potential energy (black parabola) and spatial probabilities (color)
    of the normalized quantum harmonic oscillator wavefunctions for ![](img/Formula_06_095.png)
    to ![](img/Formula_06_096.png)
  prefs: []
  type: TYPE_NORMAL
- en: 'For larger values of the displacement around the equilibrium position, the
    real potential energy is better approximated by an anharmonic oscillator, and
    it has the following form:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_097.jpg)'
  prefs: []
  type: TYPE_IMG
- en: where ![](img/Formula_06_098.png) is the anharmonicity constant. The separations
    between energy levels decrease with increasing vibrational quantum number ![](img/Formula_06_099.png).
  prefs: []
  type: TYPE_NORMAL
- en: 'The rotational energy at an internuclear distance ![](img/Formula_06_100.png)
    can be approximated by the following power series expansion [Demtröder]:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_101.png)'
  prefs: []
  type: TYPE_IMG
- en: where ![](img/Formula_06_102.png) is a constant pertaining to the restoring
    force that binds the two atoms together.
  prefs: []
  type: TYPE_NORMAL
- en: 'This expression can be written in terms of rotational frequencies [Demtröder]:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_103.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'where ![](img/Formula_06_104.png) is the rotational constant, and ![](img/Formula_06_105.png)
    and ![](img/Formula_06_106.png) are centrifugal constants:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_107.jpg)![](img/Formula_06_108.jpg)![](img/Formula_06_109.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'We define the Python `Frot()` function, which computes the rotational energy
    levels of the hydrogen molecule using an expression obtained in Ref. [Campargue]:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'We set up a dictionary, `rov`, with the vibrational quantum number ![](img/Formula_06_110.png)
    as key and the following values:'
  prefs: []
  type: TYPE_NORMAL
- en: Ground state ![](img/Formula_06_111.png) energy computed by Komasa et al. in
    2011 [Komasa]
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Rovibrational parameters of the vibrational levels ![](img/Formula_06_112.png)
    to ![](img/Formula_06_113.png) computed by Campargue in 2011 [Campargue]
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Here is the code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'We compute the vibrational energy levels of the hydrogen molecule for the ground
    rotational state ![](img/Formula_06_114.png) and for the first excited rotational
    state ![](img/Formula_06_115.png) and the difference between the two levels for
    each vibrational quantum number ![](img/Formula_06_116.png). Here is the code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'The result in *Figure 6.6* is in good agreement with the result by Komasa et
    al. [Komasa]:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.6.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.6 – Vibrational energy levels of the hydrogen molecule for ![](img/Formula_06_117.png)
    , ![](img/Formula_06_118.png) and ![](img/Formula_06_119.png)
  prefs: []
  type: TYPE_NORMAL
- en: Computing all vibrational-rotational levels of a molecule
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We present an outline of the method generally used for computing all vibrational-rotational
    levels of a molecule [Gaussian_1] [Neese] on a classical computer.
  prefs: []
  type: TYPE_NORMAL
- en: Optimizing the geometry of the molecule
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The geometry of the molecule used for vibrational analysis must first be optimized
    so that the atoms are in equilibrium and have no momentum, that is, all first
    derivatives of the energy with respect to nuclear Cartesian coordinates ![](img/Formula_06_120.png)
    of the atoms are zero:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_121.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Calculating a force constant Hessian matrix
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'A force constant Hessian matrix is calculated, which holds the second partial
    derivatives of the energy ![](img/Formula_06_122.png) with respect to displacement
    of the ![](img/Formula_06_123.png) atoms in Cartesian coordinates ![](img/Formula_06_124.png)
    , ![](img/Formula_06_125.png) , ![](img/Formula_06_126.png), for instance:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_127.png) , ![](img/Formula_06_128.png) , ![](img/Formula_06_129.png)'
  prefs: []
  type: TYPE_IMG
- en: A force constant Hessian matrix is a ![](img/Formula_06_130.png) by ![](img/Formula_06_131.png)
    matrix. The second derivatives are calculated as finite differences of the gradient
    when analytical expressions of these derivatives are not available.
  prefs: []
  type: TYPE_NORMAL
- en: Converting to mass weighted Cartesian coordinates
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The following change of Cartesian coordinates is then applied:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_132.png) , ![](img/Formula_06_133.png) , ![](img/Formula_06_134.png)'
  prefs: []
  type: TYPE_IMG
- en: by dividing by ![](img/Formula_06_135.png) each element pertaining to atoms
    ![](img/Formula_06_136.png) and ![](img/Formula_06_137.png) in the force constant
    Hessian matrix.
  prefs: []
  type: TYPE_NORMAL
- en: Diagonalizing the mass weighted Hessian matrix
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The mass weighted Hessian matrix is then diagonalized, yielding a set of ![](img/Formula_06_131.png)
    eigenvectors and ![](img/Formula_06_139.png) eigenvalues. The vibrational frequencies
    are then derived from the eigenvalues, which are forces using the equation that
    gives the harmonic oscillator frequency:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_140.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'where ![](img/Formula_06_141.png) is the frequency in s-1, ![](img/Formula_06_142.png)
    is the reduced mass, and ![](img/Formula_06_143.png) is the force constant. The
    frequency ![](img/Formula_06_144.png) in cm-1 is obtained by the relation ![](img/Formula_06_145.png)
    , where ![](img/Formula_06_146.png) is the speed of light, ![](img/Formula_06_147.png)
    cm s-1:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_148.jpg)'
  prefs: []
  type: TYPE_IMG
- en: We now illustrate this method by performing a vibrational frequency analysis
    of the CO2 molecule with Psi4 [Psi4_0], an open source quantum chemistry package.
    We refer the reader interested in installing this package to the “Get Started
    with Psi4” [Psi4_1] documentation.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we import Psi4 in our Python notebook:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'We redirect the output of the Psi4 calculation to a file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'We specify the amount of memory for the calculation:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'Then we define the geometry of the CO2 molecule [Psi4_2]:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'We optimize the geometry of the molecule:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'Here is the result, the energy of the ground electronic state of a CO2 molecule:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: 'We now perform a vibrational frequency analysis:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'We print the frequencies with the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: 'Here is the result, a list of harmonic vibrational frequencies in cm-1:'
  prefs: []
  type: TYPE_NORMAL
- en: '761.4181081677268'
  prefs: []
  type: TYPE_NORMAL
- en: '761.4181227549785'
  prefs: []
  type: TYPE_NORMAL
- en: '1513.1081106509557'
  prefs: []
  type: TYPE_NORMAL
- en: '2579.8280005025586'
  prefs: []
  type: TYPE_NORMAL
- en: These results are in excellent agreement with those presented by the Molecular
    Sciences Software Institute in their lesson to build a CO2 molecule [MolSSI].
    ChemTube3D provides an interactive 3D animation of the vibrations of carbon dioxide
    with these vibrations [ChemTube3D].
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 6.7* shows an extract of the vibrational frequency analysis performed
    with Psi4.'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.7.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.7 – Vibrational frequency analysis of the CO2 molecule with Psi4 (extract)
  prefs: []
  type: TYPE_NORMAL
- en: We now present the vibrational spectra for ortho-para isomerization of hydrogen
    molecules calculated with BO and non-BO methods and a comparison with experimental
    data.
  prefs: []
  type: TYPE_NORMAL
- en: 6.3\. Vibrational spectra for ortho-para isomerization of hydrogen molecules
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*Figure 6.8* shows a table comparing the energy spacing in wavenumber pertaining
    to the vibrational spectra for ortho-para isomerization of hydrogen molecules
    from the following sources described by columns A to C:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_149.png) is the energy in wave numbers produced by non-BO
    method with 10,000 basis functions [Sharkey].'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/Formula_06_150.png) is the energy in wave numbers produce by BO method
    [Komasa].'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/Formula_06_151.png) is experimental data in wave numbers [Dabrowski].'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'For each vibrational level ![](img/Formula_06_152.png) with the differences
    presented in percent [Sharkey_1] described by D to G:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_06_153.png)'
  prefs:
  - PREF_UL
  type: TYPE_IMG
- en: '![](img/Formula_06_154.png)'
  prefs:
  - PREF_UL
  type: TYPE_IMG
- en: '![](img/Formula_06_155.png)'
  prefs:
  - PREF_UL
  type: TYPE_IMG
- en: '![](img/Formula_06_156.png)'
  prefs:
  - PREF_UL
  type: TYPE_IMG
- en: 'Here is the table [Sharkey_1]:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.8.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.8 – Table comparing non-BO versus BO Computations to Experiment [Sharkey_1]
  prefs: []
  type: TYPE_NORMAL
- en: The non-BO method is highly accurate in predicting all states, including excited
    states, as shown in *Figure 6.9*, which presents columns A and B as a function
    of the vibrational quantum number. It is consistently lower in the predictions
    of the energy levels, with the exception of the ![](img/Formula_06_164.png) excited
    state, an anomaly attributed to the inaccuracy of the experimental data. There
    is a 5% breakdown of the BO prediction in the highest bound state (![](img/Formula_06_165.png)[Sharkey_1].
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.9.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.9 – Diagram comparing non-BO versus BO Computations to Experiment [Sharkey_1]
  prefs: []
  type: TYPE_NORMAL
- en: '*Figure 6.10* shows column G, a plot of the difference between the BO and non-BO
    computations as a function of the vibrational quantum number ![](img/Formula_06_166.png).'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B18268_Figure_6.10.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 6.10 – Diagram showing the % difference between BO/non-BO versus vibrational
    quantum number ![](img/Formula_06_167.png) [Sharkey_1]
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we have recalled the non-BO molecular Hamiltonian and given
    an outline of a method for extending the very accurate non-BO calculations with
    ECGs to states where the diatomic molecule is excited to the first rotational
    state and also vibrationally excited to an arbitrary level. We have shown a vibrational
    frequency analysis calculation with Psi4 of the carbon dioxide molecule. We have
    presented the vibrational spectra for ortho-para isomerization of hydrogen molecules
    calculated with a non-BO method [Sharkey], with a BO method [Komasa], and their
    comparison with experimental data. The non-BO method is highly accurate in predicting
    all states, including excited states of the hydrogen molecule. The scaling of
    the wave functions used for both BO and non-BO methods has a factorial dependence
    and is considered an NP-hard problem.
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'True or False: The computational complexity of determining molecular structure
    and vibrational spectra increases exponentially as a function of the number of
    atoms.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What does the acronym ECG stand for?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'True or False: In the harmonic oscillator approximation, the force required
    to extend the spring is proportional to the extension.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'True or False: When the vibrational energy is high, the harmonic oscillator
    approximation is no longer valid.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'True or False: The geometry of the molecule used for vibrational analysis must
    first be optimized so that the atoms are in equilibrium and have no momentum.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Answers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'True'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Explicitly correlated Gaussian function
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'True'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'True'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'True'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[Adamowicz_1] Sergiy Bubin, Michele Pavanello, Wei-Cheng Tung, Keeper L. Sharkey,
    and Ludwik Adamowicz, Born–Oppenheimer and Non-Born–Oppenheimer, Atomic and Molecular
    Calculations with Explicitly Correlated Gaussians, Chem. Rev. 2013, 113, 1, 36–79,
    October 1, 2012, [https://doi.org/10.1021/cr200419d](https://doi.org/10.1021/cr200419d)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Adamowicz_2] Sergiy Bubin and Ludwik Adamowicz, Computer program ATOM-MOL-nonBO
    for performing calculations of ground and excited states of atoms and molecules
    without assuming the Born–Oppenheimer approximation using all-particle complex
    explicitly correlated Gaussian functions, J. Chem. Phys. 152, 204102 (2020), [https://doi.org/10.1063/1.5144268](https://doi.org/10.1063/1.5144268)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Adamowicz_4] Jim Mitroy, Sergiy Bubin, Wataru Horiuchi, Yasuyuki Suzuki, Ludwik
    Adamowicz, Wojciech Cencek, Krzysztof Szalewicz, Jacek Komasa, D. Blume, and Kálmán
    Varga, Rev. Mod. Phys. 85, 693 – Published 6 May 2013, Theory and application
    of explicitly correlated Gaussians, [https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.85.693](https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.85.693)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Campargue] Alain Campargue, Samir Kassi, Krzysztof Pachucki and Jacek Komasa,
    The absorption spectrum of H2: CRDS measurements of the (2-0) band, review of
    the literature data and accurate ab initio line list up to 35000 cm-1, Physical
    Chemistry Chemical Physics, 13 Sep 2011, Table 5\. Rovibrational parameters of
    the V=0-13 vibrational levels of H2 obtained from the fit of the J=0-7 energy
    levels calculated in Ref. [36], [https://www.fuw.edu.pl/~krp/papers/camparge.pdf](https://www.fuw.edu.pl/~krp/papers/camparge.pdf)'
  prefs: []
  type: TYPE_NORMAL
- en: '[ChemTube3D] Vibrations of Carbon Dioxide, [https://www.chemtube3d.com/vibrationsco2](https://www.chemtube3d.com/vibrationsco2)'
  prefs: []
  type: TYPE_NORMAL
- en: '[D4.1 VA Beta] Arseny Kovyrshin, AstraZeneca AB R&D, Giorgio Silvi, HQS Quantum
    Simulations GmbH, D4.1: VA Beta and BBO Beta, NExt ApplicationS of Quantum Computing,
    23 Nov 2021, [https://www.neasqc.eu/wp-content/uploads/2022/01/NEASQC_D4.1_VA-Beta-and-BBO-Beta-R1.0.pdf](https://www.neasqc.eu/wp-content/uploads/2022/01/NEASQC_D4.1_VA-Beta-and-BBO-Beta-R1.0.pdf)
    , [https://github.com/NEASQC/Variationals_algorithms](https://github.com/NEASQC/Variationals_algorithms)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Dabrowski] Dabrowski, The Lyman and Werner Bands of H2, Can. J. Phys. 62,
    1639 (1984) Table 5\. Observed energy levels of the X^1 Sigma_g^+ of H_2, [https://doi.org/10.1139/p84-210](https://doi.org/10.1139/p84-210%20)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Demtröder] Atoms, Molecules and Photons, Wolfgang Demtröder, Second Edition,
    Springer, 9.5\. Rotation and Vibration of Diatomic Molecules, Springer, ISBN-13:
    978-3642102974'
  prefs: []
  type: TYPE_NORMAL
- en: '[Gaussian_1] Joseph W. Ochterski, Gaussian, Vibrational Analysis in Gaussian,
    [https://gaussian.com/vib/](https://gaussian.com/vib/)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Hartke] Hartke, T., Oreg, B., Jia, N. et al. Quantum register of fermion pairs.
    Nature 601, 537–541 (2022). [https://doi.org/10.1038/s41586-021-04205-8](https://doi.org/10.1038/s41586-021-04205-8)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Komasa] Komasa et al., Quantum Electrodynamics Effects in Rovibrational Spectra
    of Molecular Hydrogen J. Chem. Theory Comput. 2011, 7, 10, 3105–3115, Table 1\.
    Theoretically Predicted Dissociation Energies {in cm^(-1)} of All 302 Bound States
    of H_2\. [https://doi.org/10.1021/ct200438t](https://doi.org/10.1021/ct200438t)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Maytus] Edit Mátyus, Edit Mátyus (2019) Pre-Born–Oppenheimer molecular structure
    theory, Molecular Physics, 117:5, 590-609, DOI: 10.1080/00268976.2018.1530461,
    [https://doi.org/10.1080/00268976.2018.1530461](https://doi.org/10.1080/00268976.2018.1530461)'
  prefs: []
  type: TYPE_NORMAL
- en: '[MolSSI] Basis set convergence of molecular properties: Geometry and Vibrational
    Frequency, Molecular Sciences Software Institute (MolSSI), [http://education.molssi.org/qm-tools/04-vib-freq/index.html](http://education.molssi.org/qm-tools/04-vib-freq/index.html)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Neese] Vibrational Spectroscopy, Frank Neese from the Max Planck Institute
    for Chemical Energy Conversion, 2014 summer school, [https://www.youtube.com/watch?v=iJjg2L1F8I4](https://www.youtube.com/watch?v=iJjg2L1F8I4)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Psi4_0] Psi4 manual master index, [https://psicode.org/psi4manual/master/index.html](https://psicode.org/psi4manual/master/index.html)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Psi4_1] Get Started with PSI4, [https://psicode.org/installs/v15/](https://psicode.org/installs/v15/)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Psi4_2] Test case for Binding Energy of C4H5N (Pyrrole) with CO2 using MP2/def2-TZVPP,
    [https://github.com/psi4/psi4/blob/master/samples/mp2-def2/input.dat](https://github.com/psi4/psi4/blob/master/samples/mp2-def2/input.dat)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Psi4_3] Smith DGA, Burns LA, Simmonett AC, Parrish RM, Schieber MC, Galvelis
    R, Kraus P, Kruse H, Di Remigio R, Alenaizan A, James AM, Lehtola S, Misiewicz
    JP, Scheurer M, Shaw RA, Schriber JB, Xie Y, Glick ZL, Sirianni DA, O''Brien JS,
    Waldrop JM, Kumar A, Hohenstein EG, Pritchard BP, Brooks BR, Schaefer HF 3rd,
    Sokolov AY, Patkowski K, DePrince AE 3rd, Bozkaya U, King RA, Evangelista FA,
    Turney JM, Crawford TD, Sherrill CD. Psi4 1.4: Open-source software for high-throughput
    quantum chemistry. J Chem Phys. 2020 May 14;152(18):184108\. doi: 10.1063/5.0006002\.
    PMID: 32414239; PMCID: PMC7228781\. [https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7228781/pdf/JCPSA6-000152-184108_1.pdf](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7228781/pdf/JCPSA6-000152-184108_1.pdf%20)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Sawaya] Nicolas P. D. Sawaya, Francesco Paesani, Daniel P. Tabor, Near- and
    long-term quantum algorithmic approaches for vibrational spectroscopy, 1 Feb 2021,
    arXiv:2009.05066 [quant-ph], [https://arxiv.org/abs/2009.05066](https://arxiv.org/abs/2009.05066)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Schiffer_1] Fabijan Pavošević, Tanner Culpitt, and Sharon Hammes-Schiffer,
    Multicomponent Quantum Chemistry: Integrating Electronic and Nuclear Quantum Effects
    via the Nuclear−Electronic Orbital Method, Chem. Rev. 2020, 120, 9, 4222–4253,
    [https://doi.org/10.1021/acs.chemrev.9b00798](https://doi.org/10.1021/acs.chemrev.9b00798)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Schiffer_2] Kurt R. Brorsen, Andrew Sirjoosingh, Michael V. Pak, and Sharon
    Hammes-Schiffer, Nuclear-electronic orbital reduced explicitly correlated Hartree-Fock
    approach: Restricted basis sets and open-shell systems, J. Chem. Phys. 142, 214108
    (2015), [https://doi.org/10.1063/1.4921304](https://doi.org/10.1063/1.4921304)'
  prefs: []
  type: TYPE_NORMAL
- en: '[SciPy_0] SciPy, [https://scipy.org/](https://scipy.org/)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Sharkey] K. Sharkey et. al. Non-Born-Oppenheimer method for direct variational
    calculations of diatomic first excited rotational states using explicitly correlated
    all-particle Gaussian functions Physical Review A, 88, 032513 (2013, Table I.
    Total energies (in hartrees) of the (v,0) and (v,1) states of H_2\. [https://journals.aps.org/pra/abstract/10.1103/PhysRevA.88.032513](https://journals.aps.org/pra/abstract/10.1103/PhysRevA.88.032513)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Sharkey_1] K. Sharkey, Molecular-hydrogen poster, QLEAN™, [https://qlean.world/molecular-hydrogen-poster](https://qlean.world/molecular-hydrogen-poster%20)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Veis] Libor Veis, Jakub Višňák, Hiroaki Nishizawa, Hiromi Nakai, Jiří Pittner,
    Quantum chemistry beyond Born–Oppenheimer approximation on a quantum computer:
    A simulated phase estimation study, International Journal of Quantum Chemistry,
    22 June 2016, [https://doi.org/10.1002/qua.25176](https://doi.org/10.1002/qua.25176)'
  prefs: []
  type: TYPE_NORMAL
