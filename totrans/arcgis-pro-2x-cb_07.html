<html><head></head><body>
        

                            
                    <h1 class="header-title">Converting Data</h1>
                
            
            
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Converting shapefiles to a Geodatabase feature class</li>
<li>Merging multiple shapefiles into a single geodatabase feature class</li>
<li>Exporting tabular data to an Excel spreadsheet</li>
<li>Importing an Excel spreadsheet into ArcGIS Pro</li>
<li>Importing selected features into an existing layer</li>
</ul>


            

            
        
    

        

                            
                    <h1 class="header-title">Introduction</h1>
                
            
            
                
<p>As you may have noticed by now, GIS data comes in many formats. There are geodatabases, shapefiles, CAD files, DBF files, rasters, spreadsheets, and more. ArcGIS Pro allows you to use all of these. However, there are limits to what ArcGIS Pro allows you to do with some of these formats. Some of these are read only, such as CAD files or spreadsheets. Others you can read and edit, such as shapefiles and geodatabases. Also, if you have data spread across multiple locations, formats, and files, it can make it difficult to use.</p>
<p>If you are going to be editing and analyzing data, it is recommended that you consolidate all the required data into a single format. For ArcGIS Pro, the primary storage format is the geodatabase. Shapefiles are generally considered a secondary option. In order to consolidate your data sources, you may need to convert and combine data from one or more sources into a single source. ArcGIS Pro provides several methods and tools to accomplish this. Which one works best will depend on several factors, including:</p>
<ul>
<li>The existing data format</li>
<li>The target data format</li>
<li>How much data needs to be converted and the number of files?</li>
<li>Are you performing a wholesale conversion or do you need to select specific features?</li>
<li>Are you trying to combine multiple files into one?</li>
<li>Are you importing into the GIS or exporting out to use in another application?</li>
</ul>
<p>All of these considerations will help to determine which conversion method and tools will work best for your situation.</p>
<p>In this chapter, you will learn several different methods and tools that will allow you to convert and combine data within ArcGIS Pro. You will start by learning how to convert a simple shapefile into a new geodatabase feature class. Then you will expand those skills to learn how to merge multiple shapefiles into a single geodatabase feature class.</p>
<p>Next, you will learn how to export tabular data in your GIS to a spreadsheet, so you can easily include it in a report or perform additional calculations. Then you will reverse that workflow and import a spreadsheet into your GIS.</p>
<p>From there, you will learn how you can convert specific features from one source into another. The method you will learn provides you with a high level of control and accuracy when converting data.</p>
<p>Lastly, you will learn how to georeference CAD and raster files so that they are located in the proper location according to a specific coordinate system. This will make converting that data much easier.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Converting shapefiles to a geodatabase feature class</h1>
                
            
            
                
<p>Shapefiles are one of the most common GIS data formats you will encounter during your career in GIS. Just about every GIS-enabled application can read, import, export, and edit a shapefile. This includes applications such as QGIS, AutoCAD Map 3D, Civil 3D, Geomedia, and many others. This has resulted in shapefiles becoming a common format for sharing GIS data with multiple platforms. It is not uncommon to receive data from engineering, planning, and surveying firms in a shapefile format.</p>
<p>In this recipe, you will receive a shapefile containing the location of several stormwater drainage structures, which were collected by a local surveying firm. You will integrate this shapefile into the geodatabase for the City of Trippville.   </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe does require the sample data be installed on the computer. While it is not required to have completed any previous recipes, it is recommended that you at least review <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>, to ensure you have the proper skills required to successfully complete this recipe. You can complete this recipe with any ArcGIS Pro licensing level.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>You will need to launch ArcGIS Pro to begin this recipe.</li>
<li>In the ArcGIS Pro start window, click on Open another project:</li>
</ol>
<div><img src="img/abb24399-8cc0-427c-ae6f-1826608a35e1.png"/></div>
<ol start="3">
<li>Select Computer from the Open window and then click Browse in the area on the right.</li>
<li>Navigate to <kbd>C:\Student\ArcGISProCookbook\Chapter7\Convert Single Shapefile</kbd> by clicking on C:\ in the area on the left of the Open Project window. Then double-click on the Student, ArcGISProCookbook, Chapter7, and Convert Single Shapefile folders.</li>
<li>Select the Convert Single Shapefile.aprx project file and click OK.</li>
</ol>
<p style="padding-left: 60px">The project will open with the Trippville Stormwater Map visible. This is an existing map that was obviously created by someone else. You will notice, if you look at the Contents pane, that the map does not contain any stormwater layers. You will add the shapefile you have received from the local surveying firm:</p>
<ol start="6">
<li>In the Catalog pane, click on the small arrowhead located next to the Folders folder so you can see its contents. Then expand the Convert Single Shapefile folder so you can see its contents.</li>
<li>You should see the Stormwater_Structures.shp file in the folder you just expanded. Before you use this file you should examine its metadata to ensure it is the one you are looking for.</li>
<li>Right-click on the Stormwater_structures.shp file and select View Metadata from the menu that appears, as shown in the following screenshot:</li>
</ol>
<div><img class="alignnone size-full wp-image-872 image-border" height="513" src="img/8089e608-9208-4885-8195-0f06bbe6632b.png" width="249"/></div>
<div><p>ArcGIS Pro uses different colored icons to identify data formats. Shapefiles are shown with a green icon, CAD files with a blue icon, and geodatabases with a gray icon. </p>
</div>
<p style="padding-left: 60px">The Catalog view should open, displaying the metadata for the shapefile you selected. This will provide you with basic information concerning the shapefile. </p>
<div><p>Metadata is data about your data. It provides information about how the data was created, when it was created, how often it is updated, what its intended purpose is, and more. It is considered best practice to create and maintain metadata for all GIS datasets. However, it is not uncommon to find data without metadata. This is especially true of shapefiles, since they must be manually created and maintained. ArcGIS will automatically create at least some metadata for geodatabase feature classes and tables.</p>
</div>
<ol start="9">
<li>Take a moment to read over the metadata for the shapefile. When done, close the Catalog view by clicking on the x in the tab entitled Catalog at the top of the view area. This should return you to the map.</li>
<li>Now it is time to add the shapefile to the map. Right-click on the Stormwater_Structures.shp file and select Add to Current Map from the menu that appears, as illustrated here:</li>
</ol>
<div><img class="alignnone size-full wp-image-873 image-border" height="321" src="img/db8e95e4-67f4-4bd3-8159-3928d7eaf756.png" width="288"/></div>
<p>Add new layer to current map from Catalog pane</p>
<p style="padding-left: 60px">The Stormwater Structures layer should now appear in your Contents pane. Next you will review the attribute data associated with the layer you just added.</p>
<ol start="11">
<li>Right-click on the Stormwater_Structures layer in the Contents pane. Select the Attribute Table, as shown in the following screenshot. This will open the attribute table for the shapefile below the map view unless you have moved the table window to another location:</li>
</ol>
<div><img height="309" src="img/17df8095-3411-426a-ac45-c8034b808b05.png" width="308"/></div>
<div><p><strong>Question</strong>: What fields are located in the attribute table for the shapefile?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: How many structures/features are stored in the shapefile?</p>
<p><strong>Answer</strong>: </p>
</div>
<p style="padding-left: 60px">The table window is dockable and undockable, so, you can move it wherever you wish, including to another monitor. Unlike ArcMap, ArcGIS Pro allows you to open each table in its own window, providing greater viewing flexibility.</p>
<p style="padding-left: 60px">You should see only four fields in the attribute table, FID, Shape, Id, and Typ. The FID and Shape are default fields for a shapefile. The Id and Typ are user-defined fields. Default fields are created and maintained by the software that created the data. User-defined fields are those created and maintained by users. The default and user-defined fields will vary from application to application and format to format.</p>
<p style="padding-left: 60px">The Typ field identifies the type of structure, CB is a catch basin, AD is an area drain, DI is a drop inlet. These are all common stormwater drainage structures. </p>
<p style="padding-left: 60px">After viewing the metadata and the attribute fields, you now have a better understanding of the data you will be converting. It is always good to make sure you know the data you are working with before you start using it to perform analysis or create maps.</p>
<ol start="12">
<li>Close the Table window by clicking on the x in the tab labeled Stormwater_Structures. Now the map should fill the entire view area once more.</li>
<li>In the Catalog pane, expand the Databases folder so you can see its contents.</li>
<li>Expand the Trippville_GIS.gdb geodatabase by clicking on the small arrowhead located to the left of the database name.</li>
<li>Look at the contents of the geodatabase. You should notice that there are three feature datasets included: Base, Sewer, and Water.</li>
</ol>
<div><p>Feature datasets serve several purposes within a geodatabase. First, they help you better organize related data. Second, they ensure all data stored within them shares a common spatial reference, which means they are all in the same coordinate system. This allows the data to take part in topologies and geometric networks which are used to ensure data quality and provide additional functionality.</p>
<p>Early versions of ArcGIS Pro do not support Geometric networks, but version 2.1 and later will. Geometric Networks will be renamed to Utility Network. The Utility Network will allow you to trace your utility network and perform various types of analysis. To learn more about the Utility Network, go to <a href="http://www.esri.com/esri-news/arcnews/spring17articles/introducing-utility-network-for-arcgis">http://www.esri.com/esri-news/arcnews/spring17articles/introducing-utility-network-for-arcgis</a>.</p>
</div>
<p style="padding-left: 60px">Before you convert the Stormwater_Structures shapefile into a geodatabase feature class, you will create a new feature dataset for the stormwater system. This will allow you to easily find the data in the geodatabase later and allow you to create a utility network in the future if you need to.</p>
<ol start="16">
<li>In the Catalog pane, right-click on the Trippville_GIS.gdb geodatabase. In the menu that appears, go to New and select Feature Dataset, as illustrated in the following screenshot. This will open the Create Feature Dataset tool in the Geoprocessing pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-874 image-border" height="316" src="img/90ea7d3e-2c11-4c25-8391-a74186a6dbfd.png" width="414"/></div>
<ol start="17">
<li>The Output Geodatabase should automatically be set to Trippville_GIS.gdb because it was the one you selected and right-clicked on. For the Feature Dataset Name, type <kbd>Stormwater</kbd>.</li>
</ol>
<ol start="18">
<li>Under the Coordinate System option, click on the small drop-down arrow located on the far-right side of the cell. Select Street Rights of Way from the list, as shown here:</li>
</ol>
<div><img class="alignnone size-full wp-image-875 image-border" height="242" src="img/b2f8f7cb-0ef2-42ab-a0da-d82539a910f2.png" width="429"/></div>
<p style="padding-left: 60px">The Coordinate System should now be set to NAD_1983_StatePlane_Georgia_West_FIPS_1002_Feet.</p>
<ol start="19">
<li>Verify that the Create Feature Dataset tool looks like the screenshot that follows. If it does, click the Run button located at the bottom of the pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-876 image-border" height="221" src="img/8d0c9c62-27df-49c9-b680-6521fb88f61f.png" width="423"/></div>
<p style="padding-left: 60px">When the tool finishes, you should see the new feature dataset that you just created appear in the Trippville_GIS.gdb geodatabase. You will convert the shapefile containing the stormwater structures to a new feature class which will be stored in the feature dataset you just created.</p>
<ol start="20">
<li>In the Contents pane, right-click on the Stormwater_Structures layer. In the menu that appears, go to Data and select the Export Features option as illustrated in the following screenshot. This will open the Copy Features tool in the Geoprocessing pane. This normally appears on the right side of the interface:</li>
</ol>
<div><img height="453" src="img/70c2883b-97ad-4f27-9d27-0f0816ee967b.png" width="354"/></div>
<p>Exporting features from the Contents pane</p>
<ol start="21">
<li>The Input Features should automatically be set because you right-clicked on a specific layer to access the tool. Click the Browse button located on the far-right side of the Output Feature Class.</li>
<li>In the Output Feature Class window that opens, select the Databases folder located under Project in the left panel of the window. Two databases should appear in the right panel: Convert Single Shapefile.gdb and Trippville_GIS.gdb.</li>
<li>Double-click on the Trippville_GIS geodatabase.</li>
<li>Double-click on the Stormwater feature dataset that you created earlier.</li>
<li>In the Name cell located near the bottom of the Output Feature Class window, type <kbd>Stormwater_Structures</kbd> and click Save.</li>
<li>Verify that the Copy Features tool looks like the screenshot, and click the Run button:</li>
</ol>
<div><img class="alignnone size-full wp-image-877 image-border" height="269" src="img/cc400956-f03a-4672-afb8-800d49503ef9.png" width="398"/></div>
<p style="padding-left: 60px">If the tool ran successfully, a new layer should appear in your map. Now you will verify that ArcGIS Pro converted the shapefile successfully.</p>
<ol start="27">
<li>Close the Geoprocessing pane by clicking on the small x located in the upper-right corner of the pane.</li>
<li>In the Contents pane, click on the List by Source button. It should be the second one from the left and looks like a cylinder.</li>
</ol>
<ol start="29">
<li>Notice that you have two Stormwater_Structures layers. However, they are in two different locations.</li>
</ol>
<div><p><strong>Question</strong>: Where are the two stormwater_structures stored?</p>
<p><strong>Answer</strong>: </p>
</div>
<p style="padding-left: 60px">As you can see, one of the stormwater_structures layers is stored in the Trippville GIS geodatabase. The other is stored in the Convert Single Shapefile folder. The one in the geodatabase is the one you just converted. The other is the original shapefile. The Copy Features tool created a new feature class in the geodatabase and left the source shapefile alone. Now that you have verified that it did create the feature class in the geodatabase, you need to verify that it converted all the features.  </p>
<ol start="30">
<li>Right-click on the Stormwater_Structures layer, which is stored in the Trippville_GIS.gdb, and select Attribute Table from the menu that appears.</li>
<li>Look at the bottom of the table window to see the total number of records/features contained in the layer.</li>
</ol>
<div><p><strong>Question</strong>: Does it match the number of features that were in the Shapefile? (Look back to earlier in this recipe when you opened the attribute table for the shapefile and answered the question of how many features were stored in it if you don’t remember.)</p>
<p><strong>Answer</strong>:</p>
</div>
<p style="padding-left: 60px">Both the shapefile and geodatabase feature class should contain the same number of records/features if the Copy Features tool worked correctly.</p>
<ol start="32">
<li>Right-click on the Stormwater_Structures shapefile layer in the Contents pane, and select Remove from the menu that appears. You no longer need the shapefile layer in your map.</li>
<li>Click on the Save Project button located in the Quick Access menu at the top left of the ArcGIS Pro interface.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">There’s more…</h1>
                
            
            
                
<p>As with most things you can do in ArcGIS Pro, there is more than one way to accomplish a task. Converting a Shapefile to a geodatabase feature class is no exception. For example, you could have accessed the Copy Features tool directly from the Data Management Tools toolbox and the Features toolset in the Geoprocessing pane.</p>
<p>There is also a third way that you can convert shapefiles to a geodatabase feature class. You can use the Feature Class to Feature Class geoprocessing tool as well. Let's take a look at how that works.</p>
<p>You have received a shapefile containing stormwater drainage pipes from the same local surveying firm. You want to convert those into the feature dataset that you created earlier in this recipe:</p>
<ol>
<li>In the Catalog pane, expand the contents of the Trippville_GIS.gdb if needed. It may still be expanded from your previous work.</li>
<li>Right-click on the Stormwater feature dataset. Select Import and Feature Class…. This will open the Feature Class to Feature Class conversion tool in the Geoprocessing pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-878 image-border" height="325" src="img/aa88b8b7-fd31-409e-b41f-76912dcc5be2.png" width="347"/></div>
<ol start="3">
<li>The Output Location should already be set. Click on the Browse button at the far-right end of the Input Features.</li>
<li>In the Input features window, select the Folders folder in the left panel under Project. The Convert Single Shapefile folder should appear in the right panel of the window.</li>
<li>Double-click on the Convert Single Shapefile folder.</li>
<li>Click on Stormwater_Pipes.shp and click OK.</li>
<li>Set the Output Feature Class to <kbd>Pipes</kbd>. You will not need to change any other tool settings.</li>
<li>Verify that your Feature Class to Feature Class tool looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-879 image-border" height="430" src="img/a8e599b8-391a-406a-8cfa-f90c0e6d0aad.png" width="281"/></div>
<p>Feature class to feature class conversion tool</p>
<ol start="9">
<li>If the tool is successful, a new Pipes layer should appear in your map. This new layer points to a new feature class, you just created in the Trippville_GIS geodatabase.</li>
<li>Let’s verify that the tool did create a new feature class. In the Catalog pane, expand the Databases folder, then expand the Trippville_GIS.gdb geodatabase and the Stormwater feature dataset.</li>
<li>Verify that you see the Pipes feature class.</li>
<li>If you do, close the Geoprocessing pane and save your project.</li>
</ol>
<div><p>If any geoprocessing tool, such as the Feature Class to Feature Class tool, fails, you can always click on the History tab in the Catalog pane to review what happened. You can click on any geoprocessing operation you have performed during your ArcGIS Pro session and see if it was successful or not. If it was not, you can see the errors which were generated so you can troubleshoot why it did not work.</p>
</div>
<ol start="13">
<li>If you are not continuing to the next recipe you can close ArcGIS Pro. If you are continuing, keep ArcGIS Pro open.</li>
</ol>
<p>So, you have now seen two different tools you can use to convert shapefiles into geodatabase feature classes. These tools are not just limited to converting shapefiles. They can also convert other spatial data formats, including coverages, DWGs, DGNs, DXFs, and more as well.   </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Merging multiple shapefiles into a single geodatabase feature class</h1>
                
            
            
                
<p>You now know how to convert a single shapefile into an individual geodatabase feature class. What if you have several shapefiles that you need to merge into a single common geodatabase feature class? Can you do that in ArcGIS Pro?</p>
<p>Of course you can. This is not an uncommon workflow. You often need to combine multiple shapefiles or geodatabase feature classes into a single feature class. Combining multiple sources into a single one makes working with the data easier. For example, you are working on a regional transportation study and you receive road data from three counties. If you wish to analyze traffic flow or calculate the total length of roads by type for the region, it would be much easier to do if all the data was in a single feature class. Maybe you are responsible for maintaining data for a 911 center that services both the city and county. The city and county assign addresses for new construction and update the address point file for their respective jurisdiction. You would need to combine these two files for use in the 911 software. These are just two possible examples of situations where you would want to combine multiple shapefiles or geodatabase feature classes together into one.</p>
<p>In this recipe, you will merge three different shapefiles into a single common geodatabase feature class. You have had three field crews out collecting the location of street signs as part of a sign inventory the roads superintendent asked you to create. Each crew has collected the sign location data into a shapefile. So, you now have three separate shapefiles which need to be merged into a single geodatabase feature class. This will make the data much easier to manage and work with in the future.   </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe does require the sample data be installed on the computer. You do not need to complete any previous recipes. Though it is recommended that you review <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>, plus the previous recipe in this chapter, to ensure that you have a basic understanding of the skills required to complete this recipe. This recipe can be completed with any ArcGIS Pro licensing level. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>If you closed ArcGIS Pro before starting this recipe, you will need to start ArcGIS Pro.</li>
<li>Open the <kbd>Convert Multiple Shapefiles.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter7</kbd> using the skills you have learned in past recipes.</li>
</ol>
<p style="padding-left: 60px">The project should open with the Street Sign Inventory map. If you look in the Contents pane you will see three Street_Signs layers. These are the three shapefiles collected by your field crews. You will take a moment to investigate these three layers so you know what you have to work with.</p>
<ol start="3">
<li>Right-click on the Street_Signs_Day1 layer in the Contents pane and select Attribute Table from the menu that appears. Take a moment to investigate the Attribute Table and then answer the following questions:</li>
</ol>
<div><p><strong>Question</strong>: What type of shapefile is this layer?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: What attribute fields does it contain?</p>
<p><strong>Answer</strong>: </p>
</div>
<ol start="4">
<li>Repeat this process for the other two Street_Signs layers. Compare the answers to the previous two questions with each of these layers. Note any similarities or differences.</li>
</ol>
<p style="padding-left: 60px">As you have just found out, all three layers are point features and have a common attribute table structure or schema. While a common schema is not always required when merging multiple fields together, it does often help. One thing that must match in order to merge multiple layers together is the feature type. You can only merge points with points, lines with lines, and polygons with polygons.</p>
<p style="padding-left: 60px">Now that you have verified that the feature types match and the attribute fields are the same, you are ready to merge the three layers together to create a single one:</p>
<ol start="5">
<li>Close the Attribute Tables for the three Street_Signs layers. This will free up some screen space.</li>
<li>Click on the Analysis tab in the ribbon.</li>
<li>Click on the Tools button in the Geoprocessing group in the Analysis tab. This will open the Geoprocessing pane.</li>
</ol>
<ol start="8">
<li>Click on the Toolboxes tab in the Geoprocessing pane, as illustrated:</li>
</ol>
<div><img class="alignnone size-full wp-image-880 image-border" height="203" src="img/6aff7e48-dfe8-4961-970b-5a48a18e146d.png" width="373"/></div>
<ol start="9">
<li>In the Search box at the top of the Geoprocessing page, type <kbd>Merge</kbd> and press your <em>Enter</em> key to locate the Merge tool.</li>
<li>Select Merge (Data Management Tools) from the list that is presented. It should be near the top, as shown in the following screenshot:</li>
</ol>
<div><strong><img height="224" src="img/ea385e39-0ba4-4333-8633-f270c1796cf6.png" width="357"/></strong></div>
<p>Selecting the Merge tool in the Geoprocessing pane.</p>
<p style="padding-left: 60px">The Merge geoprocessing tool should now be open in the Geoprocessing pane. This is the tool you will use to combine the three individual shapefiles.</p>
<ol start="11">
<li>Under Input Datasets, click on the small drop-down arrow and select Street_Signs_Day1. When you do that, another input box should appear below it, allowing you to add another input.</li>
<li>Click on the small drop-down arrow at the end of the second input box that appeared and select Street_Signs_Day2.</li>
<li>Repeat that process to add Street_Signs_Day3 as the last input for the Merge tool.</li>
<li>Click the Browse button at the right side of the Output Dataset box.</li>
<li>In the Output Dataset window that appears, select Databases from the panel on the left side of the window.</li>
<li>Double-click on the Trippville_GIS geodatabase in the panel on the right side of the window.</li>
<li>In the Name cell, type <kbd>StreetSigns</kbd> and click Save.</li>
<li>Verify that your Merge tool looks like the following screenshot. If it does, click Run:</li>
</ol>
<div><strong><img height="344" src="img/3ec4abbf-af65-467e-b729-15bce03abd74.png" width="376"/></strong></div>
<p>The Merge geoprocessing tool</p>
<p style="padding-left: 60px">When the tool runs successfully, you should see a new StreetSigns layer added to your map. This new layer should cover all the points in the original three layers, but notice they still exist. The Merge tool, like most geoprocessing tools, creates new data and does not alter the original input data. But let’s verify that just to be sure.</p>
<ol start="19">
<li>Click on the List by Source tab located in the Contents pane. It is the button that looks like a gray cylinder.</li>
<li>Locate all Street Signs layers that are visible in the map. Note where their source is stored and answer the following questions:</li>
</ol>
<div><p><strong>Question</strong>: Where is the StreetSigns layer you that just created being stored?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: Where are the three Street_Signs shapefiles being stored? </p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: Are these the same? </p>
<p><strong>Answer</strong>: </p>
</div>
<p style="padding-left: 60px">As you can now see, the StreetSigns layer is referencing a geodatabase feature class that is being stored in the Trippville_GIS geodatabase, whereas the shapefiles for the Street_Signs shapefiles are stored in the Convert Single Shapefile folder. These are two very different locations. Because we don’t see a red exclamation point located beside any of the layer names, we know the data sources still exist and none have been deleted.</p>
<div><p>Any time that you see a red exclamation point located just before the layer name in the Contents pane, you know that layer has lost the connection to its source data.</p>
</div>
<ol start="21">
<li>Right-click on each of the Street_Signs layers and select Remove from the menu that appears. This removes them from the map to reduce clutter and confusion. Removing a layer from the map does not delete the source data.</li>
<li>Right-click on the StreetSigns layer and select Attribute Table from the menu that appears.</li>
</ol>
<ol start="23">
<li>Review the Attribute Table and compare it with what you saw when looking at the attribute tables for the shapefiles.</li>
</ol>
<div><p><strong>Question</strong>: How does the attribute table for the StreetSigns layer compare to the ones for the three shapefiles?</p>
<p><strong>Answer</strong>:</p>
</div>
<ol start="24">
<li>Save your project.</li>
</ol>
<p>As you can see, the Attribute Table for the new StreetSigns layer contains the same exact fields as the original three shapefiles. Also, the number of records equals the sum of the total records from the three shapefiles. The Merge geoprocessing tool combined the content, both spatial and attributes, of the three shapefiles into a single geodatabase feature class.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">There’s more…</h1>
                
            
            
                
<p>The Merge geoprocessing tool works great if you want to combine multiple files or feature classes into a new single feature class. What if you want to add new data from a shapefile or geodatabase feature class to an existing layer of information? For example, your field crews go out and locate additional street signs. You would not want to create another layer. Instead you would want to add the new signs to the existing layer. How would you do that?</p>
<p>This is where the Append geoprocessing tool comes in to play. The Append tool will add new records from an input table, file, or feature class to an existing one. Let’s see it in action so you can gain a better understanding of how it works. You will append a new shapefile that contains additional sign locations to the StreetSigns layer you just created:</p>
<ol>
<li>Click on the Map tab in the ribbon.</li>
<li>Click on the Add Data button in the Layer group on the Map tab.</li>
<li>Click on the Folders folder located under Project in the panel on the left side of the Add Data window.</li>
<li>Double-click on the Convert Single Shapefile folder in the right-side panel.</li>
<li>Select the Street_Signs_Day4.shp file and click OK to add the shapefile as a layer to the map.</li>
</ol>
<ol start="6">
<li>Right-click on the Street_Signs_Day4 layer you just added to your map, and select Zoom to Layer from the menu that is presented. This will allow you to more easily see the layer you just added. As you can see, this layer contains data for more signs located on the west side of the city.</li>
<li>Open the Attribute Table for the Street_Signs_Day4 layer using the same process you used earlier in this recipe.</li>
<li>Review the Attribute Table contents and note the number of features/records in the table. Use that information to answer the following question:</li>
</ol>
<div><p><strong>Question</strong>: How many records/features does the Street_Signs_Day4 shapefile contain?</p>
<p><strong>Answer</strong>:</p>
</div>
<ol start="9">
<li>Open the attribute table for the StreetSigns layer and note the number of records/features it contains. Use that information to answer the following question.</li>
</ol>
<div><p><strong>Question</strong>: How many records/features does the StreetSigns layer contain?</p>
<p><strong>Answer</strong>:</p>
</div>
<ol start="10">
<li>Click on the Analysis tab in the ribbon.</li>
<li>Click on the Tools button located in the Geoprocessing group on the Analysis tab.</li>
<li>In the Geoprocessing pane that appears, click on the Toolboxes tab.</li>
<li>Locate and expand the Data Management Tools toolbox.</li>
</ol>
<ol start="14">
<li>Expand the General toolset and locate the Append tool, as illustrated in the following screenshot:</li>
</ol>
<div><strong><img height="481" src="img/63138d0e-04e6-481d-a2d0-a9bdf096a0bd.png" width="594"/></strong></div>
<ol start="15">
<li>Click on the Append tool to open it in the Geoprocessing pane.</li>
<li>Click on the small drop-down arrow located to the right of the Input Datasets cell and select Street_Signs_Day4.</li>
<li>Click on the small drop-down arrow located to the right of the Target Dataset and select StreetSigns from the list presented.</li>
</ol>
<ol start="18">
<li>Verify that your Append tool looks like the following and click Run:</li>
</ol>
<div><strong><img src="img/8e9da361-49f1-4c9a-b147-5a5811478cea.png"/></strong></div>
<p>The Append tool in the Geoprocessing pane.</p>
<p style="padding-left: 60px">Notice that no new layers were added to your map, unlike when you used the Merge tool. This is because no new layers were created. The features from the Street_Signs_Day4 shapefile have been added to the existing StreetSigns shapefile. Let’s verify that is what happened.</p>
<ol start="19">
<li>In the Contents pane, select the List by Draw Order button. It is the first one on the left-hand side.</li>
</ol>
<ol start="20">
<li>Turn off the Street_Signs_Day4 layer by clicking on the box to the left of the layer name so it no longer contains a check mark.</li>
</ol>
<p style="padding-left: 60px">You should now see a copy of the features that were in the shapefile displayed in the StreetSigns layer. This shows that the features from the shapefile were copied to the geodatabase feature class. Now check the attributes to ensure they were copied.</p>
<ol start="21">
<li>In the Contents pane, select the List by Selection button.</li>
<li>Ensure the StreetSigns layer is set as selectable.</li>
<li>Right-click on the Street_Signs_Day4 layer and select Zoom to Layer. This ensures that you are zoomed in to the area covered by this layer.</li>
<li>Click on the Map tab in the ribbon.</li>
<li>Click on the Select button in the Selection group on the Map tab.</li>
<li>On your map, click on the lower-right side, as indicated in the following diagram. Continue to hold your mouse button down and drag your mouse pointer to the north-west until you reach the approximate location shown, creating a rectangle which will allow you to select all the features copied from the shapefile:</li>
</ol>
<div><strong><img height="307" src="img/31e5c155-f9b1-4fdd-b4b3-a6ac16c9beef.png" width="494"/></strong></div>
<p>Selection rectangle for street signs</p>
<ol start="27">
<li>Right-click on the StreetSigns layer and select Attribute Table.</li>
<li>Click the Show Selected Records button located at the bottom of the Attribute Table. This filters the table so that only the selected features are visible.</li>
<li>Note the total number of records. Compare that to the number of records in the table before you used the Append tool. Use that information to answer the following questions:</li>
</ol>
<div><p><strong>Question</strong>: Do the selected records all include attribute values?  </p>
<p><strong>Answer</strong>:</p>
<p><strong>Question</strong>: How does the total number of records in the table compare to the number before you ran the Append tool?</p>
<p><strong>Answer</strong>:</p>
</div>
<p style="padding-left: 60px">As you can see, the attribute values were also copied from the shapefile to the new geodatabase feature class. The new total number of records in the StreetSigns layer should equal the sum of the number of records in the shapefile plus the pre-append tool record count for the StreetSigns layer. The Append tool simply added the records/features from the shapefile to the StreetSigns layer.</p>
<ol start="30">
<li>Close the Attribute Table and Geoprocessing pane if it is still open.</li>
<li>Save your project and close ArcGIS Pro.</li>
</ol>
<p>As you have now experienced, the Merge and Append geoprocessing tools are great for combining multiple datasets into one. This can reduce the total number of datasets you must manage and make performing analysis much easier. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">Exporting tabular data to an Excel spreadsheet</h1>
                
            
            
                
<p>Many times, the people we work with are not GIS professionals or do not have access to GIS software. They may request data in another format. One of the most commonly requested formats is a spreadsheet. Spreadsheets are something just about everyone with a computer can work with. They can run calculations, summarize data, create graphs, and more.</p>
<p>While you cannot export the spatial data to a spreadsheet, ArcGIS Pro will allow you to export tabular data to a spreadsheet-compatible format. This includes Microsoft Excel XLS, XLSX, and CSV files. You are able to export attribute and stand-alone database tables to spreadsheets with ArcGIS Pro. As with most other operations, there is more than one way to do it.</p>
<p>In this recipe, you will learn two different methods for converting tables to spreadsheet compatible formats. The roads superintendent has asked you to provide him with a copy of the street sign inventory you have been working on so he can get a general count of all signs by type, and so he can compare it to his list of signs he has been keeping in a notebook. He also wants you to get him a spreadsheet with all the roads located within the city. You will use a different method for each of these tasks.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>This recipe requires that you have completed the previous recipe. It also requires you to have spreadsheet software installed, such as Microsoft Excel or Open Office. This recipe can also be completed with all license levels of ArcGIS Pro.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>You will first need to start ArcGIS Pro and open the <kbd>Convert Multiple Shapefiles.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter7\</kbd> using the skills you have learned in past recipes.</li>
<li>Locate the StreetSigns layer in the Contents pane.</li>
<li>Right-click on the StreetSigns layer and go down to Data. Then select Export Table, as illustrated in the following screenshot. This will open the Copy Rows tool in the Geoprocessing pane:</li>
</ol>
<div><img height="527" src="img/0194bb10-d0ab-4d61-b3f0-b66dae33c6e2.png" width="398"/></div>
<p>Accessing Export Table function</p>
<ol start="4">
<li>The Input Rows should already be set to the StreetSigns layer since you right-clicked on it to access the tool. Now click on the Browse button located to the right of the Output Table.</li>
<li>Click on the Folders folder located under Project in the left panel of the Output Table window.</li>
</ol>
<ol start="6">
<li>Double-click on the Convert Single Shapefile folder in the right panel.</li>
<li>In the Name cell, type <kbd>StreetSignsInventory.csv</kbd> and click the Save button at the bottom of the window.</li>
<li>Verify that your Copy Rows tool looks like the following and click Run:</li>
</ol>
<div><strong><img height="503" src="img/db7df47c-aa99-4b71-b346-f598a9bdd59c.png" width="327"/></strong></div>
<div><p>The Copy Rows tool can be used to convert multiple types of tabular data to other formats. Input for this tool can include Geodatabases, shapefiles, dBase tables, Microsoft Excel spreadsheets, CSV files, and TXT files. Output can be geodatabase standalone tables, dBase tables, and CSV and TXT files. To learn more about the Copy Rows tool, go to <a href="http://pro.arcgis.com/en/pro-app/tool-reference/data-management/copy-rows.htm">http://pro.arcgis.com/en/pro-app/tool-reference/data-management/copy-rows.htm</a>.</p>
</div>
<p style="padding-left: 60px">Remember, if you have features or records selected in a layer or table, the Copy Rows tool will only export the selected items to the new output table.</p>
<p style="padding-left: 60px">When the Copy Rows tool is complete, you should see a new table appear in the Contents pane. This is the CSV file you just created. Let’s see if it will open in Microsoft Excel or the spreadsheet application you have installed.</p>
<ol start="9">
<li>Open your Windows Explorer or File Explorer depending on what version of Windows you are using. There is typically an icon on the Taskbar located at the bottom of your monitor which will open Windows Explorer or File Explore. The icon looks like a file folder sitting in a stand.</li>
</ol>
<div><p>File/Windows Explorer is not the same as Internet Explorer. Internet Explorer is a web browser. File/Windows Explorer allows you to browse the contents of your computer, network, and connected drives.</p>
</div>
<ol start="10">
<li>In the directory tree located in the panel on the left of the File Explorer window, locate Desktop and expand it so you can see its contents.</li>
<li>Locate This PC or My Computer within the Directory Tree and expand it so you can see its contents.</li>
<li>Click on the C:\ drive. It is normally named either Local Drive or OS.</li>
<li>In the right panel, locate the Student folder and double-click on it.</li>
<li>Double-click on the ArcGISProCookbook folder to open it.</li>
<li>Double-click on the Chapter7 and the Convert Single Shapefile folders to open them.</li>
<li>Scroll down until you find the StreetSignsInventory.CSV file and double-click to open it.</li>
</ol>
<ol start="17">
<li>Take a moment to look over the contents of the file. You should see three columns. The first row should contain the field names from the Attribute Table. The remaining rows contain the data from the attribute table. It should look similar to the following:</li>
</ol>
<div><img height="342" src="img/26d54d99-c5d7-4877-a0e8-82e5925fbffc.png" width="512"/></div>
<ol start="18">
<li>Once you are done reviewing the CSV file, close it. If asked to save it, do not.</li>
</ol>
<p style="padding-left: 60px">You have just converted the Attribute Table for the StreetSigns layer to a CSV file which you opened as a spreadsheet. So, you have completed the first task. Now you need to export the street centerline attributes. This will actually require you to prepare the data before you export it, because, as you will see, your street centerline data actually extends beyond the City Limits.</p>
<ol start="19">
<li>Return to ArcGIS Pro. If you accidentally closed ArcGIS Pro, please refer back to the first step in this recipe to reopen the correct project. </li>
<li>In the Catalog pane, expand the Databases folder so you can see its contents.</li>
<li>Next, expand the Trippville_GIS.gdb geodatabase and the Base feature dataset.</li>
</ol>
<ol start="22">
<li>Drag and drop the Street_Centerlines feature class into the map view.</li>
</ol>
<p style="padding-left: 60px">As you can see, the data extends outside the City Limits of Trippville. The roads superintendent only wants data for the portions of the roads inside the City Limits, so you will need to clip the data.</p>
<ol start="23">
<li>Click on the Analysis tab in the ribbon.</li>
<li>Click on the Clip tool located in the Tools group on the ribbon. This will open the Clip tool in the Geoprocessing pane.</li>
<li>Click on the drop-down arrow for the Input Features located at the far right side of the cell. Select Street_Centerlines from the list.</li>
<li>Repeat this process for the Clip Features, selecting the City_Limit layer.</li>
<li>Accept the default name for the Output Feature Class. Verify that your Clip tool looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-881 image-border" height="375" src="img/4ad2ff3e-e52a-43b3-af51-5c86d28d8c3f.png" width="243"/></div>
<p>Clip tool in the Geoprocessing pane</p>
<p style="padding-left: 60px">When the Clip tool completes, a new layer will appear in your map which contains only the portion of the roads within the City Limits of Trippville:</p>
<ol start="28">
<li>Close the Geoprocessing pane and save your project.</li>
<li>Click on the Analysis tab in the ribbon to ensure it is active. Next click on the Tools button located in the Geoprocessing group.</li>
<li>Click on the Toolboxes tab at the top of the Geoprocessing pane, as illustrated in the following screenshot:</li>
</ol>
<div><img height="245" src="img/41ec7205-8abe-4212-a763-3c895fe86262.png" width="439"/></div>
<p>Click on Toolboxes tab in center</p>
<ol start="31">
<li>Locate and expand the Conversion Tools toolbox in the Geoprocessing pane.</li>
<li>Expand the Excel toolset to reveal the Excel to Table and the Table to Excel Python script tools.</li>
</ol>
<div><p>You may wonder how you can tell these are Python script tools. It is because of the icon located next to the tool. Scrolls, as displayed next to these two tools, indicate Python script tools. Hammers indicate system tools such as the Clip tool, you used earlier in this recipe. A group of connected multi-colored diamonds indicates a model tool created with ModelBuilder.</p>
</div>
<ol start="33">
<li>Select the Table to Excel tool. This will open the tool in the Geoprocessing pane.</li>
<li>Click the drop-down arrow for the Input Table and select Street_Centerline_Clip from the list.</li>
<li>For the Output Excel File, click the Browse button located on the far-right side.</li>
<li>In the left panel of the Save As window that just opened, locate This PC or My Computer and click on it.</li>
<li>In the right panel, locate the C:\ drive and double-click on it. The C:\ drive is often named Local Drive or OS.</li>
<li>Locate the Student folder in the right-hand side panel and double-click on it.</li>
<li>Locate the ArcGISProCookbook folder and double-click on it.</li>
<li>Locate the My Projects folder and double-click on it.</li>
<li>In the File Name box located near the bottom of the Save As window, type <kbd>Street_Centerlines_Trippville</kbd> and click Save.</li>
<li>Verify that your Table to Excel tool looks like the following, and click Run:</li>
</ol>
<div><img class="alignnone size-full wp-image-882 image-border" height="249" src="img/db0dfdff-d510-4b35-898b-bd39ba5766cf.png" width="394"/></div>
<p style="padding-left: 60px">If the tool runs successfully it should create a new spreadsheet in the folder you designated. Now you will verify the results.</p>
<ol start="43">
<li>Open Windows Explorer or File Explorer like you did earlier in this recipe.</li>
<li>Using the same method you did in <em>steps 10-14</em> of this recipe, navigate to <kbd>C:\Student\ArcGISProCookbook\MyProjects</kbd>.</li>
<li>Locate the Street_Centerlines_Trippville.xls file that you just created and double-click on it to open the file.</li>
<li>Take a moment to examine the spreadsheet you created. It should look similar to the screenshot that follows. If you desire, open the Attribute Table for the Street_Centerlines layer in ArcGIS Pro and compare the two:</li>
</ol>
<div><img src="img/15e8756d-b09d-42bc-bfcc-888830b68f97.png"/></div>
<p>Exported spreadsheet</p>
<ol start="47">
<li>When you are done examining the contents of the spreadsheet, close it and your File Explorer window.</li>
<li>Return to ArcGIS Pro and save your project.</li>
<li>If you are not continuing on to the next recipe, close ArcGIS Pro. If you are, you may leave ArcGIS Pro open.</li>
</ol>
<p>You have now used two methods to export data from GIS to a format that can be opened by applications such as Microsoft Excel. This capability further expands the usefulness and flexibility of your GIS. It opens up the ability to integrate with other non-spatial applications.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Importing an Excel spreadsheet into ArcGIS Pro</h1>
                
            
            
                
<p>You have learned how to export data from GIS formats to a spreadsheet within ArcGIS Pro. But what if you need to go the other way? People use spreadsheets to store all kinds of information. This is because they are quick and easy to create and are very versatile. So, what does it take to bring one into your GIS using ArcGIS Pro?</p>
<p>When working with spreadsheets in ArcGIS Pro, remember, simpler is always better. ArcGIS Pro allows you to view XLS and XLSX files. It displays the spreadsheet as a database table. You can view, query, and link a spreadsheet. The linking is limited to using a join or a relate, which you learned about in <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <em>Linking Data together</em>.</p>
<p>There are some limitations when trying to use a spreadsheet in ArcGIS Pro. ArcGIS Pro treats a spreadsheet like a database table. So, it applies database limitations to the spreadsheet. This includes the following:</p>
<ul>
<li>The values in the first non-empty row in the spreadsheet become the field names.</li>
<li>Each column must have a unique name.</li>
<li>Each column cannot contain special characters. Underscores ( _ ) are allowed.</li>
<li>The field names (values in the first row) are limited to 64 characters.</li>
<li>No value in a cell can exceed 255 characters.</li>
<li>Each field must start with an Alpha character. It cannot start with a number.</li>
</ul>
<p>If the spreadsheet fails to meet any of these limitations, ArcGIS Pro will not allow you to view the spreadsheet. This means that you may need to customize or simplify the spreadsheet for it to work in ArcGIS Pro. Also, ArcGIS Pro will not allow you to edit a spreadsheet.</p>
<p>If you need to edit the data in a spreadsheet or make it a permanent part of your GIS data, you will need to convert it. ArcGIS Pro has a tool that converts the spreadsheet into a database table. This can be a dBase or standalone geodatabase table. </p>
<p>In this recipe, you will view a spreadsheet containing inspection information in ArcGIS Pro. This will start with you reviewing the contents of the spreadsheet in Excel or other spreadsheet application to ensure that it does not violate some of the limitations. Then you will open it in ArcGIS Pro.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>It is recommended that you complete all the recipes in <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <em>Linking Data together</em>, of this cookbook before you work this recipe. <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <em>Linking Data together</em>, will provide you with a better understanding of how to work with database tables in ArcGIS Pro. You will also need to have Microsoft Excel or a similar spreadsheet application installed. This recipe can be completed with all license levels of ArcGIS Pro.   </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Open Windows/File Explorer. It should be an icon that looks like a file folder on your Taskbar.</li>
<li>In the panel on the left, expand the contents of This PC or My Computer, depending on your operating system.</li>
<li>Locate and expand the C:\ drive, which is typically labeled as OS or Local Drive.</li>
<li>Click on the Student folder so that its contents appear in the right-hand side panel.</li>
<li>Double-click on the ArcGISProCookbook folder</li>
<li>Double-click on the Chapter7 folder.</li>
</ol>
<ol start="7">
<li>Double-click on the Inspections2016to2017.xls file to open it. The spreadsheet should open in your spreadsheet application such as Microsoft Excel. It should look like the screenshot that follows:</li>
</ol>
<div><img src="img/6555e742-8d02-4eff-8613-1982edfb0f2e.png"/></div>
<p>Inspection spreadsheet</p>
<ol start="8">
<li>Review the spreadsheet, comparing it to the limitations listed in the opening of the recipe. Then answer the following questions:</li>
</ol>
<div><p><strong>Question</strong>: What are the values in the first row, which will become the column names when you open the spreadsheet in ArcGIS Pro?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: Is each value in the first row unique?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: Do the values in the first row contain any special characters?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: Do any of the values in the first row exceed 64 characters?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: Do any of the values in any cell exceed 255 characters? </p>
<p><strong>Answer</strong>: </p>
</div>
<p style="padding-left: 60px">As you can see, this is a simple spreadsheet. It does not contain a lot of title information or complicated equations which can cause issues in ArcGIS Pro. As a matter of fact, it meets most of the restrictions required by ArcGIS Pro. However, several of the values in the first row do violate the restrictions because they contain special characters (spaces). You will need to adjust these before you can bring the spreadsheet into ArcGIS Pro.</p>
<ol start="9">
<li>You need to change the value in cell A1. Replace <kbd>Inspection ID</kbd> with <kbd>Insp_ID</kbd>.</li>
<li>Replace <kbd>Date of Inspection</kbd> in cell C1 with <kbd>Date_Insp</kbd>.</li>
<li>Replace <kbd>Inspection Results</kbd> in cell D1 with <kbd>Insp_results</kbd>.</li>
<li>Replace <kbd>Inspection Type</kbd> in cell E1 with <kbd>Insp_Typ</kbd>.</li>
<li>Verify that you have properly replaced the values in row 1, and then save the spreadsheet and close it:</li>
</ol>
<div><strong><img src="img/de0622a5-e810-436d-96d9-c6d152fc170f.png"/></strong></div>
<ol start="14">
<li>Start ArcGIS Pro and open the <kbd>Import Spreadsheet.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter7</kbd> using the skills you have learned in past recipes. The project should open with the City of Trippville map.</li>
<li>You will now add the spreadsheet you just edited to ArcGIS Pro. Click on the Add Data button in the Layer group on the Map tab in the ribbon.</li>
<li>In the panel on the left side, expand the Computer option so you can see its contents.</li>
<li>Click on the C:\ drive so its contents appear in the right panel.</li>
<li>Scroll down in the right panel until you see the Student folder. Double-click on the Student folder.</li>
<li>Double-click on the ArcGISProCookbook folder.</li>
<li>Double-click on the Chapter7 folder.</li>
<li>Double-click on the Inspections2016to2017.xls file. Select the Inspections2016to2017$ worksheet and click OK. The worksheet should appear as a standalone table in the Contents pane.</li>
</ol>
<ol start="22">
<li>Right-click on the Inspoections2016to2017$ standalone table and select Open from the menu that appears. The worksheet opens as a table and should look very familiar. Notice the fields of information this workshop contains:</li>
</ol>
<div><strong><img src="img/55c5b0e5-8401-48f0-ac64-86bfd2412c1a.png"/></strong></div>
<p style="padding-left: 60px">If you look at the list of layers in the map, you will see an Inspections layer. This layer shows the locations of the inspections referenced in the worksheet you just brought into ArcGIS Pro. Now you will examine that layer:</p>
<ol start="23">
<li>In the Contents pane, right-click on the Inspections layer and select Attribute Table from the menu that appears.</li>
</ol>
<p style="padding-left: 60px">As you can see, this table is very simple. It only contains three fields, ObjectID, Shape, and InspID, so the layer only stores the location of each inspection. If you were to join it with the worksheet you added, then you would know a lot more about each inspection. This would in turn increase your ability to use the data in ArcGIS Pro. Now you will join the worksheet to the Inspections layer.</p>
<ol start="24">
<li>In the Contents pane, right-click on the Inspections layer, select Joins and Relates, and then Add Join, as illustrated in the following screenshot. This will open the Add Join tool in the Geoprocessing pane:</li>
</ol>
<div><img class="alignnone size-full wp-image-883 image-border" height="436" src="img/747749fd-5b21-4422-b1cb-6d6f838c01b2.png" width="399"/></div>
<ol start="25">
<li>The Layer Name or Table View should already be assigned. Click the drop-down arrow for the Input Join Field and select InspID from the list presented.</li>
<li>The Join Table should also be automatically assigned as the Inspections2016to2017$ worksheet because it is the only standalone table in your map. Click on the drop-down arrow for the Output Join Field and select Inspection_ID.</li>
</ol>
<ol start="27">
<li>Verify your Add Join Table tool looks like the following screenshot and click Run:</li>
</ol>
<div><strong><img height="258" src="img/22463cfb-fee0-4903-b532-542c4e977fc9.png" width="468"/></strong></div>
<ol start="28">
<li>Look back at the Inspections Attribute Table, which originally contained only two fields. Now you should see that the information from the worksheet has been added to that table.</li>
<li>Close the Geoprocessing pane.</li>
<li>Save your Project.</li>
</ol>
<p style="padding-left: 60px">Now that you have joined the worksheet data to the Inspections layer, you can use that additional information to label, symbolize, and query, just as if the additional information was part of the layer to start with. The one thing you cannot do is edit the information that comes from the worksheet in ArcGIS Pro. That requires you to convert it.</p>
<p style="padding-left: 60px">The method you use to convert it will depend on how you intend to use the data from the spreadsheet. If you want to keep the spreadsheet data in a separate table, you can use the Excel to Table tool. If you wish to permanently join the data to the layer, you can export the joined layer to a new feature class. You will do both now.</p>
<ol start="31">
<li>Right-click on the Inspections layer and go to Data in the menu that appears. Then select the Export Features option, as illustrated in the following screenshot. This will open the Copy Features tool in the Geoprocessing pane.</li>
</ol>
<div><img class="alignnone size-full wp-image-884 image-border" height="624" src="img/a2b2246a-1183-4f5e-be36-02ec7b165fa4.png" width="413"/></div>
<ol start="32">
<li>The Input Features value should be automatically populated. Click the Browse button at the end of the Output Features Class cell.</li>
<li>Select the Databases folder under Project in the left panel of the Output Feature Class window.</li>
<li>Double-click on the Trippville_GIS.gdb geodatabase in the right panel of the window. Then, in the Name cell near the bottom of the window, type <kbd>Inspections_more_data</kbd> and click the Save button.</li>
<li>Verify that your Copy Features tool looks like the following screenshot and click Run:</li>
</ol>
<div><strong><img src="img/137ccaf0-0a41-4f51-966c-1f28fbee3d9d.png"/></strong></div>
<p>Copy Features tool in the Geoprocessing pane</p>
<ol start="36">
<li>Close the Geoprocessing pane.</li>
<li>The new Inspections_more_data layer should appear in the Contents pane. Open the Attribute Table for this new layer and answer the following question:</li>
</ol>
<div><p><strong>Question</strong>: What attribute fields does the layer you created contain?</p>
<p><strong>Answer</strong>: </p>
</div>
<p style="padding-left: 60px">As you can see, the new layer contains all the information that was in the Attribute Table for the Inspections layer and the Inspections2016to2017$ worksheet standalone table. Now that all that information is part of a single layer, you can edit all the data.</p>
<ol start="38">
<li>Save your project using the Save button on the Quick Access toolbar.</li>
</ol>
<p>The ability to import and use data from outside sources greatly increases the flexibility of your GIS.  It can provide you with access to a plethora of new information to include in your analysis. </p>


            

            
        
    

        

                            
                    <h1 class="header-title">There’s more…</h1>
                
            
            
                
<p>You just joined a spreadsheet to the Inspections layer, and then exported that to a new feature class which contains the combined information from both the joined sources. But what if you wanted the Inspections layer and the data from the spreadsheet to remain separate but still be editable from ArcGIS? How would you do that?</p>
<p>In that case, you would want to convert the spreadsheet to a true standalone database table. This would allow the two to remain separate, but they could still be joined as needed or maybe even a relationship class could be set up between them. Keeping them separate would have other advantages as well. First, you could easily replace the standalone table with a new copy of the spreadsheet as needed if your organization wanted to continue to input data through the spreadsheet. Being a standalone table, you could share just the table with others for editing and updating via web forms or mobile applications. These are just a few of the advantages.</p>
<p>Let’s look at how you would export the spreadsheet to a standalone table in your GIS database:</p>
<ol>
<li>Click on the Analysis tab in the ribbon.</li>
<li>Click on the Tools button in the Geoprocessing group on the Analysis tab. This will open the Geoprocessing pane once again.</li>
<li>If required, click on the Toolboxes tab located near the top of the Geoprocessing pane.</li>
</ol>
<ol start="4">
<li>Locate and expand the Conversion Tools toolbox.</li>
<li>Locate and expand the Excel toolset in the Conversion Tools toolbox.</li>
</ol>
<ol start="6">
<li>You should see two tools, Excel to Table and Table to Excel. You used the Table to Excel Python tool in the previous recipe. Now you will use the Excel to Table tool. Click on the Excel to Table tool. This will open the tool in the Geoprocessing pane.</li>
<li>Click on the Browse button for the Input Excel File. This will open a new window that allows you to navigate to the Excel file you will convert.</li>
<li>In the panel on the left, locate and expand This PC or My Computer.</li>
<li>Select C:\, which is typically labeled OS or Local Drive. The contents of the C:\ drive should appear in the panel on the right.</li>
<li>Scroll down until you see the Student folder, then double-click on the Student folder.</li>
<li>Double-click on the ArcGISProCookbook folder.</li>
<li>Double-click on the Chapter7 folder.</li>
<li>Select the Inspections2016to2017.xls file and click the Open button.</li>
</ol>
<div><p>Do not double-click on the Inspections2016to2017.xls file. That will open its contents and not select it, as desired. This will cause the tool to ultimately fail. </p>
</div>
<ol start="14">
<li>Click the Browse button for the Output Table.</li>
<li>Click on the Databases folder in the left panel of the Output Table window, located under Project.</li>
<li>Double-click on the Trippville_GIS.gdb geodatabase.</li>
<li>In the Name cell, near the bottom of the Output Table window, type <kbd>Inspections_2016_2017</kbd>. Then click the Save button.</li>
</ol>
<ol start="18">
<li>Verify that your Excel to Table tool looks like the following, and click Run:</li>
</ol>
<div><strong><img height="322" src="img/e8569007-dd96-4c89-88d1-271bf9f8744f.png" width="582"/></strong></div>
<p>Excel to Table tool in the Geoprocessing pane to import the spreadsheet into a geodatabase</p>
<p style="padding-left: 60px">When the tool is complete, a new standalone table will appear in the Contents pane. This is the new table that you just created. Now you will remove the join between the Inspections layer and the spreadsheet, and replace it with a join to the new table:</p>
<ol start="19">
<li>Right-click on the Inspections layer and go to Joins and Relates in the menu that appears. Select Remove Join, as illustrated in the following screenshot. This will open the Remove Join tool in the Geoprocessing pane:</li>
</ol>
<div><strong><img height="299" src="img/bcd3aeea-b8dc-4de6-900c-f828201a65be.png" width="463"/></strong></div>
<p>Removing the data table joins </p>
<ol start="20">
<li>All the required parameters should be automatically populated, since there is only one join in place associated with the Inspections layer. So verify that your Remove Join tool looks like the following screenshot and click Run:</li>
</ol>
<div><strong><img height="279" src="img/bbc114ad-4d0a-4702-a44c-02ae7ceea217.png" width="506"/></strong></div>
<div><p style="padding-left: 60px">You can join or relate multiple tables to a single layer or table if needed within ArcGIS Pro. However, be careful how many you join or relate as it can have a negative impact on performance and become difficult to manage.</p>
</div>
<ol start="21">
<li>Using the skills you learned in <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <em>Linking Data together</em>, and earlier in this recipe, join the Inspections_2016_2017 standalone table to the Inspections layer.</li>
<li>Right-click on the Inspections2016to2017$ standalone table and select Remove. This will remove the table from the map, but does not delete the file.</li>
<li>Open the Attribute Table for the Inspections layer and verify the data from the Inspections_2016_2017 is joined.</li>
<li>Close the Geoprocessing pane and any open tables that you are viewing.</li>
<li>Save your project and close ArcGIS Pro.</li>
</ol>


            

            
        
    

        

                            
                    <h1 class="header-title">Importing selected features into an existing layer</h1>
                
            
            
                
<p>Throughout this chapter, you have learned various methods for importing entire datasets into your geodatabase or exporting from your geodatabase to other formats. What if you only want to import a few selected features or records?</p>
<p>By default, the geoprocessing tools you have already used, such as Copy Features, Merge, Append, and Excel to table, will automatically be limited to selected features or records if you have them selected. However, most of these tools create new feature classes or tables. They do not just add data to an existing dataset. ArcGIS Pro will allow you to copy data from one layer and paste it into another existing layer. This allows you to choose exactly which features you want to convert or import.</p>
<p>In this recipe you will copy records from a shapefile and paste them into an existing layer which points to a geodatabase feature class. You will do this by first performing a query to select the features in the shapefile you wish to import into the existing geodatabase layer. Then you will copy and paste those features from the shapefile into the geodatabase layer. The shapefile you are working with represents a new subdivision being constructed in the City of Trippville.</p>


            

            
        
    

        

                            
                    <h1 class="header-title">Getting ready</h1>
                
            
            
                
<p>You are not required to have completed previous recipes in order to complete this one. This recipe can be completed with all license levels of ArcGIS Pro. You will need to ensure the sample data for the book has been installed. It is assumed that by this point you have completed some recipes from the book or at least have worked with ArcGIS Pro in the past and know how to open an existing project.  </p>


            

            
        
    

        

                            
                    <h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Start ArcGIS Pro and open the <kbd>Convert Selected Data.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter7</kbd> using the skills you have learned in past recipes.</li>
<li>Notice the large parcel in the center of the map view. This is the parcel that is going to become the new subdivision. In the Contents pane select the List by Draw Order button. It is the first button on the left side.</li>
</ol>
<ol start="3">
<li>Turn on the New Subdivision Shapefile layer. Once it is visible you will be able to see the new subdivision.</li>
<li>The new project should open with the City of Trippville map zoomed to the area for the new subdivision. Click on the List by Editing button in the Contents pane. The buttons icon looks like a pencil.</li>
<li>Right-click on the Street Rights of Way layer and select Make this the only editable layer from the menu that appears, as illustrated here:</li>
</ol>
<div><img class="alignnone size-full wp-image-885 image-border" height="345" src="img/6a1398ce-483a-46f5-aa73-2e57e374aad6.png" width="441"/></div>
<ol start="6">
<li>Click on the List by Selection button in the Contents pane. It is located to the left of the List by Editing button.</li>
<li>Click on the Map tab in the ribbon. Select the Select by Attribute tool in the Selection group. This will open the Select Layer by Attribute tool in the Geoprocessing pane.</li>
<li>Click on the drop-down arrow for the Layer Name and Table View. Select the New Subdivision Shapefile from the list presented.</li>
<li>Ensure the Selection Type is set to New Selection.</li>
<li>Click on the Add Clause button.</li>
</ol>
<ol start="6">
<li>Build your expression as shown in the following screenshot, and click the Add button:</li>
</ol>
<div><strong><img src="img/b037bce4-edbb-40dc-aad3-685f47a8e857.png"/></strong></div>
<ol start="12">
<li>Click the Verify button, which looks like a green check mark, below the selection expression you just created. If it says The SQL expression is valid, click the Run button. This will select all the lines in the New Subdivision Shapefile that are attributed as being RW, which stands for Rights of Way.</li>
</ol>
<p style="padding-left: 60px">You should have 258 features selected, which you can verify by looking in the Contents pane. You should see the number of selected features next to the New Subdivision Shapefile layer. The selected features will be highlighted in the map, as shown the following screenshot:</p>
<div><img src="img/5414ca9b-423b-4562-986c-62b0def3c84f.png"/></div>
<p>Selected street rights of way lines</p>
<p style="padding-left: 60px">Now, you will copy the features you have selected and paste them to the Street Rights of Way layer.</p>
<ol start="13">
<li>Click on the Edit tab in the ribbon.</li>
<li>Click on the Select tool in the Selection group on the Edit tab.</li>
<li>Click on the Copy button located in the Clipboard group on the Edit tab.</li>
</ol>
<ol start="16">
<li>Click on the drop-down arrow located below the Paste tool in the Clipboard group on the Edit tab, and select Paste Special, as illustrated in the following screenshot:</li>
</ol>
<div><strong><img height="146" src="img/8a6429d4-7c30-4901-b51f-52adc78c38e2.png" width="269"/></strong></div>
<ol start="17">
<li>Ensure the Paste into Template is set to Street Rights of Way, as shown in the following screenshot, and click OK:</li>
</ol>
<div><img class="alignnone size-full wp-image-886 image-border" height="168" src="img/8c4d2671-46b6-4fb4-a85d-62fda352d55b.png" width="214"/></div>
<ol start="18">
<li>Look in the Contents pane. Notice that there are now no features selected in the New Subdivision Shapefile layer. Instead, there are now 258 features selected in the Street Rights of Way layer. You just copied the features from one layer and pasted them into another existing layer.</li>
<li>Click on the Clear button, located in the Selection group on the Edit tab in the ribbon, to clear your selected features.</li>
</ol>
<ol start="20">
<li>In the Contents pane, click on the List by Draw Order button and turn off the New Subdivision Shapefile layer to verify that you did successfully copy the features to the Street Rights of Way layer.</li>
<li>Click the Save button in the Manage Edits group on the Edit tab in the ribbon to save the new features you just copied into the Street Rights of Way layer. When asked to save all edits, click Yes.</li>
<li>Save your project and close ArcGIS Pro.</li>
</ol>
<p>This method will allow you to copy features from layers that reference CAD files (DWG, DGN, or DXF), shapefiles, and geodatabase feature classes to another layer as long as the layer references a shapefile or geodatabase feature class.</p>


            

            
        
    </body></html>