<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Converting Data</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following recipes:</p>
<ul>
<li>Converting shapefiles to a Geodatabase feature class</li>
<li>Merging multiple shapefiles into a single geodatabase feature class</li>
<li>Exporting tabular data to an Excel spreadsheet</li>
<li>Importing an Excel spreadsheet into ArcGIS Pro</li>
<li>Importing selected features into an existing layer</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>As you may have noticed by now, GIS data comes in many formats. There are geodatabases, shapefiles, CAD files, DBF files, rasters, spreadsheets, and more. ArcGIS Pro allows you to use all of these. However, there are limits to what ArcGIS Pro allows you to do with some of these formats. Some of these are read only, such as CAD files or spreadsheets. Others you can read and edit, such as shapefiles and geodatabases. Also, if you have data spread across multiple locations, formats, and files, it can make it difficult to use.</p>
<p>If you are going to be editing and analyzing data, it is recommended that you consolidate all the required data into a single format. For ArcGIS Pro, the primary storage format is the geodatabase. Shapefiles are generally considered a secondary option. In order to consolidate your data sources, you may need to convert and combine data from one or more sources into a single source. ArcGIS Pro provides several methods and tools to accomplish this. Which one works best will depend on several factors, including:</p>
<ul>
<li>The existing data format</li>
<li>The target data format</li>
<li>How much data needs to be converted and the number of files?</li>
<li>Are you performing a wholesale conversion or do you need to select specific features?</li>
<li>Are you trying to combine multiple files into one?</li>
<li>Are you importing into the GIS or exporting out to use in another application?</li>
</ul>
<p>All of these considerations will help to determine which conversion method and tools will work best for your situation.</p>
<p>In this chapter, you will learn several different methods and tools that will allow you to convert and combine data within ArcGIS Pro. You will start by learning how to convert a simple shapefile into a new geodatabase feature class. Then you will expand those skills to learn how to merge multiple shapefiles into a single geodatabase feature class.</p>
<p>Next, you will learn how to export tabular data in your GIS to a spreadsheet, so you can easily include it in a report or perform additional calculations. Then you will reverse that workflow and import a spreadsheet into your GIS.</p>
<p>From there, you will learn how you can convert specific features from one source into another. The method you will learn provides you with a high level of control and accuracy when converting data.</p>
<p>Lastly, you will learn how to georeference CAD and raster files so that they are located in the proper location according to a specific coordinate system. This will make converting that data much easier.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Converting shapefiles to a geodatabase feature class</h1>
                </header>
            
            <article>
                
<p>Shapefiles are one of the most common GIS data formats you will encounter during your career in GIS. Just about every GIS-enabled application can read, import, export, and edit a shapefile. This includes applications such as QGIS, AutoCAD Map 3D, Civil 3D, Geomedia, and many others. This has resulted in shapefiles becoming a common format for sharing GIS data with multiple platforms. It is not uncommon to receive data from engineering, planning, and surveying firms in a shapefile format.</p>
<p>In this recipe, you will receive a shapefile containing the location of several stormwater drainage structures, which were collected by a local surveying firm. You will integrate this shapefile into the geodatabase for the City of Trippville.   </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe does require the sample data be installed on the computer. While it is not required to have completed any previous recipes, it is recommended that you at least review <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <span><em>ArcGIS Pro Capabilities and Terminology</em>,</span> to ensure you have the proper skills required to successfully complete this recipe. You can complete this recipe with any ArcGIS Pro licensing level.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>You will need to launch ArcGIS Pro to begin this recipe.</li>
<li>In the <span class="packt_screen">ArcGIS Pro</span> start window, click on <span class="packt_screen">Open another project</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/abb24399-8cc0-427c-ae6f-1826608a35e1.png"/></div>
<ol start="3">
<li>Select <span class="packt_screen">Computer</span> from the <span class="packt_screen">Open</span> window and then click <span class="packt_screen">Browse</span> in the area on the right.</li>
<li>Navigate to <kbd>C:\Student\ArcGISProCookbook\Chapter7\Convert Single Shapefile</kbd> by clicking on <span class="packt_screen">C:\</span> in the area on the left of the <span class="packt_screen">Open Project</span> window. Then double-click on the <span class="packt_screen">Student</span>, <span class="packt_screen">ArcGISProCookbook</span>, <span class="packt_screen">Chapter7</span>, and <span class="packt_screen">Convert Single Shapefile</span> folders.</li>
<li>Select the <span class="packt_screen">Convert Single Shapefile.aprx</span> project file and click <span class="packt_screen">OK</span>.</li>
</ol>
<p style="padding-left: 60px">The project will open with the Trippville Stormwater Map visible. This is an existing map that was obviously created by someone else. You will notice, if you look at the <span class="packt_screen">Contents</span> pane, that the map does not contain any stormwater layers. You will add the shapefile you have received from the local surveying firm:</p>
<ol start="6">
<li>In the <span class="packt_screen">Catalog</span> pane, click on the small arrowhead located next to the <span class="packt_screen">Folders</span> folder so you can see its contents. Then expand the <span class="packt_screen">Convert Single Shapefile</span> folder so you can see its contents.</li>
<li>You should see the <span class="packt_screen">Stormwater_Structures.shp</span> file in the folder you just expanded. Before you use this file you should examine its metadata to ensure it is the one you are looking for.</li>
<li>Right-click on the <span class="packt_screen">Stormwater_structures.shp</span> file and select <span class="packt_screen">View Metadata</span> from the menu that appears, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-872 image-border" height="513" src="assets/8089e608-9208-4885-8195-0f06bbe6632b.png" width="249"/></div>
<div class="packt_tip">
<p>ArcGIS Pro uses different colored icons to identify data formats. Shapefiles are shown with a green icon, CAD files with a blue icon, and geodatabases with a gray icon. </p>
</div>
<p style="padding-left: 60px">The <span class="packt_screen">Catalog</span> view should open, displaying the metadata for the shapefile you selected. This will provide you with basic information concerning the shapefile. </p>
<div class="packt_infobox">
<p>Metadata is data about your data. It provides information about how the data was created, when it was created, how often it is updated, what its intended purpose is, and more. It is considered best practice to create and maintain metadata for all GIS datasets. However, it is not uncommon to find data without metadata. This is especially true of shapefiles, since they must be manually created and maintained. ArcGIS will automatically create at least some metadata for geodatabase feature classes and tables.</p>
</div>
<ol start="9">
<li>Take a moment to read over the metadata for the shapefile. When done, close the <span class="packt_screen">Catalog</span> view by clicking on the <span class="packt_screen">x</span> in the tab entitled <span class="packt_screen">Catalog</span> at the top of the view area. This should return you to the map.</li>
<li>Now it is time to add the shapefile to the map. Right-click on the <span class="packt_screen">Stormwater_Structures.shp</span> file and select <span class="packt_screen">Add to Current Map</span> from the menu that appears, as illustrated here:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-873 image-border" height="321" src="assets/db8e95e4-67f4-4bd3-8159-3928d7eaf756.png" width="288"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Add new layer to current map from Catalog pane</div>
<p style="padding-left: 60px">The <span class="packt_screen">Stormwater Structures</span> layer should now appear in your <span class="packt_screen">Contents</span> pane. Next you will review the attribute data associated with the layer you just added.</p>
<ol start="11">
<li>Right-click on the <span class="packt_screen">Stormwater_Structures</span> layer in the <span class="packt_screen">Contents</span> pane. Select the <span class="packt_screen">Attribute Table</span>, as shown in the following screenshot. This will open the attribute table for the shapefile below the map view unless you have moved the table window to another location:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="309" src="assets/17df8095-3411-426a-ac45-c8034b808b05.png" width="308"/></div>
<div class="packt_infobox">
<p><strong>Question</strong>: What fields are located in the attribute table for the shapefile?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong><span>: </span>How many structures/features are stored in the shapefile?</p>
<p><strong>Answer</strong><span>: </span></p>
</div>
<p style="padding-left: 60px">The table window is dockable and undockable, so, you can move it wherever you wish, including to another monitor. Unlike ArcMap, ArcGIS Pro allows you to open each table in its own window, providing greater viewing flexibility.</p>
<p style="padding-left: 60px">You should see only four fields in the attribute table, FID, Shape, Id, and Typ. The FID and Shape are default fields for a shapefile. The Id and Typ are user-defined fields. Default fields are created and maintained by the software that created the data. User-defined fields are those created and maintained by users. The default and user-defined fields will vary from application to application and format to format.</p>
<p style="padding-left: 60px">The Typ field identifies the type of structure, CB is a catch basin, AD is an area drain, DI is a drop inlet. These are all common stormwater drainage structures. </p>
<p style="padding-left: 60px">After viewing the metadata and the attribute fields, you now have a better understanding of the data you will be converting. It is always good to make sure you know the data you are working with before you start using it to perform analysis or create maps.</p>
<ol start="12">
<li>Close the <span class="packt_screen">Table</span> window by clicking on the <span class="packt_screen">x</span> in the tab labeled <span class="packt_screen">Stormwater_Structures</span>. Now the map should fill the entire view area once more.</li>
<li>In the <span class="packt_screen">Catalog</span> pane, expand the <span class="packt_screen">Databases</span> folder so you can see its contents.</li>
<li>Expand the <span class="packt_screen">Trippville_GIS.gdb</span> geodatabase by clicking on the small arrowhead located to the left of the database name.</li>
<li>Look at the contents of the geodatabase. You should notice that there are three feature datasets included: <span class="packt_screen">Base</span>, <span class="packt_screen">Sewer</span>, and <span class="packt_screen">Water</span>.</li>
</ol>
<div class="packt_infobox">
<p>Feature datasets serve several purposes within a geodatabase. First, they help you better organize related data. Second, they ensure all data stored within them shares a common spatial reference, which means they are all in the same coordinate system. This allows the data to take part in topologies and geometric networks which are used to ensure data quality and provide additional functionality.</p>
<p>Early versions of ArcGIS Pro do not support Geometric networks, but version 2.1 and later will. Geometric Networks will be renamed to Utility Network. The Utility Network will allow you to trace your utility network and perform various types of analysis. To learn more about the Utility Network, go to <a href="http://www.esri.com/esri-news/arcnews/spring17articles/introducing-utility-network-for-arcgis">http://www.esri.com/esri-news/arcnews/spring17articles/introducing-utility-network-for-arcgis</a>.</p>
</div>
<p style="padding-left: 60px">Before you convert the <span class="packt_screen">Stormwater_Structures</span> shapefile into a geodatabase feature class, you will create a new feature dataset for the stormwater system. This will allow you to easily find the data in the geodatabase later and allow you to create a utility network in the future if you need to.</p>
<ol start="16">
<li>In the <span class="packt_screen">Catalog</span> pane, right-click on the <span class="packt_screen">Trippville_GIS.gdb</span> geodatabase. In the menu that appears, go to <span class="packt_screen">New</span> and select <span class="packt_screen">Feature Dataset</span>, as illustrated in the following screenshot. This will open the <span class="packt_screen">Create Feature Dataset</span> tool in the <span class="packt_screen">Geoprocessing</span> pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-874 image-border" height="316" src="assets/90ea7d3e-2c11-4c25-8391-a74186a6dbfd.png" width="414"/></div>
<ol start="17">
<li>The <span class="packt_screen">Output Geodatabase</span> should automatically be set to <span class="packt_screen">Trippville_GIS.gdb</span> because it was the one you selected and right-clicked on. For the <span class="packt_screen">Feature Dataset Name</span>, type <kbd>Stormwater</kbd>.</li>
</ol>
<ol start="18">
<li>Under the <span class="packt_screen">Coordinate System</span> option, click on the small drop-down arrow located on the far-right side of the cell. Select <span class="packt_screen">Street Rights of Way</span> from the list, as shown here:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-875 image-border" height="242" src="assets/b2f8f7cb-0ef2-42ab-a0da-d82539a910f2.png" width="429"/></div>
<p style="padding-left: 60px">The <span class="packt_screen">Coordinate System</span> should now be set to <span class="packt_screen">NAD_1983_StatePlane_Georgia_West_FIPS_1002_Feet</span>.</p>
<ol start="19">
<li>Verify that the <span class="packt_screen">Create Feature Dataset</span> tool looks like the screenshot that follows. If it does, click the <span class="packt_screen">Run</span> button located at the bottom of the pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-876 image-border" height="221" src="assets/8d0c9c62-27df-49c9-b680-6521fb88f61f.png" width="423"/></div>
<p style="padding-left: 60px">When the tool finishes, you should see the new feature dataset that you just created appear in the <span class="packt_screen">Trippville_GIS.gdb</span> geodatabase. You will convert the shapefile containing the stormwater structures to a new feature class which will be stored in the feature dataset you just created.</p>
<ol start="20">
<li>In the <span class="packt_screen">Contents</span> pane, right-click on the <span class="packt_screen">Stormwater_Structures</span> layer. In the menu that appears, go to <span class="packt_screen">Data</span> and select the <span class="packt_screen">Export Features</span> option as illustrated in the following screenshot. This will open the <span class="packt_screen">Copy Features</span> tool in the <span class="packt_screen">Geoprocessing</span> pane. This normally appears on the right side of the interface:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="453" src="assets/70c2883b-97ad-4f27-9d27-0f0816ee967b.png" width="354"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Exporting features from the Contents pane</div>
<ol start="21">
<li>The <span class="packt_screen">Input Features</span> should automatically be set because you right-clicked on a specific layer to access the tool. Click the <span class="packt_screen">Browse</span> button located on the far-right side of the <span class="packt_screen">Output Feature Class</span>.</li>
<li>In the <span class="packt_screen">Output Feature Class</span> window that opens, select the <span class="packt_screen">Databases</span> folder located under <span class="packt_screen">Project</span> in the left panel of the window. Two databases should appear in the right panel: <span class="packt_screen">Convert Single Shapefile.gdb</span> and <span class="packt_screen">Trippville_GIS.gdb</span>.</li>
<li>Double-click on the <span class="packt_screen">Trippville_GIS</span> geodatabase.</li>
<li>Double-click on the <span class="packt_screen">Stormwater</span> feature dataset that you created earlier.</li>
<li>In the <span class="packt_screen">Name</span> cell located near the bottom of the <span class="packt_screen">Output Feature Class</span> window, type <kbd>Stormwater_Structures</kbd> and click <span class="packt_screen">Save</span>.</li>
<li>Verify that the <span class="packt_screen">Copy Features</span> tool looks like the screenshot, and click the <span class="packt_screen">Run</span> button:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-877 image-border" height="269" src="assets/cc400956-f03a-4672-afb8-800d49503ef9.png" width="398"/></div>
<p style="padding-left: 60px">If the tool ran successfully, a new layer should appear in your map. Now you will verify that ArcGIS Pro converted the shapefile successfully.</p>
<ol start="27">
<li>Close the <span class="packt_screen">Geoprocessing</span> pane by clicking on the small <span class="packt_screen">x</span> located in the upper-right corner of the pane.</li>
<li>In the <span class="packt_screen">Contents</span> pane, click on the <span class="packt_screen">List by Source</span> button. It should be the second one from the left and looks like a cylinder.</li>
</ol>
<ol start="29">
<li>Notice that you have two <span class="packt_screen">Stormwater_Structures</span> layers. However, they are in two different locations.</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong>: Where are the two stormwater_structures stored?</p>
<p><strong>Answer</strong><span>: </span></p>
</div>
<p style="padding-left: 60px">As you can see, one of the stormwater_structures layers is stored in the <span class="packt_screen">Trippville GIS</span> geodatabase. The other is stored in the <span class="packt_screen">Convert Single Shapefile</span> folder. The one in the geodatabase is the one you just converted. The other is the original shapefile. The Copy Features tool created a new feature class in the geodatabase and left the source shapefile alone. Now that you have verified that it did create the feature class in the geodatabase, you need to verify that it converted all the features.  </p>
<ol start="30">
<li>Right-click on the <span class="packt_screen">Stormwater_Structures</span> layer, which is stored in the <span class="packt_screen">Trippville_GIS.gdb</span>, and select <span class="packt_screen">Attribute Table</span> from the menu that appears.</li>
<li>Look at the bottom of the table window to see the total number of records/features contained in the layer.</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong>: Does it match the number of features that were in the Shapefile? (Look back to earlier in this recipe when you opened the attribute table for the shapefile and answered the question of how many features were stored in it if you don’t remember.)</p>
<p><strong>Answer</strong>:</p>
</div>
<p style="padding-left: 60px">Both the shapefile and geodatabase feature class should contain the same number of records/features if the Copy Features tool worked correctly.</p>
<ol start="32">
<li>Right-click on the <span class="packt_screen">Stormwater_Structures</span> shapefile layer in the <span class="packt_screen">Contents</span> pane, and select <span class="packt_screen">Remove</span> from the menu that appears. You no longer need the shapefile layer in your map.</li>
<li>Click on the <span class="packt_screen">Save Project</span> button located in the Quick Access menu at the top left of the ArcGIS Pro interface.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There’s more…</h1>
                </header>
            
            <article>
                
<p>As with most things you can do in ArcGIS Pro, there is more than one way to accomplish a task. Converting a Shapefile to a geodatabase feature class is no exception. For example, you could have accessed the <span class="packt_screen">Copy Features</span> tool directly from the <span class="packt_screen">Data Management Tools</span> toolbox and the <span class="packt_screen">Features</span> toolset in the <span class="packt_screen">Geoprocessing</span> pane.</p>
<p>There is also a third way that you can convert shapefiles to a geodatabase feature class. You can use the Feature Class to Feature Class geoprocessing tool as well. Let's take a look at how that works.</p>
<p>You have received a shapefile containing stormwater drainage pipes from the same local surveying firm. You want to convert those into the feature dataset that you created earlier in this recipe:</p>
<ol>
<li>In the <span class="packt_screen">Catalog</span> pane, expand the contents of the <span class="packt_screen">Trippville_GIS.gdb</span> if needed. It may still be expanded from your previous work.</li>
<li>Right-click on the <span class="packt_screen">Stormwater feature dataset</span>. Select <span class="packt_screen">Import</span> and <span class="packt_screen">Feature Class…</span>. This will open the <span class="packt_screen">Feature Class to Feature Class</span> conversion tool in the <span class="packt_screen">Geoprocessing</span> pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-878 image-border" height="325" src="assets/aa88b8b7-fd31-409e-b41f-76912dcc5be2.png" width="347"/></div>
<ol start="3">
<li>The <span class="packt_screen">Output Location</span> should already be set. Click on the <span class="packt_screen">Browse</span> button at the far-right end of the <span class="packt_screen">Input Features</span>.</li>
<li>In the <span class="packt_screen">Input features</span> window, select the <span class="packt_screen">Folders</span> folder in the left panel under <span class="packt_screen">Project</span>. The <span class="packt_screen">Convert Single Shapefile</span> folder should appear in the right panel of the window.</li>
<li>Double-click on the <span class="packt_screen">Convert Single Shapefile</span> folder.</li>
<li>Click on <span class="packt_screen">Stormwater_Pipes.shp</span> and click <span class="packt_screen">OK</span>.</li>
<li>Set the <span class="packt_screen">Output Feature Class</span> to <kbd>Pipes</kbd>. You will not need to change any other tool settings.</li>
<li>Verify that your <span class="packt_screen">Feature Class to Feature Class</span> tool looks like the following, and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-879 image-border" height="430" src="assets/a8e599b8-391a-406a-8cfa-f90c0e6d0aad.png" width="281"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Feature class to feature class conversion tool</div>
<ol start="9">
<li>If the tool is successful, a new <span class="packt_screen">Pipes</span> layer should appear in your map. This new layer points to a new feature class, you just created in the <span class="packt_screen">Trippville_GIS</span> geodatabase.</li>
<li>Let’s verify that the tool did create a new feature class. In the <span class="packt_screen">Catalog</span> pane, expand the <span class="packt_screen">Databases</span> folder, then expand the <span class="packt_screen">Trippville_GIS.gdb</span> geodatabase and the Stormwater feature dataset.</li>
<li>Verify that you see the <span class="packt_screen">Pipes</span> feature class.</li>
<li>If you do, close the <span class="packt_screen">Geoprocessing</span> pane and save your project.</li>
</ol>
<div class="packt_tip">
<p>If any geoprocessing tool, such as the Feature Class to Feature Class tool, fails, you can always click on the <span class="packt_screen">History</span> tab in the <span class="packt_screen">Catalog</span> pane to review what happened. You can click on any geoprocessing operation you have performed during your ArcGIS Pro session and see if it was successful or not. If it was not, you can see the errors which were generated so you can troubleshoot why it did not work.</p>
</div>
<ol start="13">
<li>If you are not continuing to the next recipe you can close ArcGIS Pro. If you are continuing, keep ArcGIS Pro open.</li>
</ol>
<p>So, you have now seen two different tools you can use to convert shapefiles into geodatabase feature classes. These tools are not just limited to converting shapefiles. They can also convert other spatial data formats, including coverages, DWGs, DGNs, DXFs, and more as well.   </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Merging multiple shapefiles into a single geodatabase feature class</h1>
                </header>
            
            <article>
                
<p>You now know how to convert a single shapefile into an individual geodatabase feature class. What if you have several shapefiles that you need to merge into a single common geodatabase feature class? Can you do that in ArcGIS Pro?</p>
<p>Of course you can. This is not an uncommon workflow. You often need to combine multiple shapefiles or geodatabase feature classes into a single feature class. Combining multiple sources into a single one makes working with the data easier. For example, you are working on a regional transportation study and you receive road data from three counties. If you wish to analyze traffic flow or calculate the total length of roads by type for the region, it would be much easier to do if all the data was in a single feature class. Maybe you are responsible for maintaining data for a 911 center that services both the city and county. The city and county assign addresses for new construction and update the address point file for their respective jurisdiction. You would need to combine these two files for use in the 911 software. These are just two possible examples of situations where you would want to combine multiple shapefiles or geodatabase feature classes together into one.</p>
<p>In this recipe, you will merge three different shapefiles into a single common geodatabase feature class. You have had three field crews out collecting the location of street signs as part of a sign inventory the roads superintendent asked you to create. Each crew has collected the sign location data into a shapefile. So, you now have three separate shapefiles which need to be merged into a single geodatabase feature class. This will make the data much easier to manage and work with in the future.   </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe does require the sample data be installed on the computer. You do not need to complete any previous recipes. Though it is recommended that you review <a href="45fda239-2b00-4355-9553-6c6c2b69b0ab.xhtml">Chapter 1</a>, <em>ArcGIS Pro Capabilities and Terminology</em>, plus the previous recipe in this chapter, to ensure that you have a basic understanding of the skills required to complete this recipe. This recipe can be completed with any ArcGIS Pro licensing level. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>If you closed ArcGIS Pro before starting this recipe, you will need to start ArcGIS Pro.</li>
<li>Open the <kbd>Convert Multiple Shapefiles.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter7</kbd> using the skills you have learned in past recipes.</li>
</ol>
<p style="padding-left: 60px">The project should open with the Street Sign Inventory map. If you look in the <span class="packt_screen">Contents</span> pane you will see three <span class="packt_screen">Street_Signs</span> layers. These are the three shapefiles collected by your field crews. You will take a moment to investigate these three layers so you know what you have to work with.</p>
<ol start="3">
<li>Right-click on the <span class="packt_screen">Street_Signs_Day1</span> layer in the <span class="packt_screen">Contents</span> pane and select <span class="packt_screen">Attribute Table</span> from the menu that appears. Take a moment to investigate the Attribute Table and then answer the following questions:</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong>: What type of shapefile is this layer?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong><span>: </span>What attribute fields does it contain?</p>
<p><strong>Answer</strong><span>: </span></p>
</div>
<ol start="4">
<li>Repeat this process for the other two <span class="packt_screen">Street_Signs</span> layers. Compare the answers to the previous two questions with each of these layers. Note any similarities or differences.</li>
</ol>
<p style="padding-left: 60px">As you have just found out, all three layers are point features and have a common attribute table structure or schema. While a common schema is not always required when merging multiple fields together, it does often help. One thing that must match in order to merge multiple layers together is the feature type. You can only merge points with points, lines with lines, and polygons with polygons.</p>
<p style="padding-left: 60px">Now that you have verified that the feature types match and the attribute fields are the same, you are ready to merge the three layers together to create a single one:</p>
<ol start="5">
<li>Close the <span class="packt_screen">Attribute Tables</span> for the three <span class="packt_screen">Street_Signs</span> layers. This will free up some screen space.</li>
<li>Click on the <span class="packt_screen">Analysis</span> tab in the ribbon.</li>
<li>Click on the <span class="packt_screen">Tools</span> button in the <span class="packt_screen">Geoprocessing</span> group in the <span class="packt_screen">Analysis</span> tab. This will open the <span class="packt_screen">Geoprocessing</span> pane.</li>
</ol>
<ol start="8">
<li>Click on the <span class="packt_screen">Toolboxes</span> tab in the <span class="packt_screen">Geoprocessing</span> pane, as illustrated:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-880 image-border" height="203" src="assets/6aff7e48-dfe8-4961-970b-5a48a18e146d.png" width="373"/></div>
<ol start="9">
<li>In the Search box at the top of the <span class="packt_screen">Geoprocessing</span> page, type <kbd>Merge</kbd> and press your <em>Enter</em> key to locate the <span class="packt_screen">Merge</span> tool.</li>
<li>Select <span class="packt_screen">Merge (Data Management Tools)</span> from the list that is presented. It should be near the top, as shown in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="224" src="assets/ea385e39-0ba4-4333-8633-f270c1796cf6.png" width="357"/></strong></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Selecting the Merge tool in the Geoprocessing pane.</div>
<p style="padding-left: 60px">The <span class="packt_screen">Merge</span> <span class="packt_screen">geoprocessing</span> tool should now be open in the <span class="packt_screen">Geoprocessing</span> pane. This is the tool you will use to combine the three individual shapefiles.</p>
<ol start="11">
<li>Under <span class="packt_screen">Input Datasets</span>, click on the small drop-down arrow and select <span class="packt_screen">Street_Signs_Day1</span>. When you do that, another input box should appear below it, allowing you to add another input.</li>
<li>Click on the small drop-down arrow at the end of the second input box that appeared and select <span class="packt_screen">Street_Signs_Day2</span>.</li>
<li>Repeat that process to add <span class="packt_screen">Street_Signs_Day3</span> as the last input for the <span class="packt_screen">Merge</span> tool.</li>
<li>Click the <span class="packt_screen">Browse</span> button at the right side of the <span class="packt_screen">Output Dataset</span> box.</li>
<li>In the <span class="packt_screen">Output Dataset</span> window that appears, select <span class="packt_screen">Databases</span> from the panel on the left side of the window.</li>
<li>Double-click on the <span class="packt_screen">Trippville_GIS</span> geodatabase in the panel on the right side of the window.</li>
<li>In the <span class="packt_screen">Name</span> cell, type <kbd>StreetSigns</kbd> and click <span class="packt_screen">Save</span>.</li>
<li>Verify that your <span class="packt_screen">Merge</span> tool looks like the following screenshot. If it does, click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="344" src="assets/3ec4abbf-af65-467e-b729-15bce03abd74.png" width="376"/></strong></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">The Merge geoprocessing tool</div>
<p style="padding-left: 60px">When the tool runs successfully, you should see a new <span class="packt_screen">StreetSigns</span> layer added to your map. This new layer should cover all the points in the original three layers, but notice they still exist. The Merge tool, like most geoprocessing tools, creates new data and does not alter the original input data. But let’s verify that just to be sure.</p>
<ol start="19">
<li>Click on the List by Source tab located in the <span class="packt_screen">Contents</span> pane. It is the button that looks like a gray cylinder.</li>
<li>Locate all <span class="packt_screen">Street Signs</span> layers that are visible in the map. Note where their source is stored and answer the following questions:</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong><span>: </span>Where is the StreetSigns layer you that just created being stored?</p>
<p><strong>Answer</strong><span>: </span></p>
<p><strong>Question</strong><span>: </span>Where are the three Street_Signs shapefiles being stored? </p>
<p><strong>Answer</strong><span>: </span></p>
<p><strong>Question</strong>: Are these the same? </p>
<p><strong>Answer</strong><span>: </span></p>
</div>
<p style="padding-left: 60px">As you can now see, the <span class="packt_screen">StreetSigns</span> layer is referencing a geodatabase feature class that is being stored in the <span class="packt_screen">Trippville_GIS</span> geodatabase, whereas the shapefiles for the <span class="packt_screen">Street_Signs</span> shapefiles are stored in the <span class="packt_screen">Convert Single Shapefile</span> folder. These are two very different locations. Because we don’t see a red exclamation point located beside any of the layer names, we know the data sources still exist and none have been deleted.</p>
<div class="packt_tip">
<p>Any time that you see a red exclamation point located just before the layer name in the <span class="packt_screen">Contents</span> pane, you know that layer has lost the connection to its source data.</p>
</div>
<ol start="21">
<li>Right-click on each of the <span class="packt_screen">Street_Signs</span> layers and select <span class="packt_screen">Remove</span> from the menu that appears. This removes them from the map to reduce clutter and confusion. Removing a layer from the map does not delete the source data.</li>
<li>Right-click on the <span class="packt_screen">StreetSigns</span> layer and select <span class="packt_screen">Attribute Table</span> from the menu that appears.</li>
</ol>
<ol start="23">
<li>Review the <span class="packt_screen">Attribute Table</span> and compare it with what you saw when looking at the attribute tables for the shapefiles.</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong><span>: </span>How does the attribute table for the StreetSigns layer compare to the ones for the three shapefiles?</p>
<p><strong>Answer</strong>:</p>
</div>
<ol start="24">
<li>Save your project.</li>
</ol>
<p><span>As you can see, the Attribute Table for the new StreetSigns layer contains the same exact fields as the original three shapefiles. Also, the number of records equals the sum of the total records from the three shapefiles. The Merge geoprocessing tool combined the content, both spatial and attributes, of the three shapefiles into a single geodatabase feature class.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There’s more…</h1>
                </header>
            
            <article>
                
<p>The Merge geoprocessing tool works great if you want to combine multiple files or feature classes into a new single feature class. What if you want to add new data from a shapefile or geodatabase feature class to an existing layer of information? For example, your field crews go out and locate additional street signs. You would not want to create another layer. Instead you would want to add the new signs to the existing layer. How would you do that?</p>
<p>This is where the Append geoprocessing tool comes in to play. The Append tool will add new records from an input table, file, or feature class to an existing one. Let’s see it in action so you can gain a better understanding of how it works. You will append a new shapefile that contains additional sign locations to the StreetSigns layer you just created:</p>
<ol>
<li>Click on the <span class="packt_screen">Map</span> tab in the ribbon.</li>
<li>Click on the <span class="packt_screen">Add Data</span> button in the <span class="packt_screen">Layer</span> group on the <span class="packt_screen">Map</span> tab.</li>
<li>Click on the <span class="packt_screen">Folders</span> folder located under <span class="packt_screen">Project</span> in the panel on the left side of the <span class="packt_screen">Add Data</span> window.</li>
<li>Double-click on the <span class="packt_screen">Convert Single Shapefile</span> folder in the right-side panel.</li>
<li>Select the <span class="packt_screen">Street_Signs_Day4.shp</span> file and click <span class="packt_screen">OK</span> to add the shapefile as a layer to the map.</li>
</ol>
<ol start="6">
<li>Right-click on the <span class="packt_screen">Street_Signs_Day4</span> layer you just added to your map, and select <span class="packt_screen">Zoom to Layer</span> from the menu that is presented. This will allow you to more easily see the layer you just added. As you can see, this layer contains data for more signs located on the west side of the city.</li>
<li>Open the <span class="packt_screen">Attribute Table</span> for the <span class="packt_screen">Street_Signs_Day4</span> layer using the same process you used earlier in this recipe.</li>
<li>Review the Attribute Table contents and note the number of features/records in the table. Use that information to answer the following question:</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong><span>: </span>How many records/features does the Street_Signs_Day4 shapefile contain?</p>
<p><strong>Answer</strong>:</p>
</div>
<ol start="9">
<li>Open the attribute table for the StreetSigns layer and note the number of records/features it contains. Use that information to answer the following question.</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong><span>: </span>How many records/features does the StreetSigns layer contain?</p>
<p><strong>Answer</strong><span>:</span></p>
</div>
<ol start="10">
<li>Click on the <span class="packt_screen">Analysis</span> tab in the ribbon.</li>
<li>Click on the <span class="packt_screen">Tools</span> button located in the <span class="packt_screen">Geoprocessing</span> group on the <span class="packt_screen">Analysis</span> tab.</li>
<li>In the <span class="packt_screen">Geoprocessing</span> pane that appears, click on the <span class="packt_screen">Toolboxes</span> tab.</li>
<li>Locate and expand the <span class="packt_screen">Data Management Tools</span> toolbox.</li>
</ol>
<ol start="14">
<li>Expand the <span class="packt_screen">General</span> toolset and locate the <span class="packt_screen">Append</span> tool, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="481" src="assets/63138d0e-04e6-481d-a2d0-a9bdf096a0bd.png" width="594"/></strong></div>
<ol start="15">
<li>Click on the <span class="packt_screen">Append</span> tool to open it in the <span class="packt_screen">Geoprocessing</span> pane.</li>
<li>Click on the small drop-down arrow located to the right of the <span class="packt_screen">Input Datasets</span> cell and select <span class="packt_screen">Street_Signs_Day4</span>.</li>
<li>Click on the small drop-down arrow located to the right of the <span class="packt_screen">Target Dataset</span> and select <span class="packt_screen">StreetSigns</span> from the list presented.</li>
</ol>
<ol start="18">
<li>Verify that your <span class="packt_screen">Append</span> tool looks like the following and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img src="assets/8e9da361-49f1-4c9a-b147-5a5811478cea.png"/></strong></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">The Append tool in the Geoprocessing pane.</div>
<p style="padding-left: 60px">Notice that no new layers were added to your map, unlike when you used the <span class="packt_screen">Merge</span> tool. This is because no new layers were created. The features from the <span class="packt_screen">Street_Signs_Day4</span> shapefile have been added to the existing <span class="packt_screen">StreetSigns</span> shapefile. Let’s verify that is what happened.</p>
<ol start="19">
<li>In the <span class="packt_screen">Contents</span> pane, select the <span class="packt_screen">List by Draw Order</span> button. It is the first one on the left-hand side.</li>
</ol>
<ol start="20">
<li>Turn off the <span class="packt_screen">Street_Signs_Day4</span> layer by clicking on the box to the left of the layer name so it no longer contains a check mark.</li>
</ol>
<p style="padding-left: 60px">You should now see a copy of the features that were in the shapefile displayed in the StreetSigns layer. This shows that the features from the shapefile were copied to the geodatabase feature class. Now check the attributes to ensure they were copied.</p>
<ol start="21">
<li>In the <span class="packt_screen">Contents</span> pane, select the <span class="packt_screen">List by Selection</span> button.</li>
<li>Ensure the <span class="packt_screen">StreetSigns</span> layer is set as selectable.</li>
<li>Right-click on the <span class="packt_screen">Street_Signs_Day4</span> layer and select <span class="packt_screen">Zoom to Layer</span>. This ensures that you are zoomed in to the area covered by this layer.</li>
<li>Click on the <span class="packt_screen">Map</span> tab in the ribbon.</li>
<li>Click on the <span class="packt_screen">Select</span> button in the <span class="packt_screen">Selection</span> group on the <span class="packt_screen">Map</span> tab.</li>
<li>On your map, click on the lower-right side, as indicated in the following diagram. Continue to hold your mouse button down and drag your mouse pointer to the north-west until you reach the approximate location shown, creating a rectangle which will allow you to select all the features copied from the shapefile:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="307" src="assets/31e5c155-f9b1-4fdd-b4b3-a6ac16c9beef.png" width="494"/></strong></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Selection rectangle for street signs</div>
<ol start="27">
<li>Right-click on the <span class="packt_screen">StreetSigns</span> layer and select <span class="packt_screen">Attribute Table</span>.</li>
<li>Click the <span class="packt_screen">Show Selected Records</span> button located at the bottom of the <span class="packt_screen">Attribute Table</span>. This filters the table so that only the selected features are visible.</li>
<li>Note the total number of records. Compare that to the number of records in the table before you used the Append tool. Use that information to answer the following questions:</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong>: Do the selected records all include attribute values?  </p>
<p><span><strong>Answer</strong>:</span></p>
<p><strong>Question</strong><span>: </span>How does the total number of records in the table compare to the number before you ran the Append tool?</p>
<p><strong>Answer</strong><span>:</span></p>
</div>
<p style="padding-left: 60px">As you can see, the attribute values were also copied from the shapefile to the new geodatabase feature class. The new total number of records in the StreetSigns layer should equal the sum of the number of records in the shapefile plus the pre-append tool record count for the StreetSigns layer. The Append tool simply added the records/features from the shapefile to the StreetSigns layer.</p>
<ol start="30">
<li>Close the <span class="packt_screen">Attribute Table</span> and <span class="packt_screen">Geoprocessing</span> pane if it is still open.</li>
<li>Save your project and close ArcGIS Pro.</li>
</ol>
<p>As you have now experienced, the Merge and Append geoprocessing tools are great for combining multiple datasets into one. This can reduce the total number of datasets you must manage and make performing analysis much easier. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Exporting tabular data to an Excel spreadsheet</h1>
                </header>
            
            <article>
                
<p>Many times, the people we work with are not GIS professionals or do not have access to GIS software. They may request data in another format. One of the most commonly requested formats is a spreadsheet. Spreadsheets are something just about everyone with a computer can work with. They can run calculations, summarize data, create graphs, and more.</p>
<p>While you cannot export the spatial data to a spreadsheet, ArcGIS Pro will allow you to export tabular data to a spreadsheet-compatible format. This includes Microsoft Excel XLS, XLSX, and CSV files. You are able to export attribute and stand-alone database tables to spreadsheets with ArcGIS Pro. As with most other operations, there is more than one way to do it.</p>
<p>In this recipe, you will learn two different methods for converting tables to spreadsheet compatible formats. The roads superintendent has asked you to provide him with a copy of the street sign inventory you have been working on so he can get a general count of all signs by type, and so he can compare it to his list of signs he has been keeping in a notebook. He also wants you to get him a spreadsheet with all the roads located within the city. You will use a different method for each of these tasks.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>This recipe requires that you have completed the previous recipe. It also requires you to have spreadsheet software installed, such as Microsoft Excel or Open Office. This recipe can also be completed with all license levels of ArcGIS Pro.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>You will first need to start ArcGIS Pro and open the <kbd>Convert Multiple Shapefiles.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter7\</kbd> using the skills you have learned in past recipes.</li>
<li>Locate the <span class="packt_screen">StreetSigns</span> layer in the <span class="packt_screen">Contents</span> pane.</li>
<li>Right-click on the <span class="packt_screen">StreetSigns</span> layer and go down to <span class="packt_screen">Data</span>. Then select <span class="packt_screen">Export Table</span>, as illustrated in the following screenshot. This will open the <span class="packt_screen">Copy Rows</span> tool in the <span class="packt_screen">Geoprocessing</span> pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="527" src="assets/0194bb10-d0ab-4d61-b3f0-b66dae33c6e2.png" width="398"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Accessing Export Table function</div>
<ol start="4">
<li>The <span class="packt_screen">Input Rows</span> should already be set to the <span class="packt_screen">StreetSigns</span> layer since you right-clicked on it to access the tool. Now click on the <span class="packt_screen">Browse</span> button located to the right of the <span class="packt_screen">Output Table</span>.</li>
<li>Click on the <span class="packt_screen">Folders</span> folder located under <span class="packt_screen">Project</span> in the left panel of the <span class="packt_screen">Output Table</span> window.</li>
</ol>
<ol start="6">
<li>Double-click on the <span class="packt_screen">Convert Single Shapefile</span> folder in the right panel.</li>
<li>In the <span class="packt_screen">Name</span> cell, type <kbd>StreetSignsInventory.csv</kbd> and click the <span class="packt_screen">Save</span> button at the bottom of the window.</li>
<li>Verify that your <span class="packt_screen">Copy Rows</span> tool looks like the following and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="503" src="assets/db7df47c-aa99-4b71-b346-f598a9bdd59c.png" width="327"/></strong></div>
<div class="packt_infobox">
<p>The Copy Rows tool can be used to convert multiple types of tabular data to other formats. Input for this tool can include Geodatabases, shapefiles, dBase tables, Microsoft Excel spreadsheets, CSV files, and TXT files. Output can be geodatabase standalone tables, dBase tables, and CSV and TXT files. To learn more about the Copy Rows tool, go to <a href="http://pro.arcgis.com/en/pro-app/tool-reference/data-management/copy-rows.htm">http://pro.arcgis.com/en/pro-app/tool-reference/data-management/copy-rows.htm</a>.</p>
</div>
<p style="padding-left: 60px">Remember, if you have features or records selected in a layer or table, the <span class="packt_screen">Copy Rows</span> tool will only export the selected items to the new output table.</p>
<p style="padding-left: 60px">When the <span class="packt_screen">Copy Rows</span> tool is complete, you should see a new table appear in the <span class="packt_screen">Contents</span> pane. This is the CSV file you just created. Let’s see if it will open in Microsoft Excel or the spreadsheet application you have installed.</p>
<ol start="9">
<li>Open your <span class="packt_screen">Windows Explorer</span> or <span class="packt_screen">File Explorer</span> depending on what version of Windows you are using. There is typically an icon on the Taskbar located at the bottom of your monitor which will open <span class="packt_screen">Windows Explorer</span> or <span class="packt_screen">File Explore</span>. The icon looks like a file folder sitting in a stand.</li>
</ol>
<div class="packt_tip">
<p>File/Windows Explorer is not the same as Internet Explorer. Internet Explorer is a web browser. File/Windows Explorer allows you to browse the contents of your computer, network, and connected drives.</p>
</div>
<ol start="10">
<li>In the directory tree located in the panel on the left of the <span class="packt_screen">File Explorer</span> window, locate <span class="packt_screen">Desktop</span> and expand it so you can see its contents.</li>
<li>Locate <span class="packt_screen">This PC</span> or <span class="packt_screen">My Computer</span> within the <span class="packt_screen">Directory Tree</span> and expand it so you can see its contents.</li>
<li>Click on the <span class="packt_screen">C:\</span> drive. It is normally named either <span class="packt_screen">Local Drive</span> or <span class="packt_screen">OS</span>.</li>
<li>In the right panel, locate the <span class="packt_screen">Student</span> folder and double-click on it.</li>
<li>Double-click on the <span class="packt_screen">ArcGISProCookbook</span> folder to open it.</li>
<li>Double-click on the <span class="packt_screen">Chapter7</span> and the <span class="packt_screen">Convert Single Shapefile</span> folders to open them.</li>
<li>Scroll down until you find the <span class="packt_screen">StreetSignsInventory.CSV</span> file and double-click to open it.</li>
</ol>
<ol start="17">
<li>Take a moment to look over the contents of the file. You should see three columns. The first row should contain the field names from the <span class="packt_screen">Attribute Table</span>. The remaining rows contain the data from the attribute table. It should look similar to the following:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="342" src="assets/26d54d99-c5d7-4877-a0e8-82e5925fbffc.png" width="512"/></div>
<ol start="18">
<li>Once you are done reviewing the CSV file, close it. If asked to save it, do not.</li>
</ol>
<p style="padding-left: 60px">You have just converted the Attribute Table for the StreetSigns layer to a CSV file which you opened as a spreadsheet. So, you have completed the first task. Now you need to export the street centerline attributes. This will actually require you to prepare the data before you export it, because, as you will see, your street centerline data actually extends beyond the City Limits.</p>
<ol start="19">
<li>Return to ArcGIS Pro. If you accidentally closed ArcGIS Pro, please refer back to the first step in this recipe to reopen the correct project. </li>
<li>In the <span class="packt_screen">Catalog</span> pane, expand the <span class="packt_screen">Databases</span> folder so you can see its contents.</li>
<li>Next, expand the <span class="packt_screen">Trippville_GIS.gdb</span> geodatabase and the <span class="packt_screen">Base</span> feature dataset.</li>
</ol>
<ol start="22">
<li>Drag and drop the <span class="packt_screen">Street_Centerlines</span> feature class into the map view.</li>
</ol>
<p style="padding-left: 60px">As you can see, the data extends outside the City Limits of Trippville. The roads superintendent only wants data for the portions of the roads inside the City Limits, so you will need to clip the data.</p>
<ol start="23">
<li>Click on the <span class="packt_screen">Analysis</span> tab in the ribbon.</li>
<li>Click on the <span class="packt_screen">Clip</span> tool located in the <span class="packt_screen">Tools</span> group on the ribbon. This will open the <span class="packt_screen">Clip</span> tool in the <span class="packt_screen">Geoprocessing</span> pane.</li>
<li>Click on the drop-down arrow for the <span class="packt_screen">Input Features</span> located at the far right side of the cell. Select <span class="packt_screen">Street_Centerlines</span> from the list.</li>
<li>Repeat this process for the <span class="packt_screen">Clip Features</span>, selecting the <span class="packt_screen">City_Limit</span> layer.</li>
<li>Accept the default name for the <span class="packt_screen">Output Feature Class</span>. Verify that your <span class="packt_screen">Clip</span> tool looks like the following, and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-881 image-border" height="375" src="assets/4ad2ff3e-e52a-43b3-af51-5c86d28d8c3f.png" width="243"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Clip tool in the Geoprocessing pane</div>
<p style="padding-left: 60px">When the <span class="packt_screen">Clip</span> tool completes, a new layer will appear in your map which contains only the portion of the roads within the City Limits of Trippville:</p>
<ol start="28">
<li>Close the <span class="packt_screen">Geoprocessing</span> pane and save your project.</li>
<li>Click on the <span class="packt_screen">Analysis</span> tab in the ribbon to ensure it is active. Next click on the <span class="packt_screen">Tools</span> button located in the <span class="packt_screen">Geoprocessing</span> group.</li>
<li>Click on the <span class="packt_screen">Toolboxes</span> tab at the top of the <span class="packt_screen">Geoprocessing</span> pane, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="245" src="assets/41ec7205-8abe-4212-a763-3c895fe86262.png" width="439"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Click on Toolboxes tab in center</div>
<ol start="31">
<li>Locate and expand the <span class="packt_screen">Conversion Tools</span> toolbox in the <span class="packt_screen">Geoprocessing</span> pane.</li>
<li>Expand the <span class="packt_screen">Excel</span> toolset to reveal the <span class="packt_screen">Excel to Table</span> and the <span class="packt_screen">Table to Excel Python</span> script tools.</li>
</ol>
<div class="packt_tip">
<p>You may wonder how you can tell these are Python script tools. It is because of the icon located next to the tool. Scrolls, as displayed next to these two tools, indicate Python script tools. Hammers indicate system tools such as the Clip tool, you used earlier in this recipe. A group of connected multi-colored diamonds indicates a model tool created with ModelBuilder.</p>
</div>
<ol start="33">
<li>Select the <span class="packt_screen">Table to Excel</span> tool. This will open the tool in the <span class="packt_screen">Geoprocessing</span> pane.</li>
<li>Click the drop-down arrow for the <span class="packt_screen">Input Table</span> and select <span class="packt_screen">Street_Centerline_Clip</span> from the list.</li>
<li>For the <span class="packt_screen">Output Excel File</span>, click the <span class="packt_screen">Browse</span> button located on the far-right side.</li>
<li>In the left panel of the <span class="packt_screen">Save As</span> window that just opened, locate <span class="packt_screen">This PC</span> or <span class="packt_screen">My Computer</span> and click on it.</li>
<li>In the right panel, locate the <span class="packt_screen">C:\</span> drive and double-click on it. The C:\ drive is often named <span class="packt_screen">Local Drive</span> or <span class="packt_screen">OS</span>.</li>
<li>Locate the <span class="packt_screen">Student</span> folder in the right-hand side panel and double-click on it.</li>
<li>Locate the <span class="packt_screen">ArcGISProCookbook</span> folder and double-click on it.</li>
<li>Locate the <span class="packt_screen">My Projects</span> folder and double-click on it.</li>
<li>In the <span class="packt_screen">File Name</span> box located near the bottom of the <span class="packt_screen">Save As</span> window, type <kbd>Street_Centerlines_Trippville</kbd> and click <span class="packt_screen">Save</span>.</li>
<li>Verify that your <span class="packt_screen">Table to Excel</span> tool looks like the following, and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-882 image-border" height="249" src="assets/db0dfdff-d510-4b35-898b-bd39ba5766cf.png" width="394"/></div>
<p style="padding-left: 60px">If the tool runs successfully it should create a new spreadsheet in the folder you designated. Now you will verify the results.</p>
<ol start="43">
<li>Open <span class="packt_screen">Windows Explorer</span> or <span class="packt_screen">File Explorer</span> like you did earlier in this recipe.</li>
<li>Using the same method you did in <em>steps 10-14</em> of this recipe, navigate to <kbd>C:\Student\ArcGISProCookbook\MyProjects</kbd>.</li>
<li>Locate the <span class="packt_screen">Street_Centerlines_Trippville.xls</span> file that you just created and double-click on it to open the file.</li>
<li>Take a moment to examine the spreadsheet you created. It should look similar to the screenshot that follows. If you desire, open the <span class="packt_screen">Attribute Table</span> for the <span class="packt_screen">Street_Centerlines</span> layer in ArcGIS Pro and compare the two:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/15e8756d-b09d-42bc-bfcc-888830b68f97.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Exported spreadsheet</div>
<ol start="47">
<li>When you are done examining the contents of the spreadsheet, close it and your <span class="packt_screen">File Explorer</span> window.</li>
<li>Return to ArcGIS Pro and save your project.</li>
<li>If you are not continuing on to the next recipe, close ArcGIS Pro. If you are, you may leave ArcGIS Pro open.</li>
</ol>
<p>You have now used two methods to export data from GIS to a format that can be opened by applications such as Microsoft Excel. This capability further expands the usefulness and flexibility of your GIS. It opens up the ability to integrate with other non-spatial applications.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing an Excel spreadsheet into ArcGIS Pro</h1>
                </header>
            
            <article>
                
<p>You have learned how to export data from GIS formats to a spreadsheet within ArcGIS Pro. But what if you need to go the other way? People use spreadsheets to store all kinds of information. This is because they are quick and easy to create and are very versatile. So, what does it take to bring one into your GIS using ArcGIS Pro?</p>
<p>When working with spreadsheets in ArcGIS Pro, remember, simpler is always better. ArcGIS Pro allows you to view XLS and XLSX files. It displays the spreadsheet as a database table. You can view, query, and link a spreadsheet. The linking is limited to using a join or a relate, which you learned about in <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <em>Linking Data together</em>.</p>
<p>There are some limitations when trying to use a spreadsheet in ArcGIS Pro. ArcGIS Pro treats a spreadsheet like a database table. So, it applies database limitations to the spreadsheet. This includes the following:</p>
<ul>
<li>The values in the first non-empty row in the spreadsheet become the field names.</li>
<li>Each column must have a unique name.</li>
<li>Each column cannot contain special characters. Underscores ( _ ) are allowed.</li>
<li>The field names (values in the first row) are limited to 64 characters.</li>
<li>No value in a cell can exceed 255 characters.</li>
<li>Each field must start with an Alpha character. It cannot start with a number.</li>
</ul>
<p>If the spreadsheet fails to meet any of these limitations, ArcGIS Pro will not allow you to view the spreadsheet. This means that you may need to customize or simplify the spreadsheet for it to work in ArcGIS Pro. Also, ArcGIS Pro will not allow you to edit a spreadsheet.</p>
<p>If you need to edit the data in a spreadsheet or make it a permanent part of your GIS data, you will need to convert it. ArcGIS Pro has a tool that converts the spreadsheet into a database table. This can be a dBase or standalone geodatabase table. </p>
<p>In this recipe, you will view a spreadsheet containing inspection information in ArcGIS Pro. This will start with you reviewing the contents of the spreadsheet in Excel or other spreadsheet application to ensure that it does not violate some of the limitations. Then you will open it in ArcGIS Pro.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>It is recommended that you complete all the recipes in <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <span><em>Linking Data together</em>,</span> of this cookbook before you work this recipe. <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <span><em>Linking Data together</em>,</span> will provide you with a better understanding of how to work with database tables in ArcGIS Pro. You will also need to have Microsoft Excel or a similar spreadsheet application installed. This recipe can be completed with all license levels of ArcGIS Pro.   </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Open Windows/File Explorer. It should be an icon that looks like a file folder on your Taskbar.</li>
<li>In the panel on the left, expand the contents of <span class="packt_screen">This PC</span> or <span class="packt_screen">My Computer</span>, depending on your operating system.</li>
<li>Locate and expand the <span class="packt_screen">C:\</span> drive, which is typically labeled as <span class="packt_screen">OS</span> or <span class="packt_screen">Local Drive</span>.</li>
<li>Click on the <span class="packt_screen">Student</span> folder so that its contents appear in the right-hand side panel.</li>
<li>Double-click on the <span class="packt_screen">ArcGISProCookbook</span> folder</li>
<li>Double-click on the <span class="packt_screen">Chapter7</span> folder.</li>
</ol>
<ol start="7">
<li>Double-click on the <span class="packt_screen">Inspections2016to2017.xls</span> file to open it. The spreadsheet should open in your spreadsheet application such as Microsoft Excel. It should look like the screenshot that follows:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6555e742-8d02-4eff-8613-1982edfb0f2e.png"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Inspection spreadsheet</div>
<ol start="8">
<li>Review the spreadsheet, comparing it to the limitations listed in the opening of the recipe. Then answer the following questions:</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong>: What are the values in the first row, which will become the column names when you open the spreadsheet in ArcGIS Pro?</p>
<p><strong>Answer</strong>: </p>
<p><span><strong>Question</strong>: Is each value in the first row unique?</span></p>
<p><span><strong>Answer</strong>: </span></p>
<p><strong>Question</strong>: Do the values in the first row contain any special characters?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: Do any of the values in the first row exceed 64 characters?</p>
<p><strong>Answer</strong>: </p>
<p><strong>Question</strong>: Do any of the values in any cell exceed 255 characters? </p>
<p><strong>Answer</strong>: </p>
</div>
<p style="padding-left: 60px">As you can see, this is a simple spreadsheet. It does not contain a lot of title information or complicated equations which can cause issues in ArcGIS Pro. As a matter of fact, it meets most of the restrictions required by ArcGIS Pro. However, several of the values in the first row do violate the restrictions because they contain special characters (spaces). You will need to adjust these before you can bring the spreadsheet into ArcGIS Pro.</p>
<ol start="9">
<li>You need to change the value in cell <span class="packt_screen">A1</span>. Replace <kbd>Inspection ID</kbd> with <kbd>Insp_ID</kbd>.</li>
<li>Replace <kbd>Date of Inspection</kbd> in cell <span class="packt_screen">C1</span> with <kbd>Date_Insp</kbd>.</li>
<li>Replace <kbd>Inspection Results</kbd> in cell <span class="packt_screen">D1</span> with <kbd>Insp_results</kbd>.</li>
<li>Replace <kbd>Inspection Type</kbd> in cell <span class="packt_screen">E1</span> with <kbd>Insp_Typ</kbd>.</li>
<li>Verify that you have properly replaced the values in row 1, and then save the spreadsheet and close it:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img src="assets/de0622a5-e810-436d-96d9-c6d152fc170f.png"/></strong></div>
<ol start="14">
<li>Start ArcGIS Pro and open the <kbd>Import Spreadsheet.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter7</kbd> using the skills you have learned in past recipes. The project should open with the City of Trippville map.</li>
<li>You will now add the spreadsheet you just edited to ArcGIS Pro. Click on the <span class="packt_screen">Add Data</span> button in the <span class="packt_screen">Layer</span> group on the <span class="packt_screen">Map</span> tab in the ribbon.</li>
<li>In the panel on the left side, expand the <span class="packt_screen">Computer</span> option so you can see its contents.</li>
<li>Click on the <span class="packt_screen">C:\</span> drive so its contents appear in the right panel.</li>
<li>Scroll down in the right panel until you see the <span class="packt_screen">Student</span> folder. Double-click on the <span class="packt_screen">Student</span> folder.</li>
<li>Double-click on the <span class="packt_screen">ArcGISProCookbook</span> folder.</li>
<li>Double-click on the <span class="packt_screen">Chapter7</span> folder.</li>
<li>Double-click on the <span class="packt_screen">Inspections2016to2017.xls</span> file. Select the <span class="packt_screen">Inspections2016to2017$</span> worksheet and click <span class="packt_screen">OK</span>. The worksheet should appear as a standalone table in the <span class="packt_screen">Contents</span> pane.</li>
</ol>
<ol start="22">
<li>Right-click on the <span class="packt_screen">Inspoections2016to2017$</span> standalone table and select <span class="packt_screen">Open</span> from the menu that appears. The worksheet opens as a table and should look very familiar. Notice the fields of information this workshop contains:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img src="assets/55c5b0e5-8401-48f0-ac64-86bfd2412c1a.png"/></strong></div>
<p style="padding-left: 60px">If you look at the list of layers in the map, you will see an <span class="packt_screen">Inspections</span> layer. This layer shows the locations of the inspections referenced in the worksheet you just brought into ArcGIS Pro. Now you will examine that layer:</p>
<ol start="23">
<li>In the <span class="packt_screen">Contents</span> pane, right-click on the <span class="packt_screen">Inspections</span> layer and select <span class="packt_screen">Attribute Table</span> from the menu that appears.</li>
</ol>
<p style="padding-left: 60px">As you can see, this table is very simple. It only contains three fields, ObjectID, Shape, and InspID, so the layer only stores the location of each inspection. If you were to join it with the worksheet you added, then you would know a lot more about each inspection. This would in turn increase your ability to use the data in ArcGIS Pro. Now you will join the worksheet to the <span class="packt_screen">Inspections</span> layer.</p>
<ol start="24">
<li>In the <span class="packt_screen">Contents</span> pane, right-click on the <span class="packt_screen">Inspections</span> layer, select <span class="packt_screen">Joins and Relates</span>, and then <span class="packt_screen">Add Join</span>, as illustrated in the following screenshot. This will open the <span class="packt_screen">Add Join</span> tool in the <span class="packt_screen">Geoprocessing</span> pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-883 image-border" height="436" src="assets/747749fd-5b21-4422-b1cb-6d6f838c01b2.png" width="399"/></div>
<ol start="25">
<li>The <span class="packt_screen">Layer Name or Table View</span> should already be assigned. Click the drop-down arrow for the <span class="packt_screen">Input Join Field</span> and select <span class="packt_screen">InspID</span> from the list presented.</li>
<li>The <span class="packt_screen">Join Table</span> should also be automatically assigned as the <span class="packt_screen">Inspections2016to2017$</span> worksheet because it is the only standalone table in your map. Click on the drop-down arrow for the <span class="packt_screen">Output Join Field</span> and select <span class="packt_screen">Inspection_ID</span>.</li>
</ol>
<ol start="27">
<li>Verify your <span class="packt_screen">Add Join Table</span> tool looks like the following screenshot and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="258" src="assets/22463cfb-fee0-4903-b532-542c4e977fc9.png" width="468"/></strong></div>
<ol start="28">
<li>Look back at the <span class="packt_screen">Inspections Attribute Table</span>, which originally contained only two fields. Now you should see that the information from the worksheet has been added to that table.</li>
<li>Close the <span class="packt_screen">Geoprocessing</span> pane.</li>
<li>Save your Project.</li>
</ol>
<p style="padding-left: 60px">Now that you have joined the worksheet data to the <span class="packt_screen">Inspections</span> layer, you can use that additional information to label, symbolize, and query, just as if the additional information was part of the layer to start with. The one thing you cannot do is edit the information that comes from the worksheet in ArcGIS Pro. That requires you to convert it.</p>
<p style="padding-left: 60px">The method you use to convert it will depend on how you intend to use the data from the spreadsheet. If you want to keep the spreadsheet data in a separate table, you can use the Excel to Table tool. If you wish to permanently join the data to the layer, you can export the joined layer to a new feature class. You will do both now.</p>
<ol start="31">
<li>Right-click on the <span class="packt_screen">Inspections</span> layer and go to <span class="packt_screen">Data</span> in the menu that appears. Then select the <span class="packt_screen">Export Features</span> option, as illustrated in the following screenshot. This will open the <span class="packt_screen">Copy Features</span> tool in the <span class="packt_screen">Geoprocessing</span> pane.</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-884 image-border" height="624" src="assets/a2b2246a-1183-4f5e-be36-02ec7b165fa4.png" width="413"/></div>
<ol start="32">
<li>The <span class="packt_screen">Input Features</span> value should be automatically populated. Click the <span class="packt_screen">Browse</span> button at the end of the <span class="packt_screen">Output Features Class</span> cell.</li>
<li>Select the <span class="packt_screen">Databases</span> folder under <span class="packt_screen">Project</span> in the left panel of the <span class="packt_screen">Output Feature Class</span> window.</li>
<li>Double-click on the <span class="packt_screen">Trippville_GIS.gdb</span> geodatabase in the right panel of the window. Then, in the <span class="packt_screen">Name</span> cell near the bottom of the window, type <kbd>Inspections_more_data</kbd> and click the <span class="packt_screen">Save</span> button.</li>
<li>Verify that your <span class="packt_screen">Copy Features</span> tool looks like the following screenshot and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img src="assets/137ccaf0-0a41-4f51-966c-1f28fbee3d9d.png"/></strong></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Copy Features tool in the Geoprocessing pane</div>
<ol start="36">
<li>Close the <span class="packt_screen">Geoprocessing</span> pane.</li>
<li>The new <span class="packt_screen">Inspections_more_data</span> layer should appear in the <span class="packt_screen">Contents</span> pane. Open the <span class="packt_screen">Attribute Table</span> for this new layer and answer the following question:</li>
</ol>
<div class="packt_infobox">
<p><strong>Question</strong>: What attribute fields does the layer you created contain?</p>
<p><strong>Answer</strong>: </p>
</div>
<p style="padding-left: 60px">As you can see, the new layer contains all the information that was in the Attribute Table for the <span class="packt_screen">Inspections</span> layer and the <span class="packt_screen">Inspections2016to2017$</span> worksheet standalone table. Now that all that information is part of a single layer, you can edit all the data.</p>
<ol start="38">
<li>Save your project using the <span class="packt_screen">Save</span> button on the Quick Access toolbar.</li>
</ol>
<p>The ability to import and use data from outside sources greatly increases the flexibility of your GIS.  It can provide you with access to a plethora of new information to include in your analysis. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">There’s more…</h1>
                </header>
            
            <article>
                
<p>You just joined a spreadsheet to the Inspections layer, and then exported that to a new feature class which contains the combined information from both the joined sources. But what if you wanted the Inspections layer and the data from the spreadsheet to remain separate but still be editable from ArcGIS? How would you do that?</p>
<p>In that case, you would want to convert the spreadsheet to a true standalone database table. This would allow the two to remain separate, but they could still be joined as needed or maybe even a relationship class could be set up between them. Keeping them separate would have other advantages as well. First, you could easily replace the standalone table with a new copy of the spreadsheet as needed if your organization wanted to continue to input data through the spreadsheet. Being a standalone table, you could share just the table with others for editing and updating via web forms or mobile applications. These are just a few of the advantages.</p>
<p>Let’s look at how you would export the spreadsheet to a standalone table in your GIS database:</p>
<ol>
<li>Click on the <span class="packt_screen">Analysis</span> tab in the ribbon.</li>
<li>Click on the <span class="packt_screen">Tools</span> button in the <span class="packt_screen">Geoprocessing</span> group on the <span class="packt_screen">Analysis</span> tab. This will open the <span class="packt_screen">Geoprocessing</span> pane once again.</li>
<li>If required, click on the <span class="packt_screen">Toolboxes</span> tab located near the top of the <span class="packt_screen">Geoprocessing</span> pane.</li>
</ol>
<ol start="4">
<li>Locate and expand the <span class="packt_screen">Conversion Tools</span> toolbox.</li>
<li>Locate and expand the <span class="packt_screen">Excel</span> toolset in the <span class="packt_screen">Conversion Tools</span> toolbox.</li>
</ol>
<ol start="6">
<li>You should see two tools, <span class="packt_screen">Excel to Table</span> and <span class="packt_screen">Table to Excel</span>. You used the <span class="packt_screen">Table to Excel Python</span> tool in the previous recipe. Now you will use the <span class="packt_screen">Excel to Table</span> tool. Click on the <span class="packt_screen">Excel to Table</span> tool. This will open the tool in the <span class="packt_screen">Geoprocessing</span> pane.</li>
<li>Click on the <span class="packt_screen">Browse</span> button for the <span class="packt_screen">Input Excel File</span>. This will open a new window that allows you to navigate to the Excel file you will convert.</li>
<li>In the panel on the left, locate and expand <span class="packt_screen">This PC</span> or <span class="packt_screen">My Computer</span>.</li>
<li>Select <span class="packt_screen">C:\</span>, which is typically labeled <span class="packt_screen">OS</span> or <span class="packt_screen">Local Drive</span>. The contents of the <span class="packt_screen">C:\</span> drive should appear in the panel on the right.</li>
<li>Scroll down until you see the <span class="packt_screen">Student</span> folder, then double-click on the <span class="packt_screen">Student</span> folder.</li>
<li>Double-click on the <span class="packt_screen">ArcGISProCookbook</span> folder.</li>
<li>Double-click on the <span class="packt_screen">Chapter7</span> folder.</li>
<li>Select the <span class="packt_screen">Inspections2016to2017.xls</span> file and click the <span class="packt_screen">Open</span> button.</li>
</ol>
<div class="packt_tip">
<p>Do not double-click on the <span class="packt_screen">Inspections2016to2017.xls</span> file. That will open its contents and not select it, as desired. This will cause the tool to ultimately fail. </p>
</div>
<ol start="14">
<li>Click the <span class="packt_screen">Browse</span> button for the <span class="packt_screen">Output Table</span>.</li>
<li>Click on the <span class="packt_screen">Databases</span> folder in the left panel of the <span class="packt_screen">Output Table</span> window, located under <span class="packt_screen">Project</span>.</li>
<li>Double-click on the <span class="packt_screen">Trippville_GIS.gdb</span> geodatabase.</li>
<li>In the <span class="packt_screen">Name</span> cell, near the bottom of the <span class="packt_screen">Output Table</span> window, type <kbd>Inspections_2016_2017</kbd>. Then click the <span class="packt_screen">Save</span> button.</li>
</ol>
<ol start="18">
<li>Verify that your <span class="packt_screen">Excel to Table</span> tool looks like the following, and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="322" src="assets/e8569007-dd96-4c89-88d1-271bf9f8744f.png" width="582"/></strong></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Excel to Table tool in the Geoprocessing pane to import the spreadsheet into a geodatabase</div>
<p style="padding-left: 60px">When the tool is complete, a new standalone table will appear in the <span class="packt_screen">Contents</span> pane. This is the new table that you just created. Now you will remove the join between the <span class="packt_screen">Inspections</span> layer and the spreadsheet, and replace it with a join to the new table:</p>
<ol start="19">
<li>Right-click on the <span class="packt_screen">Inspections</span> layer and go to <span class="packt_screen">Joins and Relates</span> in the menu that appears. Select <span class="packt_screen">Remove Join</span>, as illustrated in the following screenshot. This will open the <span class="packt_screen">Remove Join</span> tool in the <span class="packt_screen">Geoprocessing</span> pane:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="299" src="assets/bcd3aeea-b8dc-4de6-900c-f828201a65be.png" width="463"/></strong></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref">Removing the data table joins </div>
<ol start="20">
<li>All the required parameters should be automatically populated, since there is only one join in place associated with the <span class="packt_screen">Inspections</span> layer. So verify that your <span class="packt_screen">Remove Join</span> tool looks like the following screenshot and click <span class="packt_screen">Run</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="279" src="assets/bbc114ad-4d0a-4702-a44c-02ae7ceea217.png" width="506"/></strong></div>
<div>
<p style="padding-left: 60px">You can join or relate multiple tables to a single layer or table if needed within ArcGIS Pro. However, be careful how many you join or relate as it can have a negative impact on performance and become difficult to manage.</p>
</div>
<ol start="21">
<li>Using the skills you learned in <a href="cbca2a90-3539-4243-8ca3-0010b6f91584.xhtml">Chapter 3</a>, <span><em>Linking Data together</em>,</span> and earlier in this recipe, join the Inspections_2016_2017 standalone table to the Inspections layer.</li>
<li>Right-click on the <span class="packt_screen">Inspections2016to2017$</span> standalone table and select <span class="packt_screen">Remove</span>. This will remove the table from the map, but does not delete the file.</li>
<li>Open the <span class="packt_screen">Attribute Table</span> for the <span class="packt_screen">Inspections</span> layer and verify the data from the <span class="packt_screen">Inspections_2016_2017</span> is joined.</li>
<li>Close the <span class="packt_screen">Geoprocessing</span> pane and any open tables that you are viewing.</li>
<li>Save your project and close ArcGIS Pro.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Importing selected features into an existing layer</h1>
                </header>
            
            <article>
                
<p>Throughout this chapter, you have learned various methods for importing entire datasets into your geodatabase or exporting from your geodatabase to other formats. What if you only want to import a few selected features or records?</p>
<p>By default, the geoprocessing tools you have already used, such as Copy Features, Merge, Append, and Excel to table, will automatically be limited to selected features or records if you have them selected. However, most of these tools create new feature classes or tables. They do not just add data to an existing dataset. ArcGIS Pro will allow you to copy data from one layer and paste it into another existing layer. This allows you to choose exactly which features you want to convert or import.</p>
<p>In this recipe you will copy records from a shapefile and paste them into an existing layer which points to a geodatabase feature class. You will do this by first performing a query to select the features in the shapefile you wish to import into the existing geodatabase layer. Then you will copy and paste those features from the shapefile into the geodatabase layer. The shapefile you are working with represents a new subdivision being constructed in the City of Trippville.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>You are not required to have completed previous recipes in order to complete this one. This recipe can be completed with all license levels of ArcGIS Pro. You will need to ensure the sample data for the book has been installed. It is assumed that by this point you have completed some recipes from the book or at least have worked with ArcGIS Pro in the past and know how to open an existing project.  </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<ol>
<li>Start ArcGIS Pro and open the <kbd>Convert Selected Data.aprx</kbd> project located in <kbd>C:\Student\ArcGISProCookbook\Chapter7</kbd> using the skills you have learned in past recipes.</li>
<li>Notice the large parcel in the center of the map view. This is the parcel that is going to become the new subdivision. In the <span class="packt_screen">Contents</span> pane select the <span class="packt_screen">List by Draw Order</span> button. It is the first button on the left side.</li>
</ol>
<ol start="3">
<li>Turn on the <span class="packt_screen">New Subdivision Shapefile</span> layer. Once it is visible you will be able to see the new subdivision.</li>
<li>The new project should open with the City of Trippville map zoomed to the area for the new subdivision. Click on the List by Editing button in the <span class="packt_screen">Contents</span> pane. The buttons icon looks like a pencil.</li>
<li>Right-click on the <span class="packt_screen">Street Rights of Way</span> layer and select <span class="packt_screen">Make this the only editable layer</span> from the menu that appears, as illustrated here:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-885 image-border" height="345" src="assets/6a1398ce-483a-46f5-aa73-2e57e374aad6.png" width="441"/></div>
<ol start="6">
<li>Click on the <span class="packt_screen">List by Selection</span> button in the <span class="packt_screen">Contents</span> pane. It is located to the left of the <span class="packt_screen">List by Editing</span> button.</li>
<li>Click on the <span class="packt_screen">Map</span> tab in the ribbon. Select the <span class="packt_screen">Select by Attribute</span> tool in the <span class="packt_screen">Selection</span> group. This will open the <span class="packt_screen">Select Layer by Attribute</span> tool in the <span class="packt_screen">Geoprocessing</span> pane.</li>
<li>Click on the drop-down arrow for the <span class="packt_screen">Layer Name and Table View</span>. Select the <span class="packt_screen">New Subdivision Shapefile</span> from the list presented.</li>
<li>Ensure the <span class="packt_screen">Selection Type</span> is set to <span class="packt_screen">New Selection</span>.</li>
<li>Click on the <span class="packt_screen">Add Clause</span> button.</li>
</ol>
<ol start="6">
<li>Build your expression as shown in the following screenshot, and click the <span class="packt_screen">Add</span> button:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img src="assets/b037bce4-edbb-40dc-aad3-685f47a8e857.png"/></strong></div>
<ol start="12">
<li>Click the <span class="packt_screen">Verify</span> button, which looks like a green check mark, below the selection expression you just created. If it says <span class="packt_screen">The SQL expression is valid</span>, click the <span class="packt_screen">Run</span> button. This will select all the lines in the <span class="packt_screen">New Subdivision Shapefile</span> that are attributed as being RW, which stands for <span class="packt_screen">Rights of Way</span>.</li>
</ol>
<p style="padding-left: 60px">You should have 258 features selected, which you can verify by looking in the <span class="packt_screen">Contents</span> pane. You should see the number of selected features next to the <span class="packt_screen">New Subdivision Shapefile</span> layer. The selected features will be highlighted in the map, as shown the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5414ca9b-423b-4562-986c-62b0def3c84f.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Selected street rights of way lines</div>
<p style="padding-left: 60px">Now, you will copy the features you have selected and paste them to the <span class="packt_screen">Street Rights of Way</span> layer.</p>
<ol start="13">
<li>Click on the <span class="packt_screen">Edit</span> tab in the ribbon.</li>
<li>Click on the <span class="packt_screen">Select</span> tool in the <span class="packt_screen">Selection</span> group on the <span class="packt_screen">Edit</span> tab.</li>
<li>Click on the <span class="packt_screen">Copy</span> button located in the <span class="packt_screen">Clipboard</span> group on the <span class="packt_screen">Edit</span> tab.</li>
</ol>
<ol start="16">
<li>Click on the drop-down arrow located below the <span class="packt_screen">Paste</span> tool in the <span class="packt_screen">Clipboard</span> group on the <span class="packt_screen">Edit</span> tab, and select <span class="packt_screen">Paste Special</span>, as illustrated in the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><strong><img height="146" src="assets/8a6429d4-7c30-4901-b51f-52adc78c38e2.png" width="269"/></strong></div>
<ol start="17">
<li>Ensure the <span class="packt_screen">Paste into Template</span> is set to <span class="packt_screen">Street Rights of Way</span>, as shown in the following screenshot, and click <span class="packt_screen">OK</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-886 image-border" height="168" src="assets/8c4d2671-46b6-4fb4-a85d-62fda352d55b.png" width="214"/></div>
<ol start="18">
<li>Look in the <span class="packt_screen">Contents</span> pane. Notice that there are now no features selected in the <span class="packt_screen">New Subdivision Shapefile</span> layer. Instead, there are now 258 features selected in the <span class="packt_screen">Street Rights of Way</span> layer. You just copied the features from one layer and pasted them into another existing layer.</li>
<li>Click on the <span class="packt_screen">Clear</span> button, located in the <span class="packt_screen">Selection</span> group on the <span class="packt_screen">Edit</span> tab in the ribbon, to clear your selected features.</li>
</ol>
<ol start="20">
<li>In the <span class="packt_screen">Contents</span> pane, click on the <span class="packt_screen">List by Draw Order</span> button and turn off the <span class="packt_screen">New Subdivision Shapefile</span> layer to verify that you did successfully copy the features to the <span class="packt_screen">Street Rights of Way</span> layer.</li>
<li>Click the <span class="packt_screen">Save</span> button in the <span class="packt_screen">Manage Edits</span> group on the <span class="packt_screen">Edit</span> tab in the ribbon to save the new features you just copied into the <span class="packt_screen">Street Rights of Way</span> layer. When asked to save all edits, click <span class="packt_screen">Yes</span>.</li>
<li>Save your project and close ArcGIS Pro.</li>
</ol>
<p>This method will allow you to copy features from layers that reference CAD files (DWG, DGN, or DXF), shapefiles, and geodatabase feature classes to another layer as long as the layer references a shapefile or geodatabase feature class.</p>


            </article>

            
        </section>
    </body></html>