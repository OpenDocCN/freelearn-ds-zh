["```py\nimport arcpy\nmxdPath = 'C:\\Projects\\MXDs\\Chapter8\\BrokenLinks.mxd'\nmxdObject = arcpy.mapping.MapDocument(mxdPath)\nbrokenLinks = arcpy.mapping.ListBrokenDataSources(mxdObject)\nfor link in brokenLinks:\n print link.name, link.dataSource\n\n```", "```py\noldPath = r'C:\\Projects\\MXDs\\Data'\nnewPath = r'C:\\Projects'\nmxdObject.findAndReplaceWorkspacePaths(oldPath,newPath)\nmxdObject.save() \n\n```", "```py\noldPath = r'C:\\Projects\\MXDs\\Data'\noldType = 'SHAPEFILE_WORKSPACE'\nnewPath = r'C:\\Projects'\nnewType = 'FILEGDB_WORKSPACE'\nmxdObject.replaceWorkspaces(oldPath,oldType,newPath,newType)\nmxdObject.save()\n\n```", "```py\nimport arcpy\nlayerDic = {'Bus_Stops':[r'C:\\Projects\\OldDataPath', r'C:\\Projects'],\n 'stclines_streets': [r'C:\\Projects\\OtherPath', r'C:\\Projects']}\nmxdPath = r'C:\\Projects\\MXDs\\Chapter8\\BrokenLinks.mxd'\nmxdObject = arcpy.mapping.MapDocument(mxdPath)\nbrokenLinks = arcpy.mapping.ListBrokenDataSources(mxdObject)\nfor layer in brokenLinks:\n oldPath, newPath = layerDic[layer.name]\n layer.findAndReplaceWorkspacePath(oldPath, newPath )\n mxdObject.save()\n\n```", "```py\nimport arcpy, glob, os\noldPath = r'C:\\Projects\\MXDs\\Data'\nnewPath = r'C:\\Projects'\nfolderPath = r'C:\\Projects\\MXDs\\Chapter8'\nmxdPathList = glob.glob(os.path.join(folderPath, '*.mxd'))\nfor path in mxdPathList: \n mxdObject = arcpy.mapping.MapDocument(mxdPath)\n mxdObject.findAndReplaceWorkspacePaths(oldPath,newPath)\n mxdObject.save()\n\n```", "```py\nimport arcpy, glob, os\nmxdFolder = r'C:\\Projects\\MXDs\\Chapter8'\npdfFolder = r'C:\\Projects\\PDFs\\Chapter8'\nmxdPathList = glob.glob(os.path.join(mxdFolder, '*.mxd'))\nfor mxdPath in mxdPathList:\n mxdObject = arcpy.mapping.MapDocument(mxdPath)\n arcpy.mapping.ExportToPDF(mxdObject,\n os.path.join(pdfFolder,\n basepath( \n mxdPath.replace('mxd','pdf')\n )))\n\n```", "```py\nimport arcpy, os\ndirpath = os.path.dirname\nbasepath = os.path.basename\nBus_Stops = r\"C:\\Projects\\SanFrancisco.gdb\\Bus_Stops\"\nselectedBusStop = r'C:\\Projects\\SanFrancisco.gdb\\Chapter8Results\\SelectedBusStop'\nselectedStopBuffer = r'C:\\Projects\\SanFrancisco.gdb\\Chapter8Results\\SelectedStopBuffer'\nCensusBlocks2010 = r\"C:\\Projects\\SanFrancisco.gdb\\CensusBlocks2010\"\nselectedBlock = r'C:\\Projects\\SanFrancisco.gdb\\Chapter8Results\\SelectedCensusData'\npdfFolder = r'C:\\Projects\\PDFs\\Chapter8\\Map_{0}'\nbufferDist = 400\nsql = \"(NAME = '71 IB' AND BUS_SIGNAG = 'Ferry Plaza')\"\nmxdObject = arcpy.mapping.MapDocument(\"CURRENT\")\ndataFrame = arcpy.mapping.ListDataFrames(mxdObject, \"Layers\")[0]\nelements = arcpy.mapping.ListLayoutElements(mxdObject)\nfor el in elements:\n if el.type ==\"TEXT_ELEMENT\":\n if el.text == 'Title Element':\n titleText = el\n elif el.text == 'Subtitle Element':\n subTitleText = el\narcpy.MakeFeatureLayer_management(CensusBlocks2010, 'blocks_lyr') \nlayersList = arcpy.mapping.ListLayers(mxdObject,\"\",dataFrame)\nlayerStops = layersList[0]\nlayerCensus = layersList[1]\nlayerBuffer = layersList[2]\nlayerBlocks = layersList[3] \nif layerBlocks.dataSource != selectedBlock:\n layerBlocks.replaceDataSource(dirpath(dirpath(layerBlocks.dataSource)),\n 'FILEGDB_WORKSPACE',basepath(selectedBlock))\nif layerStops.dataSource != selectedBusStop:\n layerStops.replaceDataSource(dirpath(dirpath(layerStops.dataSource)),\n 'FILEGDB_WORKSPACE',basepath(selectedBusStop))\nif layerBuffer.dataSource != selectedStopBuffer:\n layerBuffer.replaceDataSource(dirpath(dirpath(layerBuffer.dataSource)),\n 'FILEGDB_WORKSPACE',basepath(selectedStopBuffer))\nlayerStops.visible = True\nlayerBuffer.visible = True\nlayerCensus.visible = False\nwith arcpy.da.SearchCursor(Bus_Stops,['SHAPE@','STOPID','NAME',\n 'BUS_SIGNAG' ,'OID@','SHAPE@XY'],sql) as cursor:\n for row in cursor:\n stopPointGeometry = row[0]\n stopBuffer = stopPointGeometry.buffer(bufferDist)\n with arcpy.da.UpdateCursor(layerBlocks,['OID@']) as dcursor:\n for drow in dcursor:\n dcursor.deleteRow()\n arcpy.SelectLayerByLocation_management('blocks_lyr', 'intersect', stopBuffer, \"\", \"NEW_SELECTION\")\n with arcpy.da.SearchCursor('blocks_lyr',['SHAPE@','POP10','OID@']) as bcursor:\n inCursor = arcpy.da.InsertCursor(selectedBlock,['SHAPE@','POP10'])\n for drow in bcursor: \n data = drow[0],drow[1]\n inCursor.insertRow(data)\n del inCursor\n with arcpy.da.UpdateCursor(selectedBusStop,['OID@']) as dcursor:\n for drow in dcursor:\n dcursor.deleteRow()\n inBusStopCursor = arcpy.da.InsertCursor(selectedBusStop,['SHAPE@'])\n data = [row[0]]\n inBusStopCursor.insertRow(data)\n del inBusStopCursor\n with arcpy.da.UpdateCursor(selectedStopBuffer,['OID@']) as dcursor:\n for drow in dcursor:\n dcursor.deleteRow()\n inBufferCursor = arcpy.da.InsertCursor(selectedStopBuffer,['SHAPE@'])\n data = [stopBuffer]\n inBufferCursor.insertRow(data)\n del inBufferCursor\n layerStops.name = \"Stop #{0}\".format(row[1])\n arcpy.RefreshActiveView()\n dataFrame.extent = arcpy.Extent(row[-1][0]-1200,row[-1][1]-1200,\n row[-1][0]+1200,row[-1][1]-1200)\n subTitleText.text = \"Route {0}\".format(row[2])\n titleText.text = \"Bus Stop {0}\".format(row[1])\n outPath  = pdfFolder.format( str(row[1])+ \"_\" + str(row[-2])) + '.pdf'\n print outPath\n arcpy.mapping.ExportToPDF(mxdObject,outPath)\n titleText.text = 'Title Element'\n subTitleText.text = 'Subtitle Element'\n arcpy.RefreshActiveView()\n\n```", "```py\nimport arcpy, os\nBus_Stops = r\"C:\\Projects\\SanFrancisco.gdb\\Bus_Stops\"\nselectedBusStop = r'C:\\Projects\\SanFrancisco.gdb\\Chapter8Results\\SelectedBusStop'\nselectedStopBuffer = r'C:\\Projects\\SanFrancisco.gdb\\Chapter8Results\\SelectedStopBuffer'\nCensusBlocks2010 = r\"C:\\Projects\\SanFrancisco.gdb\\CensusBlocks2010\"\nselectedBlock = r'C:\\Projects\\SanFrancisco.gdb\\Chapter8Results\\SelectedCensusData'\npdfFolder = r'C:\\Projects\\PDFs\\Chapter8\\Map_{0}'\nbufferDist = 400\nsql = \"(NAME = '71 IB' AND BUS_SIGNAG = 'Ferry Plaza')\"\n\n```", "```py\nmxdObject = arcpy.mapping.MapDocument(\"CURRENT\")\ndataFrame = arcpy.mapping.ListDataFrames(mxdObject, \"Layers\")[0]\nelements = arcpy.mapping.ListLayoutElements(mxdObject)\nfor el in elements:\n if el.type ==\"TEXT_ELEMENT\":\n if el.text == 'Title Element':\n titleText = el\n elif el.text == 'Subtitle Element':\n subTitleText = el\n\n```", "```py\narcpy.MakeFeatureLayer_management(CensusBlocks2010, 'blocks_lyr') \nlayersList = arcpy.mapping.ListLayers(mxdObject,\"\",dataFrame)\nlayerStops = layersList[0]\nlayerCensus = layersList[1]\nlayerBuffer = layersList[2]\nlayerBlocks = layersList[3] \n\n```", "```py\nif layerBlocks.dataSource != selectedBlock:\n layerBlocks.replaceDataSource(dirpath(dirpath(layerBlocks.dataSource)),\n 'FILEGDB_WORKSPACE',basepath(selectedBlock))\nif layerStops.dataSource != selectedBusStop:\n layerStops.replaceDataSource(dirpath(dirpath (layerStops.dataSource)),\n 'FILEGDB_WORKSPACE',basepath(selectedBusStop))\nif layerBuffer.dataSource != selectedStopBuffer:\n layerBuffer.replaceDataSource(dirpath( dirpath(layerBuffer.dataSource)),\n 'FILEGDB_WORKSPACE',basepath(selectedStopBuffer))\n\n```", "```py\nlayerStops.visible = True\nlayerBuffer.visible = True\nlayerCensus.visible = False\n\n```", "```py\nwith arcpy.da.SearchCursor(Bus_Stops,['SHAPE@','STOPID','NAME',\n 'BUS_SIGNAG' ,'OID@','SHAPE@XY'],sql) as cursor:\n for row in cursor:\n stopPointGeometry = row[0]\n stopBuffer = stopPointGeometry.buffer(bufferDist)\n with arcpy.da.UpdateCursor(layerBlocks,['OID@']) as                   dcursor:\n for drow in dcursor:\n dcursor.deleteRow()\n\n```", "```py\narcpy.SelectLayerByLocation_management('blocks_lyr', 'intersect', stopBuffer, \"\", \"NEW_SELECTION\")\n with arcpy.da.SearchCursor('blocks_lyr', ['SHAPE@', 'POP10','OID@']) as bcursor:\n inCursor = arcpy.da.InsertCursor(selectedBlock,['SHAPE@', 'POP10'])\n for drow in bcursor: \n data = drow[0],drow[1]\n inCursor.insertRow(data)\n del inCursor\n\n```", "```py\n with arcpy.da.UpdateCursor(selectedBusStop,['OID@']) as dcursor:\n for drow in dcursor:\n dcursor.deleteRow()\n inBusStopCursor = arcpy.da.InsertCursor(selectedBusStop,['SHAPE@'])\n data = [row[0]]\n inBusStopCursor.insertRow(data)\n del inBusStopCursor\n with arcpy.da.UpdateCursor(selectedStopBuffer,['OID@']) as dcursor:\n for drow in dcursor:\n dcursor.deleteRow()\n inBufferCursor = arcpy.da.InsertCursor(selectedStopBuffer,['SHAPE@'])\n data = [stopBuffer]\n inBufferCursor.insertRow(data)\n del inBufferCursor\n\n```", "```py\nlayerStops.name = \"Stop #{0}\".format(row[1])\ndataFrame.extent = arcpy.Extent(row[-1][0]-1200,row[-1][1]-1200,\n row[-1][0]+1200,row[-1][1]-1200)\nsubTitleText.text = \"Route {0}\".format(row[2])\ntitleText.text = \"Bus Stop {0}\".format(row[1])\narcpy.RefreshActiveView()\n\n```", "```py\noutPath = pdfFolder.format(str(row[1])+\"_\"+ str(row[-2]))+'.pdf'\narcpy.mapping.ExportToPDF(mxdObject,outPath)\ntitleText.text = 'Title Element'\nsubTitleText.text = 'Subtitle Element'\narcpy.RefreshActiveView()\n\n```"]