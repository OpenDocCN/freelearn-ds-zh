<html><head></head><body>
<div id="_idContainer161" class="calibre2">
<h1 class="chapter-number" id="_idParaDest-157"><a id="_idTextAnchor157" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1.1">12</span></h1>
<h1 id="_idParaDest-158" class="calibre5"><a id="_idTextAnchor158" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.2.1">Graph Databases</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.3.1">In the previous chapters, we’ve considered networks as data structures that we can analyze to extract insight into data science problems. </span><span class="kobospan" id="kobo.3.2">In this chapter, we’ll consider networks as data storage options, linking many pieces of information in a multi-relational way. </span><span class="kobospan" id="kobo.3.3">Many storage options exist but we’ll focus on an open source option that integrates well </span><span><span class="kobospan" id="kobo.4.1">with</span></span><span><a id="_idIndexMarker533" class="pcalibre calibre6 pcalibre1"/></span><span><span class="kobospan" id="kobo.5.1"> Python—</span></span><span><strong class="bold"><span class="kobospan" id="kobo.6.1">Neo4j</span></strong></span><span><span class="kobospan" id="kobo.7.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.8.1">We will cover the following topics in </span><span><span class="kobospan" id="kobo.9.1">this chapter:</span></span></p>
<ul class="calibre10">
<li class="calibre11"><span class="kobospan" id="kobo.10.1">Introduction to </span><span><span class="kobospan" id="kobo.11.1">graph databases</span></span></li>
<li class="calibre11"><span class="kobospan" id="kobo.12.1">Querying and modifying data </span><span><span class="kobospan" id="kobo.13.1">in Neo4j</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.14.1">By the end of this chapter, you’ll understand the advantages of graph databases to store network science datasets, be able to visualize graph databases and know how to query them for the quick retrieval of relevant information. </span><span class="kobospan" id="kobo.14.2">You’ll feel comfortable modifying tables by insertion and deletion. </span><span class="kobospan" id="kobo.14.3">You’ll understand how the tools in our previous chapters can help you query efficiently to find relevant data. </span><span class="kobospan" id="kobo.14.4">Let’s get started by exploring the rationale behind </span><span><span class="kobospan" id="kobo.15.1">graph databases.</span></span></p>
<h1 id="_idParaDest-159" class="calibre5"><a id="_idTextAnchor159" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.16.1">Introduction to graph databases</span></h1>
<p class="calibre3"><strong class="bold"><span class="kobospan" id="kobo.17.1">Graph databases</span></strong><span class="kobospan" id="kobo.18.1"> (databases </span><a id="_idIndexMarker534" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.19.1">that store data in network form) offer many advantages over traditional relational databases. </span><span class="kobospan" id="kobo.19.2">First, graph databases can capture and traverse hierarchical relationships. </span><span class="kobospan" id="kobo.19.3">While relational databases can capture taxonomies, they do so in different columns that are not </span><span><span class="kobospan" id="kobo.20.1">explicitly linked.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.21.1">In addition, graph databases capture complex relationships between items or groups of items explicitly by connecting them with edges. </span><span class="kobospan" id="kobo.21.2">This allows for multiway relationships to exist within the database; querying for nearest neighbors, for instance, is much easier when neighbors</span><a id="_idIndexMarker535" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.22.1"> are connected</span><a id="_idIndexMarker536" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.23.1"> by an edge and do not require estimation steps to find </span><strong class="bold"><span class="kobospan" id="kobo.24.1">Euclidean</span></strong><span class="kobospan" id="kobo.25.1"> or </span><strong class="bold"><span class="kobospan" id="kobo.26.1">Manhattan distances</span></strong><span class="kobospan" id="kobo.27.1"> between all items in </span><span><span class="kobospan" id="kobo.28.1">the database.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.29.1">Furthermore, graph databases can capture the directionality of relationships between items in the database very easily. </span><span class="kobospan" id="kobo.29.2">In a relational database, the directionality of a single relationship may involve several columns’ worth of information to capture that single relationship. </span><span class="kobospan" id="kobo.29.3">Thus, for items with complicated relationships that may be unidirectional, a graph database provides a compact representation of </span><span><span class="kobospan" id="kobo.30.1">data structure.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.31.1">Finally, within graph databases, it is possible to mine the dataset for implicit relationships that have not been programmed into the database by using network algorithms to probe for similar patterns in different parts of a network or to infer edges that don’t exist based on triadic closure. </span><span class="kobospan" id="kobo.31.2">For many datasets—such as continuously-growing </span><em class="italic"><span class="kobospan" id="kobo.32.1">-omics</span></em><span class="kobospan" id="kobo.33.1"> datasets, evolving ontologies, or other non-static datasets where knowledge is incomplete—mining the data provides new </span><span><span class="kobospan" id="kobo.34.1">research avenues.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.35.1">Now that we know a bit about the advantages of graph databases, let’s dive into specific differences</span><a id="_idIndexMarker537" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.36.1"> between graph databases and </span><span><span class="kobospan" id="kobo.37.1">relational databases.</span></span></p>
<h2 id="_idParaDest-160" class="calibre7"><a id="_idTextAnchor160" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.38.1">What is a graph database?</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.39.1">Graph databases are databases based on network science. </span><span class="kobospan" id="kobo.39.2">Rather than storing data as columns in a spreadsheet (shown in the following figure), as is done in relational databases, graph databases store data as </span><em class="italic"><span class="kobospan" id="kobo.40.1">networks</span></em><span class="kobospan" id="kobo.41.1">, with items that would occupy a row represented as a vertex connected to other vertices per relations that exist. </span><span class="kobospan" id="kobo.41.2">Column data is used to either add metadata to the vertex or connect it to other vertices. </span><span class="kobospan" id="kobo.41.3">Graph database queries rely on network science algorithms to traverse the graph, pattern-finding algorithms, and combinations of these two approaches. </span><span class="kobospan" id="kobo.41.4">Thus, queries for graph databases can become quite sophisticated without necessarily leading to a long run-time as subqueries in SQL will require. </span><span class="kobospan" id="kobo.41.5">Efficiency is a big advantage of graph databases. </span><span class="kobospan" id="kobo.41.6">Let’s look at an example of supermarket customer feedback related to customer service or products, shown in </span><span><em class="italic"><span class="kobospan" id="kobo.42.1">Figure 12</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.43.1">.1</span></em></span><span><span class="kobospan" id="kobo.44.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer141">
<span class="kobospan" id="kobo.45.1"><img alt="Figure 12.1 – An example of relational database design, where rows contain items with information organized into columns﻿ (Used with permission from Microsoft Excel)" src="image/B21087_12_01.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.46.1">Figure 12.1 – An example of relational database design, where rows contain items with information organized into columns (Used with permission from Microsoft Excel)</span></p>
<p class="calibre3"><span><em class="italic"><span class="kobospan" id="kobo.47.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.48.1">.1</span></em><span class="kobospan" id="kobo.49.1"> shows a relational database with many rows of data that exist as columns. </span><span class="kobospan" id="kobo.49.2">However, this data may be better represented as a graph database, where items relate through the columns or use columns as metadata in a queryable way. </span><span class="kobospan" id="kobo.49.3">Perhaps there are dates attached to</span><a id="_idIndexMarker538" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.50.1"> the comments that could link items by time and use the department related to the complaint </span><span><span class="kobospan" id="kobo.51.1">as metadata.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.52.1">While it is difficult to visualize a relational database, visualizing a graph database is much more straightforward. </span><span class="kobospan" id="kobo.52.2">Some graph databases come with built-in visualization tools to zoom into areas of interest or query results. </span><span class="kobospan" id="kobo.52.3">Some allow developers to build on pre-existing visualizations to tailor this feature to their needs. </span><span class="kobospan" id="kobo.52.4">When hovering over edges and vertices, most graph database visualization tools will show metadata associated with a vertex or edge, providing context for the relationships of interest pulled by the query. </span><span class="kobospan" id="kobo.52.5">Cytoscape is one of the most commonly used programs for network visualization at scale; originally, it was constructed to visualize proteomics datasets, where protein interactions are documented across organisms. </span><span class="kobospan" id="kobo.52.6">Here’s Cytoscape with demo images of the example </span><span><span class="kobospan" id="kobo.53.1">graphs: </span></span><a href="https://js.cytoscape.org/" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.54.1">https://js.cytoscape.org/</span></span></a><span><span class="kobospan" id="kobo.55.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.56.1">One of the advantages of Cytoscape is its ability to handle saved igraph networks such that analysis of very large networks can be done in Python and then visualized with Cytoscape, where the network size will not complicate visualization as it will with the igraph plotting functions. </span><span class="kobospan" id="kobo.56.2">In addition, Cytoscape offers a desktop version that should work with Java-based devices and a web interface version for those who do not have access to the desktop version. </span><span class="kobospan" id="kobo.56.3">If you are interested, you are encouraged to download Cytoscape and test out its visualization either with the datasets we use in this book or with your own datasets </span><span><span class="kobospan" id="kobo.57.1">of interest.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.58.1">Now that we understand the structure and advantages of graph databases, let’s dive into some datasets </span><a id="_idIndexMarker539" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.59.1">where a graph database may function better than a relational database with respect to organizing the information and retrieving information </span><span><span class="kobospan" id="kobo.60.1">of interest.</span></span></p>
<h2 id="_idParaDest-161" class="calibre7"><a id="_idTextAnchor161" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.61.1">What can you represent in a graph database?</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.62.1">There are many data science domains that can benefit from graph databases. </span><span class="kobospan" id="kobo.62.2">We’ll explore a few of these use cases in depth before diving into coding in one open source graph database. </span><span class="kobospan" id="kobo.62.3">Let’s start with an example </span><span><span class="kobospan" id="kobo.63.1">from epidemiology.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.64.1">Contact tracing</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.65.1">When a new epidemic</span><a id="_idIndexMarker540" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.66.1"> starts in an area, epidemiologists often employ a tool </span><a id="_idIndexMarker541" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.67.1">called </span><strong class="bold"><span class="kobospan" id="kobo.68.1">contact tracing</span></strong><span class="kobospan" id="kobo.69.1">, where data on each case is collected to connect cases to each other in the hopes of finding the outbreak source, or patient zero. </span><span class="kobospan" id="kobo.69.2">Patient zero often provides insight into the source of the epidemic—whether an animal vector, a laboratory breach, or an environmental disaster. </span><span class="kobospan" id="kobo.69.3">Epidemiologists, then, can pinpoint effective containment policies and monitor potential sources to prevent </span><span><span class="kobospan" id="kobo.70.1">future outbreaks.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.71.1">In longer outbreaks where a virus has enough time to mutate, contact tracing allows epidemiologists to study the viral evolution of an outbreak. </span><span class="kobospan" id="kobo.71.2">During the COVID-19 pandemic, we saw many mutations of COVID-19 with different rates of mortality and different symptomologies, some of which did not respond well to current vaccines or treatments to which prior strains had responded. </span><span class="kobospan" id="kobo.71.3">Early identification of new mutations and their geographic sources provides crucial information for quick response across countries </span><span><span class="kobospan" id="kobo.72.1">and continents.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.73.1">Let’s consider an example of contact tracing in a new HIV outbreak. </span><span class="kobospan" id="kobo.73.2">Let’s say we are in a mid-sized city with many neighborhoods and subpopulations. </span><span class="kobospan" id="kobo.73.3">Cases have popped up at several testing centers and hospitals over the past two months, and epidemiologists are concerned that the dominant strain in the area has mutated into a much deadlier strain of HIV, threatening the city. </span><span class="kobospan" id="kobo.73.4">Two of the main ways that HIV spreads within a population are sexual contact and sharing syringes when using drugs intravenously; this hypothetical epidemic seems to be largely contained to young populations with high rates of drug use and risky </span><span><span class="kobospan" id="kobo.74.1">sexual behaviors.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.75.1">When a case is identified, healthcare providers collect information about others potentially exposed to HIV through sexual contact or syringe sharing such that the person or the provider can inform those exposed that they are at risk of HIV. </span><span class="kobospan" id="kobo.75.2">Positive cases are identified and traced to build a network of exposure. </span><span class="kobospan" id="kobo.75.3">Typically, metadata, such as strain genomics, demographic factors, geographic histories, and exposure routes, is collected and attached to this network to quickly identify the main sources of spreading and populations most at risk given identified </span><span><span class="kobospan" id="kobo.76.1">case characteristics.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.77.1">Determining causality is not always straightforward. </span><span class="kobospan" id="kobo.77.2">Oftentimes, cases are missed when individuals do not present with illness or do not get tested regularly. </span><span class="kobospan" id="kobo.77.3">This means cases identified later in</span><a id="_idIndexMarker542" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.78.1"> an epidemic might be sources of infection. </span><span><em class="italic"><span class="kobospan" id="kobo.79.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.80.1">.2</span></em><span class="kobospan" id="kobo.81.1"> shows a small piece of a contact tracing network, where cases identified later in the epidemic through contact tracing were infected earlier than the presenting individual (</span><span><em class="italic"><span class="kobospan" id="kobo.82.1">Case #161</span></em></span><span><span class="kobospan" id="kobo.83.1">):</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer142">
<span class="kobospan" id="kobo.84.1"><img alt="Figure 12.2 – A small subsection of a contact tracing network" src="image/B21087_12_02.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.85.1">Figure 12.2 – A small subsection of a contact tracing network</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.86.1">In </span><span><em class="italic"><span class="kobospan" id="kobo.87.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.88.1">.2</span></em><span class="kobospan" id="kobo.89.1">, we see </span><em class="italic"><span class="kobospan" id="kobo.90.1">Case #161</span></em><span class="kobospan" id="kobo.91.1"> was identified (likely through a testing center or by seeking medical care). </span><span class="kobospan" id="kobo.91.2">This individual’s contacts revealed infection from </span><em class="italic"><span class="kobospan" id="kobo.92.1">Case #165</span></em><span class="kobospan" id="kobo.93.1">, who was infected by </span><em class="italic"><span class="kobospan" id="kobo.94.1">Case #173</span></em><span class="kobospan" id="kobo.95.1">. </span><span class="kobospan" id="kobo.95.2">Contact tracing also revealed another individual infected from </span><em class="italic"><span class="kobospan" id="kobo.96.1">Case #165</span></em><span class="kobospan" id="kobo.97.1"> (</span><em class="italic"><span class="kobospan" id="kobo.98.1">Case #169</span></em><span class="kobospan" id="kobo.99.1">). </span><span class="kobospan" id="kobo.99.2">Without contact tracing, at least three other cases would have been missed, leading to treatment delays and potentially more exposures and cases. </span><span class="kobospan" id="kobo.99.3">Generally, causality is established through strain analysis and information about the timing of exposures through sexual partners or syringe sharing. </span><span class="kobospan" id="kobo.99.4">These factors are included in the </span><span><span class="kobospan" id="kobo.100.1">case metadata.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.101.1">Storing case metadata and causality information in a relational database would be very difficult, as the directionality of infection is critical for studying epidemic evolution over the population and for contacting potential exposures who have not yet been tested (as case contacts can overlap and often do in this type of epidemic). </span><span class="kobospan" id="kobo.101.2">Graph databases allow for efficient storage and retrieval of this information for maximal efficiency of both contact tracing and</span><a id="_idIndexMarker543" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.102.1"> public policy formation to protect those at risk of HIV exposure in this population. </span><span class="kobospan" id="kobo.102.2">Early identification saves people from suffering and, </span><span><span class="kobospan" id="kobo.103.1">potentially, death.</span></span></p>
<h3 class="calibre9"><span class="kobospan" id="kobo.104.1">Island ecology study</span></h3>
<p class="calibre3"><span class="kobospan" id="kobo.105.1">Now that we know how </span><a id="_idIndexMarker544" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.106.1">graph databases improve analytics and outcomes for social science data, let’s consider how graph databases can improve research in conservation. </span><span class="kobospan" id="kobo.106.2">Suppose scientists have identified a new island in a remote area long isolated from mainland populations. </span><span><em class="italic"><span class="kobospan" id="kobo.107.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.108.1">.3</span></em><span class="kobospan" id="kobo.109.1"> shows the </span><span><span class="kobospan" id="kobo.110.1">hypothetical island:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer143">
<span class="kobospan" id="kobo.111.1"><img alt="Figure 12.3 – An﻿ illustration of an island long isolated from the mainland" src="image/B21087_12_03.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.112.1">Figure 12.3 – An illustration of an island long isolated from the mainland</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.113.1">On the island shown in </span><span><em class="italic"><span class="kobospan" id="kobo.114.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.115.1">.3</span></em><span class="kobospan" id="kobo.116.1">, we wish to document the flora and fauna that live on that island, as well as the island’s food chains. </span><span class="kobospan" id="kobo.116.2">We’ll collect information on population sizes, predator-prey relationships, and potential threats to those populations and relationships (such as climate change). </span><span class="kobospan" id="kobo.116.3">We may wish to link species into food webs to explore the </span><a id="_idIndexMarker545" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.117.1">sustainability of food sources given changes in temperature, weather, and sea levels on the island. </span><span class="kobospan" id="kobo.117.2">We may also wish to divide the island into separate ecosystems, which may be isolated in valleys with high cliffs or connected to other ecosystems on the island through migration patterns or habitat overlap. </span><span class="kobospan" id="kobo.117.3">Food webs and overlapping habitat/migration patterns create relationships between population data in our dataset, which naturally lives as a network. </span><span class="kobospan" id="kobo.117.4">We can add metadata to the vertices in our network (species or habitats) or the edges connecting them (such as seasonal information about migration patterns that might connect species from two different </span><span><span class="kobospan" id="kobo.118.1">habitats periodically).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.119.1">In this conservation example, we’ll likely have more than one dataset collected. </span><span class="kobospan" id="kobo.119.2">We might have several different food webs from different geographies. </span><span class="kobospan" id="kobo.119.3">We may also have habitat overlap datasets connecting geographies on the island that connect to our food webs, such as metadata on population size estimates, ecosystem health indicators, and </span><span><span class="kobospan" id="kobo.120.1">seasonal patterns.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.121.1">Connecting many datasets, some of which include hierarchical relationships, is quite tricky in relational databases; however, it is easy when using graph databases. </span><span class="kobospan" id="kobo.121.2">Different types of edges can connect different vertices in collected networks to link each network and the metadata contained in each network collected. </span><span class="kobospan" id="kobo.121.3">This makes querying and exploring potential relationships that are not explicitly defined (perhaps not collected due to time constraints or difficulty of terrain navigation) much easier </span><span><span class="kobospan" id="kobo.122.1">for conservationists.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.123.1">From this data and exploration of its graph database, it is possible to infer and define protected areas on the island in which many food webs connect or are isolated regions with large biodiversity. </span><span class="kobospan" id="kobo.123.2">This protects species from human activities or climate change threats and allows researchers to focus limited funding on monitoring areas critical to the overall ecosystem. </span><span class="kobospan" id="kobo.123.3">In addition, as further expeditions and conservation efforts collect new data, the graph database setup allows researchers to test hypothesized links between ecosystems or food webs that were not directly observed in the first </span><span><span class="kobospan" id="kobo.124.1">pass expedition.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.125.1">Now that we</span><a id="_idIndexMarker546" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.126.1"> understand a bit about datasets that will benefit from graph database storage solutions, let’s turn our attention to Neo4j, an open source graph </span><span><span class="kobospan" id="kobo.127.1">database option.</span></span></p>
<h1 id="_idParaDest-162" class="calibre5"><a id="_idTextAnchor162" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.128.1">Querying and modifying data in Neo4j</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.129.1">Before we start</span><a id="_idIndexMarker547" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.130.1"> using Neo4j, we’ll need to download and install the software on our machines. </span><span class="kobospan" id="kobo.130.2">You can follow this link to reach the Neo4j Desktop download </span><span><span class="kobospan" id="kobo.131.1">page: </span></span><a href="https://neo4j.com/download/" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.132.1">https://neo4j.com/download/</span></span></a><span><span class="kobospan" id="kobo.133.1">.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.134.1">You should see a page that looks like this, where you can download Neo4j by clicking on the </span><span><strong class="bold"><span class="kobospan" id="kobo.135.1">Download</span></strong></span><span><span class="kobospan" id="kobo.136.1"> button:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer144">
<span class="kobospan" id="kobo.137.1"><img alt="Figure 12.4 – Neo4j download site" src="image/B21087_12_04.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.138.1">Figure 12.4 – Neo4j download site</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.139.1">After hitting</span><a id="_idIndexMarker548" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.140.1"> the </span><strong class="bold"><span class="kobospan" id="kobo.141.1">Download</span></strong><span class="kobospan" id="kobo.142.1"> button in </span><span><em class="italic"><span class="kobospan" id="kobo.143.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.144.1">.4</span></em><span class="kobospan" id="kobo.145.1">, you’ll be prompted to follow the installer instructions to complete the installation. </span><span class="kobospan" id="kobo.145.2">When the installer finishes, you’ll see an icon or will have launched Neo4j directly on your machine from the installation process. </span><span class="kobospan" id="kobo.145.3">This should take you to a page that looks </span><span><span class="kobospan" id="kobo.146.1">like this:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer145">
<span class="kobospan" id="kobo.147.1"><img alt="Figure 12.5 – The start page of Neo4j" src="image/B21087_12_05.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.148.1">Figure 12.5 – The start page of Neo4j</span></p>
<p class="calibre3"><span><em class="italic"><span class="kobospan" id="kobo.149.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.150.1">.5</span></em><span class="kobospan" id="kobo.151.1"> shows the free Desktop version of Neo4j on a </span><span><span class="kobospan" id="kobo.152.1">Windows machine.</span></span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.153.1">Note</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.154.1">There is already an example project ready to explore </span><span><span class="kobospan" id="kobo.155.1">or query.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.156.1">We’ll work on</span><a id="_idIndexMarker549" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.157.1"> some basic queries with this data, but if you wish to explore this database prior to querying, click on </span><strong class="bold"><span class="kobospan" id="kobo.158.1">Movie DBMS</span></strong><span class="kobospan" id="kobo.159.1"> and hit the </span><strong class="bold"><span class="kobospan" id="kobo.160.1">Start</span></strong><span class="kobospan" id="kobo.161.1"> button to run the database on your machine; when you finish exploring, make sure to hit the </span><strong class="bold"><span class="kobospan" id="kobo.162.1">Stop</span></strong><span class="kobospan" id="kobo.163.1"> button to cache the </span><span><span class="kobospan" id="kobo.164.1">database again.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.165.1">The query language used by Neo4j is</span><a id="_idIndexMarker550" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.166.1"> called </span><strong class="bold"><span class="kobospan" id="kobo.167.1">Cypher</span></strong><span class="kobospan" id="kobo.168.1">. </span><span class="kobospan" id="kobo.168.2">While it functions similarly to SQL, Cypher also contains graph theoretic operations to examine relationships and connectivity within the network. </span><span class="kobospan" id="kobo.168.3">The </span><strong class="source-inline"><span class="kobospan" id="kobo.169.1">Match</span></strong><span class="kobospan" id="kobo.170.1"> command functions much like SQL’s </span><strong class="source-inline"><span class="kobospan" id="kobo.171.1">SELECT</span></strong><span class="kobospan" id="kobo.172.1"> command, and operations such as </span><strong class="source-inline"><span class="kobospan" id="kobo.173.1">limit</span></strong><span class="kobospan" id="kobo.174.1"> and </span><strong class="source-inline"><span class="kobospan" id="kobo.175.1">as</span></strong><span class="kobospan" id="kobo.176.1"> also exist in Cypher. </span><span class="kobospan" id="kobo.176.2">However, operations that retrieve directional relationships (edges) between objects in the database (vertices) also exist to query specific types of relationships that might exist. </span><span class="kobospan" id="kobo.176.3">We’ll see more of this in action as we explore the Movie DBMS (database management system) database </span><a id="_idIndexMarker551" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.177.1">on Neo4j’s </span><span><span class="kobospan" id="kobo.178.1">Desktop application.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.179.1">Now, let’s </span><span><span class="kobospan" id="kobo.180.1">explore Neo4j.</span></span></p>
<h2 id="_idParaDest-163" class="calibre7"><a id="_idTextAnchor163" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.181.1">Basic query example</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.182.1">When you open your</span><a id="_idIndexMarker552" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.183.1"> Neo4j Desktop application, you’ll see an </span><strong class="source-inline"><span class="kobospan" id="kobo.184.1">Example Project</span></strong><span class="kobospan" id="kobo.185.1"> folder. </span><span class="kobospan" id="kobo.185.2">When you hover over the </span><strong class="bold"><span class="kobospan" id="kobo.186.1">Movie DBMS</span></strong><span class="kobospan" id="kobo.187.1"> label on the right-hand side of the screen, you’ll see a </span><strong class="bold"><span class="kobospan" id="kobo.188.1">Start</span></strong><span class="kobospan" id="kobo.189.1"> button that launches the connection to this database (shown in </span><span><em class="italic"><span class="kobospan" id="kobo.190.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.191.1">.6</span></em><span class="kobospan" id="kobo.192.1">). </span><span class="kobospan" id="kobo.192.2">Click </span><span><span class="kobospan" id="kobo.193.1">on </span></span><span><strong class="bold"><span class="kobospan" id="kobo.194.1">Start</span></strong></span><span><span class="kobospan" id="kobo.195.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer146">
<span class="kobospan" id="kobo.196.1"><img alt="Figure 12.6 – The Start button to launch the Movie DBMS database" src="image/B21087_12_06.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.197.1">Figure 12.6 – The Start button to launch the Movie DBMS database</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.198.1">As shown in </span><span><em class="italic"><span class="kobospan" id="kobo.199.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.200.1">.6</span></em><span class="kobospan" id="kobo.201.1">, once you have launched the Movie DBMS database by clicking </span><strong class="bold"><span class="kobospan" id="kobo.202.1">Start</span></strong><span class="kobospan" id="kobo.203.1">, you’ll have a connection to this database. </span><span class="kobospan" id="kobo.203.2">It may take a few minutes to launch this database. </span><span class="kobospan" id="kobo.203.3">It is possible that you may not be familiar with Neo4j before reading this chapter, so we’ll click on the </span><strong class="source-inline"><span class="kobospan" id="kobo.204.1">about-movies.neo4j-browser-guide</span></strong><span class="kobospan" id="kobo.205.1"> file option and run through a few examples of queries to become familiar with Cypher’s syntax </span><span><span class="kobospan" id="kobo.206.1">and results.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.207.1">You’ll see a page like </span><span><em class="italic"><span class="kobospan" id="kobo.208.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.209.1">.7</span></em><span class="kobospan" id="kobo.210.1"> when you click on the </span><strong class="source-inline"><span class="kobospan" id="kobo.211.1">about-movies.neo4j-browser-guide</span></strong><span class="kobospan" id="kobo.212.1"> file option. </span><span class="kobospan" id="kobo.212.2">The first page shows a basic query pulling data on an actor. </span><span class="kobospan" id="kobo.212.3">Here, we’ll change the actor to </span><strong class="source-inline"><span class="kobospan" id="kobo.213.1">Brad Pitt</span></strong><span class="kobospan" id="kobo.214.1"> and query the graph for instances of </span><strong class="source-inline"><span class="kobospan" id="kobo.215.1">Brad Pitt</span></strong><span class="kobospan" id="kobo.216.1">. </span><span class="kobospan" id="kobo.216.2">When you have the code changed to what is shown in </span><span><em class="italic"><span class="kobospan" id="kobo.217.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.218.1">.7</span></em><span class="kobospan" id="kobo.219.1">, hit the arrow to run the code. </span><span class="kobospan" id="kobo.219.2">Note that you’ll see the default tutorial below the code you write. </span><span class="kobospan" id="kobo.219.3">We aren’t showing this in our Neo4j query images but it will appear on </span><span><span class="kobospan" id="kobo.220.1">your screen:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer147">
<span class="kobospan" id="kobo.221.1"><img alt="Figure 12.7 – A basic Cypher query that searches for Brad Pitt" src="image/B21087_12_07.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.222.1">Figure 12.7 – A basic Cypher query that searches for Brad Pitt</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.223.1">This database does not contain any information about Brad Pitt. </span><span class="kobospan" id="kobo.223.2">Running the suggested query on </span><strong class="source-inline"><span class="kobospan" id="kobo.224.1">Tom Hanks</span></strong><span class="kobospan" id="kobo.225.1"> does produce information in JSON form, as this data does not contain graph elements. </span><span class="kobospan" id="kobo.225.2">You should see something like </span><span><em class="italic"><span class="kobospan" id="kobo.226.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.227.1">.8</span></em><span class="kobospan" id="kobo.228.1"> when you query the</span><a id="_idIndexMarker553" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.229.1"> database for </span><span><strong class="source-inline"><span class="kobospan" id="kobo.230.1">Tom Hanks</span></strong></span><span><span class="kobospan" id="kobo.231.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer148">
<span class="kobospan" id="kobo.232.1"><img alt="Figure 12.8 – The result of our query for Tom Hanks in Movie DBMS" src="image/B21087_12_08.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.233.1">Figure 12.8 – The result of our query for Tom Hanks in Movie DBMS</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.234.1">Let’s go to the next page of the guide and add an actor to the database. </span><span class="kobospan" id="kobo.234.2">We’ll add Brad Pitt, as our query came back empty initially. </span><span><em class="italic"><span class="kobospan" id="kobo.235.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.236.1">.9</span></em><span class="kobospan" id="kobo.237.1"> shows how to add an actor to the database along with their </span><span><span class="kobospan" id="kobo.238.1">birth year.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer149">
<span class="kobospan" id="kobo.239.1"><img alt="Figure 12.9 – Instructions to create an entry for Brad Pitt" src="image/B21087_12_09.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.240.1">Figure 12.9 – Instructions to create an entry for Brad Pitt</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.241.1">When we run the code from </span><span><em class="italic"><span class="kobospan" id="kobo.242.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.243.1">.9</span></em><span class="kobospan" id="kobo.244.1">, Neo4j shows us a vertex with Brad Pitt’s information, as seen in </span><span><em class="italic"><span class="kobospan" id="kobo.245.1">Figure 12</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.246.1">.10</span></em></span><span><span class="kobospan" id="kobo.247.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer150">
<span class="kobospan" id="kobo.248.1"><img alt="Figure 12.10 – The result of creating Brad Pitt’s entry" src="image/B21087_12_10.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.249.1">Figure 12.10 – The result of creating Brad Pitt’s entry</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.250.1">We can add a</span><a id="_idIndexMarker554" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.251.1"> movie associated with </span><strong class="source-inline"><span class="kobospan" id="kobo.252.1">Brad Pitt</span></strong><span class="kobospan" id="kobo.253.1">, in this case, </span><strong class="source-inline"><span class="kobospan" id="kobo.254.1">Seven Years in Tibet</span></strong><span class="kobospan" id="kobo.255.1">, as shown in </span><span><em class="italic"><span class="kobospan" id="kobo.256.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.257.1">.11</span></em><span class="kobospan" id="kobo.258.1">’s code in the </span><span><span class="kobospan" id="kobo.259.1">top line:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer151">
<span class="kobospan" id="kobo.260.1"><img alt="Figure 12.11 – Cypher code to add a movie associated with Brad Pitt" src="image/B21087_12_11.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.261.1">Figure 12.11 – Cypher code to add a movie associated with Brad Pitt</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.262.1">When we run this Cypher</span><a id="_idIndexMarker555" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.263.1"> code, we see another graph database vertex appear, as shown in </span><span><em class="italic"><span class="kobospan" id="kobo.264.1">Figure 12</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.265.1">.12</span></em></span><span><span class="kobospan" id="kobo.266.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer152">
<span class="kobospan" id="kobo.267.1"><img alt="Figure 12.12 – The result of running the Cypher query from Figure 12.11" src="image/B21087_12_12.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.268.1">Figure 12.12 – The result of running the Cypher query from Figure 12.11</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.269.1">Just as we can add to our graph database, we can also delete individual records from the database. </span><span class="kobospan" id="kobo.269.2">Let’s delete the records we just created for </span><strong class="source-inline"><span class="kobospan" id="kobo.270.1">Brad Pitt</span></strong><span class="kobospan" id="kobo.271.1">. </span><span><em class="italic"><span class="kobospan" id="kobo.272.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.273.1">.13</span></em><span class="kobospan" id="kobo.274.1"> shows the deletion of the record for </span><strong class="source-inline"><span class="kobospan" id="kobo.275.1">Brad Pitt</span></strong><span class="kobospan" id="kobo.276.1">. </span><span class="kobospan" id="kobo.276.2">I urge you to try deleting </span><strong class="source-inline"><span class="kobospan" id="kobo.277.1">Seven Years in Tibet</span></strong><span class="kobospan" id="kobo.278.1"> before moving on to the next task in </span><span><span class="kobospan" id="kobo.279.1">this chapter:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer153">
<span class="kobospan" id="kobo.280.1"><img alt="Figure 12.13 – Cypher code to delete the record we created for Brad Pitt" src="image/B21087_12_13.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.281.1">Figure 12.13 – Cypher code to delete the record we created for Brad Pitt</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.282.1">We can also create or update a record in the database using the </span><strong class="source-inline"><span class="kobospan" id="kobo.283.1">MERGE</span></strong><span class="kobospan" id="kobo.284.1"> statement with a </span><strong class="source-inline"><span class="kobospan" id="kobo.285.1">CREATE</span></strong><span class="kobospan" id="kobo.286.1"> and a </span><strong class="source-inline"><span class="kobospan" id="kobo.287.1">MATCH</span></strong><span class="kobospan" id="kobo.288.1"> statement to either create a new record or update an existing record (depending on what exists in the database). </span><span class="kobospan" id="kobo.288.2">We’ll add Brad Pitt’s information back into the database using the code shown in </span><span><em class="italic"><span class="kobospan" id="kobo.289.1">Figure 12</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.290.1">.14</span></em></span><span><span class="kobospan" id="kobo.291.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer154">
<span class="kobospan" id="kobo.292.1"><img alt="Figure 12.14 – An updated example in Cypher code" src="image/B21087_12_14.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.293.1">Figure 12.14 – An updated example in Cypher code</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.294.1">When we run the code in </span><span><em class="italic"><span class="kobospan" id="kobo.295.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.296.1">.14</span></em><span class="kobospan" id="kobo.297.1">, we see </span><span><em class="italic"><span class="kobospan" id="kobo.298.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.299.1">.9</span></em><span class="kobospan" id="kobo.300.1"> appear again, where Brad Pitt’s</span><a id="_idIndexMarker556" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.301.1"> information has been added to the database. </span><span class="kobospan" id="kobo.301.2">Now that we know some basic Cypher commands, we can move on to more complicated graph database operations in the </span><span><span class="kobospan" id="kobo.302.1">next section.</span></span></p>
<h2 id="_idParaDest-164" class="calibre7"><a id="_idTextAnchor164" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.303.1">More complicated query examples</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.304.1">Now that we know </span><a id="_idIndexMarker557" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.305.1">how to execute basic queries, we can move on to more complicated operations in Neo4j, such as adding relationships between items. </span><span class="kobospan" id="kobo.305.2">Let’s connect actors and movies with a Cypher query connecting Brad Pitt to </span><em class="italic"><span class="kobospan" id="kobo.306.1">Seven Years in Tibet</span></em><span class="kobospan" id="kobo.307.1"> through his character, </span><span><span class="kobospan" id="kobo.308.1">Heinrich Harrer.</span></span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.309.1">Note</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.310.1">You’ll need to add both the movie and actor back into our database using the code in the </span><em class="italic"><span class="kobospan" id="kobo.311.1">Basic query example</span></em><span class="kobospan" id="kobo.312.1"> section before running this query. </span><span class="kobospan" id="kobo.312.2">This query is shown in </span><span><em class="italic"><span class="kobospan" id="kobo.313.1">Figure 12</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.314.1">.15</span></em></span><span><span class="kobospan" id="kobo.315.1">.</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer155">
<span class="kobospan" id="kobo.316.1"><img alt="Figure 12.15 – A Cypher query to connect Brad Pitt to his character, Heinrich Harrer, in Seven Years in Tibet " src="image/B21087_12_15.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.317.1">Figure 12.15 – A Cypher query to connect Brad Pitt to his character, Heinrich Harrer, in Seven Years in Tibet</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.318.1">Running this query returns information about the actor, the movie, and the relationship we just created</span><a id="_idIndexMarker558" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.319.1"> between the two datasets, as shown in </span><span><em class="italic"><span class="kobospan" id="kobo.320.1">Figure 12</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.321.1">.16</span></em></span><span><span class="kobospan" id="kobo.322.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer156">
<span class="kobospan" id="kobo.323.1"><img alt="Figure 12.16 – The result of Figure 12.15’s Cypher query to connect Brad Pitt to Seven Years in Tibet" src="image/B21087_12_16.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.324.1">Figure 12.16 – The result of Figure 12.15’s Cypher query to connect Brad Pitt to Seven Years in Tibet</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.325.1">The next page of the Neo4j Cypher guide shows an alternative way to create this relationship. </span><span class="kobospan" id="kobo.325.2">You are encouraged to modify that code to add another actor and movie as an exercise. </span><span class="kobospan" id="kobo.325.3">Let’s turn our attention to Cypher’s </span><strong class="source-inline"><span class="kobospan" id="kobo.326.1">WHERE</span></strong><span class="kobospan" id="kobo.327.1"> clauses, which function much as they do </span><span><span class="kobospan" id="kobo.328.1">in SQL.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.329.1">We’ll search for persons whose names start with the first name </span><strong class="source-inline"><span class="kobospan" id="kobo.330.1">Brad</span></strong><span class="kobospan" id="kobo.331.1">, which should pull up Brad Pitt’s entry, as well as any other actors whose first name is Brad. </span><span><em class="italic"><span class="kobospan" id="kobo.332.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.333.1">.17</span></em><span class="kobospan" id="kobo.334.1"> shows </span><span><span class="kobospan" id="kobo.335.1">this query:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer157">
<span class="kobospan" id="kobo.336.1"><img alt="Figure 12.17 – An example of a WHERE query in Cypher" src="image/B21087_12_17.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.337.1">Figure 12.17 – An example of a WHERE query in Cypher</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.338.1">When we run the Cypher code in </span><span><em class="italic"><span class="kobospan" id="kobo.339.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.340.1">.17</span></em><span class="kobospan" id="kobo.341.1">, we should see two instances of </span><strong class="source-inline"><span class="kobospan" id="kobo.342.1">Brad Pitt</span></strong><span class="kobospan" id="kobo.343.1"> showing</span><a id="_idIndexMarker559" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.344.1"> up in our database, as shown in </span><span><em class="italic"><span class="kobospan" id="kobo.345.1">Figure 12</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.346.1">.18</span></em></span><span><span class="kobospan" id="kobo.347.1">:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer158">
<span class="kobospan" id="kobo.348.1"><img alt="Figure 12.18 – Results from Figure 12.17’s WHERE Cypher query" src="image/B21087_12_18.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.349.1">Figure 12.18 – Results from Figure 12.17’s WHERE Cypher query</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.350.1">We can also match based on relationships, such as finding movies associated with an actor. </span><span class="kobospan" id="kobo.350.2">Let’s try a Cypher query on relationships to find all of the movies associated with Brad Pitt (here, just </span><strong class="source-inline"><span class="kobospan" id="kobo.351.1">Seven Years in Tibet</span></strong><span class="kobospan" id="kobo.352.1">, as we added this relationship). </span><span><em class="italic"><span class="kobospan" id="kobo.353.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.354.1">.19</span></em><span class="kobospan" id="kobo.355.1"> shows the query we’ll use to query </span><span><span class="kobospan" id="kobo.356.1">a relationship:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer159">
<span class="kobospan" id="kobo.357.1"><img alt="Figure 12.19 – A Cypher query on graph relationships between people and movies" src="image/B21087_12_19.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.358.1">Figure 12.19 – A Cypher query on graph relationships between people and movies</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.359.1">When we run the Cypher query shown in </span><span><em class="italic"><span class="kobospan" id="kobo.360.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.361.1">.19</span></em><span class="kobospan" id="kobo.362.1">, we see the connections between our</span><a id="_idIndexMarker560" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.363.1"> instances of </span><strong class="source-inline"><span class="kobospan" id="kobo.364.1">Brad Pitt</span></strong><span class="kobospan" id="kobo.365.1"> and </span><strong class="source-inline"><span class="kobospan" id="kobo.366.1">Seven Years in Tibet</span></strong><span class="kobospan" id="kobo.367.1"> shown in graph form (</span><span><em class="italic"><span class="kobospan" id="kobo.368.1">Figure 12</span></em></span><span><em class="italic"><span class="kobospan" id="kobo.369.1">.20</span></em></span><span><span class="kobospan" id="kobo.370.1">):</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer160">
<span class="kobospan" id="kobo.371.1"><img alt="Figure 12.20 – The results of Figure 12.19’s graph relationship query" src="image/B21087_12_20.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.372.1">Figure 12.20 – The results of Figure 12.19’s graph relationship query</span></p>
<p class="calibre3"><span><em class="italic"><span class="kobospan" id="kobo.373.1">Figure 12</span></em></span><em class="italic"><span class="kobospan" id="kobo.374.1">.20</span></em><span class="kobospan" id="kobo.375.1"> shows the essential strengths of a graph database. </span><span class="kobospan" id="kobo.375.2">We can see relationships that connect different items across tables (here, the </span><strong class="source-inline"><span class="kobospan" id="kobo.376.1">Person</span></strong><span class="kobospan" id="kobo.377.1"> table and the </span><strong class="source-inline"><span class="kobospan" id="kobo.378.1">Movie</span></strong><span class="kobospan" id="kobo.379.1"> table), as well as the nature of that relationship. </span><span class="kobospan" id="kobo.379.2">It’s easy to see an actor connected to a movie, and should more movies exist, we’d have an easy visualization of our query results from this graph-based query </span><span><span class="kobospan" id="kobo.380.1">in Neo4j.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.381.1">While this movie database contains basic tables and relationships, we can imagine our examples in the </span><em class="italic"><span class="kobospan" id="kobo.382.1">What can you represent in a graph database?</span></em><span class="kobospan" id="kobo.383.1"> section containing much more complicated relationships between many more tables. </span><span class="kobospan" id="kobo.383.2">Visualizing query results in graph form across tables and items in tables provides easy-to-understand summaries of the data and relationships of interest in a query. </span><span class="kobospan" id="kobo.383.3">Herein lies the power of graph databases. </span><span class="kobospan" id="kobo.383.4">Queries tend to be quick, even for queries with many subqueries or when searching very large tables and their relations, and visualizations of results allow users to explore relationships in depth across tables (or provide succinct visuals for </span><span><span class="kobospan" id="kobo.384.1">a report).</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.385.1">If you wish to explore Neo4j further, Neo4j’s AuraDB allows users to connect to the database through Python by establishing an account and connecting to Neo4j with an API in Python using the </span><strong class="source-inline"><span class="kobospan" id="kobo.386.1">neo4j</span></strong><span class="kobospan" id="kobo.387.1"> package and </span><strong class="source-inline"><span class="kobospan" id="kobo.388.1">GraphDatabase.driver()</span></strong><span class="kobospan" id="kobo.389.1"> function to create </span><span><span class="kobospan" id="kobo.390.1">the connection.</span></span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.391.1">Note</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.392.1">For any large databases or databases you wish to permanently save, you’ll need a </span><span><span class="kobospan" id="kobo.393.1">paid account.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.394.1">Once the database is created, you can query the Neo4j database through Python’s </span><strong class="source-inline"><span class="kobospan" id="kobo.395.1">neo4j driver.execute_query()</span></strong><span class="kobospan" id="kobo.396.1"> statement and import the data as a network in igraph to analyze the results. </span><span class="kobospan" id="kobo.396.2">This provides a powerful combination of graph storage and graph analysis</span><a id="_idIndexMarker561" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.397.1"> for your analytics projects. </span><span class="kobospan" id="kobo.397.2">If you are interested, you are encouraged to explore Neo4j further and create your own connected projects between igraph and Neo4j’s </span><span><span class="kobospan" id="kobo.398.1">AuraDB accounts.</span></span></p>
<h1 id="_idParaDest-165" class="calibre5"><a id="_idTextAnchor165" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.399.1">Summary</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.400.1">In this chapter, we examined cases where graph databases are advantageous, familiarized ourselves with an open source graph database called Neo4j, and learned a bit about the query language of Neo4j, called Cypher. </span><span class="kobospan" id="kobo.400.2">We created, deleted, and modified records in a Neo4j movie database. </span><span class="kobospan" id="kobo.400.3">We explored the advantages of querying graph databases and the unique query result visualizations possible with graph databases. </span><span class="kobospan" id="kobo.400.4">If you are interested, I encourage you to consult Cypher and Neo4j resources to dive deeper into what is possible with </span><span><span class="kobospan" id="kobo.401.1">graph databases.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.402.1">In the next chapter, we’ll be putting together all of the skills we’ve learned in the book so far to tackle a real-world problem of predicting Ebola outbreak severity over time and geography across regions of the Democratic Republic </span><span><span class="kobospan" id="kobo.403.1">of Congo.</span></span></p>
<h1 id="_idParaDest-166" class="calibre5"><a id="_idTextAnchor166" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.404.1">References</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.405.1">Adler, M. </span><span class="kobospan" id="kobo.405.2">W., and Johnson, A. </span><span class="kobospan" id="kobo.405.3">M. </span><span class="kobospan" id="kobo.405.4">(1988). </span><em class="italic"><span class="kobospan" id="kobo.406.1">Contact tracing for HIV infection</span></em><span class="kobospan" id="kobo.407.1">. </span><em class="italic"><span class="kobospan" id="kobo.408.1">British Medical Journal (Clinical research ed.)</span></em><span class="kobospan" id="kobo.409.1">, </span><span><em class="italic"><span class="kobospan" id="kobo.410.1">296</span></em></span><span><span class="kobospan" id="kobo.411.1">(6634), 1420.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.412.1">Angles, R., Arenas, M., Barceló, P., Hogan, A., Reutter, J., and Vrgoč, D. </span><span class="kobospan" id="kobo.412.2">(2017). </span><em class="italic"><span class="kobospan" id="kobo.413.1">Foundations of modern query languages for graph databases</span></em><span class="kobospan" id="kobo.414.1">. </span><em class="italic"><span class="kobospan" id="kobo.415.1">ACM Computing Surveys (CSUR)</span></em><span class="kobospan" id="kobo.416.1">, </span><span><em class="italic"><span class="kobospan" id="kobo.417.1">50</span></em></span><span><span class="kobospan" id="kobo.418.1">(5), 1–40.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.419.1">Beas-Luna, R., Novak, M., Carr, M. </span><span class="kobospan" id="kobo.419.2">H., Tinker, M. </span><span class="kobospan" id="kobo.419.3">T., Black, A., Caselle, J. </span><span class="kobospan" id="kobo.419.4">E., ... </span><span class="kobospan" id="kobo.419.5">and Iles, A. </span><span class="kobospan" id="kobo.419.6">(2014). </span><em class="italic"><span class="kobospan" id="kobo.420.1">An online database for informing ecological network models</span></em><span class="kobospan" id="kobo.421.1">: </span><a href="http://kelpforest" class="pcalibre calibre6 pcalibre1"><span class="kobospan" id="kobo.422.1">http://kelpforest</span></a><span class="kobospan" id="kobo.423.1">. </span><span class="kobospan" id="kobo.423.2">ucsc. </span><span class="kobospan" id="kobo.423.3">edu. </span><em class="italic"><span class="kobospan" id="kobo.424.1">PloS one</span></em><span class="kobospan" id="kobo.425.1">, </span><span><em class="italic"><span class="kobospan" id="kobo.426.1">9</span></em></span><span><span class="kobospan" id="kobo.427.1">(10), e109356.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.428.1">Hyman, J. </span><span class="kobospan" id="kobo.428.2">M., Li, J., and Stanley, E. </span><span class="kobospan" id="kobo.428.3">A. </span><span class="kobospan" id="kobo.428.4">(2003). </span><em class="italic"><span class="kobospan" id="kobo.429.1">Modeling the impact of random screening and contact tracing in reducing the spread of HIV</span></em><span class="kobospan" id="kobo.430.1">. </span><em class="italic"><span class="kobospan" id="kobo.431.1">Mathematical biosciences</span></em><span class="kobospan" id="kobo.432.1">, </span><span><em class="italic"><span class="kobospan" id="kobo.433.1">181</span></em></span><span><span class="kobospan" id="kobo.434.1">(1), 17–54.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.435.1">Mueller, W., Rudowicz-Nawrocka, J., Otrzasek, J., Idziaszek, P., and Weres, J. </span><span class="kobospan" id="kobo.435.2">(2016). </span><em class="italic"><span class="kobospan" id="kobo.436.1">Spatial data and graph databases for identifying relations among members of cattle herd</span></em><span class="kobospan" id="kobo.437.1">. </span><em class="italic"><span class="kobospan" id="kobo.438.1">International Multidisciplinary Scientific GeoConference: SGEM</span></em><span class="kobospan" id="kobo.439.1">, </span><span><em class="italic"><span class="kobospan" id="kobo.440.1">1</span></em></span><span><span class="kobospan" id="kobo.441.1">, 835–841.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.442.1">Pasquale, D. </span><span class="kobospan" id="kobo.442.2">K., Doherty, I. </span><span class="kobospan" id="kobo.442.3">A., Leone, P. </span><span class="kobospan" id="kobo.442.4">A., Dennis, A. </span><span class="kobospan" id="kobo.442.5">M., Samoff, E., Jones, C. </span><span class="kobospan" id="kobo.442.6">S., ... </span><span class="kobospan" id="kobo.442.7">and Miller, W. </span><span class="kobospan" id="kobo.442.8">C. </span><span class="kobospan" id="kobo.442.9">(2021). </span><em class="italic"><span class="kobospan" id="kobo.443.1">Lost and found: applying network analysis to public health contact tracing for HIV</span></em><span class="kobospan" id="kobo.444.1">. </span><em class="italic"><span class="kobospan" id="kobo.445.1">Applied network science</span></em><span class="kobospan" id="kobo.446.1">, </span><span><em class="italic"><span class="kobospan" id="kobo.447.1">6</span></em></span><span><span class="kobospan" id="kobo.448.1">, 1–16.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.449.1">Pokorný, J. </span><span class="kobospan" id="kobo.449.2">(2015). </span><em class="italic"><span class="kobospan" id="kobo.450.1">Graph databases: their power and limitations</span></em><span class="kobospan" id="kobo.451.1">. </span><span class="kobospan" id="kobo.451.2">In </span><em class="italic"><span class="kobospan" id="kobo.452.1">Computer Information Systems and Industrial Management: 14th IFIP TC 8 International Conference, CISIM 2015, Warsaw, Poland, September 24-26, 2015, Proceedings 14</span></em><span class="kobospan" id="kobo.453.1"> (pp. </span><span class="kobospan" id="kobo.453.2">58-69). </span><span class="kobospan" id="kobo.453.3">Springer </span><span><span class="kobospan" id="kobo.454.1">International Publishing.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.455.1">Robinson, I., Webber, J., and Eifrem, E. </span><span class="kobospan" id="kobo.455.2">(2015). </span><em class="italic"><span class="kobospan" id="kobo.456.1">Graph databases: new opportunities for connected data</span></em><span class="kobospan" id="kobo.457.1">. </span><span class="kobospan" id="kobo.457.2">O’Reilly </span><span><span class="kobospan" id="kobo.458.1">Media, Inc..</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.459.1">Shannon, P., Markiel, A., Ozier, O., Baliga, N. </span><span class="kobospan" id="kobo.459.2">S., Wang, J. </span><span class="kobospan" id="kobo.459.3">T., Ramage, D., ... </span><span class="kobospan" id="kobo.459.4">and Ideker, T. </span><span class="kobospan" id="kobo.459.5">(2003). </span><em class="italic"><span class="kobospan" id="kobo.460.1">Cytoscape: a software environment for integrated models of biomolecular interaction networks</span></em><span class="kobospan" id="kobo.461.1">. </span><em class="italic"><span class="kobospan" id="kobo.462.1">Genome research</span></em><span class="kobospan" id="kobo.463.1">, </span><em class="italic"><span class="kobospan" id="kobo.464.1">13</span></em><span class="kobospan" id="kobo.465.1"> (</span><span><span class="kobospan" id="kobo.466.1">11), 2498–2504.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.467.1">Webber, J. </span><span class="kobospan" id="kobo.467.2">(2012, October). </span><em class="italic"><span class="kobospan" id="kobo.468.1">A programmatic introduction to neo4j</span></em><span class="kobospan" id="kobo.469.1">. </span><span class="kobospan" id="kobo.469.2">In </span><em class="italic"><span class="kobospan" id="kobo.470.1">Proceedings of the 3rd annual conference on Systems, programming, and applications: software for humanity</span></em><span class="kobospan" id="kobo.471.1"> (</span><span><span class="kobospan" id="kobo.472.1">pp. </span><span class="kobospan" id="kobo.472.2">217–218).</span></span></p>
</div>
</body></html>