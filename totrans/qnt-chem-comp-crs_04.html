<html><head></head><body><div><div><h1 id="_idParaDest-93"><a id="_idTextAnchor153"/>Chapter 4: Molecular Hamiltonians</h1>
			<p class="Quote">"The best that most of us can hope to achieve in physics is simply to misunderstand at a deeper level." </p>
			<p class="Quote">– Wolfgang Pauli</p>
			<div><div><img src="img/B18268_Figure_4.1.jpg" alt="" width="1650" height="725"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.1 – Wolfgang Pauli reaching for a deeper understanding of the antisymmetry related to fermionic spin [authors]</p>
			<p>At the end of Wolfgang Pauli's 1946 Nobel lecture [Pauli] he states:</p>
			<p><em class="italic">"I may express my critical opinion, that a correct theory should neither lead to infinite zero-point energies nor to infinite zero charges, that it should not use mathematical tricks to subtract infinities or singularities, nor should it invent a hypothetical world which is only a mathematical fiction before it is able to formulate the correct interpretation of the actual world of physics."</em></p>
			<p>The concepts in this chapter have a mathematical formulation and do not have a physical or chemical reality. In other words, there are standard approximations used that allow the determination of useful chemical quantities. The calculations that use the approximations do not represent exact quantities; rather, they are approximate quantities. Therefore, these approximations require a deeper understanding in order to obtain refinement and better answers. </p>
			<p>Furthermore, the approximations used in this chapter apply only to fermionic (electronic) systems. The extension to bosonic systems is an area of research by the broader scientific community. We will see the implementation and use of virtual orbitals and both occupied and unoccupied orbitals in calculations of ground state energy.</p>
			<p>We mention<a id="_idIndexMarker331"/> different levels<a id="_idIndexMarker332"/> of implementation of the <strong class="bold">Hartree-Fock</strong> (<strong class="bold">HF</strong>) theory: <strong class="bold">Restricted Hartree-Fock</strong> (<strong class="bold">RHF</strong>), <strong class="bold">Restricted Open-shell Hartree-Fock</strong> (<strong class="bold">ROHF</strong>), and <strong class="bold">Unrestricted Hartree-Fock</strong> (<strong class="bold">UHF</strong>); however, through Qiskit, we will<a id="_idIndexMarker333"/> only show RHF. There are post-HF methodologies<a id="_idIndexMarker334"/> that one can use, such as <strong class="bold">Coupled-Cluster</strong> (<strong class="bold">CC</strong>), which we will be using in <a href="B18268_05_ePub.xhtml#_idTextAnchor208"><em class="italic">Chapter 5</em></a><em class="italic">, Variational Quantum Eigensolver</em>.</p>
			<p>In this chapter, we solve the fermionic Hamiltonian equation for a hydrogen molecule and a lithium hydride molecule and will cover the following topics:</p>
			<ul>
				<li><em class="italic">Section 4.1</em>, <em class="italic">Born-Oppenheimer approximation</em></li>
				<li><em class="italic">Section 4.2</em>, <em class="italic">Fock space</em></li>
				<li><em class="italic">Section 4.3</em>, <em class="italic">Fermionic creation and annihilation operators</em></li>
				<li><em class="italic">Section 4.4</em>, <em class="italic">Molecular Hamiltonian in the Hartree-Fock orbitals basis</em></li>
				<li><em class="italic">Section 4.5</em>, <em class="italic">Basis sets</em></li>
				<li><em class="italic">Section 4.6</em>, <em class="italic">Constructing a fermionic Hamiltonian with Qiskit Nature</em></li>
				<li><em class="italic">Section 4.7</em>, <em class="italic">Fermion to qubit mappings</em></li>
				<li><em class="italic">Section 4.8</em>, <em class="italic">Constructing a qubit Hamiltonian operator with Qiskit Nature</em></li>
			</ul>
			<h1 id="_idParaDest-94"><a id="_idTextAnchor154"/>Technical requirements</h1>
			<p>We provide a link to a companion Jupyter notebook of this chapter, which has been tested in the Google Colab environment, which is free and runs entirely in the cloud, and in the IBM Quantum Lab environment. Please refer to <a href="B18268_Appendix_B_ePub.xhtml#_idTextAnchor313"><em class="italic">Appendix B</em></a><em class="italic"> – Leveraging Jupyter Notebooks in the Cloud</em>, for more information. The companion Jupyter notebook automatically installs the following list of libraries:</p>
			<ul>
				<li>NumPy [NumPy], an open source Python library that is used in almost every field of science and engineering</li>
				<li>Qiskit [Qiskit], an open source SDK for working with quantum computers at the level of pulses, circuits, and application modules</li>
				<li>Qiskit visualization support to enable the use of visualizations and Jupyter notebooks</li>
				<li>Qiskit Nature [Qiskit_Nature] [Qiskit_Nat_0], a unique platform that bridges the gap between natural sciences and quantum simulatio<a id="_idTextAnchor155"/><a id="_idTextAnchor156"/>ns</li>
				<li><strong class="bold">Python-based Simulations of Chemistry Framework</strong> (<strong class="bold">PySCF</strong>), [PySCF], an open source collection of electronic structure modules powered by Python</li>
			</ul>
			<h2 id="_idParaDest-95"><a id="_idTextAnchor157"/>Installing NumPy, Qiskit, and importing the various modules</h2>
			<p>Install NumPy with<a id="_idIndexMarker335"/> the following command:</p>
			<pre>pip install numpy</pre>
			<p>Install Qiskit<a id="_idIndexMarker336"/> with the following command:</p>
			<pre>pip install qiskit</pre>
			<p>Install Qiskit visualization support<a id="_idIndexMarker337"/> with the following command:</p>
			<pre>pip install 'qiskit[visualization]'</pre>
			<p>Install Qiskit Nature<a id="_idIndexMarker338"/> with the following command:</p>
			<pre>pip install qiskit-nature</pre>
			<p>Install PySCF with the following<a id="_idIndexMarker339"/> command:</p>
			<pre>pip install pyscf</pre>
			<p>Import NumPy<a id="_idIndexMarker340"/> with the following command:</p>
			<pre>import numpy as np</pre>
			<p>Import Matplotlib, a comprehensive<a id="_idIndexMarker341"/> library for creating static, animated, and interactive visualizations in Python with the following command:</p>
			<pre>import matplotlib.pyplot as plt</pre>
			<p>Import the required functions and class methods with the following commands. The<code> array_to_latex function()</code> returns a Latex representation of a complex array with dimension 1 or 2:</p>
			<pre>from qiskit.visualization import array_to_latex, plot_bloch_vector, plot_bloch_multivector, plot_state_qsphere, plot_state_city
from qiskit import QuantumRegister, ClassicalRegister, QuantumCircuit, transpile
from qiskit import execute, Aer
import qiskit.quantum_info as qi
from qiskit.extensions import Initialize
from qiskit.providers.aer import extensions  # import aer snapshot instructions</pre>
			<p>Import Qiskit Nature libraries<a id="_idIndexMarker342"/> with the following commands:</p>
			<pre>from qiskit import Aer
from qiskit_nature.drivers import UnitsType, Molecule
from qiskit_nature.drivers.second_quantization import ElectronicStructureDriverType, ElectronicStructureMoleculeDriver
from qiskit_nature.problems.second_quantization import ElectronicStructureProblem
from qiskit_nature.mappers.second_quantization import ParityMapper, JordanWignerMapper, BravyiKitaevMapper
from qiskit_nature.converters.second_quantization import QubitConverter
from qiskit_nature.transformers.second_quantization.electronic import ActiveSpaceTransformer, FreezeCoreTransformer
from qiskit_nature.operators.second_quantization import FermionicOp</pre>
			<p>Import the Qiskit Nature property framework<a id="_idIndexMarker343"/> with the following command:</p>
			<pre>from qiskit_nature.properties import Property, GroupedProperty</pre>
			<p>Import the <code>ElectronicEnergy</code> property<a id="_idIndexMarker344"/> with the following command:</p>
			<pre># https://qiskit.org/documentation/nature/tutorials/08_property_framework.html
from qiskit_nature.properties.second_quantization.electronic import (
    ElectronicEnergy,
    ElectronicDipoleMoment,
    ParticleNumber,
    AngularMomentum,
    Magnetization,
)</pre>
			<p>Import the <code>ElectronicIntegrals</code> property with<a id="_idIndexMarker345"/> the following command:</p>
			<pre>from qiskit_nature.properties.second_quantization.electronic.integrals import (
    ElectronicIntegrals,
    OneBodyElectronicIntegrals,
    TwoBodyElectronicIntegrals,
    IntegralProperty,
)
from qiskit_nature.properties.second_quantization.electronic.bases import ElectronicBasis</pre>
			<p>Import the math libraries<a id="_idIndexMarker346"/> with the following command:</p>
			<pre>import cma<a id="_idTextAnchor158"/><a id="_idTextAnchor159"/>th
import math</pre>
			<h1 id="_idParaDest-96"><a id="_idTextAnchor160"/>4.1. Born-Oppenheimer approximation</h1>
			<p>Recall that the atomic orbital of an electron<a id="_idIndexMarker347"/> in an atom and the molecular orbital of an electron in a molecule are time-independent stationary states. In <em class="italic">Section 2.4</em>, <em class="italic">Postulate 4 – Time-independent stationary states</em>, we introduced the time-independent Schrödinger equation:</p>
			<p><img src="img/Formulla_04_001.png" alt="" width="243" height="53"/></p>
			<p>where <img src="img/Formulla_04_002.png" alt="" width="33" height="41"/> is the non-relative Hamiltonian operator obtained by quantizing the classical energy in Hamilton form (first quantization), and it represents the total energy (<img src="img/Formulla_04_003.png" alt="" width="29" height="33"/>) of all its particles; <img src="img/Formulla_04_004.png" alt="" width="34" height="33"/> electrons and <img src="img/Formulla_04_005.png" alt="" width="38" height="33"/> nuclei. For a molecular system, the electric charge of two nuclei <img src="img/Formulla_04_006.png" alt="" width="30" height="33"/> and <img src="img/Formulla_04_007.png" alt="" width="29" height="33"/> are <img src="img/Formulla_04_008.png" alt="" width="41" height="41"/> and <img src="img/Formulla_04_009.png" alt="" width="43" height="40"/> with masses <img src="img/Formulla_04_010.png" alt="" width="54" height="41"/> and <img src="img/Formulla_04_011.png" alt="" width="57" height="43"/>. The position of the particles in the molecule<a id="_idIndexMarker348"/> is determined by using a <strong class="bold">laboratory</strong> (<strong class="bold">LAB</strong>) frame coordinate system, as shown in <em class="italic">Figure 4.2</em>, where the origin of the coordinate system is outside the molecule. The origin of the coordinate system can be placed anywhere in free space.</p>
			<div><div><img src="img/B18268_Figure_4.2.jpg" alt="" width="799" height="384"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.2 – LAB frame coordinates</p>
			<p>The Hamiltonian in the LAB frame coordinates <img src="img/Formulla_04_012.png" alt="" width="88" height="51"/> is:</p>
			<div><div><img src="img/Formulla_04_013.jpg" alt="" width="1650" height="189"/>
				</div>
			</div>
			<p>where in atomic units, the mass of the electron, the reduced Planck constant (<img src="img/Formulla_04_014.png" alt="" width="26" height="33"/>), and the electric charge (<img src="img/Formulla_04_015.png" alt="" width="21" height="24"/>) are set to the value 1. The LAB Hamiltonian<a id="_idIndexMarker349"/> comprises the sum of the kinetic energy<a id="_idIndexMarker350"/> of all particles and the potential energy between all particles with the following definitions:</p>
			<ul>
				<li><img src="img/Formulla_04_016.png" alt="" width="59" height="61"/> and <img src="img/Formulla_04_017.png" alt="" width="66" height="61"/> are the second derivative operator with respect to the position coordinates for electrons and nuclei, that is, <img src="img/Formulla_04_018.png" alt="" width="359" height="106"/>, and likewise for the <img src="img/Formulla_04_019.png" alt="" width="58" height="46"/>electron.</li>
				<li><img src="img/Formulla_04_020.png" alt="" width="275" height="58"/>, <img src="img/Formulla_04_021.png" alt="" width="287" height="59"/>, and <img src="img/Formulla_04_022.png" alt="" width="309" height="47"/> are the distances between electrons <img src="img/Formulla_04_023.png" alt="" width="25" height="34"/> and <img src="img/Formulla_04_024.png" alt="" width="22" height="34"/>, electron <img src="img/Formulla_04_025.png" alt="" width="26" height="32"/> and nucleus <img src="img/Formulla_04_026.png" alt="" width="31" height="32"/>, and nuclei <img src="img/Formulla_04_027.png" alt="" width="29" height="32"/> and <img src="img/Formulla_04_028.png" alt="" width="28" height="32"/> determined by the Euclidean norm.</li>
			</ul>
			<p>For clarity, we list the operators<a id="_idIndexMarker351"/> of the LAB Hamiltonian in <em class="italic">Figure 4.3</em>: </p>
			<div><div><img src="img/B18268_Table_01.jpg" alt="" width="1570" height="994"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.3 – Terms of the Hamiltonian operator for a molecule</p>
			<p>In the LAB Hamiltonian, the energy of the molecular system is continuous, not discrete. The <strong class="bold">center-of-mass</strong> (<strong class="bold">COM</strong>) motion does not yield<a id="_idIndexMarker352"/> any change to the energy of the internal states of the system and can be factored out. The internal states are quantized and invariant to translations. These states are not affected by translational and rotational motions in free space. The nuclei can still move around the COM through vibrations and internal rotations.</p>
			<p>In the <strong class="bold">Born-Oppenheimer</strong> (<strong class="bold">BO</strong>) approximation, we assume that the motions of the nuclei are uncoupled<a id="_idIndexMarker353"/> from the motions of the electrons, that is, a product of nuclear equations (rotational and vibrational) and electronic equations:<a id="_idTextAnchor161"/></p>
			<div><div><img src="img/Formulla_04_034.jpg" alt="" width="1110" height="48"/>
				</div>
			</div>
			<p>where <img src="img/Formulla_04_035.png" alt="" width="383" height="48"/> are the nuclear coordinates, <img src="img/Formulla_04_036.png" alt="" width="395" height="58"/> are the electron coordinates, <img src="img/Formulla_04_037.png" alt="" width="389" height="58"/> are the spin coordinates, and the electronic wave function (<img src="img/Formulla_04_038.png" alt="" width="241" height="47"/>) is the condition on the nuclear coordinates (<img src="img/Formulla_04_039.png" alt="" width="30" height="32"/>).</p>
			<p>In the BO approximation, solving for only the electronic equation with the fixed position of the nuclei can be iterated to account for the vibrations and internal rotations of the nuclei. For each iteration, the nuclei of the atoms are fixed in space and can be thought of as a violation of the Heisenberg uncertainty principle introduced in Section 1.4., <em class="italic">Light and energy</em>. The more you know exactly where a particle is, the less you know about its momentum. In general, the internal coordinate system can be placed at the heaviest atom in the molecule or at the COM.</p>
			<p>We are only dealing with electrons moving around stationary nuclei. Hence, if we ignore the kinetic energy coupling terms of the nuclei and the nuclei with electrons, the general electronic molecular Hamiltonian is a sum of four operators, as shown:</p>
			<div><div><img src="img/Formulla_04_040.jpg" alt="" width="1301" height="182"/>
				</div>
			</div>
			<p>The last term, the potential nuclear repulsion energy, is not computed and is approximated with <strong class="bold">pseudopotentials</strong> and experimental data, and<a id="_idIndexMarker354"/> we will show this in <em class="italic">Figure 4.4</em>. This approximation has limitations that we cover further in <a href="B18268_06_ePub.xhtml#_idTextAnchor228"><em class="italic">Chapter 6</em></a><em class="italic">, Beyond Born-Oppenheimer</em>, specifically through determining<a id="_idIndexMarker355"/> potential energy surfaces.</p>
			<h1 id="_idParaDest-97">4.2. Foc<a id="_idTextAnchor162"/><a id="_idTextAnchor163"/>k space</h1>
			<p>The elec<a id="_idTextAnchor164"/><a id="_idTextAnchor165"/>tronic wave function <img src="img/Formulla_04_041.png" alt="" width="241" height="45"/> includes the spatial position for each electron (<img src="img/Formulla_04_042.png" alt="" width="300" height="50"/>) conditioned on the nuclear positions (<img src="img/Formulla_04_043.png" alt="" width="308" height="45"/>) and the spin directional<a id="_idIndexMarker356"/> coordinates for each electron (<img src="img/Formulla_04_044.png" alt="" width="339" height="57"/>). The electronic wave function must be antisymmetric with respect to the exchange of pair particle labels because these particles are fermions. Please recall that this is the Pauli exclusion principle introduced in <em class="italic">Section 2.1.3</em>, <em class="italic">General formulation of the Pauli exclusion principle</em>.</p>
			<p>Now, let's consider two electrons <img src="img/Formulla_04_045.png" alt="" width="15" height="33"/> and <img src="img/Formulla_04_046.png" alt="" width="22" height="42"/> in states <img src="img/Formulla_04_047.png" alt="" width="114" height="46"/> and <img src="img/Formulla_04_048.png" alt="" width="114" height="58"/> where the corresponding electronic wave function (<img src="img/Formulla_04_049.png" alt="" width="374" height="51"/>) representing the states of the two-electron system is antisymmetric (<img src="img/Formulla_04_050.png" alt="" width="35" height="57"/>) with respect to the exchange of identical pair particles <img src="img/Formulla_04_051.png" alt="" width="90" height="58"/>:</p>
			<div><div><img src="img/Formulla_04_052.jpg" alt="" width="930" height="63"/>
				</div>
			</div>
			<div><div><img src="img/Formulla_04_053.jpg" alt="" width="1230" height="102"/>
				</div>
			</div>
			<div><div><img src="img/Formulla_04_054.jpg" alt="" width="780" height="104"/>
				</div>
			</div>
			<div><div><img src="img/Formulla_04_055.jpg" alt="" width="1230" height="101"/>
				</div>
			</div>
			<p>Since a one-body electronic wave function as presented in Section 2.1, <em class="italic">Postulate 1 – Wave functions</em>, is a product of spatial (<img src="img/Formulla_04_056.png" alt="" width="109" height="46"/>) and spin components (<img src="img/Formulla_04_057.png" alt="" width="104" height="46"/>), there are two scenarios<a id="_idIndexMarker357"/> where antisymmetry can be achieved:</p>
			<ul>
				<li>The spin function must be antisymmetric while the spatial is symmetric.</li>
				<li>The spatial function must be antisymmetric while the spin function is symmetric.</li>
			</ul>
			<p>This means that when two particles are swapped, the total molecular wave function (<img src="img/Formulla_04_058.png" alt="" width="253" height="43"/>) describing the system also changes sign: </p>
			<div><div><img src="img/Formulla_04_059.jpg" alt="" width="630" height="57"/>
				</div>
			</div>
			<p>For <img src="img/Formulla_04_060.png" alt="" width="33" height="34"/> electrons in the field of nuclei, the total wave function <img src="img/Formulla_04_061.png" alt="" width="254" height="47"/> can be written as a product of atomic one-body spin orbitals:</p>
			<div><div><img src="img/Formulla_04_062.jpg" alt="" width="1050" height="49"/>
				</div>
			</div>
			<p>and is made to be anti-symmetric through an antisymmetric tensor product (<img src="img/Formulla_04_063.png" alt="" width="43" height="44"/> [Toulouse] and through<a id="_idIndexMarker358"/> the superposition of states using the <strong class="bold">Slater determinant</strong> first introduced by Dirac [Kaplan]:</p>
			<div><div><img src="img/Formulla_04_064.jpg" alt="" width="1320" height="208"/>
				</div>
			</div>
			<p>The Slater determinant wave function<a id="_idIndexMarker359"/> is antisymmetric with respect to the exchange of two electrons (permutation of two rows) or with respect to the exchange of two spin orbitals (permutation of two columns).</p>
			<p>For two electrons (<img src="img/Formulla_04_065.png" alt="" width="114" height="36"/>), the Slater determinant has the form:</p>
			<div><div><img src="img/Formulla_04_066.jpg" alt="" width="912" height="104"/>
				</div>
			</div>
			<div><div><img src="img/Formulla_04_067.jpg" alt="" width="1260" height="111"/>
				</div>
			</div>
			<p>For three electrons (<img src="img/Formulla_04_068.png" alt="" width="114" height="33"/>), the Slater determinan<a id="_idTextAnchor166"/>t has the form:</p>
			<div><div><img src="img/Formulla_04_069.jpg" alt="" width="1413" height="162"/>
				</div>
			</div>
			<div><div><img src="img/Formulla_04_070.jpg" alt="" width="1486" height="102"/>
				</div>
			</div>
			<div><div><img src="img/Formulla_04_071.jpg" alt="" width="1396" height="64"/>
				</div>
			</div>
			<div><div><img src="img/Formulla_04_072.jpg" alt="" width="1500" height="58"/>
				</div>
			</div>
			<p>The <strong class="bold">Fock space</strong> [Fock] is the Hilbert space<a id="_idIndexMarker360"/> in which the Slater determinant wave functions belong. By definition, a Fock space is the sum of a set of Hilbert spaces representing at least three important configurations:</p>
			<ul>
				<li>The zero-particle state <a id="_idIndexMarker361"/>also called the vacuum state<a id="_idIndexMarker362"/> is interpreted as the absence of an electron in an orbital: <img src="img/Formulla_04_073.png" alt="" width="90" height="45"/> or <img src="img/Formulla_04_074.png" alt="" width="50" height="44"/>.</li>
				<li>One-particle states: <img src="img/Formulla_04_075.png" alt="" width="130" height="59"/> or <img src="img/Formulla_04_076.png" alt="" width="50" height="45"/>.</li>
				<li>Two-particle states: <img src="img/Formulla_04_077.png" alt="" width="1002" height="107"/> or <img src="img/Formulla_04_078.png" alt="" width="74" height="44"/>.</li>
			</ul>
			<p>The number of states of an <img src="img/Formulla_04_083.png" alt="" width="27" height="24"/>-particle subspace of the Fock space of <img src="img/Formulla_04_084.png" alt="" width="33" height="32"/> electrons is:</p>
			<div><div><img src="img/Formulla_04_085.jpg" alt="" width="305" height="98"/>
				</div>
			</div>
			<p>where <img src="img/Formulla_04_086.png" alt="" width="56" height="65"/> denotes the number of <img src="img/Formulla_04_087.png" alt="" width="23" height="20"/>-combinations from a set of <img src="img/Formulla_04_088.png" alt="" width="33" height="34"/> elements.</p>
			<p>If we have 5 electrons with a 3-particle subspace: </p>
			<div><div><img src="img/Formulla_04_089.jpg" alt="" width="706" height="96"/>
				</div>
			</div>
			<p>The total number of states in a Fock space of <img src="img/Formulla_04_090.png" alt="" width="33" height="31"/> electrons is [Wiki-Comb]:</p>
			<div><div><img src="img/Formulla_04_091.jpg" alt="" width="655" height="170"/>
				</div>
			</div>
			<p>What we present here in this section is only a mathematical construction and does not represent a physical reality nor a chemical actuality. Therefore, in some ways, it is difficult to relate to the ideas and terms we use to actual chemistry taking place. However, the Fock space<a id="_idIndexMarker363"/> is exploited in quantum computing because there is a one-to-one mapping between the electron space of a molecule and the qubit space; but it is not a necessary mapping. There are other mappings that are more computationally advantageous, such as the one presented in <em class="italic">Section 4.7.4, Bravyi-Kitaev transformation</em>.</p>
			<h1 id="_idParaDest-98"><a id="_idTextAnchor167"/>4.3. Fermionic creation and annihilation operators</h1>
			<p>In the previous section, we mentioned that the Fock space is a mathematical construction and does not represent a physical reality nor a chemical actuality. However, please keep in mind that in a molecule, each electron can occupy only one spin-orbit at a time and no two electrons can occupy the same spin-orbit. </p>
			<p>Now we further consider a subspace of the Fock space, which is spanned<a id="_idIndexMarker364"/> by the <strong class="bold">occupation number</strong> of the spin-orbits, which is described by <img src="img/Formulla_04_092.png" alt="" width="48" height="39"/> electronic basis states <img src="img/Formulla_04_093.png" alt="" width="197" height="46"/>, where <img src="img/Formulla_04_094.png" alt="" width="181" height="49"/> is the occupation number of orbital <img src="img/Formulla_04_095.png" alt="" width="20" height="41"/>. </p>
			<p>The spin-orbital state <img src="img/Formulla_04_096.png" alt="" width="20" height="41"/> not occupied by an electron is represented by <img src="img/Formulla_04_097.png" alt="" width="291" height="58"/>.</p>
			<p>We define a set of fermionic annihilation operators <img src="img/Formulla_04_098.png" alt="" width="124" height="47"/> and creation operators <img src="img/Formulla_04_099.png" alt="" width="122" height="74"/>, which act on local electron modes, and which<a id="_idIndexMarker365"/> satisfy the following <strong class="bold">anti-commutation</strong> relations:</p>
			<div><div><img src="img/Formulla_04_100.jpg" alt="" width="780" height="97"/>
				</div>
			</div>
			<div><div><img src="img/Formulla_04_101.jpg" alt="" width="402" height="65"/>
				</div>
			</div>
			<p>where <img src="img/Formulla_04_102.png" alt="" width="45" height="47"/> is the Dirac delta function. The operators <img src="img/Formulla_04_103.png" alt="" width="160" height="78"/> are called the <strong class="bold">occupation number operators</strong> and commute<a id="_idIndexMarker366"/> with one another.</p>
			<p>A <strong class="bold">fermionic operator</strong> is a linear combination<a id="_idIndexMarker367"/> of products of <strong class="bold">creation</strong> and <strong class="bold">annihilation operators</strong>, which we discuss next.</p>
			<h2 id="_idParaDest-99"><a id="_idTextAnchor168"/>4.3.1. Fermion creation operator</h2>
			<p>The fermionic creation operator <img src="img/Formulla_04_104.png" alt="" width="42" height="58"/> raises by one unit the number<a id="_idIndexMarker368"/> of particles sitting in the <img src="img/Formulla_04_105.png" alt="" width="48" height="40"/> fermio<a id="_idTextAnchor169"/><a id="_idTextAnchor170"/>nic orbital:</p>
			<p class="figure-caption"><img src="img/Formulla_04_106.png" alt="" width="1004" height="66"/></p>
			<p>where:</p>
			<ul>
				<li><img src="img/Formulla_04_107.png" alt="" width="51" height="35"/> and <img src="img/Formulla_04_108.png" alt="" width="149" height="42"/> are the number of particles sitting in the <img src="img/Formulla_04_109.png" alt="" width="51" height="42"/> fermionic orbital.</li>
				<li><img src="img/Formulla_04_110.png" alt="" width="135" height="37"/> is a pre-factor that annihilates the state if we had an electron in the <img src="img/Formulla_04_111.png" alt="" width="51" height="43"/> fermionic orbital, that is, if <img src="img/Formulla_04_112.png" alt="" width="125" height="41"/>.</li>
				<li>The phase factor <img src="img/Formulla_04_113.png" alt="" width="181" height="46"/> keeps the anti-symmetric properties of the whole superposition of states.</li>
			</ul>
			<h2 id="_idParaDest-100">4.3.2. Fermion annihilati<a id="_idTextAnchor171"/><a id="_idTextAnchor172"/>on operator</h2>
			<p>The fermion annihilation operator <img src="img/Formulla_04_114.png" alt="" width="35" height="43"/> lowers by one unit<a id="_idIndexMarker369"/> the number of particles sitting in the <img src="img/Formulla_04_115.png" alt="" width="48" height="41"/> fermionic orbital:</p>
			<div><div><img src="img/Formulla_04_116.jpg" alt="" width="891" height="64"/>
				</div>
			</div>
			<p>w<a id="_idTextAnchor173"/><a id="_idTextAnchor174"/>here:</p>
			<ul>
				<li><img src="img/Formulla_04_117.png" alt="" width="50" height="32"/> and <img src="img/Formulla_04_118.png" alt="" width="162" height="45"/> are the number of particles sitting in the <img src="img/Formulla_04_119.png" alt="" width="50" height="43"/> fermionic orbital.</li>
				<li><img src="img/Formulla_04_120.png" alt="" width="50" height="34"/> is a pre-factor that annihilates the state in the Slater determinant if there is no electron in the <img src="img/Formulla_04_121.png" alt="" width="48" height="40"/> fermionic orbital, that is, if <img src="img/Formulla_04_122.png" alt="" width="131" height="42"/>.</li>
				<li>The phase factor <img src="img/Formulla_04_123.png" alt="" width="201" height="50"/> keeps the anti-symmetric properties of the whole superposition of states.</li>
			</ul>
			<p>We now see how to write the electronic molecular Hamiltonian as a linear combination of products of creation and annihilation operators.</p>
			<h1 id="_idParaDest-101"><a id="_idTextAnchor175"/>4.4. Molecular Hamiltonian in the Hartree-Fock orbitals basis</h1>
			<p>For mapping the original <strong class="bold">electronic structure Hamiltonian</strong> into the corresponding <strong class="bold">qubit Hamiltonian</strong>, we work in the second quantization<a id="_idIndexMarker370"/> formalism of quantum<a id="_idIndexMarker371"/> mechanics. Recall we introduced the first quantization in <em class="italic">Section 4.1</em>, <em class="italic">Born-Oppenheimer approximation</em>.</p>
			<p>The <strong class="bold">Hartree-Fock (HF)</strong> method approximates<a id="_idIndexMarker372"/> an <img src="img/Formulla_04_124.png" alt="" width="32" height="32"/>-body problem into <img src="img/Formulla_04_125.png" alt="" width="32" height="32"/> one-body problems where<a id="_idIndexMarker373"/> each electron evolves in the <strong class="bold">mean field</strong> of the other electrons. </p>
			<p>We can rewrite the electronic molecular Hamiltonian (<img src="img/Formulla_04_126.png" alt="" width="93" height="51"/>) as a linear combination of products of creation and annihilation operators (summarized in <em class="italic">Figure 4.4</em>):</p>
			<div><div><img src="img/Formulla_04_127.jpg" alt="" width="930" height="127"/>
				</div>
			</div>
			<p>where <img src="img/Formulla_04_128.png" alt="" width="35" height="49"/> removes an electron from spin-orbital <img src="img/Formulla_04_129.png" alt="" width="21" height="42"/>, and <img src="img/Formulla_04_130.png" alt="" width="42" height="58"/> creates an electron in spin-orbital <img src="img/Formulla_04_131.png" alt="" width="13" height="32"/>. The<a id="_idIndexMarker374"/> operation <img src="img/Formulla_04_132.png" alt="" width="80" height="60"/> is the <strong class="bold">excitation operator<a id="_idTextAnchor176"/><a id="_idTextAnchor177"/></strong>, which excites<a id="_idIndexMarker375"/> an electron from the <strong class="bold">occupied spin-orbital</strong> <img src="img/Formulla_04_133.png" alt="" width="246" height="56"/> into the <strong class="bold">unoccupied orbital</strong> <img src="img/Formulla_04_134.png" alt="" width="239" height="55"/>. Constructing these<a id="_idIndexMarker376"/> were introduced in <em class="italic">Section 2.1, Postulate 1 – Wave functions</em>. The nuclear-nuclear (<img src="img/Formulla_04_135.png" alt="" width="59" height="31"/>) repulsion energy (<img src="img/Formulla_04_136.png" alt="" width="74" height="42"/>) is approximated by pseudopotentials and experimental data as mentioned in Section 4.1, <em class="italic">Born-Oppenheimer approximation</em>.</p>
			<div><div><img src="img/B18268_Table_02.jpg" alt="" width="1632" height="788"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.4 – Molecular Hamiltonian as a linear combination of products of creation and annihilation operators</p>
			<p>The weights of operators are given by the one-electron integrals using the HF method: </p>
			<p><img src="img/Formulla_04_146.png" alt="" width="1465" height="140"/></p>
			<p>where <img src="img/Formulla_04_147.png" alt="" width="36" height="35"/> are the coordinates of electron <img src="img/Formulla_04_148.png" alt="" width="15" height="34"/>, <img src="img/Formulla_04_149.png" alt="" width="44" height="42"/> are the coordinates of atom <img src="img/Formulla_04_150.png" alt="" width="18" height="32"/> and <img src="img/Formulla_04_151.png" alt="" width="40" height="41"/> is the atomic number of atom <img src="img/Formulla_04_152.png" alt="" width="16" height="32"/>, and the two-electron terms are given by:</p>
			<p><img src="img/Formulla_04_153.png" alt="" width="1633" height="106"/></p>
			<p>The molecular Hamiltonian can be expressed in the basis of the solutions<a id="_idIndexMarker377"/> of the HF method <img src="img/Formulla_04_154.png" alt="" width="138" height="46"/>, which are called <strong class="bold">Molecular Orbitals (MOs)</strong> [Panagiotis]: </p>
			<p>We showed some example calculations of these integrals in <em class="italic">Section 2.3.6</em>, <em class="italic">Kinetic energy operation,</em> and <em class="italic">Section 2.3.7,</em> <em class="italic">Potential energy operation</em>. In the next section, we will see how to approximate the spatial wave functions in those integrals.</p>
			<p>There are three commonly used HF methods:</p>
			<ul>
				<li>The <strong class="bold">restricted HF (RHF)</strong> method is used for<a id="_idIndexMarker378"/> closed-shell molecules. The spin-orbitals are either alpha (spin-up) or beta (spin-down) and all orbitals are doubly occupied by alpha and beta spin-orbitals.</li>
				<li>The restricted <strong class="bold">open-shell (ROHF)</strong> method is used <a id="_idIndexMarker379"/>for open-shell molecules where the numbers of electrons of each spin are not equal. ROHF uses as many doubly occupied molecular orbitals as possible and singly occupied orbitals for the unpaired electrons.</li>
				<li>The <strong class="bold">unrestricted HF (UHF)</strong> method is used for open-shell<a id="_idIndexMarker380"/> molecules where the numbers of electrons of each spin are not equal. UHF orbitals can have either alpha or beta spin, but the alpha and beta orbitals may have different spatial components.</li>
			</ul>
			<h1 id="_idParaDest-102">4.5. Basis s<a id="_idTextAnchor178"/><a id="_idTextAnchor179"/>ets</h1>
			<p>The spatial wave functions, <img src="img/Formulla_04_155.png" alt="" width="89" height="45"/>, in the integrals of <em class="italic">Section 4.4,</em> <em class="italic">Molecular Hamiltonian in the Hartree-Fock orbitals basis,</em> are approximated by linear combinations of several independent<a id="_idIndexMarker381"/> basis functions. The form of these functions is inspired by the atomic orbitals of hydrogen-like systems that we introduced in <em class="italic">Section 2.1.1,</em> <em class="italic">Spherical harmonic functions,</em> which have a radial part as shown in <em class="italic">Section 2.2.1</em>, <em class="italic">Computing the radial wave functions</em>.</p>
			<p>Two classes of approximate<a id="_idIndexMarker382"/> basis orbitals that are commonly used are <strong class="bold">Slater-type orbitals (STOs)</strong> based on the Slater determinant introduced in <em class="italic">Section 4.2</em>, <em class="italic">Fock space</em>, and Cartesian <strong class="bold">Gaussian-type orbitals (GTOs)</strong>. These two types<a id="_idIndexMarker383"/> of basis functions can be combined as <strong class="bold">STO-nG</strong>, where <em class="italic">n</em> is the number<a id="_idIndexMarker384"/> of Gaussians used to make the approximation. <strong class="bold">Ab Initio electronic structure</strong> computations are conducted<a id="_idIndexMarker385"/> numerically using a basis set of orbitals.</p>
			<p>We now detail the structure of these two classes and illustrate them with Python plots of functions.</p>
			<h2 id="_idParaDest-103"><a id="_idTextAnchor180"/>4.5.1. Slater-type orbitals</h2>
			<p>STOs have the same structure<a id="_idIndexMarker386"/> as the atomic orbitals of hydrogen-like systems and their radial part have the following form [Wiki_GAU]:</p>
			<p><img src="img/Formulla_04_156.png" alt="" width="404" height="52"/></p>
			<p>where:</p>
			<ul>
				<li><img src="img/Formulla_04_157.png" alt="" width="15" height="36"/> is the angular momentum quantum with values ranging from <img src="img/Formulla_04_158.png" alt="" width="21" height="33"/> to <img src="img/Formulla_04_159.png" alt="" width="102" height="33"/>, where <img src="img/Formulla_04_160.png" alt="" width="27" height="23"/> is the principal quantum number.</li>
				<li><img src="img/Formulla_04_161.png" alt="" width="22" height="23"/> is the nuclear distance of the electron from the atomic nucleus.</li>
				<li><img src="img/Formulla_04_162.png" alt="" width="26" height="24"/> is called the orbital exponent<a id="_idIndexMarker387"/> and controls how fast the density of the orbital vanishes as a function of the nuclear distance.</li>
			</ul>
			<p><img src="img/Formulla_04_163.png" alt="" width="123" height="44"/> is determined by the following normalization condition [Wiki-GAU]:</p>
			<p><img src="img/Formulla_04_164.png" alt="" width="370" height="153"/></p>
			<p><img src="img/Formulla_04_165.png" alt="" width="555" height="151"/></p>
			<p>Noting that [Wiki-STO]:</p>
			<p><img src="img/Formulla_04_166.png" alt="" width="388" height="155"/></p>
			<p>we have:</p>
			<p><img src="img/Formulla_04_167.png" alt="" width="530" height="152"/></p>
			<p>For the 1 <img src="img/Formulla_04_168.png" alt="" width="22" height="24"/> orbital, we have <img src="img/Formulla_04_169.png" alt="" width="80" height="28"/>, hence <img src="img/Formulla_04_170.png" alt="" width="219" height="61"/> , and the radial part of the Slater orbital is:</p>
			<div><div><img src="img/Formulla_04_171.jpg" alt="" width="303" height="71"/>
				</div>
			</div>
			<p>Let's plot this function with the following Python code:</p>
			<pre>x = np.linspace(-5,5,num=1000)
r = abs(x)
alpha = 1.0
R = 2*alpha**(1.5)*np.exp(-alpha*r)
plt.figure(figsize=(4,3))
plt.plot(x,R,label="STO 1s H")
plt.legend()</pre>
			<p><em class="italic">Figure 4.5</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.5.jpg" alt="" width="422" height="316"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.5 – Plot of the radial part of the Slater-type orbital for the 1s orbital of the hydrogen atom</p>
			<p>We plot the antisymmetric spatial wave function for the hydrogen molecule as a linear combination of the preceding<a id="_idIndexMarker388"/> radial part of the slater orbital for a hydrogen atom as follows:</p>
			<pre>x = np.linspace(-7,7,num=1000)
r1 = abs(x+2.5)
r2 = abs(x-2.5)
alpha = 1.0
R = 2*alpha**(1.5)*np.exp(-alpha*r1)-2*alpha**(1.5)*np.exp(-alpha*r2)
plt.figure(figsize=(4,3))
plt.plot(x,R,label="Antisymmetric STO H2")
plt.legend()</pre>
			<p><em class="italic">Figure 4.6</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.6.jpg" alt="" width="683" height="314"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.6 – Plot of the antisymmetric spatial wave function for the hydrogen molecule</p>
			<h2 id="_idParaDest-104"><a id="_idTextAnchor181"/>4.5.2. Gaussian-type orbitals</h2>
			<p>GTOs have the same angular form<a id="_idIndexMarker389"/> as STOs, but their radial function adopts a Gaussian form [Wiki_GAU]:</p>
			<p><img src="img/Formulla_04_172.png" alt="" width="422" height="57"/></p>
			<p>where:</p>
			<ul>
				<li><img src="img/Formulla_04_173.png" alt="" width="15" height="37"/> is the angular momentum quantum with values ranging from <img src="img/Formulla_04_174.png" alt="" width="22" height="32"/> to <img src="img/Formulla_04_175.png" alt="" width="102" height="33"/>, where <img src="img/Formulla_04_176.png" alt="" width="28" height="25"/> is the principal quantum number.</li>
				<li><img src="img/Formulla_04_177.png" alt="" width="22" height="24"/> is the nuclear distance of the electron from the atomic nucleus.</li>
				<li><img src="img/Formulla_04_178.png" alt="" width="27" height="25"/> is called the orbital exponent and controls how fast the density of the orbital vanishes as a function of the nuclear distance.</li>
			</ul>
			<p><img src="img/Formulla_04_179.png" alt="" width="123" height="44"/> is determined by the following normalization condition [Wiki-GAU]:</p>
			<p><img src="img/Formulla_04_180.png" alt="" width="365" height="152"/></p>
			<p>In practice, we approximate the radial part of an STO with a linear combination of primitive<a id="_idIndexMarker390"/> Gaussian functions, called a contracted Gaussian function. The STO-nG basis sets include one contracted Gaussian function per atomic orbital [Skylaris]. We plot the STO-3G function for the 1<img src="img/Formulla_04_181.png" alt="" width="21" height="24"/> orbital<a id="_idIndexMarker391"/> of the hydrogen atom. Here is the code:</p>
			<pre>x = np.linspace(-7,7,num=1000)
r = abs(x)
c = [0.444635,0.535328,0.154329]
alpha = [0.109818,0.405771,2.227660]
psi = 0
for k in range(3):
  psi += c[k]*(2*alpha[k]/np.pi)**0.75 * np.exp(-alpha[k]*r**2)
plt.figure(figsize=(5,3))
plt.plot(x,psi,label="STO-3G 1s H")
plt.legend()</pre>
			<p><em class="italic">Figure 4.7</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.7.jpg" alt="" width="775" height="284"/>
				</div>
			</div>
			<p class="figure-caption"> </p>
			<p class="figure-caption">Figure 4.7 – Plot of the STO-3G function for the 1<img src="img/Formulla_04_182.png" alt="" width="23" height="25"/> orbital of the hydrogen atom</p>
			<p>We plot the antisymmetric spatial wave function for the hydrogen molecule as a linear combination of the preceding radial part of the STO-3G function for the 1<em class="italic">s</em> orbital of a hydrogen atom as follows: </p>
			<pre>x = np.linspace(-7,7,num=1000)
r1 = abs(x+2.5)
r2 = abs(x-2.5)
c = [0.444635,0.535328,0.154329]
alpha = [0.109818,0.405771,2.227660]
psi = 0
for k in range(3):
  psi += c[k]*(2*alpha[k]/np.pi)**0.75 * np.exp(-alpha[k]*r1**2) \
  - c[k]*(2*alpha[k]/np.pi)**0.75 * np.exp(-alpha[k]*r2**2)
plt.figure(figsize=(5,3))
plt.plot(x,psi,label="Antisymmetric STO-3G H2")
plt.legend()</pre>
			<p><em class="italic">Figure 4.8</em> shows the<a id="_idIndexMarker392"/> result:</p>
			<div><div><img src="img/B18268_Figure_4.8.jpg" alt="" width="943" height="287"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.8 – Plot of the antisymmetric STO-3G function for the 1<img src="img/Formulla_04_1821.png" alt="" width="23" height="25"/> orbital of the hydrogen molecule</p>
			<h1 id="_idParaDest-105"><a id="_idTextAnchor182"/>4.6. Constructing a fermionic Hamiltonian with Qiskit Nature</h1>
			<p>The Qiskit Nature platform<a id="_idIndexMarker393"/> works with spin orbitals [Qiskit_Nat_1]. Each molecular<a id="_idIndexMarker394"/> orbital can have a spin-up or a spin-down electron, or spin-paired electrons. A spin orbital is either of those cases. For each molecular orbital, we have two spin orbitals. Let's now illustrate the construction of a fermionic Hamiltonian operator of the hydrogen molecule with Qiskit Nature.</p>
			<h2 id="_idParaDest-106"><a id="_idTextAnchor183"/>4.6.1. Constructing a fermionic Hamiltonian operator of the hydrogen molecule </h2>
			<p>First, we define the molecular geometry<a id="_idIndexMarker395"/> of the hydrogen molecule with the Qiskit <code>Molecule</code> class, which has the following<a id="_idIndexMarker396"/> input parameters:</p>
			<ul>
				<li><code>geometry</code>, a list of atom names, such as <code>H</code> for hydrogen, followed by Cartesian coordinates <img src="img/Formulla_04_184.png" alt="" width="136" height="43"/> of the atom's position in units of angstroms</li>
				<li><code>charge</code>, an integer, the electric charge of the molecule</li>
				<li><code>multiplicity</code>, an integer, the multiplicity <img src="img/Formulla_04_185.png" alt="" width="121" height="34"/> of the molecule, where <img src="img/Formulla_04_186.png" alt="" width="26" height="33"/> is the total spin angular momentum, which is determined by the number of unpaired electrons in the molecule, that is, the number of electrons that occupy a molecular orbital singly, not with another electron:</li>
			</ul>
			<pre>hydrogen_molecule = Molecule(geometry=[['H', [0., 0., 0.]],
                              ['H', [0., 0., 0.735]]],
                     charge=0, multiplicity=1)</pre>
			<p>We define the electronic structure molecule driver by selecting the PySCF <code>driver</code> type and the basis set <code>sto3g</code>, which is the basis STO-3G we introduced in <em class="italic">Section 4.5.2</em>, <em class="italic">Gaussian-type orbitals</em>, in which the molecular orbitals are to be expanded. STO-3G is used by default in Qiskit Nature. RHF is used by default in Qiskit Nature's PySCF driver:</p>
			<pre>driver = ElectronicStructureMoleculeDriver(hydrogen_molecule, basis='sto3g', driver_type=ElectronicStructureDriverType.PYSCF)</pre>
			<p>We perform a HF calculation for the basis STO-3G. Here is the code:</p>
			<pre>qH2 = driver.run()</pre>
			<p>We create an <code>ElectronicStructureProblem</code> instance that produces the list of fermionic operators:</p>
			<pre>H2_fermionic_hamiltonian = ElectronicStructureProblem(driver)</pre>
			<p>We use the <code>second_q_ops()</code> method [Qiskit_Nat_3], which returns a list of second quantized operators: Hamiltonian<a id="_idIndexMarker397"/> operator, total particle<a id="_idIndexMarker398"/> number operator, total angular momentum operator, total magnetization operator, and, if available, <img src="img/Formulla_04_187.png" alt="" width="25" height="25"/>, <img src="img/Formulla_04_188.png" alt="" width="26" height="33"/>, <img src="img/Formulla_04_189.png" alt="" width="24" height="24"/> dipole operators:</p>
			<pre>H2_second_q_op = H2_fermionic_hamiltonian.second_q_ops()</pre>
			<p>Recall that in <em class="italic">Section 1.3</em>, <em class="italic">Quantum numbers and quantization of matter</em>, we introduced the <strong class="bold">spin projection quantum number</strong>, <img src="img/Formulla_04_190.png" alt="" width="53" height="33"/>, which gives the projection<a id="_idIndexMarker399"/> of the spin momentum <img src="img/Formulla_04_191.png" alt="" width="20" height="23"/> along the specified axis as either spin up (+½) or spin down (-½) in a given spatial direction. HF theory similarly defines <img src="img/Formulla_04_192.png" alt="" width="25" height="23"/> (up) and <img src="img/Formulla_04_193.png" alt="" width="27" height="43"/> (down) spin orbitals [Skylaris_1].</p>
			<p>We define <code>the get_particle_number()</code> function, which gets the particle number property of a given electronic structure problem. Here is the code:</p>
			<pre>def get_particle_number(problem, show=True):
  particle_number = problem.grouped_property_transformed.get_property("ParticleNumber")
  num_particles = (particle_number.num_alpha, particle_number.num_beta)
  num_spin_orbitals = particle_number.num_spin_orbitals
  if show:
    print("Number of alpha electrons: {}".format(particle_number.num_alpha))
    print("Number of beta electrons: {}".format(particle_number.num_beta))
    print("Number of spin orbitals: {}".format(num_spin_orbitals))
  return particle_number</pre>
			<p>We call the <code>get_particle_number()</code> function to get and print the parti<a id="_idTextAnchor184"/><a id="_idTextAnchor185"/>cle number properties as follows:</p>
			<pre>print("Hydrogen molecule, basis: sto3g, Hartree-Fock calculation")
H2_particle_number = get_particle_number(H2_fermionic_hamiltonian)</pre>
			<p><em class="italic">Figure 4.9</em> shows the result<a id="_idIndexMarker400"/> where we see four<a id="_idIndexMarker401"/> spin orbitals, one <img src="img/Formulla_04_194.png" alt="" width="26" height="26"/> e<a id="_idTextAnchor186"/><a id="_idTextAnchor187"/>lectron, and one <img src="img/Formula_03_006.png" alt="" width="27" height="42"/> electron:</p>
			<div><div><img src="img/B18268_Figure_4.9.jpg" alt="" width="604" height="99"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.9 – Hydrogen molecule, HF calculation for the basis STO-3G, particle numbers</p>
			<p>We define the <code>get_electronic_energy() </code>function, which returns the electronic energy property of a given electronic structure problem. Here is the code: </p>
			<pre>def get_electronic_energy(problem, show=True):
  electronic_energy = problem.grouped_property_transformed.get_property("ElectronicEnergy")
  if show:
    print(electronic_energy)
  return electronic_energy</pre>
			<p>We call the <code>get_electronic_energy()</code> function to get and print the electronic energy as follows:</p>
			<pre>H2_electronic_energy = get_electronic_energy(H2_fermionic_hamiltonian)</pre>
			<p><em class="italic">Figure 4.10</em> shows the molecular orbital (<code>MO</code>) one-body terms, where we see two <img src="img/Formulla_04_196.png" alt="" width="26" height="24"/> electron terms and two <img src="img/Formula_03_006.png" alt="" width="27" height="42"/> electron terms:</p>
			<div><div><img src="img/B18268_Figure_4.10.jpg" alt="" width="501" height="223"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.10 – Hydrogen molecule, electronic energy, molecular orbital (MO), one-body terms</p>
			<p><em class="italic">Figure 4.11</em> shows the molecular<a id="_idIndexMarker402"/> orbital (<code>MO</code>) two-body terms<a id="_idIndexMarker403"/> that contain all possible spin combinations of molecular orbital (<code>MO</code>) two-body terms, <img src="img/Formulla_04_198.png" alt="" width="52" height="25"/>, <img src="img/Formulla_04_199.png" alt="" width="54" height="42"/>, <img src="img/Formulla_04_200.png" alt="" width="124" height="42"/>:</p>
			<div><div><img src="img/B18268_Figure_4.11.jpg" alt="" width="568" height="786"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.11 – Hydrogen molecule, electronic energy, molecular orbital (MO), two-body terms</p>
			<p>The <code>FermionicOp</code> class [Qiskit_Nat_2] in the sparse label mode displays each term of the fermionic operator by a string of items<a id="_idIndexMarker404"/> separated by a space, starting<a id="_idIndexMarker405"/> with a label followed by an underscore, <code>_</code>, and by a positive integer representing the index of the fermionic mode. <em class="italic">Figure 4.12</em> shows the list of labels, the corresponding symbols, and the fermionic operator:</p>
			<div><div><img src="img/B18268_Table_03.jpg" alt="" width="856" height="357"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.12 – List of labels used by the Qiskit FermionicOp class</p>
			<p>The Qiskit <code>FermionicOp</code> class truncates<a id="_idIndexMarker406"/> the display of the fermionic Hamiltonian operator according to the maximum<a id="_idIndexMarker407"/> number of characters set by the <code>set_truncation()</code> method with a default value of 200 [Qiskit_Nat_T]. If the truncation value is set to <code>0</code>, truncation is disabled. We set truncation to <code>None</code> with the <code>set_truncation(0)</code> method and then we print all 14 terms of the fermionic Hamiltonian operator of the hydrogen molecule:</p>
			<pre># Set truncation to None
H2_second_q_op[0].set_truncation(0)
# Print the Fermionic operator
print("Hydrogen molecule")
print(H2_second_q_op[0])</pre>
			<p><em class="italic">Figure 4.13</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.13.jpg" alt="" width="518" height="402"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.13 – Fermionic Hamiltonian operator of the hydrogen molecule</p>
			<p>We now print, with the <code>FermionicOp.to_matrix</code> method, a matrix representation of the fermionic operator<a id="_idIndexMarker408"/> of the hydrogen molecule<a id="_idIndexMarker409"/> in the Fock basis where the basis states are ordered in increasing bitstring order as 0000, 0001, …, 1111. Here is the code:</p>
			<pre>print(H2_second_q_op[0].to_matrix())</pre>
			<p><em class="italic">Figure 4.14</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.14.jpg" alt="" width="417" height="452"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.14 – Matrix representation of the fermionic Hamiltonian operator of the hydrogen molecule in the Fock basis</p>
			<p>The fermionic Hamiltonian<a id="_idIndexMarker410"/> operator of the hydrogen<a id="_idIndexMarker411"/> molecule contains four particle number operators, which are shown in <em class="italic">Figure 4.15</em>:</p>
			<div><div><img src="img/B18268_Table_04.jpg" alt="" width="1632" height="468"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.15 – Particle number operators of the fermionic Hamiltonian of the hydrogen molecule</p>
			<p>The fermionic Hamiltonian operator of the hydrogen molecule contains ten two-electron exchange operators shown in <em class="italic">Figure 4.16</em>:</p>
			<div><div><img src="img/B18268_Table_05.jpg" alt="" width="1379" height="997"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.16 – Two-electron exchange operators of the fermionic Hamiltonian of the hydrogen molecule</p>
			<p>Let's now illustrate<a id="_idIndexMarker412"/> the construction of a fermionic Hamiltonian<a id="_idIndexMarker413"/> operator of the lithium hydride molecule with Qiskit Nature.</p>
			<h2 id="_idParaDest-107"><a id="_idTextAnchor188"/>4.6.2. Constructing a fermionic Hamiltonian operator of the lithium hydride molecule</h2>
			<p>We define the molecular geometry<a id="_idIndexMarker414"/> of the lithium hydride (LiH) molecule with the Qiskit  <code>Molecule</code> class<a id="_idIndexMarker415"/> as we have explained in <em class="italic">Section 4.6.1, Constructing a fermionic Hamiltonian operator of the hydrogen molecule</em>:</p>
			<pre>LiH_molecule = Molecule(geometry=[['Li', [0., 0., 0.]],
                              ['H', [0., 0., 1.5474]]],
                     charge=0, multiplicity=1)</pre>
			<p>We define the electronic structure<a id="_idIndexMarker416"/> molecule driver by selecting the PySCF <code>driver</code> type and the <code>sto3g</code> basis set in which the molecular<a id="_idIndexMarker417"/> orbitals are to be expanded:</p>
			<pre>driver = ElectronicStructureMoleculeDriver(LiH_molecule, basis='sto3g', driver_type=ElectronicStructureDriverType.PYSCF)</pre>
			<p>We create an <code>ElectronicStructureProblem</code> instance that produces the list of fermionic operators with the <code>freeze</code> <code>core=True</code> and <code>remove_orbitals=[4,3]</code> parameters, removing unoccupied orbitals:</p>
			<pre>LiH_fermionic_hamiltonian = ElectronicStructureProblem(driver, transformers=[FreezeCoreTransformer(freeze_core=True, remove_orbitals=[4, 3])])</pre>
			<p>We use the <code>second_q_ops()</code> method to get a list of second quantized operators:</p>
			<pre>LiH_second_q_op = LiH_fermionic_hamiltonian.second_q_ops()</pre>
			<p>We call <code>get_particle_number()</code> to get and print the particle number property as follows:</p>
			<pre>print("Lithium hydride molecule, basis: sto3g, Hartree-Fock calculation")
print("Parameters freeze_core=True, remove_orbitals=[4, 3]")
LiH_particle_number = get_particle_number(LiH_fermionic_hamiltonian)</pre>
			<p><em class="italic">Figure 4.17</em> shows the result where we see six spin orbitals, one <img src="img/Formulla_04_196.png" alt="" width="26" height="24"/> electron, and one <img src="img/Formulla_04_225.png" alt="" width="28" height="43"/> electron:</p>
			<div><div><img src="img/B18268_Figure_4.17.jpg" alt="" width="780" height="132"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.17 – Lithium hydride molecule, HF calculation for the basis STO-3G, particle number</p>
			<p>We call the <code>get_electronic_energy()</code> function to get<a id="_idIndexMarker418"/> and print the electronic<a id="_idIndexMarker419"/> energy as follows:</p>
			<pre>LiH_electronic_energy = get_electronic_energy(LiH_fermionic_hamiltonian)</pre>
			<p><em class="italic">Figure 4.18</em> shows the molecular orbital (<code>MO</code>) one-body terms where we see two <img src="img/Formulla_04_226.png" alt="" width="26" height="25"/> electron terms and two <img src="img/Formula_03_006.png" alt="" width="27" height="42"/> electron terms:</p>
			<div><div><img src="img/B18268_Figure_4.18.jpg" alt="" width="500" height="401"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.18 – LiH molecule, electronic energy, molecular orbital (MO), one</p>
			<p class="figure-caption">-body terms</p>
			<p><em class="italic">Figure 4.19</em> shows the molecular orbital (<code>MO</code>) two-body terms, which contains all possible spin combinations of molecular orbital two-body terms, <img src="img/Formulla_04_228.png" alt="" width="53" height="23"/>, <img src="img/Formulla_04_229.png" alt="" width="56" height="42"/>, <img src="img/Formulla_04_230.png" alt="" width="126" height="44"/>:</p>
			<div><div><img src="img/B18268_Figure_4.19.jpg" alt="" width="574" height="760"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.19 – LiH molecule, electronic energy, molecular orbital (MO), two-body terms</p>
			<p>The Qiskit <code>FermionicOp</code> class truncates the display<a id="_idIndexMarker420"/> of the fermionic Hamiltonian operator according to the maximum<a id="_idIndexMarker421"/> number of characters set by the <code>set_truncation()</code> method with a default value of <code>200</code> [Qiskit_Nat_T]. If the truncation value is set to <code>0</code>, truncation is disabled. We set truncation to <code>1000</code> with the <code>set_truncation(1000)</code> method and then we print the first 20 terms of the more than a hundred terms of the fermionic operator of the LiH molecule:</p>
			<pre># Set truncation to 1000
LiH_second_q_op[0].set_truncation(1000)
# Print the Fermionic operator
print("Lithium hydride molecule")
print(LiH_second_q_op[0])</pre>
			<p><em class="italic">Figure 4.20</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.20.jpg" alt="" width="527" height="564"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.20 – First 20 terms of the fermionic Hamiltonian operator of the lithium hydride molecule</p>
			<p>We now p<a id="_idTextAnchor189"/>rint a matrix<a id="_idIndexMarker422"/> representation of the fermionic<a id="_idIndexMarker423"/> operator of the lithium hydride molecule in the Fock basis where the basis states are ordered in increasing bitstring order as 0000, 0001, …, 1111. Here is the code:</p>
			<pre>print(LiH_second_q_op[0].to_matrix())</pre>
			<p><em class="italic">Figure 4.21</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.21.jpg" alt="" width="371" height="550"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.21 – Matrix representation of the fermionic Hamiltonian operator of the lithium hydride molecule in the Fock basis</p>
			<h1 id="_idParaDest-108"><a id="_idTextAnchor190"/>4.7. Fermion to qubit mappings</h1>
			<p>We consider a system of <img src="img/Formulla_04_231.png" alt="" width="33" height="32"/> fermions, each labeled with an integer from <img src="img/Formulla_04_158.png" alt="" width="21" height="33"/> to <img src="img/Formulla_04_233.png" alt="" width="108" height="32"/>. We need a fermion to qubit mapping, a description of the correspondence between states of fermions<a id="_idIndexMarker424"/> and states of qubits, or, equivalently, between fermionic operators and multi-qubit operators. We need a mapping between the fermion creation and annihilation operators and multi-qubit operators. The Jordan-Wigner and the Bravyi-Kitaev transformations are widely used and simulate a system of electrons with the same number of qubits as electrons.</p>
			<h2 id="_idParaDest-109">4.7.1. Qubit<a id="_idTextAnchor191"/><a id="_idTextAnchor192"/> creation and annihilation operators</h2>
			<p>We define qu<a id="_idTextAnchor193"/><a id="_idTextAnchor194"/>bit operators<a id="_idIndexMarker425"/> that act on local<a id="_idIndexMarker426"/> qubits [Yepez] [Chiew], as shown in <em class="italic">Figure 4.22</em>:</p>
			<div><div><img src="img/B18268_Table_06.jpg" alt="" width="1348" height="636"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.22 – Qubit creation and annihilation operators</p>
			<p>The qubit operators<a id="_idIndexMarker427"/> have the anti-commutation<a id="_idIndexMarker428"/> relation: <img src="img/Formulla_04_240.png" alt="" width="534" height="48"/>.</p>
			<h2 id="_idParaDest-110"><a id="_idTextAnchor195"/>4.7.2. Jordan-Wigner transformation</h2>
			<p>The <strong class="bold">Jordan-Wigner</strong> (<strong class="bold">JW</strong>) transformation stores the occupation<a id="_idIndexMarker429"/> of each spin orbital in each qubit. It maps the fermionic creation and annihilation operators to the tensor product of Pauli operators, as shown in <em class="italic">Figure 4.23</em> [Yepez] [Chiew] [Cao]. The operators <img src="img/Formulla_04_241.png" alt="" width="49" height="41"/> and <img src="img/Formulla_04_242.png" alt="" width="49" height="49"/>change the occupation for the orbital level <img src="img/Formulla_04_243.png" alt="" width="23" height="33"/>. The tensor products of <img src="img/Formulla_04_244.png" alt="" width="39" height="32"/> Pauli operators <img src="img/Formulla_04_245.png" alt="" width="91" height="50"/> enforce the fermionic anti-commutation relations by applying a phase according to the even or odd parity of the occupations for orbital labels less than <img src="img/Formulla_04_243.png" alt="" width="23" height="33"/> [Cao].</p>
			<div><div><img src="img/B18268_Table_07.jpg" alt="" width="1488" height="868"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.23 – JW transformation</p>
			<p>For example, for an orbital <img src="img/Formulla_04_259.png" alt="" width="105" height="34"/>, we have the following mapping:</p>
			<p><img src="img/Formulla_04_260.png" alt="" width="1402" height="99"/></p>
			<p>The number of single Pauli operators <img src="img/Formulla_04_261.png" alt="" width="39" height="33"/> scales linearly with the size of the system. The occupation<a id="_idIndexMarker430"/> number basis and the JW transformation allow the representation of a single fermionic creation or annihilation operator by <img src="img/Formulla_04_262.png" alt="" width="96" height="44"/> qubit operations. </p>
			<p>The Hamiltonian that results from the JW transformation commutes with the number spin up and number spin down operators, which can be used to taper off two qubits [de Keijzer].</p>
			<p>We def<a id="_idTextAnchor196"/><a id="_idTextAnchor197"/>ine the <code>label_to_qubit()</code> function to convert a term of a fermionic operator represented as a sparse label to a qubit operator, which has the following input parameters:</p>
			<ul>
				<li><code>label</code>, a sparse label as shown in <em class="italic">Figure 4.12,</em> used by the Qiskit <code>FermionicOp</code> class</li>
				<li><code>converter</code>, either <code>JordanWignerMapper()</code>, <code>ParityMapper()</code> or <code>BravyiKitaevMapper()</code></li>
			</ul>
			<p>Here is the code:</p>
			<pre>def label_to_qubit(label, converter):
    qubit_converter = QubitConverter(converter)
    f_op = FermionicOp(label)
    qubit_op = qubit_converter.convert(f_op)
    return qubit_op</pre>
			<p>Now we convert the fermionic operators "+_0", "+_1", "+_2", "+_3", and "+_4"  into qubit operators with the JW transformation<a id="_idIndexMarker431"/> with the following code:</p>
			<pre>for k in ("+_0", "+_1", "+_2", "+_3", "+_4"):
  qubit_op = label_to_qubit(k, JordanWignerMapper())
  print("{}:\n {}\n".format(k, qubit_op))</pre>
			<p><em class="italic">Figure 4.24</em> shows the result, which matches the expected outcome of the JW transformation, with the Qiskit tensor ordering of qubits:</p>
			<div><div><img src="img/B18268_Figure_4.24.jpg" alt="" width="847" height="78"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.24 – JW transformation illustrated with "+_0", "+_1", "+_2", "+_3", and "+_4"</p>
			<h2 id="_idParaDest-111"><a id="_idTextAnchor198"/>4.7.3. Parity transformation</h2>
			<p>The parity transformation<a id="_idIndexMarker432"/> is dual to the JW transformation: the parity operators are low-weight, while the occupation operators become high-weight [Bravyi][Cao]. <em class="italic">Figure 4.25</em> shows the mapping of the fermionic creation and annihilation operators to the tensor product of Pauli operators:</p>
			<div><div><img src="img/B18268_Table_08.jpg" alt="" width="1630" height="701"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.25 – Parity transformation<a id="_idTextAnchor199"/><a id="_idTextAnchor200"/></p>
			<p>Now we convert the<a id="_idIndexMarker433"/> fermionic operators "+_0", "+_1", "+_2", "+_3", and "+_4" into qubit operators with the parity transformation with the following code:</p>
			<pre>for k in ("+_0", "+_1", "+_2", "+_3", "+_4"):
  qubit_op = label_to_qubit(k, ParityMapper())
  print("{}:\n {}\n".format(k, qubit_op))</pre>
			<p><em class="italic">Figure 4.26</em> shows the result, which matches the expected outcome of the parity transformation, with the Qiskit tensor ordering of qubits:</p>
			<div><div><img src="img/B18268_Figure_4.26.jpg" alt="" width="803" height="92"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.26 – Parity transformation illustrated with "+_0", "+_1", "+_2", "+_3", and "+_4"</p>
			<p>The parity transformation introduces known symmetries that can be exploited to reduce the size of the problem by two qubits.</p>
			<h2 id="_idParaDest-112"><a id="_idTextAnchor201"/>4.7.4. Bravyi-Kitaev transformation</h2>
			<p>The Bravyi-Kitaev (BK) transformation<a id="_idIndexMarker434"/> applies only for systems of <img src="img/Formulla_04_084.png" alt="" width="33" height="32"/> fermions where <img src="img/Formulla_04_084.png" alt="" width="33" height="32"/> is equal to a power of two, <img src="img/Formulla_04_277.png" alt="" width="146" height="36"/>. The BK basis and transformation require only <img src="img/Formulla_04_278.png" alt="" width="171" height="48"/> qubit operations to represent one fermionic operator.  The BK transformation maps the occupation number basis <img src="img/Formulla_04_279.png" alt="" width="197" height="47"/> introduced in Section 4.3., <em class="italic">Fermionic creation and annihilation operators,</em> to the BK basis <img src="img/Formulla_04_280.png" alt="" width="205" height="47"/> with a matrix <img src="img/Formulla_04_281.png" alt="" width="52" height="42"/>, which is defined recursively [Cao][Seeley], where the sums<a id="_idIndexMarker435"/> are carried modulo 2: </p>
			<p><img src="img/Formulla_04_282.png" alt="" width="161" height="45"/>, <img src="img/Formulla_04_283.png" alt="" width="541" height="146"/></p>
			<p>Hence:</p>
			<p><img src="img/Formulla_04_284.png" alt="" width="237" height="84"/>, <img src="img/Formulla_04_285.png" alt="" width="396" height="197"/></p>
			<p>We define the <code>BK(m)</code> function, which returns a dictionary of matrices <img src="img/Formulla_04_286.png" alt="" width="50" height="41"/> for <img src="img/Formulla_04_287.png" alt="" width="113" height="32"/> to <img src="img/Formulla_04_288.png" alt="" width="145" height="35"/>:</p>
			<pre>def BK(m):
  I = [[1, 0], [0, 1]]
  d = {}
  d[0] = [1]
  for k in range(0, m):
    B = np.kron(I,d[k])
    for l in range(2**k, 2**(k+1)):
      B[0,l] = 1
    d[k+1] = B
  return d</pre>
			<p>We compute the matrices <img src="img/Formulla_04_289.png" alt="" width="43" height="40"/>, <img src="img/Formulla_04_290.png" alt="" width="44" height="41"/>, <img src="img/Formulla_04_291.png" alt="" width="43" height="40"/>, and <img src="img/Formulla_04_292.png" alt="" width="49" height="45"/> by calling the <code>BK(3)</code> function:</p>
			<pre>d = BK(3)
for k, v in d.items():
  s = "B_{"+str(2**k)+"} = "
  display(array_to_latex(v, prefix=s, precision = 0))
  print(" ")</pre>
			<p><em class="italic">Figure 4.27</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.27.jpg" alt="" width="932" height="504"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.27 – BK matrices <img src="img/Formulla_04_2891.png" alt="" width="50" height="40"/>, <img src="img/Formulla_04_2901.png" alt="" width="50" height="41"/>, <img src="img/Formulla_04_2911.png" alt="" width="46" height="41"/>, and <img src="img/Formulla_04_2921.png" alt="" width="53" height="45"/></p>
			<p>There are three sets<a id="_idIndexMarker436"/> to consider [Bravyi] [Mezzacapo] [Tranter]:</p>
			<ul>
				<li>The parity set <img src="img/Formulla_04_297.png" alt="" width="87" height="43"/> is the set of qubits that encodes the parity of the fermionic modes with an index less than <img src="img/Formulla_04_298.png" alt="" width="23" height="34"/> and that gives the global phase.</li>
				<li>The update set <img src="img/Formulla_04_299.png" alt="" width="88" height="43"/> is the set of qubits that must be flipped when the fermionic mode <img src="img/Formulla_04_300.png" alt="" width="24" height="34"/> changes occupation.</li>
				<li>The flip set <img src="img/Formulla_04_301.png" alt="" width="88" height="43"/> is the set of qubits that determines whether qubit <img src="img/Formulla_04_302.png" alt="" width="22" height="32"/> has the same or inverted parity with respect to the fermionic mode <img src="img/Formulla_04_303.png" alt="" width="24" height="33"/>. It is needed for odd <img src="img/Formulla_04_303.png" alt="" width="24" height="33"/> [Ribeiro].</li>
			</ul>
			<p>These three sets can be obtained from the recursive matrices that map fermionic occupation to qubits. The remainder set <img src="img/Formulla_04_305.png" alt="" width="348" height="47"/> is obtained from the set difference of the parity and flip sets [Bravyi]. </p>
			<p><em class="italic">Figure 4.28</em> shows the mapping of fermionic creation and annihilation operators to the tensor product of Pauli operators:</p>
			<div><div><img src="img/B18268_Table_09.jpg" alt="" width="1401" height="808"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.28 – BK transformation</p>
			<p>Now we convert the fermionic<a id="_idIndexMarker437"/> operators "+_0", "+_1", "+_2", "+_3", and "+_4" into qubit operators with the BK transformation with the following code:</p>
			<pre>for k in ("+_0", "+_1", "+_2", "+_3", "+_4"):
  qubit_op = label_to_qubit(k, BravyiKitaevMapper())
  print("{}:\n {}\n".format(k, qubit_op))</pre>
			<p><em class="italic">Figure 4.29</em> shows the result, which matches the expected outcome of the BK transformation, with the Qiskit tensor ordering of qubits:</p>
			<div><div><img src="img/B18268_Figure_4.29.jpg" alt="" width="828" height="82"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.29 – BK transformation illustrated with "+_0", "+_1", "+_2", "+_3", and "+_4 "</p>
			<h1 id="_idParaDest-113"><a id="_idTextAnchor202"/>4.8. Constructing a qubit Hamiltonian operator with Qiskit Nature</h1>
			<p>This section shows <a id="_idIndexMarker438"/>how to construct a qubit Hamiltonian operator with Qiskit Nature for the hydrogen molecule and the lithium hydride molecule.</p>
			<p>We define the <code>fermion_to_qubit()</code> function to convert a fermionic operator to a qubit operator, which has the following input parameters:</p>
			<ul>
				<li><code>f_op</code>, a fermionic operator obtained as explained in <em class="italic">Section 4.6</em>, <em class="italic">Constructing a fermionic Hamiltonian with Qiskit Nature</em></li>
				<li><code>mapper</code>, either <code>"Jordan-Wigner"</code> or <code>"Parity"</code> or <code>"Bravyi-Kitaev"</code></li>
				<li><code>truncate</code>, an integer to truncate the display of the Pauli list, which can be very large; set to <code>20</code> items by default</li>
				<li><code>two_qubit_reduction</code>, Boolean, by default <code>False</code>, that determines whether to carry out two-qubit reduction when possible</li>
				<li><code>z2symmetry_reduction</code>, by default <code>None</code>, that indicates whether a Z2 symmetry reduction should be applied to resulting qubit operators that are computed based on mathematical symmetries that can be detected in the operator [de Keijzer]</li>
				<li><code>show</code>, set to <code>True</code> by default to display the name of the transformation and results</li>
			</ul>
			<p>Here is the code:</p>
			<pre>def fermion_to_qubit(f_op, second_q_op, mapper, truncate=20, two_qubit_reduction=False, z2symmetry_reduction=None, show=True): 
  if show:
    print("Qubit Hamiltonian operator")
  dmap = {"Jordan-Wigner": JordanWignerMapper(), "Parity": ParityMapper(), "Bravyi-Kitaev": BravyiKitaevMapper()}
  qubit_op = None
  qubit_converter = None
  for k, v in dmap.items():
    if k == mapper:
      if show:
        print("{} transformation ". format(mapper))
      qubit_converter = QubitConverter(v, two_qubit_reduction=two_qubit_reduction, z2symmetry_reduction=z2symmetry_reduction)
      if two_qubit_reduction:
        qubit_op = qubit_converter.convert(second_q_op[0], num_particles=f_op.num_particles)
      else:
        qubit_op = qubit_converter.convert(second_q_op[0])
      n_items = len(qubit_op)
      if show:
        print("Number of items in the Pauli list:", n_items)
        if n_items &lt;= truncate:
          print(qubit_op)
        else:
          print(qubit_op[0:truncate])
  return qubit_op, qubit_converter</pre>
			<p>We now show how<a id="_idIndexMarker439"/> to construct a qubit Hamiltonian operator of the hydrogen molecule.</p>
			<h2 id="_idParaDest-114"><a id="_idTextAnchor203"/>4.8.1. Constructing a qubit Hamiltonian operator of the hydrogen molecule</h2>
			<p>First, we select<a id="_idIndexMarker440"/> the qubit mapper<a id="_idIndexMarker441"/> called <code>JordanWignerMapper()</code>: </p>
			<pre>print("Hydrogen molecule")
H2_qubit_op, qubit_converter = fermion_to_qubit(H2_fermionic_hamiltonian, H2_second_q_op, "Jordan-Wigner", two_qubit_reduction=True)</pre>
			<p><em class="italic">Figure 4.30</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.30.jpg" alt="" width="800" height="456"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.30 – Qubit Hamiltonian operator of H2 with the JW transformation</p>
			<p>Next, we use the qubit<a id="_idIndexMarker442"/> mapper called <code>ParityMapper()</code> with <code>two_qubit_reduction=True</code> to eliminate two qubits<a id="_idIndexMarker443"/> in the qubit Hamiltonian operator [Qiskit_Nat_4] [Qiskit_Nat_5]:</p>
			<pre>print("Hydrogen molecule")
H2_qubit_op, qubit_converter = fermion_to_qubit(H2_fermionic_hamiltonian, H2_second_q_op, "Parity", two_qubit_reduction=True)</pre>
			<p><em class="italic">Figure 4.31</em> shows the resulting qubit Hamiltonian operator works on two qubits. Recall that there are four spin orbitals, as shown in <em class="italic">Figure 4.9</em>, and a register length of four, as shown in <em class="italic">Figure 4.13</em> in <em class="italic">Section 4.6.1</em>, <em class="italic">Constructing a fermionic Hamiltonian operator of the hydrogen molecule</em>. A two-qubit reduction has been achieved:</p>
			<div><div><img src="img/B18268_Figure_4.31.jpg" alt="" width="810" height="221"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.31 – Qubit Hamiltonian operator of H2 with parity transformation, two_qubit_reduction=True</p>
			<p>Last, we select<a id="_idIndexMarker444"/> the qubit mapper<a id="_idIndexMarker445"/> called <code>BravyiKitaevMapper()</code>: </p>
			<pre>print("Hydrogen molecule")
H2_qubit_op, qubit_converter = fermion_to_qubit(H2_fermionic_hamiltonian, H2_second_q_op, "Bravyi-Kitaev", two_qubit_reduction=True)</pre>
			<p><em class="italic">Figure 4.32</em> shows the result:</p>
			<div><div><img src="img/B18268_Figure_4.32.jpg" alt="" width="780" height="450"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.32 – Qubit Hamiltonian operator of H2 with the Bravyi-Kitaev transformation</p>
			<h2 id="_idParaDest-115"><a id="_idTextAnchor204"/>4.8.2. Constructing a qubit Hamiltonian operator of the lithium hydride molecule</h2>
			<p>We use the qubit<a id="_idIndexMarker446"/> mapper called <code>ParityMapper()</code> with <code>two_qubit_reduction=True</code> to eliminate two qubits<a id="_idIndexMarker447"/> in the qubit Hamiltonian operator [Qiskit_Nat_4] [Qiskit_Nat_5]. We set <code>z2symmetry_reduction="auto"</code>. We print the first 20 items of the qubit Hamiltonian operator of the LiH molecule:</p>
			<pre>print("Lithium hydride molecule")
print("Using the ParityMapper with two_qubit_reduction=True to eliminate two qubits")
print("Setting z2symmetry_reduction=\"auto\"")
LiH_qubit_op, qubit_converter = fermion_to_qubit(LiH_fermionic_hamiltonian, LiH_second_q_op, "Parity", two_qubit_reduction=True, z2symmetry_reduction="auto")</pre>
			<p><em class="italic">Figure 4.33</em> shows the resulting qubit Hamiltonian operator works on four qubits. Recall that there are six spin orbitals, as shown in <em class="italic">Figure 4.17</em>, and a register length of six, as shown in <em class="italic">Figure 4.20</em> in <em class="italic">Section 4.6.2</em>, <em class="italic">Constructing a fermionic Hamiltonian operator of the lithium hydride molecule</em>. A two-qubit<a id="_idIndexMarker448"/> reduction has been<a id="_idIndexMarker449"/> achieved:</p>
			<div><div><img src="img/B18268_Figure_4.33.jpg" alt="" width="815" height="613"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.33 – Qubit Hamiltonian operator of LiH with parity transformation, two_qubit_reduction=True</p>
			<h1 id="_idParaDest-116"><a id="_idTextAnchor205"/>Summary</h1>
			<p>In this chapter, we have shown how to formulate an electronic structure program and map it into a qubit Hamiltonian, which is the input to a hybrid classical-quantum algorithm that is used to find the lowest energy eigenvalue for a quantum system. This is the topic of <a href="B18268_05_ePub.xhtml#_idTextAnchor208"><em class="italic">Chapter 5</em></a><em class="italic">, Variational Quantum Eigensolver (VQE)</em>. </p>
			<h1 id="_idParaDest-117"><a id="_idTextAnchor206"/>Questions</h1>
			<p>Please test your understanding of the concepts presented in this chapter with the corresponding Google Colab notebook:</p>
			<ol>
				<li value="1">Which of the following terms is neglected in the BO approximation?<ol><li>Electronic kinetic energy operator.</li><li>Nuclear kinetic energy operator.</li><li>Potential energy between the electrons and nuclei. It is the sum of all electron-nucleus Coulomb interactions.</li><li>Potential energy operator arising from electron-electron Coulomb repulsions.</li><li>Potential nuclear-nuclear repulsion energy operator, the sum of all nucleus-nucleus Coulomb repulsions.</li></ol></li>
				<li>The Slater determinant wave function is antisymmetric with respect to:<ol><li>The exchange of two electrons (permutation of two rows) </li><li>The exchange of two spin orbitals (permutation of two columns)</li><li>Both of the above</li></ol></li>
				<li>Name three fermion to qubit transformations currently supported by Qiskit Nature.</li>
				<li>Name two fermion to qubit transformations that simulate a system of electrons with the same number of qubits as electrons.</li>
				<li>For which transformation does the resulting Hamiltonian commute with the number spin up and number spin down operators that can be used to taper off two qubits?</li>
			</ol>
			<p>Answers</p>
			<ol>
				<li value="1">B</li>
				<li>C</li>
				<li>Jordan-Wigner, Parity, Bravyi-Kitaev</li>
				<li>Jordan-Wigner, Parity</li>
				<li>Jordan-Wigner</li>
			</ol>
			<h1 id="_idParaDest-118"><a id="_idTextAnchor207"/>References</h1>
			<p>[Bravyi] Sergey Bravyi, Jay M. Gambetta, Antonio Mezzacapo, Kristan Temme, Tapering off qubits to simulate fermionic Hamiltonians, arXiv:1701.08213v1, January 27, 2017, <a href="https://arxiv.org/pdf/1701.08213.pdf">https://arxiv.org/pdf/1701.08213.pdf</a> </p>
			<p>[Cao] Yudong Cao, Jonathan Romero, Jonathan P. Olson, Matthias Degroote, Peter D. Johnson, Mária Kieferová, Ian D. Kivlichan, Tim Menke, Borja Peropadre, Nicolas P. D. Sawaya, Sukin Sim, Libor Veis, Alán Aspuru-Guzik, Quantum Chemistry in the Age of Quantum Computing, Chem. Rev. 2019, 119, 19, 10856–10915, August 30, 2019, <a href="https://doi.org/10.1021/acs.chemrev.8b00803">https://doi.org/10.1021/acs.chemrev.8b00803</a> </p>
			<p>[Chiew] Mitchell Chiew and Sergii Strelchuk, Optimal fermion-qubit mappings, arXiv:2110.12792v1 [quant-ph], October 25, 2021, <a href="https://arxiv.org/pdf/2110.12792.pdf">https://arxiv.org/pdf/2110.12792.pdf</a> </p>
			<p>[De Keijzer] de Keijzer, R. J. P. T., Colussi, V. E., Škorić, B., and Kokkelmans, S. J. J. M. F. (2021), Optimization of the Variational Quantum Eigensolver for Quantum Chemistry Applications, arXiv, 2021, [2102.01781], <a href="https://arxiv.org/abs/2102.01781">https://arxiv.org/abs/2102.01781</a> </p>
			<p>[Grok] Grok the Bloch Sphere, <a href="https://javafxpert.github.io/grok-bloch/">https://javafxpert.github.io/grok-bloch/</a> </p>
			<p>[IBM_CEO] IBM CEO: Quantum computing will take off 'like a rocket ship' this decade, Fast Company, September 28, 2021, <a href="https://www.fastcompany.com/90680174/ibm-ceo-quantum-computing-will-take-off-like-a-rocket-ship-this-decade">https://www.fastcompany.com/90680174/ibm-ceo-quantum-computing-will-take-off-like-a-rocket-ship-this-decade</a> </p>
			<p>[IBM_comp1] Welcome to IBM Quantum Composer, <a href="https://quantum-computing.ibm.com/composer/docs/iqx/">https://quantum-computing.ibm.com/composer/docs/iqx/</a> </p>
			<p>[IBM_comp2] IBM Quantum Composer, <a href="https://quantum-computing.ibm.com/composer/files/new">https://quantum-computing.ibm.com/composer/files/new</a></p>
			<p>[Kaplan] Ilya G. Kaplan, Modern State of the Pauli Exclusion Principle and the Problems of Its Theoretical Foundation, Symmetry 2021, 13(1), 21, <a href="https://doi.org/10.3390/sym13010021">https://doi.org/10.3390/sym13010021</a> </p>
			<p>[Mezzacapo] Antonio Mezzacapo, Simulating Chemistry on a QuantumComputer, Part I, Qiskit Global Summer School 2020, IBM Quantum, Qiskit, Introduction to Quantum Computing and Quantum Hardware, <a href="https://qiskit.org/learn/intro-qc-qh/">https://qiskit.org/learn/intro-qc-qh/</a>, Lecture Notes 8, <a href="https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/lectures/introqcqh-lecture-notes-8.pdf?raw=true">https://github.com/qiskit-community/intro-to-quantum-computing-and-quantum-hardware/blob/master/lectures/introqcqh-lecture-notes-8.pdf?raw=true</a> </p>
			<p>[NumPy] NumPy: the absolute basics for beginners, <a href="https://numpy.org/doc/stable/user/absolute_beginners.html">https://numpy.org/doc/stable/user/absolute_beginners.html</a></p>
			<p>[Panagiotis] Panagiotis Kl. Barkoutsos, Jerome F. Gonthier, Igor Sokolov, Nikolaj Moll, Gian Salis, Andreas Fuhrer, Marc Ganzhorn, Daniel J. Egger, Matthias Troyer, Antonio Mezzacapo, Stefan Filipp, Ivano Tavernelli, Quantum algorithms for electronic structure calculations: Particle-hole Hamiltonian and optimized wave-function expansions, Phys. Rev. A 98, 022322 – Published August 20, 2018, DOI: 10.1103/PhysRevA.98.022322, <a href="https://link.aps.org/doi/10.1103/PhysRevA.98.022322">https://link.aps.org/doi/10.1103/PhysRevA.98.022322</a> </p>
			<p>[Qiskit] Qiskit, <a href="https://qiskit.org/">https://qiskit.org/</a> </p>
			<p>[Qiskit_Nat_0] Qiskit_Nature, <a href="https://github.com/Qiskit/qiskit-nature/blob/main/README.md">https://github.com/Qiskit/qiskit-nature/blob/main/README.md</a> </p>
			<p>[Qiskit_Nat_1] Qiskit Nature and Finance Demo Session, with Max Rossmannek and Julien Gacon, October 15, 2021, <a href="https://www.youtube.com/watch?v=UtMVoGXlz04">https://www.youtube.com/watch?v=UtMVoGXlz04</a> </p>
			<p>[Qiskit_Nat_2] FermionicOp, <a href="https://qiskit.org/documentation/nature/stubs/qiskit_nature.operators.second_quantization.FermionicOp.html">https://qiskit.org/documentation/nature/stubs/qiskit_nature.operators.second_quantization.FermionicOp.html</a> </p>
			<p>[Qiskit_Nat_3] ElectronicStructureProblem.second_q_ops, <a href="https://qiskit.org/documentation/nature/stubs/qiskit_nature.problems.second_quantization.ElectronicStructureProblem.second_q_ops.html">https://qiskit.org/documentation/nature/stubs/qiskit_nature.problems.second_quantization.ElectronicStructureProblem.second_q_ops.html</a> </p>
			<p>[Qiskit_Nat_4] QubitConverter, <a href="https://qiskit.org/documentation/nature/stubs/qiskit_nature.converters.second_quantization.QubitConverter.html">https://qiskit.org/documentation/nature/stubs/qiskit_nature.converters.second_quantization.QubitConverter.html</a> </p>
			<p>[Qiskit_Nat_5] Qiskit Nature Tutorials, Electronic structure, <a href="https://qiskit.org/documentation/nature/tutorials/01_electronic_structure.html">https://qiskit.org/documentation/nature/tutorials/01_electronic_structure.html</a></p>
			<p>[Qiskit_Nat_T] Second-Quantization Operators (qiskit_nature.operators.second_quantization) &gt; FermionicOp &gt; FermionicOp.set_truncation, <a href="https://qiskit.org/documentation/nature/stubs/qiskit_nature.operators.second_quantization.FermionicOp.set_truncation.html">https://qiskit.org/documentation/nature/stubs/qiskit_nature.operators.second_quantization.FermionicOp.set_truncation.html</a> </p>
			<p>[Qiskit_Nature] Introducing Qiskit Nature, Qiskit, Medium, April 6, 2021, <a href="https://medium.com/qiskit/introducing-qiskit-nature-cb9e588bb004">https://medium.com/qiskit/introducing-qiskit-nature-cb9e588bb004</a> </p>
			<p>[Ribeiro] Sofia Leitão, Diogo Cruz, João Seixas, Yasser Omar, José Emilio Ribeiro, J.E.F.T. Ribeiro, Quantum Simulation of Fermionic Systems, CERN, <a href="https://indico.cern.ch/event/772852/contributions/3505906/attachments/1905096/3146117/Quantum_Simulation_of_Fermion_Systems.pdf">https://indico.cern.ch/event/772852/contributions/3505906/attachments/1905096/3146117/Quantum_Simulation_of_Fermion_Systems.pdf</a> </p>
			<p>[Seeley] Jacob T. Seeley, Martin J. Richard, Peter J. Love, The Bravyi-Kitaev transformation for quantum computation of electronic structure, August 29, 2012, arXiv:1208.5986 [quant-ph], <a href="https://arxiv.org/abs/1208.5986v1">https://arxiv.org/abs/1208.5986v1</a> </p>
			<p>[Skylaris] CHEM6085: Density Functional Theory, Lecture 8, Gaussian basis sets, <a href="https://www.southampton.ac.uk/assets/centresresearch/documents/compchem/DFT_L8.pdf">https://www.southampton.ac.uk/assets/centresresearch/documents/compchem/DFT_L8.pdf</a> </p>
			<p>[Skylaris_1] C.-K. Skylaris, CHEM3023: Spins, Atoms, and Molecules, Lecture 8, Experimental observables / Unpaired electrons, <a href="https://www.southampton.ac.uk/assets/centresresearch/documents/compchem/chem3023_L8.pdf">https://www.southampton.ac.uk/assets/centresresearch/documents/compchem/chem3023_L8.pdf</a> </p>
			<p>[Toulouse] Julien Toulouse, Introduction to quantum chemistry, January 20, 2021, <a href="https://www.lct.jussieu.fr/pagesperso/toulouse/enseignement/introduction_qc.pdf">https://www.lct.jussieu.fr/pagesperso/toulouse/enseignement/introduction_qc.pdf</a> </p>
			<p>[Tranter] Andrew Tranter, Peter J. Love, Florian Mintert, Peter V. Coveney, A comparison of the Bravyi-Kitaev and Jordan-Wigner transformations for the quantum simulation of quantum chemistry, December 5,  2018, J. Chem. Theory Comput. 2018, 14, 11, 5617–5630, <a href="https://doi.org/10.1021/acs.jctc.8b00450">https://doi.org/10.1021/acs.jctc.8b00450</a> </p>
			<p>[Wiki-Comb] Number of k-combinations for all k, Wikipedia, <a href="https://en.wikipedia.org/wiki/Combination#Number_of_k-combinations_for_all_k">https://en.wikipedia.org/wiki/Combination#Number_of_k-combinations_for_all_k</a> </p>
			<p>[Wiki-GAU] Gaussian orbital, Wikipedia, <a href="https://en.wikipedia.org/wiki/Gaussian_orbital">https://en.wikipedia.org/wiki/Gaussian_orbital</a> </p>
			<p>[Wiki-STO] Slater-type orbital, Wikipedia, <a href="https://en.wikipedia.org/wiki/Slater-type_orbital">https://en.wikipedia.org/wiki/Slater-type_orbital</a> </p>
			<p>[Yepez] Jeffrey Yepez, Lecture notes: Quantum gates in matrix and ladder operator forms, January 15, 2013, <a href="https://www.phys.hawaii.edu/~yepez/Spring2013/lectures/Lecture2_Quantum_Gates_Notes.pdf">https://www.phys.hawaii.edu/~yepez/Spring2013/lectures/Lecture2_Quantum_Gates_Notes.pdf</a></p>
		</div>
	</div></body></html>