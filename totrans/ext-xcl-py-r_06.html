<html><head></head><body>
		<div><h1 id="_idParaDest-101" class="chapter-number"><a id="_idTextAnchor119"/>6</h1>
			<h1 id="_idParaDest-102"><a id="_idTextAnchor120"/>Inserting ggplot2/matplotlib Graphs</h1>
			<p>As a programmer, data visualizations are an indispensable tool for analyzing and presenting complex information in a more <a id="_idIndexMarker374"/>accessible and intuitive manner. They play a vital role in various domains, from data analysis and business intelligence to scientific research and even everyday decision-making. One of the reasons that visuals are beneficial to decision-making is that they help an analyst understand data to help communicate items that can help in the decision-making process. Here are some other reasons:</p>
			<ul>
				<li><strong class="bold">Enhanced understanding</strong>: Visualizations provide a clear and concise representation of data, making it easier for both technical and non-technical stakeholders to grasp complex relationships, trends, and patterns. They help identify outliers, correlations, and insights that might otherwise be overlooked in raw data.</li>
				<li><strong class="bold">Effective communication</strong>: Visualizations are a powerful communication tool that transcends language barriers and simplifies complex concepts. Presenting data in charts, graphs, and interactive dashboards allows for a more compelling and persuasive narrative during meetings, presentations, and reports. When data is presented visually, it becomes easier to digest and understand. For example, a Sankey chart helps to make a visualization of how data flows from a starting point to an endpoint easily digestible.</li>
				<li><strong class="bold">Geospatial analysis</strong>: Geographic data visualizations  enable deeper exploration.</li>
			</ul>
			<p>Examples of popular data visualizations include line charts for time series analysis, bar and pie charts for categorical data comparison, scatter plots for correlation analysis, bubble charts for multivariate comparisons, and choropleth maps for geospatial data representation.</p>
			<p>In conclusion, data visualizations are indispensable for programmers, as they facilitate data understanding, communication, decision-making, and exploration, making them an essential tool in today’s data-driven world.</p>
			<p>In the following sections, we are going to explore the use of <code>ggplot2</code> and <code>cowplot</code> to build some visualizations, such as histograms, ordered bar charts, and dumbbell charts.</p>
			<p>In this chapter, we are going to learn the following topics:</p>
			<ul>
				<li>Visualizing data with <code>ggplot2</code></li>
				<li>Enhancing your Excel reports with <code>plotnine2</code>, <code>matplotlib</code>, and <code>plotly</code> graphs</li>
				<li>Enhancing Excel reports with visualizations</li>
				<li>An introduction to data visualization libraries</li>
				<li>Creating graphs with <code>plotnine</code> (Python’s <code>ggplot2</code>)</li>
				<li>Other visualization libraries</li>
				<li>Embedding visualizations in Excel</li>
			</ul>
			<h1 id="_idParaDest-103"><a id="_idTextAnchor121"/>Technical requirements</h1>
			<p>For this chapter, you will need to make sure that you have a few different R packages installed. These include the following:</p>
			<ul>
				<li><code>ggplot2 3.4.4</code></li>
				<li><code>cowplot 1.1.3</code></li>
			</ul>
			<p>The code for this chapter can be found on GitHub at the following link:<a href="https://github.com/PacktPublishing/Extending-Excel-with-Python-and-R/tree/main/chapter6"> https://github.com/PacktPublishing/Extending-Excel-with-Python-and-R/tree/main/chapter</a>6.</p>
			<h1 id="_idParaDest-104"><a id="_idTextAnchor122"/>Some basics</h1>
			<p>Before we dive into the core of this chapter, here are some things that it will help us understand:</p>
			<ul>
				<li><strong class="bold">Effective communication</strong>: Visualizations are a powerful communication tool that transcends language barriers and simplifies complex concepts. Presenting data in charts, graphs, and interactive dashboards allows for a more compelling and persuasive narrative during meetings, presentations, and reports.</li>
				<li><strong class="bold">Data-driven decision making</strong>: Visualizations empower decision-makers to base their judgments on data evidence. When data is presented visually, it becomes easier to identify potential <a id="_idIndexMarker375"/>opportunities, risks, and areas for improvement, leading to more informed and effective decisions.</li>
				<li><strong class="bold">Identifying trends and anomalies</strong>: Visualization tools enable programmers to spot trends, changes, and anomalies in data quickly. This is particularly valuable in fields such as finance, where spotting irregularities promptly can prevent significant financial losses.</li>
				<li><strong class="bold">Exploratory Data Analysis</strong> (<strong class="bold">EDA</strong>): Data visualizations are essential during the exploratory phase of data analysis. By creating scatter plots, histograms, box plots, and heatmaps, programmers can explore data’s distribution and relationships before diving into more in-depth analysis.</li>
				<li><strong class="bold">Real-time monitoring</strong>: In applications that deal with constantly changing data, real-time visualizations offer a dynamic way to monitor key metrics and respond swiftly to emerging situations.</li>
				<li><strong class="bold">Geospatial analysis</strong>: Geographic data visualizations, such as maps and heatmaps, are invaluable for analyzing location-based information, such as customer distribution, disease outbreaks, or environmental changes.</li>
				<li><strong class="bold">Forecasting and predictive analysis</strong>: Visualizations help in presenting predictive models’ results and trends, making it easier for stakeholders to understand potential future scenarios and make proactive decisions.</li>
				<li><strong class="bold">Interactive reporting</strong>: Interactive visualizations allow end users to customize and interact with data, creating a more personalized experience and enabling deeper exploration.</li>
			</ul>
			<p>Let us now go into the details of these basics.</p>
			<h2 id="_idParaDest-105"><a id="_idTextAnchor123"/>Visualizing data with ggplot2</h2>
			<p><code>ggplot2</code> is a powerful and widely used data visualization package in the R programming language. Developed by <a id="_idIndexMarker376"/>Hadley Wickham, it is part of the <code>tidyverse</code> ecosystem. With <code>ggplot2</code>, users can create high-quality and customizable graphics through a declarative approach, where plots are constructed by specifying data, mapping<a id="_idIndexMarker377"/> aesthetics to variables, and adding layers of geometric shapes, statistics, and themes. Its grammar of graphics paradigm allows you to easily create complex visualizations, making it a popular choice for exploratory data analysis and presentation of insights.</p>
			<p>In this section, we will make a few graphs using the <code>ggplot2</code> library and the <code>iris</code> dataset that comes with R. The first thing we need to do is install it and load it into the current environment:</p>
			<pre class="source-code">
install.packages("ggplot2")
library(ggplot2)</pre>			<p>Now that we have the library installed and loaded, we can first see how the graph will look in base R, using the <code>hist()</code> function and then looping through the <code>Species</code> column of data for <code>Sepal.Width</code>.</p>
			<p>Let’s see the rest of the script with an explanation to accompany it:</p>
			<pre class="source-code">
hist(iris$Sepal.Width)
par(mfrow = c(2,2))
for (species in unique(iris$Species)) {
  hist(iris$Sepal.Width[iris$Species == species], main = species,
         xlab = species)
}
hist(iris$Sepal.Width, main = "All Species")
par(mfrow = c(1,1))</pre>			<p>The first line of code, <code>hist(iris$Sepal.Width)</code>, makes a histogram of the sepal width for all species of iris. The iris dataset is built into R, so we don’t need to load it with the <code>data()</code> function. The <code>Sepal.Width</code> column of the iris dataset contains the sepal width measurements for each flower. The <code>hist()</code> function plots a histogram of the data in a specified<a id="_idIndexMarker378"/> column.</p>
			<p>The second line of <a id="_idIndexMarker379"/>code, <code>par(mfrow = c(2,2))</code>, tells R to split the plotting area into four quadrants. This will allow us to plot four histograms side by side.</p>
			<p>The third line of code, <code>for (species in unique(iris$Species)) {</code>, starts a <code>for</code> loop. The <code>for</code> loop will iterate over the unique values of the <code>Species</code> column in the iris dataset. The <code>unique()</code> function returns a vector of all the unique values in a column.</p>
			<p>The body of the <code>for</code> loop, <code>hist(iris$Sepal.Width[iris$Species == species], main = species, xlab = species)</code>, makes a histogram of the sepal width for the current species. The <code>iris$Sepal.Width[iris$Species == species]</code> expression selects the sepal width measurements for the current species. The <code>main</code> argument specifies the title of the histogram, and the <code>xlab</code> argument specifies the label for the x axis.</p>
			<p>The fourth line of code, <code>hist(iris$Sepal.Width, main = "All Species")</code>, makes a histogram of the sepal width for all species. This histogram is plotted in the last quadrant of the plotting area.</p>
			<p>The fifth line of code, <code>par(mfrow = c(1,1))</code>, tells R to reset the plotting area to a single quadrant. Now that we have gone over the code, let’s see what the output looks like:</p>
			<p class="IMG---Figure">f</p>
			<div><div><img src="img/B19142_06_1.jpg" alt="Figure 6.1 – Base R histograms"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.1 – Base R histograms</p>
			<p>Now that we have the<a id="_idIndexMarker380"/> base R version done, let’s see what this <a id="_idIndexMarker381"/>will look like in <code>ggplot2</code>:</p>
			<pre class="source-code">
# Make a histogram of the sepal width for all species
iris |&gt;
ggplot(aes(x = Sepal.Width)) +
  geom_histogram(alpha = 0.328) +
  theme_minimal()
# Make a histogram of the sepal width for each species
iris |&gt;
ggplot(aes(x = Sepal.Width, fill = Species)) +
  geom_histogram(alpha = 0.328) +
  theme_minimal()</pre>			<p>The first line of code, <code>iris |&gt; ggplot(aes(x = Sepal.Width)) + geom_histogram(alpha = 0.328) + theme_minimal()</code>, makes a histogram of the sepal width for all species of iris. The iris dataset is built into R, so we don’t need to load it with the <code>data()</code> function. The <code>ggplot()</code> function is a powerful plotting function in R that <a id="_idIndexMarker382"/>allows us to create customized visualizations. The <code>aes()</code> function specifies the aesthetic mappings for the plot. In this case, we are mapping<a id="_idIndexMarker383"/> the sepal width to the <em class="italic">x</em>-axis. The <code>geom_histogram()</code> function plots a histogram of the data in the specified column. The alpha argument specifies the transparency of the bars in the histogram. The <code>theme_minimal()</code> function applies a minimal theme to the plot.</p>
			<p>The second line of code, <code>iris |&gt; ggplot(aes(x = Sepal.Width, fill = Species)) + geom_histogram(alpha = 0.328) + theme_minimal()</code>, makes a histogram of the sepal width for each species. The <code>fill</code> argument in the <code>aes()</code> function specifies the fill color of the bars in the histogram. In this case, we are using the <code>Species</code> column to color the bars in the histogram. This will allow us to see the distribution of sepal width for each species. Now that we have gone over the code, let’s see the output.</p>
			<p>This will be in two plots, as <code>ggplot2</code> objects are not plotted in a similar fashion to base R using the <code>par()</code> function.</p>
			<p>Here is the first plot:</p>
			<div><div><img src="img/B19142_06_2.jpg" alt="Figure 6.2 – A ggplot2 histogram of Sepal.Width for all species"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.2 – A ggplot2 histogram of Sepal.Width for all species</p>
			<p>This is the second plot:</p>
			<div><div><img src="img/B19142_06_3.jpg" alt="Figure 6.3 – A ggplot2 histogram of Sepal.Width filled by species"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.3 – A ggplot2 histogram of Sepal.Width filled by species</p>
			<p>Now, there is one way in which <a id="_idIndexMarker384"/>we can see the histograms side by side in <code>ggplot2</code>, and<a id="_idIndexMarker385"/> that is by using the <code>facet_wrap()</code> function:</p>
			<pre class="source-code">
iris |&gt;
  ggplot(aes(x = Sepal.Width, fill = Species)) +
  geom_histogram(alpha = 0.328) +
  facet_wrap(~ Species, scales = "free") +
  theme_minimal()</pre>			<p>The <code>aes()</code> function specifies the aesthetic mappings for the plot. In this case, we are mapping the sepal width to the <em class="italic">x</em>-axis and the species to the fill color of the bars. The <code>geom_histogram()</code> function plots a histogram of the data in the specified columns. The alpha argument specifies the transparency of the bars in the histogram. The <code>facet_wrap()</code> function creates a separate plot for each value of the <code>Species</code> column. The <code>scales = "free"</code> argument tells the <code>facet_wrap()</code> function to allow the x axis and y axis scales to vary for each plot. The <code>theme_minimal()</code> function applies a minimal theme to the plot. The output of the code is a series of three histograms, one for each species of iris. The histograms show the distribution of sepal width for each species. The <a id="_idIndexMarker386"/>different colors of the bars make it easy to see the distribution of sepal width for each species. Here is the result:</p>
			<div><div><img src="img/B19142_06_4.jpg" alt="Figure 6.4 – The ggplot2 histogram of Sepal.Width using facet_wrap"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.4 – The ggplot2 histogram of Sepal.Width using facet_wrap</p>
			<p>In this section, we learned how to plot some simple histograms using both base R and <code>ggplot2</code>. We learned how<a id="_idIndexMarker387"/> to facet the histogram by species in both situations as well.</p>
			<p>We have finished working in <code>ggplot</code>, and now it is time to see how we can extend plots with the use of a cowplot, which can help us build more complex and publication-ready graphics.</p>
			<h2 id="_idParaDest-106"><a id="_idTextAnchor124"/>Visualizing data with the cowplot package</h2>
			<p>The R <code>cowplot</code> package provides<a id="_idIndexMarker388"/> numerous functions for plotting <a id="_idIndexMarker389"/>data that is of high quality. The <code>cowplot</code> package is an R library that provides various features to help with creating publication-quality figures. It can be used for the following:</p>
			<ul>
				<li><code>plot_grid()</code> function can be used to arrange multiple plots into a grid, with labels and annotations</li>
				<li><code>align_plots()</code> function can be used to align the axes and other elements of multiple plots so that they look consistent</li>
				<li><code>plot_grid()</code> function can be used to mix plots from different<a id="_idIndexMarker390"/> plotting frameworks, such as <code>ggplot2</code> and base graphics</li>
				<li><code>ggdraw()</code> and <code>draw_*()</code> functions can be used to add annotations<a id="_idIndexMarker391"/> to plots, such as text, images, and shapes</li>
				<li><code>cowplot</code> package includes several themes that are designed for publication-quality figures</li>
			</ul>
			<p>Now that we understand what <code>cowplot</code> is, let’s dive into the first example:</p>
			<pre class="source-code">
# Install Libraries
install.packages("ggplot2")
install.packages("cowplot")
# Load required libraries
library(ggplot2)
library(cowplot)
# Load the Iris dataset
data(iris)</pre>			<p>In the preceding code, we install both the <code>ggplot2</code> and <code>cowplot</code> libraries; this will work even if they are already installed, but we will install the latest version.</p>
			<p>Now, let’s use a <code>for</code> loop to create a plot for each species of the iris dataset:</p>
			<pre class="source-code">
# Create separate histograms for each species
histograms &lt;- list()
for (species in unique(iris$Species)) {
  data_subset &lt;- iris[iris$Species == species, ]
  histogram &lt;- ggplot(data_subset, aes(x = Sepal.Width)) +
     geom_histogram(binwidth = 0.1, fill = "lightblue", color = "black") +
     labs(title = paste("Sepal Width Histogram for", species)) +
     labs(x = "", y = "") +
     theme_minimal()
  histograms[[species]] &lt;- histogram
}</pre>			<p>Let’s break the code down <a id="_idIndexMarker392"/>step by step in simple terms.</p>
			<p>The <code>histograms &lt;- list()</code> line creates an empty list called <code>histograms</code>, where we’ll store the histograms for each species.</p>
			<p>In the next line, for <code>(species in unique(iris$Species))</code> <code>{ ... }</code>, the loop goes through each unique species in the Iris dataset and performs the following steps for each species. Next is <code>data_subset &lt;- iris[iris$Species == species, ]</code>; this line<a id="_idIndexMarker393"/> creates a subset of the Iris dataset, including only the rows where the species matches the current species in the loop. It helps us focus on data for one species at a time.</p>
			<p>The <code>histogram &lt;- ggplot(data_subset, aes(x = Sepal.Width)) + ...</code> line is where the magic happens. We’re using the <code>ggplot2</code> library to create a histogram. It’s like drawing a graph that shows how many flowers have a specific sepal width. The <code>aes(x = Sepal.Width)</code> option tells R that we’re interested in plotting the <code>Sepal.Width</code> on the <em class="italic">x</em>-axis.</p>
			<p>The fifth line, <code>geom_histogram(binwidth = 0.1, fill = "lightblue", color = "black")</code>, adds the bars to the histogram. It specifies how the bars should look, such as their <a id="_idIndexMarker394"/>width and color. It’s like building the columns of the histogram.</p>
			<p>The <code>labs(title = paste("Sepal Width Histogram for", species))</code> line adds a<a id="_idIndexMarker395"/> title to the histogram, telling us what it’s about. The title changes based on the current species in the loop. It’s like writing a name tag for each histogram. The next line, <code>labs(x = "", y = "")</code>, removes the <em class="italic">x</em>- and <em class="italic">y</em>-axis labels, making the histogram look cleaner. We then add a theme to the plot using <code>theme_minimal()</code>, which makes the background of the histogram simple and clean. Finally, the <code>histograms[[species]] &lt;- histogram</code> line takes the histogram for the current species, and we store it in the <code>histograms</code> list. We use the species name to access this histogram later. The following code is slightly different but produces the same exact plots:</p>
			<pre class="source-code">
histograms &lt;- lapply(unique(iris$Species), function(species) {
  data_subset &lt;- iris[iris$Species == species, ]
  histogram &lt;- ggplot(data_subset, aes(x = Sepal.Width)) +
     geom_histogram(binwidth = 0.1, fill = "lightblue", color = "black") +
     labs(title = paste("Sepal Width Histogram for", species)) +
     labs(x = "", y = "") +
     theme_minimal()
  return(histogram)
})</pre>			<p>So, in summary, this code creates histograms for the sepal width of different species in the iris dataset. It does this by looping through each species, creating a subset of data for that species, and then creating <a id="_idIndexMarker396"/>a histogram with appropriate formatting and labels. All the histograms are stored<a id="_idIndexMarker397"/> in a list called <code>histograms</code>, so we can use them later. In this list, each species is a histogram<a id="_idIndexMarker398"/> object, and the object is named after the species it visualizes. Now, we are going to create and explain the histogram created on the full dataset and then combine them all, using the <code>plot_grid()</code> function from cowplot. Here is the code:</p>
			<pre class="source-code">
# Create histogram for all species combined
all_species_hist &lt;- ggplot(iris, aes(x = Sepal.Width)) +
  geom_histogram(binwidth = 0.1, fill = "lightblue", color = "black") +
  labs(title = "Sepal Width Histogram for All Species") +
  theme_minimal()
# Arrange histograms using cowplot
plot_grid(
  histograms[["setosa"]],
  histograms[["versicolor"]],
  histograms[["virginica"]],
  all_species_hist,
  ncol = 2,
  align = "hv"
  )</pre>			<p>The first line of code that creates the <code>all_species_hist</code> variable creates a histogram of the <code>Sepal.Width</code> column for all species combined. The histogram has a binwidth of <code>0.1</code>, and the fill color is light blue. The color of the borders is black. The title of the histogram is <code>Sepal Width Histogram for All Species</code>. The theme of the histogram is <code>theme_minimal()</code>.</p>
			<p>The next line of code, <code>plot_grid(histograms[["setosa"]], histograms[["versicolor"]], histograms[["virginica"]], all_species_hist, ncol = 2, align = "hv")</code>, uses the <code>cowplot</code> package to arrange the histograms for each species into a grid. The histograms are arranged in two columns, and they are aligned horizontally and vertically.</p>
			<p>The <code>plot_grid()</code> function takes<a id="_idIndexMarker399"/> a list of plots as its arguments. The plots are arranged in a grid according<a id="_idIndexMarker400"/> to the number of columns and rows specified by the <code>ncol</code> and <code>nrow</code> arguments. The <code>align</code> argument specifies how the plots are aligned with each other. In this case, the plots are aligned horizontally and vertically with the <code>align = "</code><code>hv"</code> argument.</p>
			<p>The output of the <code>plot_grid()</code> function is a grid of plots that can be saved to a file or displayed in the R console. Now, let’s see the final output:</p>
			<div><div><img src="img/B19142_06_5.jpg" alt="Figure 6.5 – Using cowplot to plot four histograms together"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.5 – Using cowplot to plot four histograms together</p>
			<p>Now that we have seen how to effectively use <code>cowplot</code> to combine plots and control other parts of the graphic, we can move on to the next type of plot, bar charts and dumbbell plots.</p>
			<h2 id="_idParaDest-107"><a id="_idTextAnchor125"/>Bar charts and dumbbell plots</h2>
			<p>A bar chart and dumbbell plot are all types of visualizations used to represent data. Here is a description of each and their pros and cons. First up is the bar chart. A bar chart, also known as a bar graph, uses rectangular <a id="_idIndexMarker401"/>bars to compare different categories of data. The length or height of each bar represents the value of a particular category. The bars can be plotted vertically or horizontally, with the most common type being vertical. Some of the pros of a bar chart are as follows:</p>
			<ul>
				<li><strong class="bold">Easy to read and interpret</strong>: Bar<a id="_idIndexMarker402"/> charts are straightforward and intuitive, making them easy to understand even for people without a background in statistics or data visualization</li>
				<li><strong class="bold">Effective for comparisons</strong>: Bar charts allow for quick and easy comparisons between different categories, making them useful for identifying patterns or trends</li>
				<li><strong class="bold">Suitable for categorical data</strong>: Bar charts are ideal for representing categorical or discrete variables</li>
			</ul>
			<p>Here are some of the <a id="_idIndexMarker403"/>cons:</p>
			<ul>
				<li><strong class="bold">Limited for continuous data</strong>: Bar charts are not as effective for representing continuous variables or data with many distinct values</li>
				<li><strong class="bold">Potential readability issues</strong>: When the number of bars is large or the values are close in magnitude, it can be challenging to read the exact values on the chart</li>
			</ul>
			<p>A dumbbell plot, also known<a id="_idIndexMarker404"/> as a connected <a id="_idIndexMarker405"/>dot plot or a range bar chart, compares the values of two<a id="_idIndexMarker406"/> categories or groups. It consists of two dots or markers connected by a line, with each dot representing a value and the line indicating the range between them. Here are its pros:</p>
			<ul>
				<li><strong class="bold">Highlights differences and comparisons</strong>: Dumbbell plots are effective for emphasizing the differences or comparisons between two categories or groups</li>
				<li><strong class="bold">Shows ranges and variances</strong>: The line connecting the dots in a dumbbell plot represents the range or variance<a id="_idIndexMarker407"/> between the values, providing additional information</li>
				<li><strong class="bold">Suitable for categorical or continuous data</strong>: Dumbbell plots can be used for both ordinal and continuous variables</li>
			</ul>
			<p>Here are the cons:</p>
			<ul>
				<li><strong class="bold">Limited for multiple comparisons</strong>: Dumbbell plots are best suited for comparing two categories or groups. If there are more than two groups, the plot can become cluttered and confusing.</li>
				<li><strong class="bold">Less common and familiar</strong>: Dumbbell plots are not as widely used or recognized as bar charts or time series charts, which may make them less familiar to some viewers.</li>
			</ul>
			<p>In summary, bar charts are useful for comparing values between groups, and dumbbell plots are suitable for comparing two categories or groups. Each visualization has its strengths and limitations, and the choice depends on the nature of the data and the specific insights you want to convey.</p>
			<p>Now that we have some information about the different types of plots, along with their pros and cons, it’s time to delve into creating them and seeing the output.</p>
			<h3>Bar charts with ggplot2</h3>
			<p>Bar charts can be plotted vertically or horizontally, with the most common type being vertical. The vertical axis on the left or right side of the bar chart is called the y axis, while the horizontal axis at the<a id="_idIndexMarker408"/> bottom of the chart is called the x axis. The height or length of each bar represents the value of a particular category of data. Bar charts <a id="_idIndexMarker409"/>can be used to compare different sets of data among different groups easily, and they can illustrate important changes in data throughout a period. They can be of great use when explaining the meaning of complex data, as they allow for quick and easy comparisons between different categories. Bar charts are particularly useful for showing segments of information and are commonly used to present data or concepts involving data visually. Some key properties of bar charts include the following:</p>
			<ul>
				<li>The bars are rectangular and of equal width, with varying heights</li>
				<li>The gap between one bar and another should be uniform throughout</li>
				<li>They can be either horizontal or vertical</li>
			</ul>
			<p>Overall, bar charts are a useful tool to convey relational information quickly in a visual manner and can be used to <a id="_idIndexMarker410"/>compare different sets of data among different groups <a id="_idIndexMarker411"/>easily. Now that we have a basic understanding of a bar chart and how it is useful, let’s go through an example using the <code>ggplot2</code> library.</p>
			<p>First, let’s load in the required libraries, of which <code>healthyR</code> and <code>healthyR.data</code> may need to be installed on your machine, as they may not have been already:</p>
			<pre class="source-code">
library(healthyR.data)
library(healthyR)
library(ggplot2)
library(dplyr)
library(forcats)
library(purrr)</pre>			<p>Here, we’re loading several packages that provide functions and tools for data manipulation (<code>dplyr</code>, <code>forcats</code>, and <code>purrr</code>) and visualization (<code>ggplot2</code>). These packages extend R’s capabilities for handling data and creating plots. We load in the <code>healthyR.data</code> library for the dataset to work with and the <code>healthyR</code> library for the use of the <code>category_counts_tbl()</code> function.</p>
			<p>The next block of code is used to create the dataset that we are going to plot:</p>
			<pre class="source-code">
df &lt;- healthyR_data |&gt;
  filter(payer_grouping != '?') |&gt;
  category_counts_tbl(
     .count_col = payer_grouping
     , .arrange = TRUE
     , ip_op_flag
  ) |&gt;
  group_by(ip_op_flag) |&gt;
  mutate(order_var = paste0(
     sprintf("%02i", as.integer(rank(n))),
     " - ",
     payer_grouping
     )) |&gt;
  ungroup()</pre>			<p>In this step, a pipeline (<code>|&gt;</code>) is used to perform a series of operations on the data:</p>
			<ul>
				<li><code>healthyR_data</code> is a <a id="_idIndexMarker412"/>dataset provided by the <code>healthyR.data</code> package.</li>
				<li>The <code>filter()</code> function<a id="_idIndexMarker413"/> removes rows where the <code>payer_grouping</code> column is not equal to ‘<code>?</code>’.</li>
				<li>The <code>category_counts_tbl()</code> function is applied, which counts the occurrences of each unique value in the <code>payer_grouping</code> column within each combination of <code>ip_op_flag</code> values. The <code>.count_col</code> argument specifies the column to count, <code>.arrange</code> sorts the counts in descending order, and <code>ip_op_flag</code> groups the data by this column.</li>
				<li>The data is grouped by the <code>ip_op_flag</code> column using <code>group_by()</code>.</li>
				<li>The <code>mutate()</code> function adds a new column named <code>order_var</code>, which contains formatted rank values based on the count column, <code>n</code>. This is done using the <code>sprintf()</code> function to format the rank as a two-digit integer. We then ungroup the data, as the groups are no longer necessary.</li>
			</ul>
			<p>Now, let’s make the plot:</p>
			<pre class="source-code">
ggplot(df, aes(x = order_var, y = n)) +
  geom_col(alpha = 0.328) +
  labs(x = "", y = "") +
  theme(legend.position = "none") +
  facet_wrap(~ ip_op_flag, scale = "free") +
  scale_x_discrete(
     labels =  with(df, as.character(payer_grouping) |&gt;
                              set_names(order_var))) +
  xlab(NULL) +
  theme(axis.text.x = element_text(
     angle = 90, hjust=1, vjust=.5)) +
  coord_flip() +
  theme_minimal()</pre>			<p>This section creates a bar plot using <code>ggplot2</code>:</p>
			<ul>
				<li><code>ggplot()</code> initializes the<a id="_idIndexMarker414"/> plot, and <code>aes()</code> specifies aesthetics (such as what goes on the x axis and y axis).</li>
				<li><code>geom_col()</code> adds bars<a id="_idIndexMarker415"/> to the plot, where the height of each bar represents the value of <em class="italic">n</em>. The alpha parameter controls the transparency of the bars.</li>
				<li><code>labs()</code> sets the axis labels to be empty.</li>
				<li><code>theme()</code> allows theme adjustments to be made, such as removing the legend and using a minimal theme.</li>
				<li><code>facet_wrap()</code> is used to create separate panels for each unique value of <code>ip_op_flag</code>.</li>
				<li><code>scale_x_discrete()</code> is used to customize the <em class="italic">x</em>-axis labels using the <code>payer_grouping</code> values, indexed by <code>order_var</code>.</li>
				<li><code>xlab(NULL)</code> removes the <em class="italic">x</em>-axis label.</li>
				<li><code>theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = .5))</code> adjusts the appearance of the <em class="italic">x</em>-axis text, making it vertical.</li>
				<li><code>coord_flip()</code> flips the <em class="italic">x</em> and <em class="italic">y</em> axes.</li>
				<li><code>theme_minimal()</code> applies a minimalistic theme to the plot.</li>
			</ul>
			<p>In summary, this code <a id="_idIndexMarker416"/>takes a dataset, filters and processes it, and then creates a <a id="_idIndexMarker417"/>bar plot with multiple facets, each displaying bars based on counts of a categorical variable. The plot’s appearance is customized using various <code>ggplot2</code> functions and settings. Now, after all of that, let’s see the final output:</p>
			<div><div><img src="img/B19142_06_6.jpg" alt="Figure 6.6 – Using ggplot2 to create bar plots"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.6 – Using ggplot2 to create bar plots</p>
			<p>In this section, we have learned how to make a fairly sophisticated horizonal bar chart. We created an ordered one that allowed us to see information in two different groups ordered by the same factor column. It shows us volumes by insurance payer group for inpatient and outpatient facets. Now, we will move onto the dumbbell plot.</p>
			<h3>Dumbbell plots with ggplot2</h3>
			<p>A dumbbell plot, also <a id="_idIndexMarker418"/>known as a <em class="italic">dot plot with lines</em>, is a visualization that displays the change<a id="_idIndexMarker419"/> between two <a id="_idIndexMarker420"/>points for different categories. It often uses dots (representing the categories) connected by lines to show the change. In R, you can create a dumbbell plot using libraries such as <code>ggplot2</code>. Here’s how you can do it.</p>
			<p>First, make sure you have the <code>ggplot2</code> and <code>dplyr</code> packages installed and loaded. You can install them if needed using <code>install.packages("ggplot2")</code> and <code>install.packages("dplyr")</code>.</p>
			<p>Let’s make a data frame; we<a id="_idIndexMarker421"/> will make this with two columns for the initial and final values, and a categorical variable to group them. Your data might look something like this:</p>
			<pre class="source-code">
# Sample data
data &lt;- data.frame(
  Category = c("A", "B", "C", "D"),
  Initial = c(10, 15, 8, 12),
  Final = c(18, 22, 14, 16)
)</pre>			<p>Now, let’s create a midpoint of <a id="_idIndexMarker422"/>our data before we make the actual plot:</p>
			<pre class="source-code">
data &lt;- data |&gt;
  mutate(Midpoint = (Initial + Final)/2)</pre>			<p>Now, we can go ahead and create the plot:</p>
			<pre class="source-code">
# Create the dumbbell plot using ggplot2
dumbbell_plot &lt;- ggplot(data, aes(x = Category, xend = Category, 
    y = Initial, yend = Final)) +
  geom_segment(color = "gray50") +  # Lines connecting dots
  geom_point(color = "blue", size = 3) +  # Initial values
  geom_point(aes(y = Final),
                  color = "orange", size = 3) +  # Final values
  geom_text(aes(label = Midpoint),
                 vjust = -0.5, size = 3) +  # Midpoint labels
  labs(title = "Dumbbell Plot",
         x = "Category",
         y = "Values") +
  theme_minimal()
# Print the plot
dumbbell_plot</pre>			<p>This example assumes you have a <code>Category</code> column in your data frame that defines the groups/categories. The<a id="_idIndexMarker423"/> plot will display initial values (blue dots), final values (red dots), lines <a id="_idIndexMarker424"/>connecting them, and midpoint labels above the lines. You can customize the aesthetics, colors, labels, and other elements according to your preferences. Now, let’s see what we have created.</p>
			<div><div><img src="img/B19142_06_7.jpg" alt="Figure 6.7 – A dumbbell plot with ggplot2"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.7 – A dumbbell plot with ggplot2</p>
			<p>Remember that this is just a basic example. Depending on your data and requirements, you might need to adjust the code to fit your needs. It is now time for some time series graphs.</p>
			<h1 id="_idParaDest-108"><a id="_idTextAnchor126"/>Enhancing your Excel reports with plotnine2, matplotlib, and plotly graphs</h1>
			<p>The Python section of this chapter explores the integration<a id="_idIndexMarker425"/> of popular data visualization libraries, such as <code>plotnine</code>, <code>matplotlib</code>, and <code>plotly</code>, with <a id="_idIndexMarker426"/>Microsoft Excel using Python.</p>
			<p>You’ll learn how to leverage the strengths of each library to visualize data effectively and enhance your Excel reports.</p>
			<p>This part of the chapter is organized into the following sections:</p>
			<ul>
				<li><em class="italic">Enhancing Excel reports with visualizations</em>: We’ll provide guidance on effectively using visualizations to communicate insights and patterns.</li>
				<li><em class="italic">Introduction to visualization libraries</em>: We’ll provide an overview of the key visualization libraries – <code>plotnine</code>, <code>matplotlib</code>, and <code>plotly</code>. Understanding these and the use cases is essential for selecting the right library for your needs.</li>
				<li><em class="italic">Creating graphs with </em><code>plotnine</code>: This section will delve into using the <code>plotnine</code> library to craft sophisticated graphs. You’ll learn how to generate various plot types, customize visual elements, and incorporate additional layers for enhanced clarity.</li>
				<li><em class="italic">Generating graphs with </em><code>matplotlib</code>: <code>matplotlib</code> is a versatile library for creating static visualizations. We’ll walk you through the process of generating different types of graphs using <code>matplotlib</code> and then transferring them into Excel for inclusion in your reports.</li>
				<li><em class="italic">Embedding visualizations into Excel</em>: This section covers the practical aspects of inserting graphs and charts generated<a id="_idIndexMarker427"/> with Python libraries into Excel sheets.</li>
			</ul>
			<p>By the end of this chapter, you’ll have<a id="_idIndexMarker428"/> the skills to seamlessly bridge the gap between data visualization in Python and Excel reporting. Whether you’re creating static graphs or interactive visualizations, you’ll be equipped to present data in a visually compelling and insightful way within Excel, facilitating more engaging and impactful reports.</p>
			<p>Let’s get plotting! (You can now imagine breaking out in an evil laugh!)</p>
			<h1 id="_idParaDest-109"><a id="_idTextAnchor127"/>Enhancing Excel reports with visualizations</h1>
			<p>In this section of the chapter, we dive into the practical <a id="_idIndexMarker429"/>aspect of using visualizations to enhance your Excel reports. Beyond the technical aspects of generating and embedding visualizations from Python, we will explore the broader significance of these visual aids in the context of data-driven decision-making. Visualizations in Excel aren’t just about aesthetics; they’re powerful tools for effectively communicating insights, patterns, and trends hidden within your data. Whether you’re preparing reports for stakeholders, colleagues, or clients, mastering the art of incorporating visualizations will elevate your data-driven narratives and facilitate more informed decision-making.</p>
			<p>The upcoming sections provide guidance on how to strategically use visualizations within your Excel reports to maximize their impact. You’ll learn not only how to create compelling graphs and charts but also how to interpret and present them effectively to convey your data’s story.</p>
			<p>Integrating visualizations into Excel reports goes beyond mere aesthetics – it’s about transforming data into insights that drive informed decisions. We will delve into various strategies to enhance the impact of your reports by effectively utilizing visualizations.</p>
			<p>The power of visualizations lies not just in their aesthetics but also in their ability to tell compelling stories with data. By mastering the art of choosing the right visualization type, utilizing annotations, simplifying complex data, and adhering to design principles, you’ll be well equipped to elevate your Excel reports to new levels of impact and clarity.</p>
			<h1 id="_idParaDest-110"><a id="_idTextAnchor128"/>An introduction to data visualization libraries</h1>
			<p>Data visualization is a fundamental aspect of data analysis, and Python offers a rich ecosystem of libraries to create engaging and informative visualizations. In this section, we will introduce you to three prominent <a id="_idIndexMarker430"/>data visualization libraries – <code>plotnine</code>, <code>matplotlib</code>, and <code>plotly</code>. Understanding the strengths and applications of each library is crucial for effectively conveying your data’s story in Excel reports.</p>
			<h2 id="_idParaDest-111"><a id="_idTextAnchor129"/>Plotnine – elegant grammar of graphics</h2>
			<p>The <code>ggplot2</code> library is a popular<a id="_idIndexMarker431"/> data visualization<a id="_idIndexMarker432"/> library in the R programming language, known for its expressive and declarative syntax. The Python adaptation is called <code>plotnine</code>.</p>
			<p>It is based on the <code>plotnine</code> excels in creating intricate, publication-quality plots. It offers fine-grained control over aesthetics, enabling you to customize every aspect of your visualization.</p>
			<h2 id="_idParaDest-112"><a id="_idTextAnchor130"/>Plotly – interactive visualizations</h2>
			<p><code>plotly</code> is a versatile Python library that <a id="_idIndexMarker434"/>specializes in creating interactive, web-based visualizations. It allows you to build interactive dashboards, scatter plots, line <a id="_idIndexMarker435"/>charts, and more. Users can hover over data points, zoom in, or filter data for a dynamic user experience.</p>
			<p><code>plotly</code> integrates seamlessly with Jupyter notebooks, making it a favorite choice for data scientists and analysts. It is ideal for generating interactive visualizations for web applications, reports, and data exploration.</p>
			<h2 id="_idParaDest-113"><a id="_idTextAnchor131"/>Matplotlib – classic and customizable plots</h2>
			<p><code>matplotlib</code> is a foundational library <a id="_idIndexMarker436"/>for creating static, high-quality<a id="_idIndexMarker437"/> visualizations in Python. It provides a wide range of plotting functions, making it suitable for various chart types, such as line plots, bar charts, and scatter plots.</p>
			<p><code>matplotlib</code> is highly customizable, allowing you to control every detail of your plots, from colors and labels to fonts and gridlines. It is the go-to choice for generating custom, static plots for<a id="_idIndexMarker438"/> research papers, presentations, and Excel reports.</p>
			<p>Understanding the capabilities and best use cases of these libraries will empower you to select the right tool for<a id="_idIndexMarker439"/> your data visualization needs. Whether you want to create elegant, static plots with <code>plotnine</code>, interactive dashboards with <code>plotly</code>, or highly customized visualizations with <code>matplotlib</code>, you’ll have the knowledge to choose the library that aligns with your goals.</p>
			<p>In the following sections, we’ll delve deeper into each library, providing practical examples and insights to help you master the art of data visualization in Python for Excel reports.</p>
			<p>Let’s dive into <code>plotnine</code> first.</p>
			<h1 id="_idParaDest-114"><a id="_idTextAnchor132"/>Creating graphs with plotnine (Python’s ggplot2)</h1>
			<p>In this section, we will explore the powerful capabilities of the <code>plotnine</code> library in Python, which draws inspiration from R’s <code>ggplot2</code>, covered by the R section of this chapter. You will see that (other than accounting for differences in syntax between R and Python) the code and features are extremely similar – <code>plotnine</code> and <em class="italic">ggplot2</em> are truly sister packages.</p>
			<p>By the end of this section, you’ll be <a id="_idIndexMarker440"/>well versed in generating a wide range of visualizations, customizing every detail, and incorporating additional layers for enhanced clarity.</p>
			<h2 id="_idParaDest-115"><a id="_idTextAnchor133"/>Understanding the grammar of graphics</h2>
			<p>Before we dive into creating impressive graphs with <code>plotnine</code>, it’s essential to understand the grammar of graphics. This structured approach to data visualization forms the core of <code>plotnine</code> and enables you to build complex plots by combining data, aesthetics, and geometric objects.</p>
			<p>Let’s break down some key concepts:</p>
			<ul>
				<li><code>plotnine</code> links data to visual <a id="_idIndexMarker441"/>elements in your plot. You’ll specify which variables represent the <em class="italic">x</em> and <em class="italic">y</em> axes, color, shape, size, and so on.</li>
				<li><strong class="bold">Aesthetics</strong>: Aesthetics control how <a id="_idIndexMarker442"/>data attributes are represented visually. You can use aesthetics to encode information such as color, shape, and size.</li>
				<li><code>plotnine</code> encourages<a id="_idIndexMarker443"/> a layered approach. Each layer adds a <a id="_idIndexMarker444"/>new element to your plot, such as points, lines, or labels. This allows for intricate, information-rich visualizations.</li>
			</ul>
			<h2 id="_idParaDest-116"><a id="_idTextAnchor134"/>Generating various plot types</h2>
			<p>One of the <code>plotnine</code> library’s strengths is its versatility. You can create numerous plot types, catering to different data visualization<a id="_idIndexMarker445"/> needs.</p>
			<p>In this section, we’ll illustrate the construction of various plot types using <code>plotnine</code>:</p>
			<ul>
				<li><strong class="bold">Scatter plots</strong>: Simple yet effective, scatter <a id="_idIndexMarker446"/>plots help visualize relationships between two numerical variables:<pre class="source-code">
from plotnine import ggplot, aes, geom_point, geom_bar, geom_histogram, geom_boxplot, geom_tile, geom_violin, theme_minimal, labs
import pandas
# Sample data
data = pandas.DataFrame({'x': [1, 2, 3, 4, 5],
                         'y': [2, 4, 1, 3, 5]})
# Create a scatter plot
gg = ggplot(aes(x='x', y='y'), data) + geom_point()
print(gg)</pre><p class="list-inset">Here is the plot the preceding <a id="_idIndexMarker447"/>code generates:</p></li>			</ul>
			<div><div><img src="img/B19142_06_8.jpg" alt="Figure 6.8 – A basic scatter plot"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.8 – A basic scatter plot</p>
			<ul>
				<li><strong class="bold">Bar charts</strong>: Ideal for displaying<a id="_idIndexMarker448"/> categorical data, bar charts are <a id="_idIndexMarker449"/>excellent for comparisons:<pre class="source-code">
# Sample data
data = pandas.DataFrame({'category': ['A', 'B', 'C', 'D'],
                         'value': [10, 25, 15, 30]})
# Create a bar chart
gg = ggplot(aes(x='category', y='value'), 
    data) + geom_bar(stat='identity')
print(gg)</pre><p class="list-inset">Here is the plot for it:</p></li>			</ul>
			<div><div><img src="img/B19142_06_9.jpg" alt="" role="presentation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.9 – A basic bar chart</p>
			<ul>
				<li><strong class="bold">Histograms</strong>: These are used to<a id="_idIndexMarker450"/> explore the<a id="_idIndexMarker451"/> distribution of a single variable:<pre class="source-code">
# Sample data
data = pandas.DataFrame({'values': [1, 2, 2, 3, 3, 3, 4, 4, 5]})
# Create a histogram
gg = ggplot(aes(x='values'), data) + geom_histogram(binwidth=1,
    fill='blue', color='black', alpha = 0.5)
print(gg)</pre><p class="list-inset">Here is the plot for it:</p></li>			</ul>
			<div><div><img src="img/B19142_06_10.jpg" alt="" role="presentation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">  Figure 6.10 – A basic histogram</p>
			<p class="list-inset">Note how we can use a syntax<a id="_idIndexMarker452"/> completely analogue to the R <code>ggplot2</code> syntax up to and including the alpha parameter to control the transparency. It goes to show that R and Python are essentially similar tools with similar syntax in<a id="_idIndexMarker453"/> some packages!</p>
			<ul>
				<li><strong class="bold">Box plots</strong>: Box plots provide a summary of the distribution of a dataset, including the median, quartiles, and <a id="_idIndexMarker454"/>potential outliers:<pre class="source-code">
# Sample data
data = pandas.DataFrame({'category': ['A', 'A', 'B', 'B', 'C', 'C'],
                         'value': [10, 15, 20, 25, 30, 35]})
# Create a box plot
gg = ggplot(aes(x='category', y='value'), data) + geom_boxplot()
print(gg)</pre><p class="list-inset">Here is the plot <a id="_idIndexMarker455"/>for it:</p></li>			</ul>
			<div><div><img src="img/B19142_06_11.jpg" alt="" role="presentation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.11 – A basic box plot</p>
			<ul>
				<li><code>geom_tile()</code> to achieve this:<pre class="source-code">
data = {
        'x': ['A', 'A', 'A', 'A', 'B', 'B', 'B', 'B', 'C', 'C', 'C', 'C', 'D', 'D', 'D', 'D'],
        'y': ['W', 'X', 'Y', 'Z', 'W', 'X', 'Y', 'Z', 'W', 'X', 'Y', 'Z', 'W', 'X', 'Y', 'Z'],
        'value': [10, 15, 5, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80]
}
# Convert data to a DataFrame
data = pandas.DataFrame(data)
# Create a heatmap
gg = (ggplot(data, aes(x='x', y='y', fill='value'))
            + geom_tile()
            + theme_minimal()
            + labs(title='Heatmap Example', x='X-Axis', y='Y-Axis', fill='Values'))
print(gg)</pre><p class="list-inset">Here is <a id="_idIndexMarker458"/>the plot<a id="_idIndexMarker459"/> for it:</p></li>			</ul>
			<div><div><img src="img/B19142_06_12.jpg" alt="Figure 6.12 – A basic heatmap"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.12 – A basic heatmap</p>
			<ul>
				<li><strong class="bold">Violin plots</strong>: Combining box plots <a id="_idIndexMarker460"/>and kernel density estimation, violin plots showcase data distributions with rich detail:<pre class="source-code">
# Sample data
data = {
        'Category': ['A', 'A', 'B', 'B', 'B', 'C', 'C', 'D', 'D', 'D'],
        'Value': [10, 15, 25, 30, 35, 45, 50, 65, 70, 75]
}
# Convert data to a DataFrame
df = pandas.DataFrame(data)
# Create a violin plot
gg = (ggplot(df, aes(x='Category', y='Value', fill='Category'))
            + geom_violin()
            + theme_minimal()
            + labs(title='Violin Plot Example', x='Category', y='Value', fill='Category'))
print(gg)</pre><p class="list-inset">Here is the plot for it:</p></li>			</ul>
			<div><div><img src="img/B19142_06_13.jpg" alt="" role="presentation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.13 – A basic violin plot</p>
			<p>Now that the basics are <a id="_idIndexMarker461"/>covered, let’s have a look at what makes <code>plotnine</code> so special – all the customization <a id="_idIndexMarker462"/>possibilities!</p>
			<h2 id="_idParaDest-117"><a id="_idTextAnchor135"/>Customizing the visual elements of a plotnine plot</h2>
			<p>The <code>plotnine</code> library’s strength <a id="_idIndexMarker463"/>extends to customization. You can tailor every aspect of your visualizations to meet specific requirements. Here’s a detailed explanation of how you can customize various aspects of your visualizations:</p>
			<ul>
				<li><code>plotnine</code>, you can <a id="_idIndexMarker464"/>customize labels for the <em class="italic">x</em> and <em class="italic">y</em>-axes using the <code>xlab()</code> and <code>ylab()</code> functions, respectively. To add a title and subtitle to your plot, use the <code>ggtitle()</code> and <code>labs()</code> functions:<pre class="source-code">
# Customize labels and titles
gg = gg + xlab("Custom X Label") + ylab("Custom Y Label")
gg = gg + ggtitle("Custom Plot Title") + labs(subtitle="Custom Subtitle")</pre></li>				<li><code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> to customize scales and legends:<pre class="source-code">
# Customize axes and legends
gg = gg + scale_x_continuous(breaks=[1, 2, 3, 4, 5],
    labels=["One", "Two", "Three", "Four", "Five"])
gg = gg + scale_y_continuous(limits=(0, 10))
gg = gg + scale_color_manual(values={'A': 'red', 'B': 'blue'})</pre></li>				<li><code>theme_minimal()</code> or <code>theme_light()</code> to maintain a clean look throughout your reports or <a id="_idIndexMarker467"/>presentations.<pre class="source-code">
# Apply themes
# gg = gg + theme_minimal()
gg = gg + theme_light()</pre></li>				<li><code>theme()</code> function. Adjust parameters such as <code>text</code>, <code>text_size</code>, <code>text_family</code>, and <code>text_align</code> to achieve the desired text formatting:<pre class="source-code">
# Control text formatting
gg = gg + theme(text=element_text(size=12, family="Arial",
    face="bold", color="black"),
    axis_text_x=element_text(angle=45, hjust=1)</pre><p class="list-inset">The preceding customizations result in the following graph:</p></li>			</ul>
			<div><div><img src="img/B19142_06_14.jpg" alt="" role="presentation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.14 – Custom visual elements</p>
			<p>By customizing these elements, you <a id="_idIndexMarker469"/>can create visually appealing and highly tailored visualizations to effectively communicate your data insights.</p>
			<p>Beyond customization, <code>plotnine</code> has<a id="_idIndexMarker470"/> another trick up its sleeves – layers! In the next section, we will have a look at what layers are and how to use them to deliver the best visualization possible.</p>
			<h2 id="_idParaDest-118"><a id="_idTextAnchor136"/>Incorporating additional layers</h2>
			<p>Layering is a powerful <a id="_idIndexMarker471"/>concept in <code>plotnine</code>. It allows you to superimpose multiple layers on a single plot, each conveying different aspects of your data. In this section, we’ll explore some common layers:</p>
			<ul>
				<li><strong class="bold">Trendlines</strong>: Add trendlines to reveal <a id="_idIndexMarker472"/>underlying patterns in your data</li>
				<li><strong class="bold">Error bars</strong>: Visualize variability <a id="_idIndexMarker473"/>and uncertainty by incorporating error bars</li>
				<li><strong class="bold">Annotations</strong>: Highlight specific data points <a id="_idIndexMarker474"/>or regions with text labels or geometric shapes</li>
			</ul>
			<p>To add error bars, you can <a id="_idIndexMarker475"/>use the following code:</p>
			<pre class="source-code">
from plotnine import (
    ggplot, aes, geom_line, geom_point, geom_errorbar, 
    position_dodge, geom_text, labs, geom_smooth
    )
import pandas
import numpy
# Sample data
data = pandas.DataFrame({
        'x': [1, 2, 3, 4, 5],
        'y': [10, 15, 8, 12, 18],
        'group': ['A', 'A', 'B', 'B', 'C'],
        'error': [1, 2, 1.5, 1, 2.5],
        'label_x': [2, 4, 3, 1, 5],
        'label_y': [16, 11, 6, 13, 17],
        'annotation_text': ['Peak', 'Valley', 'Low', 'High', 'Bottom']
})
# Create a ggplot object
gg = ggplot(data, aes(x='x', y='y', group='group')) + \
        geom_line() + \
        geom_point() + \
        geom_errorbar(aes(ymin='y - error', ymax='y + error'), 
        width=0.1, size=0.5, 
        position=position_dodge(width=0.2)) + \
        geom_text(aes(x='label_x', y='label_y', 
        label='annotation_text'), size=10)
# Draw the plot
print(gg)</pre>			<p>This results in the <a id="_idIndexMarker476"/>following plot:</p>
			<div><div><img src="img/B19142_06_15.jpg" alt="Figure 6.15 – Error bars added"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.15 – Error bars added</p>
			<p>For trendlines, you can use the following:</p>
			<pre class="source-code">
# Sample data
data = pandas.DataFrame({
        'X': numpy.arange(1, 21),
        'Y': numpy.random.randint(1, 101, size=20)
})
# Create a base plot
gg = (ggplot(data, aes(x='X', y='Y')) +
            geom_point() +
            labs(title='Scatter Plot with Trendline')
         )
# Add a trendline
gg = gg + geom_smooth(method='lm', se=False, linetype='dashed',
    color='red', size=1)
print(gg)</pre>			<p>This results in a trendline<a id="_idIndexMarker477"/> added to the plot:</p>
			<div><div><img src="img/B19142_06_16.jpg" alt="" role="presentation"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.16 – A scatter plot with a trendline</p>
			<p>Finally, for annotations, we<a id="_idIndexMarker478"/> have the following:</p>
			<pre class="source-code">
# Sample data
data = pandas.DataFrame({
        'X': numpy.arange(1, 11),
        'Y': numpy.random.randint(1, 101, size=10)
})
# Create a base plot
gg = (ggplot(data, aes(x='X', y='Y')) +
            geom_point() +
            labs(title='Scatter Plot with Annotations')
         )
# Add an annotation and adjust the position of the labels along the y-axis using nudge_y by 5 units
gg = gg + geom_text(aes(label='Y'), nudge_y=5, color='blue')
print(gg)</pre>			<p>This results in the following plot:</p>
			<div><div><img src="img/B19142_06_17.jpg" alt="Figure 6.17 – An annotated scatter plot"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.17 – An annotated scatter plot</p>
			<p>Whether you’re communicating insights, comparing datasets, or exploring trends, <code>plotnine</code> will empower you to create engaging and data-driven narratives for your Excel reports.</p>
			<p>Next, let’s have a look at similar<a id="_idIndexMarker479"/> plots using <code>matplotlib</code>!</p>
			<h2 id="_idParaDest-119"><a id="_idTextAnchor137"/>Generating graphs with matplotlib</h2>
			<p>In this section, we will dive into<a id="_idIndexMarker480"/> the versatile world of <code>matplotlib</code>, one of the most widely used data visualization libraries in Python. With <code>matplotlib</code>, you have the power to create an array of static visualizations, fine-tune their appearance, and tailor them to your specific needs. Whether you’re looking to craft scatter plots, bar charts, histograms, or other graphical representations of your data, <code>matplotlib</code> provides the tools to turn your data into compelling visual insights.</p>
			<h3>Creating diverse plot types with matplotlib</h3>
			<p><code>matplotlib</code> is celebrated for its versatility, offering a wide array of plot types to meet diverse data visualization requirements. In this section, we’ll delve into the construction of various plot types using <code>matplotlib</code>, allowing you to craft scatter plots, bar charts, histograms, box plots, heatmaps, and violin<a id="_idIndexMarker481"/> plots. Whether you’re seeking to explore relationships between variables, display categorical data, or analyze data distributions, <code>matplotlib</code> equips you with the tools to create the visualizations you need:</p>
			<ul>
				<li><strong class="bold">Scatter plots</strong>: Here is the code<a id="_idIndexMarker482"/> for them:<pre class="source-code">
import numpy
import pandas
import matplotlib.pyplot as plt
### scatter plot
data = {
        'Height': [155, 162, 168, 173, 179],
        'Weight': [50, 56, 61, 65, 72]
}
df = pandas.DataFrame(data)
# Create a scatter plot
df.plot.scatter(x='Height', y='Weight', 
    title='Scatter Plot of Height vs. Weight')
# Save the plot to a file (e.g., .png) in your working directory
plt.savefig('matplotlib_scatter_plot.png')
# Show the plot
plt.show()()</pre><p class="list-inset">This code will create a scatter plot of height versus weight and save it as a <code>.png</code> image. You can further customize<a id="_idIndexMarker483"/> the plot as needed. The result is shown as follows:</p></li>			</ul>
			<div><div><img src="img/B19142_06_18.jpg" alt="Figure 6.18 – A basic scatter plot with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.18 – A basic scatter plot with matplotlib</p>
			<ul>
				<li><strong class="bold">Bar charts</strong>: Here is the code<a id="_idIndexMarker484"/> for them:<pre class="source-code">
data = {'Category': ['A', 'B', 'C', 'D', 'E'],
                'Values': [15, 28, 24, 20, 32]}
df = pandas.DataFrame(data)
# Create a basic bar chart
plt.figure(figsize=(8, 6))
plt.bar(df['Category'], df['Values'], color='skyblue')
plt.xlabel('Categories')
plt.ylabel('Values')
plt.title('Basic Bar Chart')
# Save the plot to a file (e.g., .png)
plt.savefig('matplotlib_bar_chart.png')
plt.show()</pre><p class="list-inset">This code creates a simple bar chart with categories on the <em class="italic">x</em>-axis and corresponding <a id="_idIndexMarker485"/>values on the <em class="italic">y</em>-axis, resulting in<a id="_idIndexMarker486"/> the following:</p></li>			</ul>
			<div><div><img src="img/B19142_06_19.jpg" alt="Figure 6.19 – A basic bar chart with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.19 – A basic bar chart with matplotlib</p>
			<ul>
				<li><strong class="bold">Histograms</strong>: Here is the<a id="_idIndexMarker487"/> code for them:<pre class="source-code">
# Generate some random data for the histogram
data = numpy.random.normal(0, 1, 1000)
# Create a basic histogram
plt.figure(figsize=(8, 6))
plt.hist(data, bins=20, color='lightblue', edgecolor='black')
plt.xlabel('Values')
plt.ylabel('Frequency')
plt.title('Basic Histogram')
# Save the plot to a file (e.g., .png)
plt.savefig('matplotlib_histogram.png')
plt.show()</pre><p class="list-inset">This code generates a histogram from random data, showcasing the frequency distribution of values. You<a id="_idIndexMarker488"/> can adjust the number<a id="_idIndexMarker489"/> of bins, colors, labels, and other properties to customize the histogram as needed. The histogram generated is shown as follows:</p></li>			</ul>
			<div><div><img src="img/B19142_06_20.jpg" alt="Figure 6.20 – A basic histogram with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.20 – A basic histogram with matplotlib</p>
			<ul>
				<li><strong class="bold">Box plots</strong>: Here is<a id="_idIndexMarker490"/> the code<a id="_idIndexMarker491"/> for them:<pre class="source-code">
# Generate some random data for the box plot
data = [numpy.random.normal(0, 1, 100) for _ in range(3)]  # Three sets of random data
# Create a basic box plot
plt.figure(figsize=(8, 6))
plt.boxplot(data, vert=False, 
    labels=['Set 1', 'Set 2', 'Set 3'])
plt.xlabel('Values')
plt.ylabel('Data Sets')
plt.title('Basic Box Plot')
# Save the plot to a file (e.g., .png)
plt.savefig('matplotlib_boxplot.png')
plt.show()</pre><p class="list-inset">This code generates a basic box plot from random data, comparing three different datasets. You can <a id="_idIndexMarker492"/>adjust various parameters to customize the appearance of the box plot as needed. The preceding code results<a id="_idIndexMarker493"/> in this visualization:</p></li>			</ul>
			<div><div><img src="img/B19142_06_21.jpg" alt="Figure 6.21 – A basic box plot with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.21 – A basic box plot with matplotlib</p>
			<ul>
				<li><strong class="bold">Heatmaps</strong>: Here is the code<a id="_idIndexMarker494"/> for them:<pre class="source-code">
# Generate some random data for the heatmap
numpy.random.seed(42)
data = numpy.random.rand(5, 5)  # Create a 5x5 matrix of random values
# Create a heatmap
plt.figure(figsize=(8, 6))
heatmap = plt.imshow(data, cmap='viridis', 
    interpolation='nearest')
plt.colorbar(heatmap)
plt.title('Heatmap Example')
# Save the plot to a file (e.g., .png)
plt.savefig('matplotlib_heatmap.png')
plt.show()</pre><p class="list-inset">In this code, we generate a <a id="_idIndexMarker495"/>random 5x5 matrix of values and create a heatmap from it. We will use the <code>viridis</code> colormap, but you can choose from various colormaps to adjust the color scheme. This example<a id="_idIndexMarker496"/> demonstrates how to create a basic heatmap; you can further customize it according to your data and preferences. The resulting heatmap is shown as follows:</p></li>			</ul>
			<div><div><img src="img/B19142_06_22.jpg" alt="Figure 6.22 – A basic heatmap with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.22 – A basic heatmap with matplotlib</p>
			<ul>
				<li><strong class="bold">Violin plots</strong>: Here is the <a id="_idIndexMarker497"/>code for<a id="_idIndexMarker498"/> them:<pre class="source-code">
# Generate some random data for the violin plot
numpy.random.seed(42)
data = [numpy.random.normal(0, std, 100) for std in range(1, 4)]
# Create a violin plot
plt.figure(figsize=(8, 6))
plt.violinplot(data, showmedians=True)
plt.title('Violin Plot Example')
plt.xticks([1, 2, 3], ['Group 1', 'Group 2', 'Group 3'])
plt.xlabel('Groups')
plt.ylabel('Values')
# Save the plot to a file (e.g., .png)
plt.savefig('matplotlib_violinplot.png')
plt.show()</pre><p class="list-inset">In this code, we generate<a id="_idIndexMarker499"/> three sets of random data and create a violin plot to visualize their distributions. The <code>showmedians=True</code> argument <a id="_idIndexMarker500"/>displays the median values inside each violin. You can adjust the data, labels, and other plot properties to fit your specific dataset and requirements. Let’s have a look at the plot generated:</p></li>			</ul>
			<div><div><img src="img/B19142_06_23.jpg" alt="Figure 6.23 – A basic violin plot with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.23 – A basic violin plot with matplotlib</p>
			<p>Next, let’s see how to<a id="_idIndexMarker501"/> customize the visual elements in a plot of <a id="_idIndexMarker502"/>matplotlib.</p>
			<h2 id="_idParaDest-120"><a id="_idTextAnchor138"/>Customizing visual elements of a matplotlib plot</h2>
			<p>The plots created by <code>matplotlib</code> can, of course, be customized in many ways, just like the plots<a id="_idIndexMarker503"/> generated with <code>plotly</code>. In this section, we will explore the most important aspects and provide some examples along the way.</p>
			<h3>Labels and titles</h3>
			<p><code>matplotlib</code> allows you to customize<a id="_idIndexMarker504"/> axis labels, plot titles, and subtitles easily. You can set labels for the <em class="italic">x</em>- and <em class="italic">y</em>-axes, title your plot for context, and even add subtitles to provide additional information or context. Here’s <a id="_idIndexMarker505"/>an example of how to customize labels and titles in <code>matplotlib</code>:</p>
			<pre class="source-code">
# Sample data
x = [1, 2, 3, 4, 5]
y = [10, 20, 25, 30, 35]
# Create a scatter plot
plt.scatter(x, y)
# Customize labels and titles
plt.xlabel('X-axis Label')
plt.ylabel('Y-axis Label')
plt.title('Custom Title')
plt.suptitle('Subtitle for Additional Context')
# Display the plot
plt.show()</pre>			<p>Here is the graph for it:</p>
			<div><div><img src="img/B19142_06_24.jpg" alt="Figure 6.24 – Customizing labels with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.24 – Customizing labels with matplotlib</p>
			<h3>Axes and legends</h3>
			<p><code>matplotlib</code> allows you to adjust axis <a id="_idIndexMarker506"/>scales, add axis breaks, and fine-tune legends. You can change the range, scale, and tick positions on both the <em class="italic">x</em>- and <em class="italic">y</em>-axes. Additionally, you can customize legends to better represent data series or categories. </p>
			<p>Here’s an example of customizing axes and legends:</p>
			<pre class="source-code">
import matplotlib.pyplot as plt
# Sample data
x = [1, 2, 3, 4, 5]
y = [10, 20, 25, 30, 35]
# Create a line plot
plt.plot(x, y, label='Data Series A')
# Customize axes and legend
plt.xlim(0, 6)
plt.ylim(0, 40)
plt.xticks([1, 2, 3, 4, 5])
plt.yticks([0, 10, 20, 30, 40])
plt.legend()
# Display the plot
plt.show()</pre>			<p>Here is the plot<a id="_idIndexMarker507"/> for it:</p>
			<div><div><img src="img/B19142_06_25.jpg" alt="Figure 6.25 – Customizing axes and the legend with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.25 – Customizing axes and the legend with matplotlib</p>
			<h3>Themes</h3>
			<p><code>matplotlib</code> offers a variety of themes to <a id="_idIndexMarker508"/>maintain consistency in your visualizations. You can choose from different predefined styles to match your report or presentation’s aesthetics. Here’s how you can apply a different theme. As an example, we will apply the <code>ggplot</code> theme you became familiar with earlier in the chapter:</p>
			<pre class="source-code">
import matplotlib.pyplot as plt
# Apply a different theme
plt.style.use('ggplot')
# Sample data and plot
x = [1, 2, 3, 4, 5]
y = [10, 20, 25, 30, 35]
plt.plot(x, y)
# Display the plot
plt.show()</pre>			<p>Here is the<a id="_idIndexMarker509"/> plot:</p>
			<div><div><img src="img/B19142_06_26.jpg" alt="Figure 6.26 – Using themes with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.26 – Using themes with matplotlib</p>
			<h3>Text formatting</h3>
			<p><code>matplotlib</code> allows you to control text size, style, and alignment for a polished look. You can adjust the font size, use bold or<a id="_idIndexMarker510"/> italic styles, and specify alignment for text elements such as titles, labels, and annotations. Here’s an example of text formatting:</p>
			<pre class="source-code">
import matplotlib.pyplot as plt
# Sample data and plot
x = [1, 2, 3, 4, 5]
y = [10, 20, 25, 30, 35]
plt.plot(x, y)
# Customize text formatting
plt.title('Custom Title', fontsize=16, fontweight='bold', 
    color='blue')
plt.xlabel('X-axis Label', fontsize=12, fontstyle='italic', 
    color='green')
plt.ylabel('Y-axis Label', fontsize=12, fontweight='bold', 
    color='red')
# Display the plot
plt.show()</pre>			<p>Here is the plot for it:</p>
			<div><div><img src="img/B19142_06_27.jpg" alt="Figure 6.27 – Text formatting with matplotlib"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 6.27 – Text formatting with matplotlib</p>
			<p>These examples showcase<a id="_idIndexMarker511"/> how you can achieve various customization aspects in your <code>matplotlib</code> visualizations.</p>
			<p>This concludes our overview of the most popular and powerful visualization libraries in Python. The next section covers short descriptions of the other choices available.</p>
			<h1 id="_idParaDest-121"><a id="_idTextAnchor139"/>Other visualization libraries</h1>
			<p>For completeness’s sake, here is a<a id="_idIndexMarker512"/> brief description of other popular libraries as well.</p>
			<h2 id="_idParaDest-122"><a id="_idTextAnchor140"/>plotly</h2>
			<p><code>plotly</code> is a popular Python library known <a id="_idIndexMarker513"/>for creating interactive and visually appealing data visualizations. It excels in generating dynamic charts, dashboards, and interactive plots. Unfortunately, the full power of the <code>plotly</code> library’s interactivity does<a id="_idIndexMarker514"/> not work seamlessly with the most recent versions of Excel, due to security considerations introduced by Microsoft. This limitation can hinder its integration into Excel for users who rely on the latest Excel features and functionalities. Since the focus of this book is enhancing your Excel-based workflows, we will not cover <code>plotly</code> in detail.</p>
			<h2 id="_idParaDest-123"><a id="_idTextAnchor141"/>seaborn</h2>
			<p><code>seaborn</code> is another Python library designed for statistical data visualization. While it offers a wide range of customization options<a id="_idIndexMarker515"/> and the ability to create complex plots, it often requires more code to achieve the same results compared to libraries such as <code>matplotlib</code> and <code>plotnine</code>. Given the focus on simplicity and ease of use in the<a id="_idIndexMarker516"/> chapter, we chose to emphasize libraries that provide a more straightforward and concise approach to data visualization.</p>
			<p>In this section, we primarily focused on <code>matplotlib</code> and <code>plotnine</code> due to their simplicity and compatibility with Excel, ensuring you can quickly generate and integrate visualizations into Excel reports without unnecessary complexity.</p>
			<p>Now that we have covered the most popular libraries you can use to create visualizations, we can continue with the distribution of the plots: embedding them into Excel!</p>
			<h1 id="_idParaDest-124"><a id="_idTextAnchor142"/>Embedding visualizations into Excel</h1>
			<p>When working with Python libraries such as <code>matplotlib</code> and <code>plotnine</code> to create visualizations, you might want to <a id="_idIndexMarker517"/>seamlessly integrate these visualizations into your Excel reports or spreadsheets. Embedding these plots and charts into Excel can be a valuable addition to your data analysis toolkit. In this section, we’ll explore the fundamentals of embedding <code>matplotlib</code> and <code>plotnine</code> visualizations into Excel, helping you leverage the power of Python’s data visualization libraries alongside Excel’s reporting capabilities.</p>
			<h2 id="_idParaDest-125"><a id="_idTextAnchor143"/>A basic embedding process</h2>
			<p>The process of embedding <code>matplotlib</code> and <code>plotnine</code> visualizations into Excel typically involves exporting your plots or charts as image files (such as PNG or JPEG) and then importing these images into your <a id="_idIndexMarker518"/>Excel sheet. While this approach doesn’t offer the same level of interactivity as some other methods, it’s a straightforward way to enhance your Excel reports with data visualizations generated in Python.</p>
			<p>Here are the basic steps:</p>
			<ol>
				<li><code>matplotlib</code> or <code>plcotnine</code> visualization in your Python script or Jupyter notebook. Customize it to meet your data analysis and reporting requirements.</li>
				<li><code>matplotlib</code> or <code>plotnine</code> to save your visualization as an image file. Common image formats such as PNG or JPEG work well for this purpose. Ensure that you save the image in a location accessible from your Excel sheet.</li>
				<li><code>pywin32</code>:<pre class="source-code">
import win32com.client as win32
# Initialize Excel
excel = win32.gencache.EnsureDispatch('Excel.Application')
excel.Visible = True
# Create a new workbook
workbook = excel.Workbooks.Add()
# Define the (absolute) image path
image_path = 'path\\to\\your\\image.png'
# Insert the image into a specific sheet and cell
sheet = workbook.ActiveSheet
cell = sheet.Range("A1")  # You can specify the cell where you want to insert the image
# Add the image to the worksheet (note that Width and Height might need to be adjusted)
sheet.Shapes.AddPicture(image_path, LinkToFile=False,
    SaveWithDocument=True, Left=cell.Left, 
    Top=cell.Top, Width=300, Height=200)
# Save the workbook
workbook.SaveAs('your_excel_with_image.xlsx')
# Close Excel
excel.Application.Quit()</pre></li></ul></li>				<li><strong class="bold">Scheduling a script for updates (optional)</strong>: If your data changes regularly, you may want to consider <a id="_idIndexMarker520"/>scheduling script-generating the image in Excel and inserting it, using the method from the preceding <em class="italic">option 2</em>. This way, your visualization regularly updates automatically. You can do this with what you learned in <a href="B19142_04.xhtml#_idTextAnchor078"><em class="italic">Chapter 4</em></a>.</li>
			</ol>
			<p>While this method provides a static representation of your visualizations, it’s a practical way to enhance your Excel reports with Python-generated charts and plots.</p>
			<h1 id="_idParaDest-126"><a id="_idTextAnchor144"/>Summary</h1>
			<p>Embedding visualizations in Excel reports offers a practical way to enhance data presentation, customization, and automation. Whether you’re working with sales data, financial reports, or any other dataset, this approach empowers you to create insightful reports that convey your data-driven insights effectively.</p>
			<p>In this chapter, you learned about data visualization techniques in general, the ways to extend your Excel workflows and reports with those techniques, and how to implement them in R and Python.</p>
			<p>We have covered the most popular and powerful R packages and Python libraries in detail. You learned about the typical plots used to carry out your analysis and how to communicate your findings, along with use cases and examples where those data visualizations can be used.</p>
			<p>The next time you prepare an Excel report, you will be in a position to dazzle your audience with the most beautiful and insightful visualizations they have ever seen!</p>
			<p>In the next chapter, we will look at another way to communicate your findings to audiences for whom the details of raw data are too much: automating pivot tables.</p>
		</div>
	</body></html>