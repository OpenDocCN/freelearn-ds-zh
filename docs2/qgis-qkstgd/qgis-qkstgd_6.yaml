- en: Spatial Processing
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 空间处理
- en: In this chapter, we'll be performing spatial analysis using QGIS. We'll use
    the data from the GeoPackage that we used in the previous data chapters. Firstly,
    we'll look at the Processing Toolbox and then move on to some individual tools
    and spatially query our data.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用QGIS进行空间分析。我们将使用之前数据章节中使用的GeoPackage中的数据。首先，我们将查看处理工具箱，然后继续介绍一些单个工具，并对我们的数据进行空间查询。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: The Processing Toolbox
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 处理工具箱
- en: Spatial queries
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 空间查询
- en: Analyzing data
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据分析
- en: Raster-based analysis
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于栅格的分析
- en: The Processing Toolbox
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 处理工具箱
- en: 'From the Processing menu, select Toolbox. The Processing Toolbox is shown as
    follows:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 从处理菜单中选择工具箱。处理工具箱如下所示：
- en: '![](img/da1188e1-58a0-4907-87ac-a15821410a0f.png)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![](img/da1188e1-58a0-4907-87ac-a15821410a0f.png)'
- en: Processing Toolbox
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 处理工具箱
- en: At the top of the Processing Toolbox, there is a toolbar. In this toolbar, the
    first button is used to call the model builder and the second button opens the
    Python scripting tools, both of which we'll come to later. The next four buttons,
    in order, show History, Results Viewer, Edit Features In-Place (this button shows
    tools that *filters to display only algorithms that allow in-place modification
    of the geometries*), and processing settings. Under this toolbar is the search
    feature; using this feature, you can quickly find processing tools and run them.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理工具箱的顶部，有一个工具栏。在这个工具栏中，第一个按钮用于调用模型构建器，第二个按钮打开Python脚本工具，这两个工具我们将在后面介绍。接下来四个按钮按顺序显示历史记录、结果查看器、原地编辑要素（此按钮显示允许原地修改几何形状的算法的工具），以及处理设置。在此工具栏下方是搜索功能；使用此功能，您可以快速找到处理工具并运行它们。
- en: In this chapter, we'll use these tools to analyze and work with our data. We'll
    use some of the tools in the Processing Toolbox to answer some spatial or GIS-type
    questions.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用这些工具来分析和处理我们的数据。我们将使用处理工具箱中的某些工具来回答一些空间或GIS类型的问题。
- en: 'Create a new empty QGIS project. Load in the following layers from the GeoPackage:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的空QGIS项目。从GeoPackage中加载以下图层：
- en: '`regions`'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`regions`'
- en: '`pipelines`'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pipelines`'
- en: What regions intersect pipelines?
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 哪些区域与管道相交？
- en: 'We can answer this with a spatial query. In QGIS, this tool is called Select
    by Location; search for this term in the Processing Toolbox, then double-click
    on the tool to open the dialog box. We want to use this tool to select all of
    the features from the `regions` layer that intersect with `pipelines`. The input
    will look like this:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过空间查询来回答这个问题。在QGIS中，这个工具称为“按位置选择”；在处理工具箱中搜索这个术语，然后双击工具打开对话框。我们想使用这个工具来选择与`pipelines`相交的所有`regions`图层要素。输入将如下所示：
- en: '![](img/6b884b19-e69b-48f4-88a9-e1b73739c464.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6b884b19-e69b-48f4-88a9-e1b73739c464.png)'
- en: Select by Location tool
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 按位置选择工具
- en: 'The output in QGIS will look like this:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS中的输出将如下所示：
- en: '![](img/ceba0746-6e33-4d56-a034-b26d641175ae.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ceba0746-6e33-4d56-a034-b26d641175ae.png)'
- en: Selected regions highlighted
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 高亮显示的选定区域
- en: Open the attribute table by right-clicking on the layer and choosing Open Attribute
    Table. You will see the selected regions in the table. It is possible to expand
    on this query and create a field in the `regions` layer that notes whether the
    pipeline intersected the region or not. To do this, we can use the field calculator.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 通过右键单击图层并选择打开属性表来打开属性表。您将在表中看到选定的区域。可以扩展此查询并在`regions`图层中创建一个字段，以记录管道是否与区域相交。为此，我们可以使用字段计算器。
- en: 'Let''s add a field called `Pipeline` and assign the value one if the pipeline
    runs through the region and zero if it doesn''t. In the attribute table, click
    on the open field calculator button (the icon is an abacus). Fill in the Field
    Calculator as follows. Make sure the checkbox next to Only update 5 selected features
    is selected:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们添加一个名为`Pipeline`的字段，如果管道穿过该区域，则分配值为1，如果不穿过，则分配值为0。在属性表中，单击打开字段计算器按钮（图标是一个算盘）。按照以下方式填写字段计算器。确保选中旁边的“仅更新5个选定的要素”复选框：
- en: '![](img/eff21d99-6254-44a0-a9a4-38910634a119.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eff21d99-6254-44a0-a9a4-38910634a119.png)'
- en: The field calculator
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 字段计算器
- en: 'Click on OK and then open the attribute table; you will see a new field called
    `Pipeline`. This is shown as follows:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 点击确定，然后打开属性表；您将看到一个名为`Pipeline`的新字段。如下所示：
- en: '![](img/023b7c9f-ce9a-465f-a39c-fcf79fbd82cd.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/023b7c9f-ce9a-465f-a39c-fcf79fbd82cd.png)'
- en: Attribute table with selected feature(s)
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 带有选定要素的属性表
- en: 'We need to add the value zero now to all of the other fields. Invert the selection
    (the button looks like a yellow triangle underneath a grey triangle). Choose the
    `Pipeline` field from the drop-down menu and set the value equal to 0\. Click
    on Update Selected. The value to change is shown in the following screenshot:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要将所有其他字段的所有值都设置为0。反转选择（按钮看起来像灰色三角形下方的黄色三角形）。从下拉菜单中选择“管道”字段并将值设置为0。点击“更新所选”。要更改的值在上面的屏幕截图中显示：
- en: '![](img/650ebb75-ea3f-429e-9fba-56d070825d4c.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/650ebb75-ea3f-429e-9fba-56d070825d4c.png)'
- en: Update existing field in the field calculator
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在字段计算器中更新现有字段
- en: Click on OK. Now, the `Pipeline` field has either zero (not impacted) or one
    (impacted). Clear the selection and untoggle the editing. We could use the styling
    skills from [Chapter 4](e8289aa4-8eb7-4d2d-9662-4c17889a53e3.xhtml), *Styling
    Data*, to symbolize the region layer based on the newly created `Pipeline` field.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 点击“确定”。现在，“管道”字段要么为零（未受影响）或一个（受影响）。清除选择并取消编辑。我们可以使用[第4章](e8289aa4-8eb7-4d2d-9662-4c17889a53e3.xhtml)中“样式化数据”的样式技巧，根据新创建的“管道”字段来表示区域层。
- en: What buildings and settlements are within 15,000 feet of the pipeline?
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管道附近15,000英尺内的建筑和定居点有哪些？
- en: To answer this question, we need to perform a buffer on the pipeline and then
    select the points in the popp layer that fall inside this buffer. This is a common
    GIS query, and the method shown here should be applicable to any similar query
    you might have about your data. Load the popp layer into the map.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 要回答这个问题，我们需要对管道执行缓冲操作，然后选择位于此缓冲区内的popp图层中的点。这是一个常见的GIS查询，这里展示的方法应该适用于你可能对数据有任何类似查询的情况。将popp图层加载到地图中。
- en: 'Search in the Processing Toolbox for Buffer. Double-click to open the tool.
    Select the `pipelines` layer and set the buffer Distance to `15000` feet. Check
    the box next to Dissolve result; this will merge any adjacent or overlapping features
    into one feature. For the output, choose the GeoPackage that we supplied with
    this book containing this `alaska` layers. The Buffer dialog should look as follows:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理工具箱中搜索“缓冲”。双击打开工具。选择“pipelines”图层并将缓冲距离设置为“15000”英尺。勾选旁边的“溶解结果”复选框；这将合并任何相邻或重叠的要素成为一个要素。对于输出，选择我们与这本书一起提供的包含此“alaska”图层的GeoPackage。缓冲对话框应该如下所示：
- en: '![](img/0627bafa-9b8b-4dbe-9d89-758c12971f4d.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/0627bafa-9b8b-4dbe-9d89-758c12971f4d.png)'
- en: The Buffer tool
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 缓冲工具
- en: 'Click on Run. Click on Close when the tool has finished. On the map, we should
    now have a buffer of the pipelines. Use the Select by Location tool as before,
    but this time select the points in the popp layer that are within this newly created
    buffer. The dialog should look similar to the following screenshot:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 点击“运行”。当工具完成后，点击“关闭”。在地图上，我们现在应该有一个管道的缓冲区。使用之前的选择位置工具，但这次选择位于新创建的缓冲区内的popp图层中的点。对话框应该类似于下面的屏幕截图：
- en: '![](img/6b295ff1-4627-45c0-854f-a237f34953de.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/6b295ff1-4627-45c0-854f-a237f34953de.png)'
- en: Select by Location tool
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 选择位置工具
- en: 'After clicking Run, close the tool and inspect the map. This query results
    in 49 features being selected. To write these out to a new layer, right-click
    on the popp layer in the layer panel and select Export | Save Selected Features
    As. Save the selected features to a new layer in the GeoPackage called `Popp_in_pipeline_corridor`.
    This is shown in the following screenshot:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 点击运行后，关闭工具并检查地图。此查询导致选择了49个要素。要将这些要素写入新图层，在图层面板中右键单击弹出图层，选择“导出”|“将所选要素另存为”。将所选要素保存到名为“Popp_in_pipeline_corridor”的新GeoPackage图层中。这在上面的屏幕截图中显示：
- en: '![](img/6cd740d6-25f5-43cb-8fa0-c72efef001c0.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/6cd740d6-25f5-43cb-8fa0-c72efef001c0.png)'
- en: Saving the layer
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 保存图层
- en: 'Click on OK and, in the layer panel, turn off all of the layers apart from
    this one and the regions. Your map should look like the following:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 点击“确定”，在图层面板中关闭除这个图层和区域之外的所有图层。你的地图应该看起来像下面的截图：
- en: '![](img/a96b810c-5a9a-4e00-85f8-8456e5dce949.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/a96b810c-5a9a-4e00-85f8-8456e5dce949.png)'
- en: All of the popp points 15,000 feet from the pipeline
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 管道15,000英尺范围内的所有popp点
- en: Similar to the first question, this query is common in GIS. Instead of settlements
    and buildings in a pipeline corridor, you might be dealing with address points
    for customers within *x* distance of a new shop that you might wish to contact
    to let them know about a new offer.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 与第一个问题类似，这个查询在GIS中很常见。你可能会处理的是管道走廊内的地址点，而不是新商店周围的定居点和建筑，你可能会联系他们告知他们新的优惠。
- en: What is the distribution landcover types inside the buffered pipeline?
  id: totrans-49
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在缓冲管道内部，土地覆盖类型的分布是什么？
- en: This question is one where we combine both raster and vector data to provide
    an answer. We might want to know whether the pipeline is going through a protected
    area and how much of that area is impacted.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个我们需要结合栅格和矢量数据来提供答案的问题。我们可能想知道管道是否穿过保护区以及该区域有多少受到影响。
- en: 'Load the `landcover.img` dataset into the Layers panel. To answer this question,
    we''ll use a tool call Zonal Histogram. Search for it in the toolbox. Set Raster
    layer as the `landcover` layer, set Vector layer containing zones as the Buffered
    pipelines, and choose to prefix the zones with the word `Terrain_`. Save your
    changes to the GeoPackage. This is shown in the following screenshot:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 将`landcover.img`数据集加载到图层面板中。为了回答这个问题，我们将使用一个名为区域直方图的工具。在工具箱中搜索它。将栅格图层设置为`landcover`图层，将包含区域的矢量图层设置为缓冲管道，并选择使用单词`Terrain_`作为区域的前缀。将更改保存到GeoPackage中。这如图下截图所示：
- en: '![](img/b95555ea-f499-459c-a9f8-3e9bd2c45db6.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b95555ea-f499-459c-a9f8-3e9bd2c45db6.png)'
- en: Zonal histogram tool
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 区域直方图工具
- en: 'Click on Run in Background and close when finished. A new layer with one feature
    will have been added to the Layers panel. Right-click on this layer and open the
    attribute table. The table only has one feature because we dissolved the buffer
    when we created it. The resulting table looks like the following screenshot:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 点击“在后台运行”，完成后关闭。将在图层面板中添加一个具有一个要素的新图层。右键单击此图层并打开属性表。由于我们在创建时溶解了缓冲区，因此表中只有一个要素。生成的表看起来如下截图所示：
- en: '![](img/c32f9623-f121-4df5-b183-eed87d1d12f2.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c32f9623-f121-4df5-b183-eed87d1d12f2.png)'
- en: The attribute table generated by the zonal stats tool
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 区域统计工具生成的属性表
- en: We can see the field with `Terrain_x`, where `x` corresponds to the value in
    the `landcover` raster. The most impacted terrain of the pipeline was `Terrain_9`.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到带有`Terrain_x`字段的字段，其中`x`对应于`landcover`栅格中的值。管道受影响最严重的地形是`Terrain_9`。
- en: In [Chapter 7](bab7139e-9f38-4dff-b1eb-c5056be9c960.xhtml), *Expanding QGIS
    3*, we'll look at how we can combine the tools in questions 2 and 3 into a model
    to automate these processes. This would allow us to just run one tool.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第7章](bab7139e-9f38-4dff-b1eb-c5056be9c960.xhtml) *扩展QGIS 3* 中，我们将探讨如何将问题2和3中的工具组合成一个模型来自动化这些过程。这将使我们只需运行一个工具。
- en: Let's now move on to terrain modeling with raster data.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将转向使用栅格数据进行的地形建模。
- en: Raster analysis
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 栅格分析
- en: Create a new QGIS project and load into the map the `landcover.img` file. We'll
    use this layer to demonstrate a couple of the many raster processing tools in
    QGIS. On load, we have landcover classes with values ranging from 0 to 13\. The
    value zero appears to correspond to water. In this example, we're going to set
    all of the values that are equal to zero to nodata. In GIS we would set raster
    data to no data when we have data that we don't want to use or display.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的QGIS项目并将`landcover.img`文件加载到地图中。我们将使用这个图层来演示QGIS中许多栅格处理工具中的几个。加载后，我们有了从0到13的范围的覆盖层类别。值零似乎对应于水。在这个例子中，我们将所有等于零的值设置为无数据。在GIS中，当我们有不想使用或显示的数据时，我们会将栅格数据设置为无数据。
- en: 'To change the 0 values in the `Landcover` dataset to nodata, select Raster
    | Conversion | Translate (Convert Format) as shown in the following screenshot:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 要将`Landcover`数据集中的0值更改为无数据，请选择“栅格”|“转换”|“翻译”（转换格式），如图下截图所示：
- en: '![](img/b0ea5f6f-bfa4-4f39-b606-63d562fa6ba3.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b0ea5f6f-bfa4-4f39-b606-63d562fa6ba3.png)'
- en: Calling the Translate tool
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 调用翻译工具
- en: 'The Translate tool is very helpful to convert rasters into different data types
    and formats. It''s built on the GDAL translate tool; you can read about the options
    with `gdal_translate` here: [https://www.gdal.org/gdal_translate.html](https://www.gdal.org/gdal_translate.html).
    With the Translate tool open in QGIS, select the `landcover` layer as Input layer
    and set Assign a specific nodata value to the output bands to `0`. Save the output
    box labeled Converted as `Landcover_Null.tif`. This is shown in the following
    screenshot:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 翻译工具非常有帮助，可以将栅格数据转换为不同的数据类型和格式。它基于GDAL翻译工具构建；您可以通过`gdal_translate`了解选项，请参阅[https://www.gdal.org/gdal_translate.html](https://www.gdal.org/gdal_translate.html)。在QGIS中打开翻译工具后，选择`landcover`图层作为输入图层，并将输出波段分配特定无数据值设置为`0`。将输出框标记为`Converted
    as Landcover_Null.tif`保存。这如图下截图所示：
- en: '![](img/093b7ca0-ae96-4678-889e-b391d452daac.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](img/093b7ca0-ae96-4678-889e-b391d452daac.png)'
- en: Using the Translate tool to set a no data value
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 使用翻译工具设置无数据值
- en: 'The resulting raster will look like this:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 生成的栅格将看起来像这样：
- en: '![](img/f4e1a064-adf7-48d8-aeda-d4c2c8899413.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/f4e1a064-adf7-48d8-aeda-d4c2c8899413.png)'
- en: Landcover with the values 0 set to no data
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 将值为 `0` 设置为无数据的土地覆盖
- en: 'Using this newly created layer, we''ll reclassify this raster dataset based
    on a conditional statement in Raster Calculator. We''ll set every terrain will
    a value greater than or equal to five to zero and everything else to one. Open
    Raster Calculator and enter the following in the Raster Calculator Expression
    window: `"Converted@1" >= 5`, and save as `Landcover_Null_reclassified.tif` as
    shown in the following screenshot:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这个新创建的图层，我们将根据栅格计算器中的条件语句重新分类这个栅格数据集。我们将设置所有值大于或等于五的地面为零，其余部分为一。打开栅格计算器，并在栅格计算器表达式窗口中输入以下内容：`"Converted@1"
    >= 5`，并保存为 `Landcover_Null_reclassified.tif`，如图所示：
- en: '![](img/42e9a1b8-4644-4a06-9ddb-95c739e8d21d.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/42e9a1b8-4644-4a06-9ddb-95c739e8d21d.png)'
- en: Conditional statements in the Raster Calculator
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 栅格计算器中的条件语句
- en: 'The resulting binary raster will look like the following screenshot:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 结果的二值栅格将看起来像以下截图：
- en: '![](img/413e49ac-4d61-4c13-b403-2eef522214a7.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/413e49ac-4d61-4c13-b403-2eef522214a7.png)'
- en: Conditional raster generated from the Raster Calculator
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 从栅格计算器生成的条件栅格
- en: 'You might not have expected this result as the values `0` are in black and
    `1` are displayed in white. We could alter this; to do so, we need to change the
    rendering for the values of `1` to be shaded and everything else to be transparent
    (or white). Right-click on the `Landcover_Null_reclassed` layer and select Properties.
    Set Render type to Paletted/Unique values, click on Classify and adjust the values
    of `1` to red and `0` to transparent, as shown in the following screenshot:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能没有预料到这个结果，因为值为 `0` 的部分是黑色的，而 `1` 的部分显示为白色。我们可以改变这一点；要做到这一点，我们需要将 `1` 的渲染方式改为着色，其余部分为透明（或白色）。右键单击
    `Landcover_Null_reclassed` 图层并选择属性。将渲染类型设置为调色板/唯一值，点击分类并调整 `1` 的值为红色，`0` 的值为透明，如图所示：
- en: '![](img/b021c4b1-c258-4243-bf34-b7ac1add9ba1.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/b021c4b1-c258-4243-bf34-b7ac1add9ba1.png)'
- en: Changing the raster rendering
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 改变栅格的渲染方式
- en: In the next section, we'll look at converting this raster into a vector dataset.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将探讨将此栅格转换为矢量数据集的过程。
- en: Converting into vectors
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 转换为矢量
- en: 'Reclassifying rasters is useful for many visualization and processing workflows
    but also useful for converting data into vectors. From the Raster menu, select
    Conversion | Polygonize (Raster to Vector), which will open the Raster to Vector
    tool. Save the Vectorized layer as a new GeoPackage layer called `vectorised_terrains.gpkg`
    as shown in the following screenshot:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 重新分类栅格对于许多可视化和处理工作流程非常有用，同时也适用于将数据转换为矢量。从栅格菜单中选择转换 | 多边形化（栅格到矢量），这将打开栅格到矢量工具。将矢量化图层保存为名为
    `vectorised_terrains.gpkg` 的新 GeoPackage 图层，如图所示：
- en: '![](img/3dfd5b02-b534-413f-9404-4c4b6ca5fe00.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/3dfd5b02-b534-413f-9404-4c4b6ca5fe00.png)'
- en: Polygonize tool
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 多边形化工具
- en: 'This will take a little while to run as the raster is quite complex. Once finished,
    you''ll have a vector layer that will look similar to the following screenshot:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 由于栅格相当复杂，这个过程可能需要一些时间。完成后，你将拥有一个看起来类似于以下截图的矢量图层：
- en: '![](img/a4dc26dd-126d-49d8-8f3d-849e1b93596a.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/a4dc26dd-126d-49d8-8f3d-849e1b93596a.png)'
- en: The resulting vector layer created from the conditional raster
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 从条件栅格创建的结果矢量图层
- en: 'The newly created vector dataset will have features with a `DN` field equal
    to either `1` or `0`. In this case, we aren''t interested in any of the `DN` values
    equal to `0`. Open the attribute table of the layer and select the values in the
    `DN` field that are equal to `0` using the select features. Using an expression
    (click on the tenth button from the left in the attribute table). Click on Select
    features and then Close, as shown in the following screenshot:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 新创建的矢量数据集将具有 `DN` 字段等于 `1` 或 `0` 的特征。在这种情况下，我们对任何等于 `0` 的 `DN` 值不感兴趣。打开图层的属性表，并使用选择特征选择
    `DN` 字段中等于 `0` 的值。使用表达式（点击属性表从左数第十个按钮）。点击选择特征然后关闭，如图所示：
- en: '![](img/c717f440-229a-40e3-bfbf-88fc6c014d85.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/c717f440-229a-40e3-bfbf-88fc6c014d85.png)'
- en: Editing the vectorized layer
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑矢量化图层
- en: 'Click on the Toggle editing mode button in the attribute table (first button
    on the left) and then click on the red trashcan to delete the selected values.
    Click on the Toggle editing mode to turn off editing and save the edits. The final
    data should now look similar to the following:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在属性表中点击切换编辑模式按钮（左边的第一个按钮），然后点击红色垃圾桶删除选定的值。点击切换编辑模式关闭编辑并保存更改。现在最终数据应该看起来类似于以下截图：
- en: '![](img/6fde5516-75c9-40da-8be0-69765e5839df.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/6fde5516-75c9-40da-8be0-69765e5839df.png)'
- en: Final vectorized terrain layer
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 最终向量化地形层
- en: There are many raster analysis tools in the QGIS processing toolbox that we
    could use. For example, if you have access to a DEM, you could create slope maps
    and other types of terrain analysis; search for Raster Terrain Analysis in the
    Processing Toolbox.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS处理工具箱中有许多栅格分析工具我们可以使用。例如，如果您可以访问数字高程模型（DEM），您就可以创建坡度图和其他类型的地形分析；在处理工具箱中搜索“栅格地形分析”。
- en: Summary
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we've dipped our toes into the Processing Toolbox in QGIS.
    We asked questions about our data. We used simple GIS processes and tools in QGIS
    to derive answers from our data. The power of GIS lies in its data. We also looked
    at both vector- and raster-based queries.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们已经在QGIS的Processing工具箱中试水。我们针对我们的数据提出了问题。我们使用QGIS中的简单GIS流程和工具来从数据中得出答案。GIS的力量在于其数据。我们还探讨了基于向量和栅格的查询。
- en: In the next chapter, we'll look at extending this by using the model builder
    to chain common processing tools together, before looking at Plugins and the Python
    Console.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将通过使用模型构建器将常见的处理工具串联起来来扩展这一功能，然后再查看插件和Python控制台。
