# 前言

时间序列无处不在，时刻在增长。借助可以扩展的正确工具，您可以轻松释放其时间维度的洞察，赋予您在时间的赛道上的优势。

时间序列分析——从时间序列中提取洞见——对于企业和组织做出明智决策至关重要。这通过分析在时间间隔中收集的数据中的模式、趋势和异常来实现。Apache Spark 是一个强大的大数据处理框架，能够高效处理大规模时间序列数据，是处理此类数据的理想工具。

对于任何涉及 Apache Spark 的时间序列分析任务，有三个主要支柱：

+   数据准备与处理：包括收集、清洗和转换时间序列数据，使其适合进行分析。

+   建模与预测：包括应用统计模型或机器学习算法来揭示模式并预测未来趋势。

+   部署与维护：包括将模型集成到运营系统中，并持续监控和更新，以确保准确性和相关性。

本书《使用 Spark 进行时间序列分析》旨在涵盖所有这些支柱。它将提供处理、建模和预测时间序列数据的实际技术，帮助读者使用 Apache Spark 进行时间序列分析。本书基于两个主要信息来源：

+   实践经验：借鉴实际项目和经验，处理大规模时间序列数据时的 Apache Spark 运用。

+   行业洞察：融入时间序列分析和大数据处理领域专家和从业者的见解。

随着 Apache Spark 在时间序列分析中的应用不断增长，对掌握此领域技能的专业人才需求也在快速增加。本书将引导您了解使用 Apache Spark 有效进行时间序列分析所需的最佳实践和技巧，帮助您在这个快速发展的领域中保持领先。

# 本书适用对象

数据和 AI 专业人员，尤其是处理时间相关数据集的人员，将会发现《使用 Spark 进行时间序列分析》有助于提升他们在时间序列分析中运用 Apache Spark 和 Databricks 的技能。本书面向广泛的受众，从初学者到有经验的从业者，都可以从中学习如何利用 Spark 进行时序数据分析。

更具体地说，数据工程师将提升他们在使用 Spark 和 Databricks 进行大规模时间序列数据准备方面的能力。**机器学习**（**ML**）工程师将更容易扩展他们的机器学习项目范围。数据科学家和分析师将掌握新的时间序列分析技能，拓宽工具使用的范围。

# 本书涵盖的内容

*第一章*，*什么是时间序列？*，介绍了时间序列数据的概念及其分析中的独特挑战。这个基础对于有效分析和预测时间相关数据至关重要。

*第二章*，*为什么进行时间序列分析？*，详细阐述了分析时间相关数据在预测建模、趋势识别和异常检测中的重要性。通过各行业的实际应用来说明这一点。

*第三章*，*Apache Spark 简介*，深入探讨了 Apache Spark 及其在处理大规模时间序列数据时的分布式计算能力。

*第四章*，*时间序列分析项目的端到端视角*，引导我们了解时间序列分析项目的整个过程。从用例开始，涵盖了数据处理、特征工程、模型选择和评估等关键阶段。

*第五章*，*数据准备*，深入探讨了组织、清理和转换时间序列数据的关键步骤。内容包括处理缺失值、处理异常值和数据结构化等技术，从而提升后续分析过程的可靠性。

*第六章*，*探索性数据分析*，介绍了如何通过探索性数据分析揭示时间序列数据中的模式和洞察。此过程对于识别趋势和季节性等特征至关重要，为后续建模决策提供指导。

*第七章*，*构建与测试模型*，专注于为时间序列数据构建预测模型，涵盖了各种类型的模型、选择模型的方法以及如何训练、调优和评估模型。

*第八章*，*扩展分析*，讨论了在大规模和分布式计算环境中扩展时间序列分析时需要考虑的因素。内容涵盖了如何利用 Apache Spark 扩展特征工程、超参数调优以及单模型和多模型训练的不同方式。

*第九章*，*投入生产*，探讨了将时间序列模型部署到生产环境中的实际考虑因素和步骤，同时确保时间序列模型在操作环境中的可靠性和有效性。

*第十章*，*深入探索 Apache Spark*，提供了通过使用 Databricks 作为云端托管的 PaaS 平台，解决设置和管理 Apache Spark 平台的挑战。

*第十一章*，*时间序列分析的最新发展*，探讨了时间序列分析领域的最新发展，包括将生成性 AI 应用于时间序列预测的激动人心的研究方向，以及使时间序列分析结果对非技术人员易于理解的新方法。

# 为了最大限度地发挥本书的作用

本书要求你具备基本的 Python 编程语言知识，并且对数据科学和机器学习概念有基本了解。

+   *第一章、第二章、第五章、第六章* 和 *第七章* 使用 Databricks Community Edition。

+   *第三章、第四章* 和 *第九章* 使用本地容器化环境。本书中的示例在 macOS 上使用 Docker 进行测试。如果你在 Windows 或 Linux 上使用 Docker 或 Podman，适当调整后也应能够运行。如果你不打算在本地构建环境，而是更倾向于使用 Databricks 等托管平台，可以跳过这些章节的实践部分。

+   *第八章、第十章* 和 *第十一章* 使用 Databricks 平台。

获取安装和设置的附加说明及信息已在各个章节中记录。

| **本书中涉及的软件/硬件** | **操作系统要求** |
| --- | --- |
| Databricks Community Edition |  |
| 在 Amazon Web Services (AWS) 或 Microsoft Azure 上的 Databricks |  |
| Docker v4.48 或 Podman v1.16 | Windows、macOS 或 Linux |

示例代码所需的附加软件包会在代码执行时自动安装。由于软件包和用户界面可能会发生变化，请参考相应的软件包或产品文档，以了解更改信息。

**如果你使用的是本书的数字版本，我们建议你自己输入代码或从本书的 GitHub 仓库访问代码（链接在下一节提供）。这样可以帮助你避免与复制粘贴代码相关的潜在错误。**

如果有说明更新，它将尽可能地添加到 GitHub 仓库中各个章节的 README.md 文件中。

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件，链接为 [`github.com/PacktPublishing/Time-Series-Analysis-with-Spark`](https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark)。如果代码有更新，GitHub 仓库中的内容将会进行相应更新。

我们还在 https://github.com/PacktPublishing/ 提供了其他丰富书籍和视频的代码包。快去看看吧！

# 使用的约定

本书中使用了许多文本约定。

`文本中的代码`：表示文本中的代码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 账号。例如：“将下载的 `WebStorm-10*.dmg` 磁盘映像文件挂载为系统中的另一个磁盘。”

代码块设置如下：

```py
#### Summary Statistics
# Code in cell 10
df.summary().display()
```

当我们希望引起你对代码块中特定部分的注意时，相关的行或项目会以粗体显示：

```py
sns.boxplot(x='dayOfWeek', y='Global_active_power', data=pdf)
```

任何命令行输入或输出都按如下方式显示：

```py
Test SMAPE: 41.193985580947896
Test WAPE: 0.35355667972102317
```

**粗体**：表示一个新术语、一个重要的词，或者你在屏幕上看到的词。例如，菜单或对话框中的词会以**粗体**显示。以下是一个示例：“报告的其他部分涉及**警报**，如*图 6.8*所示，包括在数据集上运行的测试结果，包括特定于时间序列的测试，以及一个**重现**部分，详细描述了分析运行的情况。”

提示或重要说明

显示效果如下。

# 与我们联系

我们始终欢迎读者的反馈。

**一般反馈**：如果你对本书的任何内容有疑问，请通过电子邮件 customercare@packtpub.com 联系我们，并在邮件主题中注明书名。

**勘误表**：尽管我们已经尽力确保内容的准确性，但错误难免。如果你在本书中发现任何错误，恳请报告给我们。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

**盗版**：如果你在互联网上发现任何非法复制的作品，恳请提供相关的网址或网站名称。请通过 copyright@packtpub.com 与我们联系，并附上链接。

**如果你有兴趣成为作者**：如果你在某个领域拥有专业知识，并有意撰写或贡献书籍，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享你的想法

一旦你阅读了*《使用 Spark 进行时间序列分析》*，我们很希望听到你的想法！请[点击这里直接访问亚马逊评价页面](https://packt.link/r/1803232250)并分享你的反馈。

你的评价对我们和技术社区都非常重要，它将帮助我们确保提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢购买本书！

你喜欢随时随地阅读，但又无法随身携带纸质书籍吗？

你的电子书购买是否与选定的设备不兼容？

别担心，现在每本 Packt 书籍你都能免费获得该书的 DRM-free PDF 版本。

在任何地方、任何设备上阅读。直接从你最喜爱的技术书籍中搜索、复制并粘贴代码到你的应用程序中。

福利不仅仅到此为止，你还可以独享折扣、新闻通讯和每天通过电子邮件收到的精彩免费内容。

按照这些简单步骤来获取福利：

1.  扫描二维码或访问以下链接

![](img/B18568_QR_Free_PDF.jpg)

[`packt.link/free-ebook/978-1-80323-225-6`](https://packt.link/free-ebook/978-1-80323-225-6)

1.  提交你的购买凭证

1.  就这样！我们将直接通过电子邮件发送你的免费 PDF 及其他福利。

# 第一部分：时间序列和 Apache Spark 简介

在本部分中，您将了解时间序列分析和 Apache Spark。从时间序列数据的基础概念开始，我们将深入探讨时间序列分析的实际意义及其在各行业的应用，并结合一些实践示例。接着，您将了解 Apache Spark，理解它的使用方式、架构以及工作原理，最后在您的环境中安装它。

本部分包括以下章节：

+   *第一章*，*什么是时间序列？*

+   *第二章*，*为什么进行时间序列分析？*

+   *第三章*，*Apache Spark 简介*
