# 前言

在这个智能时代，数据分析是保持和促进商业增长的关键。每个企业都在努力最大限度地利用其数据，采用各种数据科学工具和技术，在分析成熟度曲线上不断前进。数据科学需求的突然增加是数据科学家稀缺的明显原因。要满足市场对既精通统计学、机器学习、数学建模又具备编程能力的独角兽数据科学家的需求，实属不易。

独角兽数据科学家的可用性将随着市场需求的增加而减少，并且这种情况将持续下去。因此，迫切需要一种解决方案，不仅能够让独角兽数据科学家做得更多，还能创造出 Gartner 所称的“公民数据科学家”。公民数据科学家不是其他人，而是那些主要职能不在统计或分析领域，但足够热衷于学习数据科学的开发人员、分析师、商业智能专业人士或其他技术人员。他们正成为推动整个组织和行业实现数据分析民主化的关键推动力。

不断涌现的各种工具和技术旨在促进大数据分析的规模化。此书旨在培养能够利用 Apache Spark 分布式计算平台进行数据分析的公民数据科学家。

本书是一本学习统计分析和机器学习以构建可扩展数据产品的实用指南。它帮助掌握数据科学的核心概念，并且通过 Apache Spark 帮助你快速启动任何实际数据分析项目。全书的各章都有充足的示例，读者可以在家庭计算机上执行这些示例，轻松跟随并吸收概念。每章都力求自成一体，因此读者可以从任何一章开始，相关章节提供详细内容的指引。尽管各章从基础知识入手，供初学者学习和理解，但同时也足够全面，适合资深架构师阅读。

# 本书内容涵盖

第一章，*大数据与数据科学 – 简介*，本章简要讨论了大数据分析中面临的各种挑战，以及 Apache Spark 如何在单一平台上解决这些问题。还介绍了数据分析是如何发展成现在的样子，并简要阐述了 Spark 技术栈的基本概念。

第二章，*Spark 编程模型*，本章讲述了 Apache Spark 的设计考虑因素及其支持的编程语言，还详细解释了 Spark 的核心组件，并详细介绍了 RDD API，这是 Spark 的基本构建块。

第三章，*数据框架简介*，本章介绍了数据框架，它是数据科学家们工作中最方便、最有用的组件。它解释了 Spark SQL 和赋能数据框架的 Catalyst 优化器。此外，本章还通过代码示例展示了各种数据框架操作。

第四章，*统一数据访问*，本章讨论了我们从不同来源获取数据、整合并以统一方式处理的各种方法。它涵盖了实时数据收集的流式处理方面，并讲解了这些 API 的底层原理。

第五章，*Spark 上的数据分析*，本章讨论了完整的数据分析生命周期。通过大量代码示例，解释了如何从不同来源获取数据，使用数据清理和转化技术准备数据，并进行描述性统计和推论统计，以从数据中挖掘隐藏的洞见。

第六章，*机器学习*，本章解释了各种机器学习算法，如何在 MLlib 库中实现这些算法，以及如何使用管道 API 进行流畅的执行。本章涵盖了所有算法的基本原理，因此可以作为一个一站式参考。

第七章，*使用 SparkR 扩展 Spark*，本章主要面向那些希望利用 Spark 进行数据分析的 R 语言程序员。它解释了如何使用 SparkR 编程，以及如何使用 R 库中的机器学习算法。

第八章，*分析非结构化数据*，本章仅讨论非结构化数据分析。它解释了如何获取非结构化数据、处理这些数据并进行机器学习分析。它还介绍了一些在“机器学习”章节中没有涉及的降维技术。

第九章，*可视化大数据*，本章介绍了在 Spark 上支持的各种可视化技术。它解释了数据工程师、数据科学家和业务用户的不同可视化需求，并且还建议了合适的工具和技术。它还讨论了如何利用 IPython/Jupyter 笔记本和 Apache 项目 Zeppelin 进行数据可视化。

第十章，*将所有内容整合起来*，到目前为止，书中已经在不同的章节分别讨论了大部分的数据分析组件。本章旨在将典型数据科学项目的各个步骤串联起来，并展示一个逐步实施完整分析项目的过程。

第十一章，*构建数据科学应用程序*，到目前为止，本书主要讨论了数据科学组件以及完整的执行示例。本章提供了关于如何构建可部署到生产环境中的数据产品的概述。它还介绍了 Apache Spark 项目的当前开发状态以及未来的计划。

# 本书所需内容

在执行书中提到的代码之前，您的系统必须安装以下软件。不过，并非所有软件组件都适用于所有章节：

+   Ubuntu 14.4 或 Windows 7 及以上版本

+   Apache Spark 2.0.0

+   Scala: 2.10.4

+   Python 2.7.6

+   R 3.3.0

+   Java 1.7.0

+   Zeppelin 0.6.1

+   Jupyter 4.2.0

+   IPython 内核 5.1

# 本书适用对象

本书适合任何想要利用 Apache Spark 进行数据科学和机器学习的人。如果你是一个技术专家，想扩展自己的知识以在 Spark 中执行数据科学操作，或者是一个数据科学家，想了解 Spark 中算法的实现，或是一个经验较少的新手，想学习大数据分析，本书适合你！

# 约定

本书中有多种文本样式，用于区分不同类型的信息。以下是一些样式示例及其含义的解释。

文本中的代码词、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 账号如下所示：“当程序在 Spark shell 上运行时，它被称为驱动程序，其中包含用户的 `main` 方法。”

代码块的格式如下：

```py
Scala> sc.parallelize(List(2, 3, 4)).count()
res0: Long = 3
Scala> sc.parallelize(List(2, 3, 4)).collect()
res1: Array[Int] = Array(2, 3, 4)
Scala> sc.parallelize(List(2, 3, 4)).first()
res2: Int = 2
Scala> sc.parallelize(List(2, 3, 4)).take(2)
res3: Array[Int] = Array(2, 3)
```

**新术语** 和 **重要词汇** 用粗体显示。你在屏幕上看到的词汇，例如在菜单或对话框中，文本中会像这样显示：“它还允许用户通过 **数据源 API** 从未开箱支持的数据源（例如 CSV、Avro HBase、Cassandra 等）获取数据。”

### 注释

警告或重要说明将显示在像这样的框中。

### 小贴士

小窍门和技巧以这种方式呈现。

# 读者反馈

我们始终欢迎读者的反馈。告诉我们你对本书的看法——你喜欢什么，或者不喜欢什么。读者反馈对我们非常重要，它帮助我们开发出你真正能从中受益的书籍。若要向我们提供一般反馈，请通过电子邮件发送至 feedback@packtpub.com，并在邮件主题中提及书名。如果你在某个领域具有专业知识，并有兴趣写书或为书籍贡献内容，请查看我们的作者指南：[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在你已经是 Packt 书籍的骄傲拥有者，我们有一些工具帮助你从购买中获得最大收益。

## 下载示例代码

您可以从您的帐户中下载本书的示例代码文件，网址为[`www.packtpub.com`](http://www.packtpub.com)。如果您在其他地方购买了本书，您可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册以便将文件通过电子邮件直接发送给您。

您可以通过以下步骤下载代码文件：

1.  使用您的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的**支持**标签上。

1.  点击**代码下载与勘误表**。

1.  在**搜索**框中输入书名。

1.  选择您要下载代码文件的书籍。

1.  从下拉菜单中选择您购买本书的渠道。

1.  点击**代码下载**。

文件下载后，请确保使用最新版本的工具解压或提取文件夹：

+   Windows 版的 WinRAR / 7-Zip

+   Mac 版的 Zipeg / iZip / UnRarX

+   Linux 版的 7-Zip / PeaZip

本书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Spark-for-Data-Science`](https://github.com/PacktPublishing/Spark-for-Data-Science)。我们还有其他来自我们丰富书籍和视频目录的代码包，您可以在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)查看它们！

## 下载本书的彩色图像

我们还为您提供了一份 PDF 文件，其中包含本书中使用的截图/图表的彩色图像。这些彩色图像将帮助您更好地理解输出结果的变化。您可以从[`www.packtpub.com/sites/default/files/downloads/SparkforDataScience_ColorImages.pdf`](http://www.packtpub.com/sites/default/files/downloads/Bookname_ColorImages.pdf)下载该文件。

## 勘误表

尽管我们已尽最大努力确保内容的准确性，但错误总会发生。如果您在我们的书中发现了错误——可能是文本或代码中的错误——我们将非常感激您能向我们报告。这样，您可以帮助其他读者避免困扰，并帮助我们改进后续版本的内容。如果您发现任何勘误，请通过访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)报告，选择您的书籍，点击**勘误提交表单**链接，并输入您的勘误详情。一旦您的勘误被验证，您的提交将被接受，勘误将上传到我们的网站或添加到该书标题下的现有勘误列表中。

要查看之前提交的勘误表，请访问[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索框中输入书名。所需的信息将出现在**勘误表**部分。

## 盗版

互联网盗版版权材料是一个涉及所有媒体的持续性问题。在 Packt，我们非常重视保护我们的版权和许可。如果您在互联网上发现我们作品的任何非法复制，请立即向我们提供网址或网站名称，以便我们采取措施。

请通过电子邮件联系 copyright@packtpub.com，并提供涉嫌盗版材料的链接。

感谢您帮助我们保护作者的权益，以及我们向您提供有价值内容的能力。

## 问题

如果您对本书的任何内容有问题，可以通过 questions@packtpub.com 联系我们，我们将尽力解决问题。
