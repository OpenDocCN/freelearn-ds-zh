# 第一章：《Python 生物信息学实用手册》第*三版*

使用现代 Python 库和应用程序解决现实世界的计算生物学问题

Tiago Antao

![](img/Packt_Logo_SuperSite_2022_Orange.png)

伯明翰—孟买

# 《Python 生物信息学实用手册》第*三版*

版权所有 © 2022 Packt Publishing

*版权所有*。未经出版商事先书面许可，本书的任何部分不得以任何形式或任何方式复制、存储在检索系统中或传输，除非是以简短的引文嵌入在重要的文章或评论中。

本书在编写过程中已尽最大努力确保所呈现信息的准确性。然而，本书所包含的信息是没有任何明示或暗示的担保的。无论是作者、Packt Publishing 还是其代理商与分销商，都不对因本书直接或间接造成的或声称已造成的任何损害负责。

Packt Publishing 力求通过适当使用大写字母提供本书中提到的所有公司和产品的商标信息，但无法保证这些信息的准确性。

**出版产品经理**：Devika Battike

**高级编辑**：David Sugarman

**内容开发编辑**：Joseph Sunil

**技术编辑**：Rahul Limbachiya

**文案编辑**：Safis Editing

**项目协调员**：Farheen Fathima

**校对员**：Safis Editing

**索引员**：Pratik Shirodkar

**制作设计师**：Shankar Kalbhor

**市场协调员**：Priyanka Mhatre

初版：2015 年 6 月

第二版：2018 年 11 月

第三版：2022 年 9 月

出版参考：1090922

由 Packt Publishing Ltd. 出版

Livery Place

35 Livery Street

伯明翰

B3 2PB，英国

ISBN 978-1-80323-642-1

[www.packt.com](http://www.packt.com)

# 贡献者

# 关于作者

**Tiago Antao** 是一位生物信息学家，目前在基因组学领域工作。曾是计算机科学家，Tiago 拥有葡萄牙波尔图大学科学学院的生物信息学硕士学位，并在英国利物浦热带医学学院获得了关于抗药性疟疾传播的博士学位。博士后阶段，Tiago 在英国剑桥大学从事人类数据集研究，并在英国牛津大学处理蚊子全基因组测序数据，随后协助建立了美国蒙大拿大学的生物信息学基础设施。现在，他在马萨诸塞州波士顿的生物技术领域担任数据工程师。他是 Biopython 这一重要生物信息学 Python 包的共同作者之一。

# 关于审阅者

**Urminder Singh** 是一名生物信息学家、计算机科学家以及多个开源生物信息学工具的开发者。他的教育背景涵盖了物理学、计算机科学和计算生物学学位，包括在美国爱荷华州立大学获得的生物信息学博士学位。

他的研究兴趣广泛，包括新型基因进化、精准医学、社会基因组学、医学中的机器学习以及开发大规模异构数据的工具和算法。你可以在网上访问他：[urmi-21.github.io](http://urmi-21.github.io)。

**Tiffany Ho** 在 Embark Veterinary 担任生物信息学助理。她拥有加利福尼亚大学戴维斯分校的遗传学和基因组学学士学位，并持有康奈尔大学的植物育种与遗传学硕士学位。

# 目录

## 前言

## 1

## Python 与周边软件生态

### 使用 Anaconda 安装所需的基本软件

### 准备工作

### 如何实现...

### 更多内容...

### 使用 Docker 安装所需的软件

### 准备工作

### 如何实现...

### 另见

### 通过 rpy2 与 R 进行接口连接

### 准备工作

### 如何实现...

### 更多内容...

### 另见

### 在 Jupyter 中执行 R 魔法

### 准备工作

### 如何实现...

### 更多内容...

### 另见

## 2

## 了解 NumPy、pandas、Arrow 和 Matplotlib

### 使用 pandas 处理疫苗不良事件

### 准备工作

### 如何实现...

### 更多内容...

### 另见

### 处理 pandas DataFrame 联接的陷阱

### 准备工作

### 如何实现...

### 更多内容...

### 减少 pandas DataFrame 的内存使用

### 准备工作

### 如何实现…

### 另见

### 通过 Apache Arrow 加速 pandas 处理

### 准备工作

### 如何操作...

### 还有更多...

### 理解 NumPy 作为 Python 数据科学和生物信息学的引擎

### 准备工作

### 如何操作…

### 另请参阅

### 介绍 Matplotlib 进行图表生成

### 准备工作

### 如何操作...

### 还有更多...

### 另请参阅

## 3

## 下一代测序技术

### 访问 GenBank 和 NCBI 数据库移动

### 准备工作

### 如何操作...

### 还有更多...

### 另请参阅

### 执行基本序列分析

### 准备工作

### 如何操作...

### 还有更多...

### 另请参阅

### 使用现代序列格式

### 准备工作

### 如何操作...

### 还有更多...

### 另请参阅

### 处理对齐数据

### 准备工作

### 如何操作...

### 还有更多...

### 另请参阅

### 从 VCF 文件中提取数据

### 准备工作

### 如何操作...

### 还有更多...

### 另请参阅

### 研究基因组可访问性和过滤 SNP 数据

### 准备工作

### 如何操作...

### 还有更多...

### 另请参阅

### 使用 HTSeq 处理 NGS 数据

### 准备工作

### 如何操作...

### 还有更多...

## 4

## 高级 NGS 数据处理

### 准备数据集进行分析

### 准备工作

### 如何操作…

### 利用孟德尔误差信息进行质量控制

### 如何进行…

### 更多内容…

### 通过标准统计探索数据

### 如何进行…

### 更多内容…

### 从测序注释中查找基因组特征

### 如何进行…

### 更多内容…

### 使用 QIIME 2 Python API 进行宏基因组学分析

### 准备工作

### 如何进行...

### 更多内容...

## 5

## 与基因组合作

### 技术要求

### 使用高质量参考基因组进行工作

### 准备工作

### 如何进行...

### 更多内容...

### 另见

### 处理低质量基因组参考

### 准备工作

### 如何进行...

### 更多内容...

### 另见

### 遍历基因组注释

### 准备工作

### 如何进行...

### 更多内容...

### 另见

### 使用注释从参考基因组提取基因

### 准备工作

### 如何进行...

### 更多内容...

### 另见

### 使用 Ensembl REST API 查找同源基因

### 准备工作

### 如何进行...

### 更多内容...

### 从 Ensembl 检索基因本体信息

### 准备工作

### 如何进行...

### 更多内容...

### 另见

## 6

## 群体遗传学

### 使用 PLINK 管理数据集

### 准备工作

### 如何进行...

### 更多内容...

### 另见

### 使用 sgkit 进行群体遗传学分析，配合 xarray

### 准备工作

### 如何进行...

### 更多内容...

### 使用 sgkit 探索数据集

### 准备就绪

### 如何进行...

### 更多内容...

### 参见

### 分析种群结构

### 准备就绪

### 如何进行...

### 参见

### 执行 PCA

### 准备就绪

### 如何进行...

### 更多内容...

### 参见

### 通过混合分析调查种群结构

### 准备就绪

### 如何进行...

### 更多内容...

## 7

## 系统发育学

### 为系统发育分析准备数据集

### 准备就绪

### 如何进行...

### 更多内容...

### 参见

### 对齐遗传和基因组数据

### 准备就绪

### 如何进行...

### 比较序列

### 准备就绪

### 如何进行...

### 更多内容...

### 重建系统发育树

### 准备就绪

### 如何进行...

### 更多内容...

### 递归操作树形结构

### 准备就绪

### 如何进行...

### 更多内容...

### 可视化系统发育数据

### 准备就绪

### 如何进行...

### 更多内容...

## 8

## 使用蛋白质数据银行

### 在多个数据库中查找蛋白质

### 准备就绪

### 如何进行...

### 更多内容

### 介绍 Bio.PDB

### 准备就绪

### 如何进行...

### 还有更多

### 从 PDB 文件中提取更多信息

### 准备工作

### 如何操作...

### 在 PDB 文件中计算分子距离

### 准备工作

### 如何操作...

### 进行几何运算

### 准备工作

### 如何操作...

### 还有更多

### 使用 PyMOL 进行动画制作

### 准备工作

### 如何操作...

### 还有更多

### 使用 Biopython 解析 mmCIF 文件

### 准备工作

### 如何操作...

### 还有更多

## 9

## 生物信息学管道

### 介绍 Galaxy 服务器

### 准备工作

### 如何操作…

### 还有更多

### 通过 API 访问 Galaxy

### 准备工作

### 如何操作…

### 使用 Snakemake 部署变异分析管道

### 准备工作

### 如何操作…

### 还有更多

### 使用 Nextflow 部署变异分析管道

### 准备工作

### 如何操作…

### 还有更多

## 10

## 生物信息学中的机器学习

### 通过 PCA 示例介绍 scikit-learn

### 准备工作

### 如何操作...

### 还有更多...

### 使用 PCA 上的聚类来分类样本

### 准备工作

### 如何操作...

### 还有更多...

### 使用决策树探索乳腺癌特征

### 准备工作

### 如何操作...

### 使用随机森林预测乳腺癌结果

### 准备工作

### 如何操作…

### 更多内容...

## 11

## 使用 Dask 和 Zarr 进行并行处理

### 使用 Zarr 读取基因组数据

### 准备工作

### 如何做...

### 更多内容...

### 另见

### 使用 Python 多进程进行数据的并行处理

### 准备工作

### 如何做...

### 更多内容...

### 另见

### 使用 Dask 处理基于 NumPy 数组的基因组数据

### 准备工作

### 如何做...

### 更多内容...

### 另见

### 使用 dask.distributed 调度任务

### 准备工作

### 如何做...

### 更多内容...

### 另见

## 12

## 生物信息学中的函数式编程

### 理解纯函数

### 准备工作

### 如何做...

### 更多内容...

### 理解不可变性

### 准备工作

### 如何做...

### 更多内容...

### 避免可变性作为一种稳健的开发模式

### 准备工作

### 如何做...

### 更多内容...

### 使用懒加载编程进行管道化

### 准备工作

### 如何做...

### 更多内容...

### Python 中递归的限制

### 准备工作

### 如何做...

### 更多内容...

### Python functools 模块展示

### 准备工作

### 如何做...

### 更多内容...

### 另见...

## 索引

## 你可能会喜欢的其他书籍
