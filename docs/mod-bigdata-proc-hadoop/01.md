# 一、企业数据架构原则

传统上，企业采用数据仓库来存储、处理和访问大量数据。这些仓库通常是大型关系数据库管理系统数据库，能够存储非常大规模的各种数据集。随着数据复杂性、数量和访问模式的增加，许多企业已经开始采用大数据作为模型来重新设计他们的数据组织，并围绕它定义必要的策略。

此图描述了企业中典型数据仓库的外观:

![](img/fd2772aa-5642-432c-af19-189def518610.png)

由于企业有许多不同的部门、组织和地理位置，每个部门都倾向于拥有自己的仓库，并对整个企业提出了各种挑战。例如:

*   数据的多个来源和目的地
*   数据复制和冗余
*   数据访问监管问题
*   整个企业的非标准数据定义。
*   软件和硬件的可扩展性和可靠性问题
*   数据移动和审计
*   不同仓库之间的集成

由于多项技术进步，以比几十年前更低的成本构建超大规模系统变得非常容易，例如:

*   每太字节成本
*   每纳米计算能力
*   千兆网络带宽
*   云

随着全球化，市场全球化，消费者也全球化。这增加了覆盖范围。这些进步也给企业带来了以下方面的挑战:

*   人力资本管理
*   仓库管理
*   物流管理
*   数据隐私和安全
*   销售和计费管理
*   了解需求和供应

为了掌握市场的需求，企业开始收集越来越多关于自己的指标；因此，在当前情况下，数据处理的维度有所增加。

在本章中，我们将学习:

*   数据架构原则
*   元数据的重要性
*   数据治理
*   数据安全
*   数据即服务
*   Hadoop 的数据架构演进

# 数据架构原则

当前状态的数据可以定义为以下四个维度(四个 Vs)。

# 卷

数据量是设计大数据系统所需的一个重要指标。这是决定企业为满足当前和未来存储需求而必须进行的投资的一个重要因素。

企业中不同类型的数据需要不同的存储、归档和处理能力。Petabyte 存储系统在当今行业非常普遍，这在几十年前几乎是不可能实现的。

# 速度

这是决定数据移动性的另一个数据维度。组织内部存在着属于以下类别的各种数据:

*   流式数据:
    *   实时/接近实时的数据
*   静态数据:
    *   不可变数据
    *   可变数据

这个维度对企业用来消费和处理数据的网络架构有一些影响。

# 多样化

这个维度谈论数据的形式和形状。我们可以进一步将其分为以下几类:

*   流式数据:
    *   在线数据格式(例如，JSON、MPEG 和 Avro)
*   静态数据:
    *   不可变数据(例如，媒体文件和客户发票)
    *   可变数据(例如，客户详细信息、产品库存和员工数据)
*   应用数据:
    *   配置文件、机密、密码等

作为一个组织，采用非常少的技术来减少数据的多样性是非常重要的。拥有许多不同类型的数据对于企业来说，在管理和使用所有数据方面都是一个非常大的挑战。

# 诚实

这个维度讲的是数据的准确性。如果没有对企业内每个系统为保持数据安全、可用和可靠而提供的保证有一个坚实的理解，就很难理解从这些数据中生成的分析并进一步生成见解。

必要的审计应该到位，以确保流经系统的数据通过所有质量检查，并最终通过大数据系统。

让我们看看典型的大数据系统是什么样子的:

![](img/695a9258-e5b2-4dc8-94a9-a49e5e772e78.png)

如您所见，许多不同类型的应用正在与大数据系统交互，以存储、处理和生成分析。

# 元数据的重要性

在我们试图理解元数据的重要性之前，让我们尝试理解什么是元数据。元数据简单来说就是**数据关于数据**的数据。这听起来很混乱，因为我们正在以递归的方式定义定义。

在典型的大数据系统中，我们有这三个垂直级别:

*   将数据写入大数据系统的应用
*   在大数据系统中组织数据
*   使用大数据系统数据的应用

这带来了一些挑战，因为我们谈论的是存储在大数据系统中的数百万(甚至数十亿)数据文件/数据段。我们应该能够正确识别整个企业中这些数据文件的所有权和使用情况。

我们举一个电视广播公司拥有一个电视频道的例子；它制作电视节目，并通过有线电缆网络、卫星网络、互联网等向所有目标受众广播。如果我们仔细看，内容的来源只有一个。但它正在通过所有可能的媒介传播，最终到达用户的位置，以便在电视、手机、平板电脑等设备上观看。

由于观众在各种设备上访问该电视内容，因此在这些设备上运行的应用可以生成若干消息来指示各种用户动作和偏好，并将它们发送回应用服务器。这些数据非常庞大，存储在一个大数据系统中。

根据数据在大数据系统中的组织方式，外部应用或对等应用几乎不可能知道系统中存储的不同类型的数据。为了使这一过程更容易，我们需要描述和定义数据组织是如何在大数据系统中发生的。这将帮助我们更好地了解大数据系统中的数据组织和访问。

让我们进一步扩展这个例子，假设有另一个应用从大数据系统中读取数据，以了解在给定的电视剧中做广告的最佳时间。该应用应该更好地理解大数据系统中可用的所有其他数据。因此，如果没有定义良好的元数据系统，很难做到以下几点:

*   了解存储、访问和处理的数据的多样性
*   跨不同类型的数据集构建接口
*   从安全角度正确地将数据标记为高度敏感或不敏感的数据
*   连接大数据生态系统中给定系统集之间的点
*   审核和排除因数据不一致而可能出现的问题

# 数据治理

拥有非常大的数据量不足以做出对业务成功有积极影响的非常好的决策。确保只收集、保存和维护高质量的数据是非常重要的。随着需要收集新类型的数据，数据收集过程也经历了演变。在这个过程中，我们可能会破坏一些从上一代数据中读取的接口。如果没有定义明确的流程和人员，处理数据对所有规模的组织来说都是一个巨大的挑战。

要在管理数据方面出类拔萃，我们应该考虑以下品质:

*   良好的政策和流程
*   有责任
*   正式决策结构
*   管理规则的实施

这些类型的质量的实现被称为**数据治理**。在高层次上，我们将数据治理定义为管理良好的数据。这个定义也帮助我们澄清了数据管理和数据治理不是一回事。管理数据与使用数据来做出良好的业务决策并最终管理组织有关。数据治理关注的是我们在管理数据时，在整个组织中使用规范行为的程度。

这是一个重要的区别。那么底线是什么呢？大多数组织都管理数据，但很少有人能很好地管理这些管理技术。

# 数据治理基础

让我们试着理解数据治理的基本原理:

*   有责任
*   标准化
*   透明度

透明度确保组织内外的所有员工在与组织相关的数据进行交互时了解自己的角色。这将确保以下事项:

*   建立信任
*   避免惊喜

问责制确保有权访问数据的团队和员工描述他们可以对数据做什么和不能做什么。

标准化处理数据如何被正确地标记、描述和分类。一个例子是如何为组织内的员工生成电子邮件地址。一种方法是使用[firstname-lastname@company.com](mailto:firstname-lastname@company.com)，或者这些的任何其他组合。这将确保每个有权访问这些电子邮件地址的人都知道哪个是第一个，哪个是最后一个，而无需任何人亲自解释。

标准化提高了数据质量，并为多个数据维度带来了秩序。

# 数据安全

安全不是一个新概念。它从早期的 UNIX 分时操作系统设计开始就被采用了。在最近的过去，由于广泛的数据泄露给组织带来了大量收入损失，个人和组织在安全方面的安全意识有所提高。

安全，作为一个普遍的概念，可以应用于许多不同的事情。谈到数据安全，我们需要了解以下基本问题:

*   *存在哪些类型的数据？*
*   *谁拥有数据？*
*   *谁有权访问数据？*
*   *数据什么时候退出系统？*
*   *数据是否受到物理保护？*

让我们看一看一个简单的大数据系统，并尝试更详细地理解这些问题。系统的规模让安全成为每个人的噩梦。因此，我们应该制定适当的政策，让所有人保持一致:

![](img/a3bd7e50-5fd2-4082-8c18-b407c4eee4ba.png)

在本例中，我们有以下组件:

*   跨全球多个地理区域运行的异构应用。
*   应用生成大量各种各样的输入数据。
*   所有数据都被吸收到一个大数据系统中。
*   ETL/ELT 应用使用来自大数据系统的数据，并将可使用的结果放入 RDBMS(这是可选的)。
*   商业智能应用从该存储中读取数据，并进一步生成对数据的洞察。这些是领导团队决策的动力。

你可以想象流经这个系统的数据的规模和数量。我们还可以看到，参与整个生态系统的服务器、应用和员工数量非常多。如果我们没有适当的政策，要确保这样一个复杂的系统不是一件非常容易的事情。

此外，如果攻击者使用社会工程来获得对系统的访问，我们应该确保数据访问仅限于最低可能的级别。当糟糕的安全实施到位时，攻击者可以访问几乎所有的商业秘密，这可能会给企业带来严重损失。

仅举一个例子，一家初创公司正在构建下一代计算设备，以将其所有数据托管在云上，并且没有适当的安全策略。当攻击者危及云中服务器的安全时，他们可以很容易地发现这家初创公司正在构建什么，并窃取情报。一旦情报被窃取，我们可以想象黑客如何利用这一点为自己谋利。

了解了安全性的重要性后，让我们定义需要保护的内容。

# 应用安全

应用是基于产品的组织的第一线，因为消费者使用这些应用与应用提供的产品和服务进行交互。我们必须确保在编程这些应用接口时遵循适当的安全标准。

由于这些应用向后端系统生成数据，我们应该确保在防火墙方面只允许适当的访问机制。

此外，这些应用与许多其他后端系统交互，我们必须确保显示与用户相关的正确数据。这归结为在访问不同类型的组织资源时，不仅为用户，而且为应用实现适当的身份验证和授权。

如果没有适当的审计，应用很难分析数据访问模式。所有日志都应该收集在远离应用服务器的中央位置，并可以进一步纳入大数据系统。

# 输入数据

一旦应用生成了几个度量标准，它们就可以临时存储在本地，由周期性进程进一步使用，或者被进一步推送到像 Kafka 这样的流系统。

在这种情况下，我们应该仔细思考并设计数据存储在哪里，以及哪些用户可以访问这些数据。如果我们进一步将这些数据写入像 Kafka 或 MQ 这样的系统，我们必须确保进一步的身份验证、授权和访问控制到位。

在这里，我们可以利用操作系统提供的安全措施，如进程用户标识、进程组标识、文件系统用户标识、组标识，以及高级系统(如 SELinux)来进一步限制对输入数据的访问。

# 大数据安全

根据所选择的数据仓库解决方案，我们必须确保授权的应用和用户能够读写数据仓库。适当的安全策略和审计应该到位，以确保这种大规模的数据不容易被每个人访问。

为了实现所有这些访问策略，我们可以使用操作系统提供的机制，如文件访问控制和使用访问控制。由于我们谈论的是地理上分布的大数据系统，因此我们必须思考和设计集中式身份验证系统，以便在员工与这些大数据系统交互时为他们提供无缝体验。

# RDBMS 安全性

许多关系数据库管理系统非常安全，可以为用户提供以下访问级别:

*   数据库ˌ资料库
*   桌子
*   使用模式

他们也有内置的审计机制来告诉哪些用户已经访问了什么类型的数据以及何时访问。这些数据对于保持系统的安全至关重要，应该进行适当的监控，以监控这些系统的健康和安全。

# 商业智能安全

这些应用可以是为满足公司特定需求而内部构建的应用，也可以是能够激发业务团队所寻求的洞察力的外部应用。还应该通过实施单点登录、基于角色的访问控制和基于网络的访问控制来适当地保护这些应用。

由于这些应用提供的洞察力对组织的成功至关重要，因此应该采取适当的安全措施来保护它们。

到目前为止，我们已经看到了企业系统的不同部分，并了解了可以遵循什么来提高整体企业数据设计的安全性。让我们谈谈在数据设计中随处可以应用的一些常见的东西。

# 人身安全

这涉及物理设备访问、数据中心访问、服务器访问和网络访问。如果未经授权的人员获得了对企业拥有的设备的访问权限，他们就可以访问其中存在的所有数据。

正如我们在前面几节中看到的，当操作系统运行时，我们能够通过利用操作系统的安全特性来保护资源。当入侵者获得对设备(甚至退役的服务器)的物理访问权限时，他们可以将这些设备连接到他们控制的另一个操作系统，并访问我们服务器上的所有数据。

当我们停用服务器时，必须小心，因为有一些方法可以恢复写入这些设备的数据(即使在格式化之后)。因此，我们应该遵循行业标准的设备擦除技术来适当地清除企业拥有的所有数据。

为了防止这些，我们应该考虑加密数据。

# 数据加密

加密数据将确保即使授权人员能够访问设备，他们也无法恢复数据。由于数据和员工流动性的增加，这是目前遵循的标准做法。许多大企业对笔记本电脑和手机上的硬盘进行加密。

# 安全密钥管理

如果您使用过任何需要身份验证的应用，您将使用用户名和密码的组合来访问服务。通常这些秘密存储在源代码本身中。这给非编译程序带来了挑战，因为攻击者可以轻松访问用户名和密码来访问我们的资源。

许多企业开始采用集中式密钥管理，使用这种管理，应用可以查询这些服务来访问受身份验证保护的资源。所有这些访问模式都经过 KMS 的适当审核

员工还应该使用自己的凭据访问这些系统，以访问资源。这确保密钥受到保护，并且只有授权的应用才能访问。

# 数据即服务

**数据即服务**(**【DaaS】**)是近年来因采用云的增加而流行的一个概念。说到数据。如何将数据添加到服务模型中，这可能有些令人困惑？

DaaS 为服务用户提供了极大的灵活性，让他们不必担心运行服务的底层基础设施的规模、性能和维护。基础设施会自动为我们处理它，但是考虑到我们正在处理云模型，我们拥有云的所有优势，例如*现收现付*、容量规划等等。这将减轻数据管理的负担。

如果我们试着仔细理解这一点，我们将单独去掉数据管理部分。但是数据治理也应该在这里得到很好的定义，否则我们将失去服务模型的所有好处。

到目前为止，我们谈论的是云中的*服务*概念。*这是否意味着我们不能在企业或更小的组织中使用它？*答案是*否*。因为这是一个通用的概念，它告诉我们以下事情。

当我们谈论一个服务模式时，我们应该记住以下几点，否则混乱会接踵而至:

*   证明
*   批准
*   审计

这将保证只有定义明确的用户、IP 地址和服务才能访问作为服务公开的数据。

让我们以一个拥有以下数据的组织为例:

*   雇员
*   服务器和数据中心
*   应用
*   内部网文档网站

如您所见，所有这些都是独立的数据集。但是，作为一个整体，当我们希望组织成功时。有很多重叠，我们应该尝试在这里接受 DaaS 模型，以便所有这些权威的数据应用仍然可以管理数据。但是对于其他应用，它们是使用 REST API 作为简单服务公开的；因此，这增加了组织内部的协作并促进了创新。

让我们进一步举例说明这是如何实现的:

*   以数据库形式管理所有员工数据的团队可以提供简单的**数据服务**。所有其他应用都可以使用此数据集，而无需担心存储此员工数据的底层基础架构:
    *   这将释放数据服务的消费者，使消费者:
        *   无需担心底层基础设施
        *   无需担心用于与这些数据服务器通信的协议
        *   可以只关注 REST 模型来设计应用
    *   这方面的典型例子有:
        *   将员工数据存储在数据库中，如`LDAP`或`Microsoft Active`目录
*   为整个组织管理基础架构的团队可以设计自己的系统，以避开组织的整个硬件库存，并可以提供简单的数据服务。组织的其他成员可以使用它来构建他们感兴趣的应用:
    *   这将使企业更加敏捷
    *   它确保了关于组织整个硬件的数据只有一个真实来源
    *   它提高了对数据的信任，并增强了对基于这些数据构建的应用的信心
*   组织中的每个团队都可能使用不同的技术来构建应用并将其部署到服务器上。接下来，他们还需要构建一个数据存储，以跟踪服务器上部署的软件的活动版本。拥有这样的数据源可以在以下方面帮助组织:
    *   使用这些数据构建的服务可以持续监控和查看软件部署更频繁发生的位置
    *   这些服务还可以找出哪些应用易受攻击，并在生产中积极部署，以便通过升级操作系统或软件采取进一步措施来修复漏洞
    *   了解整个软件部署生命周期中的挑战
    *   为整个组织提供了一个以标准方式做事的单一平台，从而提升了主人翁意识
*   文档对于一个组织来说是非常重要的事情之一。使用 DaaS 模型，组织和团队可以专注于与他们公司相关的文档，并且只为这些文档付费，而不是运行他们自己的基础架构。在这里，谷歌文档和微软在线办公等服务非常受欢迎，因为它们让我们可以灵活地按需付费，最重要的是，不用担心构建这些服务所需的技术。
    *   拥有这样的数据服务模型将有助于我们实现以下目标:
        *   只为使用的服务付费
        *   根据需要增加或减少存储规模
        *   如果服务在云上并连接到互联网，则可以从任何地方访问数据
        *   根据企业政策，通过虚拟专用网络连接时访问公司资源

在前面的示例中，我们看到了企业中使用的各种应用，以及数据作为模型如何以各种方式帮助企业带来协作、创新和信任。

但是，*说到大数据，DaaS 能做什么？*

就像所有其他数据一样，大数据也可以适合 DaaS 模型，并提供与我们之前看到的相同的灵活性:

*   无需担心底层硬件和技术
*   根据需要扩展基础架构
*   只为企业拥有的数据付费
*   运营和维护挑战被消除
*   数据可以在地理位置上可用，以实现高可用性
*   针对灾难恢复需求的集成备份和恢复

有了这几个优势，企业可以更加敏捷，构建能够利用这些数据作为服务的应用。

# Hadoop 的演进数据架构

Hadoop 是一款有助于可扩展和分布式计算的软件。在 Hadoop 出现之前，业界使用了许多技术来满足他们的数据需求。让我们对这些存储机制进行分类:

*   分级数据库
*   网络数据库
*   关系数据库

让我们了解一下这些数据架构是什么。

# 分层数据库体系结构

这种存储企业数据的模型是由 IBM 在 60 年代早期发明的，并被用于他们的应用中。层次数据库的基本概念是数据以**根树**的形式组织。根节点是树的开始，然后所有的子节点只链接到它的一个父节点。这是一种非常独特的存储和检索东西的方式。

如果你有一些计算机科学的背景，树是存储数据的独特方式之一，因此它彼此之间有一些关系(像父子关系)。

此图说明了数据在典型的 HDBMS 中是如何组织的:

![](img/a822afac-45fe-4dab-9a31-d65bc11157d4.png)

正如我们所看到的，根节点是组织本身，与组织相关的所有数据都遵循一个描述若干关系的树结构。这些关系可以这样理解:

*   **员工**拥有**笔记本电脑**、**手机**、**工作站**、 **iMac**
*   **员工**隶属于**组织**
*   许多供应商提供不同的要求:
    *   电脑厂商供应 **iMac** 和**工作站**
*   印度和美国都有餐饮；两个供应商，*最佳餐饮服务商*和*湾区餐饮服务商*提供这些服务

即使我们在这个巨大的数据存储中表达了多种类型的关系，我们也可以看到数据被复制，并且查询不同类型需求的数据成为一个挑战。

让我们来看一个简单的问题，比如:*哪个供应商提供了员工-391 拥有的 iMac？*

为了做到这一点，我们需要遍历树并从两个不同的子树中找到信息。

# 网络数据库体系结构

网络数据库管理系统也源于计算机科学:图论，其中有大量不同类型的节点和关系将它们连接在一起。该结构中没有特定的根节点。它是在 70 年代早期发明的:

![](img/d1aec683-9863-4b4b-a2be-fe16d7fecb94.png)

我们可以看到，在这个结构中，有几个核心数据集，还有其他数据集与核心数据集链接。

我们可以这样理解它:

*   定义了主医院
*   它有许多附属医院
*   附属医院在印度和美国
*   印度医院使用病人的数据
*   美国医院使用病人的数据
*   病人商店与主医院相连
*   员工属于医院，与其他组织有联系

在这种结构中，根据我们提出的设计，数据被表示为一个元素网络。

# 关系数据库体系结构

该系统于 80 年代初在 IBM 再次开发，被认为是迄今为止最著名的数据库系统之一。采用这种风格的软件的几个显著例子是甲骨文和 MySQL。

在这个模型中，数据以记录的形式存储，每个记录又有几个属性。所有记录集合都存储在一个表中。跨表的数据属性之间存在关系。相关表的集合存储在数据库中。

让我们看看这个关系数据库管理系统表的一个典型例子:

![](img/a892b224-45ab-43c4-8638-ceacd2a8d5ec.png)

我们正在定义以下类型的表和关系

# 雇员

*   该表由所有员工记录组成
*   每条记录的定义如下:
    *   员工唯一标识符
    *   员工姓名
    *   员工出生日期
    *   员工地址
    *   员工电话
    *   员工移动电话

# 设备

*   该表由员工拥有的所有设备组成
*   每个所有权记录根据以下内容进行定义:
    *   设备所有权标识符
    *   设备模型
    *   设备制造商
    *   设备所有权日期
    *   设备唯一编号
    *   员工编号

# 部门

包含组织中所有部门的表格:

*   唯一的部门标识
*   唯一的部门名称

# 部门和员工映射表

这是一个特殊的表，仅包含使用其唯一标识符的部门和员工之间的关系:

*   唯一的部门标识
*   唯一的员工标识

# Hadoop 数据架构

到目前为止，我们已经探索了企业使用的几种类型的数据架构。在本节中，我们将了解数据架构是如何在 Hadoop 中构建的。

简单介绍一下，Hadoop 有多个组件:

*   数据
*   数据管理
*   对数据运行作业的平台

# 数据层

这是所有数据以文件形式存储的层。这些文件由 Hadoop 系统在内部拆分为多个部分，并在服务器之间复制以实现高可用性。

因为我们讨论的是以文件形式存储的数据，所以了解这些文件是如何组织的以实现更好的治理是非常重要的。

下图显示了如何在一个 Hadoop 存储层中组织数据。数据的内容可以是任何形式，因为 Hadoop 不会强制它们处于特定的结构中。因此，我们可以在该数据层中安全地存储蓝光电影、 **CSV** ( **逗号分隔值)**文件、AVRO 编码文件等。

You might be wondering why we are not using the word **HDFS** (**Hadoop Distributed File System**) here. It's because Hadoop is designed to run on top of any distributed file system.

![](img/5c71360c-9c53-4e50-90f6-f7cea33957bf.png)

# 数据管理层

该层负责跟踪给定文件或路径的数据存储位置(根据服务器、偏移量等)。因为这只是一个记账层，所以非常重要的一点是，这一层的内容要得到高可靠性和持久性的保护。该层中数据的任何损坏都将导致整个数据文件永远丢失。

在 Hadoop 术语中，这也被称为**名称节点**。

# 作业执行层

一旦我们解决了数据问题，接下来就是读写数据的程序了。当我们谈论单个服务器或笔记本电脑上的数据时，我们很清楚数据在哪里，因此我们可以编写程序，将数据读写到相应的位置。

以类似的方式，Hadoop 存储层使得应用非常容易给出文件路径，以便在计算过程中将数据读写到存储中。这对编程社区来说是一个非常大的胜利，因为他们不需要担心数据在分布式 Hadoop 集群中的物理存储位置的底层语义。

由于 Hadoop 在数据模型附近提升了*计算，这提供了非常高的性能和吞吐量，运行的程序可以由 Hadoop 引擎在更接近整个集群中数据的位置进行调度和执行。数据的整个传输和软件执行的移动都由 Hadoop 负责。*

因此，Hadoop 的最终用户将该系统视为具有强大计算能力和存储的简单系统。这种抽象赢得了每个人的需求，成为当今大数据计算的标准。

# 摘要

在本章中，我们看到了有多少组织采用数据仓库来存储、处理和访问他们拥有的大量数据。我们学习了数据架构原则、它们的治理和安全性。在下一章中，我们将了解一些数据预处理的概念。