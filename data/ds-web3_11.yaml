- en: '11'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '11'
- en: Price Prediction with Time Series
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用时间序列进行价格预测
- en: A significant amount of time spent by analysts and researchers in the finance
    industry is devoted to predicting investment opportunities, including asset prices
    and asset returns. With the availability of large volumes of data and advancements
    in processing techniques, **machine learning** (**ML**) has gained momentum, expanding
    its application beyond asset pricing to areas such as insurance pricing, portfolio
    management, and risk management.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 金融行业中，分析师和研究人员花费大量时间进行投资机会预测，包括资产价格和资产收益。随着大量数据的可用性和处理技术的进步，**机器学习**（**ML**）得到了迅猛发展，应用领域也从资产定价扩展到如保险定价、投资组合管理和风险管理等领域。
- en: In addition to the well-known applications of ML in the financial industry,
    we can now consider the influence of Web3 and open data. As we have learned throughout
    this book, data in Web3 is accessible to anyone. Privileged information, such
    as bank balances or significant account movements, can be viewed by anyone who
    knows where to look, as explained in [*Chapter 5*](B19446_05.xhtml#_idTextAnchor168).
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 除了机器学习在金融行业中的广泛应用外，我们现在还可以考虑Web3和开放数据的影响。正如我们在本书中所学到的，Web3中的数据是任何人都可以访问的。特权信息，如银行余额或重要账户变动，任何知道去哪里查看的人都可以看到，正如在[*第5章*](B19446_05.xhtml#_idTextAnchor168)中所解释的那样。
- en: Many asset modeling and prediction problems in the financial industry involve
    a time component and the estimation of continuous outputs. This is why our focus
    in this chapter will be on time-series analysis, understanding what these outputs
    are, and how to model them. Our objective is to utilize historical data points,
    including the time component, to predict future outcomes, particularly in the
    context of predicting prices.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 金融行业中的许多资产建模和预测问题都涉及时间因素和连续输出的估计。因此，本章的重点将放在时间序列分析上，理解这些输出是什么，以及如何对其建模。我们的目标是利用包括时间因素在内的历史数据点，来预测未来的结果，特别是在预测价格的背景下。
- en: 'In summary, this chapter will cover the following topics:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 总结一下，本章将涵盖以下主题：
- en: A primer on time series
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时间序列基础
- en: Database selection and feature engineering
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据库选择和特征工程
- en: Modeling, training, and evaluation of results
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型建立、训练和结果评估
- en: We will employ both traditional statistical models and **deep learning** (**DL**)
    methodologies to capture the patterns and dynamics within the time series data.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将同时采用传统统计模型和**深度学习**（**DL**）方法来捕捉时间序列数据中的模式和动态。
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: In this chapter, we will be utilizing the `statsmodels` library, specifically
    its time-series analysis packages (`tsa` and `statespace`). `statsmodels` is a
    comprehensive Python module that offers a wide range of classes and functions
    for estimating various statistical models, performing statistical tests, and conducting
    statistical data exploration. For time-series analysis, it provides essential
    models such as univariate **autoregressive** (**AR**) models, **vector AR** (**VAR**)
    models, and univariate **AR moving average** (**ARMA**) models. Furthermore, it
    offers descriptive statistics for time series, such as the **autocorrelation**
    and **partial autocorrelation** functions (**ACF** and **PACF**).
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用`statsmodels`库，特别是其时间序列分析包（`tsa`和`statespace`）。`statsmodels`是一个全面的Python模块，提供了广泛的类和函数，用于估计各种统计模型，执行统计测试，并进行统计数据探索。对于时间序列分析，它提供了基本的模型，如单变量**自回归**（**AR**）模型，**向量自回归**（**VAR**）模型，以及单变量**自回归滑动平均**（**ARMA**）模型。此外，它还提供了时间序列的描述性统计，如**自相关**和**偏自相关**函数（**ACF**和**PACF**）。
- en: 'If you have not worked with `statsmodels` before, it can be installed using
    the following command:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你之前没有使用过`statsmodels`，可以通过以下命令进行安装：
- en: '[PRE0]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The documentation for `statsmodels` can be found at [https://www.statsmodels.org/stable/index.xhtml](https://www.statsmodels.org/stable/index.xhtml).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '`statsmodels`的文档可以在[https://www.statsmodels.org/stable/index.xhtml](https://www.statsmodels.org/stable/index.xhtml)找到。'
- en: 'We will also be utilizing `pmdarima`, which allows us to interact with `pmdarima`
    serves as a Python wrapper for various statistical and ML libraries (including
    `statsmodels` and `scikit-learn`). If you have not worked with `pmdarima` before,
    it can be installed with the following command:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还将使用`pmdarima`，它允许我们与`pmdarima`进行交互，`pmdarima`作为多个统计和机器学习库（包括`statsmodels`和`scikit-learn`）的Python封装。如果你之前没有使用过`pmdarima`，可以通过以下命令安装：
- en: '[PRE1]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The documentation for `pmdarima` can be found at [http://alkaline-ml.com/pmdarima/](http://alkaline-ml.com/pmdarima/).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '`pmdarima` 的文档可以在 [http://alkaline-ml.com/pmdarima/](http://alkaline-ml.com/pmdarima/)
    找到。'
- en: 'We will also extract our working dataset from `yfinance`, which is an open
    source Python library that serves as an interface to the Yahoo Finance API, providing
    convenient access to a wide range of financial data, including stock market prices,
    historical data, dividend information, and more. To install the library, we have
    to run the following command:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还将从 `yfinance` 中提取我们的工作数据集，`yfinance` 是一个开源的 Python 库，作为 Yahoo Finance API
    的接口，提供便捷的金融数据访问，包括股市价格、历史数据、股息信息等。要安装该库，我们需要运行以下命令：
- en: '[PRE2]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The documentation for `yfinance` can be found at [https://pypi.org/project/yfinance/](https://pypi.org/project/yfinance/).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '`yfinance` 的文档可以在 [https://pypi.org/project/yfinance/](https://pypi.org/project/yfinance/)
    找到。'
- en: 'All the data and code files related to this chapter can be accessed in the
    book’s GitHub repository, available here:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 与本章相关的所有数据和代码文件可以在本书的 GitHub 仓库中访问，点击此处查看：
- en: '[https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter11](https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter11)'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter11](https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter11)'
- en: We recommend that you read through the code files in the `Chapter11` folder
    to follow along with the chapter effectively.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我们建议你阅读 `Chapter11` 文件夹中的代码文件，以便更有效地跟随本章内容。
- en: A primer on time series
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 时间序列基础
- en: Time Series is a collection of observations across time, spaced at equal intervals
    of time.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列是一组在时间上等间隔观测值的集合。
- en: – Luis Alberiko Gil-Alaña
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: – 路易斯·阿尔贝里科·吉尔-阿拉尼亚
- en: The collection of observations mentioned by Professor Gil-Alaña forms a sequence
    of events that unfold and evolve over time in chronological order.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 吉尔-阿拉尼亚教授提到的观测值集合形成了一系列事件，这些事件随着时间的推移按时间顺序展开并发展。
- en: These observations represent various data points that change or fluctuate over
    time, such as stock prices, temperature readings, sales figures, website traffic,
    number of blockchain transactions, and more. Each observation holds valuable knowledge
    about the past and provides information about future trends.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 这些观测值代表了随时间变化或波动的各种数据点，例如股价、温度读数、销售数据、网站流量、区块链交易数量等。每个观测值都包含关于过去的宝贵信息，并为未来的趋势提供线索。
- en: 'A 10-month time series representing the monthly closing price of **Bitcoin-US
    Dollar** (**BTC-USD**) looks like this:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 一个代表 **比特币-美元**（**BTC-USD**）月度收盘价的10个月时间序列如下所示：
- en: '| **Date** | **Close** |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| **日期** | **收盘价** |'
- en: '| 10/1/2014 | 338.321014 |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| 2014/10/1 | 338.321014 |'
- en: '| 11/1/2014 | 378.046997 |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| 2014/11/1 | 378.046997 |'
- en: '| 12/1/2014 | 320.192993 |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| 2014/12/1 | 320.192993 |'
- en: '| 1/1/2015 | 217.464005 |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| 2015/1/1 | 217.464005 |'
- en: '| 2/1/2015 | 254.263 |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| 2015/2/1 | 254.263 |'
- en: '| 3/1/2015 | 244.223999 |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 2015/3/1 | 244.223999 |'
- en: '| 4/1/2015 | 236.145004 |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| 2015/4/1 | 236.145004 |'
- en: '| 5/1/2015 | 230.190002 |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| 2015/5/1 | 230.190002 |'
- en: '| 6/1/2015 | 263.071991 |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 2015/6/1 | 263.071991 |'
- en: '| 7/1/2015 | 284.649994 |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 2015/7/1 | 284.649994 |'
- en: 'Table 11.1 – Segment of the BTC-USD time series (source: Yahoo Finance)'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 表 11.1 – BTC-USD 时间序列片段（来源：Yahoo Finance）
- en: 'As we analyze time series data, we can identify patterns, trends, and fluctuations.
    These patterns may reveal recurring themes, follow a clear trajectory, or exhibit
    chaotic and unpredictable behavior. Here follows a visualization of the time series
    of the BTC price since 2015:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们分析时间序列数据时，可以识别模式、趋势和波动。这些模式可能揭示反复出现的主题，遵循清晰的轨迹，或者表现出混乱和不可预测的行为。以下是自2015年以来
    BTC 价格的时间序列可视化：
- en: '![Figure 11.1 – Plot of the entire series](img/B19446_11_01.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.1 – 整个系列的图示](img/B19446_11_01.jpg)'
- en: Figure 11.1 – Plot of the entire series
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.1 – 整个系列的图示
- en: 'A time series comprises the following components:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列包括以下组成部分：
- en: '**Trend**: This represents the overall directional movement of the series.
    A trend can be deterministic, driven by an underlying rationale, or stochastic,
    exhibiting random behavior.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**趋势**：这代表系列的整体方向性运动。趋势可以是确定性的，由潜在的理由驱动，或者是随机的，表现出随机行为。'
- en: 'In the next example, we observe a continuous upward trend since 2017, which
    has accelerated in the past 2 years:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个例子中，我们观察到自2017年以来的持续上升趋势，并且在过去2年中加速：
- en: '![Figure 11.2: Graph of trend](img/B19446_11_02.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.2：趋势图](img/B19446_11_02.jpg)'
- en: 'Figure 11.2: Graph of trend'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.2：趋势图
- en: '**Seasonal**: This component refers to recurring cycles or patterns within
    the series that repeat over a specific timeframe.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**季节性**：这部分指的是系列中在特定时间框架内重复出现的周期或模式。'
- en: 'In the given dataset, we can observe a drop mid-year and an increase toward
    the end of each year:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在给定的数据集中，我们可以观察到每年中期的下降和年末的增长：
- en: '![Figure 11.3 – Seasonal component](img/B19446_11_03.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.3 – 季节性成分](img/B19446_11_03.jpg)'
- en: Figure 11.3 – Seasonal component
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.3 – 季节性成分
- en: '**White noise**: This represents the component of the series that is not captured
    by the trend or seasonal components.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**白噪声**：这表示系列中未被趋势或季节性成分捕获的部分。'
- en: 'In the given dataset, the component appears flat initially but exhibits peaks
    at specific points coinciding with peaks in the overall series, such as at the
    end of 2017-2018 and 2021:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在给定的数据集中，该成分最初看起来是平坦的，但在特定点呈现出高峰，如2017-2018年末和2021年：
- en: '![Figure 11.4 – White noise representation](img/B19446_11_04.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.4 – 白噪声表示](img/B19446_11_04.jpg)'
- en: Figure 11.4 – White noise representation
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.4 – 白噪声表示
- en: 'To decompose a time series in order to analyze its components, we can use the
    following code:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 为了分解时间序列以分析其成分，我们可以使用以下代码：
- en: '[PRE3]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'There are two additional concepts relevant to time series analysis: autocorrelation
    and stationarity.'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析中还有两个相关概念：自相关和平稳性。
- en: '**Autocorrelation**: This refers to the dependence between consecutive points
    in a series. It indicates that the value at a given time period is influenced
    by the measurements at previous time periods. The order of autoregression represents
    the number of previous values used to predict the present value, known as the
    *lag*. For instance, if we use the previous 2 months’ prices to predict the monthly
    price of Bitcoin, it corresponds to an autocorrelation of order 2.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '**自相关**：这指的是序列中连续点之间的依赖关系。它表明给定时间段的值受先前时间段的测量影响。自回归的顺序表示用于预测当前值的先前值数量，称为*滞后*。例如，如果我们使用前2个月的价格来预测比特币的月均价，这对应于滞后为2的自相关。'
- en: '**Stationary**: A time series is said to be stationary if “*the mean and the
    variance do not depend on time, and the covariance between any two observations
    only depend on the distance between them, but not on a specific location in time*”
    (*Luis Alberiko Gil-Alaña*). Stationarity is an important assumption for many
    time series models and analyses. We can derive from the previous citation that
    a time series that has a trend or seasonality cannot be considered stationary.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '**平稳**：如果“*均值和方差不依赖于时间，并且任何两个观测值之间的协方差仅取决于它们之间的距离，而不取决于具体的时间位置*”（*Luis Alberiko
    Gil-Alaña*）。对于许多时间序列模型和分析，平稳性是一个重要的假设。我们可以从前述引用中得出结论，具有趋势或季节性的时间序列不能被认为是平稳的。'
- en: 'For example, the following time series example has a clear upward trend, so
    it is not stationary:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，以下时间序列示例明显呈上升趋势，因此不是平稳的：
- en: '![Figure 11.5 – Time series with trend](img/B19446_11_05.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.5 – 带有趋势的时间序列](img/B19446_11_05.jpg)'
- en: Figure 11.5 – Time series with trend
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.5 – 带有趋势的时间序列
- en: 'The following one has an increasing variance as it is progressing in time and
    trend, so it is not stationary:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 以下时间序列随着时间的推移和趋势具有增加的方差，因此不是平稳的：
- en: '![Figure 11.6 – Time series with variance](img/B19446_11_06.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.6 – 方差时间序列](img/B19446_11_06.jpg)'
- en: Figure 11.6 – Time series with variance
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.6 – 方差时间序列
- en: 'The following has no trend or seasonality, so can be considered stationary:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 以下时间序列没有趋势或季节性，因此可以被视为平稳的：
- en: '![Figure 11.7 – Stationary time series](img/B19446_11_07.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.7 – 平稳时间序列](img/B19446_11_07.jpg)'
- en: Figure 11.7 – Stationary time series
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.7 – 平稳时间序列
- en: Now that we have the theory, let’s introduce the dataset.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了理论，让我们介绍数据集。
- en: Exploring the dataset
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索数据集
- en: For price prediction, we will utilize two datasets. The first dataset is the
    time series data of BTC prices, extracted from Yahoo Finance, with a daily granularity.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 对于价格预测，我们将利用两个数据集。第一个数据集是从Yahoo Finance提取的BTC价格时间序列数据，以每日为粒度。
- en: 'To extract it, we use the Yfinance library with the following code:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 为了提取它，我们使用Yfinance库和以下代码：
- en: '[PRE4]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The dataset contains multiple columns, but we will focus on the close column
    and the date. The `date` column needs to be used as an index with a frequency.
    The following code snippet can be useful if not sourcing from Yfinance, which
    already handles it:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 该数据集包含多个列，但我们将重点关注收盘价列和日期列。`date` 列需要作为索引使用，并指定频率。如果数据源不是 Yfinance（它已经处理了这一点），以下代码片段可能会很有帮助：
- en: '[PRE5]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: As a Web3 dataset, compared to traditional financial stock price datasets, it
    includes prices for weekends as well, reflecting the fact that the market operates
    continuously. When selecting a times series dataset, it is essential to ensure
    that there are no missing values or handle them using the appropriate techniques.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 作为 Web3 数据集，相较于传统的金融股票价格数据集，它也包括了周末的价格，反映了市场的连续运营特点。在选择时间序列数据集时，必须确保没有缺失值，或者使用适当的技术处理它们。
- en: 'If it were necessary to work with business days only, the Pandas library has
    some additional functions such as `USFederalHolidayCalendar`, which imports holiday
    calendars and provides a list of holidays:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如果只需要处理工作日，Pandas 库提供了一些额外的函数，比如`USFederalHolidayCalendar`，它导入假期日历并提供假期列表：
- en: '[PRE6]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The `CustomBusinessDay` class provides a parametric `BusinessDay` class that
    can be used to create customized business-day calendars for local holidays and
    local weekend conventions:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '`CustomBusinessDay` 类提供了一个参数化的 `BusinessDay` 类，可用于创建自定义的工作日日历，以适应本地假期和本地周末惯例：'
- en: '[PRE7]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Additionally, we have prepared another dataset consisting of news articles and
    their corresponding **sentiment analysis** (**SA**). For each day in the BTC price
    time series that we aim to model, we will match it with a set of news articles
    and their respective SA. We will test the hypothesis that incorporating external
    information from the real world will improve the prediction performance of the
    model. Other variables that can be considered include trading volume, the number
    of tweets containing the term *BTC*, days remaining until the next halving event
    (when the reward for Bitcoin mining is cut in half, and that takes place approximately
    every 4 years), and more.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们还准备了一个由新闻文章及其对应的**情感分析**（**SA**）组成的数据集。对于我们希望建模的比特币（BTC）价格时间序列中的每一天，我们将其与一组新闻文章及其相应的
    SA 匹配。我们将验证一个假设，即将来自现实世界的外部信息纳入模型中，将提高预测性能。其他可以考虑的变量包括交易量、包含*BTC*一词的推文数量、距下次减半事件（即比特币挖矿奖励减半，每约四年发生一次）的剩余天数等。
- en: During **exploratory data analysis** (**EDA**), it’s possible to discover missing
    values, outliers, or irregularities in the dataset. As discussed in [*Chapter
    1*](B19446_01.xhtml#_idTextAnchor020), there have been instances where market
    prices were halted due to extreme volatility, such as the UST depeg. When faced
    with a dataset containing these issues, how should we address them? Non-time series-specific
    methods, such as mean or median imputation, are effective for stationary series.
    Time series-specific techniques include **Last Observation Carried Forward** (**LOCF**),
    which replaces missing values with the immediately preceding observed value, and
    **Next Observation Carried Backward** (**NOCB**), which performs the same replacement
    with the subsequent observed value. Another method is interpolation, which can
    be linear, polynomial, or spline, depending on the assumed relationship between
    observations. Further resources on potential approaches to resolve this issue
    are provided in the *Further* *reading* section.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在**探索性数据分析**（**EDA**）过程中，可能会发现数据集中的缺失值、异常值或不规则情况。如在[*第一章*](B19446_01.xhtml#_idTextAnchor020)中所讨论，有些时候由于极端波动，市场价格会暂停，例如
    UST 脱钩。在处理包含这些问题的数据集时，我们应如何应对？对于平稳序列，非时间序列特定方法，如均值或中位数插补，是有效的。针对时间序列的特定技术包括**最近观察值前推**（**LOCF**），它用紧接前一个观察值填充缺失值；以及**下一观察值后推**（**NOCB**），它用紧接后一个观察值填充缺失值。另一种方法是插值，根据假定的观察值之间的关系，可以是线性、插值多项式或样条插值。有关解决这一问题的更多方法，参见*进一步阅读*部分。
- en: Before delving into the models, it is important to address the concept of train-test
    split for time series data. Unlike the traditional datasets we have analyzed so
    far, time series models inherently possess an endogenous temporality, which is
    precisely what we aim to capture. This means that the value’s position in the
    time series order will have an impact on future points. In order to understand
    and capture this temporal relationship, we must maintain the chronological order
    of the time series and any exogenous variables. Randomly splitting the data is
    not suitable for time series analysis.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在深入研究模型之前，重要的是要解决时间序列数据的训练-测试集拆分概念。与我们迄今为止分析的传统数据集不同，时间序列模型本质上具有内生的时间性，这正是我们希望捕捉的内容。这意味着，值在时间序列中的位置将对未来的点产生影响。为了理解并捕捉这种时间关系，我们必须保持时间序列及任何外生变量的时间顺序。随机拆分数据不适用于时间序列分析。
- en: In this case, the test dataset will consist of the most recent portion of the
    series, while the training dataset will include all rows from the beginning of
    the series up to the selected test portion.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，测试数据集将由序列中最新的部分组成，而训练数据集将包括从序列开始到所选测试部分的所有行。
- en: 'Sklearn provides a helpful class for performing this split, called `TimeSeriesSplit`:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Sklearn提供了一个有用的类来执行这种拆分，叫做`TimeSeriesSplit`：
- en: '[PRE8]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The documentation can be found at the following link:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 文档可以在以下链接中找到：
- en: '[https://scikitlearn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.xhtml](https://scikitlearn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.xhtml)'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://scikitlearn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.xhtml](https://scikitlearn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.xhtml)'
- en: The challenge we will try to solve consists of predicting the BTC price on dates
    that were not part of the training. Time series problems can be approached by
    using statistical modeling, which we will call the traditional method, and through
    ML, whereby we will train a **long short-term memory** (**LSTM**) model.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 我们尝试解决的挑战是预测那些不包含在训练中的日期的BTC价格。时间序列问题可以通过使用统计建模来处理，我们将其称为传统方法，也可以通过机器学习来处理，在这种方法中我们将训练一个**长短期记忆**（**LSTM**）模型。
- en: Discussing traditional pipelines
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 讨论传统的数据处理管道
- en: 'The initial approach involves statistical modeling, using models such as ARIMA,
    **ARIMA with exogenous variables** (**ARIMAX**), and Auto ARIMA. To work with
    them, we need to address two additional challenges: ensuring the stationarity
    of the time series and determining the appropriate model order.'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 初步的方法涉及统计建模，使用像ARIMA、**带外生变量的ARIMA**（**ARIMAX**）和自动ARIMA等模型。为了使用这些模型，我们需要解决两个额外的挑战：确保时间序列的平稳性和确定合适的模型阶数。
- en: Statistical models perform better when applied to stationary time series. Traditional
    statistical time series models such as ARIMA are more effective when dealing with
    stationary time series. Resolving this issue will be part of the preprocessing
    phase.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 统计模型在应用于平稳时间序列时表现更好。像ARIMA这样的传统统计时间序列模型在处理平稳时间序列时更为有效。解决这个问题将是预处理阶段的一部分。
- en: The second challenge lies in the modeling phase, which involves understanding
    the dataset, determining the appropriate lags, and defining time windows. We will
    approach the solution manually using the Auto ARIMA algorithm, which handles hyperparameters
    automatically.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个挑战出现在建模阶段，这涉及理解数据集、确定合适的滞后和定义时间窗口。我们将使用Auto ARIMA算法手动接近解决方案，它会自动处理超参数。
- en: Preprocessing
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据预处理
- en: Various functions can be employed to transform non-stationary time series data
    into a format suitable for our models. Examples include differencing, logarithmic
    transformations, **moving averages** (**MAs**), percent changes, lags, and cumulative
    sums.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 可以采用多种函数将非平稳时间序列数据转换为适合我们模型的格式。例如，差分、对数变换、**移动平均**（**MAs**）、百分比变化、滞后和累积和等。
- en: Differencing calculates the differences between consecutive observations. This
    technique helps stabilize the mean of a time series by removing changes at a certain
    level, thereby reducing or eliminating trend and seasonality.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 差分计算连续观测值之间的差异。这个技术通过去除某个水平的变化来帮助稳定时间序列的均值，从而减少或消除趋势和季节性。
- en: 'In the `Traditional time series models.ipynb` notebook, we start with a dataset
    that looks like this:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 在`Traditional time series models.ipynb`笔记本中，我们从一个看起来像这样的数据集开始：
- en: '![Figure 11.8 – Complete time series](img/B19446_11_08.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![图11.8 – 完整时间序列](img/B19446_11_08.jpg)'
- en: Figure 11.8 – Complete time series
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.8 – 完整时间序列
- en: 'To apply differencing, we use the following code:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 为了应用差分，我们可以使用以下代码：
- en: '[PRE9]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'After such a process, the dataset is transformed as follows:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 经过这样的处理，数据集转换如下：
- en: '![Figure 11.9 – Differenced time series](img/B19446_11_09.jpg)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.9 – 差分时间序列](img/B19446_11_09.jpg)'
- en: Figure 11.9 – Differenced time series
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.9 – 差分时间序列
- en: In some cases, differencing the data once may not result in a stationary series.
    In such instances, it may be necessary to apply differencing a second time to
    achieve stationarity.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，仅进行一次差分可能无法使序列变为平稳。在这种情况下，可能需要进行第二次差分以实现平稳。
- en: Other functions such as percent change, log difference, and MA can also help
    reduce trend and seasonality, making the series resemble white noise. Log transformation
    is particularly useful when dealing with non-constant variance, while MA can be
    beneficial for series with high volatility.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 其他函数，如百分比变化、对数差分和MA，也可以帮助减少趋势和季节性，使序列更像白噪声。对数变换在处理非恒定方差时尤其有用，而MA对于波动性较高的序列也有益。
- en: To help determine if a series is stationary, we can employ statistical tests
    such as the Dickey-Fuller test. This test is a root-based test that focuses on
    the coefficient associated with the first lag of the time series variable. If
    the coefficient is equal to one (indicating a unit root), the time series behaves
    as non-stationary, which is the null hypothesis. We reject the null hypothesis
    if the test result is negative and statistically significant, indicating that
    the time series is stationary. There are other tests for similar purposes, such
    as the **Kwiatkowski-Phillips-Schmidt-Shin** (**KPSS**) test or the Phillips-Perron
    test. An explanation exceeds the scope of this book; however, all of them can
    be sourced from the same library we have been working on. Once we have a stationary
    dataset, we can proceed to modeling.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助判断一个序列是否平稳，我们可以使用统计检验方法，如迪基-富勒检验。该检验是基于根的检验，重点关注与时间序列变量第一阶滞后相关的系数。如果该系数等于1（表示单位根），则该时间序列表现为非平稳，即原假设。如果检验结果为负且具有统计学显著性，我们拒绝原假设，表明该时间序列是平稳的。还有其他类似的检验方法，如**Kwiatkowski-Phillips-Schmidt-Shin**（**KPSS**）检验或Phillips-Perron检验。由于解释超出了本书的范围，但它们都可以从我们使用的同一库中获得。一旦我们获得了平稳的数据集，就可以开始建模。
- en: Modeling – ARIMA/SARIMAX and Auto ARIMA
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 建模 – ARIMA/SARIMAX 和 Auto ARIMA
- en: Among statistical algorithms used for forecasting future values, we encounter
    ARIMA /SARIMAX and Auto ARIMA. ARIMA considers past values to predict future values,
    while SARIMAX incorporates seasonality patterns and exogenous variables. Auto
    ARIMA automates the modeling process based on training data.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在用于预测未来值的统计算法中，我们遇到了ARIMA/SARIMAX和Auto ARIMA。ARIMA考虑过去的值来预测未来的值，而SARIMAX则结合了季节性模式和外生变量。Auto
    ARIMA则基于训练数据自动化建模过程。
- en: The names of these models are derived from the concepts they comprise. **ARIMA**
    stands for **autoregressive** (**AR**)-**integrated** (**I**)-**moving average**
    (**MA**). **SARIMAX** adds **S** for **seasonal** and **X** for **exogenous**
    as it can be fed with independent variables. **Auto ARIMA** adds **Auto** for
    **automatic modeling**. Let’s delve into these concepts.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 这些模型的名称源自其包含的概念。**ARIMA**代表**自回归**（**AR**）-**差分**（**I**）-**移动平均**（**MA**）。**SARIMAX**在此基础上增加了**S**，表示**季节性**，以及**X**，表示**外生性**，因为它可以输入独立变量。**Auto
    ARIMA**则在**Auto**（自动建模）前缀的基础上进一步简化了建模过程。让我们深入探讨这些概念。
- en: '**AR** identifies the regression order of the time series onto itself. It assumes
    that the latest data point value depends on previous values with a lag that we
    determine; that is, *the number of* *lag observations*.'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '**AR**确定时间序列自身的回归阶数。它假设最新的数据点值依赖于前一个值，并且该依赖关系具有我们确定的滞后数，即*滞后观测数*。'
- en: 'We can determine the regression order by using the PACF plot, which is part
    of the `statsmodels` library. The following code can be used to plot it:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过使用PACF图来确定回归阶数，该图是`statsmodels`库的一部分。以下代码可用于绘制该图：
- en: '[PRE10]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The PACF measures the direct correlation between past values and current values
    and examines the spikes at each lag to determine their significance. A significant
    spike extends beyond significant limits, indicating that the correlation for that
    lag is not zero. The number of significant correlations determines the order of
    the AR term (p).
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: PACF衡量过去值与当前值之间的直接相关性，并检查每个滞后的尖峰以确定其显著性。如果某个滞后的尖峰超出了显著性限制，则表明该滞后的相关性不为零。显著相关性的数量决定了AR项（p）的阶数。
- en: '**I** identifies the number of differencing procedures required to make the
    series stationary.'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '**I** 表示使序列平稳所需的差分次数。'
- en: '**MA** models the error of the time series based on past forecast errors, assuming
    that the current error depends on the previous error with a lag that we determine.
    In essence, this corresponds to the size of the “window” function over our time
    series data and corresponds to the MA (*q*) part of the model. We can approach
    the order of q by examining the autocorrelation plot (ACF).'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '**MA** 根据过去的预测误差来建模时间序列的误差，假设当前误差依赖于先前的误差，并且具有我们确定的滞后。这本质上对应于时间序列数据上“窗口”函数的大小，并且对应于模型中的
    MA (*q*) 部分。我们可以通过检查自相关图 (ACF) 来确定 q 的阶数。'
- en: The ACF shows whether the elements of a time series are positively correlated,
    negatively correlated, or independent of each other. The horizontal axis shows
    the lags and the spikes show how relevantly correlated such lags are. We consider
    an ACF of order q based on statistically significant spikes that are far from
    zero.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: ACF 展示了时间序列元素之间是正相关、负相关，还是相互独立的。横轴表示滞后值，尖峰显示了这些滞后值的相关性程度。我们根据远离零的统计显著尖峰，考虑一个阶数为
    q 的 ACF。
- en: 'To plot the ACF, we can use the following code, utilizing the `statsmodels`
    library:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 为了绘制 ACF，我们可以使用以下代码，利用 `statsmodels` 库：
- en: '[PRE11]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Here is a rule of thumb to start testing models:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是开始测试模型的一个经验法则：
- en: 'If the PACF has a significant spike at lag p, but not beyond, and the ACF plot
    decays more gradually, we will use the following order for the model: ARIMA (p,d,0):'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 PACF 在滞后 p 处有显著尖峰但之后没有，并且 ACF 图呈现更渐进的衰减，我们将为模型使用以下阶数：ARIMA (p,d,0)：
- en: '![Figure 11.10 – Hypothesis 1](img/B19446_11_10.jpg)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.10 – 假设 1](img/B19446_11_10.jpg)'
- en: Figure 11.10 – Hypothesis 1
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.10 – 假设 1
- en: 'If the ACF plot has a significant spike at lag q but not beyond and the PACF
    plot decays more gradually, we will use the following order for the model: ARIMA
    (0,d,q):'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 如果 ACF 图在滞后 q 处有显著尖峰但之后没有，并且 PACF 图呈现出更渐进的衰减，我们将为模型使用以下阶数：ARIMA (0,d,q)：
- en: '![Figure 11.11 – Hypothesis 2](img/B19446_11_11.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.11 – 假设 2](img/B19446_11_11.jpg)'
- en: Figure 11.11 – Hypothesis 2
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.11 – 假设 2
- en: '`m` period of time. It will be modeled in a similar way as the time series.
    The specifics of the seasonal component of SARIMA are highlighted as follows:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '`m` 表示时间周期。它将以类似时间序列的方式建模。SARIMA 的季节性组件的具体内容如下：'
- en: '`SARIMA(p,d,q)`**(P,D,Q)[m]**'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '`SARIMA(p,d,q)`**(P,D,Q)[m]**'
- en: 'The components are defined as follows:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 组件定义如下：
- en: '`P`: Seasonal AR order.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`P`：季节性 AR 阶数。'
- en: '`D`: Seasonal difference order.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`D`：季节性差分阶数。'
- en: '`Q`: Seasonal MA order.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Q`：季节性 MA 阶数。'
- en: '`m`: The number of time steps for a single seasonal period. To get this number,
    it is useful to decompose similar periods of time that we want to predict (always
    from the training dataset) to spot the seasonality. In the case under analysis,
    we see a seasonality of 8 days.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`m`：单个季节性周期的时间步数。为了得到这个数字，通常需要分解我们希望预测的相似时间段（始终使用训练数据集）以观察季节性。在此分析中，我们看到季节性为
    8 天。'
- en: To evaluate the model, we utilize a traditional regression metric known as **root
    mean squared error** (**RMSE**). RMSE is a statistical measure employed to assess
    the accuracy of a model’s predictions by calculating the square root of the **mean
    squared error** (**MSE**). MSE is the average of the squared differences between
    the original and predicted values. RMSE yields a single, easily interpretable
    value that represents the typical magnitude of errors made by a predictive model.
    A lower RMSE indicates a better fit between predicted and actual values, reflecting
    a more accurate predictive model. Another related metric is **mean absolute error**
    (**MAE**), which represents the average of the absolute differences between the
    actual and predicted values in the dataset.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估模型，我们采用一种传统的回归指标——**均方根误差** (**RMSE**)。RMSE 是一种统计度量，用于评估模型预测准确性，方法是计算 **均方误差**
    (**MSE**) 的平方根。MSE 是原始值与预测值之间平方差的平均值。RMSE 产生一个单一、易于解释的值，代表预测模型误差的典型大小。较低的 RMSE
    表示预测值与实际值之间的拟合度更好，反映了模型的预测更为准确。另一个相关指标是 **平均绝对误差** (**MAE**)，它表示数据集中实际值与预测值之间绝对差值的平均值。
- en: RMSE is widely favored for comparing the performance of regression models, particularly
    because it is expressed in the same units as the dependent variable, facilitating
    a straightforward interpretation.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: RMSE 被广泛用于比较回归模型的性能，特别是因为它与因变量的单位相同，从而使得结果更容易解释。
- en: In the Jupyter notebook, we can observe that the model can be further improved.
    The result of the manual modeling is an RMSE value of `0.073`.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Jupyter 笔记本中，我们可以观察到模型还可以进一步改进。手动建模的结果是 RMSE 值为 `0.073`。
- en: Auto ARIMA
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Auto ARIMA
- en: Auto ARIMA handles the task of tuning hyperparameters very well. It automatically
    generates the optimal values for the parameters (`p`,`d`, and `q`).
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: Auto ARIMA 很好地处理了超参数调优任务。它会自动生成参数（`p`，`d`，`q`）的最优值。
- en: The metric named the **Akaike information criterion** (**AIC**), useful in selecting
    predictors for regression, is used to determine the order of an ARIMA model. Particularly,
    the Auto ARIMA model iterates during the fitting process to find the best combination
    of parameters that minimizes the AIC. According to the documentation, it functions
    *like a grid search*, trying different sets of p and q parameters. For the differencing
    terms, Auto ARIMA utilizes a test of stationarity, such as an augmented Dickey-Fuller
    test, and considers seasonality.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 被称为**赤池信息量准则**（**AIC**）的度量，用于选择回归模型的预测变量，用来确定 ARIMA 模型的阶数。特别地，Auto ARIMA 模型在拟合过程中通过迭代来寻找能最小化
    AIC 的最佳参数组合。根据文档，它*类似于网格搜索*，尝试不同的 p 和 q 参数组合。对于差分项，Auto ARIMA 使用如扩展的迪基-富勒（Augmented
    Dickey-Fuller）检验等平稳性检验，并考虑季节性。
- en: 'This approach significantly improves our model, saving time and reducing human
    errors. To implement it, we can use the following code:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法显著改善了我们的模型，节省了时间并减少了人为错误。为了实现它，我们可以使用以下代码：
- en: '[PRE12]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The parameters passed are as follows:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 传入的参数如下：
- en: '`training_data`: This is the time series data we want to model.'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`training_data`：这是我们希望建模的时间序列数据。'
- en: '`stepwise`: A Boolean parameter that controls whether the function should perform
    a stepwise search for the best ARIMA model. If set to `True`, the function will
    perform a stepwise search (that is, it will iteratively consider adding or removing
    AR, MA, or I components). If set to `False`, the function will search for the
    best ARIMA model using an exhaustive search over possible combinations, similar
    to a grid search. A stepwise search is faster but may not always find the best
    model.'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`stepwise`：一个布尔参数，控制函数是否应执行逐步搜索以找到最佳 ARIMA 模型。如果设置为 `True`，函数将执行逐步搜索（即，它将迭代考虑添加或删除
    AR、MA 或 I 组件）。如果设置为 `False`，函数将通过对所有可能组合进行穷举搜索来查找最佳 ARIMA 模型，类似于网格搜索。逐步搜索较快，但可能并不总是能找到最佳模型。'
- en: '`seasonal`: A Boolean parameter that specifies whether the model should include
    seasonal components (for example, SARIMA). If set to `True`, the function will
    search for seasonal patterns in the data. If set to `False`, it will only consider
    non-seasonal ARIMA models.'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`seasonal`：一个布尔参数，指定模型是否应包括季节性成分（例如 SARIMA）。如果设置为 `True`，该函数将搜索数据中的季节性模式。如果设置为
    `False`，则仅考虑非季节性的 ARIMA 模型。'
- en: '`n_jobs`: This parameter controls the number of CPU cores to use when performing
    the model search. Setting it to `-1` means using all available CPU cores, which
    can speed up the search process, especially when we have a large dataset.'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`n_jobs`：该参数控制在执行模型搜索时使用的 CPU 核心数。将其设置为`-1`表示使用所有可用的 CPU 核心，这可以加快搜索过程，尤其是在数据集较大的时候。'
- en: '`trace`: This is a debugging parameter. When set to `True`, it enables verbose
    output, which includes diagnostic information and intermediate results during
    the model search.'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`trace`：这是一个调试参数。当设置为 `True` 时，它启用详细输出，包含诊断信息和模型搜索过程中的中间结果。'
- en: After implementing this model, the RMSE decreases substantially; however, it
    has room for improvement. Now, let’s look at incorporating a specific domain or
    subject-matter knowledge.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 实现该模型后，RMSE 显著下降；然而，仍有改进空间。现在，让我们看看如何融入特定领域或主题知识。
- en: Adding exogenous variables
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加外生变量
- en: Exogenous variables are additional pieces of information that can be included
    in our models. These variables can originate from the same time series, such as
    observing BTC price increases at specific hours or days, or they can be completely
    exogenous, such as SA of news or derived from X (formerly Twitter).
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 外生变量是可以被纳入模型的附加信息。这些变量可以来自相同的时间序列，比如观察 BTC 价格在特定小时或日期的波动，或者它们可以是完全外生的，如新闻情感分析或来自
    X（前 Twitter）的数据。
- en: 'In our notebook, we incorporate the sentiment of the news of each day as an
    exogenous variable. The preprocessing of such a dataset includes the following:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的笔记本中，我们将每天新闻的情感作为外生变量纳入模型。该数据集的预处理包括以下内容：
- en: 'Mapping the sentiment of the news according to the `sentiment_mapping` dictionary
    to the following criteria:'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据 `sentiment_mapping` 字典将新闻情绪映射到以下标准：
- en: '[PRE13]'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: outliers = day_sentiment_df[z_scores > threshold]
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: outliers = day_sentiment_df[z_scores > threshold]
- en: outliers['sentiment_number'] = outliers['sentiment_number'] * 2
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: outliers['sentiment_number'] = outliers['sentiment_number'] * 2
- en: day_sentiment_df.update(outliers)
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: day_sentiment_df.update(outliers)
- en: '[PRE14]'
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Both decisions in *steps 1* and *2* are arbitrary decisions of the data scientist
    and look to reflect in the data the fact that the crypto market tends to overreact
    to news, whether positive, negative, or neutral.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '*步骤 1* 和 *步骤 2* 中的两个决策是数据科学家的任意决定，旨在反映加密市场通常会对新闻产生过度反应，无论是正面、负面还是中性新闻。'
- en: 'By applying the exogenous variable, ARIMAX and Auto ARIMA models show a decreased
    RMSE compared to their versions without exogenous variables, which is very positive:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 通过应用外生变量，ARIMAX 和 Auto ARIMA 模型显示出相较于不使用外生变量的版本，RMSE 下降，这是非常积极的：
- en: '`rmse -` `manual: 0.046`'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`rmse -` `manual: 0.046`'
- en: '`rmse -` `auto: 0.062`'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`rmse -` `auto: 0.062`'
- en: We see that the manual tuning of the model outperforms the Auto ARIMA model
    when adding the exogenous variable.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到，当加入外生变量时，手动调整模型的表现优于 Auto ARIMA 模型。
- en: 'To compare the performance of these models with the LSTM, we can compare RMSE
    metrics or reverse the results with the following code in order to compare USD
    prices. To reverse from logs, we can use this code snippet:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 为了比较这些模型与 LSTM 的性能，我们可以比较 RMSE 指标，或者使用以下代码反转结果，以便比较 USD 价格。要从对数转换中反转，我们可以使用以下代码片段：
- en: '[PRE15]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: We have now reviewed the statistic model, so we proceed to build a DL model.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经回顾了统计模型，现在我们继续构建深度学习（DL）模型。
- en: Using a neural network – LSTM
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用神经网络 – LSTM
- en: We explained in detail how LSTM works in [*Chapter 8*](B19446_08.xhtml#_idTextAnchor250).
    Briefly, LSTM serves as a specialized form of **recurrent neural network** (**RNN**)
    designed to detect patterns in data sequences. Its distinct feature lies in its
    capacity to preserve information over extended periods compared to conventional
    RNNs. LSTM overcomes this short-term memory problem by selectively retaining relevant
    information.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在[*第8章*](B19446_08.xhtml#_idTextAnchor250)中详细解释了 LSTM 的工作原理。简而言之，LSTM 是一种专门设计用来检测数据序列中模式的**递归神经网络**（**RNN**）。它的独特之处在于，相比于传统的
    RNN，LSTM 可以在较长时间内保留信息。LSTM 通过选择性地保留相关信息来克服短期记忆问题。
- en: Preprocessing
  id: totrans-171
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据预处理
- en: 'We will treat the problem as a **supervised learning** (**SL**) task. For that
    purpose, we will modify the training set as follows:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把这个问题视为**监督学习**（**SL**）任务。为此，我们将修改训练集，具体方法如下：
- en: Scale the dataset using the `MinMaxScaler()`.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `MinMaxScaler()` 缩放数据集。
- en: 'Iterate through the scaled dataset and retrieve the 60 days previous to the
    current price (`y_train)` and convert them into features for each price. The result
    will be a training dataset with 60 price columns as `x_train` features for each
    BTC price (`y_train`). In summary, for each data point that the model learns,
    it refers to the previous 60 days in `x_train`:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 遍历缩放后的数据集，并提取当前价格（`y_train`）之前的 60 天数据，将其转换为每个价格的特征。结果将是一个训练数据集，其中有 60 个价格列作为每个
    BTC 价格（`y_train`）的 `x_train` 特征。总之，对于模型学习的每个数据点，它参考的是 `x_train` 中的前 60 天数据：
- en: '![Figure 11.12 – Structure of the training dataset](img/B19446_11_12.jpg)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.12 – 训练数据集结构](img/B19446_11_12.jpg)'
- en: Figure 11.12 – Structure of the training dataset
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.12 – 训练数据集结构
- en: We use the previous 60 days as input variables for each day considered as an
    output variable.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用之前的 60 天作为每一天的输入变量，将其视为输出变量。
- en: Model building
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型构建
- en: To build the model, we will leverage the Keras library. For that, we add to
    the model two LSTM layers with 50 neurons each, the first one with the input shape
    of our dataset.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 为了构建模型，我们将利用 Keras 库。为此，我们为模型添加了两层 LSTM，每层 50 个神经元，第一层的输入形状为我们的数据集。
- en: 'We also add two dense layers with 25 and 1 neurons each. The structure of the
    model should be kept as simple as possible and is totally modifiable:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还添加了两层全连接层，每层分别有 25 和 1 个神经元。模型结构应保持尽可能简单，并且完全可以修改：
- en: '[PRE16]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'We will later compile with the Adam optimizer and choose `mean_squared_error`
    as the loss metric:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 我们稍后会使用 Adam 优化器进行编译，并选择 `mean_squared_error` 作为损失度量：
- en: '[PRE17]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'To save the callbacks, in order to analyze the results of our training, we
    set up the TensorBoard tool to read from a new folder that saves the logs:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保存回调，以便分析我们训练的结果，我们设置了 TensorBoard 工具，从一个新的文件夹中读取保存的日志：
- en: '[PRE18]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Training and evaluation
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 训练与评估
- en: 'We train our model with a batch size of 10 and 35 epochs:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 我们用批量大小为 10 和 35 个 epoch 来训练我们的模型：
- en: '[PRE19]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: To evaluate how well the model predicts, we will build a new dataset with data
    from the last 30 days that has not been passed to the model. To do that, we need
    to follow the same steps that we executed for the training dataset in the *Preprocessing*
    section. We turn 60 rows into columns in `x_test` that become features of the
    61st value that becomes `y` or the value to be predicted (`y_test`).
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估模型的预测效果，我们将构建一个包含过去30天数据的新数据集，这些数据未曾传递给模型。为此，我们需要遵循与*数据预处理*部分中训练数据集相同的步骤。我们将60行数据转化为`x_test`中的列，这些列成为第61个值的特征，该值即为要预测的`y`（或`y_test`）。
- en: 'For the prediction, we will only consider the last 30 days and calculate the
    RMSE between the predicted values and the `y_test` values. To do that, we can
    use the following code:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在预测时，我们只会考虑最后30天的数据，并计算预测值与`y_test`值之间的RMSE。为此，我们可以使用以下代码：
- en: '[PRE20]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'If we plot the prediction and the ground truth data, the result is not bad.
    Please refer to the `Chapter11/LSTM.ipynb` notebook for a colored version:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们绘制预测值和真实数据的图表，结果还不错。请参阅`Chapter11/LSTM.ipynb`笔记本查看彩色版本：
- en: '![Figure 11.13 – Predicted and ground truth data](img/B19446_11_13.jpg)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![图 11.13 – 预测值和真实数据](img/B19446_11_13.jpg)'
- en: Figure 11.13 – Predicted and ground truth data
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.13 – 预测值和真实数据
- en: A comparison between the RMSE of the models shows that the LSTM approach performs
    better in this environment of high volatility of prices with a $457 error versus
    a $1,283 error of the best ARIMA model.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 对比模型的RMSE显示，在价格高波动的环境中，LSTM方法表现更好，误差为$457，而最好的ARIMA模型误差为$1,283。
- en: 'Some key differences to take into account are as follows:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 需要考虑的一些关键差异如下：
- en: '**Relationship between variables**: ARIMA models assume linear relationships
    between the input and output variables. They can capture some nonlinear patterns,
    but complex nonlinear dependencies present in the data will not be covered. LSTM
    models are better suited for capturing nonlinear relationships and long-term dependencies
    in time series data. This makes LSTM models more suitable for modeling nonlinear
    and sequential data with complex temporal patterns.'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**变量之间的关系**：ARIMA模型假设输入和输出变量之间存在线性关系。它们可以捕捉一些非线性模式，但数据中的复杂非线性依赖关系无法覆盖。LSTM模型更适合捕捉时间序列数据中的非线性关系和长期依赖性。这使得LSTM模型更适合建模具有复杂时间模式的非线性和顺序数据。'
- en: '**Training complexity**: ARIMA models involve estimating parameters such as
    AR, MA, and differencing terms. LSTM models, as with all **neural networks** (**NNs**),
    require more computational resources and training time. They involve training
    multiple layers of recurrent units with a large number of parameters. Training
    DL models typically requires more data and computational power compared to traditional
    statistical models.'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**训练复杂度**：ARIMA模型涉及估计AR、MA和差分项等参数。LSTM模型和所有**神经网络**（**NNs**）一样，需要更多的计算资源和训练时间。它们涉及训练多个递归单元层次，且有大量参数。与传统统计模型相比，训练深度学习（DL）模型通常需要更多的数据和计算能力。'
- en: With the libraries we analyzed, it is possible to examine both methods, compare
    the performance, and evaluate the accuracy of each model.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们分析的库中，可以同时检查这两种方法，比较它们的表现，并评估每个模型的准确性。
- en: Summary
  id: totrans-200
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we explored the analysis of price time series for BTC in a
    market that operates continuously, exhibits high volatility, and can experience
    exaggerated reactions to news events.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了对BTC价格时间序列的分析，适用于一个持续运作、波动性高且可能对新闻事件产生夸张反应的市场。
- en: We began by familiarizing ourselves with the fundamental concepts of time series
    analysis and introduced traditional models such as ARIMA and Auto ARIMA. For our
    use case, we transformed our price dataset into the stationary form and learned
    to apply the models to it. Lastly, we incorporated an exogenous variable such
    as the news into our model. This external information proved to be valuable, contributing
    to a reduction in the error metric we were tracking.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先熟悉了时间序列分析的基本概念，并介绍了传统模型，如ARIMA和Auto ARIMA。对于我们的用例，我们将价格数据集转换为平稳形式，并学习如何将这些模型应用于数据。最后，我们将外部变量（如新闻）纳入模型中。这个外部信息证明是有价值的，有助于减少我们跟踪的误差指标。
- en: Furthermore, we delved into the LSTM model approach, which required us to restructure
    the dataset differently. This involved numerous modifications and adaptations
    to accommodate the specific requirements of the LSTM model, which ultimately performed
    better.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们深入探讨了LSTM模型方法，这要求我们以不同的方式重构数据集。这涉及到对数据集的众多修改和调整，以适应LSTM模型的特定要求，最终取得了更好的表现。
- en: By employing a comprehensive range of techniques and incorporating external
    factors, we have gained valuable insights into analyzing and forecasting token
    price time series. These findings serve as a foundation for further exploration
    and refinement of our models.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 通过采用一系列综合性技术并结合外部因素，我们在分析和预测代币价格时间序列方面获得了宝贵的洞察。这些发现为进一步探索和完善我们的模型奠定了基础。
- en: Further reading
  id: totrans-205
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 深入阅读
- en: 'To complement this chapter, the following links may help:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 为了补充本章内容，以下链接可能对您有所帮助：
- en: '*Time Series Analysis in R Part 2: Time Series Transformations*. (n.d.). An
    online community for showcasing R & Python tutorials. *DataScience+*. [https://datascienceplus.com/time-series-analysis-in-r-part-2-time-series-transformations/](https://datascienceplus.com/time-series-analysis-in-r-part-2-time-series-transformations/)'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*R中的时间序列分析第2部分：时间序列转换*。（无日期）。一个展示R与Python教程的在线社区。*DataScience+*。[https://datascienceplus.com/time-series-analysis-in-r-part-2-time-series-transformations/](https://datascienceplus.com/time-series-analysis-in-r-part-2-time-series-transformations/)'
- en: '*Computer Science*. (*2019*, *December 22*). *Stock Price Prediction Using
    Python & Machine Learning* [Video]. *YouTube*. [https://www.youtube.com/watch?v=QIUxPv5PJOY](https://www.youtube.com/watch?v=QIUxPv5PJOY)'
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*计算机科学*。(*2019年*，*12月22日*)。*使用Python和机器学习进行股票价格预测* [视频]。*YouTube*。[https://www.youtube.com/watch?v=QIUxPv5PJOY](https://www.youtube.com/watch?v=QIUxPv5PJOY)'
- en: '*Luis Alberiko Gil-Alaña*. (*2021*). *Introduction to Time Series* [PDF document].'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Luis Alberiko Gil-Alaña*。(*2021*)。*时间序列导论* [PDF文档]。'
- en: '*Cryptocurrencies and stock market indices. Are they related?* *LA Gil-Alaña*,
    *EJA Abakah*, *MFR Rojo*. *Research in International Business and Finance*, *2020*.
    [http://ddfv.ufv.es/bitstream/handle/10641/2229/cryptocurrencies%20and%20stock%20market%20indices.pdf?sequence=1&isAllowed=y](http://ddfv.ufv.es/bitstream/handle/10641/2229/cryptocurrencies%20and%20stock%20market%20indices.pdf?sequence=1&isAllowed=y)'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*加密货币与股市指数。它们相关吗？* *LA Gil-Alaña*，*EJA Abakah*，*MFR Rojo*。*国际商业与金融研究*，*2020*。[http://ddfv.ufv.es/bitstream/handle/10641/2229/cryptocurrencies%20and%20stock%20market%20indices.pdf?sequence=1&isAllowed=y](http://ddfv.ufv.es/bitstream/handle/10641/2229/cryptocurrencies%20and%20stock%20market%20indices.pdf?sequence=1&isAllowed=y)'
- en: '*Modelling long memory volatility in the Bitcoin market: Evidence of persistence
    and structural breaks*. *E Bouri*, *LA Gil*-*Alaña*, *R Gupta*, *D Roubaud*. *International
    Journal of Finance & Economics*, *2019*. [https://onlinelibrary.wiley.com/doi/abs/10.1002/ijfe.1670](https://onlinelibrary.wiley.com/doi/abs/10.1002/ijfe.1670)'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*比特币市场中的长记忆波动建模：持久性和结构性断裂的证据*。*E Bouri*，*LA Gil-Alaña*，*R Gupta*，*D Roubaud*。*国际金融与经济学杂志*，*2019*。[https://onlinelibrary.wiley.com/doi/abs/10.1002/ijfe.1670](https://onlinelibrary.wiley.com/doi/abs/10.1002/ijfe.1670)'
- en: '*Abulkhair, A.* (*2023*, *June 13*). *Data imputation demystified | Time series
    data*. *Medium*. [https://medium.com/@aaabulkhair/data-imputation-demystified-time-series-data-69bc9c798cb7](mailto:https://medium.com/@aaabulkhair/data-imputation-demystified-time-series-data-69bc9c798cb7)'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Abulkhair, A.* (*2023年*，*6月13日*)。*数据插补揭秘 | 时间序列数据*。*Medium*。[https://medium.com/@aaabulkhair/data-imputation-demystified-time-series-data-69bc9c798cb7](mailto:https://medium.com/@aaabulkhair/data-imputation-demystified-time-series-data-69bc9c798cb7)'
- en: '*Jingjuewang*. (*2017*, *December 11*). *Handle Missing Values in Time Series
    For Beginners*. *Kaggle: Your Machine Learning and Data Science* *Community*.
    [https://www.kaggle.com/code/juejuewang/handle-missing-values-in-time-series-for-beginners](https://www.kaggle.com/code/juejuewang/handle-missing-values-in-time-series-for-beginners)'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Jingjuewang*。(*2017年*，*12月11日*)。*初学者处理时间序列中的缺失值*。*Kaggle：你的机器学习与数据科学社区*。[https://www.kaggle.com/code/juejuewang/handle-missing-values-in-time-series-for-beginners](https://www.kaggle.com/code/juejuewang/handle-missing-values-in-time-series-for-beginners)'
- en: '*Aldean, A. S.* (*2023*, *June 29*). *Time Series Data Interpolation*. *Medium*.
    [https://medium.com/@aseafaldean/time-series-data-interpolation-e4296664b86](mailto:https://medium.com/@aseafaldean/time-series-data-interpolation-e4296664b86)'
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Aldean, A. S.* (*2023年*，*6月29日*)。*时间序列数据插值*。*Medium*。[https://medium.com/@aseafaldean/time-series-data-interpolation-e4296664b86](mailto:https://medium.com/@aseafaldean/time-series-data-interpolation-e4296664b86)'
- en: '*Holloway, N*. (*2019*, *March 16*). *Seasonality and SARIMAX*. *Kaggle: Your
    Machine Learning and Data Science* *Community*. [https://www.kaggle.com/code/nholloway/seasonality-and-sarimax](https://www.kaggle.com/code/nholloway/seasonality-and-sarimax)'
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Holloway, N*. (*2019*, *March 16*). *季节性和SARIMAX*. *Kaggle: 你的机器学习与数据科学* *社区*.
    [https://www.kaggle.com/code/nholloway/seasonality-and-sarimax](https://www.kaggle.com/code/nholloway/seasonality-and-sarimax)'
- en: '*Brownlee, J*. (*2020*, *December*). *Understand Time Series Forecast Uncertainty
    Using Prediction Intervals with Python*. *Machine Learning* *Mastery*. [https://machinelearningmastery.com/time-series-forecast-uncertainty-using-confidence-intervals-python/](https://machinelearningmastery.com/time-series-forecast-uncertainty-using-confidence-intervals-python/)'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Brownlee, J*. (*2020*, *December*). *使用Python的预测区间理解时间序列预测不确定性*. *机器学习* *精通*.
    [https://machinelearningmastery.com/time-series-forecast-uncertainty-using-confidence-intervals-python/](https://machinelearningmastery.com/time-series-forecast-uncertainty-using-confidence-intervals-python/)'
- en: '*Chugh, A.* (*2022*, *March 16*). *MAE, MSE, RMSE, Coefficient of Determination,
    Adjusted R Squared — Which Metric is Better?* *Medium*. [https://medium.com/analytics-vidhya/mae-mse-rmse-coefficient-of-determination-adjusted-r-squared-which-metric-is-better-cd0326a5697e](https://medium.com/analytics-vidhya/mae-mse-rmse-coefficient-of-determination-adjusted-r-squared-which-metric-is-better-cd0326a5697e)'
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Chugh, A.* (*2022*, *March 16*). *MAE、MSE、RMSE、决定系数、调整后的R平方——哪个指标更好？* *Medium*.
    [https://medium.com/analytics-vidhya/mae-mse-rmse-coefficient-of-determination-adjusted-r-squared-which-metric-is-better-cd0326a5697e](https://medium.com/analytics-vidhya/mae-mse-rmse-coefficient-of-determination-adjusted-r-squared-which-metric-is-better-cd0326a5697e)'
