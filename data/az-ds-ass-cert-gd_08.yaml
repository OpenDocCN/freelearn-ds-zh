- en: '*Chapter 6*: Visual Model Training and Publishing'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第 6 章*：可视化模型训练与发布'
- en: '**Azure Machine Learning** (**AzureML**) Studio offers a designer experience
    when developing a model by allowing you to drag, drop, and configure training
    and inference pipelines. In this chapter, you will get an overview of the designer.
    You will then create a training process. Once you have seen the overall flow that''s
    used with the designer, we will close this chapter by creating an inference pipeline
    and publishing the trained model artifact as a service endpoint.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**Azure 机器学习**（**AzureML**）Studio 提供了一个设计器体验，帮助你在开发模型时通过拖放和配置训练与推理管道。在本章中，你将概览设计器。随后，你将创建一个训练过程。在了解设计器使用的整体流程后，本章将通过创建一个推理管道并将训练好的模型工件发布为服务端点来结束。'
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将覆盖以下主题：
- en: Overview of the designer
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设计器概述
- en: Designing a training process
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设计训练过程
- en: Creating a batch and real-time inference pipeline
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建批量和实时推理管道
- en: Deploying a real-time inference pipeline
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署实时推理管道
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: You will need to have access to an Azure subscription. Within that subscription,
    you will need a `packt-azureml-rg`. In addition, you will need to have either
    a `Contributor` or `Owner` `packt-learning-mlw`, as described in [*Chapter 2*](B16777_02_Final_VK_ePub.xhtml#_idTextAnchor026),
    *Deploying Azure Machine Learning Workspace Resources*.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要拥有 Azure 订阅。在该订阅中，你需要一个`packt-azureml-rg`。此外，你需要有`Contributor`或`Owner`角色的`packt-learning-mlw`，具体如在[*第
    2 章*](B16777_02_Final_VK_ePub.xhtml#_idTextAnchor026)中所述，*部署 Azure 机器学习工作区资源*。
- en: You will also need to have registered `churn-dataset` within your workspace,
    which you created in [*Chapter 5*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072),
    *Letting the Machines Do the Model Training*.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 你还需要在你的工作区中注册`churn-dataset`，该工作区是在[*第 5 章*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072)中创建的，*让机器来进行模型训练*。
- en: Overview of the designer
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设计器概述
- en: 'AzureML Studio offers a graphical designer that allows you to author pipelines
    visually. As per the definition, a pipeline is an independently executable flow
    of subtasks that describes a machine learning task. There are three types of pipelines
    that you can create within the designer:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: AzureML Studio 提供了一个图形化设计器，可以让你以可视化方式创建管道。根据定义，管道是一个可以独立执行的子任务流，描述了一个机器学习任务。在设计器中，你可以创建三种类型的管道：
- en: '**Training pipelines**: These pipelines are used for training models.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**训练管道**：这些管道用于训练模型。'
- en: '**Batch inference pipelines**: These pipelines are used to operationalize pre-trained
    models for batch prediction.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**批量推理管道**：这些管道用于将预训练模型用于批量预测。'
- en: '**Real-time inference pipelines**: These pipelines are used to expose a REST
    API that allows third-party applications to make real-time predictions using pre-trained
    models.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**实时推理管道**：这些管道用于暴露一个 REST API，允许第三方应用程序使用预训练模型进行实时预测。'
- en: To create a batch and a real-time pipeline, you need to author a training pipeline.
    In the following sections, you will learn how to create a training pipeline and
    then produce a batch and real-time pipeline on top of it. In [*Chapter 11*](B16777_11_Final_VK_ePub.xhtml#_idTextAnchor160),
    *Working with Pipelines*, you will learn how to author similar pipelines through
    code.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建批量和实时管道，你需要先编写一个训练管道。在接下来的部分中，你将学习如何创建训练管道，然后在此基础上生成批量和实时管道。在[*第 11 章*](B16777_11_Final_VK_ePub.xhtml#_idTextAnchor160)中，*与管道协作*，你将学习如何通过代码编写类似的管道。
- en: 'To start authoring pipelines, you will need to visit the **Designer** home
    page. Click on the **Designer** menu item to navigate to the home page, as shown
    in the following screenshot:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始编写管道，你需要访问**设计器**主页。点击**设计器**菜单项，导航到主页，如下图所示：
- en: '![Figure 6.1 – Designer home page'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.1 – 设计器主页'
- en: '](img/B16777_06_001.jpg)'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16777_06_001.jpg)'
- en: Figure 6.1 – Designer home page
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.1 – 设计器主页
- en: Next to the **New pipeline +** button, you will see several other buttons with
    different ready-to-use sample pipelines. Please familiarize yourself with these
    samples later. These samples regularly update to show the latest features of the
    designer, and it's a great resource to get started.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在**新建管道 +** 按钮旁边，你将看到几个其他按钮，带有不同的现成示例管道。稍后请熟悉这些示例。为了展示设计器的最新功能，这些示例会定期更新，且它们是一个很好的入门资源。
- en: In this chapter, we will create a new pipeline, starting from scratch. Clicking
    on the **+** button will lead you to the authoring screen/view, which we will
    explore in the next section.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将从零开始创建一个新的管道。点击**+**按钮将带你进入创作视图/屏幕，我们将在下一节中探索这个视图。
- en: The authoring screen/view
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创作视图
- en: 'The main page for building a pipeline with the designer looks as follows:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 使用设计器构建管道的主页面如下所示：
- en: '![Figure 6.2 – AzureML designer authoring view'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '![图6.2 – AzureML设计器创作视图'
- en: '](img/B16777_06_002.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16777_06_002.jpg)'
- en: Figure 6.2 – AzureML designer authoring view
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.2 – AzureML设计器创作视图
- en: 'We will describe the main page user interface here, and the preceding screenshot
    serves as a reference:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在这里描述主页面的用户界面，前面的截图作为参考：
- en: By clicking on the hamburger icon (![](img/1.png)) in the top-left corner, you
    can hide and unhide the AzureML main menu shown in the preceding screenshot as
    number **1**. From now on, we will assume this area is hidden.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过点击左上角的汉堡菜单图标 (![](img/1.png))，你可以隐藏或显示前面截图中标记为**1**的AzureML主菜单。从现在起，我们假设该区域已被隐藏。
- en: In the area labeled number **2**, you can find all the assets you can drop onto
    the canvas, referred to as number **3** in the preceding screenshot. By dropping
    different assets onto the canvas, you can build a pipeline. You will learn more
    about this area in the *Understanding the asset library* section of this chapter.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在标记为**2**的区域，你可以找到所有可以拖放到画布上的资产，这些资产在前面的截图中被标记为**3**。通过将不同的资产拖放到画布上，你可以构建一个管道。你将在本章的*了解资产库*部分深入了解该区域。
- en: On the right-hand area marked as **4**, you will find the settings. This area
    is also referred to as the details page. This view changes depending on what you
    have selected in the canvas. If you have not chosen any asset in the canvas area,
    you will see settings for the pipeline you are building, and you can choose a
    **default compute target** that will run each pipeline step. If you select an
    asset, you will find various configuration options for the specific asset.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在右侧标记为**4**的区域，你将找到设置。这个区域也被称为详情页。此视图会根据你在画布中选择的内容而变化。如果你在画布区域中没有选择任何资产，你将看到你正在构建的管道的设置，并且可以选择一个**默认计算目标**来执行每个管道步骤。如果你选择了一个资产，你将找到该资产的各种配置选项。
- en: Area `test-pipeline`.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 区域`test-pipeline`。
- en: In area **5**, you will also find the **Settings** button (![](img/2.png)).
    With that button, you can hide/unhide the **Settings** area marked as **4** in
    the preceding screenshot. In the same area, you can find additional icons that
    allow you to save or delete the pipeline and **undo, redo, and s****earch** on
    the canvas. The **Selection** tool (![](img/3.png)) is the standard cursor on
    the canvas. Later, when we work on our pipeline, we will switch to the **Hand**
    tool (![](img/4.png)) to move selected parts on the canvas. Click on **Settings**
    to hide area **4** and increase the estate of the canvas.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在区域**5**，你还会找到**设置**按钮 (![](img/2.png))。通过该按钮，你可以隐藏/显示前面截图中标记为**4**的**设置**区域。在同一区域，你还可以找到其他图标，用于保存或删除管道，以及在画布上进行**撤销、重做和搜索**操作。**选择**工具
    (![](img/3.png)) 是画布上的标准光标。稍后，在我们构建管道时，我们将切换到**手型**工具 (![](img/4.png)) 来移动画布上选中的部分。点击**设置**以隐藏区域**4**，并扩大画布区域。
- en: The last area, which is marked as **6** in the previous screenshot, provides
    you with the functionalities to **submit, publish, and c****lone** the pipeline,
    which we will discuss in the *Creating a batch and real-time inference pipeline*
    section.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后一个区域，在前面截图中标记为**6**，提供了**提交、发布和克隆**管道的功能，我们将在*创建批处理和实时推理管道*部分中讨论。
- en: Before moving on to the next section, you will need to configure the **default
    compute target** property used by the pipeline to execute all the steps. Open
    the pipeline settings and select the compute cluster you used in [*Chapter 5*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072),
    *Letting the Machines Do the Model Training*.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续下一节之前，你需要配置管道用于执行所有步骤的**默认计算目标**属性。打开管道设置，并选择你在[*第5章*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072)中使用的计算集群，*让机器进行模型训练*。
- en: In the next section, you will explore the area marked as **2**, also known as
    the *asset library*.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分，你将探索标记为**2**的区域，也被称为*资产库*。
- en: Understanding the asset library
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 了解资产库
- en: 'To build a pipeline, you will need to stitch together various assets. In this
    section, you will look at the different assets available within the asset library
    of the designer. In *Figure 6.2*, we had 96 of them available. This number depends
    on how many datasets you have registered in the AzureML workspace, and in a future
    release of AzureML, you may even be able to create your own coding assets. The
    following diagram shows the categories that are available in the asset library
    and a brief explanation of what type of assets (also referred to as modules) they
    contain:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 要构建管道，你需要将不同的资产拼接在一起。在本节中，你将查看设计器的资产库中可用的不同资产。在*图 6.2*中，我们有96个可用的资产。这个数字取决于你在AzureML工作区中注册了多少数据集，并且在AzureML的未来版本中，你甚至可能能够创建自己的编码资产。下图显示了资产库中可用的类别以及它们包含的资产类型（也称为模块）的简要说明：
- en: '![Figure 6.3 – Categories in the AzureML designer asset library'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.3 – AzureML 设计器资产库中的类别'
- en: '](img/B16777_06_003.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16777_06_003.jpg)'
- en: Figure 6.3 – Categories in the AzureML designer asset library
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.3 – AzureML 设计器资产库中的类别
- en: 'There are three types of assets in this library:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 这个库中有三种类型的资产：
- en: Datasets and modules for manual input
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据集和手动输入的模块
- en: Untrained models
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 未训练的模型
- en: Modules that perform certain operations on the data
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行某些数据操作的模块
- en: You will be dragging and dropping components from this asset library while building
    your first end-to-end machine learning training pipeline in the designer. In the
    next section, you will see what each asset looks like and how you can connect
    various assets between them.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在你构建第一个端到端机器学习训练管道时，你将从这个资产库中拖放组件。在接下来的章节中，你将看到每个资产的外观以及如何在它们之间连接不同的资产。
- en: Exploring the asset's inputs and outputs
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索资产的输入和输出
- en: 'Each asset we drop from the asset library is a module of the pipeline we are
    building. A module looks similar to this sample module shown in the following
    screenshot:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从资产库中拖放的每个资产都是我们正在构建的管道中的一个模块。一个模块看起来类似于以下截图中显示的示例模块：
- en: '![Figure 6.4 – A sample module with two inputs and one output'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.4 – 一个具有两个输入和一个输出的示例模块'
- en: '](img/B16777_06_004.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16777_06_004.jpg)'
- en: Figure 6.4 – A sample module with two inputs and one output
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.4 – 一个具有两个输入和一个输出的示例模块
- en: 'Let''s describe this module from top to bottom:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从上到下描述这个模块：
- en: 'Zero, one, or more input ports at the top: The sample module in the preceding
    screenshot accepts two inputs. You can connect the output of another module to
    the input of the next one.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 顶部有零个、一个或多个输入端口：在前面的截图中，示例模块接受两个输入。你可以将另一个模块的输出连接到下一个模块的输入。
- en: In the middle of the module, the name describes the functionality of the module.
    Our example is a **Train Model** module, which trains an untrained model passed
    in the left input port with the data given in the right input port.
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在模块的中间，模块名称描述了该模块的功能。我们的示例是一个**训练模型**模块，它会使用右侧输入端口给定的数据训练一个从左侧输入端口传入的未训练模型。
- en: If you select the module in the canvas, the module's detail page will appear
    in the area marked as **4** in *Figure 6.2*. This page is different for each module.
    You can configure various options, such as its short description or the compute
    target that will execute the specific module.
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你在画布中选择模块，模块的详情页面将出现在*图 6.2*中标记为**4**的区域。这一页面对于每个模块都是不同的。你可以配置各种选项，如短描述或将执行该特定模块的计算目标。
- en: Under the module name, you can read the description text of that module. You
    can edit this description by selecting the module and editing the text on the
    module's detail page. The module description in our example shows the text **Sample
    Module**.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在模块名称下方，你可以看到该模块的描述文本。你可以通过选择模块并编辑模块详情页面上的文本来修改该描述。在我们的示例中，模块描述显示的是**示例模块**的文本。
- en: At the bottom of the module, there are one or more **output ports** that you
    can drag and connect to the next module.
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在模块的底部，有一个或多个**输出端口**，你可以将它们拖动并连接到下一个模块。
- en: In this section, you explored the various aspects of AzureML Studio's designer.
    In the next section, you will start authoring your first training pipeline.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你已经探索了AzureML Studio设计器的各个方面。在下一节中，你将开始编写你的第一个训练管道。
- en: Building the pipeline with the designer
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用设计器构建管道
- en: In this section, we will create a training pipeline to train a machine learning
    model against the **churn** dataset you used in the previous chapter.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将创建一个训练管道，用于训练在上一章中使用的**客户流失**数据集的机器学习模型。
- en: 'When you start designing a training pipeline, we recommend leveraging the *7
    Steps of Machine Learning* approach shown in the following diagram, which contains
    all the steps needed to create a machine learning model:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 当你开始设计训练流程时，我们建议采用如下图所示的*7步机器学习*方法，它包含了创建机器学习模型所需的所有步骤：
- en: '![Figure 6.5 – 7 Steps of Machine Learning'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.5 – 7步机器学习'
- en: '](img/B16777_06_005.jpg)'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16777_06_005.jpg)'
- en: Figure 6.5 – 7 Steps of Machine Learning
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.5 – 7步机器学习
- en: This 7-step journey is a valuable checklist for real-life end-to-end scenarios
    to ensure you are not missing anything. In this journey, you will need various
    components, transformations, and models, which you can find in the asset library.
    To keep things simple, we will skip a couple of steps in the pipeline that you
    are going to design. In this section, you will start with a dataset that you will
    prepare to train a model. You will then evaluate the model and store it. In the
    next section, you will use that model to create a batch and a real-time pipeline
    that utilize the model to make predictions.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 这7步的旅程是现实场景中的宝贵清单，可以确保你不会遗漏任何步骤。在这个过程中，你将需要各种组件、转换和模型，这些都可以在资产库中找到。为了简化流程，我们将跳过一些你设计的流程中的步骤。在这一节中，你将从准备数据集开始，准备好训练模型。然后，你将评估模型并存储它。在下一节中，你将使用该模型创建批处理和实时流水线，利用模型进行预测。
- en: Let's start by acquiring the data that will be used to train the model, something
    you will do in the next section.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从获取将用于训练模型的数据开始，这将在下一节中进行。
- en: Acquiring the data
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 获取数据
- en: 'The first step is selecting the dataset that you will use to train the model:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是选择你将用于训练模型的数据集：
- en: In the asset library, expand the **Datasets** category by clicking on the arrow
    next to its name. You should see **churn-dataset** there, which you created in
    [*Chapter 5*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072), *Letting the Machines
    Do the Model Training*:![Figure 6.6 – churn-dataset under the Datasets category
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在资产库中，点击**数据集**类别旁的箭头展开。你应该可以看到你在[*第5章*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072)中创建的**流失数据集**，*让机器进行模型训练*：![图
    6.6 – 数据集类别下的流失数据集
- en: '](img/B16777_06_006.jpg)'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_006.jpg)'
- en: Figure 6.6 – churn-dataset under the Datasets category
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.6 – 数据集类别下的流失数据集
- en: Drag **churn-dataset** onto the canvas:![Figure 6.7 – Canvas with churn-dataset
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**流失数据集**拖动到画布上：![图 6.7 – 带有流失数据集的画布
- en: '](img/B16777_06_007.jpg)'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_007.jpg)'
- en: Figure 6.7 – Canvas with churn-dataset
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.7 – 带有流失数据集的画布
- en: With that, you have just completed the **Data collection** step, which means
    you can move on to step number 2 of the *7 Steps of Machine Learning*.
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 到此，你已经完成了**数据收集**步骤，意味着你可以进入*7步机器学习*的第二步。
- en: The next step is **Data preparation**. Add a processing step to the pipeline
    by dragging the **Select Columns in Dataset** module, which can be found under
    the **Data Transformation** category in the asset library, onto the canvas.
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是**数据准备**。通过拖动**选择数据集中的列**模块，将其添加到流程中，该模块可以在资产库中的**数据转换**类别下找到。
- en: You will now need to create a flow between the dataset and the module. You can
    do that by pulling from the dataset's **output port**, the small circle at the
    bottom of this **dataset**, to the dataset's **input port**, the small circle
    at the top of the **Select Columns in Dataset** module, as shown in the following
    screenshot:![Figure 6.8 – Creating a flow between the dataset and the processing
    module
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，你需要在数据集和模块之间创建流程。你可以通过从数据集的**输出端口**（数据集底部的小圆圈）拖动到**选择数据集中的列**模块的**输入端口**（模块顶部的小圆圈）来完成，如下图所示：![图
    6.8 – 在数据集和处理模块之间创建流程
- en: '](img/B16777_06_008.jpg)'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_008.jpg)'
- en: Figure 6.8 – Creating a flow between the dataset and the processing module
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.8 – 在数据集和处理模块之间创建流程
- en: The next step is to configure the **Select Columns in Dataset** module. With
    the module selected in the canvas, click on the **Edit column** link on the details
    pane, which is on the right of the canvas, as shown in the preceding screenshot.
    The **Select columns** dialog will appear. See the following screenshot for the
    final configuration of this popup.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是配置**选择数据集中的列**模块。选择画布上的模块后，点击画布右侧详细信息窗格中的**编辑列**链接，如上图所示。**选择列**对话框将会出现。参见以下截图，了解该弹出窗口的最终配置。
- en: In that popup, select **All columns** from the dropdown.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在该弹出窗口中，从下拉菜单中选择**所有列**。
- en: Add a second line by clicking on the **+** button.
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**+**按钮添加第二行。
- en: Select **Exclude** from the dropdown.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择**排除**。
- en: Choose **Column names** from the second dropdown.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从第二个下拉框中选择**列名称**。
- en: Select the **id** column from the last dropdown.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从最后一个下拉框中选择**id**列。
- en: 'The dialog page should look as follows:'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对话框页面应该如下所示：
- en: '![Figure 6.9 – Select columns dialog'
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 6.9 – 选择列对话框]'
- en: '](img/B16777_06_009.jpg)'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_009.jpg)'
- en: Figure 6.9 – Select columns dialog
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.9 – 选择列对话框
- en: Click on **Save** to close the popup.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**以关闭弹出窗口。
- en: So far, you have selected the dataset that you will use to train the model,
    and you have prepared the data by removing the **id** column, which you will not
    need for the training process. In the next section, you will finalize your training
    pipeline by adding the untrained model, the module that will train the model,
    and the module for scoring and evaluating the trained model.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你已经选择了将用于训练模型的数据集，并通过移除**id**列（在训练过程中不需要此列）准备了数据。在下一节中，你将通过添加未训练的模型、训练模型的模块以及用于评分和评估训练模型的模块来完善你的训练流程。
- en: Preparing the data and training the model
  id: totrans-91
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备数据并训练模型
- en: 'Now, you will choose the model that you will train. In [*Chapter 5*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072),
    *Letting the Machines Do the Model Training*, you identified a **voting ensemble**
    as the best performing model for the given data. This type of model is a combination
    of different models, including **Random Forest**. To keep this example simple,
    you will use a **Two-Class Decision Forest** model, similar to **Random Forest**.
    Let''s get started:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你将选择你将要训练的模型。在[*第5章*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072)中，*让机器进行模型训练*，你确定了**投票集成**是给定数据的最佳表现模型。这种类型的模型是不同模型的组合，包括**随机森林**。为了简化示例，你将使用一个类似于**随机森林**的**两类决策森林**模型。我们开始吧：
- en: Navigate to the **Machine Learning Algorithms** category in the asset library.
    You will notice a couple of subcategories, including **Classification**. From
    that subcategory, drag and drop the **Two-Class Decision Forest** module onto
    the canvas.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在资产库中导航到**机器学习算法**类别。你会注意到几个子类别，其中包括**分类**。从该子类别中，拖动并将**两类决策森林**模块拖放到画布上。
- en: 'For the model training, you will need two additional modules: the **Split Data**
    module, which you can find in the asset library under the **Data Transformation**
    category, and the **Train Model** module, which can be found in the **Model Training**
    category. Drag and drop both modules onto the canvas.'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于模型训练，你将需要两个额外的模块：**拆分数据**模块，可以在资产库的**数据转换**类别中找到，以及**训练模型**模块，可以在**模型训练**类别中找到。将这两个模块拖放到画布上。
- en: You will need to extend the data flow you created in the previous section to
    pass the data through the new modules. Pull an **output port** from the **Select
    Columns in Dataset** module to an **input port** of the **Split Data** module.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你需要扩展你在上一节中创建的数据流，将数据传递通过新的模块。从**数据集中的选择列**模块拉取一个**输出端口**到**拆分数据**模块的**输入端口**。
- en: You will need to configure the **Split Data** module on the module's details
    pane, as shown in the following screenshot. Set **Fraction of rows in the first
    output dataset** to **0.7**. By doing that, 70% of the data will be sent on the
    **left output port** area, which is used to train the model, and 30% will be sent
    to the **right output port** area, which is used for testing.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你需要在模块的详细信息面板中配置**拆分数据**模块，如下图所示。将**第一个输出数据集中的行比例**设置为**0.7**。这样，70%的数据将通过**左输出端口**区域传送，用于训练模型，30%的数据将通过**右输出端口**区域传送，用于测试。
- en: The **Train Model** module accepts two inputs. On the **left input port** area,
    you need to pass an untrained model that will be trained with the data given on
    the **right input port** area. Pull an **output port** from the **Two-Class Decision
    Forest** module to the **left input port** area of the **Train Model** module.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**训练模型**模块接受两个输入。在**左输入端口**区域，你需要传递一个未训练的模型，该模型将使用**右输入端口**区域提供的数据进行训练。从**两类决策森林**模块拉取一个**输出端口**到**训练模型**模块的**左输入端口**区域。'
- en: Drag the **left output port** area of the **Split Data** module to the **right
    input port** area of **Train Model**. Your canvas should look as follows:![Figure
    6.10 – The Train Model module is missing some configuration
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**拆分数据**模块的**左输出端口**区域拖动到**训练模型**模块的**右输入端口**区域。你的画布应该如下所示：![图 6.10 – 训练模型模块缺少一些配置]
- en: '](img/B16777_06_010.jpg)'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_010.jpg)'
- en: Figure 6.10 – The Train Model module is missing some configuration
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.10 – 训练模型模块缺少一些配置
- en: In the preceding screenshot, there is an orange exclamation mark in the **Train
    Model** module. This mark indicates that something is misconfigured in that module.
    So far, you have configured which model to train and what data to use for the
    model's training. However, you have not defined which column the model should
    predict yet. This column is referred to as **Label column**. To configure **Label
    column**, select the module in the canvas and click on the **Edit column** link.
    This will open the **Label column** dialog shown in the following screenshot.
    Select the **churned** column from the drop-down list and click **Save**:![Figure
    6.11 – Selecting the column that the model will predict
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在前面的截图中，**训练模型**模块中有一个橙色的感叹号。这个标记表示该模块的某些配置错误。到目前为止，你已经配置了训练模型和使用哪些数据进行训练，但你还没有定义模型要预测哪一列。这个列被称为**标签列**。要配置**标签列**，选择画布中的模块，然后点击**编辑列**链接。这将打开如下截图所示的**标签列**对话框。从下拉列表中选择**churned**列，然后点击**保存**：![图
    6.11 – 选择模型将要预测的列
- en: '](img/B16777_06_011.jpg)'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_011.jpg)'
- en: Figure 6.11 – Selecting the column that the model will predict
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.11 – 选择模型将要预测的列
- en: So far, the training pipeline is performing the first four steps of the *7 Steps
    of Machine Learning*. The next step is to evaluate the model.
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 到目前为止，训练管道已完成了*机器学习的7个步骤*中的前四个步骤。接下来的步骤是评估模型。
- en: Drag and drop the **Score Model** module onto the canvas, which can be found
    in the asset library under the **Model Scoring & Evaluation** category. This module
    accepts a trained model in the **left input port** area and a dataset on the **right
    input port** area. The output of this module is a dataset that contains the inferences
    made by the model against the incoming dataset.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**评分模型**模块拖放到画布上，该模块可以在资产库中的**模型评分与评估**类别下找到。该模块接受训练好的模型作为**左输入端口**区域的数据，以及作为**右输入端口**区域的数据集。该模块的输出是一个包含模型对输入数据集进行推理结果的数据集。
- en: Connect the **right output port** area of the **Split Data** module to the **right
    input port** area of the **Score Model** module. This will create a data flow
    that will bring the 30% part of the original data into the **Score Model** module.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**分割数据**模块的**右输出端口**区域连接到**评分模型**模块的**右输入端口**区域。这将创建一个数据流，将原始数据的30%部分传递到**评分模型**模块。
- en: Connect the **output port** area of the **Train Model** module to the **left
    input port** area of the **Score Model** module. The **Score Model** module will
    use the trained model to perform inferences against the incoming data.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**输出端口**区域连接到**训练模型**模块的**左输入端口**区域。**评分模型**模块将使用训练好的模型对输入数据进行推理。
- en: Drag and drop the **Evaluate Model** module onto the canvas, which can be found
    in the asset library under the **Model Scoring & Evaluation** category. This module
    will compare the predictions that the model made against the values stored in
    the **churned** column.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**评估模型**模块拖放到画布上，该模块可以在资产库中的**模型评分与评估**类别下找到。该模块将比较模型所做的预测与**churned**列中存储的值。
- en: Connect the **output port** area of the **Score Model** module to the **left
    input port** area of the **Evaluate Model** module.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**评分模型**模块的**输出端口**区域连接到**评估模型**模块的**左输入端口**区域。
- en: 'If you have followed all the steps so far, your canvas should look as follows:'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你已经按照步骤操作，画布应该如下所示：
- en: '![Figure 6.12 – The completed training pipeline'
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 6.12 – 完整的训练管道'
- en: '](img/B16777_06_012.jpg)'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_012.jpg)'
- en: Figure 6.12 – The completed training pipeline
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.12 – 完整的训练管道
- en: 'So far, you have authored a training pipeline that performs the following actions:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你已经编写了一个训练管道，完成了以下操作：
- en: Removes the **id** column from the dataset.
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从数据集中移除**id**列。
- en: Splits the data into a training dataset and a validation one. The training dataset
    contains 70% of the original data. The validation dataset contains the remaining
    30%.
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将数据分为训练数据集和验证数据集。训练数据集包含原始数据的70%。验证数据集包含剩余的30%。
- en: Trains **Two-Class Decision Forest** using the training dataset.
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用训练数据集训练**二类决策森林**。
- en: Scores the validation dataset using the trained model.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用训练好的模型对验证数据集进行评分。
- en: Evaluates the performance of the model by examining the results in the scored
    dataset. You will be able to review the metrics of the trained model in the **Evaluate
    Model** module.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过检查评分数据集中的结果来评估模型的性能。您将能够在**评估模型**模块中查看训练模型的度量。
- en: In the next section, you are going to execute this pipeline to train the model.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，您将执行此管道来训练模型。
- en: Executing the training pipeline
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 执行训练管道
- en: 'In the previous section, you created a complete training pipeline that you
    will now execute by creating a new pipeline run. Let''s get started:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节中，您创建了一个完整的训练管道，接下来您将通过创建一个新的管道运行来执行它。让我们开始吧：
- en: Click on the **Submit** button in the top-right corner. The **Set up pipeline
    run** dialog will open, as shown in the following screenshot.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击右上角的**提交**按钮，**设置管道运行**对话框将打开，如下图所示。
- en: You will need to create a new experiment and name it **test-pipeline**. Select
    the **Create new** radio button and then type in this name.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您需要创建一个新的实验并命名为**test-pipeline**。选择**创建新实验**单选按钮，然后输入该名称。
- en: 'Notice that the pipeline will execute in the default **compute target** you
    selected in the *The authoring screen/view* section. Click on the **Submit** button
    to start executing the training pipeline:'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请注意，管道将在您在*作者界面/视图*部分中选择的默认**计算目标**上执行。点击**提交**按钮开始执行训练管道：
- en: '![Figure 6.13 – Preparing to execute the training pipeline'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.13 – 准备执行训练管道'
- en: '](img/B16777_06_013.jpg)'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16777_06_013.jpg)'
- en: Figure 6.13 – Preparing to execute the training pipeline
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.13 – 准备执行训练管道
- en: 'Once the pipeline finishes executing, the designer will look similar to the
    following:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦管道执行完成，设计器将类似于以下界面：
- en: '![Figure 6.14 – Successfully running the pipeline'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.14 – 成功运行管道'
- en: '](img/B16777_06_014.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16777_06_014.jpg)'
- en: Figure 6.14 – Successfully running the pipeline
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.14 – 成功运行管道
- en: With that, you have successfully finished developing and training your first
    pipeline. When the execution of the pipeline is completed, the **Create inference
    pipeline** button will appear. The following section describes the different options
    you have when it comes to creating an inference pipeline.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 至此，您已成功完成了第一个管道的开发和训练。当管道执行完成后，**创建推理管道**按钮将出现。以下部分将描述在创建推理管道时可选的不同选项。
- en: Creating a batch and real-time inference pipeline
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建批量和实时推理管道
- en: 'This section will discuss the two options of deploying an inference pipeline
    from the designer: **batch** and **real time**:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将讨论从设计器部署推理管道的两种选项：**批量**和**实时**：
- en: With batch predictions, you asynchronously score large datasets.
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用批量预测，您可以异步地对大型数据集进行评分。
- en: With real-time prediction, you score a small dataset or a single row in real
    time.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用实时预测，您可以实时地对一个小数据集或一行数据进行评分。
- en: 'When you create an inference pipeline, either batch or real time, AzureML takes
    care of the following things:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 当您创建一个推理管道时，无论是批量的还是实时的，AzureML 会处理以下事项：
- en: AzureML stores the trained model and all the trained data processing modules
    as an asset in the asset library under the **Datasets** category.
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AzureML将训练好的模型和所有训练数据处理模块作为资产，存储在**数据集**类别下的资产库中。
- en: It removes unnecessary modules such as **Train Model** and **Split Data** automatically.
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它会自动删除不必要的模块，如**训练模型**和**拆分数据**。
- en: It adds the trained model to the pipeline.
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它将训练好的模型添加到管道中。
- en: Especially for real-time inference pipelines, AzureML will add a **web service
    input** and a **web service output** in the final pipeline.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 特别是对于实时推理管道，AzureML将在最终管道中添加**Web 服务输入**和**Web 服务输出**。
- en: Let's start by creating a batch pipeline, something you will do in the next
    section.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从创建一个批量管道开始，这将是您在下一节中要做的事情。
- en: Creating a batch pipeline
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建批量管道
- en: 'In this section, you will create a batch inference pipeline. Let''s get started:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将创建一个批量推理管道。让我们开始吧：
- en: Click on the **Create inference pipeline** dropdown next to the **Submit** button
    and select **Batch inference pipeline**. This action will create the **Batch inference
    pipeline** tab, as shown in the following screenshot:![Figure 6.15 – The Batch
    inference pipeline tab showing the default generated pipeline
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建推理管道**下拉菜单，位于**提交**按钮旁边，并选择**批量推理管道**。此操作将创建**批量推理管道**标签页，如下图所示：![图 6.15
    – 显示默认生成管道的批量推理管道标签页
- en: '](img/B16777_06_015.jpg)'
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_015.jpg)'
- en: Figure 6.15 – The Batch inference pipeline tab showing the default generated
    pipeline
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.15 – 显示默认生成管道的批量推理管道选项卡
- en: By adding a pipeline parameter, you will be able to change the behavior of the
    pipeline at runtime. In our case, we want to parameterize which dataset to use
    to make predictions. To parameterize the input dataset, click on **churn-dataset**
    and select the **Set as pipeline parameter** checkbox in the details pane on the
    right.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过添加管道参数，你将能够在运行时更改管道的行为。在我们的案例中，我们希望参数化用于预测的数据集。要参数化输入数据集，点击**churn-dataset**，然后在右侧详细信息窗格中勾选**设置为管道参数**复选框。
- en: Change the default parameter name in the **Parameter name** text box to **batchfile**.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**参数名称**文本框中的默认参数名称更改为**batchfile**。
- en: Click on the **Publish** button to bring up the **Set up published pipeline**
    dialog shown in the following screenshot.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**发布**按钮，弹出**设置已发布管道**对话框，如以下截图所示。
- en: Select the **Create new** radio button to define a new pipeline endpoint. This
    endpoint is used to trigger the pipeline that you are about to publish.
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**创建新**单选按钮，以定义新的管道端点。此端点用于触发即将发布的管道。
- en: Keep the default value of the **New PipelineEndpoint name** field as is. It
    should read **test-pipeline-batch inference**.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保持**新管道端点名称**字段的默认值不变。它应该显示为**test-pipeline-batch inference**。
- en: You can add a description to your published endpoint by filling in the **PipelineEndpoint
    description (optional)** field. Write **Test of a batch pipeline parameter name
    batchfile** in that field.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以通过填写**管道端点描述（可选）**字段，向已发布的端点添加描述。在该字段中写入**批量管道参数名称batchfile的测试**。
- en: Keep all the other settings as is. The completed dialog page should look as
    follows:![Figure 6.16 – Published pipeline dialog page
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保持所有其他设置不变。完成后的对话框页面应该如下所示：![图 6.16 – 已发布管道对话框页面
- en: '](img/B16777_06_016.jpg)'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![](img/B16777_06_016.jpg)'
- en: Figure 6.16 – Published pipeline dialog page
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.16 – 已发布管道对话框页面
- en: Click on the **Publish** button.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**发布**按钮。
- en: 'Once the pipeline''s endpoint has been successfully published, the message
    shown in the following screenshot will appear in the designer. The **test-pipeline-batch
    inference** link will direct you to the published pipeline:'
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 一旦管道的端点成功发布，设计器中将显示如下截图中的消息。**test-pipeline-batch inference**链接将引导你到已发布的管道：
- en: '![](img/B16777_06_017.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16777_06_017.jpg)'
- en: Figure 6.17 – Publish succeeded
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.17 – 发布成功
- en: Now that you have published a batch inference pipeline, you can trigger it through
    the AzureML Studio interface. In [*Chapter 11*](B16777_11_Final_VK_ePub.xhtml#_idTextAnchor160),
    *Working with Pipelines*, in the *Publishing a pipeline to expose it as an endpoint*
    section, you will learn more about these pipelines and how you can integrate them
    with third-party applications.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经发布了一个批量推理管道，你可以通过AzureML Studio界面触发它。在[*第11章*](B16777_11_Final_VK_ePub.xhtml#_idTextAnchor160)，*与管道一起工作*的*将管道发布为端点*部分，你将学习更多关于这些管道以及如何将它们与第三方应用程序集成的内容。
- en: In the next section, we will create a real-time pipeline based on the training
    pipeline.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将基于训练管道创建实时管道。
- en: Creating a real-time pipeline
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建实时管道
- en: 'In this section, you will create a real-time inference pipeline. Let''s get
    started:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你将创建一个实时推理管道。让我们开始吧：
- en: Select the **Training pipeline** tab in the designer, which is visible on the
    top-left corner in *Figure 6.15*.
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在设计器中选择**训练管道**选项卡，该选项卡位于*图 6.15*的左上角。
- en: Click on the **Create inference pipeline** dropdown next to the **Submit** button
    and select **Real-time inference pipeline**. This will generate the default **r****eal-time
    inference pipeline** shown in the following screenshot:![Figure 6.18 – The default
    real-time inference pipeline
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**提交**按钮旁边的**创建推理管道**下拉菜单，并选择**实时推理管道**。这将生成默认的**实时推理管道**，如以下截图所示：![图 6.18
    – 默认实时推理管道
- en: '](img/B16777_06_018.jpg)'
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![](img/B16777_06_018.jpg)'
- en: Figure 6.18 – The default real-time inference pipeline
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.18 – 默认实时推理管道
- en: Before we deploy this pipeline, we will need to make a couple of changes.
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在我们部署此管道之前，需要进行一些更改。
- en: Click on the **Select Columns in Dataset** module and click on the **Edit column**
    link in the details pane on the right-hand side.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**选择数据集中的列**模块，并点击右侧详细信息窗格中的**编辑列**链接。
- en: Add a new row to the **Select columns** dialog by clicking on the plus (**+**)
    icon.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击加号（**+**）图标，在**选择列**对话框中添加新行。
- en: Select **Exclude** and **Column names** from the corresponding dropdowns and
    enter **churned** as the column's name to exclude. The dialog page should look
    as follows:![Figure 6.19 – Excluding both the id and churned columns from the
    incoming dataset
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从相应的下拉菜单中选择**排除**和**列名**，并输入**churned**作为要排除的列名。对话框页面应如下所示：![图 6.19 – 从传入数据集中排除id和churned列
- en: '](img/B16777_06_019.jpg)'
  id: totrans-174
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_019.jpg)'
- en: Figure 6.19 – Excluding both the id and churned columns from the incoming dataset
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 6.19 – 从传入数据集中排除id和churned列
- en: From the **Data Transformation** category in the asset library, drag the **Apply
    SQL Transformation** module onto the canvas. Place it above the **Webservice Output**
    module.
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从资产库中的**数据转换**类别中，将**应用SQL转换**模块拖到画布上。将其放置在**Web服务输出**模块的上方。
- en: Connect the **output port** area of the **Score Model** module to the **left
    input port** area of the **Apply SQL Transformation** module.
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**评分模型**模块的**输出端口**区域连接到**应用SQL转换**模块的**左输入端口**区域。
- en: Delete the connection between the **Score Model** module and the **Web Service
    Output** model. To do that, select the connection between those two modules by
    clicking on it. When highlighted, select the trash icon or press the *Delete*
    button on your keyboard. The connector should be removed.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除**评分模型**模块与**Web服务输出**模块之间的连接。为此，点击连接两者模块之间的连接线。选中后，点击垃圾桶图标或按键盘上的*删除*按钮。连接器应被移除。
- en: Delete the **Evaluate Model** module from the canvas.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除画布中的**评估模型**模块。
- en: Connect the **output port** area of the **Apply SQL Transformation** module
    to the **input port** area of the **Web Service Output** module.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**应用SQL转换**模块的**输出端口**区域连接到**Web服务输出**模块的**输入端口**区域。
- en: Select the **Apply SQL Transformation** module.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**应用SQL转换**模块。
- en: 'Click on the **Edit code** link in the **Apply SQL Transformation** detail
    pane and replace the default query with the following one:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**应用SQL转换**详细面板中的**编辑代码**链接，并用以下查询替换默认查询：
- en: '[PRE0]'
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This SQL transformation only selects the predicted value, which is stored in
    the **Scored Labels** column.
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此SQL转换仅选择预测值，该值存储在**评分标签**列中。
- en: Press the **Save** button. The changed pipeline should look like the one shown
    in the following screenshot.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按**保存**按钮。修改后的管道应如下图所示。
- en: To ensure that the pipeline you have designed executes properly, you will need
    to run it once using the **Submit** button. The **Set up published pipeline**
    dialog will appear.
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了确保您设计的管道正确执行，您需要使用**提交**按钮运行一次。将弹出**设置已发布的管道**对话框。
- en: You will need to execute the pipeline within an experiment. Select the **Create
    new** radio button.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您需要在实验中执行管道。选择**创建新**单选按钮。
- en: Use **test-pipeline-real-time-inference** as **New experiment name**.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**test-pipeline-real-time-inference**作为**新实验名称**。
- en: Keep the default values as is for the rest of the fields and press **Submit**.
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保持其他字段的默认值不变，点击**提交**。
- en: 'Your pipeline should execute, and the canvas should look as follows:'
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您的管道应该可以执行，且画布应如下所示：
- en: '![Figure 6.20 – Modified real-time inference pipeline'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 6.20 – 修改后的实时推断管道'
- en: '](img/B16777_06_020.jpg)'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B16777_06_020.jpg)'
- en: Figure 6.20 – Modified real-time inference pipeline
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.20 – 修改后的实时推断管道
- en: After verifying that the pipeline can execute without any issues, you can deploy
    it as a real-time endpoint. You have two options regarding the infrastructure
    that will host your real-time endpoint. You can deploy either in an **Azure Container
    Instance** (**ACI**) or **Azure Kubernetes Service** (**AKS**) cluster. The **ACI**
    infrastructure is useful for testing purposes, while the **AKS** infrastructure
    supports better production environments. In our case, we will deploy to **ACI**,
    something you will read about in the next section.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 在验证管道可以正常执行后，您可以将其部署为实时端点。关于将托管实时端点的基础设施，您有两种选择。您可以选择将其部署到**Azure容器实例**（**ACI**）或**Azure
    Kubernetes服务**（**AKS**）集群中。**ACI**基础设施适用于测试目的，而**AKS**基础设施则支持更好的生产环境。在我们的案例中，我们将部署到**ACI**，您将在下一部分了解有关内容。
- en: Deploying a real-time inference pipeline
  id: totrans-195
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 部署实时推断管道
- en: 'In this section, you will deploy the sample real-time inference pipeline you
    created in the **Real-time inference pipeline** designer tab. Let''s get started:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，您将部署在**实时推断管道**设计器标签中创建的示例实时推断管道。让我们开始吧：
- en: Click on the **Deploy** button. This will bring up the **Set up real-time endpoint**
    popup shown in the following screenshot.
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**部署**按钮。这将弹出**设置实时端点**的弹窗，如下图所示。
- en: On the **Set up real-time endpoint** popup, select the **Deploy new real-time
    endpoint** radio button option.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**设置实时端点**弹窗中，选择**部署新实时端点**单选按钮选项。
- en: In the **Name** text field, enter **first-real-time-endpoint**.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**名称**文本框中，输入**first-real-time-endpoint**。
- en: In the **Description** text field, enter **Container Deployment of the first
    real-time pipeline**.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**描述**文本框中，输入**第一个实时管道的容器部署**。
- en: Click on the **Compute type** drop-down list and select **Azure Container Instance**.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**计算类型**下拉列表，选择**Azure 容器实例**。
- en: You won't need to modify the **Advanced** settings. The completed popup should
    look as follows:![Figure 6.21 – Set up real-time endpoint popup
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你无需修改**高级**设置。完成的弹窗应如下所示：![图6.21 – 设置实时端点弹窗
- en: '](img/B16777_06_021.jpg)'
  id: totrans-203
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B16777_06_021.jpg)'
- en: Figure 6.21 – Set up real-time endpoint popup
  id: totrans-204
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图6.21 – 设置实时端点弹窗
- en: Click on the **Deploy** button to provision your real-time endpoint. This will
    take a couple of minutes.
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**部署**按钮以配置你的实时端点。这将需要几分钟时间。
- en: After successfully deploying the pipeline, you will find the newly deployed
    pipeline under **Assets** | **Endpoints** of AzureML Studio. The endpoint you
    just deployed is the same as the one you deployed in [*Chapter 5*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072),
    *Letting the Machines Do the Model Training*. You can test it through the web
    interface. You will deep dive into how to use similar endpoints in [*Chapter 12*](B16777_12_Final_VK_ePub.xhtml#_idTextAnchor171),
    *Operationalizing Models with Code*. Before moving on, you should delete the real-time
    endpoint to avoid being charged. Follow the instructions in the *Cleaning up the
    model deployment* section of [*Chapter 5*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072),
    *Letting the Machines Do the Model Training*, to delete the endpoint you just
    deployed.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 成功部署管道后，你将在AzureML Studio的**资产** | **端点**中找到新部署的管道。你刚部署的端点与在[*第5章*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072)中部署的端点相同，*让机器进行模型训练*。你可以通过网页界面进行测试。你将在[*第12章*](B16777_12_Final_VK_ePub.xhtml#_idTextAnchor171)中深入了解如何使用类似的端点，*通过代码使模型操作化*。在继续之前，你应当删除实时端点，以免产生费用。请参照[*第5章*](B16777_05_Final_VK_ePub.xhtml#_idTextAnchor072)中的*清理模型部署*部分，删除你刚刚部署的端点。
- en: Summary
  id: totrans-207
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: This chapter introduced the pipeline designer, which allows us to create AzureML
    pipelines via drag and drop. You built your first training pipeline based on the
    churn dataset and the **Two-Class Decision Forest** model. We discussed three
    pipeline types, authored the training pipeline, created a batch pipeline, and
    developed and deployed a real-time pipeline.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍了管道设计器，它允许我们通过拖放方式创建AzureML管道。你基于客户流失数据集和**二分类决策森林**模型构建了你的第一个训练管道。我们讨论了三种管道类型，编写了训练管道，创建了批量管道，并开发和部署了实时管道。
- en: This chapter concludes the no-code, low-code features that AzureML provides.
    In the next chapter, you will start working on the AzureML Python SDK. The AzureML
    Python SDK allows you to train models and create machine learning pipelines through
    code, which is critical for the DP-100 exam.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 本章总结了AzureML提供的无代码、低代码功能。在下一章，你将开始使用AzureML Python SDK。AzureML Python SDK允许你通过代码训练模型并创建机器学习管道，这对于DP-100考试至关重要。
- en: Question
  id: totrans-210
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: What are the options for deploying real-time pipelines?
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 部署实时管道有哪些选项？
- en: '**Azure Container Instances** only'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure 容器实例**仅适用'
- en: '**Azure Container Instances** and **Azure Kubernetes Services**'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure 容器实例**和**Azure Kubernetes 服务**'
- en: '**Azure Container Instances** and **Azure Virtual Machines**'
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure 容器实例**和**Azure 虚拟机**'
- en: '**Azure Virtual Machines** only'
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure 虚拟机**仅适用'
- en: Further reading
  id: totrans-216
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'This section offers a list of helpful web resources to help you augment your
    AzureML designer knowledge:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 本节提供了一些有用的网络资源，帮助你扩展AzureML设计器的知识：
- en: 'Configuring data splits and cross-validation in automated machine learning:
    [https://docs.microsoft.com/azure/machine-learning/how-to-configure-cross-validation-data-splits](https://docs.microsoft.com/azure/machine-learning/how-to-configure-cross-validation-data-splits%0D)'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置数据拆分和交叉验证的自动化机器学习：[https://docs.microsoft.com/azure/machine-learning/how-to-configure-cross-validation-data-splits](https://docs.microsoft.com/azure/machine-learning/how-to-configure-cross-validation-data-splits%0D)
- en: 'Running batch predictions using the AzureML designer: [https://github.com/MicrosoftDocs/azure-docs/blob/master/articles/machine-learning/how-to-run-batch-predictions-designer.md](https://github.com/MicrosoftDocs/azure-docs/blob/master/articles/machine-learning/how-to-run-batch-predictions-designer.md%0D)'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 AzureML 设计器运行批量预测：[https://github.com/MicrosoftDocs/azure-docs/blob/master/articles/machine-learning/how-to-run-batch-predictions-designer.md](https://github.com/MicrosoftDocs/azure-docs/blob/master/articles/machine-learning/how-to-run-batch-predictions-designer.md%0D)
- en: 'Tutorial: Designer – deploying a machine learning model: [https://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-deploy](https://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-deploy%0D)'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 教程：设计器 – 部署机器学习模型：[https://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-deploy](https://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-deploy%0D)
- en: What is the AzureML designer? [https://docs.microsoft.com/azure/machine-learning/concept-designer](https://docs.microsoft.com/azure/machine-learning/concept-designer%0D)
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是 AzureML 设计器？[https://docs.microsoft.com/azure/machine-learning/concept-designer](https://docs.microsoft.com/azure/machine-learning/concept-designer%0D)
- en: 'Tutorial: Designer – training a no-code regression model: [https://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-train-score](https://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-train-score%20)'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 教程：设计器 – 训练一个无代码回归模型：[https://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-train-score](https://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-train-score%20)
- en: 'Tutorial: Designer – deploying a machine learning model: [ttps://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-deploy](https://ttps://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-deploy)'
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 教程：设计器 – 部署机器学习模型：[ttps://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-deploy](https://ttps://docs.microsoft.com/azure/machine-learning/tutorial-designer-automobile-price-deploy)
