- en: Naive Bayes
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 朴素贝叶斯
- en: A Naive Bayes classification algorithm assigns a class to an element of a set
    that is most probable according to Bayes' theorem.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 朴素贝叶斯分类算法根据贝叶斯定理将最可能的类别分配给一组元素。
- en: 'Let''s say that *A* and *B* are probabilistic events. *P(A)* is the probability
    of *A* being `true`. *P(A|B)* is the conditional probability of *A* being `true`,
    given that *B* is `true`. If this is the case, then Bayes'' theorem states the
    following:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 假设 *A* 和 *B* 是概率事件。*P(A)* 是 *A* 为 `true` 的概率。*P(A|B)* 是在 *B* 为 `true` 的情况下，*A*
    为 `true` 的条件概率。如果是这种情况，那么贝叶斯定理声明如下：
- en: '![](img/1e3a0961-1ce8-4b33-8295-610932648b72.png)'
  id: totrans-3
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1e3a0961-1ce8-4b33-8295-610932648b72.png)'
- en: '*P(A)* is the prior probability of *A* being `true` without the knowledge of
    the probability of *P(B)* and *P(B|A)*. *P(A|B)* is the posterior probability
    of *A* being `true`, taking into consideration additional knowledge about the
    probability of *B* being `true`.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '*P(A)* 是在没有 *P(B)* 和 *P(B|A)* 概率知识的情况下，*A* 为 `true` 的先验概率。*P(A|B)* 是考虑到 *B*
    为 `true` 额外知识的条件概率。'
- en: 'In this chapter, you will learn about the following topics:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将学习以下主题：
- en: How to apply Bayes' theorem in a basic way to compute the probability of a medical
    test that is correct in the simple example medical test
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何在简单的医学检测示例中以基础方式应用贝叶斯定理来计算医学测试的正确概率
- en: How to grasp Bayes' theorem by proving its statement and its extension
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何通过证明贝叶斯定理的陈述及其扩展来掌握贝叶斯定理
- en: How to apply Bayes' theorem differently to independent and dependent variables
    in examples of playing chess
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何在国际象棋的示例中将贝叶斯定理应用于独立和依赖变量
- en: How to apply Bayes' theorem to discrete random variables in examples of medical
    tests and playing chess, and for continuous random variables in an example of
    gender classification using the probability distribution of the continuous random
    variable
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何在医学测试和国际象棋的离散随机变量示例中应用贝叶斯定理，以及如何在性别分类的连续随机变量示例中使用连续随机变量的概率分布应用贝叶斯定理
- en: How to implement an algorithm in Python to calculate the posterior probabilities
    of using Bayes' theorem
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何在Python中实现算法，利用贝叶斯定理计算后验概率
- en: By the end of this chapter, you will be able to verify your understanding of
    Naive Bayes by solving problems. You will also be able to discern in which situations
    Bayes' theorem is an appropriate method of analysis, and when it is not.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，您将能够通过解决问题验证您对朴素贝叶斯的理解。您还将能够辨别在什么情况下贝叶斯定理是合适的分析方法，以及在何时不适用。
- en: Medical tests – basic application of Bayes' theorem
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 医学测试 – 贝叶斯定理的基本应用
- en: A patient takes a special cancer test that has an accuracy of `test_accuracy=99.9%`—if
    the result is positive, then 99.9% of the patients tested will suffer from that
    particular type of cancer. Conversely, 99.9% of the patients with a negative result
    will not suffer from that particular cancer.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 一位病人接受了一项特殊的癌症检测，准确率为`test_accuracy=99.9%`——如果结果为阳性，那么99.9%的接受检测的患者会患有该特定类型的癌症。反之，99.9%接受检测的患者如果结果为阴性，则不会患有该特定类型的癌症。
- en: Suppose that a patient is tested and the result is positive. What is the probability
    of that patient suffering from that particular type of cancer?
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 假设病人接受了检测且结果为阳性。那么该病人患某种特定类型癌症的概率是多少？
- en: Analysis
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分析
- en: 'We will use Bayes'' theorem to ascertain the probability of the patient having
    cancer:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用贝叶斯定理来确定病人患癌症的概率：
- en: '![](img/d0bacaf1-2e6b-4b9a-9a18-babfad1b9c73.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d0bacaf1-2e6b-4b9a-9a18-babfad1b9c73.png)'
- en: To ascertain the prior probability that a patient has cancer, we have to find
    out how frequently cancer occurs among people. Say that we find out that 1 person
    in 100,000 suffers from this kind of cancer. Therefore, *P(cancer)=1/100,000*.
    So, *P(test_positive|cancer) = test_accuracy=99.9%=0.999* given by the accuracy
    of the test.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确定病人患癌症的先验概率，我们必须了解癌症在人群中的发生频率。假设我们发现每10万人中就有1人患有这种癌症。因此，*P(cancer)=1/100,000*。因此，*P(test_positive|cancer)
    = test_accuracy=99.9%=0.999*，这是由检测的准确性给出的。
- en: '*P(test_positive)* has to be computed as follows:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '*P(test_positive)* 需要按以下方式计算：'
- en: '![](img/fc29a390-e50c-428a-955b-24bd1632f2f5.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fc29a390-e50c-428a-955b-24bd1632f2f5.png)'
- en: '![](img/edb7873e-6060-4860-a3d0-b50025907846.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/edb7873e-6060-4860-a3d0-b50025907846.png)'
- en: '![](img/bddd6d3c-f083-49cd-bb6d-8ecd0b3ae5d3.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bddd6d3c-f083-49cd-bb6d-8ecd0b3ae5d3.png)'
- en: 'Therefore, we can calculate the following:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以计算以下内容：
- en: '![](img/4b5d9b6e-2b40-467d-bb4b-1c1fd4d6252b.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4b5d9b6e-2b40-467d-bb4b-1c1fd4d6252b.png)'
- en: '![](img/68db59ff-64f1-42e0-bb56-1725a4861f17.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/68db59ff-64f1-42e0-bb56-1725a4861f17.png)'
- en: '![](img/fe78ce54-69c9-4861-8a7b-52c216b97539.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fe78ce54-69c9-4861-8a7b-52c216b97539.png)'
- en: So, even if the result of the test is positive and the test has an accuracy
    of 99.9%, the probability of the patient having the type of cancer tested for
    is only approximately 1%. The probability of someone having cancer after taking
    the test is relatively low when compared to the high accuracy of the test, but
    is much higher than the probability of 1 in 100,000 (0.001%), as was known prior
    to taking the test, based on its occurrence in the population.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，即使测试结果是阳性，且测试的准确率为99.9%，患者患所测试癌症的概率也只有大约1%。与测试的高准确率相比，测试后患癌症的概率相对较低，但远高于在测试前已知的1/100,000（0.001%）的概率，这是基于该癌症在整个群体中的发生率。
- en: Bayes' theorem and its extension
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 贝叶斯定理及其扩展
- en: In this section, we will state and prove both Bayes' theorem and its extension.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将陈述并证明贝叶斯定理及其扩展。
- en: Bayes' theorem
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 贝叶斯定理
- en: 'Bayes'' theorem states the following:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 贝叶斯定理指出如下：
- en: '![](img/ee63b297-ca71-4ec1-97ec-e23e65d8e68a.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ee63b297-ca71-4ec1-97ec-e23e65d8e68a.png)'
- en: Proof
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 证明
- en: 'We can prove this theorem by using elementary set theory on the probability
    spaces of the events *A* and *B*. In other words, here, a probability event will
    be defined as a set of the possible outcomes in the probability space:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过使用初等集合论在事件*A*和*B*的概率空间上证明这个定理。换句话说，在这里，概率事件将被定义为概率空间中可能结果的集合：
- en: '![](img/aa0e5bb6-2353-4a84-8068-1617792a0145.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/aa0e5bb6-2353-4a84-8068-1617792a0145.png)'
- en: 'Figure 2.1: Probability space for the two events'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.1：两个事件的概率空间
- en: 'As you can see in the preceding diagram, we can state the following relationships:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 如你在上面的图示中所见，我们可以陈述如下关系：
- en: '![](img/faace8ed-f119-42e8-9bdc-9e8cb7d84d9e.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](img/faace8ed-f119-42e8-9bdc-9e8cb7d84d9e.png)'
- en: '![](img/43a6b4bc-0020-4e6d-87ea-5e6126ab9dc9.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](img/43a6b4bc-0020-4e6d-87ea-5e6126ab9dc9.png)'
- en: 'Rearranging these relationships, we get the following:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些关系重新排列，我们得到如下：
- en: '![](img/dec2ce66-426b-4593-94b1-76d8f2faeb19.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dec2ce66-426b-4593-94b1-76d8f2faeb19.png)'
- en: '![](img/933fce7d-60d9-428e-a4f6-4e1addbeefc0.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](img/933fce7d-60d9-428e-a4f6-4e1addbeefc0.png)'
- en: '![](img/fd66305c-346b-4fd0-bb93-87ce36cab82b.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fd66305c-346b-4fd0-bb93-87ce36cab82b.png)'
- en: 'This is, in fact, Bayes'' theorem:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 这实际上就是贝叶斯定理：
- en: '![](img/be64046f-7f71-41a2-994f-1e6ce0425aa7.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/be64046f-7f71-41a2-994f-1e6ce0425aa7.png)'
- en: This concludes the proof.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了证明。
- en: Extended Bayes' theorem
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扩展贝叶斯定理
- en: 'We can extend Bayes'' theorem by taking more probability events into consideration.
    Suppose that the events *B1,…,Bn* are conditionally independent given *A*. Let
    *~A* denote the complement of *A*. Then, we have the following:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过考虑更多的概率事件来扩展贝叶斯定理。假设事件*B1,…,Bn*在给定*A*的情况下是条件独立的。让*~A*表示*A*的补集。那么，我们有如下结果：
- en: '![](img/0f87f51c-675b-4c5d-a9a2-83eeb9da4e84.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0f87f51c-675b-4c5d-a9a2-83eeb9da4e84.png)'
- en: '![](img/84cfe840-b3eb-4fc0-9351-63504b5c5114.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/84cfe840-b3eb-4fc0-9351-63504b5c5114.png)'
- en: Proof
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 证明
- en: 'Since the events *B1,…,Bn* are conditionally independent given *A* (and also
    given *~A*), we get the following:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 由于事件*B1,…,Bn*在给定*A*（以及给定*~A*）的情况下是条件独立的，我们得到如下结论：
- en: '![](img/8f2b7b8e-dc43-4a01-bb68-4c8d3350135f.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8f2b7b8e-dc43-4a01-bb68-4c8d3350135f.png)'
- en: 'Applying the simple form of Bayes'' theorem and this fact, we thus have the
    following:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 应用贝叶斯定理的简易形式和这一事实，我们得到如下结果：
- en: '![](img/0483f55a-0137-4da3-9481-f6310c381597.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0483f55a-0137-4da3-9481-f6310c381597.png)'
- en: '![](img/7659e200-e263-4048-a432-a4a119a3b01f.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7659e200-e263-4048-a432-a4a119a3b01f.png)'
- en: '![](img/4f2148c3-8a3f-4b7e-82fc-19733de3b484.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4f2148c3-8a3f-4b7e-82fc-19733de3b484.png)'
- en: This completes the proof.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了证明。
- en: Playing chess – independent events
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下棋 – 独立事件
- en: 'Suppose we are given the following table of data. This tells us whether or
    not our friend will play a game of chess with us outside in the park, based on
    a number of weather-related conditions:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们给定了以下数据表。这告诉我们，基于一系列与天气相关的条件，我们的朋友是否愿意在公园外和我们下棋：
- en: '| **Temperature** | **Wind** | **Sunshine** | **Play** |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| **温度** | **风力** | **阳光** | **是否下棋** |'
- en: '| Cold | Strong | Cloudy | No |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| 寒冷 | 强风 | 阴天 | 否 |'
- en: '| Warm | Strong | Cloudy | No |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 强风 | 阴天 | 否 |'
- en: '| Warm | None | Sunny | Yes |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 无 | 晴天 | 是 |'
- en: '| Hot | None | Sunny | No |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 无 | 晴天 | 否 |'
- en: '| Hot | Breeze | Cloudy | Yes |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 微风 | 阴天 | 是 |'
- en: '| Warm | Breeze | Sunny | Yes |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 微风 | 晴天 | 是 |'
- en: '| Cold | Breeze | Cloudy | No |'
  id: totrans-68
  prefs: []
  type: TYPE_TB
  zh: '| 寒冷 | 微风 | 阴天 | 否 |'
- en: '| Cold | None | Sunny | Yes |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '| 寒冷 | 无 | 晴天 | 是 |'
- en: '| Hot | Strong | Cloudy | Yes |'
  id: totrans-70
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 强风 | 阴天 | 是 |'
- en: '| Warm | None | Cloudy | Yes |'
  id: totrans-71
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 无 | 阴天 | 是 |'
- en: '| Warm | Strong | Sunny | ? |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 强风 | 晴天 | ? |'
- en: We would like to establish, by using Bayes' theorem, whether our friend would
    like to play a game of chess with us in the park given that the Temperature is
    Warm, the Wind is Strong, and it is Sunny.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望通过使用贝叶斯定理来判断，如果温度是温暖的，风速较强，且阳光明媚，我们的朋友是否愿意在公园与我们下棋。
- en: Analysis
  id: totrans-74
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分析
- en: 'In this case, we may want to consider *Temperature*, *Wind*, and *Sunshine*
    as the independent random variables. The formula for the extended Bayes'' theorem,
    when adapted, becomes the following:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们可能希望将*Temperature*、*Wind*和*Sunshine*作为独立随机变量。扩展后的贝叶斯定理公式如下：
- en: '![](img/92f1bd4b-20e6-47b0-854f-caab5e54c58e.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](img/92f1bd4b-20e6-47b0-854f-caab5e54c58e.png)'
- en: '![](img/41f48dec-1acc-44c9-82ac-da9cead92eec.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/41f48dec-1acc-44c9-82ac-da9cead92eec.png)'
- en: '![](img/e4b560ed-d258-4bf4-9c11-4520aa5329db.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e4b560ed-d258-4bf4-9c11-4520aa5329db.png)'
- en: '![](img/56a1223e-b6d0-4a83-aa29-1dc7c8a24168.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](img/56a1223e-b6d0-4a83-aa29-1dc7c8a24168.png)'
- en: '![](img/005c8a30-7590-450e-b9ce-504018db3fce.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](img/005c8a30-7590-450e-b9ce-504018db3fce.png)'
- en: Let's count the number of columns in the table with all known values to determine
    the individual probabilities.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们计算表格中所有已知值的列数，以确定各个概率。
- en: '*P(Play=Yes)=6/10=3/5*, since there are 10 columns with complete data, and
    *6* of them have the value *Yes* for the attribute *Play*.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '*P(Play=Yes)=6/10=3/5*，因为有10列完整数据，其中*6*列的*Play*属性值为*Yes*。'
- en: '*P(Temperature=Warm|Play=Yes)=3/6=1/2*, since there are *6* columns with the
    value *Yes* for the attribute *Play* and, of those, *3* have the value *Warm*
    for the attribute *Temperature*. Similarly, we have the following:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '*P(Temperature=Warm|Play=Yes)=3/6=1/2*，因为有*6*列的*Play*属性值为*Yes*，其中有*3*列的*Temperature*属性值为*Warm*。同样地，我们得到以下内容：'
- en: '*![](img/18624546-bada-4ea7-9649-ee96875906b4.png)*'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*![](img/18624546-bada-4ea7-9649-ee96875906b4.png)*'
- en: '*![](img/49dc0bc8-1607-4ac8-bbde-d5d434eb01a7.png)*'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*![](img/49dc0bc8-1607-4ac8-bbde-d5d434eb01a7.png)*'
- en: '*![](img/e59f6029-9102-4629-8a66-bf8327219510.png) *'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*![](img/e59f6029-9102-4629-8a66-bf8327219510.png) *'
- en: '*![](img/ca839282-8e05-4444-8dc3-6aeb3033fa2e.png)*'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*![](img/ca839282-8e05-4444-8dc3-6aeb3033fa2e.png)*'
- en: '*![](img/f644f2ce-925d-44e3-b8ab-7c7cf88935cb.png)*'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*![](img/f644f2ce-925d-44e3-b8ab-7c7cf88935cb.png)*'
- en: '*![](img/28d39d67-16b2-4a81-90e6-94e4a234e722.png)*'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*![](img/28d39d67-16b2-4a81-90e6-94e4a234e722.png)*'
- en: 'Thus:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 因此：
- en: '![](img/77863d74-e1c8-41d2-b472-82c68b98a3f9.png)  and ![](img/eecbedd6-3e19-4efb-899a-2792c4a36271.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/77863d74-e1c8-41d2-b472-82c68b98a3f9.png) 和 ![](img/eecbedd6-3e19-4efb-899a-2792c4a36271.png)'
- en: 'Therefore, we have the following:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们得到以下内容：
- en: '![](img/997d4964-fab8-47b0-ae81-cb5fc020c85c.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](img/997d4964-fab8-47b0-ae81-cb5fc020c85c.png)'
- en: This means that our friend is likely to be happy to play chess with us in the
    park in the stated weather conditions, with a probability of about *67%*. Since
    this is a majority, we could classify the data vector (*Temperature=Warm, Wind=Strong,
    Sunshine=Sunny*) as being in the *Play=Yes* class.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着，在给定的天气条件下，我们的朋友很可能会高兴地与我们在公园下棋，概率大约为*67%*。由于这是多数，我们可以将数据向量(*Temperature=Warm,
    Wind=Strong, Sunshine=Sunny*)归类为*Play=Yes*类别。
- en: Implementation of a Naive Bayes classifier
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实现一个朴素贝叶斯分类器
- en: 'In this section, we will implement a program calculating the probability of
    a data item belonging to a certain class by using Bayes'' theorem:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将实现一个程序，通过使用贝叶斯定理来计算一个数据项属于某一类别的概率：
- en: '[PRE0]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'We use the dictionary part from the common library:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用公共库中的字典部分：
- en: '[PRE1]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '**Input**:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '**输入**：'
- en: 'We save the data from the table, for example, the data that is related to playing
    chess playing chess, in the following CSV file:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将与下棋相关的表格数据（例如，关于下棋的数据）保存在以下CSV文件中：
- en: '[PRE2]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '**Output**:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出**：'
- en: 'We provide the `chess.csvfile` as the input to the Python program, calculating
    the probabilities of the data item (*Temperature=Warm, Wind=Strong, Sunshine=Sunny*)
    belonging to the classes present in the file by using `Play=Yes` and `Play=No`.
    As we found out earlier, the data item belongs to the `Play=Yes` class due to
    it having higher probability. Therefore, we classify the data item into that class:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 我们提供`chess.csvfile`作为输入，使用Python程序计算数据项(*Temperature=Warm, Wind=Strong, Sunshine=Sunny*)属于文件中现有类别的概率，分别为`Play=Yes`和`Play=No`。正如我们之前发现的，该数据项属于`Play=Yes`类别，因为其概率较高。因此，我们将数据项归类到该类别中：
- en: '[PRE3]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Playing chess – dependent events
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 玩棋——依赖事件
- en: 'Suppose that we would like to find out whether our friend would like to play
    chess with us in a park in Cambridge, UK. But, this time, we are given different
    input data:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想要了解我们的朋友是否愿意在英国剑桥的公园与我们下棋。但这次，我们提供了不同的输入数据：
- en: '| **Temperature** | **Wind** | **Season** | **Play** |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '| **Temperature** | **Wind** | **Season** | **Play** |'
- en: '| Cold | Strong | Winter | No |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '| 冷 | 强风 | 冬季 | 否 |'
- en: '| Warm | Strong | Autumn | No |'
  id: totrans-110
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 强风 | 秋季 | 否 |'
- en: '| Warm | None | Summer | Yes |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 无 | 夏季 | 是 |'
- en: '| Hot | None | Spring | No |'
  id: totrans-112
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 无 | 春季 | 否 |'
- en: '| Hot | Breeze | Autumn | Yes |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 微风 | 秋季 | 是 |'
- en: '| Warm | Breeze | Spring | Yes |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 微风 | 春季 | 是 |'
- en: '| Cold | Breeze | Winter | No |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
  zh: '| 冷 | 微风 | 冬季 | 否 |'
- en: '| Cold | None | Spring | Yes |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '| 冷 | 无 | 春季 | 是 |'
- en: '| Hot | Strong | Summer | Yes |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 强风 | 夏季 | 是 |'
- en: '| Warm | None | Autumn | Yes |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 无 | 秋季 | 是 |'
- en: '| Warm | Strong | Spring | ? |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 强风 | 春季 | ? |'
- en: So, now we are wondering how the answer to whether our friend would like to
    play in a park in Cambridge, UK, will change with this different data in regard
    to the **Temperature** being **Warm**, the **Wind** being **Strong**, and the
    **Season** being **Spring**.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，现在我们想知道，当数据中**温度**为**温暖**，**风**为**强风**，**季节**为**春季**时，我们朋友是否会在英国剑桥的公园玩耍，答案会如何变化。
- en: Analysis
  id: totrans-121
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分析
- en: We may be tempted to use Bayesian probability to calculate the probability of
    our friend playing chess with us in the park. However, we should be careful, and
    ask whether the probability of the events are independent of each other.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可能会倾向于使用贝叶斯概率来计算我们朋友是否会在公园与我们下棋。然而，我们应该小心，问一下这些事件的概率是否相互独立。
- en: In the previous example, where we used Bayesian probability, we were given the
    probability variables **Temperature**, **Wind**, and **Sunshine**. These are reasonably
    independent. Common sense tells us that a specific **Temperature** and **Sunshine**
    do not have a strong correlation to a specific **Wind** speed. It is true that
    sunny weather results in higher temperatures, but sunny weather is common even
    when the temperatures are very low. Hence, we considered even **Sunshine** and
    **Temperature** as being reasonably independent as random variables and applied
    Bayes' theorem.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的例子中，我们使用了贝叶斯概率，给定的概率变量是**温度**、**风**和**阳光**。这些变量是合理独立的。常识告诉我们，特定的**温度**和**阳光**与特定的**风速**之间并没有强相关性。的确，阳光明媚的天气会带来更高的气温，但即使温度很低，阳光明媚的天气也很常见。因此，我们认为即使是**阳光**和**温度**作为随机变量也是合理独立的，并应用了贝叶斯定理。
- en: However, in this example, **Temperature** and **Season** are closely related,
    especially in a location such as the UK, our stated location for the park. Unlike
    countries closer to the equator, temperatures in the UK vary greatly throughout
    the year. Winters are cold and summers are hot. Spring and fall have temperatures
    in between.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在这个例子中，**温度**和**季节**是紧密相关的，特别是在像英国这样的位置——我们所说的公园所在地。与靠近赤道的国家不同，英国的气温全年变化很大。冬天很冷，夏天很热。春天和秋天的气温介于其中。
- en: Therefore, we cannot apply Bayes' theorem here, as the random variables are
    dependent. However, we could still perform some analysis by using Bayes' theorem
    on the partial data. By eliminating sufficient dependent variables, the remaining
    ones could turn out to be independent. Since **Temperature** is a more specific
    variable than **Season**, and the two variables are dependent, let's keep just
    the **Temperature** variable. The remaining two variables, **Temperature** and
    **Wind**, are independent.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们不能在这里应用贝叶斯定理，因为这些随机变量是相关的。然而，我们仍然可以通过对部分数据使用贝叶斯定理来进行一些分析。通过消除足够的相关变量，剩余的变量可能会变得独立。由于**温度**比**季节**更为具体，且这两个变量是相关的，因此我们只保留**温度**变量。剩下的两个变量，**温度**和**风**，是独立的。
- en: 'Thus, we get the following data:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们得到以下数据：
- en: '| **Temperature** | **Wind** | **Play** |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| **温度** | **风** | **下棋** |'
- en: '| Cold | Strong | No |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| 冷 | 强风 | 否 |'
- en: '| Warm | Strong | No |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 强风 | 否 |'
- en: '| Warm | None | Yes |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 无 | 是 |'
- en: '| Hot | None | No |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 无 | 否 |'
- en: '| Hot | Breeze | Yes |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 微风 | 是 |'
- en: '| Warm | Breeze | Yes |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 微风 | 是 |'
- en: '| Cold | Breeze | No |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| 冷 | 微风 | 否 |'
- en: '| Cold | None | Yes |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| 冷 | 无 | 是 |'
- en: '| Hot | Strong | Yes |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| 热 | 强风 | 是 |'
- en: '| Warm | None | Yes |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 无 | 是 |'
- en: '| Warm | Strong | ? |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| 温暖 | 强风 | ? |'
- en: We can keep the duplicate rows, as they give us greater evidence of the occurrence
    of that specific data row.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以保留重复的行，因为它们提供了该特定数据行发生的更多证据。
- en: '**Input**:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '**输入**：'
- en: 'Saving the table, we get the following CSV file:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 保存该表格，我们得到以下CSV文件：
- en: '[PRE4]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '**Output**:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '**输出**：'
- en: 'We input the saved CSV file into the `naive_bayes.py` program and we get the
    following result:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将保存的CSV文件输入到`naive_bayes.py`程序中，得到了以下结果：
- en: '[PRE5]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The first class, `Yes`, is going to be true, with a probability of 50%. The
    numerical difference resulted from using Python's non-exact arithmetic on the
    float numerical data type. The second class, `No`, has the same probability, that
    is, 50%, of being true. Thus, we cannot make a reasonable conclusion with the
    data that we have about the class of the vector (`Warm`, `Strong`). However, you
    have probably already noticed that this vector already occurs in the table with
    the resulting class `No`. Hence, our guess would be that this vector should just
    happen to exist in one class, `No`. But, to have greater statistical confidence,
    we would need more data or more independent variables to be involved.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个类别 `Yes` 有50%的概率为真。由于使用Python的非精确浮点数算术导致数值上的差异。第二个类别 `No` 也有相同的50%概率为真。因此，根据我们目前的数据，我们无法对向量的类别（`温暖`，`强`）做出合理的结论。然而，您可能已经注意到，这个向量已经在具有结果类别
    `No` 的表格中出现。因此，我们的猜测是，这个向量应该刚好存在于一个类别 `No` 中。但是，要有更高的统计置信度，我们需要更多的数据或涉及更多的独立变量。
- en: Gender classification – Bayes for continuous random variables
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 性别分类 – 连续随机变量的贝叶斯方法
- en: So far, we have been given a probability event that belonged to one of a finite
    number of classes, for example, a temperature was classified as cold, warm, or
    hot. But how would we calculate the posterior probability if we were given the
    temperature in °C instead?
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经得到了属于有限数量类别中的一个概率事件，例如，一个温度被分类为冷、温暖或热。但是如果我们获得的是以°C为单位的温度，我们如何计算后验概率呢？
- en: 'For this example, we are given the heights of five men and five women, as shown
    in the following table:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们得到了五名男性和五名女性的身高数据，如下表所示：
- en: '| **Height in cm** | **Gender** |'
  id: totrans-150
  prefs: []
  type: TYPE_TB
  zh: '| **身高（厘米）** | **性别** |'
- en: '| 180 | Male |'
  id: totrans-151
  prefs: []
  type: TYPE_TB
  zh: '| 180 | 男性 |'
- en: '| 174 | Male |'
  id: totrans-152
  prefs: []
  type: TYPE_TB
  zh: '| 174 | 男性 |'
- en: '| 184 | Male |'
  id: totrans-153
  prefs: []
  type: TYPE_TB
  zh: '| 184 | 男性 |'
- en: '| 168 | Male |'
  id: totrans-154
  prefs: []
  type: TYPE_TB
  zh: '| 168 | 男性 |'
- en: '| 178 | Male |'
  id: totrans-155
  prefs: []
  type: TYPE_TB
  zh: '| 178 | 男性 |'
- en: '| 170 | Female |'
  id: totrans-156
  prefs: []
  type: TYPE_TB
  zh: '| 170 | 女性 |'
- en: '| 164 | Female |'
  id: totrans-157
  prefs: []
  type: TYPE_TB
  zh: '| 164 | 女性 |'
- en: '| 155 | Female |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| 155 | 女性 |'
- en: '| 162 | Female |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| 162 | 女性 |'
- en: '| 166 | Female |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| 166 | 女性 |'
- en: '| 172 | ? |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| 172 | ? |'
- en: Suppose that the next person has a height of 172 cm. What gender is that person
    more likely to be, and with what probability?
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 假设下一个人的身高为172厘米。那么这个人更可能是什么性别，以及概率是多少？
- en: Analysis
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分析
- en: One approach to solving this problem could be to assign classes to the numerical
    values; for example, the people with a height of between 170 cm and 179 cm would
    be in the same class. With this approach, we may end up with a few classes that
    are very wide, for example, with a high cm range, or with classes that are more
    precise but have fewer members, and so we cannot use the full potential of the
    Bayes classifier. Similarly, using this method, we would not consider the classes
    of height interval (170, 180) and (180, 190) in centimeters, to be closer to each
    other than the classes (170, 180) and (190, 200).
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 解决这个问题的一种方法是为数值赋予类别；例如，身高在170厘米和179厘米之间的人将属于同一类。使用这种方法，我们可能会得到一些非常宽的类，例如，具有较高厘米范围的类，或者具有更精确但成员较少的类，因此我们不能充分利用贝叶斯分类器的全部潜力。同样地，使用这种方法，我们不会考虑身高区间（170,
    180）和（180, 190）之间的类比考虑（170, 180）和（190, 200）之间的类更接近。
- en: 'Let''s remind ourselves of the Bayes'' formula here:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在这里回顾一下贝叶斯公式：
- en: '![](img/4065676f-213a-496e-bd48-07eb551ed0ea.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4065676f-213a-496e-bd48-07eb551ed0ea.png)'
- en: '![](img/94706b71-4c4e-4397-8eb0-4b09d25dc2b2.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![](img/94706b71-4c4e-4397-8eb0-4b09d25dc2b2.png)'
- en: Expressing the formula in the final form shown here removes the need to normalize
    the *P(height|male)* and *P(height)* to get the correct probability of a person
    being male based on their height.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里表达出最终形式的公式消除了归一化 *P(身高|男性)* 和 *P(身高)* 以获得基于身高判断一个人是男性的正确概率的需要。
- en: 'Assuming that the height of people is distributed normally, we could use a
    normal probability distribution to calculate *P(male|height)*. We assume that *P(male)=0.5*,
    that is, it is equally likely that the person to be measured is of either gender.
    A normal probability distribution is determined by the mean, μ, and the variance, *σ²*,
    of the population:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 假设人们的身高服从正态分布，我们可以使用正态概率分布来计算 *P(男性|身高)*。我们假设 *P(男性)=0.5*，即被测量的人是男性或女性的可能性相等。正态概率分布由总体的均值μ和方差
    *σ²* 决定：
- en: '![](img/9e873050-d211-4beb-a2aa-71d9e92b60d1.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9e873050-d211-4beb-a2aa-71d9e92b60d1.png)'
- en: 'The following table shows the mean height and variance by gender:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 下表显示了按性别分组的平均身高和方差：
- en: '| **Gender** | **Mean height** | **Height variance** |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| **性别** | **平均身高** | **身高方差** |'
- en: '| Male | 176.8 | 37.2 |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| 男性 | 176.8 | 37.2 |'
- en: '| Female | 163.4 | 30.8 |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| 女性 | 163.4 | 30.8 |'
- en: 'Thus, we could calculate the following:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以计算以下内容：
- en: '![](img/b09b6973-a133-4315-90af-45500ef2010d.png)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b09b6973-a133-4315-90af-45500ef2010d.png)'
- en: '![](img/c217fffa-8ec2-4fcf-9a6c-26ee7e8c1f97.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c217fffa-8ec2-4fcf-9a6c-26ee7e8c1f97.png)'
- en: 'Note that these are not the probabilities, just the values of the probability
    density function. However, from these values, we can already observe that a person
    with a height of 172 cm is more likely to be male than female because, as follows:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这些不是概率值，而是概率密度函数的值。然而，从这些值中，我们可以观察到，身高为172厘米的人更有可能是男性而不是女性，原因如下：
- en: '![](img/d0f50b50-b969-498a-9dd4-cf33f29b3ff2.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d0f50b50-b969-498a-9dd4-cf33f29b3ff2.png)'
- en: 'To be more precise:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 更准确地说：
- en: '![](img/fb09d676-5919-46b8-a422-726f60fb9607.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fb09d676-5919-46b8-a422-726f60fb9607.png)'
- en: '![](img/3da3fe22-f207-4c58-a2dd-e775312e98e3.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3da3fe22-f207-4c58-a2dd-e775312e98e3.png)'
- en: Therefore, the probability of a person with a height of *172* cm being male
    is of *68.9%*.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，身高为*172*厘米的人是男性的概率为*68.9%*。
- en: Summary
  id: totrans-184
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we learned about Naive Bayes and how it can be applied in different
    ways for different purposes.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们学习了朴素贝叶斯算法及其在不同场景下的应用。
- en: 'Bayes'' theorem states the following:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 贝叶斯定理如下所述：
- en: '![](img/5d22360b-62a2-4229-b95f-3863b4a71b76.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5d22360b-62a2-4229-b95f-3863b4a71b76.png)'
- en: 'Here, *P(A|B)* is the conditional probability of *A* being true, given that *B* is
    true. It is used to update the value of the probability that *A* is true given
    the new observations about other probabilistic events. This theorem can be extended
    to a statement with multiple random variables:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*P(A|B)*是条件概率，即在*B*为真的情况下，*A*为真的概率。它用于更新在新的观测值下，*A*为真时的概率值。这个定理可以扩展到含有多个随机变量的命题：
- en: '![](img/7aab5897-71b6-48e3-8cba-88fdbac84ace.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7aab5897-71b6-48e3-8cba-88fdbac84ace.png)'
- en: The random variables *B1,...,Bn* have to be conditionally independent given *A*.
    The random variables can be discrete or continuous and follow a probability distribution,
    for example, normal (Gaussian) distribution.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 随机变量*B1,...,Bn*在给定*A*的条件下需要相互独立。这些随机变量可以是离散的或连续的，并且遵循概率分布，例如正态（高斯）分布。
- en: We also studied the discrete random variable. We learned that it is best to
    ensure that you have a data item for each value of a discrete random variable
    given any of the conditions (with a value of *A*) by collecting sufficient data.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还研究了离散随机变量。我们了解到，最佳做法是通过收集足够的数据，确保在给定任何条件（具有值*A*）的情况下，为离散随机变量的每个值收集一个数据项。
- en: The more independent random variables we have, the more accurately we can determine
    the posterior probability. However, the greater danger is that some of these variables
    could be dependent, resulting in imprecise final results. When variables are dependent,
    we may eliminate some of the dependent variables and consider only mutually independent
    variables, or consider another algorithm as an approach to solving the data science
    problem.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 随着独立随机变量的增多，我们可以更准确地确定后验概率。然而，更大的危险在于，这些变量中的某些可能是相关的，导致最终结果不准确。当变量相关时，我们可以去除一些相关变量，只考虑相互独立的变量，或考虑采用其他算法来解决数据科学问题。
- en: In the next chapter, we will learn how to classify an element with a decision
    tree algorithm.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何使用决策树算法对元素进行分类。
- en: Problems
  id: totrans-194
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: '**Problem 1**: A patient is tested for a virus, *V*. The accuracy of the test
    is 98%. This virus, *V*, is currently present in 4 out of 100 people in the region
    the patient lives in:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 1**：一名患者接受病毒*V*的检测，测试的准确率为98%。该病毒*V*在患者所在地区每100人中有4人感染：'
- en: a) What is the probability that a patient having the virus, *V*, if they test
    positive?
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: a) 如果患者检测结果为阳性，患者感染病毒*V*的概率是多少？
- en: b) What is the probability of a patient still having the virus if the result
    of the test is negative?
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: b) 如果测试结果为阴性，患者仍然感染病毒的概率是多少？
- en: '**Problem 2**: Apart from assessing whether patients are suffering from the
    virus, *V* (in *Problem 1*), by using the test, a doctor usually also checks for
    other symptoms. According to a doctor, about 85% of patients with symptoms such
    as fever, nausea, abdominal discomfort, and malaise have the virus, *V*:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 2**：除了评估患者是否感染病毒*V*（见**问题 1**）外，医生通常还会检查其他症状。根据一位医生的说法，大约85%的患者在出现发热、恶心、腹部不适和乏力等症状时，感染了病毒*V*：'
- en: a) What is the probability of a patient having the virus, *V*, if they have
    the symptoms mentioned previously and their test result for the virus is positive?
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: a) 如果病人出现了之前提到的症状，并且病毒检测结果为阳性，病人感染病毒*V*的概率是多少？
- en: b) How likely is it that the patient has the virus if they have the symptoms
    mentioned previously, but the result of the test is negative?
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: b) 如果病人出现了之前提到的症状，但测试结果为阴性，病人感染病毒的概率有多大？
- en: '**Problem 3**: On a certain island, one in two tsunamis is preceded by an earthquake.
    There have been 4 tsunamis and 6 earthquakes in the past 100 years. A seismological
    station recorded an earthquake in the ocean near the island. What is the probability
    that it will result in a tsunami?'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 3**：在某个岛屿上，每两个海啸中就有一个是由地震引发的。过去100年内发生了4次海啸和6次地震。一个地震站记录到岛屿附近海洋发生了地震。这个地震会导致海啸的概率是多少？'
- en: '**Problem 4**: Patients are tested with four independent tests to ascertain
    whether they have a certain illness:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 4**：病人接受四项独立测试，以确定是否患有某种疾病：'
- en: '| **Test1 positive** | **Test2 positive** | **Test3 positive** | **Test4 positive**
    | **Illness** |'
  id: totrans-203
  prefs: []
  type: TYPE_TB
  zh: '| **Test1 阳性** | **Test2 阳性** | **Test3 阳性** | **Test4 阳性** | **疾病** |'
- en: '| Yes | Yes | Yes | No | Yes |'
  id: totrans-204
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 是 | 是 | 否 | 是 |'
- en: '| Yes | Yes | No | Yes | Yes |'
  id: totrans-205
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 是 | 否 | 是 | 是 |'
- en: '| No | Yes | No | No | No |'
  id: totrans-206
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 是 | 否 | 否 | 否 |'
- en: '| Yes | No | No | No | No |'
  id: totrans-207
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 否 | 否 | 否 | 否 |'
- en: '| No | No | No | No | No |'
  id: totrans-208
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 否 | 否 | 否 | 否 |'
- en: '| Yes | Yes | Yes | Yes | Yes |'
  id: totrans-209
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 是 | 是 | 是 | 是 |'
- en: '| Yes | No | Yes | Yes | Yes |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 否 | 是 | 是 | 是 |'
- en: '| No | Yes | No | No | No |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 是 | 否 | 否 | 否 |'
- en: '| No | No | Yes | Yes | No |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 否 | 是 | 是 | 否 |'
- en: '| Yes | Yes | No | Yes | Yes |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 是 | 否 | 是 | 是 |'
- en: '| Yes | No | Yes | No | Yes |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 否 | 是 | 否 | 是 |'
- en: '| Yes | No | No | Yes | Yes |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 否 | 否 | 是 | 是 |'
- en: '| No | Yes | Yes | No | ? |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 是 | 是 | 否 | ? |'
- en: We have taken a new patient, for whom the second and third tests are positive,
    while the first and fourth tests are negative. What is the probability that they
    suffer from the illness?
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接诊了一位新病人，第二项和第三项测试为阳性，而第一项和第四项测试为阴性。该病人患有该疾病的概率是多少？
- en: '**Problem 5**: We are given the following table of words that have featured
    in emails and whether or not those emails were spam:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 5**：我们给出以下包含在邮件中的词汇及这些邮件是否为垃圾邮件的数据：'
- en: '| **Money** | **Free** | **Rich** | **Naughty** | **Secret** | **Spam** |'
  id: totrans-219
  prefs: []
  type: TYPE_TB
  zh: '| **Money** | **Free** | **Rich** | **Naughty** | **Secret** | **Spam** |'
- en: '| No | No | Yes | No | Yes | Yes |'
  id: totrans-220
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 否 | 是 | 否 | 是 | 是 |'
- en: '| Yes | Yes | Yes | No | No | Yes |'
  id: totrans-221
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 是 | 是 | 否 | 否 | 是 |'
- en: '| No | No | No | No | No | No |'
  id: totrans-222
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 否 | 否 | 否 | 否 | 否 |'
- en: '| No | Yes | No | No | No | Yes |'
  id: totrans-223
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 是 | 否 | 否 | 否 | 是 |'
- en: '| Yes | No | No | No | No | No |'
  id: totrans-224
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 否 | 否 | 否 | 否 | 否 |'
- en: '| No | Yes | No | Yes | Yes | Yes |'
  id: totrans-225
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 是 | 否 | 是 | 是 | 是 |'
- en: '| No | Yes | No | Yes | No | Yes |'
  id: totrans-226
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 是 | 否 | 是 | 否 | 是 |'
- en: '| No | No | No | Yes | No | Yes |'
  id: totrans-227
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 否 | 否 | 是 | 否 | 是 |'
- en: '| No | Yes | No | No | No | No |'
  id: totrans-228
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 是 | 否 | 否 | 否 | 否 |'
- en: '| No | No | No | No | Yes | No |'
  id: totrans-229
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 否 | 否 | 否 | 是 | 否 |'
- en: '| Yes | Yes | Yes | No | Yes | Yes |'
  id: totrans-230
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 是 | 是 | 否 | 是 | 是 |'
- en: '| Yes | No | No | No | Yes | Yes |'
  id: totrans-231
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 否 | 否 | 否 | 是 | 是 |'
- en: '| No | Yes | Yes | No | No | No |'
  id: totrans-232
  prefs: []
  type: TYPE_TB
  zh: '| 否 | 是 | 是 | 否 | 否 | 否 |'
- en: '| Yes | No | Yes | No | Yes | ? |'
  id: totrans-233
  prefs: []
  type: TYPE_TB
  zh: '| 是 | 否 | 是 | 否 | 是 | ? |'
- en: a) Create a Naive Bayes algorithm to determine whether or not a given email
    is a spam message. What is the result when given an email that contains the words
    **Money**, **Rich**, and **Secret**, but does not contain the words **Free** and
    **Naughty**?
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: a) 创建一个朴素贝叶斯算法来判断一封邮件是否为垃圾邮件。当一封邮件包含**Money**、**Rich**和**Secret**这几个词，但不包含**Free**和**Naughty**时，算法的结果是什么？
- en: b) Do you agree with the result of the algorithm? Is the Naive Bayes algorithm,
    as used here, a good method for classifying emails? Justify your answers.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: b) 你同意算法的结果吗？在这里使用的朴素贝叶斯算法，作为分类邮件的好方法吗？请证明你的回答。
- en: '**Problem 6**: This is a gender classification problem. Let''s assume that
    we are given the following data about ten people:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 6**：这是一个性别分类问题。假设我们有关于十个人的以下数据：'
- en: '| **Height in cm** | **Weight in kg** | **Hair length** | **Gender** |'
  id: totrans-237
  prefs: []
  type: TYPE_TB
  zh: '| **身高（厘米）** | **体重（千克）** | **发长** | **性别** |'
- en: '| 180 | 75 | Short | Male |'
  id: totrans-238
  prefs: []
  type: TYPE_TB
  zh: '| 180 | 75 | 短 | 男 |'
- en: '| 174 | 71 | Short | Male |'
  id: totrans-239
  prefs: []
  type: TYPE_TB
  zh: '| 174 | 71 | 短 | 男 |'
- en: '| 184 | 83 | Short | Male |'
  id: totrans-240
  prefs: []
  type: TYPE_TB
  zh: '| 184 | 83 | 短 | 男 |'
- en: '| 168 | 63 | Short | Male |'
  id: totrans-241
  prefs: []
  type: TYPE_TB
  zh: '| 168 | 63 | 短 | 男 |'
- en: '| 178 | 70 | Long | Male |'
  id: totrans-242
  prefs: []
  type: TYPE_TB
  zh: '| 178 | 70 | 长 | 男 |'
- en: '| 170 | 59 | Long | Female |'
  id: totrans-243
  prefs: []
  type: TYPE_TB
  zh: '| 170 | 59 | 长 | 女 |'
- en: '| 164 | 53 | Short | Female |'
  id: totrans-244
  prefs: []
  type: TYPE_TB
  zh: '| 164 | 53 | 短 | 女 |'
- en: '| 155 | 46 | Long | Female |'
  id: totrans-245
  prefs: []
  type: TYPE_TB
  zh: '| 155 | 46 | 长 | 女 |'
- en: '| 162 | 52 | Long | Female |'
  id: totrans-246
  prefs: []
  type: TYPE_TB
  zh: '| 162 | 52 | 长 | 女 |'
- en: '| 166 | 55 | Long | Female |'
  id: totrans-247
  prefs: []
  type: TYPE_TB
  zh: '| 166 | 55 | 长 | 女 |'
- en: '| 172 | 60 | Long | ? |'
  id: totrans-248
  prefs: []
  type: TYPE_TB
  zh: '| 172 | 60 | 长 | ? |'
- en: What is the probability that the 11th person, with a height of 172 cm, a weight
    of 60 kg, and long hair, is a man?
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 第 11 个人，身高 172 cm，体重 60 kg，长发的情况下，他是男性的概率是多少？
- en: Analysis
  id: totrans-250
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分析
- en: '**Problem 1**: Before the patient is given the test, the probability that they
    have the virus is 4%, `P(virus)=4%=0.04`. The accuracy of the test is `test_accuracy=98%=0.98`.
    We apply the formula from the medical test example:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 1**：在患者接受测试之前，他们患有病毒的概率是 4%，`P(virus)=4%=0.04`。测试的准确性为 `test_accuracy=98%=0.98`。我们应用医学测试示例中的公式：'
- en: '![](img/dc1aa0f8-2719-43ef-b4f2-787caf38b22a.png)'
  id: totrans-252
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dc1aa0f8-2719-43ef-b4f2-787caf38b22a.png)'
- en: '![](img/28e07d40-bc73-420b-b2d9-f34c6dc01780.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![](img/28e07d40-bc73-420b-b2d9-f34c6dc01780.png)'
- en: '![](img/e3cb7891-2def-442f-a927-7301ec9b898f.png)'
  id: totrans-254
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e3cb7891-2def-442f-a927-7301ec9b898f.png)'
- en: 'Therefore, we have the following:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们有以下公式：
- en: '![](img/5aed8c3d-b9e3-4b07-9854-b9754706737d.png)'
  id: totrans-256
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5aed8c3d-b9e3-4b07-9854-b9754706737d.png)'
- en: '![](img/b376c15a-2e14-4a7e-9d35-3ca0f8c3fb12.png)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b376c15a-2e14-4a7e-9d35-3ca0f8c3fb12.png)'
- en: '![](img/9ab31095-5143-42d8-944c-fb99a7237905.png)'
  id: totrans-258
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9ab31095-5143-42d8-944c-fb99a7237905.png)'
- en: '![](img/a4a11a40-2b4e-4508-8238-68ce149be36b.png)'
  id: totrans-259
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a4a11a40-2b4e-4508-8238-68ce149be36b.png)'
- en: 'This means that there is a probability of about 67% that the patient has the
    virus, *V*, if the result of the test is positive:'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着，如果测试结果为阳性，患者患有病毒 *V* 的概率约为 67%：
- en: '![](img/8fe1c210-e01c-4767-b2ff-85ff40b2884b.png)  ![](img/1da1d2dc-4191-4858-ad2c-8650ba72ef0e.png)'
  id: totrans-261
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8fe1c210-e01c-4767-b2ff-85ff40b2884b.png)  ![](img/1da1d2dc-4191-4858-ad2c-8650ba72ef0e.png)'
- en: '![](img/81fada1b-643c-4a6a-b3b1-d40a8af050bf.png)'
  id: totrans-262
  prefs: []
  type: TYPE_IMG
  zh: '![](img/81fada1b-643c-4a6a-b3b1-d40a8af050bf.png)'
- en: '![](img/3f8aa57e-59d5-4d3f-8c62-03b4a13d839b.png)'
  id: totrans-263
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3f8aa57e-59d5-4d3f-8c62-03b4a13d839b.png)'
- en: '![](img/42741e2f-5561-4559-a5e4-447886bddd91.png)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![](img/42741e2f-5561-4559-a5e4-447886bddd91.png)'
- en: If the test is negative, a patient can still have the virus, V, with a probability
    of 0.08%.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 如果测试结果为阴性，患者仍然可能携带病毒 *V*，概率为 0.08%。
- en: '**Problem 2**: Here, we can assume that symptoms and a positive test result
    are conditionally independent events given that a patient has the virus, *V*.
    The variables we have are as follows:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 2**：在这里，我们可以假设给定患者已感染病毒 *V* 的情况下，症状和阳性测试结果是条件独立的事件。我们有以下变量：'
- en: '![](img/f46385f4-8c9d-4542-a64b-26f4f91f5534.png)'
  id: totrans-267
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f46385f4-8c9d-4542-a64b-26f4f91f5534.png)'
- en: '![](img/935aabe7-095c-4dd5-b8c9-0439eb6d2461.png)'
  id: totrans-268
  prefs: []
  type: TYPE_IMG
  zh: '![](img/935aabe7-095c-4dd5-b8c9-0439eb6d2461.png)'
- en: '![](img/71046b30-50a7-41ba-9a27-31d49e523af1.png)'
  id: totrans-269
  prefs: []
  type: TYPE_IMG
  zh: '![](img/71046b30-50a7-41ba-9a27-31d49e523af1.png)'
- en: 'Since we have two independent random variables, we will use an extended Bayes''
    theorem:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们有两个独立的随机变量，因此我们将使用扩展的贝叶斯定理：
- en: a) ![](img/8906397d-4a1c-4dba-b313-9dede2e3085f.png)
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: a) ![](img/8906397d-4a1c-4dba-b313-9dede2e3085f.png)
- en: '![](img/c78c1ea1-4431-4b95-9e0a-27b4ef2fa01a.png)'
  id: totrans-272
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c78c1ea1-4431-4b95-9e0a-27b4ef2fa01a.png)'
- en: '![](img/621859bc-e83d-4d07-9928-c8f61b01a426.png)'
  id: totrans-273
  prefs: []
  type: TYPE_IMG
  zh: '![](img/621859bc-e83d-4d07-9928-c8f61b01a426.png)'
- en: '![](img/74c720e9-7880-48bd-ab49-bf0dc3b6ebd4.png)'
  id: totrans-274
  prefs: []
  type: TYPE_IMG
  zh: '![](img/74c720e9-7880-48bd-ab49-bf0dc3b6ebd4.png)'
- en: '![](img/84f2c052-cd38-4316-9540-bb217c5703c6.png)'
  id: totrans-275
  prefs: []
  type: TYPE_IMG
  zh: '![](img/84f2c052-cd38-4316-9540-bb217c5703c6.png)'
- en: '![](img/81037bed-996f-47a3-827e-1b27f69f59bd.png)'
  id: totrans-276
  prefs: []
  type: TYPE_IMG
  zh: '![](img/81037bed-996f-47a3-827e-1b27f69f59bd.png)'
- en: '![](img/83aa2fcc-5511-41a8-8533-5fa7651ad7c6.png)'
  id: totrans-277
  prefs: []
  type: TYPE_IMG
  zh: '![](img/83aa2fcc-5511-41a8-8533-5fa7651ad7c6.png)'
- en: '![](img/afe1c7dd-5163-42aa-a5ab-d14103f8fb43.png)'
  id: totrans-278
  prefs: []
  type: TYPE_IMG
  zh: '![](img/afe1c7dd-5163-42aa-a5ab-d14103f8fb43.png)'
- en: So, a patient with symptoms of the virus, *V*, and a positive test result for
    the virus has the virus with a probability of approximately 92%.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，患者如果有病毒 *V* 的症状，并且测试结果为阳性，则该患者有大约 92% 的概率是感染了病毒。
- en: Note that in the previous question, we learned that a patient has the virus
    with a probability of only about 67%, given that the result of the test was positive.
    But after adding another independent random variable, the probability increased
    to 92%, even though the symptom assessment was reliable only on 85% of patients.
    This implies that usually, it is a very good idea to add as many independent random
    variables as possible to calculate the posterior probability with a higher accuracy
    and confidence.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，在前一个问题中，我们得知在测试结果为阳性的情况下，患者患有病毒的概率仅约为 67%。但是，在加入另一个独立随机变量后，即使症状评估仅对 85%
    的患者可靠，概率也提高到了 92%。这意味着通常，加入尽可能多的独立随机变量来计算后验概率，以提高准确性和信心，是一个非常好的选择。
- en: 'b) Here, the patient has symptoms of the virus, *V*, but the result of the
    test is negative. Thus, we have the following:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: b) 在这里，患者有病毒 *V* 的症状，但测试结果为阴性。因此，我们有以下内容：
- en: '![](img/37316f38-35b8-4554-a249-d64fd87d3e2c.png)'
  id: totrans-282
  prefs: []
  type: TYPE_IMG
  zh: '![](img/37316f38-35b8-4554-a249-d64fd87d3e2c.png)'
- en: '![](img/61381a17-2a9f-467b-aee1-786a38941113.png)'
  id: totrans-283
  prefs: []
  type: TYPE_IMG
  zh: '![](img/61381a17-2a9f-467b-aee1-786a38941113.png)'
- en: '![](img/e3876435-dc39-4adb-a5a9-b7318b1d5973.png)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e3876435-dc39-4adb-a5a9-b7318b1d5973.png)'
- en: '![](img/cb9b5a57-2971-4b5c-b96a-73736ef8f6cb.png)'
  id: totrans-285
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cb9b5a57-2971-4b5c-b96a-73736ef8f6cb.png)'
- en: '![](img/a927d5f6-5c02-4cb5-a8e5-e5c41220ec00.png)'
  id: totrans-286
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a927d5f6-5c02-4cb5-a8e5-e5c41220ec00.png)'
- en: '![](img/d33f112e-aa5c-45f6-bf06-90dc921f53fe.png)'
  id: totrans-287
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d33f112e-aa5c-45f6-bf06-90dc921f53fe.png)'
- en: '![](img/33a28454-1784-4cf6-b285-453db7c3d609.png)'
  id: totrans-288
  prefs: []
  type: TYPE_IMG
  zh: '![](img/33a28454-1784-4cf6-b285-453db7c3d609.png)'
- en: '![](img/05029050-7378-4e07-8ca5-f21f8f6950d2.png)'
  id: totrans-289
  prefs: []
  type: TYPE_IMG
  zh: '![](img/05029050-7378-4e07-8ca5-f21f8f6950d2.png)'
- en: Thus, a patient testing negative with regard to the test, but with symptoms
    of the virus, *V*, has a probability of 0.48% of having the virus.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，某患者在测试中结果为阴性，但有病毒症状*V*，其感染病毒的概率为0.48%。
- en: '**Problem 3**: We apply the basic form of Bayes'' theorem:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 3**：我们应用了贝叶斯定理的基本形式：'
- en: '![](img/35a6fedd-b2a7-4c7f-8ae6-84e76434a3f0.png)'
  id: totrans-292
  prefs: []
  type: TYPE_IMG
  zh: '![](img/35a6fedd-b2a7-4c7f-8ae6-84e76434a3f0.png)'
- en: '![](img/d3bc5df0-a7f0-4767-a795-edfdef073037.png)'
  id: totrans-293
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d3bc5df0-a7f0-4767-a795-edfdef073037.png)'
- en: '![](img/997c5842-638a-40d4-b7f0-c299188fc98f.png)'
  id: totrans-294
  prefs: []
  type: TYPE_IMG
  zh: '![](img/997c5842-638a-40d4-b7f0-c299188fc98f.png)'
- en: There is a 33% chance that there will be a tsunami following the recorded earthquake.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 记录到的地震后，发生海啸的概率为33%。
- en: Note that, here, we set *P(tsunami)* to be the probability of a tsunami happening
    on some particular day in the past 100 years. We used a day as a unit to calculate
    the probability *P(earthquake)* as well. If we changed the unit to an hour, week,
    month, and so on for both *P(tsunami)* and *P(earthquake)*, the result would still
    be the same. What is important in the calculation is the ratio *P(tsunami):P(earthquake)=4:6=2/3:1*,
    that is, that a tsunami is about 66% more likely to happen than an earthquake.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这里我们将*P(海啸)*设置为过去100年某一天发生海啸的概率。我们也使用了一天作为单位来计算*P(地震)*的概率。如果我们将单位改为小时、周、月等，*P(海啸)*和*P(地震)*的结果仍然会保持不变。计算中的关键在于比例*P(海啸):P(地震)=4:6=2/3:1*，也就是说，海啸发生的概率大约是地震的66%。
- en: '**Problem 4**: We put the data into the program for calculating the posterior
    probability from the observations and get the following result:'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 4**：我们将数据输入程序，计算从观测数据得出的后验概率，得到以下结果：'
- en: '*[[''No'', ''Yes'', ''Yes'', ''No'', {''Yes'': 0.0, ''No'': 1.0}]]*'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: '*[[''否'', ''是'', ''是'', ''否'', {''是'': 0.0, ''否'': 1.0}]]*'
- en: According to this calculation, a patient tested should not suffer from the virus.
    However, the probability of *'No'* seems quite high. It may be a good idea to
    get more data in order to obtain a more precise estimate of the probability of
    the patient being healthy.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 根据这个计算，患者应当没有感染病毒。然而，*'否'*的概率似乎相当高。为了获得更精确的健康概率估计，获取更多的数据可能是个好主意。
- en: '**Problem 5**:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 5**：'
- en: 'a) The result of the algorithm is as follows:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: a) 算法的结果如下：
- en: '*[[''Yes'', ''No'', ''Yes'', ''No'', ''Yes'', {''Yes'': 0.8459918784779665,
    ''No'': 0.15400812152203341}]]*'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: '*[[''是'', ''否'', ''是'', ''否'', ''是'', {''是'': 0.8459918784779665, ''否'': 0.15400812152203341}]]*'
- en: So, according to the Naive Bayes algorithm, when applied to the data in the
    table, the email is spam with a probability of about 85%.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，根据朴素贝叶斯算法，当应用于表格中的数据时，电子邮件是垃圾邮件的概率大约为85%。
- en: b)  This method may not be as good since the occurrence of certain words in
    a spam email is not independent. For example, spam emails containing the word
    "money" would likely try to convince the victim of a spam email that they could
    somehow get money from the spammer, and hence, other words, such as **Rich**,
    **Secret**, or **Free** are more likely to be present in such an email as well.
    The nearest neighbor algorithm would seem to perform better at spam email classification.
    You could verify the actual methods by using cross-validation.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: b) 这种方法可能不如预期，因为垃圾邮件中某些词语的出现并不是独立的。例如，包含“money”（钱）一词的垃圾邮件，通常会试图说服受害者相信他们可以通过垃圾邮件发送者获得金钱，因此其他词语，如**Rich**（富有）、**Secret**（秘密）或**Free**（免费）等，更有可能出现在这类邮件中。最近邻算法在垃圾邮件分类中可能表现得更好。你可以通过交叉验证来验证实际方法。
- en: '**Problem 6**: For this problem, we will use the extended Bayes'' theorem for
    both continuous and discrete random variables:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题 6**：对于这个问题，我们将使用扩展的贝叶斯定理，适用于连续和离散随机变量：'
- en: '![](img/1dde7a8e-2292-425d-a96e-fc6d4a267b73.png)'
  id: totrans-306
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1dde7a8e-2292-425d-a96e-fc6d4a267b73.png)'
- en: '![](img/ff8dcb78-c7fe-4b51-89af-c29cf6119772.png)'
  id: totrans-307
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ff8dcb78-c7fe-4b51-89af-c29cf6119772.png)'
- en: '![](img/7e147f51-fd63-49d4-8b98-885ff7da1b5e.png)'
  id: totrans-308
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7e147f51-fd63-49d4-8b98-885ff7da1b5e.png)'
- en: 'Let''s summarize the given information in the following tables:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过以下表格总结给定的信息：
- en: '| **Gender** | **Mean height** | **Variance in height** |'
  id: totrans-310
  prefs: []
  type: TYPE_TB
  zh: '| **性别** | **平均身高** | **身高方差** |'
- en: '| Male | 176.8 | 37.2 |'
  id: totrans-311
  prefs: []
  type: TYPE_TB
  zh: '| 男性 | 176.8 | 37.2 |'
- en: '| Female | 163.4 | 30.8 |'
  id: totrans-312
  prefs: []
  type: TYPE_TB
  zh: '| 女性 | 163.4 | 30.8 |'
- en: '| **Gender** | **Mean weight** | **Variance in weight** |'
  id: totrans-313
  prefs: []
  type: TYPE_TB
  zh: '| **性别** | **平均体重** | **体重方差** |'
- en: '| Male | 72.4 | 53.8 |'
  id: totrans-314
  prefs: []
  type: TYPE_TB
  zh: '| 男性 | 72.4 | 53.8 |'
- en: '| Female | 53 | 22.5 |'
  id: totrans-315
  prefs: []
  type: TYPE_TB
  zh: '| 女性 | 53 | 22.5 |'
- en: 'From this data, let''s determine the other values that are needed to determine
    the final probability of the person being male:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些数据中，让我们确定确定最终为男性的概率所需的其他值：
- en: '![](img/4169d7f0-2b98-4be7-bb83-f93516a68639.png)'
  id: totrans-317
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4169d7f0-2b98-4be7-bb83-f93516a68639.png)'
- en: '![](img/e930eaca-16dc-4eb5-a4a8-c4480e5c5cdc.png)'
  id: totrans-318
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e930eaca-16dc-4eb5-a4a8-c4480e5c5cdc.png)'
- en: '![](img/2ee5daf0-4d30-4011-a807-86ec634c57ca.png)'
  id: totrans-319
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2ee5daf0-4d30-4011-a807-86ec634c57ca.png)'
- en: '![](img/87adbc1d-9167-4ff7-98b0-f69fe0b8f48a.png)'
  id: totrans-320
  prefs: []
  type: TYPE_IMG
  zh: '![](img/87adbc1d-9167-4ff7-98b0-f69fe0b8f48a.png)'
- en: '![](img/34dd87d9-edb2-487a-9db0-91c738e70049.png)'
  id: totrans-321
  prefs: []
  type: TYPE_IMG
  zh: '![](img/34dd87d9-edb2-487a-9db0-91c738e70049.png)'
- en: '![](img/d8b4bbc3-a624-4431-b26a-1ddd25b3dcae.png)'
  id: totrans-322
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d8b4bbc3-a624-4431-b26a-1ddd25b3dcae.png)'
- en: '![](img/04f46edb-81e8-4906-b580-791cff84a269.png)'
  id: totrans-323
  prefs: []
  type: TYPE_IMG
  zh: '![](img/04f46edb-81e8-4906-b580-791cff84a269.png)'
- en: '![](img/82ad2dd2-0646-4fda-846d-2ec00cbbcc9e.png)'
  id: totrans-324
  prefs: []
  type: TYPE_IMG
  zh: '![](img/82ad2dd2-0646-4fda-846d-2ec00cbbcc9e.png)'
- en: '![](img/40791c73-f78d-4f41-ad07-fabbc077a486.png)'
  id: totrans-325
  prefs: []
  type: TYPE_IMG
  zh: '![](img/40791c73-f78d-4f41-ad07-fabbc077a486.png)'
- en: '![](img/81644091-b199-4490-8cc2-bf6916acb70b.png)'
  id: totrans-326
  prefs: []
  type: TYPE_IMG
  zh: '![](img/81644091-b199-4490-8cc2-bf6916acb70b.png)'
- en: '![](img/8197cbba-e3fb-45e4-9037-8e1c0d2bfdcb.png)'
  id: totrans-327
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8197cbba-e3fb-45e4-9037-8e1c0d2bfdcb.png)'
- en: Therefore, the probability of a person with a height of 172 cm, a weight of
    60 kg, and long hair, being a male is 20.3%. Thus, they are more likely to be
    female.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，身高172厘米、体重60公斤且有长发的人是男性的概率为20.3%。因此，他们更可能是女性。
