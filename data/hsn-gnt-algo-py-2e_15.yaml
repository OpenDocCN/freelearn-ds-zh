- en: '12'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '12'
- en: Explainable AI, Causality, and Counterfactuals with Genetic Algorithms
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可解释人工智能、因果关系与基因算法中的反事实
- en: This chapter explores the application of genetic algorithms for generating “what-if”
    scenarios, providing valuable insights into the analysis of datasets and associated
    machine learning models, and enabling actionable insights, which help achieve
    desired outcomes.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章探讨了基因算法在生成“假设”场景中的应用，提供了对数据集和相关机器学习模型分析的宝贵见解，并为实现预期结果提供了可操作的洞察。
- en: This chapter begins by introducing the fields of **Explainable AI** (**XAI**)
    and **causality** before explaining the concept of **counterfactuals**. We’ll
    use this technique to explore the ubiquitous *German Credit Risk* dataset and
    use genetic algorithms to apply a counterfactual analysis to it and discover valuable
    insights.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章开始时介绍了 **可解释人工智能**（**XAI**）和 **因果关系** 领域，随后解释了 **反事实** 的概念。我们将使用这一技术探索无处不在的
    *德国信用风险* 数据集，并利用基因算法对其进行反事实分析，从中发现有价值的洞察。
- en: 'By the end of this chapter, you will be able to do the following:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将能够做到以下几点：
- en: Be familiar with the fields of XAI and causality, as well as their applications
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 熟悉 XAI 和因果关系领域及其应用
- en: Understand the concept of counterfactuals and their importance
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解反事实的概念及其重要性
- en: Get acquainted with the German Credit Risk dataset, as well as its shortcomings
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 熟悉德国信用风险数据集及其缺点
- en: Implement an application to create counterfactual “what-if” scenarios that provide
    actionable insights for this dataset and shed light on the operation of its associated
    machine learning model
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现一个应用程序，创建反事实的“假设”场景，为这个数据集提供可操作的洞察，并揭示其相关机器学习模型的操作。
- en: We will start this chapter with a quick overview of XAI and causality. If you
    are a seasoned data scientist, feel free to skip this introductory section.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将从对 XAI 和因果关系的简要概述开始。如果你是经验丰富的数据科学家，可以跳过这一介绍部分。
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'In this chapter, we will be using Python 3 with the following supporting libraries:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用 Python 3 和以下支持库：
- en: '**deap**'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**deap**'
- en: '**numpy**'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**numpy**'
- en: '**pandas**'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**pandas**'
- en: '**scikit-learn**'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**scikit-learn**'
- en: Important note
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: If you’re using the **requirements.txt** file we’ve provided (see [*Chapter
    3*](B20851_03.xhtml#_idTextAnchor091)), these libraries are already included in
    your environment.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是我们提供的 **requirements.txt** 文件（见 [*第 3 章*](B20851_03.xhtml#_idTextAnchor091)），这些库已经包含在你的环境中。
- en: The programs that will be used in this chapter can be found in this book’s GitHub
    repository at [https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/tree/main/chapter_12](https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/tree/main/chapter_12).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中将使用的程序可以在本书的 GitHub 仓库中找到，网址是 [https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/tree/main/chapter_12](https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/tree/main/chapter_12)。
- en: 'Check out the following video to see the Code in Action:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下视频，观看代码演示：
- en: '[https://packt.link/OEBOd](https://packt.link/OEBOd).'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/OEBOd](https://packt.link/OEBOd)。'
- en: Unlocking the black box – XAI
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 解锁黑盒 – XAI
- en: '**XAI** is a crucial element in the realm of **artificial intelligence** (**AI**)
    that aims to demystify the intricate workings of machine learning models. As AI
    applications continue to grow, understanding the decision-making processes of
    models becomes paramount for building trust and ensuring responsible deployment.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '**XAI** 是 **人工智能**（**AI**）领域的一个关键元素，旨在揭示机器学习模型复杂的工作原理。随着人工智能应用的不断增长，理解模型的决策过程变得至关重要，以建立信任并确保负责任的部署。'
- en: XAI intends to address the inherent complexity and opacity of such models and
    to provide clear and accessible explanations for predictions. This transparency
    not only enhances the interpretability of AI models but also empowers users, stakeholders,
    and regulatory bodies to scrutinize and comprehend these processes. In critical
    domains such as healthcare and finance, where decisions have real-world consequences,
    XAI is indispensable. For instance, in medical diagnoses, an explainable model
    not only delivers accurate predictions but also sheds light on specific features
    in medical images or patient records that influenced the diagnosis, building trust
    and aligning with ethical standards.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: XAI旨在解决此类模型固有的复杂性和不透明性问题，并提供清晰且易于理解的预测解释。这种透明性不仅增强了AI模型的可解释性，还使用户、利益相关者和监管机构能够审视和理解这些过程。在医疗保健和金融等关键领域，决策具有现实世界的后果，XAI显得尤为重要。例如，在医学诊断中，可解释的模型不仅提供准确的预测，还揭示了影响诊断的医学图像或患者记录中的具体特征，从而建立信任并符合伦理标准。
- en: One effective approach to achieving explainability is through *model-agnostic*
    techniques. These methods offer **post-hoc** (“after the fact”) explanations for
    any machine learning model, regardless of its architecture. Techniques such as
    *SHAP values* and *LIME* generate explanations by making small, controlled changes
    to input data or model parameters, revealing the features that contribute most
    to a prediction.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 实现可解释性的有效方法之一是通过*模型无关*技术。这些方法为任何机器学习模型提供**事后**（“事后解释”）的解释，不论其架构如何。像*SHAP值*和*LIME*等技术，通过对输入数据或模型参数进行小幅、受控的调整，生成解释，从而揭示对预测贡献最大的特征。
- en: Building on the foundation of XAI, **causality** adds a layer of depth by exploring
    the “why” behind the “what,” as described in the next section.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在XAI的基础上，**因果关系**通过探索“是什么背后的‘为什么’”为模型提供了更深层次的解释，正如下节所述。
- en: Unraveling cause and effect – causality in AI
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 揭示因果关系——AI中的因果性
- en: Knowing not just what AI predicts but also understanding the causal links behind
    those predictions can be vital, particularly in domains where decisions carry
    significant consequences.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 不仅仅是了解AI的预测结果，还要理解这些预测背后的因果关系，这在决策具有重大影响的领域尤为重要。
- en: In AI, causality explores whether changes in aspects of the data impact the
    predictions or decisions of the model. For example, in healthcare, understanding
    the causal links between patient parameters and predicted outcomes helps tailor
    treatments more effectively. The aim is not just accurate predictions but also
    understanding the mechanisms behind them for a nuanced and actionable insight
    into the data.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在AI中，因果性探索数据的各个方面的变化是否会影响模型的预测或决策。例如，在医疗保健领域，了解患者参数与预测结果之间的因果关系有助于更有效地量身定制治疗方案。目标不仅是准确的预测，还要理解这些预测背后的机制，以便为数据提供更加细致且可操作的洞察。
- en: What-if scenarios – counterfactuals
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 假设情景——反事实
- en: '**Counterfactuals** further augment the interpretability of AI systems by exploring
    “what-if” scenarios and considering alternative outcomes. Counterfactual explanations
    help us understand how changes in input could affect model predictions by tweaking
    these inputs and observing variations (or lack thereof) in the model’s decisions.
    This process essentially poses the question, “*What if?*” and enables us to gain
    valuable insights into the sensitivity and robustness of AI models.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '**反事实**通过探索“假如”情景并考虑替代结果，进一步增强了AI系统的可解释性。反事实解释帮助我们了解如何通过调整输入来影响模型预测，通过微调这些输入并观察模型决策中的变化（或没有变化）。这一过程本质上提出了“*如果呢？*”的问题，并使我们能够获得有关AI模型敏感性和鲁棒性的有价值的洞察。'
- en: For example, let’s imagine a scenario where an AI-driven car decides to avoid
    a pedestrian. Through counterfactual analysis, we can uncover how this decision
    might change under different conditions, providing valuable insights into the
    model’s behavior. As another example, consider a recommendation system. Counterfactuals
    could help us understand how adjusting certain user preferences might change the
    recommended items, offering users a clearer understanding of the system’s inner
    workings and allowing developers to enhance user satisfaction.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设一个AI驱动的汽车决定避开行人。通过反事实分析，我们可以揭示在不同条件下这一决策如何发生变化，从而为模型的行为提供有价值的洞察。另一个例子是推荐系统。反事实分析可以帮助我们理解如何调整某些用户偏好，可能会改变推荐的项目，从而为用户提供更清晰的系统工作原理，并使开发者能够提高用户满意度。
- en: In addition to providing a deeper understanding of model behavior, counterfactuals
    can be utilized for model improvement and debugging. By exploring alternative
    scenarios and observing how changes propagate through the model, developers can
    identify potential weaknesses, biases, or areas for optimization.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 除了提供对模型行为的更深理解外，反事实分析还可以用于模型改进和调试。通过探索替代场景并观察变化如何传播，开发人员可以发现潜在的弱点、偏差或优化空间。
- en: As we will illustrate in the following sections, the exploration of “what-if”
    scenarios can also empower users to anticipate and interpret the AI system’s responses.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在以下章节中所示，探索“假设”场景也可以使用户预测和解读AI系统的响应。
- en: Genetic algorithms in counterfactual analysis – navigating alternative scenarios
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 遗传算法在反事实分析中的应用——导航替代场景
- en: Genetic algorithms emerge as useful tools for performing counterfactual analysis,
    offering a flexible approach to modify model inputs to attain a desired outcome.
    Here, each solution in the genetic algorithm represents a unique input combination.
    The optimization objective depends on the model’s output and can incorporate conditions
    linked to input values, such as restricting changes or maximizing a particular
    input value.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 遗传算法作为执行反事实分析的有用工具，提供了一种灵活的方式来修改模型输入，从而达到预期的结果。在这里，遗传算法中的每个解代表一个独特的输入组合。优化目标取决于模型的输出，并可以结合与输入值相关的条件，例如限制变化或最大化某个特定输入值。
- en: In the following sections, we will leverage genetic algorithms to perform counterfactual
    analysis on a machine learning model tasked with determining the credit risk of
    a loan applicant. Through this exploration, we aim to answer various questions
    concerning a particular applicant, gaining insights into the model’s inner workings.
    Additionally, this analysis can provide actionable information to assist the applicants
    in improving their chances of securing a loan.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，我们将利用遗传算法对一个机器学习模型进行反事实分析，该模型的任务是确定贷款申请人的信用风险。通过这种探索，我们旨在回答有关特定申请人的各种问题，深入了解模型的内在运作。此外，这一分析还可以提供可操作的信息，帮助申请人提高获得贷款的机会。
- en: Let’s begin by familiarizing ourselves with the dataset that will be used to
    train the model.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先熟悉将用于训练模型的数据集。
- en: The German Credit Risk dataset
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 德国信用风险数据集
- en: For our experiments in this chapter, we will utilize a modified version of the
    well-known *German Credit Risk* dataset, which is widely used for research and
    benchmarking in the fields of machine learning and statistics. The original dataset
    can be accessed from the *UCI Machine Learning Repository* and comprises 1,000
    instances, each with 20 attributes. This dataset is designed for a binary classification
    task that aims to predict whether a loan applicant is creditworthy or poses a
    credit risk.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的实验中，我们将使用经过修改的*德国信用风险*数据集，该数据集在机器学习和统计学领域的研究和基准测试中被广泛使用。原始数据集可以从*UCI机器学习库*访问，包含1,000个实例，每个实例有20个属性。该数据集旨在进行二分类任务，目的是预测贷款申请人是否值得信贷或存在信用风险。
- en: In contemporary standards, certain original attributes in this dataset are considered
    *protected*, notably those representing the gender and age of the candidate. In
    our adapted version of this dataset, these attributes have been excluded. Additionally,
    several other features have either been removed or their values have been converted
    into numerical formats for simplicity.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 按照现代标准，数据集中某些原始属性被认为是*受保护*的，特别是代表候选人性别和年龄的属性。在我们修改后的版本中，这些属性已被排除。此外，其他一些特征要么被删除，要么其值已被转换为数值格式，以便简化处理。
- en: 'The modified dataset can be found in the `chapter_12/data/credit_risk_data.csv`
    file and consists of the following columns:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 修改后的数据集可以在`chapter_12/data/credit_risk_data.csv`文件中找到，包含以下列：
- en: '**checking**: The status of the applicant’s checking account:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**checking**: 申请人支票账户的状态：'
- en: '**0**: No checking account'
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**0**: 没有支票账户'
- en: '**1**: Balance < 100 DM'
  id: totrans-44
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**1**: 余额 < 100 德国马克'
- en: '**2**: 100 <= balance < 200 DM'
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**2**: 100 <= 余额 < 200 德国马克'
- en: '**3**: Balance >= 200 DM'
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**3**: 余额 >= 200 德国马克'
- en: '**duration**: The duration of the requested loan in months'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**duration**: 申请贷款的时长（月数）'
- en: '**credit_history**: Information about the applicant’s credit history:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**credit_history**: 申请人的信用历史信息：'
- en: '**0**: No loans taken/all loans paid back duly'
  id: totrans-49
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**0**: 没有贷款/所有贷款已按时偿还'
- en: '**1**: Existing loans paid back duly till now'
  id: totrans-50
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**1**: 现有贷款已按时偿还'
- en: '**2**: All loans at this bank are paid back duly'
  id: totrans-51
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**2**: 本银行的所有贷款均已按时还清'
- en: '**3**: There’s been a delay in paying off in the past'
  id: totrans-52
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**3**: 过去曾有还款延迟'
- en: '**4**: Critical account/other loans existing'
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**4**: 存在重要账户/其他贷款'
- en: '**amount**: The amount of the requested loan'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**金额**: 申请贷款的金额'
- en: '**savings**: The status of the applicant’s savings account:'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**储蓄**: 申请人的储蓄账户状态：'
- en: '**0**: Unknown/no savings account'
  id: totrans-56
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**0**: 未知/没有储蓄账户'
- en: '**1**: Balance < 100 DM'
  id: totrans-57
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**1**: 余额 < 100 德国马克'
- en: '**2**: 100 <= balance < 500 DM'
  id: totrans-58
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**2**: 100 <= 余额 < 500 德国马克'
- en: '**3**: 500 <= balance < 1000 DM'
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**3**: 500 <= 余额 < 1000 德国马克'
- en: '**4**: Balance >= 1000 DM'
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**4**: 余额 >= 1000 德国马克'
- en: '**employment_duration**:'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**就业时长**:'
- en: '**0**: Unemployed'
  id: totrans-62
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**0**: 失业'
- en: '**1**: Duration < 1 year'
  id: totrans-63
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**1**: 时长 < 1 年'
- en: '**2**: 1 <= duration < 4 years'
  id: totrans-64
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**2**: 1 <= 时长 < 4 年'
- en: '**3**: 4 <= duration < 7 years'
  id: totrans-65
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**3**: 4 <= 时长 < 7 年'
- en: '**4**: Duration >= 7 years'
  id: totrans-66
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**4**: 时长 >= 7 年'
- en: '**other_debtors**: Any other individuals who might be co-debtors or share financial
    responsibility for the loan, aside from the primary applicant:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**其他债务人**: 除主要申请人外，任何可能是共同债务人或共同承担贷款财务责任的个人：'
- en: '**none**'
  id: totrans-68
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无**'
- en: '**guarantor**'
  id: totrans-69
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**担保人**'
- en: '**co-applicant**'
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**共同申请人**'
- en: '**present_residence**: The duration of the applicant’s current residence at
    the present address, represented as an integer between 1 and 4'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**现住址**: 申请人在当前地址的居住时长，用1到4之间的整数表示'
- en: '**housing**: The housing situation of the applicant:'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**住房**: 申请人的住房情况：'
- en: '**for free**'
  id: totrans-73
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**免费**'
- en: '**own**'
  id: totrans-74
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自有**'
- en: '**rent**'
  id: totrans-75
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**租赁**'
- en: '**number_credits**: The number of credit accounts held at the same bank'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**信用账户数**: 在同一银行持有的信用账户数量'
- en: '**people_liable**: The number of people who are financially dependent on the
    applicant'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**负担人**: 申请人经济上依赖的人的数量'
- en: '**telephone**: Whether the applicant has a telephone (**1** = yes, **0** =
    no)'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**电话**: 申请人是否有电话（**1** = 是，**0** = 否）'
- en: '**credit_risk**: The value to be predicted:'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**信用风险**: 要预测的值：'
- en: '**1**: High risk (indicating a higher likelihood of default or credit issues)'
  id: totrans-80
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**1**: 高风险（表示违约或信用问题的可能性较高）'
- en: '**0**: Low risk'
  id: totrans-81
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**0**: 低风险'
- en: 'For illustration purposes, here are the first 10 lines of the data:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明，我们提供了数据的前10行：
- en: '[PRE0]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: While in previous cases of working with datasets, our main goal was to develop
    a machine learning model for precise predictions on new data, we will now employ
    counterfactuals to turn things around and identify data that matches a desired
    prediction.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然在以往的数据集工作中，我们的主要目标是开发一个机器学习模型，以对新数据做出精准的预测，但现在我们将使用反事实情境来扭转局面，并识别出与期望预测匹配的数据。
- en: Exploring counterfactual scenarios for credit risk prediction
  id: totrans-85
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索用于信用风险预测的反事实情境
- en: 'As evident from the data, many applicants are deemed a credit risk (indicated
    by `1` as the last value), leading to loan disapproval. For such applicants, the
    following question arises: Is there any action they can take to change this decision
    and be considered creditworthy (indicated by `0` as the outcome)? By *action*,
    we mean changing the status of one or more of their attributes, such as the amount
    they are requesting to borrow.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 从数据中可以看出，许多申请人被认为是信用风险（最后的值为`1`），导致贷款被拒。对于这些申请人，提出以下问题：他们能采取什么措施改变这一决定，并被视为有信用？（结果为`0`）。这里所说的*措施*是指更改他们的某些属性状态，例如他们申请的借款金额。
- en: 'Upon inspecting the dataset, some attributes are challenging or even impossible
    for an applicant to change, such as employment duration, number of dependents,
    or current housing. For our examples, we will focus on the following four attributes,
    all of which offer some flexibility:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在检查数据集时，一些属性对于申请人来说是困难或甚至不可能改变的，比如就业时长、抚养人数或当前住房。对于我们的例子，我们将重点关注以下四个属性，它们都有一定的灵活性：
- en: '**amount**: The amount of the requested loan'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**金额**: 申请贷款的金额'
- en: '**duration**: The duration of the requested loan in months'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**时长**: 申请贷款的时长（以月为单位）'
- en: '**checking**: The status of the applicant’s checking account'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**支票账户**: 申请人的支票账户状态'
- en: '**savings**: The status of the applicant’s savings account'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**储蓄**: 申请人的储蓄账户状态'
- en: 'The question can now be phrased as follows: For a candidate currently labeled
    as a credit risk, what is the minimal change (if any) we could make to these four
    attributes, or some of them, such that the outcome changes to creditworthy?'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在问题可以这样表述：对于一个目前被标记为信用风险的候选人，我们可以对这四个属性（或其中一些）进行哪些最小的变化，使结果变为信用良好？
- en: 'To address this question, as well as other relevant questions, we will create
    the following:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 为了回答这个问题，以及其他相关问题，我们将创建以下内容：
- en: A machine learning model that has been trained on our dataset. This model will
    then be used to provide predictions that will enable us to test potential outcomes
    when an applicant’s data is modified.
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个已经在我们的数据集上训练的机器学习模型。该模型将被用来提供预测，从而在修改申请人数据时测试潜在的结果。
- en: A genetic algorithm-based solution that searches for the new attribute values
    to answer our question(s).
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于遗传算法的解决方案，寻找新的属性值以回答我们的问题。
- en: These components will be implemented using Python, as described in the following
    sections.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这些组件将使用Python实现，如下文所述。
- en: The Applicant class
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Applicant类
- en: The `Applicant` class represents an applicant from the dataset; in other words,
    a row from the CSV file. The class also enables us to modify the values of the
    `amount`, `duration`, `checking`, and `savings` fields, representing the corresponding
    attributes of the applicant. This class can be found in the `applicant.py` file,
    which is located at [https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/applicant.py](https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/applicant.py).
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '`Applicant`类表示数据集中的一个申请人；换句话说，就是CSV文件中的一行数据。该类还允许我们修改`amount`、`duration`、`checking`和`savings`字段的值，这些字段代表了申请人的相应属性。此类可以在`applicant.py`文件中找到，文件位于[https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/applicant.py](https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/applicant.py)。'
- en: 'The main functionality of this class is highlighted as follows:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 该类的主要功能如下所示：
- en: The class’s **__init__()** method uses the value of the **dataset_row** argument
    to copy the values from the corresponding dataset row and create an instance representing
    the applicant.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该类的**__init__()**方法使用**dataset_row**参数的值从对应的数据集行中复制值，并创建一个代表申请人的实例。
- en: In addition to setters and getters for the four attributes mentioned previously,
    the **get_values()** method returns the current values of the four attributes,
    while the **with_values()** method creates a copy of the original applicant instance
    and subsequently modifies the copied values of the same four attributes. Both
    of these methods utilize a list of integers for the four attribute values as they
    will be used directly by a genetic algorithm that represents potential applicants
    as a list of four integers.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 除了先前提到的四个属性的设置器和获取器外，**get_values()**方法返回四个属性的当前值，而**with_values()**方法则创建原始申请人实例的副本，并随之修改这四个属性的复制值。这两个方法都使用整数列表来表示四个属性的值，因为它们将被遗传算法直接使用，遗传算法将潜在的申请人表示为四个整数的列表。
- en: The CreditRiskData class
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CreditRiskData类
- en: The `CreditRiskData` class encapsulates the credit risk dataset and the machine
    learning model trained on this data. It can be found in the `credit_risk_data.py`
    file, located at [https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/credit_risk_data.py](https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/credit_risk_data.py).
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`CreditRiskData`类封装了信用风险数据集及其上训练的机器学习模型。该类位于`credit_risk_data.py`文件中，可以在[https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/credit_risk_data.py](https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/credit_risk_data.py)找到。'
- en: 'The main functionality of this class is highlighted in the following steps:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 该类的主要功能在以下步骤中体现：
- en: 'The **__init__()** method of the class initializes the random seed; it then
    calls the **read_dataset()** method, which reads the dataset from the CSV file:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该类的**__init__()**方法初始化随机种子；然后调用**read_dataset()**方法，该方法从CSV文件中读取数据集：
- en: '[PRE1]'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Next, it checks if a trained model has already been created and saved to a file.
    If the model file exists, it is loaded. Otherwise, the **train_model()** method
    is called.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，它检查是否已创建并保存了训练好的模型文件。如果模型文件存在，则加载它。否则，调用**train_model()**方法。
- en: 'The **train_model()** method created a *Random Forest classifier*, which is
    first evaluated using a 5-fold cross-validation procedure, to validate its generalization
    ability:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**train_model()**方法创建了一个*随机森林分类器*，该分类器首先通过5折交叉验证程序进行评估，以验证其泛化能力：'
- en: '[PRE2]'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Next, the model is trained using the entire dataset and evaluated on it:'
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用整个数据集训练模型并对其进行评估：
- en: '[PRE3]'
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Once trained, the *Random Forest* model can assign *feature importance* values
    to the various attributes of the dataset, indicating the contribution of each
    attribute to the model’s predictions. While these values provide insights into
    the factors influencing the model’s decisions, we will use them here to validate
    our assumption that the four attributes we chose can make a difference:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦训练完成，*随机森林* 模型可以为数据集的各个属性分配 *特征重要性* 值，表示每个属性对模型预测的贡献。虽然这些值提供了对影响模型决策的因素的见解，但我们将在这里使用它们来验证我们假设的四个属性是否能产生不同的结果：
- en: '[PRE4]'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The **is_credit_risk()** method utilizes the trained model to predict the outcome
    for a given applicant’s data using *Scikit-learn*’s **predict()** method, returning
    **True** when the candidate is considered a credit risk.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**is_credit_risk()** 方法利用训练过的模型，通过 *Scikit-learn* 的 **predict()** 方法预测给定申请者数据的结果，当候选者被认为是信用风险时返回
    **True**。'
- en: Additionally, the **risk_probability()** method provides a float between 0 and
    1 indicating the degree to which the candidate is considered a credit risk. It
    utilizes the model’s **predict_proba()** method, capturing the continuous output
    value just before a threshold is applied to convert it into a discrete value of
    0 or 1.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此外，**risk_probability()** 方法提供一个介于0和1之间的浮动值，表示申请者被认为是信用风险的程度。它利用模型的 **predict_proba()**
    方法，在应用阈值将其转换为离散值0或1之前，捕获连续的输出值。
- en: The convenience method, **get_applicant()**, allows us to select an applicant’s
    row from the dataset and print its data.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 方便的方法 **get_applicant()** 允许我们从数据集中选择一个申请者的行并打印其数据。
- en: Finally, the **main()** function starts by creating an instance of the **CreditRiskData**
    class, which trains the model for the first time if needed. It then retrieves
    information about the 25th applicant from the dataset and prints it. Afterward,
    it modifies the values of the four mutable attributes and prints the information
    of the modified applicant.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，**main()** 函数首先通过创建 **CreditRiskData** 类的实例来启动，如果需要，它会第一次训练模型。接着，它从数据集中获取第25个申请者的信息并打印出来。之后，它修改四个可变属性的值，并打印修改后的申请者信息。
- en: 'When executing the **main()** function for the first time, the results of the
    cross-validation test evaluation, as well as the training accuracy, are printed
    out:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当第一次执行 **main()** 函数时，交叉验证测试评估的结果，以及训练精度，将会被打印出来：
- en: '[PRE5]'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: These results indicate that, while the trained model can fully reproduce the
    dataset’s results, its accuracy is approximately 76% when making predictions for
    unseen samples – a reasonable outcome for this dataset.
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这些结果表明，虽然训练过的模型能够完全再现数据集的结果，但在对未见过的样本进行预测时，模型的准确率约为76%——对于这个数据集来说，这是一个合理的结果。
- en: 'Next, the feature importance values are printed in descending order. Notably,
    among the top attributes in the list are the four we chose to modify:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，特征重要性值按降序打印。值得注意的是，列表中的前几个属性就是我们选择修改的四个：
- en: '[PRE6]'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The information about the attributes and the predicted outcome for the applicant
    in row 25 of the dataset is now printed. It’s worth noting that in the file, this
    corresponds to the 27th row, given that the first row contains headers, and the
    data rows start counting from 0:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 数据集中第25行申请者的属性信息和预测结果现在被打印出来。值得注意的是，在文件中，这对应于第27行，因为第一行包含标题，数据行从0开始计数：
- en: '[PRE7]'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The output is as follows:'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '[PRE8]'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: As the output shows, this applicant is considered a credit risk.
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如输出所示，该申请者被认为是信用风险。
- en: 'The program now modifies all four values using the **with_values()** method:'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 程序现在通过 **with_values()** 方法修改所有四个值：
- en: '[PRE9]'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Then, it repeats the printing, reflecting the changes:'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 然后，它重复打印，反映变化：
- en: '[PRE10]'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: As the preceding output illustrates, when using the new values, the applicant
    is no longer considered a credit risk. While these modified values were manually
    selected through trial and error, it’s now time to automate this process using
    genetic algorithms.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 正如前面的输出所示，当使用新值时，申请者不再被认为是信用风险。虽然这些修改的值是通过反复试验手动选择的，但现在是时候使用遗传算法来自动化这个过程了。
- en: Counterfactuals with genetic algorithms
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用遗传算法进行反事实分析
- en: To demonstrate how genetic algorithms can work with counterfactuals, we will
    start with the same applicant of row 25, who is originally considered a credit
    risk, and search for the smallest set of changes that will make their prediction
    creditworthy. As we mentioned previously, we will consider making changes to the
    `amount`, `duration`, `checking`, and `savings` attributes.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 为了演示遗传算法如何与反事实一起工作，我们将从第25行的相同申请者开始，该申请者最初被认为是信用风险，然后寻找使其预测信用可接受的最小变化集。如前所述，我们将考虑对`amount`、`duration`、`checking`和`savings`属性进行更改。
- en: Solution representation
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 解的表示
- en: 'When approaching this problem, a straightforward way to represent a candidate
    solution is using a list of four integer values, each corresponding to one of
    the four attributes we want to modify:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理这个问题时，表示候选解的一种简单方法是使用一个包含四个整数值的列表，每个值对应我们希望修改的四个属性之一：
- en: '[amount, duration, checking, savings]'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '[amount, duration, checking, savings]'
- en: 'For example, the modified values we used in the main function of the `credit_risk_data.py`
    program will be represented as follows:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，我们在`credit_risk_data.py`程序的主函数中使用的修改值将表示如下：
- en: '[PRE11]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: As we did in previous chapters, we will utilize floating-point, real numbers
    to represent the integers. This enables the genetic algorithm to use the tried-and-true
    real number operators for crossover and mutation and use the same representation
    for each item regardless of its range. Before evaluation, the real numbers will
    be converted into integers using the `int()` function.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在前几章中所做的那样，我们将利用浮点数来表示整数。这样，遗传算法可以使用行之有效的实数操作符进行交叉和变异，并且无论每个项的范围如何，都使用相同的表示。在评估之前，实数将通过`int()`函数转换为整数。
- en: We’ll evaluate each of these solutions in the next subsection.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在下一小节中评估每个解。
- en: Evaluating the solutions
  id: totrans-142
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 评估解
- en: 'Since our goal is to find the *smallest* degree of changes that will reverse
    the prediction, a question arises: How do we measure the extent of the changes
    made? One possible approach is to use the sum of the absolute differences between
    the current solution’s values and the original values, each divided by the range
    of that value, as shown here:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们的目标是找到使预测结果反转的*最小*变化程度，因此一个问题出现了：我们如何衡量所做变化的程度？一种可能的方法是使用当前解的值与原始值之间的绝对差值之和，每个差值除以该值的范围，如下所示：
- en: ∑ i=1 4  |current valu e i − original valu e i|  _______________________  range
    of valu e i
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: ∑ i=1 4  |current valu e i − original valu e i|  _______________________  range
    of valu e i
- en: Now that we have established the representation and evaluation of the candidate
    solutions, we are ready to cover the Python implementation of the genetic algorithm.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经建立了候选解的表示和评估方法，我们准备展示遗传算法的Python实现。
- en: The genetic algorithm solution
  id: totrans-146
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 遗传算法解
- en: The genetic algorithm-based counterfactual search is implemented in a Python
    program called `01_counterfactual_search.py`, which is located at [https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/01_counterfactual_search.py](https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/01_counterfactual_search.py).
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 基于遗传算法的反事实搜索实现于名为`01_counterfactual_search.py`的Python程序中，该程序位于[https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/01_counterfactual_search.py](https://github.com/PacktPublishing/Hands-On-Genetic-Algorithms-with-Python-Second-Edition/blob/main/chapter_12/01_counterfactual_search.py)。
- en: 'The following steps describe the main parts of this program:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤描述了该程序的主要部分：
- en: 'We begin by defining several constants. Then, we create an instance of the
    **CreditRiskData** class:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们首先定义几个常量。然后，我们创建**CreditRiskData**类的一个实例：
- en: '[PRE12]'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The next several code segments are dedicated to setting the ranges of the four
    attributes that will be used as the solution variables. We start by declaring
    placeholders, as follows:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来的几个代码片段用于设置将用作解变量的四个属性的范围。我们首先声明占位符，如下所示：
- en: '[PRE13]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: The first list holds the lower bounds of the four attributes, the second holds
    the upper bounds, and the third holds the difference between them.
  id: totrans-153
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 第一个列表包含四个属性的下限，第二个包含上限，第三个包含它们之间的差值。
- en: 'Now comes the **set_ranges()** method, which accepts the lower and upper bound
    for each of the four attributes and populates the placeholders accordingly. Since
    we are using real numbers that will be converted into integers, we’ll increment
    each range to ensure uniform distribution of the resulting integers:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来是**set_ranges()**方法，该方法接受四个属性的上下限，并相应地填充占位符。由于我们使用的是将转换为整数的实数，我们将增加每个范围的值，以确保结果整数的均匀分布：
- en: '[PRE14]'
  id: totrans-155
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Next, we’ll use the **set_ranges()** method to set the ranges for the problem
    at hand. We’ve picked the following values:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将使用**set_ranges()**方法为当前问题设置范围。我们选择了以下值：
- en: '**amount**: 100..5000'
  id: totrans-157
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**amount**：100..5000'
- en: '**duration**: 2..72'
  id: totrans-158
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**duration**：2..72'
- en: '**checking**: 0..3'
  id: totrans-159
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**checking**：0..3'
- en: '**savings**: 0..4:'
  id: totrans-160
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**savings**：0..4：'
- en: '[PRE15]'
  id: totrans-161
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Now, we must select the applicant from row 25 of the dataset (the same one
    we used earlier) and save its original four values in a separate variable, **applicant_values**:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们必须从数据集的第25行选择申请人（与之前使用的一样），并将其原始的四个值保存在单独的变量**applicant_values**中：
- en: '[PRE16]'
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The **get_score()** function is used to evaluate the fitness of each solution
    by calculating the cost to be minimized. The cost consists of two parts: first,
    as mentioned in the *Evaluating the solutions* section, we calculate the distance
    between the values of the four attributes that the solution represents and the
    matching original values of the candidate – the larger the distance, the larger
    the cost:'
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**get_score()**函数用于通过计算需要最小化的代价来评估每个解决方案的适应度。代价由两部分组成：首先，如*评估解决方案*部分所述，我们计算该解决方案表示的四个属性值与候选人匹配的原始值之间的距离——距离越大，代价越大：'
- en: '[PRE17]'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Since we would like the solution to represent a creditworthy candidate, the
    second, optional, part of the cost is meant to penalize solutions that are considered
    a credit risk. Here, we’ll utilize the **is_credit_risk()** and **risk_probability()**
    methods so that when the former indicates that the solution is not creditworthy,
    the latter is used to determine the extent of the added penalty:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于我们希望解决方案能够代表一个有信用的候选人，因此代价的第二部分（可选）用于惩罚被视为信用风险的解决方案。在这里，我们将使用**is_credit_risk()**和**risk_probability()**方法，这样当前者表明解决方案没有信用时，后者将用于确定增加的惩罚程度：
- en: '[PRE18]'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The rest of the program is very similar to the ones we saw previously when
    we used a list of real numbers to represent the individuals – for example, the
    one in [*Chapter 9*](B20851_09.xhtml#_idTextAnchor257), *Architecture Optimization
    of Deep Learning Networks*. We’ll get underway with the single-objective strategy
    for minimizing fitness as our goal is to minimize the value calculated by the
    cost function defined earlier:'
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该程序的其余部分与我们之前看到的非常相似，当时我们使用实数列表来表示个体——例如，[*第9章*](B20851_09.xhtml#_idTextAnchor257)，*深度学习网络架构优化*。我们将开始使用单目标策略来最小化适应度，因为我们的目标是最小化由先前定义的代价函数计算出的值：
- en: '[PRE19]'
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Since the solution is represented by a list of four float values, one for each
    of the attributes we can modify, each with its own range, we must define separate
    toolbox *creator* operators for them using the corresponding **bounds_low** and
    **bounds_high** values:'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于解决方案由四个浮动值的列表表示，每个值对应我们可以修改的一个属性，并且每个属性有其自己的范围，我们必须为它们定义独立的工具箱*creator*操作符，使用相应的**bounds_low**和**bounds_high**值：
- en: '[PRE20]'
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'These four operators are then used in the definition of **individualCreator**:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这四个操作符接着在**individualCreator**的定义中使用：
- en: '[PRE21]'
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'After assigning the *selection* operator to the usual *tournament selection*
    with a tournament size of **2**, we assign the *crossover* and *mutation* operators,
    which are specialized for bounded float-list chromosomes, and provide them with
    the ranges we defined earlier:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在将*selection*操作符分配给通常的*tournament selection*（锦标赛选择），并设置锦标赛大小为**2**后，我们将为其分配*crossovers*和*mutation*操作符，这些操作符专门用于有界浮点数列表染色体，并提供我们之前定义的范围：
- en: '[PRE22]'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'In addition, we’ll continue to use the *elitist* approach, where the **hall-of-fame**
    (**HOF**) members – the current best individuals – are always passed untouched
    to the next generation:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此外，我们将继续使用*elitist*方法，其中**hall-of-fame**（**HOF**）成员——当前最佳个体——始终不加修改地传递到下一代：
- en: '[PRE23]'
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: We end by printing the best solution found, as well as the prediction for that
    solution.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们打印出找到的最佳解决方案以及该解决方案的预测值。
- en: 'It’s time to try out the program and see the results! The output starts with
    printing out the original attributes and status of the chosen applicant:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是时候试用该程序并查看结果了！输出从打印所选申请人的原始属性和状态开始：
- en: '[PRE24]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: gen     nevals  min             avg
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: gen     nevals  min             avg
- en: 0       50      0.450063        51.7213
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 0       50      0.450063        51.7213
- en: 1       42      0.450063        30.2695
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 1       42      0.450063        30.2695
- en: 2       44      0.393725        14.2223
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 2       44      0.393725        14.2223
- en: 3       37      0.38311         7.62647
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 3       37      0.38311         7.62647
- en: '...'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '...'
- en: 28      40      0.141661        0.169646
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 28      40      0.141661        0.169646
- en: 29      40      0.141661        0.175401
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 29      40      0.141661        0.175401
- en: 30      44      0.141661        0.172197
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 30      44      0.141661        0.172197
- en: '-- Best solution: Amount = 1370, Duration = 16, checking = 1, savings = 1'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: -- 最佳方案：金额 = 1370，期限 = 16，检查 = 1，储蓄 = 1
- en: '-- Prediction: is_risk = checking and savings accounts does not need to be
    changed.'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: -- 预测：是_风险 = 检查和储蓄账户无需更改。
- en: Although the amount was altered to `1,374`, it could have remained unchanged
    at 1,374\. This can be verified by directly calling the `is_credit_risk()` function
    with the values [1374, 16, 1, 1]. The way our cost function is defined, the difference
    between 1,370 and 1,374 divided by the range of 4,900 is minute, potentially causing
    the algorithm to take many more generations to recognize that the value of 1,374
    is better than 1,370\. By narrowing the range for the amount to 1,000..2,000,
    the same program identifies the value of 1,374 well within the allotted 30 generations.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管金额被调整为`1,374`，它本来可以保持不变为1374。通过直接调用`is_credit_risk()`函数，并使用值[1374, 16, 1,
    1]，可以验证这一点。根据我们的成本函数定义，1370与1374之间的差异除以4900的范围是微小的，可能导致算法需要更多的世代才能识别出1374比1370更好。通过将金额的范围缩小到1000..2000，同样的程序能够在规定的30代内很好地识别出1374的值。
- en: More “what-if” scenarios
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 更多的“假设”场景
- en: We found that altering the loan duration from 6 to 16 months for applicant 25
    could render the application creditworthy. However, what if the applicant prefers
    a shorter duration, or wants to maximize the loan’s amount? These are precisely
    the kind of “what-if” scenarios that counterfactuals explore, and the code we
    have written enables us to simulate various scenarios and address such questions,
    as will be demonstrated in the following subsections.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 我们发现，将申请人25的贷款期限从6个月调整为16个月，可以使得申请获得信用。但是，如果申请人希望更短的期限，或想最大化贷款金额呢？这些正是反事实所探索的“假设”场景，我们编写的代码可以模拟不同场景并解决这些问题，如下文小节所示。
- en: Reducing the duration
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 减少期限
- en: Let’s start with the case where the same applicant prefers to keep the duration
    shorter than the value of 16 months found earlier – can other changes compensate
    for that?
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从同一申请人希望将期限设置为比之前找到的16个月更短的情况开始——其他变化能否弥补这一点？
- en: 'Based on the experience of the previous run, it may prove beneficial to narrow
    the allowed ranges of the four attributes. Let’s try to be more conservative and
    use the following ranges:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 根据前次运行的经验，缩小四个属性的允许范围可能是有益的。让我们尝试采取更保守的方式，并使用以下范围：
- en: '**amount**: 1000..2000'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**金额**: 1000..2000'
- en: '**duration**: 2..12'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**期限**: 2..12'
- en: '**checking**: 0..1'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**检查**: 0..1'
- en: '**savings**: 0..1'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**储蓄**: 0..1'
- en: 'Here, we’ll limit the duration to 12 months and aim to avoid increasing the
    current balance in either the `checking` or `savings` account. This can be achieved
    by modifying the call to `set_ranges()`, as follows:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将期限限制为12个月，并且力求避免增加当前`检查`或`储蓄`账户的余额。这可以通过修改`set_ranges()`的调用来实现，如下所示：
- en: '[PRE25]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'When we run the modified program, the outcome is the following:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们运行修改后的程序时，结果如下：
- en: '[PRE26]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: This indicates that if the applicant is willing to somewhat lower the requested
    loan amount, a reduced duration value of 12 months can be achieved.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明，如果申请人愿意稍微降低所请求的贷款金额，则可以实现12个月的缩短期限。
- en: 'What if we want to reduce the duration even further? Let’s change the duration
    range to 1..10, for example. This yields the following outcome:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想进一步减少期限呢？比如将期限范围更改为1..10。这将得到以下结果：
- en: '[PRE27]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: This indicates that the algorithm has failed to find a solution where the applicant
    is creditworthy using these ranges. Note that it does not necessarily mean that
    such a solution does not exist, but it seems unlikely.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明，算法未能在这些范围内找到一个申请人是可信贷的解决方案。请注意，这并不一定意味着不存在这样的解决方案，但似乎不太可能。
- en: 'Even if we go back and allow the ranges for the `checking` and `savings` accounts
    to have their original ranges of 0..3 and 0..4, a solution is not found so long
    as the duration is limited to 10 months or less. However, allowing the amount
    to go under 1,000 seems to do the trick. Let’s use the following ranges:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 即使我们回去并允许`checking`和`savings`账户的原始范围（0..3和0..4），如果期限限制在10个月或更少，仍然找不到解决方案。然而，允许金额低于1,000似乎能解决问题。让我们使用以下范围：
- en: '**amount**: 100..2000'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**金额**: 100..2000'
- en: '**duration**: 2..10'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**期限**: 2..10'
- en: '**checking**: 0..1'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**checking**: 0..1'
- en: '**savings**: 0..1'
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**储蓄**: 0..1'
- en: 'Here, we get the following solution:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们得到了以下解决方案：
- en: '[PRE28]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: This implies that if the applicant reduces the loan amount to 971, the application
    will be approved for the desired duration of 10.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着，如果申请者将贷款金额减少到971，则申请将按所需的10个月期限获得批准。
- en: 'More surprisingly, however, is the value of 0 that was found for the `savings`
    attribute, which is lower than the original 1\. As you may recall, the values
    of this attribute are interpreted as follows:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 更令人惊讶的是，`savings`属性的值为0，低于原始的1。如你所记得，这个属性的值解释如下：
- en: '**0**: Unknown/no savings account'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**0**: 未知/没有储蓄账户'
- en: '**1**: Balance < 100 DM'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**1**: 余额 < 100 DM'
- en: '**2**: 100 <= balance < 500 DM'
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**2**: 100 <= 余额 < 500 DM'
- en: '**3**: 500 <= balance < 1000 DM'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**3**: 500 <= 余额 < 1000 DM'
- en: '**4**: Balance >= 1000 DM'
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**4**: 余额 >= 1000 DM'
- en: It seems unlikely that having no savings would be advantageous when applying
    for a loan. Furthermore, if we try all possible values other than 0, by setting
    the range to 1..3, no solution is found. This indicates that, according to the
    model used, having no savings account is considered preferable to having one,
    even with a high balance. This is likely an indication of a flaw in the model,
    or an issue in the dataset itself, such as biased or incomplete data. Such findings
    are one of the use cases for counterfactuals.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来，在申请贷款时没有储蓄是不利的。而且，如果我们尝试所有除0以外的可能值，将范围设置为1..3，则没有找到解决方案。这表明，根据使用的模型，没有储蓄账户比拥有储蓄账户更为优越，即使储蓄余额较高。这可能是模型存在缺陷的表现，或者是数据集本身存在问题，例如数据偏见或不完整。这样的发现是反事实推理的一种使用场景。
- en: Maximizing the loan’s amount
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 最大化贷款金额
- en: 'So far, we have manipulated the outcome for an applicant who was initially
    considered a credit risk. However, we can play this “what-if” game with *any*
    applicant, including those who were already approved. Let’s consider an applicant
    from row 68 (the 70th line in the file). When printing out the applicant’s information,
    we see the following:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经操作了一个最初被认为是信用风险的申请者的结果。然而，我们可以对*任何*申请者进行这种“假设”游戏，包括那些已经被批准的申请者。让我们考虑第68行的申请者（文件中的第70行）。当打印出申请者信息时，我们看到以下内容：
- en: '[PRE29]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: applicant = credit_data.get_applicant(68)
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: applicant = credit_data.get_applicant(68)
- en: '[PRE30]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: bounds_low, bounds_high, ranges = set_ranges(2000, 50000, 36, 36, 0,
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: bounds_low, bounds_high, ranges = set_ranges(2000, 50000, 36, 36, 0,
- en: 0, 1, 1)
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 0, 1, 1)
- en: '[PRE31]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: applicant_values = applicant.get_values()
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: applicant_values = applicant.get_values()
- en: applicant_values[0 is used since the amount attribute is the first of the four
    values utilized by the program.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: applicant_values[0] 被使用，因为金额属性是程序所用的四个值中的第一个。
- en: 'Running this program yields the following output:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 运行这个程序会得到以下输出：
- en: '[PRE32]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: The preceding output demonstrates that this applicant can maintain the original
    creditworthy status while increasing the loan amount, without making any changes
    to the other attributes.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 上述输出表明，这位申请者在增加贷款金额的同时，保持了原有的信用良好状态，而无需对其他属性做出任何更改。
- en: 'The next question we’ll address is whether we can *further* increase the loan
    amount by allowing changes to the `checking` and/or `savings` attributes. To this
    effect, we will modify the boundaries so that these two attributes can be adjusted
    to any valid value:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来的问题是，是否可以通过允许更改`checking`和/或`savings`属性，*进一步*增加贷款金额。为此，我们将修改边界，使这两个属性可以调整为任何有效值：
- en: '[PRE33]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The outcome of the modified program is somewhat surprising:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 修改后的程序结果有些令人惊讶：
- en: '[PRE34]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: This result suggests that changing the status of the checking account from 0
    (no checking account) to 1 (balance < 100 DM) is sufficient to secure a significantly
    higher loan amount. If we repeat the experiment with much higher amounts (for
    example, 500,000, replacing the previous value in two different spots in the program),
    the result will be similar – the candidate is creditworthy for that high amount,
    so long as the checking status is changed from 0 to 1.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 这个结果表明，将支票账户的状态从0（没有支票账户）改为1（余额<100 DM）就足以获得显著更高的贷款金额。如果我们用更高的金额（例如500,000，替换程序中两个不同位置的值）重复这个实验，结果将类似——只要将支票状态从0改为1，候选人就能获得这笔高额贷款。
- en: This observation is true when experimenting with other applicants as well, indicating
    a potential vulnerability in the model.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 这个观察结果同样适用于其他申请人，表明模型可能存在潜在的漏洞。
- en: You are encouraged to make additional modifications to the program and explore
    your own what-if scenarios. In addition to providing valuable insights and a deeper
    understanding of the model’s behavior, experimenting with “what-if” scenarios
    can be a lot of fun!
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 鼓励你对程序进行额外修改，探索自己的“如果…会怎样”场景。除了提供有价值的洞察和更深入地理解模型行为外，实验“如果…会怎样”场景还可以非常有趣！
- en: Extending to other datasets
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展到其他数据集
- en: The same process demonstrated in this chapter can be applied to other datasets.
    For instance, consider a dataset that’s used for predicting the expected price
    of a rental apartment. In this scenario, you can use similar counterfactual analysis
    to determine what modifications the landlord can introduce to the apartment to
    achieve a certain rent. Using programs similar to the ones introduced here, you
    could apply genetic algorithms to explore the sensitivity of the model’s predictions
    to changes in input features and identify actionable insights for achieving desired
    outcomes.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 本章演示的相同过程可以应用于其他数据集。例如，考虑一个用于预测租赁公寓预期价格的数据集。在这个场景中，你可以使用类似的反事实分析来确定房东可以对公寓进行哪些修改，以实现某个租金。使用类似本章介绍的程序，你可以应用遗传算法来探索输入特征变化对模型预测的敏感性，并确定可行的洞察，以实现期望的结果。
- en: Summary
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, you were introduced to the concepts of **XAI**, **causality**,
    and **counterfactuals**. After getting acquainted with the *German Credis Risk*
    dataset, we created a machine learning model that predicts whether an applicant
    is creditworthy.  Next, we applied genetic algorithm-based counterfactual analysis
    of the dataset to the trained model, explored several “what-if” scenarios, and
    gained valuable insights.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了**XAI**、**因果关系**和**反事实**的概念。在熟悉了*German Credis Risk* 数据集后，我们创建了一个机器学习模型，用于预测申请人是否具备信用资格。接下来，我们应用了基于遗传算法的反事实分析，将该数据集应用于训练好的模型，探索了几个“如果…会怎样”场景，并获得了宝贵的洞察。
- en: In the next two chapters, we will shift our focus to accelerating the execution
    of genetic algorithm-based programs, such as the ones we’ve developed throughout
    this book, by exploring different strategies for applying concurrency.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的两章中，我们将转向加速基于遗传算法的程序的执行，例如我们在本书中开发的程序，通过探索应用并发的不同策略。
- en: Further reading
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'For more information on the topics that were covered in this chapter, please
    refer to the following resources:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 如需了解本章中涉及的更多内容，请参考以下资源：
- en: '*Hands-On Explainable AI (XAI) with Python*, by Denis Rothman, July 2020'
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Python中的可解释AI（XAI）实践*，作者：Denis Rothman，2020年7月'
- en: '*Causal Inference and Discovery in Python*, by Aleksander Molak, May 2023'
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Python中的因果推理与发现*，作者：Aleksander Molak，2023年5月'
- en: '*Responsible AI in the Enterprise*, by Adnan Masood, July 2023'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*企业中的负责任AI*，作者：Adnan Masood，2023年7月'
- en: '*Scikit-learn* *RandomForestClassifier*: [https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html)'
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Scikit-learn* *RandomForestClassifier*：[https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html)'
- en: '[PRE35]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: '[PRE36]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
