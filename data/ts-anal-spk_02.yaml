- en: '2'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '2'
- en: Why Time Series Analysis?
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 为什么需要时间序列分析？
- en: This chapter delves into the practical significance of analyzing time-dependent
    data. It elucidates how time series analysis enables predictive modeling, trend
    identification, and anomaly detection. By illustrating real-world applications
    across industries, the chapter emphasizes the critical role of temporal insights
    in decision-making. Grasping the importance of time series analysis is crucial
    for professionals, as it highlights the impact on forecasting accuracy, resource
    optimization, and strategic planning, fostering a comprehensive appreciation for
    the utility of time-oriented data analysis.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章深入探讨了分析时间序列数据的实际意义。它阐明了时间序列分析如何支持预测建模、趋势识别和异常检测。通过展示各行业的实际应用，本章强调了时间洞察在决策中的关键作用。掌握时间序列分析的重要性对专业人士至关重要，因为它凸显了对预测准确性、资源优化和战略规划的影响，促进了对面向时间的数据分析的全面理解。
- en: 'We will cover the following topics in this chapter:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下内容：
- en: The need for time series analysis
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时间序列分析的需求
- en: Industry-specific use cases
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 行业特定的应用案例
- en: Hands-on with selected use cases
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择应用案例的动手实践
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'Following the first chapter, we will go one notch up with the code here. The
    objective will be to showcase the use of time series for selected use cases. The
    code for this chapter can be found in the `ch2` folder of the GitHub repository
    of this book: https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/tree/main/ch2.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一章之后，我们将在这里进一步提高代码的难度，目标是展示时间序列在选定应用案例中的使用。本章的代码可以在本书 GitHub 仓库的 `ch2` 文件夹中找到：
    https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/tree/main/ch2。
- en: Refer to this GitHub repository for the latest revisions of the code, which
    will be commented on if updated post-publication from what is presented in the
    code sections of this book.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考这个 GitHub 仓库，获取代码的最新修订版本，若更新内容与本书中代码部分不同，更新将会在仓库中注释说明。
- en: The hands-on section of this chapter will go into further detail.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的动手实践部分将进一步详细介绍。
- en: Understanding the need for time series analysis
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解时间序列分析的需求
- en: As we discussed in the previous chapter, time series are present in all avenues
    of life and across all industries. Hence, the need for analyzing time series is
    everywhere. We will explore the different use cases for different industries in
    this chapter. Before we get to that, in this section, we will look at the underlying
    approaches. These can be broadly categorized as forecasting, pattern detection
    and categorization, and anomaly detection. *Figure 2**.1* shows several key time
    series analysis concepts that will be discussed in this chapter.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在上一章讨论的，时间序列在生活的各个方面以及所有行业中都存在。因此，分析时间序列的需求无处不在。本章将探讨不同行业的不同应用案例。在此之前，我们将在本节中研究其基本方法。这些方法大致可以分为预测、模式检测与分类，以及异常检测。*图
    2.1*展示了本章将讨论的几个关键时间序列分析概念。
- en: '![](img/B18568_02_1.jpg)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18568_02_1.jpg)'
- en: 'Figure 2.1: Concepts in time series analysis'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.1：时间序列分析中的概念
- en: Let’s now go into further detail on each of these.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们更详细地讨论每一个部分。
- en: Forecasting
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预测
- en: Forecasting time series is the prediction of future values based on previously
    observed values. This is achieved by modeling the underlying patterns in the time
    series data – such as trends, seasonality, and cycles – to make predictions about
    future data points. For example, in the case of the temperature time series we
    visualized in *Chapter 1*, we can use forecasting models to predict next month’s
    temperatures based on the pattern learned from previous months. Forecasting is
    the most common approach used for time series analysis, and we will spend the
    most time on it in this book. This can be single-step, multi-step, univariate,
    or multivariate.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列预测是基于先前观察到的数值来预测未来的值。这是通过建模时间序列数据中的基本模式——例如趋势、季节性和周期——来预测未来的数据点。例如，在我们在*第一章*中可视化的温度时间序列的例子中，我们可以使用预测模型根据从前几个月学习到的模式来预测下个月的温度。预测是时间序列分析中最常见的方法，本书将重点讨论这一方法。这可以是单步预测、多步预测、单变量预测或多变量预测。
- en: Single-step forecasting
  id: totrans-18
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 单步预测
- en: With single-step forecasting, we predict the next occurrence in the time series
    based on our analysis of the historical data points, and the model built accordingly.
    The granularity of the step is usually the same as in the dataset from which we
    are learning the historical patterns. For example, if in our historical time series,
    we have daily temperatures, then the next step will be the next day. If we have
    aggregated the data points to, for example, monthly averages, and modeled the
    pattern of monthly changes, then the next step will be the average temperature
    for the next month.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在单步预测中，我们根据对历史数据点的分析以及由此构建的模型，预测时间序列中的下一次发生事件。预测步骤的粒度通常与我们学习历史模式的数据集中的粒度相同。例如，如果我们的历史时间序列中包含的是每日温度，那么下一步将是第二天。如果我们将数据点汇总为例如月度平均值，并且对月度变化模式进行了建模，那么下一步将是下个月的平均温度。
- en: While single-step forecasting is usually the most reliable forecast we can get,
    it is, unfortunately, insufficient for many requirements because, in real life,
    we plan way more ahead than just one (time) step at a time. If we are doing daily
    forecasts, we want to forecast not just for tomorrow. We want to predict days,
    weeks, and even months into the future. A single step is just not sufficient for
    planning.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然单步预测通常是我们能获得的最可靠的预测，但不幸的是，它对于许多需求来说是不够的，因为在现实生活中，我们往往需要比仅仅预测一个（时间）步骤更长远的计划。如果我们在做每日预测，我们不仅仅想预测明天的天气。我们希望能够预测未来几天、几周甚至几个月的情况。单步预测对于规划来说显然不足够。
- en: Multi-step forecasting
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 多步预测
- en: With muti-step forecasting, we predict multiple next steps in the time series
    using the model built from the historical data points. We also use the forecasted
    prior steps as input. With our daily temperature example, this could mean forecasting
    day by day for the entire upcoming week.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在多步预测中，我们使用从历史数据点构建的模型，预测时间序列中的多个下一步。我们还将预测的前一步作为输入。以我们的每日温度为例，这可能意味着对接下来一周的每天进行逐日预测。
- en: Challenges
  id: totrans-23
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 挑战
- en: The challenge with multi-step forecasting is that further predictions are built
    upon prior predictions, which contrasts with single-step forecasting, where predictions
    are based on actual data points. Practically, this means recursively applying
    the forecasting algorithm one step at a time, each step adding the forecast to
    the dataset, and using the historical and forecasted data points to predict the
    next step. Hence, inaccuracies in the forecast are cumulated further and further
    as we go each step into the future.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 多步预测的挑战在于，后续的预测是基于先前的预测，这与单步预测不同，单步预测是基于实际数据点的。实际上，这意味着递归地逐步应用预测算法，每一步都将预测结果添加到数据集中，并使用历史和预测数据点来预测下一步。因此，预测中的不准确性随着每一步向未来推进而逐渐累积。
- en: Note
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 注意事项
- en: This cumulation of forecasting errors with multi-step forecasting is the kind
    of limitation you want to be upfront about with the business or anyone you are
    building the forecast for. You want to be sure to set the expectations on longer-term
    forecasting.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 这种多步预测中的预测误差累积是你希望与业务或任何为你构建预测的人提前沟通的限制。你需要确保在长期预测方面设定清晰的预期。
- en: Solutions
  id: totrans-27
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 解决方案
- en: 'There are a few ways to address the multi-step forecast challenge, besides
    limiting it to a very short horizon:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 除了将预测限制在非常短的时间范围内外，还有几种方法可以应对多步预测的挑战：
- en: First and foremost, build as accurate a model as possible so that the initial
    step forecasted is close to reality
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首先，构建一个尽可能准确的模型，使得初步预测的结果接近现实。
- en: Another approach is to use a combination of models, aiming to average out the
    forecasting errors
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 另一种方法是使用模型组合，旨在平均化预测误差。
- en: Finally, limit the forecasting interval or number of steps and recalculate the
    forecast when new measurements come in
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，限制预测间隔或步数，并在有新的测量数据时重新计算预测。
- en: Univariate forecasting
  id: totrans-32
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 单变量预测
- en: So far, with the temperature time series in [*Chapter 1*](B18568_01.xhtml#_idTextAnchor016),
    we have considered only one variable (univariate) at a time, that is, the temperature
    at a specific location. Another example of a univariate time series, this time
    in the economic sector, is the rate of unemployment for a specific region or country.
    A single time series is univariate by definition, be it for temperature or unemployment
    rate. In real-world scenarios, the requirement is likely going to be to forecast
    multiple time series at the same time so that we can get a more comprehensive
    view of the future than just one time series can give us. In the case of temperature,
    this can mean taking multiple locations into account or additionally forecasting
    the level of pollutants in the air. For economic forecasting, it can be about
    forecasting the **Gross Domestic Product** (**GDP**) in addition to the level
    of unemployment. This leads us to multivariate forecasting.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，在[**第1章**](B18568_01.xhtml#_idTextAnchor016)中，我们只考虑了单一变量（单变量）的时间序列，也就是特定位置的温度。另一个单变量时间序列的例子，在经济领域，是特定地区或国家的失业率。根据定义，单个时间序列是单变量的，无论是温度还是失业率。在现实世界中，需求往往是同时预测多个时间序列，这样我们能比单一时间序列提供的视角获得更全面的未来预测。以温度为例，这可能意味着需要考虑多个地点，或者额外预测空气中的污染物水平。对于经济预测，这可能意味着需要预测**国内生产总值**（**GDP**）以及失业率。这引出了多变量预测。
- en: Multivariate forecasting
  id: totrans-34
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 多变量预测
- en: 'While univariate is about a single time series, there are a couple of ways
    to characterize multivariate forecasting:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 单变量是指单一的时间序列，而多变量预测有几种方式可以进行描述：
- en: '**Multiple input** dimensions are the case when we provide several variables
    (time series and non time series) as input to the forecasting model – for example,
    using past temperatures and pollutant levels to predict future temperatures.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**多重输入**维度是指我们将多个变量（包括时间序列和非时间序列）作为输入提供给预测模型——例如，使用过去的温度和污染物水平来预测未来的温度。'
- en: '**Multiple output** prediction uses the forecasting model to predict multiple
    variables. With the preceding temperature example, this means forecasting both
    the temperature and the pollutant level.'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**多重输出**预测使用预测模型来预测多个变量。以之前的温度示例为例，这意味着要同时预测温度和污染物水平。'
- en: As we have seen with the preceding examples, there can be several scenarios
    with multiple time series. These series can be **correlated**, and if they have
    the same underlying cause (which can itself be represented by yet another time
    series), can have **co-movement**. They can have **causal dependency**, where
    one time series has a causality relationship to another. They can also be **independent**,
    and we just predict them simultaneously. We will address some of these considerations
    in [*Chapter 6*](B18568_06.xhtml#_idTextAnchor116) on exploratory data analysis.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们从前面的例子中看到的，可能会有多个时间序列的不同场景。这些序列可以是**相关**的，如果它们有相同的潜在原因（这个原因本身也可以通过另一个时间序列来表示），它们就可能有**共动**关系。它们也可以有**因果依赖性**，即一个时间序列与另一个时间序列之间存在因果关系。它们还可能是**独立的**，我们只是同时进行预测。在[**第6章**](B18568_06.xhtml#_idTextAnchor116)的探索性数据分析中，我们将讨论一些这些考虑因素。
- en: In summary, forecasting is rarely done in isolation, and the number of time
    series that we need to analyze at the same time can be in the hundreds or even
    thousands. This need to scale to multiple time series is a good reason to use
    a parallel execution tool such as Apache Spark, as we will see in later chapters.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，预测很少是单独进行的，我们需要同时分析的时间序列数量可能达到数百甚至数千。这个对多个时间序列的需求是使用并行执行工具（如Apache Spark）的一个很好的理由，正如我们将在后续章节中看到的那样。
- en: Now that we have discussed forecasting, let’s see another type of analysis,
    which will enable us to classify time series.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经讨论了预测，现在让我们看看另一种分析方法，这将使我们能够对时间序列进行分类。
- en: Pattern detection and categorization
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模式检测与分类
- en: Pattern detection and categorization is about identifying and classifying time
    series based on certain patterns. In general, time series follow a certain pattern,
    which we can identify and label. These labels allow us to classify time series
    by matching the labeled pattern to new occurrences of time series. We can follow
    different approaches to achieve this, broadly categorized as distance-based, interval-based,
    frequency-based, dictionary-based, shapelets, ensembles, and deep learning. These
    approaches will now be detailed.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 模式检测与分类是基于某些模式识别和分类时间序列。通常，时间序列遵循某种模式，我们可以识别并标记这些模式。这些标签允许我们通过将标记的模式与新的时间序列发生情况进行匹配，从而对时间序列进行分类。我们可以采取不同的方法来实现这一点，广义上可分为基于距离、基于区间、基于频率、基于字典、形状模式、集成方法和深度学习。接下来将详细介绍这些方法。
- en: Distance-based
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 基于距离
- en: Distance-based time series classification using **k-Nearest Neighbors** (**kNN**)
    and **Dynamic Time Warping** (**DTW**), which will be explained here, is a proven
    method for analyzing time-sequential data. Due to shifts and distortions in time
    series data, standard Euclidean distance is a poor metric for similarity measurement.
    DTW offers an alternative by aligning the sequences in time. It calculates the
    minimum distance between two time series, considering all possible alignments,
    which makes it compute-intensive. kNN is then used to classify the time series
    based on the similarity of their shapes.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 基于距离的时间序列分类方法，使用**k-最近邻**（**kNN**）和**动态时间规整**（**DTW**），将在这里进行解释，这是分析时间序列数据的成熟方法。由于时间序列数据的偏移和扭曲，标准的欧几里得距离并不是衡量相似性的良好度量。DTW通过将序列在时间上对齐提供了一种替代方案。它计算两条时间序列之间的最小距离，考虑所有可能的对齐方式，这使得其计算量较大。然后使用kNN根据时间序列的形状相似性来进行分类。
- en: The following chart shows the outcome of DTW to calculate the distance between
    the shares of Google (lower, black) and Amazon, and the shares of Google and Meta.
    We will execute this example in the hands-on section of this chapter.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表展示了使用动态时间规整（DTW）计算谷歌股票（下方，黑线）与亚马逊股票，以及谷歌股票与Meta股票之间的距离。我们将在本章的动手操作部分执行这个示例。
- en: '![](img/B18568_02_2.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18568_02_2.jpg)'
- en: 'Figure 2.2: DTW distance (GOOG – black line)'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.2：DTW距离（GOOG – 黑线）
- en: Interval-based
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 基于区间
- en: With this approach, the time series is first partitioned into intervals, for
    which descriptive statistics are calculated. These intervals are then used as
    feature vectors together with classifiers such as random forests or support vector
    machines. The advantage of this method is that it captures the properties of time
    series over different phases, which works well for time series with non-uniform
    patterns over time. This summarization of the time series into intervals with
    statistical features is also a great way to reduce complexity and improve interpretability.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这种方法，时间序列首先被划分为多个区间，并计算每个区间的描述性统计量。这些区间随后与分类器如随机森林或支持向量机一起作为特征向量使用。该方法的优势在于它能够捕捉时间序列在不同阶段的特性，这对于那些在时间上具有不均匀模式的时间序列非常有效。将时间序列汇总成带有统计特征的区间也是降低复杂性并提高可解释性的好方法。
- en: Frequency-based
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 基于频率
- en: This classification method, such as **Random Interval Spectral Ensemble** (**RISE**),
    involves first transforming the time series to the frequency domain, using, for
    example, the Fourier transform. RISE is an ensemble approach based on classifiers,
    such as decision trees, built from random intervals and spectral features extracted
    for these intervals. The advantage of this method is in identifying frequency-related
    or periodic characteristics, and as an ensemble approach, it is robust while providing
    accuracy.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这种分类方法，例如**随机区间谱集成**（**RISE**），首先通过例如傅里叶变换将时间序列转换到频域。RISE 是一种基于分类器的集成方法，分类器如决策树，是通过随机区间和为这些区间提取的谱特征构建的。该方法的优势在于能够识别与频率相关或周期性特征，并且作为一种集成方法，它在提供准确性的同时具有鲁棒性。
- en: Dictionary-based
  id: totrans-52
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 基于字典
- en: 'Dictionary-based time series classification methods convert time series into
    symbolic representations, allowing the use of text-based techniques for classification.
    Prominent methods following this approach are these:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 基于字典的时间序列分类方法将时间序列转换为符号表示，从而可以使用基于文本的技术进行分类。遵循这一方法的突出方法有：
- en: '**Bag of Patterns** (**BoP**): BoP creates a “bag” of patterns by applying
    a sliding window to capture local patterns. This is then hashed into a frequency
    histogram, which is used as the feature vector for classification.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模式包**（**BoP**）：BoP通过应用滑动窗口捕获局部模式，从而创建一个“模式包”。然后将其哈希为频率直方图，用作分类的特征向量。'
- en: '**Bag of SFA Symbols** (**BOSS**): BOSS is a variation that is more robust
    to noise and effective at capturing key patterns. It uses **Symbolic Fourier Approximation**
    (**SFA**) to capture the time series at different resolutions.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SFA符号包**（**BOSS**）：BOSS是一种更能抵御噪声并有效捕获关键模式的变体。它使用**符号傅里叶近似**（**SFA**）在不同分辨率下捕获时间序列。'
- en: '**RandOm Convolutional KErnel Transform** (**ROCKET**): ROCKET offers further
    speed and efficiency for large datasets. It generates and uses random convolutional
    kernels to convert time series into feature vectors.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**随机卷积核变换**（**ROCKET**）：ROCKET为大数据集提供了更高的速度和效率。它生成并使用随机卷积核将时间序列转换为特征向量。'
- en: Shapelets
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Shapelets
- en: These are sub-sequences within the time series, which are representative of
    class-specific patterns. By finding shapelets that match within the time series
    or another correlated time series, it is possible to classify the time series
    accordingly. This works well when the class-defining features are localized in
    time – for example, a sudden spike in transaction amount, which could correspond
    to a credit card theft. Shapelets can also help with interpretability—once it
    is well understood, a shapelet can be used to explain the time series at the points
    in time where they match.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是时间序列中的子序列，代表了特定类别模式。通过找到在时间序列或其他相关时间序列中匹配的形状，可以相应地对时间序列进行分类。当定义类别的特征在时间上是局部化的时候，例如交易金额突然增加，可能对应信用卡盗窃。Shapelets还可以帮助解释性——一旦形状被充分理解，可以用于解释在时间上匹配的时间序列点。
- en: Ensembles
  id: totrans-59
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 集成
- en: The ensemble classification methods mentioned so far group a similar type of
    classifier. Another approach, such as the **Hierarchical Vote Collective of Transformation-based
    Ensembles** (**HIVE-COTE**), is with different types of classifiers. The idea
    is to have an ensemble based on different aspects of the time series as captured
    by the different nature of classifiers used. These are trained independently,
    and the predictions are combined based on a hierarchical voting method. As with
    other ensemble methods, this can yield greater robustness and accuracy. Also,
    due to the various techniques used, HIVE-COTE is a good candidate for complex
    multi-pattern time series. This does, however, come with a high compute cost.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 迄今为止提到的集成分类方法将相似类型的分类器分组。另一种方法，如**基于层次化投票的转换集成**（**HIVE-COTE**），则采用不同类型的分类器。其思想是基于不同分类器捕获的时间序列的不同方面构建集成。这些分类器是独立训练的，其预测结果根据层次化投票方法进行组合。与其他集成方法一样，这可以提高鲁棒性和准确性。此外，由于使用了各种技术，HIVE-COTE是复杂多模式时间序列的一个良好选择。然而，这也带来了较高的计算成本。
- en: Deep learning
  id: totrans-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 深度学习
- en: Methods such as **TimeNet** leverage deep neural networks to automatically extract
    features, patterns, and relationships within time series. TimeNet is pre-trained,
    which makes it quickly usable. It combines layers of **Convolutional Neural Networks**
    (**CNNs**) for local features and **Recurrent Neural Networks** (**RNNs**) for
    sequential patterns. This allows TimeNet to capture both low-level and high-level
    patterns, effectively learning the hierarchical representation. The benefit is
    adaptability to various time series classification problems while limiting the
    need for manual feature engineering. The cons, similar to other deep learning
    approaches, are the high volume of data needed for pre-training, the computing
    resources required, and the lack of interpretability. Despite these, they are
    state-of-the-art in performance in several complex cases.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 诸如**TimeNet**的方法利用深度神经网络自动提取时间序列中的特征、模式和关系。TimeNet是预训练的，这使得它能够快速应用。它结合了**卷积神经网络**（**CNNs**）用于局部特征和**循环神经网络**（**RNNs**）用于顺序模式。这使得TimeNet能够有效地捕获低级和高级模式，从而学习层次化表示。其优点在于适应各种时间序列分类问题，同时减少了手动特征工程的需求。与其他深度学习方法类似，缺点在于需要大量数据进行预训练、需要的计算资源较多，以及缺乏可解释性。尽管如此，在多种复杂情况下，它们仍然是性能最先进的方法之一。
- en: While we will not spend as much time on the classification of time series in
    this book as on forecasting, this is a promising area for further research, together
    with its own set of operational challenges.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然本书不会像预测那样详细讨论时间序列的分类，但这仍是一个值得进一步研究的有前景领域，并且面临一系列操作性挑战。
- en: This brings us to the final type of analysis, which is about detecting anomalies
    from time series data.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 这带我们进入最后一种分析类型，即从时间序列数据中检测异常。
- en: Anomaly detection
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 异常检测
- en: 'The third category of use cases for time series analysis is anomaly detection,
    which is about flagging unexpected patterns or occurrences. While this is related
    to pattern detection and forecasting, the purpose here is different: to identify
    an unexpected deviation in the behavior of the source system. Anomaly detection
    is crucial in various domains, such as finance, healthcare, and industrial systems.
    These anomalies can be indicative of critical incidents, such as system failures,
    financial fraud, or network intrusions.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析的第三类使用场景是异常检测，旨在标记意外的模式或事件。虽然这与模式识别和预测有关，但其目的是不同的：识别源系统行为的意外偏差。异常检测在多个领域至关重要，如金融、医疗保健和工业系统。这些异常可能表明严重事件的发生，例如系统故障、金融欺诈或网络入侵。
- en: 'In addition to being uni- or multivariate, an anomaly can be as follows:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 除了单变量或多变量外，异常还可以表现为以下几种形式：
- en: '**Point**: This is the case when a single data point is identified as an anomaly'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**点**：这是指一个单一的数据点被识别为异常的情况。'
- en: '**Collective**: It can be that multiple data points as a group of near measurements
    are all flagged'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集合**：当多个数据点作为一组近似的测量值被标记为异常时，就属于此类情况。'
- en: '**Contextual**: A data point or a collective can be anomalous in the context
    of surrounding measurements, and the same point or collective may not be an issue
    in another context'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**上下文**：某个数据点或集合在周围测量值的上下文中可能是异常的，而在另一个上下文中， 同一个数据点或集合可能不是问题。'
- en: Anomalies can also be distinguished as outliers and novelties, where outliers
    may indicate errors or faults, and novelties are previously unseen patterns that
    may not be problematic.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 异常也可以分为离群值和新颖性，离群值可能表示错误或故障，而新颖性则是之前未见过的模式，可能不是问题。
- en: Note
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: For anomaly detection to work, the prior data preparation stage must keep the
    outliers in the dataset, which is the opposite of what is usually done during
    the data curation process.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使异常检测有效，数据准备阶段必须保留数据集中的异常值，这与通常在数据整理过程中所做的相反。
- en: In addition to traditional statistical and rule-based approaches, there are
    newer machine learning techniques. The methods for anomaly detection in time series
    data can be categorized into unsupervised, supervised, and semi-supervised approaches,
    each with its own set of techniques and algorithms. An anomaly score is usually
    calculated with a threshold configured to flag anomalies.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 除了传统的统计和基于规则的方法，还有更新的机器学习技术。时间序列数据中的异常检测方法可以分为无监督、监督和半监督方法，每种方法都有其独特的技术和算法。异常分数通常是通过设置阈值来计算，用于标记异常。
- en: Unsupervised anomaly detection
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 无监督异常检测
- en: 'Unsupervised anomaly detection does not need labeled data. This assumes that
    anomalies are different enough from the normal that they can be detected without
    prior knowledge. Common methods include the following:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 无监督异常检测不需要标记数据。这假设异常与正常数据的差异足够大，可以在没有先验知识的情况下检测到。常见的方法包括：
- en: '**Statistical** methods such as **z-score** and **box plot analysis** are used
    to identify outliers based on statistical properties'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**统计**方法，如**z-score**和**箱线图分析**，用于根据统计特性识别异常值。'
- en: '**Clustering-based** methods such as **DBSCAN** or **k-means** cluster similar
    data points, with anomalies as points that do not fit into any cluster'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于聚类**的方法，如**DBSCAN**或**k-means**，将相似的数据点聚集在一起，而异常点则是那些不属于任何聚类的点。'
- en: '**Density-based** methods such as kNN and **Local Outlier Factor** (**LOF**)
    use the density of the local neighborhood to identify anomalies'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于密度**的方法，如kNN和**局部异常因子**（**LOF**），利用局部邻域的密度来识别异常。'
- en: '**Isolation forest** is a tree-based model that works well for high-dimensional
    data, isolating anomalies'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**隔离森林**是一种基于树的模型，适用于高维数据，能够有效地将异常值隔离出来。'
- en: The chart in *Figure 2**.3* shows the outcome of an isolation forest model,
    used to detect anomalies in a household’s energy consumption.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '*图2.3*中的图表显示了隔离森林模型的结果，用于检测家庭能源消费中的异常。'
- en: '![](img/B18568_02_3.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18568_02_3.jpg)'
- en: 'Figure 2.3: Anomaly detection on energy consumption'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.3：能耗异常检测
- en: The model was fitted to consumption data up to November 9 and thereafter used
    on previously unseen data in the box. The anomalies are shown in red/paler color.
    We will run this example in the hands-on section of this chapter.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 该模型是根据到11月9日为止的消费数据拟合的，然后用于之前未见过的数据。异常数据以红色/较浅的颜色显示。我们将在本章的实践部分运行此示例。
- en: Supervised anomaly detection
  id: totrans-85
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 有监督异常检测
- en: 'Supervised anomaly detection works with a labeled dataset having both normal
    and anomalous cases. Better at detecting anomalies, it does, however, require
    labeled data, which can be difficult to obtain. Techniques include the following:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 有监督异常检测适用于包含正常和异常情况的标注数据集。虽然能更好地检测异常，但它需要标注数据，这些数据可能比较难获得。相关技术包括以下几种：
- en: '**Classification models** such as traditional classifiers such as logistic
    regression, **Support Vector Machines** (**SVMs**), or more complex models such
    as CNNs and RNNs, trained to distinguish between normal and anomalous instances'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分类模型**，如传统的分类器（如逻辑回归）、**支持向量机**（**SVM**）或更复杂的模型，如CNN和RNN，这些模型经过训练用来区分正常与异常实例。'
- en: '**Ensemble methods** such as random forest or gradient boosting can be used
    with improved detection accuracy as they combine multiple models'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集成方法**，如随机森林或梯度提升，可以通过组合多个模型来提高检测精度。'
- en: Semi-supervised anomaly detection
  id: totrans-89
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 半监督异常检测
- en: Semi-supervised anomaly detection needs a smaller amount of labeled data together
    with a larger set of unlabeled data. An example is the case of industrial monitoring
    when we have limited data points from sensor readings. These measurements correspond
    mostly to normal operations of the equipment and can be labeled as such. New readings
    falling out of the normal label can then be flagged as anomalous.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 半监督异常检测需要较少的标注数据，并结合大量未标注的数据。例如，在工业监控中，当我们从传感器读取的数据显示数据点有限时，这些测量值大多数对应设备的正常运行，可以标注为正常。然后，超出正常标签的新读数可以被标记为异常。
- en: 'Also useful when labeling a large dataset is expensive, semi-supervised techniques
    include the following:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 当标注一个大规模数据集昂贵时，半监督技术包括以下几种：
- en: Modifying unsupervised techniques to include the limited available labels –
    for example, modifying density-based or clustering methods for added sensitivity
    to labeled anomalies.
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修改无监督技术以包含有限的可用标签——例如，修改基于密度的或聚类方法，以增强对标注异常的敏感性。
- en: '**Novelty detection** trains a model on the normal data to find its distribution,
    akin to unsupervised statistical approaches, and then deviation from this distribution
    is flagged. One-class SVMs and autoencoders are examples of techniques in this
    case.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**新颖性检测**通过在正常数据上训练模型以找到其分布，类似于无监督统计方法，然后偏离该分布的值会被标记出来。一类SVM和自编码器就是这种技术的示例。'
- en: Advanced deep learning methods
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 高级深度学习方法
- en: 'Methods using deep learning techniques include the following:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 使用深度学习技术的方法包括以下几种：
- en: '**Autoencoders** are neural networks that compress and then reconstruct the
    input data. The idea is that these models will reconstruct normal data well and
    have higher reconstruction errors with anomalous data.'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自编码器**是神经网络，通过压缩然后重建输入数据。其原理是，这些模型能很好地重建正常数据，而对异常数据的重建误差较高。'
- en: Sequence types of models such as **Long Short-Term Memory** (**LSTM**), **RNNs**,
    and **Transformers** identify temporal dependencies in time series data, hence
    are useful for anomaly detection in sequences.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 序列类型的模型，如**长短期记忆**（**LSTM**）、**RNN**和**Transformers**，能够识别时间序列数据中的时间依赖性，因此在序列异常检测中非常有用。
- en: Note
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 注
- en: From an operational point of view, an anomaly detection system is part of a
    comprehensive monitoring and alerting architecture. Note that Kalman filters are
    used in cases where low-latency or real-time detection and alerting are required.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 从操作角度来看，异常检测系统是全面监控和告警架构的一部分。需要注意的是，在低延迟或实时检测和告警要求的情况下，卡尔曼滤波器常常被使用。
- en: This summarizes the various methods for anomaly detection. The choice of method
    for anomaly detection depends on the characteristics of the time series and anomalies
    that need to be detected, the availability of labeled data, the computational
    resources available, and the requirement for real-time detection. Hybrid and advanced
    methods, especially those based on deep learning, have shown promising results
    in various applications due to their ability to model complex patterns and dependencies
    in time series data.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 这总结了各种异常检测方法。选择异常检测方法取决于时间序列和异常的特征、可用的标记数据、计算资源以及实时检测的要求。混合方法和高级方法，特别是基于深度学习的方法，由于能够建模时间序列数据中的复杂模式和依赖关系，已在各种应用中取得了令人鼓舞的结果。
- en: Moving on from an overview of the landscape of time series analysis, let’s now
    consider how they are used and their impact in various sectors.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 从时间序列分析的整体概述出发，我们现在来看看它们在各个行业中的使用及其影响。
- en: Industry-specific use cases
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 行业特定的应用案例
- en: We looked at different types of time series analysis in the previous section.
    The question remains on their applicability across different sectors, which we
    will now dive into. But before we do that, the chart in *Figure 2**.4* gives you
    a sense of the multitude of applications across industries.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在前一部分讨论了不同类型的时间序列分析。接下来我们将探讨它们在不同行业中的适用性。 在此之前，*图2.4*中的图表能帮助你了解跨行业应用的多样性。
- en: '![](img/B18568_02_4.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18568_02_4.jpg)'
- en: 'Figure 2.4: Application of time series analysis across industries'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.4：时间序列分析在各行业中的应用
- en: Let’s look at the application of time series analysis in each of these sectors
    in detail.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们详细了解时间序列分析在各个行业中的应用。
- en: Financial services
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 金融服务
- en: 'Time series analysis in financial services is crucial for understanding trends,
    patterns, and future behaviors. The applications are diverse, offering valuable
    insights for decision-making, strategic planning, risk management, and regulatory
    compliance. The following is how time series analysis is used across various functions
    within financial services:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 金融服务中的时间序列分析对于理解趋势、模式和未来行为至关重要。其应用广泛，能为决策、战略规划、风险管理和合规提供宝贵的见解。以下是时间序列分析在金融服务各个职能中的应用：
- en: '**Market analysis**: The future prices of assets are forecast by analyzing
    their historical prices, including trends and seasonality. This helps traders
    and investors decide on which asset to trade and when.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**市场分析**：通过分析资产的历史价格，包括趋势和季节性，预测未来资产价格。这有助于交易员和投资者决定交易哪些资产以及何时交易。'
- en: '**Risk management**: In addition to the preceding, another important aspect
    of financial instruments’ prices is their volatility, which needs to be analyzed
    to better manage risks and design mitigation strategies. This includes **Value
    at Risk** (**VaR**) modeling, which estimates the potential loss for an investment
    over a period based on historical volatility and correlations. Another area of
    risk management is credit risk, which covers time series data on repayment histories,
    defaults, and economic conditions. This helps assess the likelihood of future
    defaults and losses. The counter to this, estimation for provisioning, ensures
    enough funds are set aside to cover potential loan losses, while liquidity management
    ensures sufficient liquidity is maintained. Finally, at the macro-economic level,
    stress testing involves analyzing historical worst-case scenarios.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**风险管理**：除了前述内容，金融工具价格的另一个重要方面是它们的波动性，这需要进行分析，以更好地管理风险并制定减缓策略。这包括**风险价值**（**VaR**）建模，通过基于历史波动性和相关性来估算某个投资在一段时间内的潜在损失。风险管理的另一个领域是信用风险，包括偿还历史、违约和经济状况的时间序列数据。这有助于评估未来违约和损失的可能性。为此，预备金估算确保足够的资金被预留以应对潜在的贷款损失，而流动性管理确保保持足够的流动性。最后，在宏观经济层面，压力测试涉及分析历史上的最坏情况。'
- en: '**Portfolio management**: The two main aspects here are optimizing asset allocation
    and related performance evaluation of the portfolio. By analyzing the historical
    returns and correlations between assets, portfolio managers can define the asset
    allocation to meet the desired risk-return profiles. Looking back at their performance
    over time, the portfolio can then be adjusted as needed.'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**投资组合管理**：这里的两个主要方面是优化资产配置和相关的投资组合表现评估。通过分析历史回报和资产之间的相关性，投资组合经理可以确定资产配置，以满足预期的风险回报特征。回顾其随时间的表现后，投资组合可以根据需要进行调整。'
- en: '**Algorithmic trading**: At its core, this involves using time series data
    on a microseconds or milliseconds scale to make high-frequency trading decisions.
    The complete cycle includes developing strategies, doing backtesting, and then,
    once strategies are in active use, generating the correct signals for trading.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**算法交易**：从本质上讲，这涉及利用微秒或毫秒级的时间序列数据来做出高频交易决策。完整的周期包括开发策略、进行回测，然后一旦策略投入实际使用，就生成正确的交易信号。'
- en: '**Fraud detection**: The idea here is to analyze transactions to identify and
    flag patterns that could indicate fraudulent activities, including market manipulation
    or insider trading.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**欺诈检测**：这里的核心思想是分析交易，识别并标记可能表明欺诈活动的模式，包括市场操纵或内幕交易。'
- en: '**Economic forecasting**: This is used to project, for example, interest rates
    and other economic indicators with an impact on policymaking by central banks,
    governments, and financial institutions.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**经济预测**：这用于预测例如利率和其他对中央银行、政府和金融机构政策制定有影响的经济指标。'
- en: In essence, time series analysis in financial services is foundational to support
    a wide range of activities, from trading decisions to portfolio management and
    regulatory compliance. It leverages historical data to forecast future events,
    manage risks, and uncover valuable insights. Thus, time series analysis drives
    informed decision-making across the financial ecosystem.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 从本质上讲，金融服务中的时间序列分析是支撑广泛活动的基础，从交易决策到投资组合管理和合规监管。它利用历史数据预测未来事件、管理风险并揭示有价值的洞察力。因此，时间序列分析推动了金融生态系统中的明智决策。
- en: Retail
  id: totrans-116
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 零售
- en: 'Time series analysis in the retail industry uses chronological data for decision-making,
    to optimize operations, and to enhance customer experiences. Retailers can gain
    insights into trends, seasonal variations, and cyclical behaviors that affect
    their business. The following are some of the key use cases:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 零售行业中的时间序列分析使用按时间顺序排列的数据来进行决策、优化运营和提升客户体验。零售商可以洞察影响其业务的趋势、季节性变化和周期性行为。以下是一些关键的应用场景：
- en: '**Sales forecasting and revenue prediction**: Predicting future sales based
    on historical data, considering seasonal variations, trends, and external factors
    such as holidays and economic conditions, helps plan inventory, staffing, and
    marketing activities. This is crucial for financial planning and investment decisions.'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**销售预测和收入预测**：根据历史数据预测未来的销售情况，考虑季节性变化、趋势和外部因素（如假期和经济条件），有助于规划库存、员工和营销活动。这对于财务规划和投资决策至关重要。'
- en: '**Inventory management and supply chain optimization**: Retailers can optimize
    stock levels by analyzing purchasing patterns and lead times. Better demand planning
    and scheduling of replenishment minimizes stockouts and reduces excess inventory.
    Forecasting can be done at each product level, facilitating efficient inventory
    replenishment. This has also a positive impact on supply chain management. A related
    use case in retail that is growing in adoption is food waste prediction and reduction.'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**库存管理和供应链优化**：零售商可以通过分析购买模式和交货时间来优化库存水平。更好的需求规划和补货调度可以最大限度地减少缺货现象并减少过剩库存。在每个产品层级进行预测，有助于高效的库存补充。这也对供应链管理产生积极影响。零售行业中一个正在增加应用的相关案例是食品浪费预测和减少。'
- en: '**Price optimization and marketing planning**: Optimal pricing strategies over
    time, maximizing sales and profits, can be determined by analyzing the impact
    of price changes on sales volumes. This includes insight into seasonal price sensitivities,
    impacts of promotions and marketing campaigns, and competitive pricing. This also
    optimizes marketing spend, while better aligning to seasonal patterns.'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**价格优化与营销规划**：通过分析价格变动对销量的影响，可以确定最佳定价策略，从而最大化销售和利润。这包括对季节性价格敏感性、促销和营销活动的影响以及竞争定价的洞察。同时，这也优化了营销支出，更好地与季节性模式对接。'
- en: '**Customer behavior analysis and product life cycle management**: Retailers
    can inform marketing strategies and product development by understanding changes
    in customer buying habits over time. This analysis helps identify trends, such
    as changes in purchasing channels or increasing interest in product categories.
    This, in turn, improves decisions about product introductions, discontinuation,
    or relaunches. With better customer behavior analysis, it is also possible to
    develop effective loyalty projects, resulting in improved customer retention.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**客户行为分析与产品生命周期管理**：零售商可以通过了解客户购买习惯随时间的变化，来指导营销策略和产品开发。此分析有助于识别趋势，如购买渠道的变化或对某些产品类别的兴趣增加。这反过来有助于在产品推出、停产或重新上市方面做出更好的决策。通过更深入的客户行为分析，还可以制定有效的忠诚度项目，从而提高客户留存率。'
- en: '**Store performance analysis and workforce planning**: By comparing the sales
    trends across different locations, this analysis identifies high-performing stores
    and those needing help. This informs decisions about store expansions or closures
    and aligns staffing levels to the right store and busy times. The impact here
    is both on operational efficiency and improved customer service.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**门店表现分析与员工规划**：通过比较不同地点的销售趋势，分析可以识别高表现的门店和需要帮助的门店。这有助于做出有关门店扩张或关闭的决策，并将人员配置与合适的门店及繁忙时段对接。其影响不仅体现在运营效率上，还能改善客户服务。'
- en: The use of time series analysis in retail influences every aspect of the business,
    from inventory and pricing to marketing and workforce management. By leveraging
    historical data, retailers can make informed decisions that enhance operational
    efficiency, customer satisfaction, and profitability.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析在零售中的应用影响着业务的方方面面，从库存和定价到营销和员工管理。通过利用历史数据，零售商可以做出明智的决策，从而提升运营效率、客户满意度和盈利能力。
- en: Healthcare
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 医疗保健
- en: 'Time series analysis in healthcare is an essential tool for tracking health-related
    data over chronological intervals. This method allows for the observation of patterns,
    trends, and changes in health metrics, which can be critical in improving patient
    care, operational efficiency, and clinical outcomes. Here’s an overview of applications
    in healthcare:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析在医疗保健中是跟踪健康相关数据的重要工具。此方法可以观察健康指标的模式、趋势和变化，这对改善患者护理、运营效率和临床结果至关重要。以下是医疗保健中的应用概述：
- en: '**Patient monitoring**: In the continuous monitoring of vital signs (heart
    rate, blood pressure, etc.), time series analysis can be used for real-time assessment
    of patient health and early detection of acute medical events. Similarly, by analyzing
    data from wearable devices, one can monitor trends in physical activity, sleep
    patterns, and other health indicators over time. This can be either in a clinical
    setting or for personal health awareness.'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**患者监测**：在持续监测生命体征（如心率、血压等）时，可以使用时间序列分析对患者健康进行实时评估，并及早发现急性医疗事件。同样，通过分析可穿戴设备的数据，可以监测身体活动、睡眠模式及其他健康指标随时间的变化。这可以在临床环境中进行，也可以用于个人健康意识。'
- en: '**Epidemiology and disease surveillance**: The significance of this requirement
    was highlighted by COVID-19\. The spread of infectious diseases must be tracked
    over time to understand transmission patterns, identify outbreaks, and plan public
    interventions accordingly. At the individual level, patients with a chronic disease
    may need to adjust their treatment plans based on the progression of the disease.
    Though similar, this is different from monitoring vitals in terms of the timescale
    of interventions.'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**流行病学与疾病监测**：这一需求的重要性在COVID-19期间得到了突出体现。必须随着时间推移追踪传染病的传播，以了解传播模式、识别疫情爆发，并相应规划公共干预措施。在个人层面，患有慢性病的患者可能需要根据病情的发展调整治疗计划。虽然相似，但这与监测生命体征在干预时间尺度上有所不同。'
- en: '**Management of hospital resources**: With most public hospitals stretched
    thin, it is a huge benefit to be able to predict hospital admission rates in order
    to optimize bed allocation and staffing.'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**医院资源管理**：由于大多数公立医院的资源紧张，能够预测医院的入院率以优化床位分配和人员安排是一个巨大的优势。'
- en: There are numerous other applications of time series analysis in healthcare,
    such as healthcare quality monitoring, drug development, and medical research,
    and with the COVID-19 pandemic, public health monitoring, analysis, and policy-making.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析在医疗行业有众多其他应用，如医疗质量监测、药物研发和医学研究，尤其是在新冠疫情期间，公共卫生监测、分析和政策制定。
- en: By using time series analysis, the healthcare sector can enhance patient care,
    improve operational efficiencies, and contribute to medical research, ultimately
    leading to better health outcomes and more informed healthcare policies.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用时间序列分析，医疗行业可以提升患者护理质量、提高运营效率，并推动医学研究，最终改善健康结果并推动更为科学的医疗政策。
- en: Manufacturing and utilities
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 制造业和公用事业
- en: 'Time series analysis is important in the manufacturing and utilities sectors
    for ensuring safety, optimizing operations, and improving efficiency. Here’s an
    overview of its use cases in these industries:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析在制造业和公用事业领域至关重要，能够确保安全、优化运营并提高效率。以下是这些行业中时间序列分析的应用概述：
- en: '**Manufacturing**: First, in terms of planning, with demand forecasting, scheduling
    production, and inventory management, time series help meet market demand without
    overproduction. Then, to keep production going, machine sensors send data to predictive
    maintenance models to generate warnings of potential failures, resulting in prompt
    maintenance. This can significantly reduce downtime while saving on unnecessary
    preventive maintenance. Anomaly detection further helps with early detection and
    limitation of quality issues.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**制造业**：首先，在规划方面，通过需求预测、生产调度和库存管理，时间序列帮助满足市场需求而不造成过度生产。然后，为了保持生产运行，机器传感器将数据发送到预测性维护模型，以生成潜在故障的警告，从而进行及时维护。这可以显著减少停机时间，同时节省不必要的预防性维护。异常检测进一步帮助提前发现并限制质量问题。'
- en: '**Oil and gas**: As in manufacturing, predictive maintenance and anomaly detection
    ensure reduced downtime, while maximizing output. Also, with the significant upfront
    investment required in infrastructure in this sector, it is crucial to have good
    forecasting of demand and prices to guide planning.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**石油和天然气**：与制造业类似，预测性维护和异常检测确保减少停机时间，同时最大化产出。此外，由于该领域基础设施需要大量前期投资，因此准确的需求和价格预测对规划至关重要。'
- en: '**Utilities**: The primary use cases in the utilities sector are demand and
    load forecasting, which result in planning, grid management, and development.
    This further leads to optimal grid utilization, with improved customer service,
    while preventing outages. Finally, time series analysis and forecasting of new
    renewal energy sources ensures they can be optimally integrated into the overall
    energy mix.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**公用事业**：公用事业领域的主要应用包括需求和负荷预测，进而帮助规划、配电管理和发展。这进一步促使了电网的最优利用，提高了客户服务，同时防止了停电。最后，时间序列分析和对新能源来源的预测确保它们能够与整体能源结构进行最优整合。'
- en: In all these sectors, time series analysis contributes to resource optimization,
    cost reduction, and strategic planning, ultimately leading to more resilient and
    efficient operations.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有这些领域，时间序列分析有助于资源优化、成本降低和战略规划，最终促进更具韧性和高效的运营。
- en: Note
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 注
- en: A predominant and fast-growing source of time series data is **Internet of Things**
    (**IoT**) devices and sensors. This is due to the explosion in the number of connected
    devices. This data is collected, stored, and analyzed – usually in real time –
    with use cases across industries, some of which have been discussed, from machine
    sensor data used for predictive maintenance to energy meter data to forecast consumption
    to health trackers, and many more.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 一个主要且快速增长的时间序列数据来源是**物联网**（**IoT**）设备和传感器。这是因为连接设备数量的激增。此数据被收集、存储并分析——通常是实时的——应用场景遍及各行各业，其中一些已经讨论过，例如用于预测性维护的机器传感器数据、用于预测消费的能源表数据、健康追踪器等，涵盖范围广泛。
- en: This concludes the section on industry-specific use cases, on the many applications
    of time series analysis to different sectors of activity. The list is ever-expanding
    with frequent innovation on new use cases, driven by new analysis methods and
    new business requirements. Next, we will see some of the time series analysis
    methods in action with industry-specific datasets.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 本节总结了行业特定用例，展示了时间序列分析在不同领域中的广泛应用。随着新分析方法和新业务需求的推动，应用案例不断创新并扩展。接下来，我们将通过行业特定数据集，展示一些时间序列分析方法的实际应用。
- en: Hands-on with selected use cases
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用选定的用例进行动手实践
- en: In this hands-on section, we will go through some selected use cases with industry-specific
    datasets.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一动手实践部分，我们将使用行业特定的数据集，逐步演示一些选定的用例。
- en: Forecasting
  id: totrans-142
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预测
- en: For the forecasting use case, we started with an example on temperatures in
    [*Chapter 1*](B18568_01.xhtml#_idTextAnchor016), where we loaded the dataset,
    analyzed its components, and visualized the result. The focus was on the past
    – that is, historical data. In the following steps, we will highlight the specific
    part of the code related to the future – that is, forecasting. This is based on
    the code in `ts-spark_ch1_2fp`, which we imported into Databricks Community Edition
    in [*Chapter 1*](B18568_01.xhtml#_idTextAnchor016).
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 对于预测用例，我们从 [*第 1 章*](B18568_01.xhtml#_idTextAnchor016) 中关于温度的示例开始，加载数据集，分析其组成并可视化结果。重点放在过去——即历史数据。在接下来的步骤中，我们将重点展示与未来相关的代码部分——即预测。这基于
    `ts-spark_ch1_2fp` 中的代码，我们已将其导入到 Databricks 社区版，并在 [*第 1 章*](B18568_01.xhtml#_idTextAnchor016)
    中详细介绍。
- en: 'The forecasting steps are as follows:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 预测步骤如下：
- en: Load the dataset, which was covered in [*Chapter 1*](B18568_01.xhtml#_idTextAnchor016).
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载数据集，内容详见 [*第 1 章*](B18568_01.xhtml#_idTextAnchor016)。
- en: 'Using the `Prophet` library, the model is created and trained (fit) on the
    data:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `Prophet` 库，模型在数据上创建并训练（拟合）：
- en: '[PRE0]'
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'We then use a very handy function in Prophet to generate future dates, `make_future_dataframe`.
    These will be required as input, and passed as parameters, to do the prediction
    part, which is with the `predict` function:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接着我们使用 Prophet 中一个非常有用的函数 `make_future_dataframe` 来生成未来日期。这些日期将作为输入，并作为参数传递，用于进行预测部分，即使用
    `predict` 函数：
- en: '[PRE1]'
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: plot_plotly(model, forecast, changepoints=True)
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: plot_plotly(model, forecast, changepoints=True)
- en: '[PRE2]'
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](img/B18568_02_5.jpg)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18568_02_5.jpg)'
- en: 'Figure 2.5: Forecasting temperature'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.5：温度预测
- en: This was a brief hands-on introduction to forecasting. We will be doing more
    forecasting, including with other libraries in addition to Prophet, in the rest
    of this book.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 这是对预测的简要动手实践介绍。接下来我们将在本书的其他部分进行更多的预测，包括使用除 Prophet 之外的其他库。
- en: Pattern classification
  id: totrans-155
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模式分类
- en: For pattern classification, we will use financial time series – more specifically,
    share prices of technology companies. We will explore the use of two different
    open source libraries for DTW, `fastdtw` and `dtw-python`. This is based on the
    code in `ts-spark_ch2_1.dbc`, which we can import from the GitHub location for
    [*Chapter 2*](B18568_02.xhtml#_idTextAnchor044) into Databricks Community Edition,
    as per the approach explained in [*Chapter 1*](B18568_01.xhtml#_idTextAnchor016).
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 对于模式分类，我们将使用金融时间序列——更具体地说，科技公司股票的股价。我们将探讨使用两个不同的开源库进行 DTW，分别是 `fastdtw` 和 `dtw-python`。这基于
    `ts-spark_ch2_1.dbc` 中的代码，我们可以从 GitHub 上的链接导入，并按照 [*第 1 章*](B18568_01.xhtml#_idTextAnchor016)
    中的说明，将其导入到 Databricks 社区版中。
- en: 'The code URL is as follows:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 代码 URL 如下所示：
- en: '[https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch2/ts-spark_ch2_1.dbc](https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch2/ts-spark_ch2_1.dbc)'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch2/ts-spark_ch2_1.dbc](https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch2/ts-spark_ch2_1.dbc)'
- en: 'Let’s start with `fastdtw` with the following code steps:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从 `fastdtw` 开始，以下是步骤代码：
- en: 'First, we import the necessary libraries:'
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们导入必要的库：
- en: '[PRE3]'
  id: totrans-161
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: from_date = "2019-01-01"
  id: totrans-162
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: from_date = "2019-01-01"
- en: to_date = "2024-01-01"
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: to_date = "2024-01-01"
- en: yftickers = [
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: yftickers = [
- en: '"AAPL", "AMZN", "GOOG", "META",'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '"AAPL", "AMZN", "GOOG", "META",'
- en: '"MSFT", "NVDA", "PYPL", "TSLA"]'
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '"MSFT", "NVDA", "PYPL", "TSLA"]'
- en: yfdata = {
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: yfdata = {
- en: 'yftick: yf.download('
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'yftick: yf.download('
- en: 'yftick, start=from_date, end=to_date, multi_level_index=False)[fastdtw library
    is used to calculate the DTW distances for each pair of stocks:'
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: yftick, start=from_date, end=to_date, multi_level_index=False)[使用 fastdtw 库来计算每对股票的
    DTW 距离：
- en: '[PRE4]'
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'We then plot the distance matrix using a heatmap with the following code:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后我们使用以下代码绘制距离矩阵的热图：
- en: '[PRE6]'
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: This creates the visualization in *Figure 2**.6*, where the value of the DTW
    distance between AMZN and GOOG share prices is highlighted. Of the combination
    of shares analyzed, these two are the nearest to each other compared to the other
    DTW distances.
  id: totrans-174
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这创建了*图2**.6*中的可视化，其中突出显示了AMZN和GOOG股价之间的DTW距离值。在分析的股票组合中，这两个股票的DTW距离最接近其他股价。
- en: '![](img/B18568_02_6.jpg)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18568_02_6.jpg)'
- en: 'Figure 2.6: DTW distance heatmap'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.6：DTW距离热图
- en: The line showing the DTW distance measurement between the two time series, AMZN
    and GOOG, is visualized in *Figure 2**.2*.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 显示AMZN和GOOG两个时间序列之间DTW距离测量的线在*图2**.2*中可视化展示。
- en: 'The plot of the time series for all the tickers is simply done with the following:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 所有股票代码的时间序列图可以通过以下代码简单地生成：
- en: '[PRE7]'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'This creates *Figure 2**.7*:'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这创建了*图2**.7*：
- en: '![](img/B18568_02_7.jpg)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18568_02_7.jpg)'
- en: 'Figure 2.7: Selected technology share prices'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.7：选定的技术股价格
- en: 'We use the following code with the `dtw-python` library to generate the alignment
    plot in *Figure 2**.2*:'
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们使用以下代码和`dtw-python`库来生成*图2**.2*中的对齐图：
- en: '[PRE8]'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This concludes a brief hands-on introduction to pattern classification – more
    specifically, the initial step of distance calculation for the distance-based
    method using DTW, as applied to financial time series. Following this step, you
    can then apply the kNN classification algorithm.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 这结束了模式分类的简要实践介绍——更具体地说，是基于DTW的距离计算方法的初步步骤，应用于金融时间序列。在这一步之后，你可以继续应用kNN分类算法。
- en: Anomaly detection
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 异常检测
- en: In the final hands-on example of this chapter, we will explore an anomaly detection
    use case applied to energy consumption for a household. This is based on the code
    in `ts-spark_ch2_2.dbc`, and the dataset in `ts-spark_ch2_ds2.csv`. We import
    the code into Databricks Community Edition, as per the approach explained in [*Chapter
    1*](B18568_01.xhtml#_idTextAnchor016).
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的最后一个实践示例中，我们将探讨应用于家庭能耗的异常检测用例。这基于`ts-spark_ch2_2.dbc`中的代码，以及`ts-spark_ch2_ds2.csv`中的数据集。我们将按照[*第1章*](B18568_01.xhtml#_idTextAnchor016)中解释的方法，将代码导入到Databricks社区版中。
- en: 'The code URL is as follows: [https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch2/ts-spark_ch2_2.dbc](https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch2/ts-spark_ch2_2.dbc)'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 代码网址如下：[https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch2/ts-spark_ch2_2.dbc](https://github.com/PacktPublishing/Time-Series-Analysis-with-Spark/raw/main/ch2/ts-spark_ch2_2.dbc)
- en: 'The code steps follow:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 代码步骤如下：
- en: 'First, we import the necessary libraries:'
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们导入必要的库：
- en: '[PRE9]'
  id: totrans-191
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: As discussed earlier in this chapter, isolation forest is a tree-based model
    that can be used for isolating anomalies.
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 正如本章早些时候所讨论的，Isolation Forest是一种基于树的模型，可以用来隔离异常值。
- en: 'Spark is used to read the dataset:'
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Spark读取数据集：
- en: '[PRE10]'
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Note that this is a different yet equivalent syntax to `spark.load()`, which
    we used in [*Chapter 1*](B18568_01.xhtml#_idTextAnchor016).
  id: totrans-195
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，这是与我们在[*第1章*](B18568_01.xhtml#_idTextAnchor016)中使用的`spark.load()`不同但等效的语法。
- en: 'To enable calculations on the columns’ value, we need to change the data types
    of the columns from string to double:'
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了进行列值的计算，我们需要将列的数据类型从字符串更改为双精度：
- en: '[PRE11]'
  id: totrans-197
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'We then choose the first part of the dataset to use for training the model:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们选择数据集的第一部分用于训练模型：
- en: '[PRE12]'
  id: totrans-199
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The Isolation Forest model can then be created and fitted to the training dataset:'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后可以创建并拟合Isolation Forest模型到训练数据集：
- en: '[PRE13]'
  id: totrans-201
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The model can then be used to flag the anomalies in the full dataset:'
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后可以使用该模型标记完整数据集中的异常：
- en: '[PRE14]'
  id: totrans-203
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Finally, to show the result in *Figure 2**.3*:'
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，为了显示*图2**.3*中的结果：
- en: '[PRE15]'
  id: totrans-205
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: This completes the hands-on introduction to anomaly detection using an energy
    consumption time series. As discussed in this chapter, Isolation Forest, used
    here, is just one of many methods available.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 这完成了使用能耗时间序列进行异常检测的实践介绍。正如本章所讨论的，Isolation Forest方法在此处使用，但这只是众多可用方法之一。
- en: Summary
  id: totrans-207
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we focused on the practical significance of analyzing time
    series data for predictive modeling, trend identification, and anomaly detection.
    We viewed real-world applications across industries, highlighting the importance
    of time series analysis while getting some practice with two different sector-specific
    datasets.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们重点讨论了分析时间序列数据在预测建模、趋势识别和异常检测中的实际意义。我们回顾了各行各业的实际应用，突出了时间序列分析的重要性，并且实践了两个不同领域的数据集。
- en: Before we can scale these and other use cases, we need an additional key component,
    Apache Spark, to which you will be introduced in the next chapter.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们能够扩展这些及其他用例之前，我们需要一个额外的关键组件——Apache Spark，您将在下一章中了解它。
- en: Further reading
  id: totrans-210
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'This section serves as a repository of sources that can help you build on your
    understanding of the topic:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 本节作为一个资料库，汇集了可以帮助您加深对该主题理解的资源：
- en: '*Time Series Analysis - Data, Methods, and Applications*, edited by Chun-Kit
    Ngan: [https://www.intechopen.com/books/8362](https://www.intechopen.com/books/8362)'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《时间序列分析 - 数据、方法与应用》*，由 Chun-Kit Ngan 编著：[https://www.intechopen.com/books/8362](https://www.intechopen.com/books/8362)'
- en: '**Financial services:**'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**金融服务：**'
- en: '*Essentials of Time Series for Financial Applications* by Massimo Guidolin
    and Manuela Pedio: [https://www.sciencedirect.com/book/9780128134092/essentials-of-time-series-for-financial-applications](https://www.sciencedirect.com/book/9780128134092/essentials-of-time-series-for-financial-applications)'
  id: totrans-214
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《金融应用中的时间序列基础》*（Massimo Guidolin 和 Manuela Pedio 著）：[https://www.sciencedirect.com/book/9780128134092/essentials-of-time-series-for-financial-applications](https://www.sciencedirect.com/book/9780128134092/essentials-of-time-series-for-financial-applications)'
- en: '*Time-Series Forecasting Techniques for Banking Variables* by Arindam Bandyopadhyay:
    [https://academic.oup.com/book/43110/chapter-abstract/361614151?redirectedFrom=fulltext&login=false](https://academic.oup.com/book/43110/chapter-abstract/361614151?redirectedFrom=fulltext&login=false)'
  id: totrans-215
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《银行变量的时间序列预测技术》*（Arindam Bandyopadhyay 著）：[https://academic.oup.com/book/43110/chapter-abstract/361614151?redirectedFrom=fulltext&login=false](https://academic.oup.com/book/43110/chapter-abstract/361614151?redirectedFrom=fulltext&login=false)'
- en: '**Retail:**'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**零售业：**'
- en: '*A profit prediction model with time series analysis for retail store* by Sridevi
    U. K. and Shanthi P: [https://www.researchgate.net/publication/325882164_A_profit_prediction_model_with_time_series_analysis_for_retail_store](https://www.researchgate.net/publication/325882164_A_profit_prediction_model_with_time_series_analysis_for_retail_store)'
  id: totrans-217
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《基于时间序列分析的零售店盈利预测模型》*（Sridevi U. K. 和 Shanthi P 著）：[https://www.researchgate.net/publication/325882164_A_profit_prediction_model_with_time_series_analysis_for_retail_store](https://www.researchgate.net/publication/325882164_A_profit_prediction_model_with_time_series_analysis_for_retail_store)'
- en: '*A Comparative Study on Forecasting of Retail Sales* (Hasan et al., 2022):
    [https://arxiv.org/pdf/2203.06848.pdf](https://arxiv.org/pdf/2203.06848.pdf)'
  id: totrans-218
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《零售销售预测的比较研究》*（Hasan 等，2022）：[https://arxiv.org/pdf/2203.06848.pdf](https://arxiv.org/pdf/2203.06848.pdf)'
- en: '**Healthcare:**'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**医疗保健：**'
- en: '*AI in Healthcare: Time-Series Forecasting Using Statistical, Neural, and Ensemble
    Architectures* (Kaushik et al., 2020): [https://www.frontiersin.org/articles/10.3389/fdata.2020.00004/full](https://www.frontiersin.org/articles/10.3389/fdata.2020.00004/full)'
  id: totrans-220
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《医疗领域的人工智能：使用统计、神经网络和集成架构进行时间序列预测》*（Kaushik 等，2020）：[https://www.frontiersin.org/articles/10.3389/fdata.2020.00004/full](https://www.frontiersin.org/articles/10.3389/fdata.2020.00004/full)'
- en: '*Time Series Forecasting for Healthcare Diagnosis and Prognostics with the
    Focus on Cardiovascular Diseases* (Bui et al., 2018): [https://www.researchgate.net/publication/320002542_Time_Series_Forecasting_for_Healthcare_Diagnosis_and_Prognostics_with_the_Focus_on_Cardiovascular_Diseases](https://www.researchgate.net/publication/320002542_Time_Series_Forecasting_for_Healthcare_Diagnosis_and_Prognostics_with_the_Focus_on_Cardiovascular_Diseases)'
  id: totrans-221
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《聚焦心血管疾病的医疗诊断和预后时间序列预测》*（Bui 等，2018）：[https://www.researchgate.net/publication/320002542_Time_Series_Forecasting_for_Healthcare_Diagnosis_and_Prognostics_with_the_Focus_on_Cardiovascular_Diseases](https://www.researchgate.net/publication/320002542_Time_Series_Forecasting_for_Healthcare_Diagnosis_and_Prognostics_with_the_Focus_on_Cardiovascular_Diseases)'
- en: '**Manufacturing** **and utilities:**'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**制造业** **与公用事业：**'
- en: '*Time Series Prediction in Industry 4.0: A Comprehensive Review and Prospects
    for Future Advancements* (Kashpruk et al., 2023): [https://www.mdpi.com/2076-3417/13/22/12374](https://www.mdpi.com/2076-3417/13/22/12374)'
  id: totrans-223
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《工业4.0中的时间序列预测：全面综述及未来发展展望》*（Kashpruk 等，2023）：[https://www.mdpi.com/2076-3417/13/22/12374](https://www.mdpi.com/2076-3417/13/22/12374)'
- en: '*Time-series pattern recognition in Smart Manufacturing Systems: A literature
    review and ontology* (Farahani et al., 2023): [https://www.sciencedirect.com/science/article/pii/S0278612523000997](https://www.sciencedirect.com/science/article/pii/S0278612523000997)'
  id: totrans-224
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《智能制造系统中的时间序列模式识别：文献综述与本体分析》*（Farahani 等，2023）：[https://www.sciencedirect.com/science/article/pii/S0278612523000997](https://www.sciencedirect.com/science/article/pii/S0278612523000997)'
- en: '*Measuring the energy intensity of domestic activities from smart meter data*
    (Stankovic et al., 2016): [https://www.sciencedirect.com/science/article/pii/S0306261916313897](https://www.sciencedirect.com/science/article/pii/S0306261916313897)'
  id: totrans-225
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从智能电表数据测量家庭活动的能量强度*（Stankovic 等人，2016年）：[https://www.sciencedirect.com/science/article/pii/S0306261916313897](https://www.sciencedirect.com/science/article/pii/S0306261916313897)'
- en: '**Libraries:**'
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**库：**'
- en: 'FastDTW: [http://cs.fit.edu/~pkc/papers/tdm04.pdf](http://cs.fit.edu/~pkc/papers/tdm04.pdf)'
  id: totrans-227
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'FastDTW: [http://cs.fit.edu/~pkc/papers/tdm04.pdf](http://cs.fit.edu/~pkc/papers/tdm04.pdf)'
- en: 'dtw-python: [https://dynamictimewarping.github.io/python/](https://dynamictimewarping.github.io/python/)'
  id: totrans-228
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'dtw-python: [https://dynamictimewarping.github.io/python/](https://dynamictimewarping.github.io/python/)'
- en: Join our community on Discord
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加入我们的 Discord 社区
- en: 'Join our community’s Discord space for discussions with the authors and other
    readers:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 加入我们社区的 Discord 空间，与作者和其他读者进行讨论：
- en: '[https://packt.link/ds](https://packt.link/ds)'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/ds](https://packt.link/ds)'
- en: '![](img/ds_(1).jpg)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ds_(1).jpg)'
