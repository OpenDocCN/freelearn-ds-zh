- en: Chapter 2. Inference
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二章 推断
- en: '|   | *"I can see nothing," said I, handing it back to my friend.**"On the
    contrary, Watson, you can see everything. You fail, however, to reason from what
    you see. You are too timid in drawing your inferences."* |   |'
  id: totrans-1
  prefs: []
  type: TYPE_TB
  zh: '|   | *“我什么也看不见，”我说着，把它递还给我的朋友。**“相反，沃森，你什么都看得见。你只是没有从你所见的事物中推理出来。然而，你在得出结论时过于胆怯。”*
    |   |'
- en: '|   | --*Sir Arthur Conan Doyle, The Adventure of the Blue Carbuncle* |'
  id: totrans-2
  prefs: []
  type: TYPE_TB
  zh: '|   | --*阿瑟·柯南·道尔，《蓝宝石冒险》* |'
- en: In the previous chapter, we introduced a variety of numerical and visual approaches
    to understand the normal distribution. We discussed descriptive statistics, such
    as the mean and standard deviation, and how they can be used to summarize large
    amounts of data succinctly.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们介绍了多种数值和视觉方法来理解正态分布。我们讨论了描述性统计量，例如均值和标准差，以及它们如何用于简洁地总结大量数据。
- en: A dataset is usually a sample of some larger population. Sometimes, this population
    is too large to be measured in its entirety. Sometimes, it is intrinsically unmeasurable,
    either because it is infinite in size or it otherwise cannot be accessed directly.
    In either case, we are forced to generalize from the data that we have.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集通常是某个更大总体的样本。有时，这个总体过于庞大，无法完全测量。有时，它本质上是无法测量的，可能是因为它的大小是无限的，或因为其他原因无法直接访问。无论是哪种情况，我们都不得不从已有的数据中进行概括。
- en: 'In this chapter, we consider statistical inference: how we can go beyond simply
    describing the samples of data and instead describe the population from which
    they were sampled. We''ll look in detail at how confident we can be about the
    inferences we make from the samples of data. We''ll cover hypothesis testing:
    a robust approach to data analysis that puts the science in data science. We''ll
    also implement an interactive web page with ClojureScript to simulate the relationship
    between samples and the population from which they are taken.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论统计推断：如何超越仅仅描述数据样本，而是描述它们来自的总体。我们将详细探讨我们对从数据样本中得出的推断的置信度。我们还将讨论假设检验：一种强健的数据分析方法，它将科学带入数据科学。我们还将使用ClojureScript实现一个交互式网页，以模拟样本与它们所来自总体之间的关系。
- en: To help illustrate the principles, we'll invent a fictional company, AcmeContent,
    that has recently hired us as a data scientist.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助说明这些原理，我们将虚构一个公司——AcmeContent，假设它最近聘请我们作为数据科学家。
- en: Introducing AcmeContent
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍AcmeContent
- en: To help illustrate the concepts in this chapter, let's imagine that we've recently
    been appointed for the data scientist role at AcmeContent. The company runs a
    website that lets visitors share video clips that they've enjoyed online.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助说明本章的概念，假设我们最近被聘为AcmeContent公司的数据科学家。该公司运营着一个网站，让访问者分享他们在网上喜欢的视频片段。
- en: One of the metrics AcmeContent tracks through its web analytics is **dwell time**.
    This is a measure of how long a visitor stays on the site. Clearly, visitors who
    spend a long time on the site are enjoying themselves and AcmeContent wants its
    visitors to stay as long as possible. If the mean dwell time increases, our CEO
    will be very happy.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: AcmeContent通过其网站分析跟踪的一个指标是**停留时间**。这是衡量访问者在网站上停留多久的指标。显然，花费较长时间在网站上的访问者通常是在享受网站的内容，AcmeContent希望访问者尽可能长时间停留。如果平均停留时间增加，我们的首席执行官将非常高兴。
- en: Note
  id: totrans-10
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Dwell time is the length of time between the time a visitor first arrives at
    a website and the time they make their last request to your site.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 停留时间是指访问者第一次到达网站和他们做出最后一次请求之间的时间长度。
- en: A **bounce** is a visitor who makes only one request—their dwell time is zero.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '**跳出率**是指只做出一次请求的访问者——他们的停留时间为零。'
- en: As the company's new data scientist, it falls to us to analyze the dwell time
    reported by the website's analytics and measure the success of AcmeContent's site.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 作为公司的新数据科学家，我们的任务是分析网站分析报告中的停留时间，并衡量AcmeContent网站的成功程度。
- en: Download the sample code
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 下载示例代码
- en: The code for this chapter is available at [https://github.com/clojuredatascience/ch2-inference](https://github.com/clojuredatascience/ch2-inference)
    or from the Packt Publishing's website.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的代码可以在[https://github.com/clojuredatascience/ch2-inference](https://github.com/clojuredatascience/ch2-inference)上找到，也可以从Packt
    Publishing的网站获取。
- en: The example data has been generated specifically for this chapter. It's small
    enough that it has been included with the book's sample code inside the data directory.
    Consult the book's wiki at [http://wiki.clojuredatascience.com](http://wiki.clojuredatascience.com)
    for links to further read about dwell time analysis.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这个示例数据是专门为本章生成的。它足够小，因此已与书中的示例代码一起包含在数据目录中。请查阅本书的 wiki：[http://wiki.clojuredatascience.com](http://wiki.clojuredatascience.com)以获取关于停留时间分析的进一步阅读链接。
- en: Load and inspect the data
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加载并检查数据
- en: In the previous chapter, we used Incanter to load Excel spreadsheets with the
    `incanter.excel/load-xls` function. In this chapter, we will load a dataset from
    a tab-separated text file. For this, we'll make use of `incanter.io/read-dataset`
    that expects to receive either a URL object or a file path represented as a string.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们使用 Incanter 的`incanter.excel/load-xls`函数加载了 Excel 电子表格。在本章中，我们将从一个以制表符分隔的文本文件中加载数据集。为此，我们将使用`incanter.io/read-dataset`，它期望接收一个
    URL 对象或一个表示文件路径的字符串。
- en: 'The file has been helpfully reformatted by AcmeContent''s web team to contain
    just two columns—the date of the request and the dwell time in seconds. There
    are column headings in the first row, so we pass `:header true` to `read-dataset`:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 该文件已由 AcmeContent 的网页团队进行了有益的重新格式化，包含了两列——请求日期和停留时间（单位：秒）。第一行是列标题，因此我们向`read-dataset`传递`:header
    true`：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'If you run this code (either in the REPL or on the command line with `lein
    run –e 2.1`), you should see an output similar to the following:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你运行这段代码（无论是在 REPL 中还是通过命令行使用`lein run –e 2.1`），你应该会看到类似如下的输出：
- en: '![Load and inspect the data](img/7180OS_02_100.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![加载并检查数据](img/7180OS_02_100.jpg)'
- en: Let's see what the dwell times look like as a histogram.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看停留时间以直方图的形式呈现出来是什么样的。
- en: Visualizing the dwell times
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可视化停留时间
- en: 'We can plot a histogram of dwell times by simply extracting the `:dwell-time`
    column with `i/$`:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过简单地使用`i/$`提取`:dwell-time`列来绘制停留时间的直方图：
- en: '[PRE1]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The earlier code generates the following histogram:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 之前的代码生成了以下的直方图：
- en: '![Visualizing the dwell times](img/7180OS_02_110.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![可视化停留时间](img/7180OS_02_110.jpg)'
- en: This is clearly not a normally distributed data, nor even a very skewed normal
    distribution. There is no tail to the left of the peak (a visitor clearly can't
    be on our site for less than zero seconds). While the data tails off steeply to
    the right at first, it extends much further along the *x* axis than we would expect
    from normally distributed data.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，这不是一个正态分布的数据，甚至也不是一个非常偏斜的正态分布。峰值左侧没有尾部（访客显然不可能在我们的网站停留不到零秒）。虽然数据开始时右侧急剧下降，但它沿着*x*轴延伸得比我们从正态分布数据中预期的要远得多。
- en: When confronted with distributions like this, where values are mostly small
    but occasionally extreme, it can be useful to plot the *y* axis as a **log scale**.
    Log scales are used to represent events that cover a very large range. Chart axes
    are ordinarily linear and they partition a range into equally sized steps like
    the "number line" we learned at school. Log scales partition the range into steps
    that get larger and larger as they go further away from the origin.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 当遇到像这样的分布时，其中大部分值都很小，但偶尔出现极端值，使用**对数尺度**绘制*y*轴可能会很有用。对数尺度用于表示覆盖非常大范围的事件。通常，图表的坐标轴是线性的，它们将一个范围分割成相等大小的步骤，就像我们在学校学过的“数字线”。对数尺度则将范围分割成随着离原点越来越远而逐渐增大的步骤。
- en: Some systems of measurement for natural phenomena that cover a very large range
    are represented on a log scale. For example, the Richter magnitude scale for earthquakes
    is a base-10 logarithmic scale, which means that an earthquake measuring 5 on
    the Richter scale is 10 times the magnitude of an earthquake measuring 4\. The
    decibel scale is also a logarithmic scale with a different base—a sound wave of
    30 decibels has 10 times the magnitude of a sound wave of 20 decibels. In each
    case, the principle is the same—the use of a log scale allows a very large range
    of values to be compressed into a much smaller range.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 一些测量自然现象的系统，涵盖了非常大的范围，通常会使用对数尺度表示。例如，地震的里氏震级就是一个以 10 为底的对数尺度，这意味着震级为 5 的地震是震级为
    4 的地震的 10 倍。分贝尺度也是一个对数尺度，但它有不同的底数——30 分贝的声波的强度是 20 分贝声波的 10 倍。在每种情况下，原理都是一样的——使用对数尺度可以将一个非常大的值范围压缩到一个更小的范围内。
- en: 'Plotting our *y* axis on `log-axis` is simple with Incanter with `c/set-axis`:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Incanter 中，通过`c/set-axis`将我们的*y*轴绘制为`log-axis`非常简单：
- en: '[PRE2]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: By default Incanter will use a base-10 log scale, meaning that each tick on
    the axis represents a range that is 10 times the previous step. A chart like this—where
    only one axis is shown on a log scale—is called **log-linear**. Unsurprisingly,
    a chart showing two log axes is called a **log-log chart**.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Incanter将使用以10为底的对数尺度，这意味着轴上的每一个刻度代表的范围是前一步的10倍。像这样的图表——只有一个轴是对数尺度——称为**对数-线性**图。毫不奇怪，显示两个对数轴的图表称为**对数-对数图**。
- en: '![Visualizing the dwell times](img/7180OS_02_120.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![可视化停留时间](img/7180OS_02_120.jpg)'
- en: Plotting dwell times on a log-linear plot shows hidden consistency in the data—there
    is a linear relationship between the dwell time and the logarithm of the frequency.
    The clarity of the relationship breaks down to the right of the plot where there
    are fewer than 10 visitors but, aside from this, the relationship is remarkably
    consistent.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在对数-线性图上绘制停留时间能够显示数据中的隐藏一致性——停留时间与频率的对数之间存在线性关系。除了图表右侧（那里的访问者少于10个）出现关系不再清晰外，其他部分该关系非常一致。
- en: A straight line on a log-linear plot is a clear indicator of an exponential
    distribution.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在对数-线性图上，直线是指数分布的明显指示。
- en: The exponential distribution
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 指数分布
- en: The exponential distribution occurs frequently when considering situations where
    there are many small positive quantities and much fewer larger quantities. Given
    what we have learned about the Richter scale, it won't be a surprise to learn
    that the magnitude of earthquakes follows an exponential distribution.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 指数分布通常出现在考虑有许多小的正量和较少的较大量的情况时。根据我们对里氏震级的了解，地震的震级遵循指数分布这一点应该不会令人惊讶。
- en: The distribution also frequently occurs in waiting times—the time until the
    next earthquake of any magnitude roughly follows an exponential distribution as
    well. The distribution is often used to model failure rates, which is essentially
    the waiting time until a machine breaks down. Our exponential distribution models
    a process similar to failure—the waiting time until a visitor gets bored and leaves
    our site.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 该分布也经常出现在等待时间中——直到下一次任何震级的地震发生的时间大致也遵循指数分布。该分布常用于建模故障率，本质上是指机器故障的等待时间。我们的指数分布模型类似于故障过程——即访问者厌倦并离开我们网站的等待时间。
- en: 'The exponential distribution has a number of interesting properties. One relates
    to the mean and standard deviation:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 指数分布具有许多有趣的性质。其中之一与均值和标准差有关：
- en: '[PRE3]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The mean and standard deviations are very similar. In fact, for an ideal exponential
    distribution, they are exactly the same. This property holds true for all the
    exponential distributions—as the mean increases, so does the standard deviation.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 均值和标准差非常相似。实际上，对于理想的指数分布，它们是完全相同的。这个特性适用于所有的指数分布——均值越大，标准差也越大。
- en: Note
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For exponential distributions, the mean and standard deviations are equal.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 对于指数分布，均值和标准差相等。
- en: A second property of the exponential distribution is that it is **memoryless**.
    This is a counterintuitive property best illustrated by an example. We expect
    that as a visitor continues to browse our site, the probability of them getting
    bored and leaving increases. Since the mean dwell time is 93 seconds, it might
    appear that beyond 93 seconds, they are less and less likely to continue browsing.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 指数分布的第二个特性是它是**无记忆**的。这是一个与直觉相反的特性，最好的说明方法是通过一个例子来展示。我们通常认为，随着访问者继续浏览我们的网站，他们厌倦并离开的概率会增加。由于平均停留时间为93秒，因此可能会出现这样的想法：超过93秒后，他们继续浏览的可能性会越来越小。
- en: The memoryless property of exponential distributions tells us that the probability
    of a visitor staying on our site for another 93 seconds is exactly the same whether
    they have already been browsing the site for 93 seconds, 5 minutes, an hour, or
    they have just arrived.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 指数分布的无记忆特性告诉我们，访问者在我们的网站上停留额外93秒的概率，与他们已经浏览了93秒、5分钟、1小时，还是刚刚到达网站时的浏览时间无关。
- en: Note
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For a memoryless distribution, the probability of continuing for an additional
    *x* minutes is not affected by how much time has already elapsed.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 对于无记忆分布，继续再等额外的*x*分钟的概率与已经经过的时间无关。
- en: The memoryless property of exponential distributions goes some way towards explaining
    why it is so difficult to predict when an earthquake will occur next. We must
    rely on other evidence (such as a disturbance in geomagnetism) rather than the
    elapsed time.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 指数分布的记忆无关特性在一定程度上解释了为何如此难以预测地震何时发生。我们必须依赖其他证据（例如地磁扰动），而非时间的流逝。
- en: Since the median dwell time is 64 seconds, about half of our visitors are staying
    on the site for only around a minute. A mean of 93 seconds shows that some visitors
    are staying much longer than that. These statistics have been calculated on all
    the visitors over the last 6 months. It might be interesting to see how these
    statistics vary per day. Let's calculate this now.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 由于中位数停留时间为64秒，大约一半的访客只在网站停留约一分钟。平均值93秒表明，有些访客停留的时间要长得多。这些统计数据是基于过去6个月所有访客计算的。可能有趣的是，看看这些统计数据在每天的变化。让我们现在计算一下。
- en: The distribution of daily means
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日均值分布
- en: The file provided by the web team includes the timestamp of the visit. In order
    to aggregate by day, it's necessary to remove the time portion from the date.
    While we could do this with string manipulation, a more flexible approach would
    be to use a date and time library such as `clj-time` ([https://github.com/clj-time/clj-time](https://github.com/clj-time/clj-time))
    to parse the string. This will allow us to not only remove the time, but also
    perform arbitrarily complex filters (such as filtering to particular days of the
    week or the first or last day of the month, for example).
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 网络团队提供的文件包含了访问的时间戳。为了按天汇总数据，我们需要从日期中移除时间部分。虽然我们可以通过字符串操作来完成这一任务，但更灵活的方法是使用日期和时间库，如`clj-time`（[https://github.com/clj-time/clj-time](https://github.com/clj-time/clj-time)）来解析字符串。这将不仅使我们能够移除时间，还能执行任意复杂的过滤操作（例如，筛选特定的星期几，或每月的第一天或最后一天）。
- en: 'The `clj-time.predicates` namespace contains a variety of useful predicates
    and the `clj-time.format` namespace contains parsing functions that will attempt
    to convert the string to a date-time object using predefined standard formats.
    If our timestamp wasn''t already in a standard format, we could use the same namespace
    to build a custom formatter. Consult the `clj-time` documentation for more information
    and many usage examples:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '`clj-time.predicates` 命名空间包含了多种有用的谓词，而 `clj-time.format` 命名空间包含了尝试使用预定义的标准格式将字符串转换为日期时间对象的解析函数。如果我们的时间戳不是标准格式，我们可以使用相同的命名空间构建自定义格式化器。更多信息和使用示例，请参考
    `clj-time` 文档：'
- en: '[PRE4]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Combining the previous functions allows us to calculate the mean, median, and
    standard deviation for the daily mean dwell times:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 将前面的函数结合起来，我们可以计算日均停留时间的平均值、中位数和标准差：
- en: '[PRE5]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The mean value of our daily means is 90.2 seconds. This is close to the mean
    value we calculated previously on the whole dataset, including weekends. The standard
    deviation is much lower though, just 3.7 seconds. In other words, the distribution
    of daily means has a much lower standard deviation than the entire dataset. Let''s
    plot the daily mean dwell times on a chart:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的日均值的平均值是90.2秒。这个值接近我们之前计算的整个数据集（包括周末）的平均值。然而，标准差要低得多，仅为3.7秒。换句话说，日均值的分布比整个数据集的标准差要小得多。接下来，让我们在图表上绘制日均停留时间：
- en: '[PRE6]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'This code generates the following histogram:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码生成了以下的直方图：
- en: '![The distribution of daily means](img/7180OS_02_130.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![日均值分布](img/7180OS_02_130.jpg)'
- en: The distribution of sample means is distributed symmetrically around the overall
    grand mean value of 90 seconds with a standard deviation of 3.7 seconds. Unlike
    the distribution from which these means were sampled—the exponential distribution—the
    distribution of sample means is normally distributed.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 样本均值的分布围绕整体总均值90秒对称，标准差为3.7秒。与这些均值抽样的分布——指数分布不同，样本均值的分布呈正态分布。
- en: The central limit theorem
  id: totrans-63
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 中心极限定理
- en: We encountered the central limit theorem in the previous chapter when we took
    samples from a uniform distribution and averaged them. In fact, the central limit
    theorem works for any distribution of values, provided the distribution has a
    finite standard deviation.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在上一章中遇到了中心极限定理，当时我们从均匀分布中取样并对其求平均。实际上，中心极限定理适用于任何值的分布，只要该分布的标准差是有限的。
- en: Note
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The central limit theorem states that the distribution of sample means will
    be normally distributed irrespective of the distribution from which they were
    calculated.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 中心极限定理指出，不管样本是从哪种分布中计算出来的，样本均值的分布将是正态分布。
- en: It doesn't matter that the underlying distribution is exponential—the central
    limit theorem shows that the mean of random samples taken from any distribution
    will closely approximate a normal distribution. Let's plot a normal curve over
    our histogram to see how closely it matches.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 无论基础分布是否为指数分布，都不重要——中心极限定理表明，从任何分布中随机抽取的样本的均值将接近正态分布。让我们在直方图上绘制正态曲线，看看它与实际数据的匹配程度。
- en: 'To plot a normal curve over our histogram, we have to plot our histogram as
    a density histogram. This plots the proportion of all the points that have been
    put in each bucket rather than the frequency. We can then overlay the normal probability
    density with the same mean and standard deviation:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在我们的直方图上绘制正态曲线，我们必须将直方图绘制为密度直方图。这样绘制的是每个桶中所有数据点的比例，而不是频率。然后，我们可以叠加具有相同均值和标准差的正态概率密度：
- en: '[PRE7]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'This code generates the following chart:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 该代码生成了以下图表：
- en: '![The central limit theorem](img/7180OS_02_140.jpg)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![中心极限定理](img/7180OS_02_140.jpg)'
- en: The normal curve plotted over the histogram has a standard deviation of approximately
    3.7 seconds. In other words, this quantifies the variation of each daily mean
    being relative to the grand mean of 90 seconds. We can think of each day's mean
    as a sample from the overall population with the earlier curve representing the
    distribution of the sample means. Because 3.7 seconds is the amount that the sample's
    mean differs from the grand mean, it's referred to as the **standard error**.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制在直方图上的正态曲线的标准差大约是3.7秒。换句话说，这量化了每天均值相对于90秒总体均值的变异。我们可以将每天的均值看作是来自总体的样本，而前面提到的曲线表示的是样本均值的分布。因为3.7秒是样本均值与总体均值的差异，所以它被称为**标准误差**。
- en: Standard error
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 标准误差
- en: While the standard deviation measures the amount of variation there is within
    a sample, the standard error measures the amount of variation there is between
    the means of samples taken from the same population.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 标准差衡量样本内部的变异量，而标准误差衡量从同一总体中抽取样本的均值之间的变异量。
- en: Note
  id: totrans-75
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The standard error is the standard deviation of the distribution of the sample
    means.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 标准误差是样本均值分布的标准差。
- en: 'We have calculated the standard error of dwell time empirically by looking
    at the previous 6 months of data. But there is an equation that allows us to calculate
    it from only a single sample:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过查看过去6个月的数据经验性地计算了停留时间的标准误差。但也有一个方程式，允许我们仅通过一个样本来计算它：
- en: '![Standard error](img/7180OS_02_01.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![标准误差](img/7180OS_02_01.jpg)'
- en: 'Here, *σ[x]* is the standard deviation and *n* is the sample size. This is
    unlike the descriptive statistics that we studied in the previous chapter. While
    they described a single sample, the standard error attempts to describe a property
    of samples in general—the amount of variation in the sample means that variations
    can be expected for samples of a given size:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*σ[x]* 是标准差，*n* 是样本大小。这与我们在上一章中学习的描述性统计不同。描述性统计描述的是单个样本，而标准误差试图描述样本的一般特性——即样本均值的变异量，可以预期给定大小的样本会有变异：
- en: '[PRE8]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The standard error of the mean is thus related to two factors:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 均值的标准误差与两个因素有关：
- en: The size of the sample
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 样本大小
- en: The population standard deviation
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 总体标准差
- en: The size of the sample has the largest impact on the standard error. Since we
    take the square root of the sample size, we have to increase the size of the sample
    by four to halve the size of the standard error.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 样本大小对标准误差的影响最大。由于我们需要对样本大小取平方根，因此必须将样本大小增加四倍才能使标准误差减半。
- en: It may seem curious that the proportion of the population sampled has no effect
    on the size of the standard error. This is just as well, since some populations
    could be infinite in size.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 可能会让人感到奇怪的是，总体样本的比例对标准误差的大小没有影响。这其实是好事，因为某些总体的大小可能是无限的。
- en: Samples and populations
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 样本与总体
- en: The words "sample" and "population" mean something very particular to statisticians.
    A population is the entire collection of entities that a researcher wishes to
    understand or draw conclusions about. For example, in the second half of the 19th
    century, Gregor Johann Mendel, the originator of genetics, recorded observations
    about pea plants. Although he was studying specific plants in a laboratory, his
    objective was to understand the underlying mechanisms behind heredity in all possible
    pea plants.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '"样本"和"总体"这两个词对统计学家来说有着非常特殊的含义。总体是研究者希望理解或从中得出结论的所有实体的集合。例如，在19世纪下半叶，遗传学的奠基人格雷戈尔·约翰·孟德尔记录了豌豆植物的观察数据。尽管他是在实验室中研究特定的植物，但他的目标是理解所有可能的豌豆植物中的遗传机制。'
- en: Note
  id: totrans-88
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Statisticians refer to the group of entities from which a sample is drawn as
    the population, whether or not the objects being studied are people.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 统计学家将从中抽取样本的实体群体称为总体，无论被研究的对象是否为人类。
- en: Since populations may be large—or in the case of Mendel's pea plants, infinite—we
    must study representative samples and draw inferences about the population from
    them. To distinguish the measurable attributes of our samples from the inaccessible
    attributes of the population, we use the word *statistics* to refer to the *sample*
    attributes and parameters to refer to the population attributes.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 由于总体可能非常大——或像孟德尔研究的豌豆植物那样是无限的——我们必须研究具有代表性的样本，并从中推断总体。为了区分样本的可测量属性和总体的不可得属性，我们使用"统计量"一词来指代*样本*属性，使用"参数"一词来指代总体属性。
- en: Note
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Statistics are the attributes we can measure from our samples. Parameters are
    the attributes of the population we are trying to infer.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 统计量是我们可以从样本中测量的属性。参数是我们试图推断的总体属性。
- en: 'In fact, statistics and parameters are distinguished through the use of different
    symbols in mathematical formulae:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，统计量和参数通过在数学公式中使用不同的符号来区分：
- en: '| Measure | Sample statistic | Population parameter |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| 测量 | 样本统计量 | 总体参数 |'
- en: '| --- | --- | --- |'
  id: totrans-95
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Number of items | *n* | *N* |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
  zh: '| 项目数量 | *n* | *N* |'
- en: '| Mean | ![Samples and populations](img/7180OS_02_02.jpg) | *µ[x]* |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
  zh: '| 均值 | ![样本与总体](img/7180OS_02_02.jpg) | *µ[x]* |'
- en: '| Standard deviation | *S[x]* | *σ[x]* |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
  zh: '| 标准差 | *S[x]* | *σ[x]* |'
- en: '| Standard error | ![Samples and populations](img/7180OS_02_03.jpg) |   |'
  id: totrans-99
  prefs: []
  type: TYPE_TB
  zh: '| 标准误差 | ![样本与总体](img/7180OS_02_03.jpg) |   |'
- en: Here, ![Samples and populations](img/7180OS_02_02.jpg) is pronounced as "x-bar,"
    *µ[x]* is pronounced as "mu x," and *σ[x]* is pronounced as "sigma x."
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 这里， ![样本与总体](img/7180OS_02_02.jpg) 发音为"x-bar"，*µ[x]* 发音为"mu x"，*σ[x]* 发音为"sigma
    x"。
- en: If you refer back to the equation for the standard error, you'll notice that
    it is calculated from the population standard deviation *σ[x]*, not the sample
    standard deviation *S[x]*. This presents us with a paradox—we can't calculate
    the sample statistic using population parameters when the population parameters
    are precisely the values we are trying to infer. In practice, though, the sample
    and population standard deviations are assumed to be the same above a sample size
    of about 30.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你回顾标准误差的公式，你会注意到它是从总体标准差*σ[x]*而不是样本标准差*S[x]*中计算得出的。这给我们带来了一个悖论——我们无法在总体参数正是我们试图推断的值时，使用总体参数来计算样本统计量。然而，实际上，当样本量大约在30以上时，样本标准差和总体标准差通常假设是相同的。
- en: 'Let''s calculate the standard error from a particular day''s means. For example,
    let''s take a particular day, say May 1:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从某一天的均值来计算标准误差。例如，假设我们选择某一天，比如5月1日：
- en: '[PRE9]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Although we have only taken a sample from one day, the standard error we calculate
    is very close to the standard deviation of all the sample means—3.6 compared to
    3.7s. It's as if, like a cell containing DNA, each sample encodes information
    about the entire population within it.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我们只从一天的数据中抽取了一个样本，但我们计算出的标准误差与所有样本均值的标准差非常接近——3.6与3.7。就像一个包含DNA的细胞一样，每个样本都编码了关于整个总体的信息。
- en: Confidence intervals
  id: totrans-105
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 置信区间
- en: Since the standard error of our sample measures how closely we expect our sample
    mean to match the population mean, we could also consider the inverse—the standard
    error measures how closely we expect the population mean to match our measured
    sample mean. In other words, based on our standard error, we can infer that the
    population mean lies within some expected range of the sample mean with a certain
    degree of confidence.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们的样本的标准误差衡量了我们预期样本均值与总体均值之间的匹配程度，我们也可以考虑其逆向——标准误差衡量了我们预期总体均值与我们测得的样本均值之间的匹配程度。换句话说，基于我们的标准误差，我们可以推断总体均值在某个预期的样本均值范围内，并且具有一定的置信度。
- en: Taken together, the "degree of confidence" and the "expected range" define a
    **confidence interval**. While stating confidence intervals, it is fairly standard
    to state the 95 percent interval—we are 95 percent sure that the population parameter
    lies within the interval. Of course, there remains a 5 percent possibility that
    it does not.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 总的来说，“置信度”和“预期范围”共同定义了**置信区间**。在陈述置信区间时，通常会陈述 95% 置信区间——我们有 95% 的信心认为总体参数位于该区间内。当然，仍然有
    5% 的可能性它不在其中。
- en: '![Confidence intervals](img/7180OS_02_150.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![Confidence intervals](img/7180OS_02_150.jpg)'
- en: Whatever the standard error, 95 percent of the population mean will lie between
    -1.96 and 1.96 standard deviations of the sample mean. 1.96 is therefore the *critical
    z-value* for a 95 percent confidence interval.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 无论标准误差是多少，95% 的总体均值将位于样本均值的 -1.96 和 1.96 个标准差之间。因此，1.96 是 95% 置信区间的*临界 z 值*。
- en: Note
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The name *z*-value comes from the fact that the normal distribution is also
    called the *z*-distribution.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '*z*-值这个名字来源于正态分布也被称为*z*-分布的事实。'
- en: 'The number 1.96 is so commonly used that it''s a number worth remembering,
    but we can also calculate the critical value using the `s/quantile-normal` function.
    Our `confidence-interval` function that follows expects a value for `p` between
    zero and one. This will be 0.95 for our 95 percent confidence interval. We need
    to subtract it from one and divide it by two to calculate the site of each of
    the two tails (2.5 percent for the 95 percent confidence interval):'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 数字 1.96 使用得非常广泛，是一个值得记住的数字，但我们也可以使用 `s/quantile-normal` 函数来计算临界值。我们接下来的 `confidence-interval`
    函数期望输入一个在零到一之间的 `p` 值。对于我们的 95% 置信区间，这个值为 0.95。我们需要从 1 中减去它并除以 2，以计算两个尾部的大小（95%
    置信区间的 2.5%）：
- en: '[PRE10]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The result tells us that we can be 95 percent confident that the population
    mean lies between 83.53 and 97.75 seconds. Indeed, the population mean we calculated
    previously lies well within this range.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 结果告诉我们，我们可以有 95% 的信心认为总体均值位于 83.53 秒到 97.75 秒之间。事实上，我们之前计算的总体均值正好位于这个范围之内。
- en: Sample comparisons
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 样本比较
- en: After a viral marketing campaign, the web team at AcmeContent take a sample
    of dwell times for us to analyze from a single day. They'd like to know whether
    their latest campaign has brought more engaged visitors to the site. Confidence
    intervals provide us with an intuitive way to compare the two samples.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在一次病毒式营销活动之后，AcmeContent 的网络团队从单一天的数据中为我们提供了一个停留时间的样本以供分析。他们想知道他们最新的营销活动是否吸引了更多互动的访客。置信区间为我们提供了一种直观的方式来比较这两个样本。
- en: 'We load the dwell times from the campaign as we did earlier and summarize them
    in the same way:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们像之前一样加载来自活动的停留时间，并以相同的方式对其进行总结：
- en: '[PRE11]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The mean seems to be much larger than the means we have been looking at previously—130s
    compared to 90s. It could be that there is some significant difference here, although
    the standard error is over twice the size of our previous one day sample, owing
    to a smaller sample size and larger standard deviation. We can calculate the 95
    percent confidence interval for the population mean based on this data using the
    same `confidence-interval` function like before:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 这个均值似乎比我们之前看到的均值要大得多——130 秒对比 90 秒。这里可能存在显著差异，尽管标准误差是我们之前一天样本的两倍多，这是由于样本量较小且标准差较大。我们可以使用和之前相同的
    `confidence-interval` 函数基于这些数据计算总体均值的 95% 置信区间：
- en: '[PRE12]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The 95 percent confidence interval for the population mean is 114.8s to 145.6s.
    This doesn't overlap with the 90s population mean we calculated previously at
    all. There appears to be a large underlying population difference that is unlikely
    to have occurred just through a sampling error alone. Our task now is to find
    out why.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 总体均值的95%置信区间是114.8秒到145.6秒。这与我们之前计算的90年代的总体均值完全不重合。看起来存在一个很大的基础群体差异，单纯通过抽样误差是不太可能产生的。现在我们的任务是找出原因。
- en: Bias
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 偏差
- en: A sample should be representative of the population from which it is drawn.
    In other words, it should avoid bias that would result in certain kinds of population
    members being systematically excluded (or included) over others.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 样本应当能够代表其所抽取的总体。换句话说，它应当避免产生偏差，使得某些种类的群体成员在系统性地被排除（或包含）时，相较于其他群体而言，受到不公正的影响。
- en: A famous example of sample bias is the 1936 Literary Digest poll for the US
    Presidential Election. It was one of the largest and most expensive polls ever
    conducted with 2.4 million people being surveyed by mail. The results were decisive—Republican
    governor of Kansas Alfred Landon would defeat Franklin D. Roosevelt, taking 57
    percent of the vote. In the event, Roosevelt won the election with 62 percent
    of the vote.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 一个著名的样本偏差例子是1936年《文学文摘》对美国总统选举的民调。这是历史上最大、最昂贵的民调之一，共有240万人通过邮件接受调查。结果非常明确——堪萨斯州的共和党州长阿尔弗雷德·兰登将击败富兰克林·D·罗斯福，获得57%的选票。然而，最终罗斯福以62%的选票赢得了选举。
- en: The primary cause of the magazine's huge sampling error was sample selection
    bias. In their attempt to gather as many voter addresses as possible, the Literary
    Digest scoured telephone directories, magazine subscription lists, and club membership
    lists. In an era when telephones were more of a luxury item, this process was
    guaranteed to be biased in favor of upper- and middle-class voters and was not
    representative of the electorate as a whole. A secondary cause of bias was **nonresponse
    bias**—less than a quarter of those who were approached actually responded to
    the survey. This is a kind of selection bias that favors only those respondents
    who actually wish to participate.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 该杂志巨大的抽样误差的主要原因是样本选择偏差。在试图收集尽可能多的选民地址时，《文学文摘》翻阅了电话簿、杂志订阅名单和俱乐部会员名单。在那个电话是奢侈品的时代，这一过程必然会偏向上层和中产阶级选民，无法代表整个选民群体。偏差的次要原因是**无应答偏差**——不到四分之一的受访者回应了调查。这是一种选择偏差，只偏向那些真正愿意参与的受访者。
- en: A common way to avoid sample selection bias is to ensure that the sampling is
    randomized in some way. Introducing chance into the process makes it less likely
    that experimental factors will unfairly influence the quality of the sample. The
    Literary Digest poll was focused on getting the largest sample possible, but an
    unbiased small sample is much more useful than a badly chosen large sample.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 避免样本选择偏差的常见方法是确保采样在某种程度上是随机的。将随机性引入过程可以减少实验因素不公平地影响样本质量的可能性。《文学文摘》民调的重点是尽可能获得最大的样本，但一个无偏的小样本比一个错误选择的大样本更有用。
- en: 'If we open up the `campaign-sample.tsv` file, we''ll discover that our sample
    has come exclusively from June 6, 2015\. This was a weekend, a fact we can easily
    confirm with `clj-time`:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们打开`campaign-sample.tsv`文件，我们会发现我们的样本完全来自2015年6月6日。这一天是周末，我们可以通过`clj-time`轻松确认这一点：
- en: '[PRE13]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Our summary statistics so far have all been based on the data we filtered just
    to include weekdays. This is a bias in our sample, and if the weekend visitor
    behavior turns out to be different from the weekday behavior—a very likely scenario—then
    we would say that the samples represent two different populations.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们的汇总统计数据都是基于我们只筛选了工作日数据的结果。这是样本中的一种偏差，如果周末的访问者行为与工作日的行为有所不同——这是一种非常可能的情况——那么我们可以说，这些样本代表了两个不同的群体。
- en: Visualizing different populations
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可视化不同群体
- en: 'Let''s remove the filter for weekdays and plot the daily mean dwell time for
    both week days and weekends:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们去掉工作日的筛选条件，绘制工作日和周末的日均停留时间：
- en: '[PRE14]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The code generates the following histogram:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 代码生成了以下直方图：
- en: '![Visualizing different populations](img/7180OS_02_160.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![可视化不同群体](img/7180OS_02_160.jpg)'
- en: The distribution is no longer a normal distribution. In fact, the distribution
    is **bimodal**—there are two peaks. The second smaller peak, which corresponds
    to the newly added weekend data, is lower both because there are not as many weekend
    days as weekdays and because the distribution has a larger standard error.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 这时的分布不再是正态分布。事实上，分布是**双峰分布**——有两个峰值。第二个较小的峰值，代表新加入的周末数据，相对较低，这既是因为周末天数少于工作日，也因为分布的标准误差较大。
- en: Note
  id: totrans-136
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: In general, distributions with more than one peak are referred to as **multimodal**.
    They can be an indicator that two or more normal distributions have been combined,
    and therefore, that two or more populations may have been combined. A classic
    example of bimodality is the distribution of people's heights, since the modal
    height for men is larger than that for women.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，具有多个峰值的分布称为**多峰分布**。它们可能表示两个或更多的正态分布被合并，因此，可能表示两个或更多的人群被合并。一个经典的双峰分布的例子是人的身高分布，因为男性的常见身高大于女性的常见身高。
- en: 'The weekend data has different characteristics than the weekday data. We should
    make sure that we''re comparing like with like. Let''s filter our original dataset
    just to weekends:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 周末数据与工作日数据具有不同的特征。我们应确保在比较时是“对比相同的事物”。让我们将原始数据集过滤，仅保留周末数据：
- en: '[PRE15]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The grand mean value at weekends (based on 6 months of data) is 117.8s, which
    falls within the 95 percent confidence interval of the marketing sample. In other
    words, although 130s is a high mean dwell time, even for a weekend, the difference
    is not so big that it couldn't simply be attributed to chance variation within
    the sample.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 周末的总体均值（基于6个月的数据）为117.8秒，落在市场样本的95%置信区间内。换句话说，虽然130秒是较高的均值，甚至对于周末来说，但这一差异并不大到无法仅归因于样本内的随机波动。
- en: The approach we have just taken to establish a genuine difference in populations
    (between the visitors to our site on weekends compared to the visitors during
    the week) is not the way statistical testing would conventionally proceed. A more
    usual approach is to begin with a theory, and then to test that theory against
    the data. The statistical method defines a rigorous approach for this called **hypothesis
    testing**.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚才采取的建立人群差异（即周末访问者与工作日访问者之间的差异）的方法，并不是统计检验常规的做法。更常见的方法是从一个理论开始，然后用数据检验这个理论。统计方法为此定义了一种严格的流程，称为**假设检验**。
- en: Hypothesis testing
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 假设检验
- en: Hypothesis testing is a formal process for statisticians and data scientists.
    The standard approach to hypothesis testing is to define an area of research,
    decide which variables are necessary to measure what is being studied, and then
    to set out two competing hypotheses. In order to avoid only looking at the data
    that confirms our biases, researchers will state their hypothesis clearly ahead
    of time. Statistics can then be used to confirm or refute this hypothesis, based
    on the data.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 假设检验是统计学家和数据科学家的正式过程。假设检验的标准方法是定义一个研究领域，决定哪些变量是必要的以测量所研究的内容，然后提出两个竞争的假设。为了避免只看符合我们偏见的数据，研究人员会事先明确陈述他们的假设。然后，统计数据可以用来根据数据确认或否定这个假设。
- en: In order to help retain our visitors, designers go to work on a variation of
    our home page that uses all the latest techniques to keep the attention of our
    audience. We'd like to be sure that our effort isn't in vain, so we will look
    for an increase in dwell time on the new site.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助留住我们的访客，设计师开始修改主页，采用所有最新的技术来吸引观众的注意力。我们希望确保我们的努力不会白费，因此我们将关注新网站上的停留时间是否有所增加。
- en: Therefore, our research question is "does the new site cause the visitor's dwell
    time to increase"? We decide that this should be tested with reference to the
    mean dwell time. Now, we need to set out our two hypotheses. By convention, the
    data is assumed not to contain what the researcher is looking for. The conservative
    opinion is that the data would not show anything unusual. This is called the **null
    hypothesis** and is normally denoted *H[0]*.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们的研究问题是“新网站是否导致访客的停留时间增加”？我们决定用均值停留时间来进行检验。现在，我们需要列出两个假设。按惯例，数据被假设不包含研究者所寻找的内容。保守的观点是，数据不会显示任何异常。这就是**零假设**，通常用*H[0]*表示。
- en: Note
  id: totrans-146
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Hypothesis testing assumes that the null hypothesis is true until the weight
    of the evidence makes this proposition unlikely. This "back to front" way of looking
    for proof is driven partly by the simple psychological fact that when people go
    looking for something, they tend to find it.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 假设检验假定原假设为真，直到证据的权重使得这个假设变得不太可能。这种“倒过来看”证据的方法部分是由一个简单的心理事实驱动的：当人们去寻找某样东西时，他们倾向于找到它。
- en: 'The researcher then forms an alternate hypothesis, denoted by *H[1]*. This
    could simply be that the population mean is different from the baseline. Or, it
    could be that the population mean is greater or lesser than the baseline, or even
    greater or lesser by some specified value. We''d like to test whether the new
    site increases dwell time, so these will be our null and alternate hypotheses:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 研究者随后形成一个备择假设，表示为*H[1]*。这可能仅仅意味着总体均值与基准值不同。或者，它可能意味着总体均值大于或小于基准值，甚至可能大于或小于某个特定值。我们希望测试新网站是否能增加停留时间，因此这些将是我们的原假设和备择假设：
- en: '*H[0]*: The dwell time for the new site is no different than the dwell time
    of the existing site'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*H[0]*：新网站的停留时间与现有网站的停留时间没有区别。'
- en: '*H[1]*: The dwell time is greater for the new site compared to the existing
    site'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*H[1]*：新网站的停留时间相比于现有网站更长。'
- en: Our conservative assumption is that the new site has no effect on the dwell
    time of users. The null hypothesis doesn't have to be nil hypothesis (that there
    is no effect), but in this case, we have no reasonable justification to assume
    otherwise. If the sample data does not support the null hypothesis (if the data
    differs from its prediction by a margin too large to be by chance alone), then
    we will reject the null hypothesis and propose the alternative hypothesis as the
    best alternative explanation.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的保守假设是新网站对用户停留时间没有影响。原假设不一定是“无效假设”（即没有效应），但在这种情况下，我们没有合理的理由假设它有所不同。如果样本数据不支持原假设（如果数据与其预测的差异过大，不可能仅由偶然造成），我们将拒绝原假设，并提出备择假设作为最好的替代解释。
- en: Having set out the null and alternative hypotheses, we must set a significance
    level at which we are looking for an effect.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在设定原假设和备择假设后，我们必须设定一个显著性水平，用来衡量我们是否在寻找某种效应。
- en: Significance
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 显著性
- en: Significance testing was originally developed independent of hypothesis testing,
    but the two approaches are now very often used in concert together. The purpose
    of significance testing is to set the threshold beyond which we determine that
    the observed data no longer supports the null hypothesis.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 显著性检验最初是独立于假设检验开发的，但如今这两种方法常常一起使用。显著性检验的目的是设定一个阈值，超过该阈值我们认为观察到的数据不再支持原假设。
- en: 'There are therefore two risks:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，存在两个风险：
- en: We may accept a difference as significant when in fact, it arose by chance
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可能会接受一个差异是显著的，而实际上它可能是偶然产生的。
- en: We may attribute a difference to chance when, in fact, it indicates a true population
    difference
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可能会将一个差异归因于偶然，而实际上它代表了一个真正的总体差异。
- en: 'These two possibilities are respectively referred to as Type I and Type II
    errors:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 这两种可能性分别被称为第一类错误和第二类错误：
- en: '|   | *H[0]* false | *H[0]* true |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '|   | *H[0]* 错误 | *H[0]* 正确 |'
- en: '| --- | --- | --- |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| **Reject H[0]** | True negative | Type I error |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| **拒绝 H[0]** | 真阴性 | 第一类错误 |'
- en: '| **Accept** *H[0]* | Type II error | True positive |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| **接受** *H[0]* | 第二类错误 | 真阳性 |'
- en: The more we reduce our risk of making Type I errors, the more we increase our
    risk of making Type II errors. In other words, the more confident we wish to be
    to not claim a real difference when there is none, the bigger the difference we'll
    demand between our samples to claim statistical significance. This increases the
    probability that we'll disregard a genuine difference when we encounter it.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们减少第一类错误的风险时，第二类错误的风险就会增加。换句话说，我们希望避免在没有真实差异时错误地认为有差异，因此我们要求样本之间有更大的差异才能宣称统计显著性。这增加了我们忽略真正差异的可能性。
- en: Two significance thresholds are commonly used by statisticians. These are the
    5 percent and 1 percent levels. A difference at 5 percent is commonly called *significant*
    and at 1 percent is called *highly significant*. The choice of threshold is often
    referred to in formulae by the Greek letter alpha, *α*. Since finding no effect
    might be regarded as a failure (either of the experiment or of the new site),
    we might be tempted to adjust *α* until we find an effect. Because of this, the
    textbook approach to significance testing requires us to set a significance level
    before we look at our data. A level of 5 percent is often chosen, so let's go
    with it.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 统计学家常用两个显著性阈值。这些分别是5%的显著性水平和1%的显著性水平。5%的差异通常被称为*显著*，而1%的差异被称为*高度显著*。阈值的选择通常用希腊字母α（*α*）在公式中表示。由于找不到效果可能被认为是失败（无论是实验失败还是新网站失败），我们可能会倾向于调整*α*，直到我们发现效果为止。因此，教科书中的显著性检验方法要求我们在查看数据之前就设定显著性水平。5%的水平通常是默认选择的，所以我们也选择这个水平。
- en: Testing a new site design
  id: totrans-165
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 测试新网站设计
- en: The web team at AcmeContent have been hard at work, developing a new site to
    encourage visitors to stick around for an extended period of time. They've used
    all the latest techniques and, as a result, we're pretty confident that the site
    will show a marked improvement in dwell time.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: AcmeContent的网络团队一直在努力开发一个新的网站，目的是鼓励访客停留更长时间。他们采用了所有最新的技术，因此我们非常有信心这个网站能够显著提高停留时间。
- en: Rather than launching it to all users at once, AcmeContent would like to test
    the site on a small sample of visitors first. We've educated them about sample
    bias, and as a result, the web team diverts a random 5 percent of the site traffic
    to the new site for one day. The result is provided to us as a single text file
    containing all the day's traffic. Each row shows the dwell time for a visitor
    who is given a value of either "0" if they used the original site design, or "1"
    if they saw the new (and hopefully improved) site.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: AcmeContent并不打算一次性将其推出给所有用户，而是希望先在一小部分访客中进行测试。我们已经向他们讲解了样本偏差，因此网络团队将网站流量的5%随机导向新网站，持续一天。结果以单个文本文件的形式提供给我们，文件中包含当天所有的流量数据。每行显示的是一个访客的停留时间，并给出一个值，"0"表示他们使用了原始网站设计，"1"表示他们看到了新的（并且希望能改进的）网站。
- en: Performing a z-test
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进行z检验
- en: While testing with the confidence intervals previously, we had a single population
    mean to compare to.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前使用置信区间进行测试时，我们有一个单一的总体均值来进行比较。
- en: With *z*-testing, we have the option of comparing two samples. The people who
    saw the new site were randomized, and the data for both groups was collected on
    the same day to rule out other time-dependent factors.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 通过*z*检验，我们可以选择比较两个样本。观看新网站的人是随机分配的，且两个组的数据是在同一天收集的，以排除其他时间相关因素的干扰。
- en: 'Since we have two samples, we also have two standard errors. The *z*-test is
    performed against the pooled standard error, which is simply the square root of
    the sum of the variances divided by the sample sizes. This is the same as the
    result we would get if we took the standard error of the samples combined:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们有两个样本，因此我们也有两个标准误差。z检验是基于合并标准误差进行的，合并标准误差只是将方差的和除以样本大小后再开方。这与我们将样本合并后的标准误差相同：
- en: '![Performing a z-test](img/7180OS_02_04.jpg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![进行z检验](img/7180OS_02_04.jpg)'
- en: 'Here, ![Performing a z-test](img/7180OS_02_05.jpg) is the variance of sample
    *a* and ![Performing a z-test](img/7180OS_02_06.jpg) is the variance of sample
    *b*. *n[a]* and *n[b]* are the sample sizes of *a* and *b*, respectively. The
    pooled standard error can be calculated in Clojure like this:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，![进行z检验](img/7180OS_02_05.jpg)是样本*a*的方差，![进行z检验](img/7180OS_02_06.jpg)是样本*b*的方差。*n[a]*和*n[b]*分别是样本*a*和*b*的样本大小。合并标准误差可以像这样在Clojure中计算：
- en: '[PRE16]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'To determine if the difference we''re seeing is unexpectedly large, we can
    take the ratio of the observed difference between the means over the pooled standard
    error. This quantity is given the variable name *z*:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确定我们所看到的差异是否异常大，我们可以计算观测到的均值差异与合并标准误差的比值。这个值被赋予变量名*z*：
- en: '![Performing a z-test](img/7180OS_02_07.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![进行z检验](img/7180OS_02_07.jpg)'
- en: 'Using our `pooled-standard-error` function, the *z*-statistic can be calculated
    like this:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 使用我们的`pooled-standard-error`函数，可以像这样计算*z*统计量：
- en: '[PRE17]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The ratio *z* captures how much the means differ relative to the amount we
    would expect given the standard error. The *z*-statistic therefore tells us how
    many standard errors apart the means are. Since the standard error has a normal
    probability distribution, we can associate this difference with a probability
    by looking up the *z*-statistic in the normal CDF:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '*z*比率反映了均值相差的大小，相对于标准误差的期望量。因此，*z*-统计量告诉我们均值之间相差多少个标准误差。由于标准误差服从正态分布，我们可以通过查找标准正态累积分布（CDF）来将这个差异与概率关联起来：'
- en: '[PRE18]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The following example uses the *z*-test to compare the performance of the two
    sites. We do this by grouping the rows by site, returning a map that indexes the
    site to the collection of rows for the site. We call `map-vals` with `(partial
    map :dwell-time)` to convert the collection of rows into a collection of dwell
    times. `map-vals` is a function defined in Medley ([https://github.com/weavejester/medley](https://github.com/weavejester/medley)),
    a library of lightweight utility functions:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示例使用*z*-检验来比较两个网站的性能。我们通过按网站分组行，将网站索引到网站行集合的映射。我们调用`map-vals`与`(partial map
    :dwell-time)`一起，将行集合转换为停留时间集合。`map-vals`是Medley（[https://github.com/weavejester/medley](https://github.com/weavejester/medley)）库中定义的一个轻量级工具函数：
- en: '[PRE19]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Setting a significance level of 5 percent is much like setting a confidence
    interval of 95 percent. In essence, we're looking to see if the observed difference
    falls outside the 95 percent confidence interval. If it does, we can claim to
    have found a result that's significant at the 5 percent level.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 设置5%的显著性水平就像设置95%的置信区间本质上是一样的。实质上，我们在查看观察到的差异是否落在95%的置信区间之外。如果是这样，我们可以声称找到了一个在5%的显著性水平上显著的结果。
- en: Note
  id: totrans-184
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The *p*-value is the probability of making a Type I error by wrongly rejecting
    the null hypothesis if it is, in fact, true. The smaller the *p*-value, the more
    certainty we have that the null hypothesis is false, and that we have found a
    genuine effect.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '*p*-值是指在原假设真实的情况下，错误地拒绝原假设的概率。*p*-值越小，我们越能确信原假设是错误的，并且我们发现了一个真正的效应。'
- en: This code returns a value of 0.0498, equating to 4.98 percent. As it is just
    less than our significance threshold of 5 percent, we can claim to have found
    something significant.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码返回的值为0.0498，等于4.98%。因为这个值略低于我们的显著性阈值5%，所以我们可以声称我们发现了显著的结果。
- en: 'Let''s remind ourselves of the null and alternative hypotheses:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾一下原假设和备择假设：
- en: '*H[0]*: The dwell time for the new site is no different from the dwell time
    of the existing site'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*H[0]*: 新网站的停留时间与现有网站的停留时间没有差异。'
- en: '*H[1]*: The dwell time is greater for the new site compared to the existing
    site'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*H[1]*: 新网站的停留时间比现有网站的停留时间更长。'
- en: Our alternate hypothesis is that the dwell time is greater for the new site.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的备择假设是新网站的停留时间更长。
- en: We are ready to claim statistical significance, and that the dwell time is greater
    for the new site compared to the existing site, but we have a problem—with a smaller
    sample, there is an increased uncertainty that the sample standard deviation matches
    the population standard deviation. Our new site sample has only 16 visitors, as
    shown in the output of the previous example. Samples as small as this invalidate
    the assumption that the standard error is normally distributed.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 我们准备声称统计显著性，并且新网站的停留时间比现有网站的停留时间更长，但我们遇到一个问题——样本量较小时，样本标准差与总体标准差匹配的不确定性增加。我们的新网站样本只有16位访问者，如前面例子中的输出所示。像这样的样本量会使得标准误差服从正态分布的假设无效。
- en: Fortunately, there is a statistical test and an associated distribution which
    models the increased uncertainty of standard errors for smaller sample sizes.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，有一种统计检验和相应的分布可以模型化样本量较小时标准误差的不确定性增大。
- en: Student's t-distribution
  id: totrans-193
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 斯图登特的t分布
- en: The *t*-distribution was popularized by William Sealy Gossett, a chemist working
    for the Guinness Brewery in Ireland, who incorporated it into his analysis of
    Stout.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '*t*-分布由威廉·西利·戈塞特（William Sealy Gossett）推广，他是爱尔兰吉尼斯啤酒厂的化学家，他将其应用于他的Stout分析中。'
- en: Note
  id: totrans-195
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: William Gosset published the test in Biometrika in 1908, but was forced to use
    a pen name by his employer, who regarded the fact that they were using statistics
    as a trade secret. The pen name he chose was "Student".
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 威廉·戈塞特在1908年在《Biometrika》上发表了这个检验，但由于他的雇主认为他们使用统计学是商业机密，戈塞特被迫使用笔名。他选择的笔名是“学生（Student）”。
- en: While the normal distribution is completely described by two parameters—the
    mean and standard deviation, the *t*-distribution is described by only one parameter
    called the **degrees of freedom**. The larger the degrees of freedom, the closer
    the *t*-distribution resembles the normal distribution with a mean of zero and
    a standard deviation of one. As the degrees of freedom decreases, the distribution
    becomes wider with tails that are fatter than the normal distribution.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然正态分布完全由两个参数——均值和标准差描述，但*t*分布只由一个参数描述，即**自由度**。自由度越大，*t*分布越接近均值为零、标准差为一的正态分布。当自由度减小时，分布变得更宽，尾部比正态分布更胖。
- en: '![Student''s t-distribution](img/7180OS_02_170.jpg)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![学生的t分布](img/7180OS_02_170.jpg)'
- en: The earlier chart shows how the *t*-distribution varies with respect to the
    normal distribution for different degrees of freedom. Fatter tails for smaller
    sample sizes correspond to an increased chance of observing larger deviations
    from the mean.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的图表显示了*t*分布相对于正态分布在不同自由度下的变化。较小样本量对应着更胖的尾部，这意味着观察到大偏差的概率更高。
- en: Degrees of freedom
  id: totrans-200
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 自由度
- en: The degrees of freedom, often abbreviated to *df*, is closely related to the
    sample size. It is a useful statistic and an intuitive property of the series
    that can be demonstrated simply by example.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 自由度，通常缩写为*df*，与样本大小密切相关。它是一个有用的统计量，也是一个直观的系列属性，可以通过简单的例子进行演示。
- en: If you were told that the mean of two values is 10 and that one of the values
    is 8, you would not need any additional information to be able to infer that the
    other value is 12\. In other words, for a sample size of two and a given mean,
    one of the values is constrained if the other is known.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你被告知两个值的均值为10且其中一个值为8，你不需要任何额外的信息就能推断出另一个值是12。换句话说，对于样本量为2且均值已知的情况，一旦知道其中一个值，另一个值就有约束。
- en: If instead you're told that the mean of three values is 10 and the first value
    is also 10, you would not be able to deduce what the remaining two values are.
    Since there are an infinite number of sets of three numbers beginning with 10
    whose mean is 10, the second value must also be specified before you can infer
    the value of the third.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你被告知三个值的均值为10且第一个值也是10，你就无法推断出剩余两个值是什么。因为有无限多个以10为起始值且均值为10的三个数字集合，在你能推断出第三个值之前，必须先指定第二个值。
- en: 'For any set of three numbers, the constraint is simple: you can freely pick
    the first two numbers, but the final number is constrained. The degrees of freedom
    can thus be generalized in the following way: for any single sample, the degrees
    of freedom is one less than the sample size.'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 对于任何三个数字的集合，约束是简单的：你可以自由选择前两个数字，但最后一个数字是有约束的。自由度可以通过以下方式概括：对于任何单一样本，自由度为样本大小减一。
- en: When comparing two samples of data, the degrees of freedom is two less than
    the sum of the sample sizes, which is the same as the sum of their individual
    degrees of freedom.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 在比较两个数据样本时，自由度是样本大小总和减去2，即等于它们各自自由度的总和。
- en: The t-statistic
  id: totrans-206
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: t统计量
- en: 'While using the *t*-distribution, we look up the *t*-statistic. Like the *z*-statistic,
    this value quantifies how unlikely a particular observed deviation is. For a dual
    sample *t*-test, the *t*-statistic is calculated in the following way:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用*t*分布时，我们查找*t*统计量。与*z*统计量类似，该值量化了某一特定观察偏差的不太可能性。对于双样本*t*检验，t统计量的计算方式如下：
- en: '![The t-statistic](img/7180OS_02_08.jpg)'
  id: totrans-208
  prefs: []
  type: TYPE_IMG
  zh: '![t统计量](img/7180OS_02_08.jpg)'
- en: 'Here, ![The t-statistic](img/7180OS_02_09.jpg) is the pooled standard error.
    We could calculate the pooled standard error in the same way as we did earlier:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![t统计量](img/7180OS_02_09.jpg)是合并标准误差。我们可以像之前一样计算合并标准误差：
- en: '![The t-statistic](img/7180OS_02_10.jpg)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![t统计量](img/7180OS_02_10.jpg)'
- en: However, the equation assumes knowledge of the population parameters *σ[a]*
    and *σ[b]*, which can only be approximated from large samples. The *t*-test is
    designed for small samples and does not require us to make assumptions about population
    variance.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，该方程假设已知总体参数*σ[a]*和*σ[b]*，这些只能通过大样本来近似。*t*检验是为小样本设计的，因此不需要我们对总体方差做出假设。
- en: 'As a result, for the *t*-test, we write the pooled standard error as the square
    root of the sum of the standard errors:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，对于*t*检验，我们将合并的标准误差写为标准误差的平方和的平方根：
- en: '![The t-statistic](img/7180OS_02_11.jpg)'
  id: totrans-213
  prefs: []
  type: TYPE_IMG
  zh: '![t统计量](img/7180OS_02_11.jpg)'
- en: 'In practice, the earlier two equations for the pooled standard error yield
    identical results, given the same input sequences. The difference in notation
    just serves to illustrate that with the *t*-test, we depend only on sample statistics
    as input. The pooled standard error ![The t-statistic](img/7180OS_02_09.jpg) can
    be calculated in the following way:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，前面提到的两条关于合并标准误差的公式在给定相同输入数据的情况下会得到相同的结果。符号的不同仅仅是为了说明在*t*检验中，我们只依赖样本统计量作为输入。合并标准误差![t-统计量](img/7180OS_02_09.jpg)可以通过以下方式计算：
- en: '[PRE20]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Although they are represented differently in mathematical notation, in practice,
    the calculation of *t*-statistic is identical to *z*-statistic:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管在数学符号上有所不同，但实际上，计算*t*-统计量与计算*z*-统计量是相同的：
- en: '[PRE21]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: The difference between the two statistics is conceptual rather than algorithmic—the
    *z*-statistic is only applicable when the samples follow a normal distribution.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 这两种统计量之间的差异是概念性的，而非算法性的——*z*-统计量仅适用于样本遵循正态分布的情况。
- en: Performing the t-test
  id: totrans-219
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行t检验
- en: 'The difference in the way *t*-test works stems from the probability distribution
    from which our *p*-value is calculated. Having calculated our *t*-statistic, we
    need to look up the value in the *t*-distribution parameterized by the degrees
    of freedom of our data:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '*t*-检验的工作方式的不同，源自用于计算*p*值的概率分布。计算了我们的*t*-统计量后，我们需要根据数据的自由度查找*t*-分布中的值：'
- en: '[PRE22]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: The degrees of freedom are two less than the sizes of the samples combined,
    which is 298 for our samples.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 自由度是样本总量减去二，即我们样本的自由度是298。
- en: '![Performing the t-test](img/7180OS_02_180.jpg)'
  id: totrans-223
  prefs: []
  type: TYPE_IMG
  zh: '![执行t检验](img/7180OS_02_180.jpg)'
- en: 'Recall that we are performing a hypothesis test. So, let''s state our null
    and alternate hypotheses:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 回想一下，我们正在进行假设检验。因此，首先让我们陈述零假设和备择假设：
- en: '*H[0]*: This sample is drawn from a population with a supplied mean'
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*H[0]*：此样本来自具有给定均值的总体'
- en: '*H[1]*: This sample is drawn from a population with a greater mean'
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*H[1]*：此样本来自具有更大均值的总体'
- en: 'Let''s run the example:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们运行这个示例：
- en: '[PRE23]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: This returns a *p*-value of over 0.05\. Since this is greater than the *α* of
    5% we set for our hypothesis test, we are not able to reject the null hypothesis.
    Our test for the difference between the means has not discovered a significant
    difference using the *t*-test. Our barely significant result of the *z*-test was
    therefore partly due to it having such a small sample.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 这返回一个超过0.05的*p*值。由于这个值大于我们为假设检验设置的5% *α*，我们无法拒绝零假设。我们对于均值差异的检验没有通过*t*检验发现显著差异。因此，*z*-检验所得到的微弱显著结果部分是由于样本量太小。
- en: Two-tailed tests
  id: totrans-230
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 双尾检验
- en: There has been an implicit assumption in our alternate hypothesis that the new
    site would perform better than the previous site. The process of hypothesis testing
    goes to great lengths to ensure that we don't encode hidden assumptions while
    looking for statistical significance.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的备择假设中，隐含假设新站点的表现会优于旧站点。假设检验的过程会尽可能避免在寻找统计显著性时暗中引入隐性假设。
- en: Tests where we look only for a significant increase or decrease in quantity
    are called **one-tailed tests** and are generally frowned upon, except in the
    case where a change in the opposite direction would be impossible. The name comes
    from the fact that a one-tailed test allocates all of the *α* to a single tail
    of the distribution. By not testing in the other direction, the test has more
    power to reject the null hypothesis in a particular direction and, in essence,
    lowers the threshold by which we would judge a result as significant.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 只关注数量显著增加或减少的检验被称为**单尾检验**，通常是不被推荐的，除非发生相反方向的变化是不可行的。这个名字来源于单尾检验将所有的*α*分配到分布的一个尾部。通过不检验另一方向，该检验可以更有力地拒绝零假设，并在本质上降低判断结果显著性的门槛。
- en: Note
  id: totrans-233
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Statistical power is the probability of correctly accepting the alternative
    hypothesis. This can be thought of as the ability of the test to detect an effect,
    where there is an effect to be detected.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 统计功效是正确接受备择假设的概率。这可以被认为是检验发现效应的能力，在效应存在的情况下。
- en: While higher statistical power sounds desirable, it comes at the cost of there
    being a greater probability of making a Type I error. A more correct approach
    would be to entertain the possibility that the new site could realistically be
    worse than the existing site. This allocates our *α* equally to both tails of
    the distribution and ensures a significant outcome that is not biased by a prior
    assumption of improvement.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管更高的统计功效听起来是理想的，但它也意味着发生第一类错误的概率更大。一个更正确的方法是考虑新站点可能比现有站点差的可能性。这将我们的*α*值平分到分布的两个尾部，并确保结果的显著性不受先前假设改进的偏倚。
- en: '![Two-tailed tests](img/7180OS_02_190.jpg)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![双尾检验](img/7180OS_02_190.jpg)'
- en: In fact, Incanter already provides functions to perform two-sample *t*-tests
    with the `s/t-test` function. We provide a sample of data as the first argument
    and a sample to compare against with the `:y` keyword argument. Incanter will
    assume that we want to perform a two-tailed test, unless we pass the `:alternative`
    keyword with a value of `:greater` or `:lower`, in which case a one-tailed test
    will be performed.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，Incanter已经提供了执行双样本*t*检验的函数，即`s/t-test`函数。我们将数据样本作为第一个参数传递，另一个样本则通过`:y`关键字传递给函数进行比较。Incanter会假设我们要进行双尾检验，除非我们传递`:alternative`关键字并指定`：greater`或`：lower`，此时将进行单尾检验。
- en: '[PRE24]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Incanter's *t*-test returns a lot of information, including the *p*-value. The
    *p*-value is around twice what we calculated for the one-tailed test. In fact,
    the only reason it's not exactly double is because Incanter implements a slight
    variant of the *t*-test called **Welch's t-test**, which is slightly more robust
    when two samples have different standard deviations. Since we know that, for exponential
    distributions, the mean and the variance are intimately related, the test is slightly
    more rigorous to apply and returns an even lower significance.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: Incanter的*t*检验返回了大量信息，包括*p*-值。这个*p*-值大约是我们为单尾检验计算值的两倍。事实上，它不是恰好是两倍，唯一的原因是Incanter实现了一种稍有变异的*t*检验，叫做**Welch's
    t-test**，当两个样本的标准差不同时，这种检验略微更强健。由于我们知道对于指数分布，均值和方差是密切相关的，因此这个检验应用起来稍微严格一些，并返回一个更低的显著性水平。
- en: One-sample t-test
  id: totrans-240
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 单样本t检验
- en: Independent samples of *t*-tests are the most common sort of statistical analysis,
    which provide a very flexible and generic way of comparing whether two samples
    represent the same or different population. However, in cases where the population
    mean is already known, there is an even simpler test represented by `s/simple-t-test`.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 独立样本的*t*检验是最常见的统计分析方法，它提供了一种非常灵活和通用的方式，用于比较两个样本是否代表相同或不同的总体。然而，在总体均值已知的情况下，还有一种更简单的检验，即由`s/simple-t-test`表示。
- en: 'We pass a sample and a population mean to test against with the `:mu` keyword.
    So, if we simply want to see whether our new site is significantly different from
    the previous population mean dwell time of 90s, we can run a test like this:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过`:mu`关键字传递一个样本和一个总体均值进行检验。因此，如果我们仅仅想看看我们新站点的平均停留时间是否显著不同于先前90秒的总体均值，我们可以进行如下测试：
- en: '[PRE25]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: The `simple-t-test` function returns not only the *p*-value for the test, but
    also the confidence interval for the population mean. It is wide, running from
    78.5s to 165.5s, certainly overlapping with the 90s of our test. This explains
    why we were not able to reject the null hypothesis.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: '`simple-t-test`函数不仅返回检验的*p*-值，还会返回总体均值的置信区间。它很宽，从78.5秒到165.5秒，显然与我们测试中的90秒有重叠。这也解释了为什么我们无法拒绝原假设。'
- en: Resampling
  id: totrans-245
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 重采样
- en: To develop an intuition as to how the *t*-test can confirm and calculate these
    statistics from so little data, we can apply an approach called **resampling**.
    Resampling is based on the premise that each sample is just one of an infinite
    number of possible samples from a population. We can gain an insight into the
    nature of what these other samples could have been, and therefore have a better
    understanding of the underlying population, by taking many new samples from our
    existing sample.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 为了直观地理解*t*检验如何从如此少的数据中确认和计算这些统计量，我们可以应用一种叫做**重采样**的方法。重采样的前提是每个样本只是从一个总体中可能出现的无限多个样本之一。通过从现有样本中多次重新抽取样本，我们可以更好地理解这些其他样本的性质，从而更清楚地理解底层的总体。
- en: There are actually several resampling techniques, and we'll discuss one of the
    simplest—bootstrapping. In bootstrapping, we generate a new sample by repeatedly
    taking a random value from the original sample with replacement until we generate
    a sample that is of the same size as the original. Because these values are replaced
    between each random selection, the same source value can appear multiple times
    in the new sample. It is as if we were drawing a random card from a deck of playing
    cards repeatedly, but replacing the card after each draw. Occasionally, we will
    pick a card that we have previously selected.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上有几种重抽样技术，我们将讨论其中一种最简单的方法——自助法（bootstrapping）。在自助法中，我们通过反复从原始样本中随机抽取值并进行有放回抽样，直到生成一个与原始样本大小相同的新样本。由于每次随机选择后都会放回原始值，因此相同的源值可能会在新样本中出现多次。就好像我们在从一副扑克牌中反复抽取随机卡片，但每次抽完都会将卡片放回。偶尔，我们会再次抽到之前选过的卡片。
- en: 'We can bootstrap our sample easily in Incanter to generate many resamples with
    the bootstrap function. The `bootstrap` function takes two arguments—the original
    sample and a summary statistic to be calculated on the bootstrapped samples as
    well as the number of optional arguments—`:size` (the number of bootstrapped samples
    to be calculated on, each sample being the size of the original sample), `:smooth`
    (whether to smooth the output of discrete statistics such as the median), `:smooth-sd`,
    and `:replacement`, which defaults to true:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在Incanter中轻松地对样本进行自助法重抽样，利用`bootstrap`函数生成多个重抽样。`bootstrap`函数接受两个参数——原始样本和一个汇总统计量（该统计量将在重抽样样本上计算），以及一些可选参数——`:size`（需要计算的重抽样样本数量，每个样本的大小与原始样本相同）、`:smooth`（是否对离散统计量（如中位数）的输出进行平滑处理）、`:smooth-sd`和`:replacement`，默认为`true`：
- en: '[PRE26]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Let''s visualize the output in a histogram:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们用直方图来可视化输出结果：
- en: '![Resampling](img/7180OS_02_200.jpg)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![重抽样](img/7180OS_02_200.jpg)'
- en: The histogram shows how the values of the mean value have changed with repeated
    (re) samples of the new site dwell times. Although the input was just a single
    sample of 16 visitors, the bootstrapped samples have simulated the standard error
    of our original sample very clearly and visualized the confidence interval (78s
    to 165s) calculated earlier by our single sample *t*-test.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 直方图显示了随着重复（重）抽样新站点停留时间值的变化，均值的变化情况。尽管输入的数据只有一个16位访客的样本，但自助法重抽样清晰地模拟了原始样本的标准误差，并可视化了我们之前通过单一样本t检验计算出的置信区间（78秒到165秒）。
- en: Through bootstrapping, we simulated by taking multiple samples, even though
    we only had one sample as our input. It's a generally useful technique to estimate
    parameters that we cannot or do not know to calculate analytically.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 通过自助法重抽样，尽管我们的输入只有一个样本，我们通过多次抽样进行了模拟。这是一种广泛有用的技术，可以估计那些我们无法或者不知道如何进行解析计算的参数。
- en: Testing multiple designs
  id: totrans-254
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 测试多个设计
- en: It's been disappointing to discover that there is no statistical significance
    behind the increased dwell time of users on the new site design. Better that we
    discovered this on a small sample of users before we rolled it out to the world
    though.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 令人失望的是，我们发现新站点设计并未显著提高用户的停留时间。不过，我们在向全球推出之前，在一小部分用户中发现了这一问题，也算是幸运的。
- en: Not to be discouraged, AcmeContent's web team works overtime and devises a suite
    of alternative site designs. Taking the best elements from the other designs,
    they devise 19 variations to be tested. Together with our original site, which
    will act as a control, there are 20 different sites to direct visitors to.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 不灰心丧气，AcmeContent的网页团队加班加点，设计了一套替代的站点方案。通过从其他设计中汲取最佳元素，他们提出了19个变体供测试。加上我们的原始站点（作为对照组），一共有20个不同的站点来吸引访客。
- en: Calculating sample means
  id: totrans-257
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 计算样本均值
- en: The web team deploys the 19 new site designs alongside the original site. As
    mentioned earlier, each receives a random 5 percent of the visitors. We let the
    test run for 24 hours.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 网页团队将19个新设计和原始设计一起部署。正如之前所提到的，每个设计都会随机分配5%的访客。我们让测试运行24小时。
- en: 'The next day, we receive a file that shows the dwell times for visitors to
    each of the site designs. Each has been labeled with a number, with site `0` corresponding
    to the original unaltered design, and numbers `1` to `19` representing the other
    designs:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 第二天，我们收到了一份文件，展示了每个站点设计的访客停留时间。每个设计都有一个编号，其中`0`代表原始未更改的设计，`1`到`19`代表其他设计：
- en: '[PRE27]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'This code generates the following table:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码生成了如下表格：
- en: '![Calculating sample means](img/7180OS_02_210.jpg)'
  id: totrans-262
  prefs: []
  type: TYPE_IMG
  zh: '![计算样本均值](img/7180OS_02_210.jpg)'
- en: 'We would like to test out each of the site designs to see if any generate a
    statistically significant result. To do so, we could compare the sites with each
    other as follows:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望测试每个站点设计，以查看是否有任何生成统计学显著结果。为此，我们可以通过以下方式将各个站点进行比较：
- en: '[PRE28]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: However, this would be a bad idea. We are very likely to see a statistical difference
    between the pages that performed particularly well against the pages that performed
    particularly poorly, even if these differences were by chance. If you run the
    earlier example, you'll see that many of the pages are statistically different
    from each other.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这并不是一个好主意。即使这些差异是偶然发生的，我们也很可能会看到在表现特别好的页面与表现特别差的页面之间存在统计学差异。如果你运行前面的示例，你会看到许多页面在统计学上彼此存在差异。
- en: 'Alternatively, we could compare each site against our current baseline—the
    mean dwell time of 90 seconds currently measured for our site:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，我们可以将每个站点与我们当前的基准进行比较——即目前我们网站的平均停留时间为90秒：
- en: '[PRE29]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'This test determines two sites as being significantly different from the baseline:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 这个测试确定了两个站点与基准值有显著差异：
- en: '[PRE30]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: The small *p*-values (smaller than 1 percent) indicate that there is a very
    statistically significant difference. This looks very promising, but we have an
    issue. We have performed a *t*-test on 20 samples of data with an *α* of 0.05\.
    The definition of *α* is that it is the probability of wrongly rejecting the null
    hypothesis. By running a *t*-test 20 times, it actually becomes probable that
    we would wrongly reject the null hypothesis for at least one of the pages.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 较小的*p*值（小于1%）表示存在非常显著的统计学差异。这看起来非常有前景，但我们有一个问题。我们已经对20个数据样本进行了*t*检验，设定*α*为0.05。*α*的定义是错误拒绝原假设的概率。通过进行20次*t*检验，实际上有可能错误地拒绝至少一个页面的原假设。
- en: By comparing multiple pages at once like this, we invalidate the results of
    the *t*-test. There exist a variety of alternative techniques to address the problem
    of making multiple comparisons in statistical tests, which we'll introduce in
    a later section.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 通过像这样一次性比较多个页面，我们使得*t*检验的结果失效。解决在统计检验中进行多重比较的问题，存在多种替代技术，我们将在后面的章节中介绍这些方法。
- en: Multiple comparisons
  id: totrans-272
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 多重比较
- en: The fact that with repeated trials, we increase the probability of discovering
    a significant effect is called the multiple comparisons problem. In general, the
    solution to the problem is to demand more significant effects when comparing many
    samples. There is no straightforward solution to this issue though; even with
    an *α* of 0.01, we will make a Type I error on an average of 1 percent of the
    time.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，随着重复试验，我们增加了发现显著效应的概率，这就是多重比较问题。通常，解决该问题的方法是，在比较多个样本时要求更显著的效应。然而，这个问题并没有简单的解决方案；即使设置*α*为0.01，我们仍然会在平均1%的时间内犯第一类错误。
- en: To develop our intuition about how multiple comparisons and statistical significance
    relate to each other, let's build an interactive web page to simulate the effect
    of taking multiple samples. It's one of the advantages of using a powerful and
    general-purpose programming language like Clojure for data analysis that we can
    run our data processing code in a diverse array of environments.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助我们更直观地理解多重比较和统计显著性之间的关系，接下来我们将构建一个互动网页，来模拟进行多次采样的效果。使用像Clojure这样强大且通用的编程语言进行数据分析的优势之一就是，我们可以在多种环境中运行我们的数据处理代码。
- en: 'The code we''ve written and run so far for this chapter has been compiled for
    the Java Virtual Machine. But since 2013, there has been an alternative target
    environment for our compiled code: the web browser. ClojureScript extends the
    reach of Clojure even further to any computer that has a JavaScript-enabled web
    browser.'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 我们目前为本章编写并运行的代码是为Java虚拟机编译的。但自2013年以来，我们的编译代码有了一个替代目标环境：网页浏览器。ClojureScript将Clojure的应用范围进一步扩展到了任何具有JavaScript功能的网页浏览器的计算机。
- en: Introducing the simulation
  id: totrans-276
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 引入模拟
- en: To help visualize the problems associated with multiple significance testing,
    we'll use ClojureScript to build an interactive simulation, looking for statistically
    significant differences between the samples drawn at random from two exponential
    distributions. To see how other factors relate to our hypothesis testing, our
    simulation will allow us to change the underlying population mean for each of
    the two distributions, as well as set the sample size and desired confidence level.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助可视化与多重显著性检验相关的问题，我们将使用 ClojureScript 构建一个交互式模拟，寻找从两个指数分布中随机抽样的样本之间的统计显著差异。为了观察其他因素如何与我们的假设检验相关联，我们的模拟将允许我们改变两个分布的基础总体均值，以及设置样本大小和所需的置信水平。
- en: If you have downloaded the sample code for this chapter, you will see, in the
    resources directory, an `index.html` file. If you open this code in a web browser,
    you should see a message prompting you to compile the JavaScript. We can do this
    with the Leiningen plugin called `cljsbuild`.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已下载本章的示例代码，你将在资源目录中看到一个 `index.html` 文件。如果你在浏览器中打开这个文件，你应该看到一个提示信息，提示你编译
    JavaScript。我们可以使用名为 `cljsbuild` 的 Leiningen 插件来做到这一点。
- en: Compile the simulation
  id: totrans-279
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 编译模拟
- en: '`cljsbuild` is a Leiningen plugin that compiles ClojureScript to JavaScript.
    To use it, we simply have to let the compiler know where we would like to output
    the JavaScript file. While Clojure code outputs to a `.jar` file (short for Java
    Archive), ClojureScript outputs to a single `.js` file. We specify the name of
    the output file and the compiler settings to use with the `:cljsbuilds` section
    of `project.clj`.'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: '`cljsbuild` 是一个将 ClojureScript 编译为 JavaScript 的 Leiningen 插件。要使用它，我们只需让编译器知道我们希望将
    JavaScript 文件输出到哪里。Clojure 代码输出为 `.jar` 文件（即 Java 存档），而 ClojureScript 输出为单个 `.js`
    文件。我们通过 `project.clj` 文件中的 `:cljsbuilds` 部分指定输出文件的名称和编译器设置。'
- en: 'The plugin is accessible on the command line as `lein cljsbuild`. In the root
    of the project directory, run the following command:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 该插件可以通过命令行访问，命令为 `lein cljsbuild`。在项目根目录中运行以下命令：
- en: '[PRE31]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'This command will compile a JavaScript file for us. An alternative command
    is as follows:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将为我们编译一个 JavaScript 文件。另一种替代命令如下：
- en: '[PRE32]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: The preceding will compile the code, but will remain active, monitoring changes
    to the source files. If any of these files are updated, the output will be recompiled.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 上述内容将编译代码，但会保持活跃，监控源文件的更改。如果这些文件中的任何一个被更新，输出将会重新编译。
- en: Open the file `resources/index.html` in a web browser now to see the effect
    of the JavaScript.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 现在打开 `resources/index.html` 文件在浏览器中查看 JavaScript 的效果。
- en: The browser simulation
  id: totrans-287
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 浏览器模拟
- en: 'An HTML page has been supplied in the resources directory of the sample project.
    Open the page in any modern browser and you should see something similar to the
    following image:'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 一个 HTML 页面已被提供在示例项目的资源目录中。在任何现代浏览器中打开该页面，你应该能看到类似以下的图像：
- en: '![The browser simulation](img/7180OS_02_220.jpg)'
  id: totrans-289
  prefs: []
  type: TYPE_IMG
  zh: '![浏览器模拟](img/7180OS_02_220.jpg)'
- en: The left of the page shows a dual histogram with the distribution of two samples,
    both taken from an exponential distribution. The means of the populations from
    which the samples are generated are controlled by the sliders at the top right
    corner of the web page in the box marked as **Parameters**. Underneath the histogram
    is a plot showing the two probability densities for the population means based
    on the samples. These are calculated using the *t*-distribution, parameterized
    by the degrees of freedom of the sample. Below these sliders, in a box marked
    as **Settings**, are another pair of sliders that set the sample size and confidence
    intervals for the test. Adjusting the confidence intervals will crop the tails
    of the *t*-distributions; at the 95 percent confidence interval, only the central
    95 percent of the probability distributions are displayed. Finally, in a box marked
    as **Statistics**, are the sliders that show the mean of both the samples. These
    cannot be changed; their values are measured from the samples. A button marked
    as **New Sample** can be used to generate two new random samples. Observe how
    the sample means fluctuate with each new pair of samples being generated. Keep
    generating samples and you'll occasionally observe significant differences between
    sample means, even when the underlying population means are identical.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 页面左侧显示了两个样本的双重直方图，这些样本都来自指数分布。样本生成的总体均值由网页右上角标记为 **参数** 的框中的滑块控制。在直方图下方是一个图表，显示基于样本的总体均值的两个概率密度。这些值是通过
    *t* 分布计算的，参数是样本的自由度。在这些滑块下方，在标记为 **设置** 的框中，有另一对滑块用于设置样本大小和置信区间。调整置信区间会裁剪 *t*
    分布的尾部；在 95% 置信区间下，只有概率分布的中央 95% 会被显示。最后，在标记为 **统计数据** 的框中，显示了两个样本的均值的滑块。这些值不能更改；它们是从样本中测量得出的。一个标记为
    **新样本** 的按钮可以用来生成两个新的随机样本。观察每次生成新样本对样本均值的波动。不断生成样本，你偶尔会看到样本均值之间有显著差异，即使底层总体均值相同。
- en: While we explore the effects of changing the sample size and the confidence
    for different population means, let's look at how the simulation was constructed
    with the libraries `jStat`, `Reagent`, and `B1`.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们探索不同样本大小和置信度对不同总体均值的影响时，让我们看看如何使用 `jStat`、`Reagent` 和 `B1` 库构建这个模拟。
- en: jStat
  id: totrans-292
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: jStat
- en: As ClojureScript compiles to JavaScript, we can't make use of the libraries
    that have Java dependencies. Incanter is heavily reliant on several underlying
    Java libraries, so we have to find an alternative to Incanter for our browser-based
    statistical analysis.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 ClojureScript 编译成 JavaScript，我们不能使用有 Java 依赖的库。Incanter 强烈依赖几个底层 Java 库，因此我们必须找到一个替代
    Incanter 的浏览器端统计分析工具。
- en: Note
  id: totrans-294
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: While building ClojureScript applications, we can't make use of the libraries
    that depend on Java libraries, as they won't be available in the JavaScript engine
    which executes our code.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建 ClojureScript 应用程序时，我们不能使用依赖于 Java 库的库，因为它们在执行我们代码的 JavaScript 引擎中不可用。
- en: '`jStat` ([https://github.com/jstat/jstat](https://github.com/jstat/jstat))
    is a JavaScript statistical library. It provides functions to generate sequences
    according to specific distributions, including the exponential and *t*-distributions.'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: '`jStat` ([https://github.com/jstat/jstat](https://github.com/jstat/jstat))
    是一个 JavaScript 统计库。它提供了根据特定分布生成序列的函数，包括指数分布和 *t* 分布。'
- en: To use it, we have to make sure it's available on our webpage. We can do this
    either by linking it to a remote **content distribution network** (**CDN**) or
    by hosting the file ourselves. The advantage of linking it to a CDN is that visitors,
    who previously downloaded `jStat` for another website, can make use of their cached
    version. However, since our simulation is for local use, we've included the file
    so that the page works even when our browser is offline.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用它，我们必须确保它在我们的网页上可用。我们可以通过链接到远程**内容分发网络** (**CDN**) 或者自己托管文件来实现这一点。链接到 CDN
    的好处是，曾经为另一个网站下载过 `jStat` 的访客可以使用他们的缓存版本。然而，由于我们的模拟是为本地使用而设计的，我们已经将文件包含在内，以确保即使浏览器离线，页面也能正常工作。
- en: The `jstat.min.js` file has been downloaded in the `resources/js/vendor` directory.
    The file is loaded in the main body of `index.html` with a standard HTML tag.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: '`jstat.min.js` 文件已下载到 `resources/js/vendor` 目录中。该文件通过标准 HTML 标签加载到 `index.html`
    的主体部分。'
- en: To make use of jStat's distribution generating functions, we have to interact
    with the JavaScript library from ClojureScript. As with the Java interop, Clojure
    provides pragmatic syntax to interact with the libraries written in the host language.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 为了利用jStat的分布生成函数，我们必须从ClojureScript与JavaScript库进行交互。与Java互操作一样，Clojure提供了务实的语法来与用主机语言编写的库进行交互。
- en: '`jStat` provides a variety of distributions documented at [https://jstat.github.io/distributions.html](https://jstat.github.io/distributions.html).
    To generate samples from an exponential distribution, we''d like to call the `jStat.exponential.sample(lambda)`
    function. The JavaScript interop for it is very straightforward; we prefix the
    expression with `js/` to ensure that we access JavaScript''s namespace and move
    the position of the brackets:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: '`jStat`提供了各种分布，可以在[https://jstat.github.io/distributions.html](https://jstat.github.io/distributions.html)找到相关文档。要从指数分布生成样本，我们可以调用`jStat.exponential.sample(lambda)`函数。与JavaScript的互操作非常简单；我们只需在表达式前加上`js/`，以确保访问JavaScript的命名空间，并调整括号的位置：'
- en: '[PRE33]'
  id: totrans-301
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Once we have the ability to generate samples from an exponential distribution,
    creating a lazy sequence of samples will be as simple as calling the function
    repeatedly:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们能够从指数分布中生成样本，创建一个懒加载样本序列将变得简单，只需要重复调用该函数：
- en: '[PRE34]'
  id: totrans-303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: ClojureScript exposes almost all of Clojure, including lazy sequences. Refer
    to the book's wiki at [http://wiki.clojuredatascience.com](http://wiki.clojuredatascience.com)
    for links to resources on the JavaScript interop.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: ClojureScript几乎暴露了Clojure的所有功能，包括懒加载序列。请参考本书的wiki [http://wiki.clojuredatascience.com](http://wiki.clojuredatascience.com)，获取关于JavaScript互操作的资源链接。
- en: B1
  id: totrans-305
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: B1
- en: Now that we can generate samples of data in ClojureScript, we'd like to be able
    to plot them on a histogram. We need a pure Clojure alternative to Incanter that
    will draw histograms in a web-accessible format; the B1 library ([https://github.com/henrygarner/b1](https://github.com/henrygarner/b1))
    provides just this functionality. The name is derived from the fact that it is
    adapted and simplified from the ClojureScript library `C2`, which in turn is a
    simplification of the popular JavaScript data visualization framework `D3`.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以在ClojureScript中生成数据样本，我们希望能够将它们绘制在直方图上。我们需要一个纯Clojure的替代方案，用于绘制可以在网页上访问的直方图；B1库（[https://github.com/henrygarner/b1](https://github.com/henrygarner/b1)）正提供了这样的功能。这个名字源于它是从ClojureScript库`C2`改编和简化而来的，而`C2`又是流行的JavaScript数据可视化框架`D3`的简化版。
- en: We'll be using B1's simple utility functions in `b1.charts` to build histograms
    out of our data in ClojureScript. B1 does not mandate a particular display format;
    we could use it to draw on a canvas element or even to build diagrams directly
    out of the HTML elements. However, B1 does contain functions to convert charts
    to SVG in `b1.svg` and these can be displayed in all modern web browsers.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用B1在`b1.charts`中的简单工具函数，将数据构建为ClojureScript中的直方图。B1并不强制要求特定的显示格式；我们可以使用它在canvas元素上绘制，或者甚至直接从HTML元素中构建图表。然而，B1确实包含将图表转换为SVG的函数，这些图表可以在所有现代网页浏览器中显示。
- en: Scalable Vector Graphics
  id: totrans-308
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 可伸缩矢量图形（Scalable Vector Graphics）
- en: SVG stands for Scalable Vector Graphics and defines a set of tags that represent
    drawing instructions. The advantage of SVG is that results can be rendered at
    any size without the blurring associated with raster (pixel-based) graphics that
    are scaled up. An additional benefit is that modern browsers know how to render
    SVG drawing instructions to produce images directly in the web page and can style
    and animate the images with CSS.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: SVG代表可伸缩矢量图形（Scalable Vector Graphics），定义了一组表示绘图指令的标签。SVG的优势在于，结果可以在任何尺寸下渲染，而不会像按比例放大的光栅（基于像素的）图形那样模糊。另一个好处是现代浏览器知道如何渲染SVG绘图指令，并直接在网页中生成图像，还可以使用CSS对图像进行样式化和动画处理。
- en: 'Although a detailed discussion of SVG and CSS is beyond the scope of this book,
    B1 does provide syntax that is very much like Incanter''s to build simple charts
    and graphs using SVG. Given a sequence of values, we call the `c/histogram` function
    to convert it into an internal representation of the data structure. We can add
    additional histograms with the `c/add-histogram` function and call `svg/as-svg`
    to render the chart to an SVG representation:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然对SVG和CSS的详细讨论超出了本书的范围，但B1确实提供了类似Incanter的语法，用于使用SVG构建简单的图表和图形。给定一组值，我们可以调用`c/histogram`函数将其转换为数据结构的内部表示。我们可以使用`c/add-histogram`函数添加额外的直方图，并调用`svg/as-svg`将图表渲染为SVG表示形式：
- en: '[PRE35]'
  id: totrans-311
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Unlike Incanter, when we choose to render our histogram, we must also specify
    the desired width and height of the chart.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 与Incanter不同，当我们选择渲染直方图时，我们还必须指定图表的期望宽度和高度。
- en: Plotting probability densities
  id: totrans-313
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 绘制概率密度
- en: 'In addition to using jStat to generate samples from the exponential distribution,
    we''ll also use it to calculate the probability density for the *t*-distribution.
    We can construct a simple function to wrap the `jStat.studentt.pdf(t, df)` function,
    providing the correct *t*-statistic and degrees of freedom to parameterize the
    distribution:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 除了使用jStat从指数分布中生成样本外，我们还将使用它来计算*t*分布的概率密度。我们可以构建一个简单的函数来封装`jStat.studentt.pdf(t,
    df)`函数，提供正确的*t*统计量和自由度来参数化分布：
- en: '[PRE36]'
  id: totrans-315
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'An advantage of using ClojureScript is that we have already written the code
    to calculate the *t*-statistic from a sample. The code, which worked in Clojure,
    can be compiled to ClojureScript with no changes whatsoever:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 使用ClojureScript的一个优势是我们已经编写了计算样本*t*统计量的代码。这段代码在Clojure中可以正常工作，并且可以在不做任何更改的情况下编译为ClojureScript：
- en: '[PRE37]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: To render the probability density, we can use B1's `c/function-area-plot`. This
    will generate an area plot from the line described by a function. The provided
    function simply needs to accept an *x* and return the corresponding *y*.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 为了渲染概率密度，我们可以使用B1的`c/function-area-plot`。这将根据一个由函数描述的线生成面积图。提供的函数只需要接受一个*x*并返回相应的*y*。
- en: 'A slight complication is that the value of *y* we return will be different
    for different samples. This is because `t-pdf` will be highest at the sample mean
    (corresponding to a *t*-statistic of zero). Because of this, we''ll need to generate
    a different function for each sample to be passed to `function-area-plot`. This
    is accomplished by the `probability-density` function, as follows:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 一个小小的复杂性是我们返回的*y*值对于不同的样本会有所不同。这是因为`t-pdf`在样本均值处（对应于*t*统计量为零）最高。因此，我们需要为每个样本生成一个不同的函数来传递给`function-area-plot`。这通过`probability-density`函数来实现，如下所示：
- en: '[PRE38]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: Here, we're defining a higher-order function called `probability-density` that
    accepts a single value, `sample`. We calculate some simple summary statistics
    and then return an anonymous function that calculates the probability density
    for a given value in the distribution.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们定义了一个高阶函数`probability-density`，它接受一个单一值`sample`。我们计算一些简单的汇总统计量，然后返回一个匿名函数，该函数计算分布中给定值的概率密度。
- en: 'This anonymous function is what will be passed to `function-area-plot`. It
    accepts an *x* and calculates a *t*-statistic for the given sample from it. The
    *y* value returned is the probability of the *t*-distribution associated with
    the *t*-statistic:'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 这个匿名函数将传递给`function-area-plot`。它接受一个*x*并计算给定样本的*t*统计量。返回的*y*值是与*t*统计量相关的*t*分布的概率：
- en: '[PRE39]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: As with histograms, generating multiple plots is as straightforward as calling
    `add-function` with the chart, and the new function we'd like to add.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 与直方图一样，生成多个图表和调用`add-function`一样简单，只需提供图表和我们想要添加的新函数。
- en: State and Reagent
  id: totrans-325
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 状态和Reagent
- en: State in ClojureScript is managed in the same way as Clojure applications—through
    the use of atoms, refs, or agents. Atoms provide uncoordinated, synchronous access
    to a single identity and are an excellent choice for storing the application state.
    Using an atom ensures that the application always sees a single, consistent view
    of the data.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 在ClojureScript中，状态的管理方式与Clojure应用程序相同——通过使用原子、引用或代理。原子提供对单一身份的非协调、同步访问，是存储应用状态的绝佳选择。使用原子确保应用始终看到数据的一致视图。
- en: Reagent is a ClojureScript library that provides a mechanism to update the content
    of a web page in response to changing the value of an atom. Markup and state are
    bound together, so that markup is regenerated whenever the application state is
    updated.
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: Reagent是一个ClojureScript库，它提供了一种机制，用于在原子值发生变化时更新网页内容。标记和状态是绑定在一起的，因此每当应用程序状态更新时，标记将重新生成。
- en: Reagent also provides syntax to render HTML in an idiomatic way using Clojure
    data structures. This means that both the content and the interactivity of the
    page can be handled in one language.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: Reagent还提供了语法，用于使用Clojure数据结构以惯用方式渲染HTML。这意味着页面的内容和交互性可以使用一种语言来处理。
- en: Updating state
  id: totrans-329
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更新状态
- en: With data held in a Reagent atom, updating the state is achieved by calling
    the `swap!` function with two arguments—the atom we wish to update and a function
    to transform the state of the atom. The provided function needs to accept the
    current state of the atom and return the new state. The exclamation mark indicates
    that the function has side effects and, in this case, the side effects are desirable;
    in addition to updating the atom, Reagent will ensure that relevant sections of
    our HTML page are updated.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 数据保存在Reagent atom中，更新状态是通过调用`swap!`函数实现的，该函数接受两个参数——我们希望更新的atom和一个函数，该函数用来转换atom的状态。提供的函数需要接受atom的当前状态并返回新的状态。感叹号表示该函数具有副作用，在这里副作用是可取的；除了更新atom之外，Reagent还会确保我们的HTML页面中的相关部分得到更新。
- en: 'The exponential distribution has a single parameter—the rate symbolized by
    lambda, *λ*. The rate of an exponential distribution is the reciprocal of the
    mean, so we calculate `(/ 1 mean-a)` to pass it as the argument to the exponential
    distribution function:'
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 指数分布有一个单一的参数——速率，表示为λ（lambda）。指数分布的速率是均值的倒数，因此我们通过计算`(/ 1 mean-a)`来将其作为参数传递给指数分布函数：
- en: '[PRE40]'
  id: totrans-332
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: In the preceding code, we have defined an `update-sample` function that accepts
    a map containing `:sample-size`, `:mean-a`, and `:mean-b`, and returns a new map
    with the associated new samples and sample means.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的代码中，我们定义了一个`update-sample`函数，它接受一个包含`:sample-size`、`:mean-a`和`:mean-b`的映射，并返回一个包含相关新样本和样本均值的新映射。
- en: The `update-sample` function is pure in the sense that it doesn't have side
    effects, which makes it easier to test. The `update-sample!` function wraps it
    with a call to `swap!`. Reagent ensures that any code that depends on the value
    contained in this atom will be executed when the value in the atom changes. This
    causes our interface to be re-rendered in response to the new samples.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: '`update-sample`函数是纯函数，意思是它没有副作用，这使得它更容易测试。`update-sample!`函数通过调用`swap!`来封装它。Reagent确保任何依赖于该atom中值的代码在atom中的值发生变化时都会执行。这导致我们的界面在新样本的响应下重新渲染。'
- en: Binding the interface
  id: totrans-335
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 绑定界面
- en: 'To bind the interface to the state, Reagent defines a `render-component` function.
    This links a particular function (in this case, our `layout-interface` function)
    with a particular HTML node (the element with the ID `root` on our page):'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 为了将界面绑定到状态，Reagent定义了一个`render-component`函数。这个函数将一个特定的函数（在此为我们的`layout-interface`函数）与一个特定的HTML节点（页面上ID为`root`的元素）连接起来：
- en: '[PRE41]'
  id: totrans-337
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Our `layout-interface` function contains an HTML markup expressed as nested
    Clojure data structures. Amongst the calls to `:div` and `:h1`, elements are calls
    to our two `sample-histograms` and `sample-means` functions. They will be substituted
    with their return values—the SVG representations of the histograms and the probability
    densities of the means.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的`layout-interface`函数包含了作为嵌套Clojure数据结构表示的HTML标记。在对`:div`和`:h1`的调用之间，有两个调用我们自己的`sample-histograms`和`sample-means`函数。它们将被替换为它们的返回值——直方图的SVG表示以及均值的概率密度。
- en: For the sake of brevity, we have omitted the implementation of the `controllers`
    function, which handles the rendering of the sliders and the **New Sample** button.
    Consult the `cljds.ch2.app` namespace in the sample code to see how this is implemented.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简洁起见，我们省略了`controllers`函数的实现，它处理滑块和**新建样本**按钮的渲染。请查阅示例代码中的`cljds.ch2.app`命名空间，查看这是如何实现的。
- en: Simulating multiple tests
  id: totrans-340
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模拟多个测试
- en: Each time the **New** **Sample** button is pressed, a pair of new samples from
    an exponential distribution with population means taken from the sliders are generated.
    The samples are plotted on a histogram and, underneath, a probability density
    function is drawn showing the standard error for the sample. As the confidence
    intervals are changed, observe how the acceptable deviation of the standard error
    changes as well.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 每次按下**新建** **样本**按钮时，都会生成一对来自指数分布的新样本，人口均值来自滑块。样本会被绘制在直方图上，并且在下面会绘制一个概率密度函数，显示样本的标准误差。当置信区间发生变化时，可以观察到标准误差的可接受偏差也会发生变化。
- en: Each time the button is pressed, we could think of it as a significance test
    with an alpha set to the complement of the confidence interval. In other words,
    if the probability distributions for the sample means overlap at the 95 percent
    confidence interval, we cannot reject the null hypothesis at the 5 percent significance
    level.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 每次按下按钮时，我们可以将其视为一个显著性检验，alpha设置为置信区间的补充值。换句话说，如果样本均值的概率分布在95%的置信区间内重叠，我们就无法在5%的显著性水平下拒绝零假设。
- en: Observe how, even when the population means are identical, occasional large
    deviations in the means will occur. Where samples differ by more than our standard
    error, we can accept the alternate hypothesis. With a confidence level of 95 percent,
    we will discover a significant result around one in 20 trials, even when the population
    means of the distributions are identical. When this happens, we are making a Type
    1 error in mistaking a sampling error for a real population difference.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 请观察，即使总体均值相同，均值偶尔也会发生较大的偏差。当样本差异超过我们的标准误差时，我们可以接受备择假设。在95%的置信水平下，即使分布的总体均值相同，我们也会在20次试验中发现约一次显著结果。当这种情况发生时，我们正在犯第一类错误，即将抽样误差误认为是真正的总体差异。
- en: '![Simulating multiple tests](img/7180OS_02_230.jpg)'
  id: totrans-344
  prefs: []
  type: TYPE_IMG
  zh: '![模拟多重测试](img/7180OS_02_230.jpg)'
- en: Despite the identical population parameters, large sample differences are occasionally
    observed.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管总体参数相同，但偶尔会观察到较大的样本差异。
- en: The Bonferroni correction
  id: totrans-346
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 邦费罗尼校正
- en: We therefore require an alternative approach while conducting multiple tests
    that will account for an increased probability of discovering a significant effect
    through repeated trials. The Bonferroni correction is a very simple adjustment
    that ensures we are unlikely to make Type I errors. It does this by adjusting
    the alpha for our tests.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在进行多重测试时，我们需要一种替代方法，以应对通过重复试验发现显著效应的概率增加。邦费罗尼校正是一种非常简单的调整方法，确保我们不太可能犯第一类错误。它通过调整我们测试的显著性水平（alpha）来实现这一点。
- en: 'The adjustment is a simple one—the Bonferroni correction simply divides our
    desired alpha by the number of tests we are performing. For example, if we had
    *k* site designs to test and an experimental alpha of *0.05*, the Bonferroni correction
    is expressed as:'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 该调整非常简单——邦费罗尼校正只需将我们期望的显著性水平（alpha）除以我们进行的测试数量。例如，如果我们有*k*个网站设计要测试，并且实验的显著性水平为*0.05*，则邦费罗尼校正公式为：
- en: '![The Bonferroni correction](img/7180OS_02_12.jpg)'
  id: totrans-349
  prefs: []
  type: TYPE_IMG
  zh: '![邦费罗尼校正](img/7180OS_02_12.jpg)'
- en: 'This is a safe way to mitigate the increased probability of making a Type I
    error in multiple testing. The following example is identical to `ex-2-22`, except
    the alpha value has been divided by the number of groups:'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 这是减少在多重测试中发生第一类错误概率增加的安全方法。以下示例与`ex-2-22`相同，不同之处在于显著性水平的值已被除以组的数量：
- en: '[PRE42]'
  id: totrans-351
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: If you run the preceding example, you'll see that none of the pages count as
    statistically significant any longer using the Bonferroni correction.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你运行前面的示例，你会发现使用邦费罗尼校正后，任何页面都不再被视为统计显著。
- en: Significance testing is a balancing act—the lower our chances of making a Type
    I error, the greater our risk of making a Type II error. The Bonferroni correction
    is very conservative and it's possible that we're missing a genuine difference
    due to being so cautious.
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 显著性检验是一项平衡工作——我们降低第一类错误的几率时，第二类错误的风险会增大。邦费罗尼校正非常保守，因此有可能由于过于谨慎，我们错过了真正的差异。
- en: In the final part of this chapter, we'll investigate an alternative approach
    to significance testing that strikes a balance between making Type I and Type
    II errors while allowing us to test all the 20 pages simultaneously.
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的最后部分，我们将研究一种替代的显著性检验方法，这种方法在减少第一类错误和第二类错误之间取得平衡，同时允许我们同时测试所有的20个页面。
- en: Analysis of variance
  id: totrans-355
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 方差分析
- en: Analysis of variance, often shortened to **ANOVA**, is a series of statistical
    methods used to measure the statistical significance of the difference between
    groups. It was developed by Ronald Fisher, an extremely gifted statistician, who
    also popularized significance testing through his work on biological testing.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 方差分析，通常缩写为**ANOVA**，是一系列用于衡量组间差异的统计显著性的方法。它由极具天赋的统计学家罗纳德·费舍尔（Ronald Fisher）开发，他通过在生物学实验中的应用推广了显著性检验。
- en: Our tests, using the *z*-statistic and *t*-statistic, have focused on sample
    means as the primary mechanism to draw a distinction between the two samples.
    In each case, we looked for a difference in the means divided by the level of
    difference we could reasonably expect and quantified by the standard error.
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的测试，使用*z*-统计量和*t*-统计量，主要集中在样本均值上，作为区分两个样本的主要机制。在每种情况下，我们都寻找均值的差异，除以我们合理预期的差异水平，并通过标准误差进行量化。
- en: The mean isn't the only statistic that might indicate a difference between samples.
    In fact, it is also possible to use the sample variance as an indicator of statistical
    difference.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 均值并不是唯一可能表明样本之间存在差异的统计量。事实上，样本方差也可以作为统计差异的一个指标。
- en: '![Analysis of variance](img/7180OS_02_240.jpg)'
  id: totrans-359
  prefs: []
  type: TYPE_IMG
  zh: '![方差分析](img/7180OS_02_240.jpg)'
- en: To illustrate how this might work, consider the preceding diagram. Each of the
    three groups on the left could represent samples of dwell times for a specific
    page with its own mean and standard deviation. If the dwell times for all the
    three groups are combined into one, the variance is larger than the average variance
    for the groups taken individually.
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明这一点，考虑前面的图示。左侧的三个组中的每一个都可以代表某一特定页面的停留时间样本，每个组都有自己的均值和标准差。如果将三个组的停留时间合并成一个，则方差比单独计算每组的平均方差要大。
- en: The statistical significance of an ANOVA test is derived from the ratio of two
    variances—the variance *between* the groups of interest and the variance *within*
    the groups of interest. If there is a significant difference between the groups
    that is not reflected within the groups, then those groupings help explain some
    of the variance between the groups. Conversely, if the variance within the groups
    is identical to the variance between the groups, the groups are not statistically
    different from one another.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 方差分析（ANOVA）测试的统计显著性来源于两个方差的比率——即*组间*方差和*组内*方差。如果组间存在显著差异，但组内没有反映这种差异，那么这些分组有助于解释组间的一些方差。相反，如果组内的方差与组间的方差相同，那么这些组在统计学上并没有显著差异。
- en: The F-distribution
  id: totrans-362
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: F-分布
- en: The *F*-distribution is parameterized by two degrees of freedom—those of the
    sample size and those of the number of groups.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: '*F*-分布由两个自由度参数化——一个是样本大小的自由度，另一个是组数的自由度。'
- en: 'The first degree of freedom is the count of groups less one and the second
    degree of freedom is the size of the sample less the number of groups. If *k*
    represents the number of groups, and *n* represents the sample size:'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个自由度是组数减一，第二个自由度是样本大小减去组数。如果*k*代表组数，*n*代表样本大小：
- en: '![The F-distribution](img/7180OS_02_13.jpg)![The F-distribution](img/7180OS_02_14.jpg)'
  id: totrans-365
  prefs: []
  type: TYPE_IMG
  zh: '![F-分布](img/7180OS_02_13.jpg)![F-分布](img/7180OS_02_14.jpg)'
- en: 'We can visualize different *F*-distributions with an Incanter function plot:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过Incanter函数图来可视化不同的*F*分布：
- en: '![The F-distribution](img/7180OS_02_250.jpg)'
  id: totrans-367
  prefs: []
  type: TYPE_IMG
  zh: '![F-分布](img/7180OS_02_250.jpg)'
- en: The lines of the preceding diagram show various *F*-distributions for a sample
    of 100 points split into 5, 10, and 50 groups.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的图示显示了不同的*F*分布，这些分布是基于将100个数据点拆分成5组、10组和50组的结果。
- en: The F-statistic
  id: totrans-369
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: F-统计量
- en: 'The test statistic that represents the ratio of the variance within and between
    the groups is called the *F*-statistic. The closer *F*-statistic is to one, the
    more alike the two variances are. The *F*-statistic is calculated very simply
    as follows:'
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 表示组内和组间方差比率的检验统计量称为*F*-统计量。*F*-统计量越接近1，表示两者的方差越相似。*F*-统计量的计算方法非常简单，如下所示：
- en: '![The F-statistic](img/7180OS_02_15.jpg)'
  id: totrans-371
  prefs: []
  type: TYPE_IMG
  zh: '![F-统计量](img/7180OS_02_15.jpg)'
- en: Here, ![The F-statistic](img/7180OS_02_16.jpg) is the *variance between* the
    groups and ![The F-statistic](img/7180OS_02_17.jpg) is the *variance within* the
    groups.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![F-统计量](img/7180OS_02_16.jpg)是组间的*方差*，而![F-统计量](img/7180OS_02_17.jpg)是组内的*方差*。
- en: As the ratio *F* gets larger, the larger the variance between the groups is
    compared to the variance within the groups. This implies that the grouping is
    doing a good job in explaining the variance observed in the sample as a whole.
    Where this ratio exceeds a critical threshold, we can say that the difference
    is statistically significant.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 当*F*比率增大时，组间方差与组内方差的比率也会增大。这意味着分组在解释整个样本观察到的方差方面表现得很好。当这个比率超过一个临界值时，我们可以说差异在统计学上是显著的。
- en: Note
  id: totrans-374
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The *F*-test is always a one-tailed test, because any variance among the groups
    tends to make *F* large. It is impossible for *F* to decrease below zero.
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: '*F*检验始终是单尾检验，因为组间的任何方差都会使*F*值变大。*F*不可能小于零。'
- en: 'The *variance within* for an *F*-test is calculated as the mean squared deviation
    from the mean. We calculate this as the sum of squared deviations from the mean
    divided by the first degree of freedom. For example, if there are *k* groups,
    each with a mean of ![The F-statistic](img/7180OS_02_18.jpg), we could calculate
    the variance within like this:'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: '*F*检验中的*组内方差*是通过均值的平方偏差的平均值计算的。我们将其计算为从均值的平方偏差的和除以第一个自由度。例如，如果有*k*个组，每个组的均值为
    ![F统计量](img/7180OS_02_18.jpg)，我们可以这样计算*组内方差*：'
- en: '![The F-statistic](img/7180OS_02_19.jpg)'
  id: totrans-377
  prefs: []
  type: TYPE_IMG
  zh: '![F统计量](img/7180OS_02_19.jpg)'
- en: Here, *SSW* represents the *sum of squares within* and *x[jk]* represents the
    value of the *j^(th)* element in group *k*.
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*SSW*表示*组内平方和*，*x[jk]*表示组*k*中*j^(th)*元素的值。
- en: 'The preceding formula for calculating the *SSW* looks intimidating. But, in
    fact, Incanter defines a useful `s/sum-of-square-devs-from-mean` function that
    makes calculating the sum of squares within as trivial as:'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的计算*SSW*的公式看起来很复杂。但实际上，Incanter定义了一个有用的` s/sum-of-square-devs-from-mean`函数，这使得计算组内平方和变得像这样简单：
- en: '[PRE43]'
  id: totrans-380
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'The *variance between* for an *F*-test has a similar formula:'
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: '*F*检验中的*组间方差*有类似的公式：'
- en: '![The F-statistic](img/7180OS_02_20.jpg)'
  id: totrans-382
  prefs: []
  type: TYPE_IMG
  zh: '![F统计量](img/7180OS_02_20.jpg)'
- en: 'Here, *SST* is the *total sum of squares* and *SSW* is the value we just calculated.
    The total sum of the squares is the sum of squared differences from the "grand"
    mean that can be calculated like this:'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*SST*是*总平方和*，*SSW*是我们刚刚计算的值。总平方和是从“总体”均值的平方差的总和，可以这样计算：
- en: '![The F-statistic](img/7180OS_02_21.jpg)'
  id: totrans-384
  prefs: []
  type: TYPE_IMG
  zh: '![F统计量](img/7180OS_02_21.jpg)'
- en: 'Thus, *SST* is simply the overall sum of the squares without any grouping.
    We can calculate both the SST and SSW in Clojure, like this:'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，*SST*只是没有任何分组的整体平方和。我们可以在Clojure中像这样计算*SST*和*SSW*：
- en: '[PRE44]'
  id: totrans-386
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: The *F*-statistic is calculated as the ratio of the variance between and the
    variance within the groups. Combining both our `ssb` and `ssw` functions defined
    previously and the two degrees of freedom, we can calculate the *F*-statistic
    in Clojure as follows.
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: '*F*统计量是通过组间方差与组内方差的比率来计算的。结合之前定义的`ssb`和`ssw`函数以及两个自由度，我们可以在Clojure中按如下方式计算*F*统计量。'
- en: 'Thus, we can calculate the *F*-statistic from our groups and our two degrees
    of freedom as follows:'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以通过以下方式从我们的各组和两个自由度计算*F*统计量：
- en: '[PRE45]'
  id: totrans-389
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Now that we can calculate the *F*-statistic from our groups, we're ready to
    use it in an *F*-test.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以从各组计算出*F*统计量，准备在*F*检验中使用它。
- en: The F-test
  id: totrans-391
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*F*检验'
- en: As with all of the hypothesis tests we have looked at in this chapter, once
    we have a statistic and a distribution, we simply need to pick a value of *α*
    and see if our data has exceeded the critical value for the test.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 和我们在本章中查看的所有假设检验一样，一旦我们有了统计量和分布，我们只需要选择一个*α*值，并查看我们的数据是否超出了该检验的临界值。
- en: 'Incanter provides an `s/f-test` function, but this only measures the variance
    between and within the two groups. To run an *F*-test on our 20 different groups,
    we will need to implement our own *F*-test function. Fortunately, we''ve already
    done the hard work in the previous sections by calculating an appropriate *F*-statistic.
    We can perform the *F*-test by looking up the *F*-statistic in an *F*-distribution
    parameterized with the correct degrees of freedom. In the following code, we will
    write an `f-test` function, which uses this to perform the test on an arbitrary
    number of groups:'
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: Incanter提供了一个` s/f-test`函数，但它仅衡量两组间和组内的方差。为了对我们20个不同的组进行*F*检验，我们需要实现自己的*F*检验函数。幸运的是，我们已经通过计算合适的*F*统计量，在前面的部分做了很多繁重的工作。我们可以通过查找*F*统计量并使用带有正确自由度的*F*分布来执行*F*检验。在下面的代码中，我们将编写一个`f-test`函数，利用它对任意数量的组执行检验：
- en: '[PRE46]'
  id: totrans-394
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'In the last line of the preceding function, we convert the value of the *F*-statistic
    into a *p*-value using Incanter''s `s/cdf-f` function parameterized by the correct
    degrees of freedom. This *p*-value is a measure of the whole model, how well the
    different pages explain the variance of the dwell times overall. All that remains
    for us to do is to choose a significance level and run the test. Let''s stick
    with a 5 percent significance level:'
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 在前述函数的最后一行，我们使用Incanter的`s/cdf-f`函数，并根据正确的自由度将*F*统计量转换为*p*值。这个*p*值是对整个模型的度量，表明不同页面如何解释总体停留时间的方差。我们需要做的就是选择一个显著性水平并运行测试。我们暂时选择5%的显著性水平：
- en: '[PRE47]'
  id: totrans-396
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: The test returns a *p*-value of 0.014, which is a significant result. The different
    pages indeed have different variances that cannot simply be explained away by
    random sampling error alone.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 该测试返回了一个*p*值为0.014，这是一个显著的结果。不同的页面确实有不同的方差，不能仅仅通过随机抽样误差来解释。
- en: '![The F-test](img/7180OS_02_260.jpg)'
  id: totrans-398
  prefs: []
  type: TYPE_IMG
  zh: '![F检验](img/7180OS_02_260.jpg)'
- en: 'We could use a box plot to visualize the distributions of each site together
    in one chart to compare them side by side:'
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用箱线图将每个网站的分布一起可视化，并将它们并排进行比较：
- en: '[PRE48]'
  id: totrans-400
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: In the preceding code, we reduce over the groups, calling `c/add-box-plot` for
    each group. The groups are sorted by their site ID before plotting, so our original
    page 0 is to the extreme left of the chart.
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的代码中，我们对各组进行遍历，为每个组调用`c/add-box-plot`。在绘制前，组按其网站ID进行排序，因此我们的原始页面0位于图表的最左侧。
- en: '![The F-test](img/7180OS_02_270.jpg)'
  id: totrans-402
  prefs: []
  type: TYPE_IMG
  zh: '![F检验](img/7180OS_02_270.jpg)'
- en: 'It might appear that site ID `10` has the longest dwell times, since its interquartile
    range extends furthest up the chart. However, if you look closely, you''ll see
    its mean value is lower than site 6, having a mean dwell time of over 144 seconds:'
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来网站ID `10`的停留时间最长，因为其四分位距在图表上延伸得最远。然而，如果仔细观察，你会发现它的均值低于网站6，停留时间的平均值超过144秒：
- en: '[PRE49]'
  id: totrans-404
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'Now that we have confirmed a statistically significant effect using the *F*-test,
    we''re justified in claiming that site ID `6` is statistically different from
    the baseline:'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经通过*F*检验确认了统计显著效应，我们有理由宣称网站ID `6`在统计上与基准存在差异：
- en: '[PRE50]'
  id: totrans-406
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: Finally, we have evidence to suggest that page ID 6 is a genuine improvement
    over the current site. As a result of our analysis, the AcmeContent CEO authorizes
    the launch of a new look website. The web team is delighted!
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，我们有证据表明，页面ID 6相较于当前网站确实有所改进。根据我们的分析，AcmeContent的CEO授权启动新版本的网站。网络团队感到非常高兴！
- en: Effect size
  id: totrans-408
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 效应大小
- en: In this chapter, we focused on statistical significance—the methods employed
    by statisticians to ensure a difference is discovered, which cannot be easily
    explained as chance variation. We must always remember that finding a significant
    effect isn't the same as finding a large effect. With very large samples, even
    a tiny difference in sample means will count as significant. To get a better sense
    of whether our discovery is both significant and important, we should state the
    effect size as well.
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们集中讨论了统计显著性——统计学家用来确保发现的差异不能简单地归因于随机变异的方法。我们必须始终记住，发现显著效应并不等同于发现大效应。在非常大的样本中，即使样本均值之间的差异很小，也会被视为显著。为了更好地了解我们的发现是否既显著又重要，我们还应当陈述效应大小。
- en: Cohen's d
  id: totrans-410
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Cohen's d
- en: 'Cohen''s d is an adjustment that can be applied to see whether the difference
    we have observed is not just statistically significant, but actually large. Like
    the Bonferroni correction, the adjustment is a straightforward one:'
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: Cohen's d是一个调整指标，可以帮助我们判断我们观察到的差异不仅是统计显著的，而且实际上很大。类似于Bonferroni校正，这个调整非常简单：
- en: '![Cohen''s d](img/7180OS_02_22.jpg)'
  id: totrans-412
  prefs: []
  type: TYPE_IMG
  zh: '![Cohen''s d](img/7180OS_02_22.jpg)'
- en: 'Here, *S[ab]* is the pooled standard deviation (not the pooled standard error)
    of the samples. It can be calculated in a way similar to the pooled standard error:'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，*S[ab]*是样本的合并标准差（而非合并标准误）。它的计算方式类似于合并标准误：
- en: '[PRE51]'
  id: totrans-414
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Thus, we can calculate Cohen''s d for our page 6, as follows:'
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以计算页面6的Cohen's d，如下所示：
- en: '[PRE52]'
  id: totrans-416
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: In contrast with the *p*-values, there is no absolute threshold for Cohen's
    d. Whether an effect can be considered large is partly dependent on the context,
    but it does provide a useful, normalized measure of the effect size. Values above
    0.5 are typically considered large, so 0.38 is a moderate effect. It certainly
    represents a meaningful increase in the dwell time on our site and is certainly
    worth the effort of a site upgrade.
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 与*p*值相比，Cohen's d 没有绝对的阈值。一个效应是否可以被认为是大的，部分取决于具体背景，但它确实提供了一个有用的、标准化的效应大小度量。大于
    0.5 的值通常被认为是大的，因此 0.38 是一个适度的效应。它无疑代表了我们网站停留时间的显著增加，值得为网站升级付出努力。
- en: Summary
  id: totrans-418
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we've learned about the difference between descriptive and
    inferential statistics. Once again, we've seen the importance of normal distribution
    and the central limit theorem, and learned how to quantify population differences
    with *z*-tests, *t*-tests, and *F*-tests.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了描述性统计和推断性统计的区别。我们再次看到了正态分布和中心极限定理的重要性，并了解了如何通过*z*检验、*t*检验和*F*检验量化总体差异。
- en: We've learned about how the techniques of inferential statistics analyze the
    samples themselves to make claims about the population that was sampled. We've
    seen a variety of techniques—confidence intervals, bootstrapping, and significance
    tests—that can yield insight into the underlying population parameters. By simulating
    repeated tests with ClojureScript, we've also gained an insight into the difficulty
    of significance testing with multiple comparisons and seen how the *F*-test attempts
    to address the issue and strike a balance between Type I and Type II errors.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 我们了解了推断统计学的技巧如何通过分析样本本身来对所抽样的总体做出推断。我们见识了各种技术——置信区间、重抽样法和显著性检验——这些都能提供有关潜在总体参数的见解。通过使用
    ClojureScript 模拟重复的测试，我们还洞察了多重比较中的显著性检验困难，并看到*F*检验如何试图解决这一问题，在第一类和第二类错误之间找到平衡。
- en: In the next chapter, we'll apply the lessons we've learned on variance and *F*-testing
    to single samples. We'll introduce the technique of regression analysis and use
    it to find correlations among variables within a sample of Olympic athletes.
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将把在方差和*F*检验中学到的知识应用到单个样本中。我们将介绍回归分析技术，并使用它来寻找奥林匹克运动员样本中变量之间的相关性。
