- en: Chapter 2. Viewing Spatial Data
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二章 查看空间数据
- en: In this chapter, we will cover how to view spatial data from different data
    sources. QGIS supports many file and database formats as well as OGC Web Services.
    We will first see how we can load layers from these different data sources. We
    will then look into the basics of styling both vector and raster layers and will
    create our first map, which you can see in the following screenshot. We will finish
    this chapter with an example for loading background maps from online services.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将介绍如何从不同的数据源查看空间数据。QGIS支持许多文件和数据库格式以及OGC网络服务。我们将首先了解如何从这些不同的数据源加载图层。然后我们将探讨矢量图层和栅格图层的基本样式，并创建我们的第一个地图，你可以在下面的屏幕截图中看到。我们将以从在线服务加载背景地图的示例结束本章。
- en: '![Viewing Spatial Data](img/7488_02_01.jpg)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![查看空间数据](img/7488_02_01.jpg)'
- en: Note
  id: totrans-3
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For the examples in this chapter, we will be using sample data provided by the
    QGIS project and available for download from [download.osgeo.org/qgis/data/qgis_sample_data.zip](http://download.osgeo.org/qgis/data/qgis_sample_data.zip)
    (20 MB). Download and unzip it.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本章的示例，我们将使用由QGIS项目提供的样本数据，并可以从[download.osgeo.org/qgis/data/qgis_sample_data.zip](http://download.osgeo.org/qgis/data/qgis_sample_data.zip)（20
    MB）下载。下载并解压它。
- en: Loading vector data from files
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从文件加载矢量数据
- en: In this section, we will talk about loading vector data from GIS formats such
    as Shapefiles as well as from text files.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将讨论从GIS格式，如Shapefiles以及文本文件中加载矢量数据。
- en: 'We can load vector files using the menu entry by going to **Layer** | **Add
    vector layer** and also by using the **Add vector layer** toolbar button. If you
    like shortcuts, use *Ctrl* + *Shift* + *V*. In the **Add vector layer** dialog,
    we find a drop-down list that allows us to specify the encoding of the input file.
    This option is important if we are dealing with files that contain special characters,
    such as German umlauts or letters from alphabets other than the default Latin
    one. The following screenshot shows the **Add vector layer** dialog:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过转到**图层** | **添加矢量图层**以及使用**添加矢量图层**工具栏按钮来加载矢量文件。如果你喜欢快捷方式，可以使用*Ctrl* +
    *Shift* + *V*。在**添加矢量图层**对话框中，我们找到一个下拉列表，允许我们指定输入文件的编码。如果我们处理包含特殊字符的文件，例如德语的重音符号或其他非默认拉丁字母表中的字母，此选项很重要。以下屏幕截图显示了**添加矢量图层**对话框：
- en: '![Loading vector data from files](img/7488_02_02.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![从文件加载矢量数据](img/7488_02_02.jpg)'
- en: What we are most interested in now is the **Browse** button, which opens the
    file-opening dialog. Note the **file type filter** drop-down list on the bottom-right
    corner of the dialog. We can open it to see a list of the supported vector file
    types. This filter is useful to find specific files faster by hiding all files
    of a different type, but be aware that the filter settings are stored and will
    be applied again the next time we open the dialog.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在最感兴趣的是**浏览**按钮，它打开文件打开对话框。注意对话框右下角的**文件类型过滤器**下拉列表。我们可以打开它，查看支持的矢量文件类型列表。此过滤器通过隐藏不同类型的所有文件，有助于更快地找到特定文件，但请注意，过滤器设置将被存储，并在我们下次打开对话框时再次应用。
- en: This can be a source of confusion if we later try to find a different file and
    it happens to be hidden by the filter, so remember to check the filter settings
    if you are having trouble locating a file.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们后来试图找到不同的文件，而它恰好被过滤器隐藏，这可能会引起混淆，所以请记住，如果你在查找文件时遇到困难，要检查过滤器设置。
- en: We can load more than one file in one go by selecting multiple files at once
    (holding down *Ctrl* on Windows/Ubuntu or *Cmd* on Mac). Let's give it a try.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过一次选择多个文件来一次性加载多个文件（在Windows/Ubuntu上按住*Ctrl*或在Mac上按住*Cmd*）。让我们试一试。
- en: We select `alaska.shp` and `airports.shp` from the sample data `vmap0_shapefiles`
    folder.
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们从样本数据文件夹`vmap0_shapefiles`中选择`alaska.shp`和`airports.shp`。
- en: Next, we confirm our selection by clicking on **Open**, and we are taken back
    to the **Add vector layer** dialog.
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们通过点击**打开**来确认我们的选择，然后我们返回到**添加矢量图层**对话框。
- en: After clicking on **Open** once more, the selected files are loaded. You will
    notice that each vector layer is displayed in a random color. Don't worry about
    that now. We'll deal with layer styles later in this chapter.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次点击**打开**后，选定的文件将被加载。你会注意到每个矢量层都显示为随机颜色。现在不用担心这个。我们将在本章后面处理图层样式。
- en: Tip
  id: totrans-15
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: There are multiple tricks that make loading data even faster; for example, you
    can simply drag and drop files from the operating system file browser into QGIS.
    Another way to quickly access your spatial data is by using QGIS' built-in file
    browser. If you set up QGIS as shown in [Chapter 1](ch01.html "Chapter 1. Getting
    Started with QGIS"), *Getting Started with QGIS*, you'll find the browser on the
    left-hand side, just below the layer list. Navigate to your data folder and you
    can again drag and drop files from the browser to the map. Additionally, you can
    mark a folder as favorite by right-clicking on the folder and selecting **Add
    to favorites**. This way, your data folders will be even faster to access because
    they are added in the **Favorites** section right at the top of the browser list.
  id: totrans-16
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 有多种技巧可以使加载数据更快；例如，您可以直接从操作系统文件浏览器中将文件拖放到 QGIS 中。另一种快速访问您的空间数据的方法是使用 QGIS 内置的文件浏览器。如果您按照[第
    1 章](ch01.html "第 1 章。QGIS 入门")中所示设置 QGIS，即“QGIS 入门”，您会发现浏览器位于左侧，位于图层列表下方。导航到您的数据文件夹，您可以从浏览器中将文件再次拖放到地图上。此外，您可以通过右键单击文件夹并选择**添加到收藏夹**来标记文件夹为收藏夹。这样，您的数据文件夹将更快地访问，因为它们被添加到浏览器列表顶部的**收藏夹**部分。
- en: Another popular source of spatial data are delimited text (CSV) files. QGIS
    can load CSV files using the **Add Delimited Text Layer** option available via
    the menu entry by going to **Layers** | **Add Delimited Text Layer** or the corresponding
    toolbar button. Click on **Browse** and select `elevp.csv` from the sample data.
    CSVs come with all kinds of delimiters. As you can see in the following screenshot,
    the plugin lets you choose from the most common ones (**Comma**, **Tab**, and
    so on), but you can also specify any other plain or regular expression delimiter.
    If your CSV contains quotation marks such as " or ', you can use the **Quote**
    option to have them removed. The **Number of header lines to discard** option
    allows us to skip extra lines at the beginning of the text file. The following
    **Field options** include functionality to trim extra spaces from field values
    or to redefine the decimal separator to a comma. The spatial information itself
    can be provided either in two columns containing coordinates of points X and Y
    or by using the **Well known text (WKT)** format. A WKT field can contain points,
    lines, or polygons.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个流行的空间数据来源是分隔文本（CSV）文件。QGIS 可以通过**添加分隔文本图层**选项加载 CSV 文件，该选项可通过**图层**|**添加分隔文本图层**或相应的工具栏按钮访问。点击**浏览**并从示例数据中选择
    `elevp.csv`。CSV 包含各种分隔符。如图所示，插件允许您从最常见的选择中选取（**逗号**、**制表符**等），但您也可以指定任何其他纯文本或正则表达式分隔符。如果您的
    CSV 包含引号，如 " 或 '，您可以使用**引号**选项来移除它们。**要丢弃的标题行数**选项允许我们跳过文本文件开头的额外行。以下**字段选项**包括从字段值中删除额外空格或重新定义小数分隔符为逗号的功能。空间信息本身可以由包含点
    X 和 Y 坐标的两列提供，或者使用**已知文本 (WKT)**格式。WKT 字段可以包含点、线或多边形。
- en: Tip
  id: totrans-18
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: WKT is a very useful and flexible format. For example, a line can be specified
    by writing `LINESTRING (30 10, 10 30, 40 40)`. If you are unfamiliar with the
    concept, you can find an introduction with examples at [en.wikipedia.org/wiki/Well-known_text](http://en.wikipedia.org/wiki/Well-known_text).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: WKT 是一个非常有用且灵活的格式。例如，一条线可以通过编写 `LINESTRING (30 10, 10 30, 40 40)` 来指定。如果您不熟悉这个概念，您可以在
    [en.wikipedia.org/wiki/Well-known_text](http://en.wikipedia.org/wiki/Well-known_text)
    找到带有示例的介绍。
- en: '![Loading vector data from files](img/7488_02_03.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![从文件加载矢量数据](img/7488_02_03.jpg)'
- en: After clicking on **OK**, QGIS will prompt us to specify the layer's **coordinate
    reference system** (**CRS**). We will talk about handling coordinate reference
    systems next.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**确定**后，QGIS 将提示我们指定图层的**坐标参考系统**（**CRS**）。我们将在下一节讨论处理坐标参考系统。
- en: Dealing with coordinate reference systems
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 处理坐标参考系统
- en: Whenever we load a data source, QGIS looks for usable CRS information; for example,
    in the Shapefile's `.prj` file. If QGIS cannot find any usable information, it
    will by default ask you to specify the CRS manually. This behavior can be changed
    by going to **Settings** | **Options** | **CRS** to always use either the project
    CRS or a default CRS.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 每次我们加载数据源时，QGIS 都会寻找可用的 CRS 信息；例如，在 Shapefile 的 `.prj` 文件中。如果 QGIS 找不到任何可用的信息，它将默认提示您手动指定
    CRS。此行为可以通过转到**设置**|**选项**|**CRS**来更改，始终使用项目 CRS 或默认 CRS。
- en: 'The QGIS Coordinate Reference System Selector offers a filter that makes finding
    the CRS easier. It can filter by name or by ID (for example, the EPSG code). Just
    start typing and watch how the list of potential CRSs gets shorter. There are
    actually two separate lists: the upper one contains the CRSs we have recently
    used while the lower list is much longer and contains all available CRSs. For
    the `elevp.csv` file, we select **NAD27 / Alaska Albers**.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS坐标参考系统选择器提供了一个过滤器，使查找CRS变得更容易。它可以按名称或按ID（例如，EPSG代码）过滤。只需开始输入，看看潜在CRS列表是如何变短的。实际上有两个独立的列表：上面的列表包含我们最近使用的CRS，而下面的列表更长，包含所有可用的CRS。对于`elevp.csv`文件，我们选择**NAD27
    / 阿拉斯加阿尔伯斯**。
- en: If we want to check a layer's CRS, we can find this information in the layer
    properties' **General** section, which can be accessed by going to **Layer** |
    **Properties** or by double-clicking on the layer name in the layer list. If you
    think that QGIS picked the wrong CRS or you made a mistake specifying the CRS,
    you can correct the CRS settings using **Specify CRS**. Note that this does not
    change the underlying data or reproject it. We'll talk about reprojecting vectors
    and raster files in [Chapter 3](ch03.html "Chapter 3. Data Creation and Editing"),
    *Data Creation and Editing*.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想检查一个层的CRS，我们可以在层属性**常规**部分找到这个信息，可以通过转到**图层** | **属性**或通过在图层列表中双击图层名称来访问。如果您认为QGIS选择了错误的CRS或您在指定CRS时犯了错误，您可以使用**指定CRS**来纠正CRS设置。请注意，这不会更改底层数据或重新投影它。我们将在[第3章](ch03.html
    "第3章。数据创建和编辑")中讨论重新投影矢量和栅格文件，*数据创建和编辑*。
- en: 'In QGIS, we can create a map out of multiple layers even if each dataset is
    stored with a different CRS. QGIS handles the necessary reprojections automatically
    by enabling a mechanism called on-the-fly reprojection, which can be accessed
    by going to **Settings** | **Project Properties** as you can see in the following
    screenshot:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在QGIS中，即使每个数据集存储的CRS不同，我们也可以从多个图层创建地图。QGIS通过启用一个称为即时重投影的机制来自动处理必要的重投影，您可以通过转到**设置**
    | **项目属性**来访问它，如下面的截图所示：
- en: All layers are reprojected to the project CRS on the fly, which means that QGIS
    calculates these reprojections dynamically and only for the purpose of rendering
    the map. The underlying data is not changed and spatial analyses are not affected.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 所有图层都会即时重投影到项目CRS，这意味着QGIS会动态地计算这些重投影，并且只为渲染地图的目的。底层数据不会改变，空间分析也不会受到影响。
- en: '![Dealing with coordinate reference systems](img/7488_02_04.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![处理坐标参考系统](img/7488_02_04.jpg)'
- en: In some cases, you might have to specify a CRS that is not available in QGIS'
    CRS database. You can add CRS definitions by going to **Settings** | **Custom
    CRS**. Click on the **Add new CRS** button to create a new entry, type in a name
    for the new CRS, and paste the `proj4` definition string. Just close the dialog
    by clicking on **OK** when you are done.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些情况下，您可能需要指定QGIS坐标系数据库中不可用的CRS。您可以通过转到**设置** | **自定义坐标系**来添加CRS定义。点击**添加新CRS**按钮创建新条目，为新的CRS输入一个名称，并粘贴`proj4`定义字符串。完成操作后，只需点击**确定**关闭对话框。
- en: Loading raster files
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加载栅格文件
- en: Loading raster files is not much different from loading vector files. Selecting
    the menu entry **Layer** and then clicking on **Add Raster Layer**, clicking on
    the **Add Raster Layer** button, or pressing the *Ctrl* + *Shift* + *R* shortcut
    will take you directly to the file-opening dialog. Again, you can check the file
    type filter to see a list of supported file types.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 加载栅格文件与加载矢量文件没有太大区别。选择**图层**菜单项，然后点击**添加栅格图层**，点击**添加栅格图层**按钮，或按*Ctrl* + *Shift*
    + *R*快捷键将直接带您到文件打开对话框。再次提醒，您可以通过检查文件类型过滤器来查看支持的文件类型列表。
- en: Let's give it a try and load `landcover.img` from the sample data `raster` folder.
    Similarly, just like vector files, you can load rasters by dragging them into
    QGIS from the operating system or the built-in file browser.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们试一试，从样本数据`raster`文件夹中加载`landcover.img`。同样，就像矢量文件一样，您可以通过从操作系统或内置文件浏览器拖动它们到QGIS中来加载栅格文件。
- en: Note
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Support for all these different vector and raster file types in QGIS is handled
    by the powerful GDAL/OGR package. You can check the full list of supported formats
    at [www.gdal.org/formats_list.html](http://www.gdal.org/formats_list.html) (for
    rasters) and [www.gdal.org/ogr/ogr_formats.html](http://www.gdal.org/ogr/ogr_formats.html)
    (for vectors).
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS中所有这些不同类型的向量和栅格文件类型都由强大的GDAL/OGR包处理。您可以在[www.gdal.org/formats_list.html](http://www.gdal.org/formats_list.html)（栅格）和[www.gdal.org/ogr/ogr_formats.html](http://www.gdal.org/ogr/ogr_formats.html)（向量）查看支持的完整格式列表。
- en: Georeferencing raster maps
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 地理配准栅格地图
- en: Some raster data sources, such as simple scanned maps, lack proper spatial referencing,
    and we have to georeference them before we can use them in a GIS. In QGIS, we
    can georeference rasters using the Georeferencer GDAL plugin, which can be accessed
    by going to **Raster** | **Georeferencer** (enable it by going to **Plugins**
    | **Manage and Install Plugins** if you cannot find it in the **Raster** menu).
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 一些栅格数据源，如简单的扫描地图，缺乏适当的空间参考，我们必须在将它们用于GIS之前对其进行地理配准。在QGIS中，我们可以使用地理配准器GDAL插件来地理配准栅格，该插件可以通过转到**栅格**
    | **地理配准**访问（如果无法在**栅格**菜单中找到，请通过转到**插件** | **管理并安装插件**来启用它）。
- en: 'Georeferencer covers the following use cases:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 地理配准器涵盖了以下用例：
- en: We can create a world file for a raster file without altering the original raster.
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以为栅格文件创建一个世界文件，而不会改变原始栅格。
- en: If we have a map image that contains points with known coordinates, we can set
    **ground control points** (**GCPs**) and enter the known coordinates.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果我们有一个包含已知坐标点的地图图像，我们可以设置**地面控制点**（**GCPs**）并输入已知坐标。
- en: Finally, if we don't know the coordinates of any points on the map, we still
    have the chance to place GCPs manually using a second, already georeferenced map
    of the same area. We can use objects that are visible in both maps to pick points
    in the map that we want to georeference and work out their coordinates from the
    reference map.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，如果我们不知道地图上任何点的坐标，我们仍然有机会使用同一区域的第二个已地理配准的地图手动放置GCPs。我们可以使用在两个地图中都可见的对象来选择我们想要地理配准的点，并从参考地图中确定它们的坐标。
- en: After loading a raster into Georeferencer by going to **File** | **Open raster**
    or using the **Open raster** toolbar button, we are asked to specify the CRS of
    the ground control points we are planning to add. Next, we can start adding ground
    control points by going to **Edit** | **Add point**. We can use the pan and zoom
    tools to navigate and we can place GCPs by clicking on the map. We are then prompted
    to insert the coordinates of the new point or pick them from the reference map
    in the main QGIS window.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 通过转到**文件** | **打开栅格**或使用**打开栅格**工具栏按钮，将栅格加载到地理配准器中后，我们会要求指定我们计划添加的地面控制点的CRS。接下来，我们可以通过转到**编辑**
    | **添加点**来开始添加地面控制点。我们可以使用平移和缩放工具进行导航，并通过在地图上点击来放置GCPs。然后，我们会提示输入新点的坐标或从主QGIS窗口中的参考地图中选择它们。
- en: After placing the GCPs, we can define the transformation algorithm by going
    to **Settings** | **Transformation Settings**. Which algorithm you choose depends
    on your input data and the level of geometric distortion you want to allow. The
    most commonly used algorithms are polynomial 1 to 3\. A first-order polynomial
    transformation allows scaling, translation, and rotation only.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 放置GCPs后，我们可以通过转到**设置** | **变换设置**来定义变换算法。您选择哪种算法取决于您的输入数据和您想要允许的几何畸变程度。最常用的算法是多项式1到3。一阶多项式变换仅允许缩放、平移和旋转。
- en: A second-order polynomial transformation can handle some curvature, and a third-order
    polynomial transformation consequently allows for even higher degrees of distortion.
    The thin-plate spline algorithm can handle local deformations in the map, and
    is therefore very useful when working with very low-quality map scans. The linear
    option, on the other hand, is only used to create world files, and as mentioned
    previously, this does not actually transform the raster.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 二阶多项式变换可以处理一些曲率，而三阶多项式变换则允许更高的畸变程度。薄板样条算法可以处理地图中的局部变形，因此在处理非常低质量的地图扫描时非常有用。另一方面，线性选项仅用于创建世界文件，如前所述，这实际上并不变换栅格。
- en: The resampling method depends on your input data and the result you want to
    achieve. Cubic resampling creates smooth results, but if you don't want to change
    the raster values, choose the nearest neighbor method.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 重采样方法取决于您的输入数据和您想要实现的结果。立方重采样创建平滑的结果，但如果您不想更改栅格值，请选择最近邻方法。
- en: Before we can start the georeferencing process, we still have to specify the
    output file name and target CRS. Make sure that the **Load in QGIS when done**
    option is active. Then, we can close the **Transformation Settings** dialog and
    go to **File** | **Start Georeferencing**. The georeferenced raster will automatically
    be loaded into the QGIS main map window.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始地理配准过程之前，我们仍然需要指定输出文件名和目标坐标参考系统。确保 **完成时加载到 QGIS 中** 选项处于激活状态。然后，我们可以关闭
    **变换设置** 对话框，转到 **文件** | **开始地理配准**。地理配准的栅格将自动加载到 QGIS 主地图窗口中。
- en: Loading data from databases
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从数据库加载数据
- en: 'QGIS supports PostGIS, SpatiaLite, MSSQL, SQL Anywhere, and Oracle Spatial
    databases. We will cover the two open source options: PostGIS and SpatiaLite.
    Both are available cross-platform, just like QGIS.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS 支持 PostGIS、SpatiaLite、MSSQL、SQL Anywhere 和 Oracle Spatial 数据库。我们将介绍两种开源选项：PostGIS
    和 SpatiaLite。这两个选项都支持跨平台，就像 QGIS 一样。
- en: '**SpatiaLite** is the spatial extension for Sqlite databases. Sqlite is a self-contained,
    serverless, zero-configuration, transactional SQL database engine ([www.sqlite.org](http://www.sqlite.org)).
    This basically means that an Sqlite database, and therefore also a SpatiaLite
    database, doesn''t need a server installation, and can be copied and exchanged
    just like any ordinary file.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '**SpatiaLite** 是 Sqlite 数据库的空间扩展。Sqlite 是一个自包含的、无服务器的、零配置的事务性 SQL 数据库引擎 ([www.sqlite.org](http://www.sqlite.org))。这基本上意味着
    Sqlite 数据库，因此也是 SpatiaLite 数据库，不需要服务器安装，可以像任何普通文件一样复制和交换。'
- en: 'You can download an example database from [www.gaia-gis.it/spatialite-2.3.1/test-2.3.zip](http://www.gaia-gis.it/spatialite-2.3.1/test-2.3.zip).
    Unzip the file; you will be able to connect to it by going to **Layer** | **Add
    SpatiaLite Layer**, using the **Add SpatiaLite Layer** toolbar button, or by pressing
    *Ctrl* + *Shift* + *L*. Click on **New** to select the database file `test-2.3.sqlite`.
    QGIS will save all connections and add them to the drop-down list at the top.
    After clicking on **Connect**, you will see the list of layers stored in the database
    as shown in the following screenshot:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从 [www.gaia-gis.it/spatialite-2.3.1/test-2.3.zip](http://www.gaia-gis.it/spatialite-2.3.1/test-2.3.zip)
    下载示例数据库。解压文件；您可以通过转到 **图层** | **添加 SpatiaLite 图层**，使用 **添加 SpatiaLite 图层** 工具栏按钮，或按
    *Ctrl* + *Shift* + *L* 来连接到它。单击 **新建** 选择数据库文件 `test-2.3.sqlite`。QGIS 将保存所有连接并将它们添加到顶部的下拉列表中。在单击
    **连接** 后，您将看到数据库中存储的图层列表，如下面的截图所示：
- en: '![Loading data from databases](img/7488_02_05.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![从数据库加载数据](img/7488_02_05.jpg)'
- en: Like with files, you can select one or more tables from the list and click on
    **Add** to load them into the map. Additionally, you can use **Set Filter** to
    load only specific features.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 与文件一样，您可以从列表中选择一个或多个表，然后单击 **添加** 将它们加载到地图中。此外，您还可以使用 **设置过滤器** 仅加载特定要素。
- en: Tip
  id: totrans-52
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Filters in QGIS use SQL-like syntax; for example, `"Name" = 'EMILIA-ROMAGNA'`
    to select only the region called EMILIA-ROMAGNA, or `"Name" LIKE 'ISOLA%'` to
    select all regions starting with ISOLA. The filter queries are passed on to the
    underlying data provider (for example, Spatialite or OGR). The provider syntax
    for basic filter queries is consistent over different providers, but can vary
    when using more exotic functions. You can read up on the details of OGR SQL on
    [http://www.gdal.org/ogr/ogr_sql.html](http://www.gdal.org/ogr/ogr_sql.html).
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: QGIS 中的过滤器使用类似 SQL 的语法；例如，`"Name" = 'EMILIA-ROMAGNA'` 用于仅选择名为 EMILIA-ROMAGNA
    的区域，或者 `"Name" LIKE 'ISOLA%'` 用于选择以 ISOLA 开头的所有区域。过滤器查询将传递给底层数据提供者（例如，Spatialite
    或 OGR）。基本过滤器查询的提供者语法在不同提供者之间是一致的，但在使用更复杂的函数时可能会变化。您可以在 [http://www.gdal.org/ogr/ogr_sql.html](http://www.gdal.org/ogr/ogr_sql.html)
    上查阅 OGR SQL 的详细信息。
- en: '**PostGIS** is the spatial extension for the PostgreSQL database system. Installing
    and configuring the database is out of the scope of this book, but there are installers
    for Windows and packages for many Linux distributions as well as for Mac. To load
    data from a PostGIS database, go to **Layers** | **Add PostGIS Layer**, use the
    **Add PostGIS Layer** toolbar button, or press *Ctrl* + *Shift* + *D*.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**PostGIS** 是 PostgreSQL 数据库系统的空间扩展。安装和配置数据库超出了本书的范围，但提供了 Windows 的安装程序以及许多
    Linux 发行版和 Mac 的软件包。要从 PostGIS 数据库加载数据，请转到 **图层** | **添加 PostGIS 图层**，使用 **添加
    PostGIS 图层** 工具栏按钮，或按 *Ctrl* + *Shift* + *D*。'
- en: 'When using a database for the first time, click on **New** to establish a new
    database connection. In the following dialog, you can specify a **Name** for the
    new connection. Other fields that have to be filled are as follows:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 当首次使用数据库时，点击**新建**以建立新的数据库连接。在以下对话框中，您可以指定新连接的**名称**。其他需要填写的字段如下：
- en: '**Host**: The server''s IP address is inserted in this field. You can use localhost
    if PostGIS is running locally.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机**：服务器的IP地址将插入到此字段。如果PostGIS在本地运行，您可以使用localhost。'
- en: '**Port**: The PostGIS default port is 5432.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**端口**：PostGIS默认端口是5432。'
- en: '**Database**: This is the name of the PostGIS database you want to connect
    to.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据库**：这是您想要连接的PostGIS数据库名称。'
- en: '**Username** and **Password**: For convenience, you can tell QGIS to save them.![Loading
    data from databases](img/7488_02_06.jpg)'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**用户名**和**密码**：为了方便，您可以告诉QGIS保存它们。![从数据库加载数据](img/7488_02_06.jpg)'
- en: 'The following screenshot shows the dialog to create a new connection to a database
    called **postgis**:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了创建到名为**postgis**的数据库的新连接的对话框：
- en: After the connection is established, you can load and filter tables just like
    we discussed for SpatiaLite.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 建立连接后，您可以像我们之前讨论的SpatiaLite那样加载数据和过滤表格。
- en: Loading data from web services
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从网络服务加载数据
- en: More and more data providers offer access to their datasets via OGC-compliant
    web services such as WMS, WCS, or WFS. QGIS supports these services out-of-the-box.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 越来越多的数据提供者通过OGC兼容的Web服务（如WMS、WCS或WFS）提供对他们的数据集的访问。QGIS支持这些服务。
- en: You can load WMS layers by going to **Layer** | **Add WMS Layer**, by clicking
    on the **Add WMS Layer** button, or by pressing *Ctrl* + *Shift* + *W*. If you
    know a WMS server, you can connect to it by clicking on **New** and filling in
    a name and the URL. All other fields are optional. Don't worry if you don't know
    of any WMS server, because we can simply click on **Add default servers** to get
    access information about servers whose administrators collaborate with the QGIS
    project. One of these servers is called **Lizardtech server**. Select it, or any
    of the other servers, from the drop-down box and click on **Connect** to see the
    list of layers available through the server.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过转到**图层** | **添加WMS图层**，点击**添加WMS图层**按钮，或按*Ctrl* + *Shift* + *W*来加载WMS图层。如果您知道一个WMS服务器，您可以通过点击**新建**并填写名称和URL来连接到它。所有其他字段都是可选的。如果您不知道任何WMS服务器，请不要担心，因为我们只需点击**添加默认服务器**即可获取与QGIS项目合作的管理员的服务器访问信息。其中有一个服务器称为**Lizardtech服务器**。从下拉框中选择它或任何其他服务器，然后点击**连接**以查看通过服务器可用的图层列表。
- en: From the layer list, you can now select one or more layers for download. It
    is worth noting that the order in which you select the layers does matter because
    the layers will be combined on the server side, and QGIS will only receive the
    combined image as the resultant layer. If you want to be able to use the layers
    separately, you have to download them one by one. The data download starts once
    you click on **Add**. The dialog will stay open so that you can add additional
    layers from the server.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 从图层列表中，您现在可以选择一个或多个图层进行下载。值得注意的是，您选择图层的顺序很重要，因为图层将在服务器端合并，QGIS只会接收到合并后的图像作为结果图层。如果您想能够单独使用图层，您必须逐个下载它们。点击**添加**后，数据下载开始。对话框将保持打开状态，以便您可以添加来自服务器的其他图层。
- en: Many WMS servers offer their layers in multiple different CRSs. You can check
    the list of available CRSs by clicking on the **Change** button at the bottom
    of the dialog. This will open a CRS selector dialog, which is limited to the WMS
    server's CRS capabilities.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 许多WMS服务器提供他们的图层以多种不同的CRS。您可以通过点击对话框底部的**更改**按钮来检查可用的CRS列表。这将打开一个CRS选择对话框，该对话框限于WMS服务器的CRS功能。
- en: Loading data from WCS or WFS servers works in the same way, but public servers
    are rare and unreliable, and therefore no recommendation can be provided here.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 从WCS或WFS服务器加载数据的方式相同，但公共服务器很少且不可靠，因此在此无法提供推荐。
- en: Styling raster layers
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 样式栅格图层
- en: After this introduction to data sources, we can now create our first map. We
    will build the map from the bottom up by first loading some background rasters
    (hillshade and land cover), which we will then overlay with point, line, and polygon
    layers.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在介绍完数据源之后，我们现在可以创建我们的第一个地图。我们将从下往上构建地图，首先加载一些背景栅格（阴影和土地覆盖），然后我们将用点、线和多边形图层叠加它们。
- en: Let's start by loading land cover and hillshade from `landcover.img` and `SR_50M_alaska_nad.tif`
    and then opening the **Style** section in layer properties (**Layer** | **Properties**
    or by double-clicking on the layer name). QGIS tries to pick a reasonable default
    render type. The hillshade raster, `SR_50M_alaska_nad.tif`, is loaded with the
    **Singleband gray** render type as you can see in the following screenshot. If
    we want to render the hillshade raster in color instead of grayscale, we can change
    the render type to **Singleband pseudocolor**. In pseudocolor mode, we can create
    color maps either manually or by selecting one of the premade color ramps. But
    let's stick with **Singleband gray** for hillshade for now.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从加载来自`landcover.img`和`SR_50M_alaska_nad.tif`的土地覆盖和阴影层开始，然后打开图层属性的**样式**部分（**图层**
    | **属性**或通过双击图层名称）。QGIS会尝试选择一个合理的默认渲染类型。如您在以下截图中所见，阴影栅格`SR_50M_alaska_nad.tif`以**单波段灰度**渲染类型加载。如果我们想以彩色而不是灰度渲染阴影栅格，我们可以将渲染类型更改为**单波段伪彩色**。在伪彩色模式下，我们可以手动创建颜色图或选择预制的颜色渐变之一。但为了现在，我们还是坚持使用**单波段灰度**来样式阴影。
- en: Below the color settings, we find a section with more advanced options that
    control raster resampling, brightness, contrast, saturation, and hue—options you
    probably know from image processing software. By default, resampling is set to
    the fast **Nearest neighbour** option. To get nice, smoother results, we can change
    to the **Bilinear** or **Cubic** method.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 在颜色设置下方，我们找到一个包含更多高级选项的部分，这些选项控制栅格重采样、亮度、对比度、饱和度和色调——这些选项您可能从图像处理软件中很熟悉。默认情况下，重采样设置为快速的**最近邻**选项。为了获得更平滑的结果，我们可以将其更改为**双线性**或**立方**方法。
- en: Click on **Ok** or **Apply** to confirm. In both cases, the map will be redrawn
    using the new layer style. If you click on **Apply**, the **Layer Properties**
    dialog stays open and you can continue to fine-tune the layer style. If you click
    on **Ok**, the **Layer Properties** dialog is closed.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**确定**或**应用**以确认。在这两种情况下，地图将使用新的图层样式重新绘制。如果您点击**应用**，则**图层属性**对话框保持打开状态，您可以继续微调图层样式。如果您点击**确定**，则**图层属性**对话框将关闭。
- en: '![Styling raster layers](img/7488_02_07.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![样式栅格层](img/7488_02_07.jpg)'
- en: The `landcover.img` raster is a good example of a paletted raster. Each cell
    value is mapped to a specific color. To change a color, we can simply double-click
    on the **Color** preview and a color picker will open.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '`landcover.img`栅格是一个调色板栅格的好例子。每个单元格值都映射到特定的颜色。要更改颜色，我们只需双击**颜色**预览，就会打开颜色选择器。'
- en: 'The style section of a paletted raster looks like the following screenshot:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 一个调色板栅格的样式部分看起来如下截图所示：
- en: '![Styling raster layers](img/7488_02_08.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![样式栅格层](img/7488_02_08.jpg)'
- en: 'If we want to combine hillshade and land cover into one aesthetically pleasing
    background, we can use a combination of the **Blending mode** and layer **Transparency**.
    Blending modes are another feature commonly found in image-processing software.
    The main advantage of blending modes over transparency is that we can avoid the
    usually dull, low-contrast look that results from combining rasters using transparency
    alone. If you haven''t had any experience with blending, take some time to try
    the different effects. For this example, I used the **Darken** blending mode,
    as highlighted in the previous screenshot, together with a global layer transparency
    of **50 %,** as shown in the following screenshot:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想将阴影和土地覆盖组合成一个美观的背景，我们可以使用**混合模式**和图层**透明度**的组合。混合模式是图像处理软件中常见的另一个功能。与透明度相比，混合模式的主要优势是我们可以避免仅使用透明度结合栅格时通常出现的单调、低对比度的外观。如果您没有混合经验，请花些时间尝试不同的效果。在这个例子中，我使用了**变暗**混合模式，如前一个截图所示，以及全局图层透明度**50**%，如下一个截图所示：
- en: '![Styling raster layers](img/7488_02_09.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![样式栅格层](img/7488_02_09.jpg)'
- en: Styling vector layers
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 样式矢量图层
- en: When we load vector layers, QGIS renders them using a default style and a random
    color. Of course, we want to customize these styles to better reflect our data.
    In the following exercises, we will style point, line, and polygon layers, and
    we will also get accustomed with the most common vector styling options.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们加载矢量图层时，QGIS使用默认样式和随机颜色进行渲染。当然，我们希望自定义这些样式以更好地反映我们的数据。在以下练习中，我们将样式点、线和多边形图层，并且我们将熟悉最常见的矢量样式选项。
- en: Creating point styles – an example of an airport style
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建点样式 – 机场样式的例子
- en: Let's get started with a point layer! Load `airport.shp` from our sample data.
    Regardless of the layer's geometry type, we always find a drop-down list with
    the available style options in the upper-left corner of the **Style** dialog.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从点图层开始！从我们的样本数据中加载`airport.shp`。无论图层的几何类型如何，我们总是在**样式**对话框的右上角找到一个包含可用样式选项的下拉列表。
- en: 'The following style options are available for vector layers:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 向量图层有以下样式选项可用：
- en: '**Single Symbol**: This is the simplest option. When we use a Single Symbol
    style, all points are displayed with the same symbol.'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**单个符号**：这是最简单的选项。当我们使用单个符号样式时，所有点都使用相同的符号显示。'
- en: '**Categorized**: This is the style of choice if a layer contains points of
    different categories; for example, a layer containing locations of different animal
    sightings.'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分类**：如果图层包含不同类别的点，则这是首选的样式；例如，包含不同动物观测地点的图层。'
- en: '**Graduated styles**: These are great if we want to visualize numerical values;
    for example, temperature measurements.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**渐变样式**：如果我们想可视化数值，这些样式非常好；例如，温度测量。'
- en: '**Rule-based styles**: These are the most advanced options. These styles are
    very flexible because they allow us to write multiple rules for one layer.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基于规则的样式**：这是最先进的选项。这些样式非常灵活，因为它们允许我们为单个图层编写多个规则。'
- en: '**Point displacement styles**: These are only available for point layers. These
    styles are useful if you need to visualize point layers with multiple points at
    the same coordinates; for example, students of a school living at the same address.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**点位移样式**：这些样式仅适用于点图层。如果您需要可视化具有相同坐标的多个点图层，这些样式很有用；例如，住在同一地址的学校学生。'
- en: Below the drop-down list we find the symbol preview, and below that there is
    the list of symbol layers, which shows us the different layers the symbol consists
    of. On the right-hand side, we find options for the symbol size and size units,
    color and transparency, as well as rotation. Using the **Data defined properties**
    button, we can also tell QGIS to use the feature's attribute values to define
    symbol shape, size, color, and so on. Finally, the bottom-right area contains
    a preview area with saved symbols.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在下拉列表下方，我们找到符号预览，再下方是符号层列表，它显示了符号由哪些不同的层组成。在右侧，我们找到用于符号大小和大小单位、颜色和透明度以及旋转的选项。使用**数据定义属性**按钮，我们还可以告诉QGIS使用要素的属性值来定义符号形状、大小、颜色等。最后，右下角包含一个保存符号的预览区域。
- en: 'Point layers are by default displayed using a simple circle symbol. We want
    to use a symbol of an airplane instead. To change the symbol, select the **Simple
    marker** entry in **Symbol layers**. Notice how the right-hand side of the dialog
    changes. We can now see the options available for simple markers: **Colors**,
    **Size**, **Rotation**, **Form**, and so on. However, we are not looking for circles,
    stars, or square symbols—we want an airplane. That''s why we need to change the
    **Symbol layer type** option from **Simple marker** to **SVG marker**. Many of
    the options are similar, but on the bottom we now find a selection of SVG images
    that we can choose from. Scroll through the list and pick the airplane symbol
    as shown in the following screenshot:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 点图层默认使用简单的圆形符号显示。我们想使用飞机符号。要更改符号，请选择**符号层**中的**简单标记**条目。注意对话框的右侧如何变化。我们现在可以看到简单标记的选项：**颜色**、**大小**、**旋转**、**形状**等。然而，我们不是在寻找圆形、星星或方形符号——我们想要一个飞机。这就是为什么我们需要将**符号层类型**选项从**简单标记**更改为**SVG标记**。许多选项都是相似的，但在底部我们现在可以找到一组SVG图像供我们选择。滚动列表并选择如图所示的飞机符号：
- en: '![Creating point styles – an example of an airport style](img/7488_02_10.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![创建点样式 – 机场样式的示例](img/7488_02_10.jpg)'
- en: 'Symbol layer types for point layers include the following:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 点图层符号层类型包括以下几种：
- en: '**Simple marker**: These include geometric forms such as circles, stars, and
    squares'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**简单标记**：这些包括几何形状，如圆形、星星和方形'
- en: '**Font marker**: These provide access to your symbol fonts'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**字体标记**：这些提供对您的符号字体的访问'
- en: '**SVG marker**: Each QGIS installation comes with a collection of default SVG
    symbols; add your own folders containing SVG images by going to **Settings** |
    **Options** | **System** | **SVG Paths**'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SVG标记**：每个QGIS安装都附带一组默认的SVG符号；通过访问**设置** | **选项** | **系统** | **SVG路径**来添加包含SVG图像的自己的文件夹。'
- en: '**Ellipse marker**: These include customizable ellipses, rectangles, crosses,
    and triangles; especially useful when combined with what we set in the data defined
    settings option'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**椭圆标记器**：这些包括可定制的椭圆、矩形、十字和三角形；特别适用于与我们在数据定义设置选项中设置的内容结合使用'
- en: '**Vector Field marker**: This is a customizable vector-field visualization
    tool'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**矢量场标记器**：这是一个可定制的矢量场可视化工具'
- en: Creating line styles – an example of river or road styles
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建线样式 – 河流或道路样式的示例
- en: 'In this exercise, we will create a river style for the `majriver.shp` file
    in our sample data. The goal is to create a line style with two colors: a fill
    color for the center of the line and an outline color. This technique is very
    useful because it can also be used to create road styles.'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将为我们样本数据中的`majriver.shp`文件创建河流样式。目标是创建一个具有两种颜色的线条样式：线条中心的填充颜色和轮廓颜色。这种技术非常有用，因为它还可以用来创建道路样式。
- en: To create such a style, we combine two simple lines. The default symbol is one
    simple line. Click on the green **+** symbol located below the **Symbol layers**
    list to add another simple line. The lower one will be our outline and the upper
    one will be the fill. Select the upper simple line and change the color to blue
    and the width to 0.3 millimeters. Next, select the lower simple line and change
    its color to gray and the width to 0.6 millimeters, slightly wider than the other
    line. Check the preview and click on **Apply** to test how the style looks when
    applied to the river layer.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建这样的样式，我们结合了两条简单的线。默认符号是一条简单的线。点击位于**符号层**列表下方的绿色**+**符号以添加另一条简单线。下面的一条将是我们轮廓，上面的一条将是填充。选择上面的简单线，将其颜色更改为蓝色并将宽度更改为0.3毫米。接下来，选择下面的简单线，将其颜色更改为灰色并将宽度更改为0.6毫米，比其他线条略宽。检查预览，并点击**应用**以测试将样式应用于河流层时的外观。
- en: 'You will notice that the style doesn''t look perfect yet. That''s because each
    line feature is drawn separately, one after the other, and this leads to a rather
    disconnected appearance. Luckily, that''s easy to fix; we only need to enable
    the so-called symbol levels. To do that, select the **Line** entry in the **Symbol
    layers** list and tick the checkbox in the **Symbol Levels** dialog of the **Advanced**
    section (the button in the lower-right corner of the style dialog) as shown in
    the following screenshot. Click on **Apply** to test the results:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 你会注意到样式还不是完美的。这是因为每个线要素都是单独绘制的，一个接一个，这导致了一种相当不连贯的外观。幸运的是，这很容易修复；我们只需要启用所谓的符号级别。为此，在**符号层**列表中选择**线**条目，并在**高级**部分的**符号级别**对话框中勾选复选框（位于样式对话框的右下角按钮），如图下截图所示。点击**应用**以测试结果：
- en: Tip
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: Whenever we create a symbol that we might want to re-use in other maps, we can
    save it by going to **Symbol** | **Save in symbol library** (the button beside
    the **Advanced** button in the bottom-right corner). We can assign a name to the
    new symbol; after we save it, it will be added to the **Saved styles** preview
    area.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 每当我们创建可能想要在其他地图中重复使用的符号时，我们可以通过转到**符号** | **保存到符号库**（位于底右角的**高级**按钮旁边的按钮）来保存它。我们可以为新符号分配一个名称；保存后，它将被添加到**已保存样式**预览区域。
- en: '![Creating line styles – an example of river or road styles](img/7488_02_11.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![创建线样式 – 河流或道路样式的示例](img/7488_02_11.jpg)'
- en: 'Symbol layer types for line layers include the following:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 线层符号层类型包括以下几种：
- en: '**Simple line**: These are solid or dashed lines'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**简单线**：这些是实线或虚线'
- en: '**Marker line**: These lines are made out of point markers located at line
    vertices or in regular intervals'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标记线**：这些线由位于线顶点或等间隔的点标记组成'
- en: Creating polygon styles – an example of a landmass style
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建多边形样式 – 一个陆地样式的示例
- en: 'In this exercise, we will create a style for the `alaska.shp` file. The goal
    is to create a simple fill with a blue halo. Like in the previous river style
    example, we will combine two symbol layers to create this style: a simple fill
    layer that defines the main fill color with a thin border and an additional simple
    line outline layer for the halo. The halo should have nice rounded corners. To
    achieve those, change the **Join style** option to **Round**. Similar to the previous
    example, we again enable symbol levels; to prevent this landmass style from blocking
    out the background map, we select the **Multiply** blending mode as shown in the
    following screenshot:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将为`alaska.shp`文件创建一个样式。目标是创建一个带有蓝色光环的简单填充。就像之前的河流样式示例一样，我们将结合两个符号层来创建这个样式：一个定义主要填充颜色并带有细边框的简单填充层，以及一个额外的简单线条轮廓层用于光环。光环应该有漂亮的圆角。为了实现这一点，将**连接样式**选项更改为**圆形**。类似于之前的示例，我们再次启用符号级别；为了防止这种陆地样式遮挡背景地图，我们选择**乘法**混合模式，如以下截图所示：
- en: '![Creating polygon styles – an example of a landmass style](img/7488_02_12.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![创建多边形样式 - 一个陆地样式的示例](img/7488_02_12.jpg)'
- en: 'Symbol layer types for polygon layers include the following:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 多边形层的符号层类型包括以下几种：
- en: '**Simple fill**: These define fill and outline colors as well as basic fill
    styles'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**简单填充**: 这些定义填充和轮廓颜色以及基本的填充样式'
- en: '**Centroid fill**: These allow us to put point markers at the center of polygons'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**质心填充**: 这些允许我们在多边形的中心放置点标记'
- en: '**Line/Point pattern fill**: These support user-defined line and point patterns
    with flexible spacing'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**线/点图案填充**: 这些支持用户定义的线型和点图案，具有灵活的间距'
- en: '**SVG fill**: These fill the polygon using SVG patterns'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SVG填充**: 这些使用SVG图案填充多边形'
- en: '**Outline**: These make it possible to outline areas using line styles'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**轮廓**: 这些使使用线条样式绘制轮廓区域成为可能'
- en: Loading background maps
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 加载背景地图
- en: Background maps are very useful for quick checks and to provide orientation,
    especially if you don't have access to any other base layers. Adding background
    maps is easy using the OpenLayers plugin. It provides access to satellite, street,
    and hybrid maps by Google, Yahoo!, and Bing, as well as different map types by
    OpenStreetMap, Stamen, and Apple.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 背景地图对于快速检查和提供方向非常有用，尤其是在你无法访问任何其他基础图层的情况下。使用OpenLayers插件添加背景地图非常简单。它提供了通过Google、Yahoo!和Bing访问卫星、街道和混合地图的权限，以及通过OpenStreetMap、Stamen和Apple提供的不同地图类型。
- en: To install the OpenLayers plugin, go to **Plugins** | **Manage and Install Plugins
    | Get more**. Wait until the list of available plugins has finished loading. Use
    the filter to look for the **OpenLayers Plugin** option as shown in the following
    screenshot. Select it from the list and click on **Install**. This is going to
    take a moment. Once it's done, you will see a short confirmation message. You
    can then close the installer and the **OpenLayers Plugin** option should be available
    through the **Plugins** menu.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装OpenLayers插件，请转到**插件** | **管理和安装插件 | 获取更多**。等待直到可用的插件列表加载完成。使用过滤器查找**OpenLayers插件**选项，如以下截图所示。从列表中选择它，然后点击**安装**。这可能需要一点时间。完成后，您将看到一个简短的确认消息。然后您可以关闭安装程序，**OpenLayers插件**选项应该可以通过**插件**菜单使用。
- en: '![Loading background maps](img/7488_02_13.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![加载背景地图](img/7488_02_13.jpg)'
- en: Note that you have to be online to use these services. Another fact worth mentioning
    is that all these services provide their maps only in Pseudo Mercator (EPSG:3857).
    Your project CRS will automatically be changed to Pseudo Mercator when you load
    a background map using the **OpenLayers plugin** option.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，您必须在线才能使用这些服务。另一个值得注意的事实是，所有这些服务都只提供伪墨卡托（EPSG:3857）地图。当您使用**OpenLayers插件**选项加载背景地图时，您的项目CRS将自动更改为伪墨卡托。
- en: 'If you load the OSM Landscape layer, your map will look like the following
    screenshot:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您加载OSM景观层，您的地图将看起来像以下截图：
- en: '![Loading background maps](img/7488_02_14.jpg)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![加载背景地图](img/7488_02_14.jpg)'
- en: Summary
  id: totrans-124
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we covered how to load spatial data from files, databases,
    and web services. We saw how QGIS handles coordinate reference systems and had
    a first introduction to styling vector and raster layers, a topic we will cover
    in more detail in [Chapter 5](ch05.html "Chapter 5. Creating Great Maps"), *Creating
    Great Maps*. We also installed our first Python plugin, the OpenLayers plugin,
    and used it to load background maps into our project.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了如何从文件、数据库和Web服务中加载空间数据。我们看到了QGIS如何处理坐标参考系统，并对矢量图层和栅格图层的样式化进行了初步介绍，这个主题我们将在[第5章](ch05.html
    "第5章。创建优秀的地图")“创建优秀的地图”中更详细地探讨。我们还安装了我们的第一个Python插件，即OpenLayers插件，并使用它将背景地图加载到我们的项目中。
