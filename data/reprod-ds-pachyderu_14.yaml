- en: '*Chapter 11*: Using Pachyderm Notebooks'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第11章*：使用 Pachyderm Notebooks'
- en: In [*Chapter 10*](B17085_10_Final_SB_Epub.xhtml#_idTextAnchor220), *Pachyderm
    Language Clients*, we learned how to use Pachyderm language clients, including
    the Pachyderm Go client and Pachyderm Python client. The latter is probably more
    popular among data scientists as Python is the language that a lot of data scientists
    use. And if you write in Python, you are likely familiar with the open source
    tool, **JupyterLab**.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [*第10章*](B17085_10_Final_SB_Epub.xhtml#_idTextAnchor220)《*Pachyderm 语言客户端*》中，我们学习了如何使用
    Pachyderm 语言客户端，包括 Pachyderm Go 客户端和 Pachyderm Python 客户端。后者可能在数据科学家中更受欢迎，因为 Python
    是许多数据科学家使用的语言。而且如果你使用 Python 编写代码，你可能对开源工具 **JupyterLab** 很熟悉。
- en: JupyterLab is an open source platform that provides an **Interactive Development
    Environment** (**IDE**) in which you can not only author your code but also execute
    it. This advantage makes JupyterLab an ideal tool for data science experiments.
    However, while JupyterLab provides a basic version control system for its notebooks,
    it's not to the level of data provenance that Pachyderm offers. Pachyderm Hub,
    the SaaS version of Pachyderm, provides a way to integrate your Pachyderm cluster
    with Pachyderm Notebooks, a built-in version of JupyterLab coupled with Pachyderm.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: JupyterLab 是一个开源平台，提供 **交互式开发环境**（**IDE**），你不仅可以编写代码，还可以执行代码。这个优点使得 JupyterLab
    成为数据科学实验的理想工具。然而，尽管 JupyterLab 为其笔记本提供了基本的版本控制系统，但它的版本控制系统并不具备 Pachyderm 所提供的数据来源级别。Pachyderm
    Hub，作为 Pachyderm 的 SaaS 版本，提供了一种将 Pachyderm 集群与 Pachyderm Notebooks 集成的方式，后者是
    JupyterLab 的内置版本，并与 Pachyderm 配合使用。
- en: This chapter is intended to demonstrate how to configure a Pachyderm cluster
    in Pachyderm Hub and use Pachyderm Notebooks. By the end of this chapter, we will
    learn how to run basic Pachyderm operations in Pachyderm Notebooks and will create
    a sentiment analysis pipeline.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章旨在演示如何在 Pachyderm Hub 中配置 Pachyderm 集群，并使用 Pachyderm Notebooks。在本章结束时，我们将学习如何在
    Pachyderm Notebooks 中运行基本的 Pachyderm 操作，并创建一个情感分析管道。
- en: 'This chapter covers the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章内容包括以下主题：
- en: Enabling Pachyderm Notebooks in Pachyderm Hub
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Pachyderm Hub 中启用 Pachyderm Notebooks
- en: Running basic Pachyderm operations in Pachyderm Notebooks
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Pachyderm Notebooks 中运行基本的 Pachyderm 操作
- en: Creating and running an example pipeline in Pachyderm Notebooks
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Pachyderm Notebooks 中创建并运行一个示例管道
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'You should have already installed the following components:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该已经安装了以下组件：
- en: '`pachctl` 2.0.0 or later'
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pachctl` 2.0.0 或更高版本'
- en: Access to Pachyderm Hub
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问 Pachyderm Hub
- en: A GitHub or Gmail account
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 GitHub 或 Gmail 账户
- en: Downloading the source files
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 下载源文件
- en: All code samples used in this section are stored in the GitHub repository created
    for this book at [https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/tree/main/Chapter11-Using-Pachyderm-Notebooks](https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/tree/main/Chapter11-Using-Pachyderm-Notebooks).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 本节中使用的所有代码示例都存储在为本书创建的 GitHub 仓库中，链接为 [https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/tree/main/Chapter11-Using-Pachyderm-Notebooks](https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/tree/main/Chapter11-Using-Pachyderm-Notebooks)。
- en: The `Dockerfile` used in this section is stored at [https://hub.docker.com/repository/docker/svekars/pachyderm-ide](https://hub.docker.com/repository/docker/svekars/pachyderm-ide).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 本节中使用的 `Dockerfile` 存储在 [https://hub.docker.com/repository/docker/svekars/pachyderm-ide](https://hub.docker.com/repository/docker/svekars/pachyderm-ide)。
- en: Enabling Pachyderm Notebooks in Pachyderm Hub
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Pachyderm Hub 中启用 Pachyderm Notebooks
- en: Before you can take advantage of Pachyderm Notebooks, you need to create an
    account in Pachyderm Hub and a Pachyderm workspace. Pachyderm Hub provides a trial
    period for all users to test its functionality.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在你能使用 Pachyderm Notebooks 之前，你需要在 Pachyderm Hub 创建一个账户和一个 Pachyderm 工作区。Pachyderm
    Hub 为所有用户提供试用期，供其测试功能。
- en: After the trial period ends, you need to upgrade to the Pachyderm Pro version
    to continue using Pachyderm Notebooks.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 试用期结束后，你需要升级到 Pachyderm Pro 版本才能继续使用 Pachyderm Notebooks。
- en: Create a workspace
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建一个工作区
- en: In Pachyderm Hub, your work is organized in **workspaces**. A workspace is a
    grouping in which multiple Pachyderm clusters can run. Your organization might
    decide to assign each workspace to a team of engineers.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Pachyderm Hub 中，你的工作是以 **工作区**（workspaces）形式组织的。一个工作区是一个容器，其中可以运行多个 Pachyderm
    集群。你的组织可能决定将每个工作区分配给一组工程师。
- en: Before you can create a workspace, you need a Pachyderm Hub account, so let's
    create one. Pachyderm Hub supports authentication with Gmail and GitHub. You must
    have either of those to create an account with Pachyderm Hub.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建工作区之前，你需要一个Pachyderm Hub帐户，所以我们来创建一个。Pachyderm Hub支持使用Gmail和GitHub进行身份验证。你必须拥有其中之一才能在Pachyderm
    Hub创建帐户。
- en: 'To create a Pachyderm Hub account, complete the following steps:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 创建Pachyderm Hub帐户，请完成以下步骤：
- en: Go to [https://www.pachyderm.com/try-pachyderm-hub#](https://www.pachyderm.com/try-pachyderm-hub#)
    and fill out the provided form to request a free trial of Pachyderm Hub. It might
    take some time for your account to be activated and you will receive an email
    with instructions.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问[https://www.pachyderm.com/try-pachyderm-hub#](https://www.pachyderm.com/try-pachyderm-hub#)，并填写提供的表单以申请Pachyderm
    Hub的免费试用。你的帐户激活可能需要一些时间，你将收到包含指示的电子邮件。
- en: Log in to your Pachyderm Hub account with the Gmail or GitHub account you have
    provided in the sign-up form.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用你在注册表单中提供的Gmail或GitHub帐户登录Pachyderm Hub帐户。
- en: Fill out the **Get Started** form and click **Get Started**.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写**开始使用**表单并点击**开始使用**。
- en: 'Click **Create a workspace**, fill out the form that appears as shown in the
    following screenshot, and click **Create**:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建工作区**，填写弹出表单，内容如下面的截图所示，然后点击**创建**：
- en: '![Figure 11.1 – Create a new workspace'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.1 – 创建一个新工作区'
- en: '](img/B17085_11_001.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_001.jpg)'
- en: Figure 11.1 – Create a new workspace
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.1 – 创建一个新工作区
- en: When you create a workspace, you automatically deploy a Pachyderm cluster. If
    you're using a trial version of Pachyderm, you will have deployed a single-node
    cluster, which should be enough for testing.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 创建工作区时，你将自动部署一个Pachyderm集群。如果你正在使用Pachyderm的试用版，你将部署一个单节点集群，这应该足够进行测试。
- en: Now that you have created your first workspace, you need to connect to your
    cluster using `pachctl`.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经创建了第一个工作区，接下来你需要使用`pachctl`连接到你的集群。
- en: Connect to your Pachyderm Hub workspace with pachctl
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用pachctl连接到你的Pachyderm Hub工作区
- en: If this is not the first chapter that you are reading in this book, you should
    already have `pacthl` installed on your computer. Otherwise, install `pachctl`
    as described in [*Chapter 4*](B17085_04_Final_SB_Epub.xhtml#_idTextAnchor096),
    *Installing Pachyderm Locally*.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这不是你在本书中阅读的第一章，你应该已经在计算机上安装了`pachctl`。否则，请按照[*第4章*](B17085_04_Final_SB_Epub.xhtml#_idTextAnchor096)中的说明，*在本地安装Pachyderm*。
- en: 'To connect to your Pachyderm Hub workspace, do the following:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 要连接到Pachyderm Hub工作区，请执行以下步骤：
- en: In the Pachyderm Hub UI, locate your workspace, and click the CLI link.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Pachyderm Hub UI中，找到你的工作区，然后点击CLI链接。
- en: Follow the instructions in the UI to switch your Pachyderm context and enable
    communication between your computer and your workspace on Pachyderm Hub.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照界面中的指示，切换你的Pachyderm上下文，并启用计算机与Pachyderm Hub上工作区之间的通信。
- en: 'After you authenticate, run the following command:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在身份验证后，运行以下命令：
- en: '[PRE0]'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You should get the following response:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 你应当得到以下响应：
- en: '[PRE1]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Check that you have switched to the correct context by running the following
    command:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过运行以下命令检查是否已切换到正确的上下文：
- en: '[PRE2]'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This command should return the name of your Pachyderm Hub workspace.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令应返回你在Pachyderm Hub工作区的名称。
- en: You can now communicate with your cluster deployed on Pachyderm Hub through
    `pachctl` from a terminal on your computer.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你可以通过计算机终端中的`pachctl`与部署在Pachyderm Hub上的集群进行通信。
- en: Now that we have configured our cluster, let's connect to a Pachyderm notebook.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经配置好了集群，接下来让我们连接到Pachyderm笔记本。
- en: Connect to a Pachyderm notebook
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接到Pachyderm笔记本
- en: '**Pachyderm Notebooks** is an **IDE** for data scientists that provides easy
    access to familiar Python libraries. You can run and test your code in cells while
    Pachyderm backs your pipeline.'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '**Pachyderm笔记本**是一个**IDE**，为数据科学家提供便捷访问常用的Python库。你可以在单元格中运行和测试代码，而Pachyderm会为你的管道提供支持。'
- en: 'To connect to a Pachyderm notebook, complete the following steps:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 要连接到Pachyderm笔记本，请完成以下步骤：
- en: 'In the Pachyderm Hub UI, in your workspace, click **Notebooks**:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Pachyderm Hub UI中，进入你的工作区，点击**笔记本**：
- en: '![Figure 11.2 – Access Pachyderm Notebooks'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.2 – 访问Pachyderm笔记本'
- en: '](img/B17085_11_002.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_002.jpg)'
- en: Figure 11.2 – Access Pachyderm Notebooks
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.2 – 访问Pachyderm笔记本
- en: When prompted, click **Sign in with OAuth 2.0** and then sign in with the account
    that has access to Pachyderm Hub.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当提示时，点击**使用OAuth 2.0登录**，然后使用具有Pachyderm Hub访问权限的帐户登录。
- en: 'On the **Server Options** screen, select the **Default** server:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**服务器选项**页面，选择**默认**服务器：
- en: '![Figure 11.3 – Server Options'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.3 – 服务器选项'
- en: '](img/B17085_11_003.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_003.jpg)'
- en: Figure 11.3 – Server Options
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.3 – 服务器选项
- en: Click **Start** and then **Launch Server**.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **开始** 然后点击 **启动服务器**。
- en: 'You should see the following screen:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下屏幕：
- en: '![Figure 11.4 – Pachyderm Notebooks home'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.4 – Pachyderm 笔记本首页'
- en: '](img/B17085_11_004.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_004.jpg)'
- en: Figure 11.4 – Pachyderm Notebooks home
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.4 – Pachyderm 笔记本首页
- en: Now that we have access to Pachyderm Notebooks, we can create Pachyderm pipelines
    directly from the Pachyderm Notebooks UI, experiment with Python code and `python-pachyderm`,
    run `pachctl` commands, and even create `Markdown` files to document our experiments.
    We'll look into this functionality in the next section.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以访问 Pachyderm 笔记本了，我们可以直接从 Pachyderm 笔记本 UI 创建 Pachyderm 管道，实验 Python 代码和
    `python-pachyderm`，运行 `pachctl` 命令，甚至创建 `Markdown` 文件来记录我们的实验。我们将在下一部分详细了解此功能。
- en: Running basic Pachyderm operations in Pachyderm Notebooks
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Pachyderm 笔记本中运行基本的 Pachyderm 操作
- en: The main advantage of Pachyderm Notebooks is that it provides a unified experience.
    Not only can you run your experiments inside of it, but you can also access your
    Pachyderm cluster through the integrated terminal by using both `pachctl` and
    `python-pachyderm`. All the pipelines that you create through the JupyterLab UI
    will be reflected in your Pachyderm cluster whether it runs locally or on a cloud
    platform.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: Pachyderm 笔记本的主要优势是它提供了统一的体验。你不仅可以在其中运行实验，还可以通过集成终端使用 `pachctl` 和 `python-pachyderm`
    访问你的 Pachyderm 集群。你通过 JupyterLab UI 创建的所有管道将在你的 Pachyderm 集群中反映出来，无论它是在本地运行还是在云平台上。
- en: Now let's see how we can use Pachyderm Notebooks to access our Pachyderm cluster.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们看看如何使用 Pachyderm 笔记本访问我们的 Pachyderm 集群。
- en: Using the integrated terminal
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用集成终端
- en: You can run the integrated terminal from within Pachyderm Notebooks and use
    it to execute `pachctl` or any other `UNIX` commands.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在 Pachyderm 笔记本中运行集成终端，并使用它执行 `pachctl` 或任何其他 `UNIX` 命令。
- en: 'To use the integrated terminal, complete the following steps:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用集成终端，请完成以下步骤：
- en: On the Pachyderm Notebooks home page, click **Terminal**.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Pachyderm 笔记本首页，点击 **终端**。
- en: 'Click the **Terminal** icon to start a new Terminal window:'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **终端** 图标以启动一个新的终端窗口：
- en: '![Figure 11.5 – Start a Terminal within Pachyderm Notebooks'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.5 – 在 Pachyderm 笔记本中启动终端'
- en: '](img/B17085_11_005.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_005.jpg)'
- en: Figure 11.5 – Start a Terminal within Pachyderm Notebooks
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.5 – 在 Pachyderm 笔记本中启动终端
- en: 'Get the version of Pachyderm:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取 Pachyderm 的版本：
- en: '[PRE3]'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Try running other Pachyderm commands that you have learned in previous chapters
    to see how it works.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试运行你在前几章中学习的其他 Pachyderm 命令，看看它是如何工作的。
- en: Important note
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The version of `pachctl` and `pachd` are different than the ones your run directly
    from your computer terminal as Pachyderm Notebooks has a preinstalled version
    of `pachctl`, which sometimes might not match the version of your cluster. This
    should not affect your work with Pachyderm.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '`pachctl` 和 `pachd` 的版本与从你计算机终端直接运行的版本不同，因为 Pachyderm 笔记本有一个预安装的 `pachctl`
    版本，而这个版本有时可能与集群的版本不匹配。这个差异不应影响你使用 Pachyderm 的工作。'
- en: Now that we know how to use the terminal, let's try to create a Pachyderm notebook.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们知道如何使用终端了，让我们尝试创建一个 Pachyderm 笔记本。
- en: Using Pachyderm Notebooks
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 Pachyderm 笔记本
- en: A notebook is an interactive document in which the users can write Python code,
    run it, and visualize it. These features make notebooks a great experimentation
    tool that many data scientists use in their work. After the experiment is finished,
    you might want to export the notebook as a Python script or library.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 笔记本是一个交互式文档，用户可以在其中编写 Python 代码，运行它并可视化结果。这些功能使得笔记本成为许多数据科学家在工作中使用的优秀实验工具。实验完成后，你可能希望将笔记本导出为
    Python 脚本或库。
- en: 'Pachyderm Notebooks supports the following types of notebooks:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: Pachyderm 笔记本支持以下类型的笔记本：
- en: Python notebooks
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python 笔记本
- en: Julia notebooks
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Julia 笔记本
- en: R notebooks
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R 笔记本
- en: These three languages seem to be most popular among data scientists. You can
    create Julia and R notebooks to experiment specifically with the code that you
    want to use with your pipeline. With Python notebooks, not only you can test your
    code, but you can also use the `python-pachyderm` client to interact with the
    Pachyderm cluster.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 这三种语言似乎是数据科学家中最受欢迎的。你可以创建 Julia 和 R 笔记本，专门实验你想在管道中使用的代码。通过 Python 笔记本，你不仅可以测试代码，还可以使用
    `python-pachyderm` 客户端与 Pachyderm 集群进行交互。
- en: Important note
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The code described in this section can be found in the [https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/blob/main/Chapter11-Using-Pachyderm-Notebooks/example.ipynb](https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/blob/main/Chapter11-Using-Pachyderm-Notebooks/example.ipynb)
    file.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 本节中描述的代码可以在 [https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/blob/main/Chapter11-Using-Pachyderm-Notebooks/example.ipynb](https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/blob/main/Chapter11-Using-Pachyderm-Notebooks/example.ipynb)
    文件中找到。
- en: 'Let''s create a Python notebook and run a few commands:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们创建一个 Python 笔记本并运行几个命令：
- en: On the Pachyderm Notebooks home screen, click on the Python 3 notebook icon
    to create a new notebook.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Pachyderm 笔记本主页屏幕上，点击 Python 3 笔记本图标以创建一个新的笔记本。
- en: 'We can use both regular Python and `python-pachyderm` in this notebook. For
    example, to get the current version of your Pachyderm cluster and list all the
    repositories, paste the following in the notebook''s cell:'
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以在这个笔记本中使用常规 Python 和 `python-pachyderm`。例如，要获取当前 Pachyderm 集群的版本并列出所有仓库，可以将以下内容粘贴到笔记本的单元格中：
- en: '[PRE4]'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Click the run icon to run the script and get the result:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击运行图标以运行脚本并获得结果：
- en: '![Figure 11.6 – Running python-pachyderm in Notebooks'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.6 – 在笔记本中运行 python-pachyderm'
- en: '](img/B17085_11_006.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_006.jpg)'
- en: Figure 11.6 – Running python-pachyderm in Notebooks
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.6 – 在笔记本中运行 python-pachyderm
- en: 'Create a repository by pasting the following code in the next cell and running
    it:'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过将以下代码粘贴到下一个单元格并运行，创建一个仓库：
- en: '[PRE5]'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Here is the output that you should see:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 这是你应该看到的输出：
- en: '![Figure 11.7 – List repo'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.7 – 列出仓库'
- en: '](img/B17085_11_007.jpg)'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_007.jpg)'
- en: Figure 11.7 – List repo
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.7 – 列出仓库
- en: Note that you do not need to import `python_pachyderm` and define the client
    in the second and subsequent cells since you have already defined it in the first
    cell.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，你不需要在第二个及后续单元格中导入 `python_pachyderm` 并定义客户端，因为你已经在第一个单元格中定义过了。
- en: 'Let''s add some files to the data repository:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们向数据仓库中添加一些文件：
- en: '[PRE6]'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Here is the output that you should see:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 这是你应该看到的输出：
- en: '![Figure 11.8 – Put file output'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.8 – 上传文件输出'
- en: '](img/B17085_11_008.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_008.jpg)'
- en: Figure 11.8 – Put file output
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.8 – 上传文件输出
- en: This dataset contains statistics about COVID-19 vaccinations from December 24
    to 31, 2020\.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这个数据集包含了从 2020 年 12 月 24 日到 12 月 31 日的 COVID-19 疫苗接种统计数据。
- en: 'You can print the contents of the file by running the following code:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以通过运行以下代码打印文件内容：
- en: '[PRE7]'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'You should see the following output:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Figure 11.9 – Total vaccinations'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.9 – 总疫苗接种数'
- en: '](img/B17085_11_009.jpg)'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_009.jpg)'
- en: Figure 11.9 – Total vaccinations
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.9 – 总疫苗接种数
- en: 'This CSV file has the following columns: **location**, **date**, **vaccine**
    (manufacturer), and **total_vaccinations**.'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 这个 CSV 文件包含以下列：**位置**、**日期**、**疫苗**（生产商）和 **总疫苗接种数**。
- en: 'Let''s also print the top five rows of the file to view the names of the columns:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们还打印文件的前五行，以查看列名：
- en: '[PRE8]'
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'You should see the following output:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Figure 11.10 – Top five rows'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.10 – 前五行'
- en: '](img/B17085_11_010.jpg)'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_010.jpg)'
- en: Figure 11.10 – Top five rows
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.10 – 前五行
- en: 'Finally, let''s create a simple pipeline that will tell us which country did
    the most vaccinations in a single given day during the observed period:'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，让我们创建一个简单的管道，它将告诉我们在观察期内，某一天哪一个国家进行了最多的疫苗接种：
- en: '[PRE9]'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'You should see the following output:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Figure 11.11 – Create pipeline output'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.11 – 创建管道输出'
- en: '](img/B17085_11_011.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_011.jpg)'
- en: Figure 11.11 – Create pipeline output
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.11 – 创建管道输出
- en: 'Let''s get the result of our pipeline by executing the following code:'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们通过执行以下代码来获取管道的结果：
- en: '[PRE10]'
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'You should see the following output:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Figure 11.12 – Results of the pipeline'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.12 – 管道的结果'
- en: '](img/B17085_11_012.jpg)'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_012.jpg)'
- en: Figure 11.12 – Results of the pipeline
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.12 – 管道的结果
- en: Our pipeline has determined that during the period from December 24 to December
    31, the most vaccinations were done in **Germany** on **December 31**. The number
    of vaccinations was **206443** and the manufacturer was **Pfizer/BioNTech**.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的管道已经确定，在 12 月 24 日至 12 月 31 日期间，**德国**在 **12 月 31 日**进行了最多的疫苗接种。接种的数量是 **206443**，生产商是
    **Pfizer/BioNTech**。
- en: 'To clean up your cluster, run the following:'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要清理你的集群，请运行以下命令：
- en: '[PRE11]'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'You should see the following output:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Figure 11.13 – Cluster clean up'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.13 – 集群清理'
- en: '](img/B17085_11_013.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_013.jpg)'
- en: Figure 11.13 – Cluster clean up
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.13 – 集群清理
- en: In this section, we learned how to perform basic Pachyderm operations in Pachyderm
    Python Notebooks. Next, we'll create another example pipeline.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们学习了如何在Pachyderm Python Notebooks中执行基本的Pachyderm操作。接下来，我们将创建另一个示例流水线。
- en: Creating and running an example pipeline in Pachyderm Notebooks
  id: totrans-145
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Pachyderm Notebooks中创建并运行一个示例流水线
- en: In the previous section, we learned how to use Pachyderm Notebooks, create repositories,
    put data, and even created a simple pipeline. In this section, we will create
    a pipeline that performs sentiment analysis on a Twitter dataset.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节中，我们学习了如何使用Pachyderm Notebooks，创建仓库，存放数据，甚至创建了一个简单的流水线。在本节中，我们将创建一个对Twitter数据集进行情感分析的流水线。
- en: Important note
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The code described in this section can be found in the [https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/blob/main/Chapter11-Using-Pachyderm-Notebooks/sentiment-pipeline.ipynb](https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/blob/main/Chapter11-Using-Pachyderm-Notebooks/sentiment-pipeline.ipynb)
    file.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 本节中描述的代码可以在[https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/blob/main/Chapter11-Using-Pachyderm-Notebooks/sentiment-pipeline.ipynb](https://github.com/PacktPublishing/Reproducible-Data-Science-with-Pachyderm/blob/main/Chapter11-Using-Pachyderm-Notebooks/sentiment-pipeline.ipynb)文件中找到。
- en: We will use a modified version of the International Women's Day Tweets dataset
    from Kaggle available at [https://www.kaggle.com/michau96/international-womens-day-tweets](https://www.kaggle.com/michau96/international-womens-day-tweets).
    Our modified version includes only two columns—tweet number **#** and **text**.
    The dataset includes **51,480** rows.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用Kaggle上的修改版国际妇女节推文数据集，数据集链接为[https://www.kaggle.com/michau96/international-womens-day-tweets](https://www.kaggle.com/michau96/international-womens-day-tweets)。我们的修改版仅包含两列——推文编号**#**和**文本**。该数据集包含**51,480**行数据。
- en: 'Here is an extract of the first few rows of the dataset:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是数据集前几行的提取：
- en: '[PRE12]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Here is a diagram of the workflow:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是工作流程的图示：
- en: '![Figure 11.14 – Sentiment analysis pipeline'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.14 – 情感分析流水线'
- en: '](img/B17085_11_014.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_014.jpg)'
- en: Figure 11.14 – Sentiment analysis pipeline
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.14 – 情感分析流水线
- en: In the next section, we will learn about the methodology that is used to build
    this pipeline.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将学习构建该流水线所使用的方法论。
- en: Pipeline methodology
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 流水线方法论
- en: We will use `TextBlob`, an open source Python library for text processing, to
    perform sentiment analysis on the tweets in the dataset.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用`TextBlob`，一个用于文本处理的开源Python库，对数据集中的推文进行情感分析。
- en: '**Sentiment analysis** is a technique that helps understand the overall mood
    of the individuals involved in a specific conversation, discussing specific products
    and services, or rating a movie. Sentiment analysis is widely used in various
    types of businesses and industries by marketers and sociologists to get a quick
    assessment of customer sentiment. In this example, we will be looking at emotions
    expressed in a selection of tweets about International Women''s Day.'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '**情感分析**是一种帮助理解特定对话中涉及个体整体情绪的技术，讨论特定的产品和服务，或评估一部电影。情感分析在各种类型的商业和行业中被营销人员和社会学家广泛使用，用于快速评估客户情绪。在本例中，我们将查看有关国际妇女节的一些推文中表达的情感。'
- en: '`TextBlob` provides two metrics for sentiment analysis—polarity and subjectivity.
    Each word in a sentence is assigned a score and then the mean score is assigned
    to the whole sentence. In this example, we will only determine the polarity of
    the tweets. Polarity defines the positivity or negativity of a sentence based
    on a predefined word intensity.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '`TextBlob`提供了两种情感分析指标——极性和主观性。句子中的每个单词都被分配一个分数，然后将该分数的平均值分配给整个句子。在本例中，我们将只确定推文的极性。极性根据预定义的单词强度来定义句子的积极性或消极性。'
- en: 'Polarity values range from -1 to 1, with -1 meaning negative sentiment, 0 being
    neutral, and 1 being positive. If we were to show this on a scale, it would look
    like this:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 极性值范围从-1到1，其中-1表示负面情感，0表示中性，1表示正面。如果我们将其显示在一个刻度上，它会是这样的：
- en: '![Figure 11.15 – Polarity'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.15 – 极性'
- en: '](img/B17085_11_015.jpg)'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_015.jpg)'
- en: Figure 11.15 – Polarity
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.15 – 极性
- en: 'If we were to put the words into a table and assign them polarity scores, here
    is what we might get:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们将这些单词放入表格中并分配极性分数，可能会得到如下结果：
- en: '![Figure 11.16 – Polarity scores'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.16 – 极性分数'
- en: '](img/Table_012.jpg)'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Table_012.jpg)'
- en: Figure 11.16 – Polarity scores
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.16 – 极性分数
- en: 'Let''s run a quick `TextBlob` example on a simple sentence to see how it works.
    Use the code in the `sentiment-test.py` file to try this example:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们快速运行一个简单句子的`TextBlob`示例，看看它是如何工作的。使用`sentiment-test.py`文件中的代码尝试这个示例：
- en: '[PRE13]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'To run this script, complete the following steps:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行这个脚本，完成以下步骤：
- en: 'You need to install `TextBlob` in the Pachyderm Notebooks terminal:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你需要在Pachyderm笔记本终端中安装`TextBlob`：
- en: '[PRE14]'
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Here is the output that you should see:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 这是你应该看到的输出：
- en: '![Figure 11.17 – Installing TextBlob'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.17 – 安装TextBlob]'
- en: '](img/B17085_11_017.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_017.jpg)'
- en: Figure 11.17 – Installing TextBlob
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.17 – 安装TextBlob
- en: 'Run `sentiment-test.py` either in your local terminal or in a Jupyter notebook:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本地终端或Jupyter Notebook中运行`sentiment-test.py`：
- en: '![Figure 11.18 – Output of the sentiment-test.py script'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.18 – sentiment-test.py脚本的输出]'
- en: '](img/B17085_11_018.jpg)'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_018.jpg)'
- en: Figure 11.18 – Output of the sentiment-test.py script
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.18 – sentiment-test.py脚本的输出
- en: As you can see in the output, `TextBlob` assigns a score for each sentence.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 如输出所示，`TextBlob`会为每个句子分配一个评分。
- en: Now that we have reviewed the methodology of our example, let's create our pipelines.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经回顾了示例的方法论，让我们创建我们的管道。
- en: Creating the pipelines
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建管道
- en: Our first pipeline will use NLTK to clean the Twitter data in our `data.csv`
    file. We will create a standard Pachyderm pipeline by using `python-pachyderm`.
    The pipeline will consume files from the data repository, run the `data-clean.py`
    script on it, and output the cleaned text to the `data-clean` output repository.
    The pipeline will use the `svekars/pachyderm-ide:1.0` Docker image to run the
    code.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第一个管道将使用NLTK来清理`data.csv`文件中的Twitter数据。我们将使用`python-pachyderm`创建一个标准的Pachyderm管道。该管道将从数据存储库中获取文件，运行`data-clean.py`脚本，并将清理后的文本输出到`data-clean`输出存储库。该管道将使用`svetkar/pachyderm-ide:1.0`
    Docker镜像来运行代码。
- en: 'The first part of `data-clean.py` imports the components that are familiar
    to us from [*Chapter 8*](B17085_08_Final_SB_Epub.xhtml#_idTextAnchor184), *Creating
    an End-to-End Machine Learning Workflow*. These components include NLTK and `pandas`,
    which we will use to preprocess our data. We will also import `re` to specify
    regular expressions:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: '`data-clean.py`的第一部分导入了我们在[*第8章*](B17085_08_Final_SB_Epub.xhtml#_idTextAnchor184)中熟悉的组件，*创建端到端机器学习工作流*。这些组件包括NLTK和`pandas`，我们将用它们来预处理数据。我们还将导入`re`来指定正则表达式：'
- en: '[PRE15]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The second part of the script performs the data cleaning using the NLTK `word_tokenize`
    method, `stopwords` with the `lambda` function, and `re.split` to remove the URLs.
    Finally, the script saves the cleaned text to `cleaned-data.csv` in the output
    repository:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本的第二部分使用NLTK的`word_tokenize`方法、`stopwords`和`lambda`函数，以及`re.split`来移除URL，进行数据清理。最后，脚本将清理后的文本保存到`cleaned-data.csv`文件中，存放在输出存储库：
- en: '[PRE16]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Our second pipeline will perform sentiment analysis on the cleaned data with
    the `TextBlob` Python library. The `sentiment.py` script imports the following
    components:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第二个管道将使用`TextBlob` Python库对清理后的数据执行情感分析。`sentiment.py`脚本导入了以下组件：
- en: '[PRE17]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: We'll use `pandas` to manipulate the data frames. We'll use `matplotlib` and
    `seaborn` to visualize our results, and we'll use `redirect_stdout` to save our
    results to a file.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用`pandas`来操作数据框。我们将使用`matplotlib`和`seaborn`来可视化结果，并使用`redirect_stdout`将结果保存到文件中。
- en: 'Next, our script performs sentiment analysis and creates two new columns—`polarity_score`
    and `sentiment`. The resulting table is saved to a new CSV file called `polarity.csv`:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们的脚本执行情感分析并创建两个新列——`polarity_score`和`sentiment`。结果表格保存为一个名为`polarity.csv`的新CSV文件：
- en: '[PRE18]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Then, the script saves the tweets of sentiment category to its own variable,
    calculates the total for each category, and saves the totals to the `number_of_tweets.txt`
    file:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，脚本将情感类别的推文保存到其自己的变量中，计算每个类别的总数，并将总数保存到`number_of_tweets.txt`文件：
- en: '[PRE19]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The last part of the script builds a pie chart with the percentages of tweets
    in each category and saves them to the `plot.png` file:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本的最后部分绘制了一个饼图，显示每个类别推文的百分比，并将其保存到`plot.png`文件中：
- en: '[PRE20]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Let''s create these pipelines:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们创建这些管道：
- en: Create a new Pachyderm Python notebook.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的Pachyderm Python笔记本。
- en: 'Create a Pachyderm `data` repository:'
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个Pachyderm `data`存储库：
- en: '[PRE21]'
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'You should see the following output:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Figure 11.19 – Output of the created repository'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.19 – 创建的存储库的输出]'
- en: '](img/B17085_11_019.jpg)'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_019.jpg)'
- en: Figure 11.19 – Output of the created repository
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.19 – 创建的存储库的输出
- en: 'Put the `data.csv` file in this repository:'
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`data.csv`文件放入这个存储库：
- en: '[PRE22]'
  id: totrans-208
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'This script returns the following output:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本返回以下输出：
- en: '![Figure 11.20 – Put file output'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.20 – 放置文件输出'
- en: '](img/B17085_11_020.jpg)'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_020.jpg)'
- en: Figure 11.20 – Put file output
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.20 – 放置文件输出
- en: 'List the files in the data repository:'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列出数据库中的文件：
- en: '[PRE23]'
  id: totrans-214
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'You should see the following response:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下响应：
- en: '![Figure 11.21 – List file output'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.21 – 列表文件输出'
- en: '](img/B17085_11_021.jpg)'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_021.jpg)'
- en: Figure 11.21 – List file output
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.21 – 列表文件输出
- en: 'Create the `data-clean` pipeline:'
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建 `data-clean` 管道：
- en: '[PRE24]'
  id: totrans-220
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'You should see the following output:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Figure 11.22 – Create pipeline output'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.22 – 创建管道输出'
- en: '](img/B17085_11_022.jpg)'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_022.jpg)'
- en: Figure 11.22 – Create pipeline output
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.22 – 创建管道输出
- en: The output is truncated and shows only the `data-clean` pipeline. You should
    see similar output for the `sentiment` pipeline.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 输出被截断，仅显示 `data-clean` 管道的内容。你应该也能看到 `sentiment` 管道的类似输出。
- en: 'Let''s view the first few lines of the file in the `data-clean` repository
    that has our cleaned data:'
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们查看 `data-clean` 库中包含我们清洗数据的文件的前几行：
- en: '[PRE25]'
  id: totrans-227
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'This script returns the following output:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本返回以下输出：
- en: '![Figure 11.23 – Cleaned data'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.23 – 清洗后的数据'
- en: '](img/B17085_11_023.jpg)'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_023.jpg)'
- en: Figure 11.23 – Cleaned data
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.23 – 清洗后的数据
- en: You can see that the text was broken down into tokens.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以看到文本已被分解为标记。
- en: 'Let''s get the list of files in the sentiment repository:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们获取情感库中的文件列表：
- en: '[PRE26]'
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'You should see a lengthy output. The files will be under `path:`, similar to
    the following response:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到一长串输出。文件将位于 `path:` 下，类似于以下响应：
- en: '![Figure 11.24 – List of files in the sentiment repository'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.24 – 情感库中的文件列表'
- en: '](img/B17085_11_024.jpg)'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_024.jpg)'
- en: Figure 11.24 – List of files in the sentiment repository
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.24 – 情感库中的文件列表
- en: 'There should be three files, as follows:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 应该有三个文件，如下所示：
- en: '`number_of_tweets.txt`: A text file with the total number of tweets in each
    category'
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`number_of_tweets.txt`：一个文本文件，包含每个类别的推文总数'
- en: '`plot.png`: A pie chart with the percentages of tweets in each category'
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`plot.png`：一个饼图，显示每个类别中推文的百分比'
- en: '`polarity.csv`: A new CSV table with the `polarity_score` and `sentiment` columns'
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`polarity.csv`：一个新的 CSV 表格，包含 `polarity_score` 和 `sentiment` 列'
- en: 'Now, let''s look at the first few rows of the `polarity.csv` table:'
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们来看一下 `polarity.csv` 表格的前几行：
- en: '[PRE27]'
  id: totrans-244
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'This script returns the following output:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本返回以下输出：
- en: '![Figure 11.25 – Polarity and sentiment results'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.25 – 极性和情感结果'
- en: '](img/B17085_11_025.jpg)'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_025.jpg)'
- en: Figure 11.25 – Polarity and sentiment results
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.25 – 极性和情感结果
- en: You can see the two new columns appended to our original table, giving a polarity
    score in the range [-1;1] and a sentiment category.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以看到原始表格中新增的两列，提供了一个范围为 [-1;1] 的极性分数和一个情感类别。
- en: 'Let''s see the total number for each sentiment category:'
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们来看一下每个情感类别的总数：
- en: '[PRE28]'
  id: totrans-251
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'You should see the following output:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该看到以下输出：
- en: '![Figure 11.26 – Total number of tweets for each category'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.26 – 每个类别的推文总数'
- en: '](img/B17085_11_026.jpg)'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_026.jpg)'
- en: Figure 11.26 – Total number of tweets for each category
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.26 – 每个类别的推文总数
- en: 'Finally, let''s look at the pie chart with sentiment category percentages:'
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，让我们来看一下带有情感类别百分比的饼图：
- en: '[PRE29]'
  id: totrans-257
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'This script returns the following output:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 该脚本返回以下输出：
- en: '![Figure 11.27 – Percentage of positive, negative, and neutral sentiments'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 11.27 – 正面、负面和中性情感的百分比'
- en: '](img/B17085_11_027.jpg)'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17085_11_027.jpg)'
- en: Figure 11.27 – Percentage of positive, negative, and neutral sentiments
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 图 11.27 – 正面、负面和中性情感的百分比
- en: Based on this chart, we can tell that the majority of the tweets contain positive
    sentiments and the percentage of negative tweets can be considered insignificant.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 根据这张图，我们可以看出大多数推文包含正面情感，负面推文的百分比可以认为微不足道。
- en: This concludes our sentiment analysis example.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是我们情感分析示例的全部内容。
- en: Summary
  id: totrans-264
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have learned how to create Pachyderm notebooks in Pachyderm
    Hub, a powerful addition to Pachyderm that enables data scientists to leverage
    the benefits of an integrated environment with the Pachyderm data lineage functionality
    and pipelines. Data scientists spend hours performing exploratory data analysis
    and do so in notebooks. Combining Pachyderm and notebooks brings data scientists
    and data engineers together on one platform, letting them speak the same language
    and use the same tools.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何在 Pachyderm Hub 中创建 Pachyderm 笔记本，这是 Pachyderm 的一个强大功能，能够让数据科学家利用集成环境与
    Pachyderm 数据血统功能和管道的优势。数据科学家花费数小时进行探索性数据分析，并且是在笔记本中完成的。将 Pachyderm 与笔记本结合，能够将数据科学家和数据工程师汇聚在同一平台，让他们讲同样的语言，使用相同的工具。
- en: In addition to the above, we created a pipeline that performs basic sentiment
    analysis of Twitter data and ran it completely in a Pachyderm notebook. We have
    expanded our knowledge of Python Pachyderm and how it can be used in conjunction
    with other tools and libraries.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 除了上述内容外，我们还创建了一个管道，用于对 Twitter 数据进行基本的情感分析，并且完全在 Pachyderm 笔记本中运行。我们扩展了对 Python
    Pachyderm 的知识，并了解了它如何与其他工具和库结合使用。
- en: Further reading
  id: totrans-267
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'JupyterLab documentation: https://jupyterlab.readthedocs.io/en/stable/'
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: JupyterLab 文档： [https://jupyterlab.readthedocs.io/en/stable/](https://jupyterlab.readthedocs.io/en/stable/)
- en: '`TextBlob` documentation: [https://textblob.readthedocs.io/en/dev/](https://textblob.readthedocs.io/en/dev/)'
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`TextBlob` 文档：[https://textblob.readthedocs.io/en/dev/](https://textblob.readthedocs.io/en/dev/)'
- en: '`python-pachyderm` documentation: [https://python-pachyderm.readthedocs.io/en/stable/](https://python-pachyderm.readthedocs.io/en/stable/)'
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`python-pachyderm` 文档：[https://python-pachyderm.readthedocs.io/en/stable/](https://python-pachyderm.readthedocs.io/en/stable/)'
