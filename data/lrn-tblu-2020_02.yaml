- en: '2'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '2'
- en: Connecting to Data in Tableau
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接到 Tableau 中的数据
- en: 'Tableau offers the ability to connect to nearly any data source. It does this
    with a unique paradigm that leverages the power and efficiency of existing database
    engines or alternately extracts the data locally. We''ll look at joins, blends,
    unions, and the brand new object model in *Chapter 13*, *Understanding the Tableau
    Data Model, Joins, and Blends*. In this chapter, we''ll focus on essential concepts
    of how Tableau connects to and works with data. We''ll cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 提供了连接几乎所有数据源的能力。它通过一种独特的范式来实现这一点，该范式利用了现有数据库引擎的强大功能和效率，或者提取数据到本地。我们将在*第
    13 章*《理解 Tableau 数据模型、连接和联接》中详细探讨连接、混合、联合以及全新的对象模型。在本章中，我们将重点介绍 Tableau 如何连接并处理数据的基本概念。我们将涵盖以下主题：
- en: The Tableau paradigm
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Tableau 范式
- en: Connecting to data
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接到数据
- en: Managing data source metadata
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理数据源元数据
- en: Working with extracts instead of live connections
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用提取代替实时连接
- en: Filtering data
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 过滤数据
- en: We'll start by gaining an understanding of the underlying paradigm of how Tableau
    works with data.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从理解 Tableau 如何处理数据的基本范式开始。
- en: The Tableau paradigm
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Tableau 范式
- en: The unique and exciting experience of working with data in Tableau is a result
    of **VizQL** (**Visual Query Language**).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Tableau 中处理数据的独特和令人兴奋的体验，正是 **VizQL**（**可视化查询语言**）的结果。
- en: VizQL was developed as a Stanford University research project, focusing on the
    natural ways that humans visually perceive the world and how that could be applied
    to data visualization. We naturally perceive differences in size, shape, spatial
    location, and color. VizQL allows Tableau to translate your actions, as you drag
    and drop fields of data in a visual environment, into a query language that defines
    how the data encodes those visual elements. You will never need to read, write,
    or debug VizQL. As you drag and drop fields onto various shelves defining size,
    color, shape, and spatial location, Tableau will generate the VizQL behind the
    scenes. This allows you to focus on visualizing data, not writing code!
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: VizQL 是作为斯坦福大学的研究项目开发的，专注于人类如何自然地感知世界的方式，以及如何将这种感知应用到数据可视化中。我们自然地感知大小、形状、空间位置和颜色的差异。VizQL
    使 Tableau 能够将你在可视化环境中拖放数据字段的操作，转换成定义数据如何编码这些视觉元素的查询语言。你无需阅读、编写或调试 VizQL。当你将字段拖放到定义大小、颜色、形状和空间位置的各个架构上时，Tableau
    会在后台生成 VizQL。这使得你可以专注于可视化数据，而不是编写代码！
- en: One of the benefits of VizQL is that it provides a common way of describing
    how the arrangement of various fields in a view defines a query related to the
    data. This common baseline can then be translated into numerous flavors of SQL,
    MDX, and **Tableau Query Language** (**TQL**, used for extracted data). Tableau
    will automatically perform the translation of VizQL into a native query to be
    run by the source data engine.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: VizQL 的一个好处是它提供了一种通用的方式来描述视图中各个字段的排列如何定义与数据相关的查询。这个通用的基准可以被转换成多种 SQL、MDX 和 **Tableau
    查询语言**（**TQL**，用于提取的数据）的变种。Tableau 会自动将 VizQL 转换为由源数据引擎执行的本地查询。
- en: 'In its simplest form, the Tableau paradigm of working with data looks like
    the following diagram:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在最简单的形式下，Tableau 处理数据的范式如下图所示：
- en: '![](img/B16021_02_01.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_01.png)'
- en: 'Figure 2.1: The basic Tableau paradigm for working with data'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.1：Tableau 处理数据的基本范式
- en: Let's look at how this paradigm works in a practical example.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过一个实际示例来看看这一范式是如何工作的。
- en: A simple example
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 一个简单的示例
- en: 'Open the `Chapter 02 Starter.twbx` workbook located in the `\Learning Tableau\Chapter
    02` directory and navigate to the `Tableau Paradigm` sheet. That view was created
    by dropping the **Region** dimension on **Columns** and the **Sales** measure
    on **Rows**. Here is a screenshot:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 打开位于 `\Learning Tableau\Chapter 02` 目录下的 `Chapter 02 Starter.twbx` 工作簿，并导航到
    `Tableau Paradigm` 表单。该视图是通过将 **Region** 维度拖放到 **Columns**，并将 **Sales** 度量拖放到
    **Rows** 创建的。以下是截图：
- en: '![](img/B16021_02_02.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_02.png)'
- en: 'Figure 2.2: This bar chart is the result of a query that returned four aggregate
    rows of data'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.2：此条形图是一个查询的结果，返回了四行聚合数据
- en: The view is defined by two fields. **Region** is the only dimension, which means
    it defines the level of detail in the view and slices the measure so that there
    will be a bar per region. **Sales** is used as a measure aggregated by summing
    each sale within each region. (Notice also that **Region** is discrete, resulting
    in column **headers** while **Sales** is continuous, resulting in an **axis**.)
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 视图由两个字段定义。**区域**是唯一的维度，意味着它定义了视图的细节级别，并切分度量，这样每个区域就会有一条条形图。**销售额**作为度量，通过在每个区域内求和每笔销售来聚合。（另请注意，**区域**是离散的，导致生成列
    **标题**，而**销售额**是连续的，导致生成 **轴**。）
- en: For the purpose of this example (although the principle is applicable to any
    data source), let's say you were connected live to a SQL Server database with
    the `Superstore` data stored in a table. When you first create the preceding screenshot,
    Tableau generates a VizQL script, which is translated into an SQL script and sent
    to the SQL Server. The SQL Server database engine evaluates the query and returns
    aggregated results to Tableau, which are then rendered visually.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 以本示例为例（尽管该原理适用于任何数据源），假设您通过实时连接到 SQL Server 数据库，其中 `Superstore` 数据存储在一张表中。当您首次创建上面的截图时，Tableau
    会生成一个 VizQL 脚本，这个脚本会被翻译为 SQL 脚本并发送到 SQL Server。SQL Server 数据库引擎评估查询并返回聚合结果到 Tableau，之后这些结果会以可视化形式呈现。
- en: 'The entire process would look something like the following diagram in Tableau''s
    paradigm:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 整个过程在 Tableau 的范式中看起来像下图所示：
- en: '![](img/B16021_02_03.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_03.png)'
- en: 'Figure 2.3: Tableau generated the bar chart in the previous image using a paradigm
    like this'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.3：Tableau 使用类似这样的范式生成了前面图片中的条形图
- en: There may have been hundreds, thousands, or even millions of rows of sales data
    in SQL Server. However, when SQL Server processes the query, it returns aggregate
    results. In this case, SQL Server returns only four aggregate rows of data to
    Tableau—one row for each region.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: SQL Server 中可能有数百、数千甚至数百万行销售数据。然而，当 SQL Server 处理查询时，它返回的是汇总结果。在这种情况下，SQL Server
    只返回四行汇总数据到 Tableau——每个区域一行。
- en: On occasion, a database administrator may want to find out what scripts are
    running against a certain database to debug performance issues or to determine
    more efficient indexing or data structures. Many databases supply profiling utilities
    or log execution of queries. In addition, you can find SQL or MDX generated by
    Tableau in the logs located in the `My Tableau Repository\Logs` directory.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，数据库管理员可能需要找出针对某个特定数据库正在执行的脚本，以便调试性能问题或确定更高效的索引或数据结构。许多数据库提供了分析工具或记录查询的执行。此外，您还可以在位于
    `My Tableau Repository\Logs` 目录中的日志文件中找到 Tableau 生成的 SQL 或 MDX 查询。
- en: You may also use Tableau's built-in **Performance Recorder** to locate the queries
    that have been executed. From the top menu, select **Help | Settings and Performance
    | Start Performance Recording**, then interact with a view, and finally, stop
    the recording from the menu. Tableau will open a dashboard that will allow you
    to see tasks, performance, and queries that were executed during the recording
    session.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以使用 Tableau 内置的 **性能记录器** 来定位已执行的查询。在顶部菜单中选择 **帮助 | 设置和性能 | 开始性能记录**，然后与视图交互，最后在菜单中停止记录。Tableau
    将打开一个仪表板，允许您查看在记录会话期间执行的任务、性能和查询。
- en: To see the aggregate data that Tableau used to draw the view, press *Ctrl +*
    *A* to select all the bars, and then right-click one of them and select **View
    Data**.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看 Tableau 用于绘制视图的汇总数据，按 *Ctrl +* *A* 选择所有条形图，然后右键点击其中一条，选择 **查看数据**。
- en: '![](img/B16021_02_04.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_04.png)'
- en: 'Figure 2.4: Use the View Data tooltip option to see a summary or underlying
    data for a mark'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.4：使用查看数据工具提示选项查看标记的摘要或基础数据
- en: 'This will reveal a **View Data** window:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示一个 **查看数据** 窗口：
- en: '![](img/B16021_02_05.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_05.png)'
- en: 'Figure 2.5: The Summary tab displays the aggregate data Tableau used to render
    each mark in the view'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.5：摘要选项卡显示 Tableau 用于渲染视图中每个标记的汇总数据
- en: 'The **View Data** screen allows you to observe the data in the view. The **Summary**
    tab displays the aggregate-level data that was used to render the view. The **Sales**
    values here are the sum of sales for each region. When you click the **Full Data**
    (previously named **Underlying**) tab, Tableau will query the data source to retrieve
    all the records that make up the aggregate records. In this case, there are **9,426**
    underlying records, as indicated on the status bar in the lower-right corner of
    the following screenshot:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**查看数据**屏幕允许你观察视图中的数据。**汇总**标签显示了用于渲染视图的汇总级别数据。这里的**销售额**是每个地区的销售总和。当你点击**完整数据**（之前称为**基础数据**）标签时，Tableau
    将查询数据源，检索所有构成汇总记录的记录。在这种情况下，基础记录有**9,426**条，如下图右下角状态栏所示：'
- en: '![](img/B16021_02_06.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_06.png)'
- en: 'Figure 2.6: The Full Data tab reveals the row-level data in the database'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.6：**完整数据**标签显示了数据库中的行级数据
- en: Tableau did not need **9,426** records to draw the view and did not request
    them from the data source until the **Full Data** data tab was clicked.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 不需要**9,426**条记录来绘制视图，并且直到点击**完整数据**数据标签时才会向数据源请求这些记录。
- en: Database engines are optimized to perform aggregations on data. Typically, these
    database engines are also located on powerful servers. Tableau leverages the optimization
    and power of the underlying data source. In this way, Tableau can visualize massive
    datasets with relatively little local processing of the data.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库引擎经过优化，可以对数据执行聚合操作。通常，这些数据库引擎也位于强大的服务器上。Tableau 利用底层数据源的优化和计算能力。通过这种方式，Tableau
    可以以相对较少的本地数据处理来可视化大量数据集。
- en: 'Additionally, Tableau will only query the data source when you make changes
    requiring a new query or a view refresh. Otherwise, it will use the aggregate
    results stored in a local cache, as illustrated here:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，只有在你进行需要新查询或视图刷新的更改时，Tableau 才会查询数据源。否则，它将使用存储在本地缓存中的汇总结果，如下所示：
- en: '![](img/B16021_02_07.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_07.png)'
- en: 'Figure 2.7: The first rendering with a given set of fields queries the data
    source directly. Subsequent renderings will query the cache, even if the same
    fields are re-arranged in the view'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.7：第一次渲染时，给定的一组字段会直接查询数据源。后续的渲染会查询缓存，即使相同的字段在视图中被重新排列。
- en: In the preceding example, the query with **Region** as a dimension and the sum
    of **Sales** as a measure will only be issued once to the data source. When the
    four rows of aggregated results are returned, they are stored in the cache. After
    the initial rendering, if you were to move **Region** to another visual encoding
    shelf, such as color, or **Sales** to a different visual encoding shelf, such
    as size, then Tableau will retrieve the aggregated rows from the cache and simply
    re-render the view.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的示例中，查询以**地区**作为维度和**销售额**的总和作为度量，仅会对数据源发出一次请求。当返回的四行汇总结果时，它们会被存储在缓存中。初次渲染之后，如果你将**地区**移动到另一个视觉编码架，比如颜色，或将**销售额**移动到另一个视觉编码架，比如大小，那么
    Tableau 会从缓存中获取汇总的行并重新渲染视图。
- en: You can force Tableau to bypass the cache and refresh the data from a data source
    by pressing *F5* or selecting your data source from the **Data** menu and selecting
    **Refresh**. Do this any time you want a view to reflect the most recent changes
    in a live data source.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过按下*F5*键，或从**数据**菜单中选择数据源并选择**刷新**，强制 Tableau 跳过缓存并从数据源刷新数据。每当你希望视图反映来自实时数据源的最新更改时，都可以这样做。
- en: If you were to introduce new fields into the view that did not have cached results,
    Tableau would send a new query to the data source, retrieve the aggregated results,
    and add those results to the cache.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你向视图中引入了没有缓存结果的新字段，Tableau 会向数据源发出新的查询，检索汇总结果，并将这些结果添加到缓存中。
- en: Connecting to data
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接到数据
- en: There is virtually no limit to the data that Tableau can visualize! Almost every
    new version of Tableau adds new native connectors. Tableau continues to add native
    connectors for cloud-based data. The **web data connector** allows you to write
    a connector for any online data you wish to retrieve. The **Tableau Hyper API**
    allows you to programmatically read and write extracts of data, enabling you to
    access data from any source and write it to a native Tableau format. Additionally,
    for any database without a built-in connection, Tableau gives you the ability
    to use a generic **ODBC** connection.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 几乎可以可视化任何数据！几乎每个新的 Tableau 版本都会添加新的原生连接器。Tableau 还在不断为基于云的数据添加原生连接器。**Web
    数据连接器**允许你为任何想要检索的在线数据编写连接器。**Tableau Hyper API** 允许你通过编程方式读取和写入数据提取，从而让你访问任何来源的数据并将其写入
    Tableau 原生格式。此外，对于没有内置连接的数据库，Tableau 允许你使用通用 **ODBC** 连接。
- en: You may have multiple data sources in the same workbook. Each source will show
    up under the **Data** tab on the left sidebar.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能在同一个工作簿中有多个数据源。每个数据源将在左侧边栏的 **数据** 选项卡下显示。
- en: 'Although the terms are often used interchangeably, it is helpful to make a
    distinction. A **connection** technically refers to the connection made to data
    in a single location, such as tables in a single database, or files of the same
    type in the same directory structure. A **data source** may contain more than
    one connection that can be joined together, such as a table in SQL Server joined
    to tables in a Snowflake database that are joined to an Excel table. You can think
    about it this way: a Tableau workbook may contain one or more data sources and
    each data source may contain one or more connections. We''ll maintain this distinction
    throughout the book.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这些术语经常交替使用，但做出区分是有帮助的。**连接**严格来说是指与单一位置数据的连接，例如同一数据库中的表，或同一目录结构中的相同类型的文件。**数据源**可以包含多个可以联合在一起的连接，比如
    SQL Server 中的表与 Snowflake 数据库中的表联合，再与 Excel 表联合。你可以这么理解：一个 Tableau 工作簿可能包含一个或多个数据源，而每个数据源可能包含一个或多个连接。本书中我们会保持这个区分。
- en: This section will focus on a few practical examples of connecting to various
    data sources. There's no way to cover every possible type of connection but we
    will cover several that are representative of others. You may or may not have
    access to some of the data sources in the following examples. Don't worry if you
    aren't able to follow each example. Merely observe the differences.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将重点介绍一些连接到各种数据源的实际示例。无法覆盖所有可能的连接类型，但我们将介绍几个具有代表性的例子。你可能没有权限访问以下示例中的某些数据源。如果无法跟随每个示例，也无需担心，重点是观察它们之间的差异。
- en: Connecting to data in a file
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接到文件中的数据
- en: 'File-based data includes all sources of data where the data is stored in a
    file. File-based data sources include the following:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 文件数据包括所有存储在文件中的数据源。文件数据源包括以下类型：
- en: '**Extracts**: A `.hyper` or `.tde` file containing data that was extracted
    from an original source.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**提取文件**：一个 `.hyper` 或 `.tde` 文件，包含从原始数据源提取的数据。'
- en: '**Microsoft Access**: An `.mdb` or `.accdb` database file created in Access.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Microsoft Access**：一个 `.mdb` 或 `.accdb` 数据库文件，在 Access 中创建。'
- en: '**Microsoft Excel:** An `.xls`, `.xlsx`, or `.xlsm` spreadsheet created in
    Excel. Multiple Excel sheets or sub-tables may be joined or unioned together in
    a single connection.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Microsoft Excel**：在 Excel 中创建的 `.xls`、`.xlsx` 或 `.xlsm` 电子表格。多个 Excel 表格或子表格可以通过单一连接进行合并或联合。'
- en: '**Text file**: A delimited text file, most commonly `.txt`, `.csv`, or `.tab`.
    Multiple text files in a single directory may be joined or unioned together in
    a single connection.'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文本文件**：一个分隔符文本文件，最常见的是 `.txt`、`.csv` 或 `.tab`。多个文本文件可以在单一目录中通过连接合并或联合在一起。'
- en: '**Local cube file**: A `.cub` file that contains multi-dimensional data. These
    files are typically exported from OLAP databases.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**本地数据立方体文件**：一个 `.cub` 文件，包含多维数据。这些文件通常从 OLAP 数据库中导出。'
- en: '**Adobe PDF**: A`.pdf` file that may contain tables of data that can be parsed
    by Tableau.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Adobe PDF**：一个 `.pdf` 文件，可能包含 Tableau 可解析的表格数据。'
- en: '**Spatial file**: A wide variety of spatial formats are supported such as `.kml`,
    `.shp`, `.tab`, `.mif`, spatial JSON, and ESRI database files. These formats contain
    spatial objects that can be rendered by Tableau.'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**空间文件**：支持多种空间格式，如 `.kml`、`.shp`、`.tab`、`.mif`、空间 JSON 和 ESRI 数据库文件。这些格式包含可以被
    Tableau 渲染的空间对象。'
- en: '**Statistical file**: A `.sav`, `.sas7bdat`, `.rda`, or `.rdata` file generated
    by statistical tools, such as SAS or R.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**统计文件**：由统计工具生成的`.sav`、`.sas7bdat`、`.rda`或`.rdata`文件，例如SAS或R。'
- en: '**JSON** **file**: A `.json` file that contains data in JSON format.'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**JSON** **文件**：一个包含JSON格式数据的`.json`文件。'
- en: In addition to those mentioned previously, you can connect to Tableau files
    to import connections that you have saved in another Tableau workbook (`.twb`
    or `.twbx`). The connection will be imported, and changes will only affect the
    current workbook.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 除了前面提到的连接方式，你还可以连接到Tableau文件，以导入你在其他Tableau工作簿中保存的连接（`.twb`或`.twbx`）。连接将被导入，且更改仅会影响当前工作簿。
- en: 'Follow this example to see a connection to an Excel file:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 按照这个示例查看连接到Excel文件的方式：
- en: Navigate to the **Connect to Excel** sheet in the `Chapter 02 Starter.twbx`
    workbook.
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`Chapter 02 Starter.twbx`工作簿中，导航至**连接到Excel**工作表。
- en: From the menu, select **Data | New Data Source** and select **Microsoft Excel**
    from the list of possible connections.
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从菜单中选择**数据 | 新建数据源**，然后从可能的连接列表中选择**Microsoft Excel**。
- en: In the open dialogue, open the `Superstore.xlsx` file from the `\Learning Tableau\Chapter
    02` directory. Tableau will open the **Data Source** screen. You should see the
    two sheets of the Excel document listed on the left.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在开放的对话框中，从`\Learning Tableau\Chapter 02`目录打开`Superstore.xlsx`文件。Tableau将打开**数据源**界面。你应该能在左侧看到Excel文档中的两个工作表。
- en: Double-click the **Orders** sheet and then the **Returns** sheet. Tableau will
    prompt you with an **Edit Relationship** dialog. We'll cover relationships in
    depth in *Chapter 13*, *Understanding the Tableau Data Model, Joins, and Blends*.
    For now, accept the defaults by closing the dialog.
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击**订单**工作表，然后双击**退货**工作表。Tableau会弹出**编辑关系**对话框。我们将在*第13章*《理解Tableau数据模型、连接和合并》中详细介绍关系。现在，关闭对话框以接受默认设置。
- en: 'Your data source screen should look similar to the following screenshot:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 你的数据源界面应该与以下截图类似：
- en: '![](img/B16021_02_08.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_08.png)'
- en: 'Figure 2.8: The data source screen with two objects (Orders and Returns)'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.8：包含两个对象（订单和退货）的数据源界面
- en: 'Take some time to familiarize yourself with the **Data Source** screen interface,
    which has the following features (numbered in the preceding screenshot):'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 花些时间熟悉**数据源**界面的操作，该界面具有以下功能（在前面的截图中已编号）：
- en: '**Toolbar**: The toolbar has a few of the familiar controls, including undo,
    redo, and save. It also includes the option to refresh the current data source.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**工具栏**：工具栏包含一些常用的控件，包括撤销、重做和保存。它还包括刷新当前数据源的选项。'
- en: '**Connections**: All the connections in the current data source. Click **Add**
    to add a new connection to the current data source. This allows you to join data
    across different connection types. Each connection will be color-coded so that
    you can distinguish what data is coming from which connection.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**连接**：当前数据源中的所有连接。点击**添加**以向当前数据源添加新的连接。这使你可以跨不同连接类型联合数据。每个连接会用颜色标识，以便区分数据来自哪个连接。'
- en: '**Sheets (or Tables)**: This lists all the tables of data available for a given
    connection. This includes sheets, sub-tables, and named ranges for Excel; tables,
    views, and stored procedures for relational databases; and other connection-dependent
    options, such as **New Union** or **Custom SQL**.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**工作表（或表格）**：列出给定连接的所有数据表。这包括Excel的工作表、子表和命名区域；关系型数据库的表、视图和存储过程；以及其他与连接相关的选项，例如**新建联合**或**自定义SQL**。'
- en: '**Data Source Name**: This is the name of the currently selected data source.
    You may select a different data source using the drop-down arrow next to the database
    icon. You may click the name of the data source to edit it.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据源名称**：这是当前选择的数据源的名称。你可以使用数据库图标旁的下拉箭头选择其他数据源。点击数据源的名称可以进行编辑。'
- en: '**Object / Data Model Canvas**: Drop sheets and tables from the left into this
    area to make them part of the connection. You may add additional tables by dragging
    and dropping or double-clicking them. Each will be added as an object to the object
    model. You may also add tables as unions or double-click an object to edit the
    underlying tables and joins. We''ll cover the details extensively in *Chapter
    13*, *Understanding the Tableau Data Model, Joins, and Blends*. For now, simply
    note that Orders and Returns are related together by the Order ID.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**对象/数据模型画布**：将左侧的表单和表格拖动到此区域，以使其成为连接的一部分。你可以通过拖放或双击它们来添加额外的表格。每个表格将作为对象添加到对象模型中。你还可以将表格添加为联合，或双击对象以编辑底层表格和连接。我们将在*第13章*中详细讲解这些内容，*理解
    Tableau 数据模型、连接和混合*。现在，只需注意，订单和退货是通过订单 ID 关联在一起的。'
- en: '**Live** **or** **Extract** **Options**: For many data sources, you may choose
    whether you would like to have a live connection or an extracted connection. We''ll
    look at these in further detail later in the chapter.'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**实时** **或** **提取** **选项**：对于许多数据源，你可以选择使用实时连接或提取连接。我们将在本章后面详细介绍这些内容。'
- en: '**Data Source** **Filters**: You may add filters to the data source. These
    will be applied at the data-source level, and thus to all views of the data using
    this data source in the workbook.'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据源** **筛选器**：你可以为数据源添加筛选器。筛选器将在数据源级别应用，因此会影响工作簿中使用该数据源的所有视图。'
- en: '**Preview Pane Options**: These options allow you to specify whether you''d
    like to see a preview of the data or a list of metadata, and how you would like
    to preview the data (examples include alias values, hidden fields shown, and how
    many rows you''d like to preview).'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预览窗格选项**：这些选项允许你指定是否希望查看数据预览或元数据列表，并且可以选择如何预览数据（例如，别名值、显示隐藏字段、以及希望预览多少行数据）。'
- en: '**Preview Pane/Metadata View**: Depending on your selection in the options,
    this space either displays a preview of data or a list of all fields with additional
    metadata. Notice that these views give you a wide array of options, such as changing
    data types, hiding or renaming fields, and applying various data transformation
    functions. We''ll consider some of these options in this and later chapters.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预览窗格/元数据视图**：根据你在选项中的选择，这个区域要么显示数据预览，要么显示所有字段及其附加的元数据。请注意，这些视图为你提供了广泛的选项，例如更改数据类型、隐藏或重命名字段以及应用各种数据转换功能。我们将在本章以及后续章节中探讨其中的一些选项。'
- en: Once you have created and configured your data source, you may click any sheet
    to start using it.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你创建并配置了数据源，就可以点击任何表单开始使用它。
- en: 'Conclude this exercise with the following steps:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此练习的步骤如下：
- en: Click the data source name to edit the text and rename the data source to `Orders
    and Returns`.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击数据源名称编辑文本，并将数据源重命名为 `Orders and Returns`。
- en: Navigate to the **Connect to Excel** sheet and, using the `Orders and Returns`
    data source, create a time series showing **Returns (Count)** by **Return Reason**.
    Your view should look like the following screenshot:![](img/B16021_02_09.png)
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**连接到 Excel** 表单，并使用 `Orders and Returns` 数据源，创建一个显示**退货数量**按**退货原因**分类的时间序列。你的视图应如下图所示：![](img/B16021_02_09.png)
- en: 'Figure 2.9: The number of returns by return reason'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.9：按退货原因分类的退货数量
- en: If you need to edit the connection at any time, select **Data** from the menu,
    locate your connection, and then select **Edit Data Source...**. Alternately,
    you may right-click any data source under the **Data** tab on the left sidebar
    and select **Edit Data Source...**, or click the **Data Source** tab in the lower-left
    corner. You may access the data source screen at any time by clicking the **Data
    Source** tab in the lower-left corner of Tableau Desktop.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要随时编辑连接，请从菜单中选择**数据**，找到你的连接，然后选择**编辑数据源...**。或者，你可以右键单击左侧边栏中的任何数据源，并选择**编辑数据源...**，或者点击左下角的**数据源**选项卡。你可以通过点击
    Tableau Desktop 左下角的**数据源**选项卡随时访问数据源界面。
- en: Connecting to data on a server
  id: totrans-87
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接到服务器上的数据
- en: Database servers, such as SQL Server, Snowflake, Vertica, and Oracle, host data
    on one or more server machines and use powerful database engines to store, aggregate,
    sort, and serve data based on queries from client applications. Tableau can leverage
    the capabilities of these servers to retrieve data for visualization and analysis.
    Alternately, data can be extracted from these sources and stored in an extract.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库服务器，如 SQL Server、Snowflake、Vertica 和 Oracle，将数据托管在一台或多台服务器上，并使用强大的数据库引擎根据客户端应用程序的查询存储、汇总、排序和提供数据。Tableau
    可以利用这些服务器的功能来提取数据进行可视化和分析。或者，数据可以从这些源中提取并存储在提取文件中。
- en: As an example of connecting to a server data source, we'll demonstrate connecting
    to SQL Server. If you have access to a server-based data source, you may wish
    to create a new data source and explore the details. However, this specific example
    is not included in the workbook in this chapter.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 作为连接到服务器数据源的示例，我们将演示如何连接到 SQL Server。如果您有访问基于服务器的数据源的权限，您可能希望创建一个新的数据源并探索其详细信息。然而，这个特定的示例没有包含在本章的工作簿中。
- en: 'As soon as the Microsoft SQL Server connection is selected, the interface displays
    options for some initial configuration as follows:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦选择了 Microsoft SQL Server 连接，界面会显示一些初步配置选项，如下所示：
- en: '![](img/B16021_02_10.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_10.png)'
- en: 'Figure 2.10: The connection editor for Microsoft SQL Server'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.10：Microsoft SQL Server 的连接编辑器
- en: A connection to SQL Server requires the **Server** name, as well as authentication
    information.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 连接到 SQL Server 需要 **服务器** 名称以及身份验证信息。
- en: A database administrator can configure SQL Server to **Use Windows Authentication**
    or a SQL Server username and password. With SQL Server, you can also optionally
    allow reading uncommitted data. This can potentially improve performance but may
    also lead to unpredictable results if data is being inserted, updated, or deleted
    at the same time as Tableau is querying. Additionally, you may specify SQL to
    be run at connect time using the **Initial SQL...** link in the lower-left corner.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库管理员可以配置 SQL Server 使用 **Windows 身份验证** 或 SQL Server 用户名和密码。通过 SQL Server，您还可以选择允许读取未提交的数据。这可能会提高性能，但如果数据在
    Tableau 查询时同时被插入、更新或删除，可能会导致不可预测的结果。此外，您可以通过左下角的 **初始 SQL...** 链接指定在连接时运行的 SQL。
- en: In order to maintain high standards of security, Tableau will not save a password
    as part of a data source connection. This means that if you share a workbook using
    a live connection with someone else, they will need to have credentials to access
    the data. This also means that when you first open the workbook, you will need
    to re-enter your password for any connections requiring a password.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保持高标准的安全性，Tableau 不会将密码作为数据源连接的一部分进行保存。这意味着，如果您使用实时连接与他人共享工作簿，他们需要有访问数据的凭据。这也意味着，当您首次打开工作簿时，对于任何需要密码的连接，您需要重新输入密码。
- en: 'Once you click the orange **Sign In** button, you will see a screen that is
    very similar to the connection screen you saw for Excel. The main difference is
    on the left, where you have an option for selecting a **Database**, as shown in
    the following screenshot:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦点击橙色的 **登录** 按钮，您将看到一个与您之前看到的 Excel 连接界面非常相似的界面。主要的区别在于左侧，您有一个选择 **数据库** 的选项，如下图所示：
- en: '![](img/B16021_02_11.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_11.png)'
- en: 'Figure 2.11: Once connected to a database, Tableau will display tables, views,
    and stored procedures as options to add to the object model'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.11：一旦连接到数据库，Tableau 将显示表、视图和存储过程作为添加到对象模型的选项
- en: 'Once you''ve selected a database, you will see the following:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦选择了数据库，您将看到以下内容：
- en: '**Table**: This shows any data tables or views contained in the selected database.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**表格**：此处显示选定数据库中的任何数据表或视图。'
- en: '**New Custom SQL**: You may write your own custom SQL scripts and add them
    as tables. You may join these as you would any other table or view.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**新建自定义 SQL**：您可以编写自己的自定义 SQL 脚本并将其作为表添加。您可以像其他任何表或视图一样联接这些表。'
- en: '**New Union**: You may union together tables in the database. Tableau will
    match fields based on name and data type, and you may additionally merge fields
    as needed.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**新建联合**：您可以将数据库中的表联合在一起。Tableau 会根据名称和数据类型匹配字段，并根据需要额外合并字段。'
- en: '**Stored Procedures**: You may use a stored procedure that returns a table
    of data. You will be given the option of setting values for stored procedure parameters
    or using or creating a Tableau parameter to pass values.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**存储过程**：您可以使用返回数据表的存储过程。您将有机会为存储过程参数设置值，或使用或创建一个Tableau参数来传递值。'
- en: Once you have finished configuring the connection, click a tab for any sheet
    to begin visualizing the data.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完连接后，点击任意工作表的标签页以开始可视化数据。
- en: Using extracts
  id: totrans-105
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用提取
- en: 'Any data source that is using an extract will have a distinctive icon that
    indicates the data has been pulled from an original source into an extract, as
    shown in the following screenshot:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 使用提取的数据源将有一个独特的图标，表示数据已从原始数据源提取到提取中，如以下截图所示：
- en: '![](img/B16021_02_12.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_12.png)'
- en: 'Figure 2.12: The icon next to a data source indicates whether it is extracted
    or not'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.12：数据源旁边的图标指示其是否已提取
- en: 'The first data connection in the preceding data pane is extracted, while the
    second is not. After an extract has been created, you may choose to use the extract
    or not. When you right-click a data source (or **Data** from the menu and then
    the data source), you will see the following menu options:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 前面数据窗格中的第一个数据连接已被提取，而第二个则没有。在创建提取后，您可以选择是否使用该提取。右键点击数据源（或从菜单中选择**数据**，然后选择数据源），您将看到以下菜单选项：
- en: '![](img/B16021_02_13.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_13.png)'
- en: 'Figure 2.13: The context menu for a data connection in the Data pane with Extract
    options numbered'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.13：数据窗格中数据连接的上下文菜单，提取选项标注编号
- en: 'Let''s cover them in more detail:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更详细地介绍它们：
- en: '**Refresh**: The **Refresh** option under the data source simply tells Tableau
    to refresh the local cache of data. With a live data source, this would re-query
    the underlying data. With an extracted source, the cache is cleared and the extract
    is required, but this **Refresh** option does not update the extract from the
    original source. To do that, use **Refresh** under the **Extract** sub-menu (see
    number 4 in this list).'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**刷新**：数据源下的**刷新**选项仅告知Tableau刷新本地数据缓存。对于实时数据源，这将重新查询底层数据。对于已提取的数据源，将清除缓存并要求使用提取，但此**刷新**选项不会更新提取中的数据。如果要更新提取，请使用**提取**子菜单中的**刷新**选项（参见此列表中的编号4）。'
- en: '**Extract Data...**: This creates a new extract from the data source (replacing
    an existing extract if it exists).'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**提取数据...**：此选项将从数据源创建一个新的提取（如果已有提取，则会替换原提取）。'
- en: '**Use Extract**: This option is enabled if there is an extract for a given
    data source. Unchecking the option will tell Tableau to use a live connection
    instead of the extract. The extract will not be removed and may be used again
    by checking this option at any time. If the original data source is not available
    to this workbook, Tableau will ask where to find it.'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**使用提取**：如果某个数据源有提取，此选项将被启用。取消选中此选项将告诉Tableau使用实时连接，而非提取。提取不会被删除，您可以随时通过勾选此选项再次使用它。如果原始数据源对当前工作簿不可用，Tableau将询问数据源的存放位置。'
- en: '**Refresh**: This **Refresh** option refreshes the extract with data from the
    original source. It does not optimize the extract for some changes you make (such
    as hiding fields or creating new calculations).'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**刷新**：此**刷新**选项将使用原始数据源的数据刷新提取。它不会优化由于您进行的某些更改（例如隐藏字段或创建新的计算）而产生的提取。'
- en: '**Append Data from File...** or **Append Data from Data Source…**:These options
    allow you to append additional files or data sources to an existing extract, provided
    they have the same exact data structure as the original source. This adds rows
    to your existing extract; it will not add new columns.'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**从文件追加数据...** 或 **从数据源追加数据...**：这些选项允许您将其他文件或数据源追加到现有提取中，前提是它们与原始数据源具有完全相同的数据结构。这将向现有提取中添加行；不会添加新的列。'
- en: '**Compute Calculations Now**: This will restructure the extract, based on changes
    you''ve made since originally creating the extract, to make it as efficient as
    possible. Certain calculated fields may be *materialized* (that is, calculated
    once so that the resulting value can be stored) and newly hidden columns or deleted
    calculations will be removed from the extract.'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**立即计算计算字段**：此操作将根据自初次创建提取以来您所做的更改，重新结构化提取，以提高其效率。某些计算字段可能会被*物化*（即，计算一次，以便可以存储计算结果值），新隐藏的列或删除的计算将从提取中移除。'
- en: '**Remove**: This removes the definition of the extract, optionally deletes
    the extract file, and resumes a live connection to the original data source.'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**删除**：这将删除提取的定义，选择性地删除提取文件，并恢复与原始数据源的实时连接。'
- en: '**History**: This allows you to view the history of the extract and refreshes.'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**历史记录**：这允许你查看提取和刷新历史。'
- en: '**Properties**: This enables you to view the properties of the extract, such
    as the location, underlying source, filters, and row limits.'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**属性**：这使你能够查看提取的属性，例如位置、底层数据源、筛选器和行限制。'
- en: Let's next consider the performance ramifications of using extracts.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来我们来考虑使用提取的性能影响。
- en: Connecting to data in the cloud
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接到云端数据
- en: Certain data connections are made to data that is hosted in the cloud. These
    include **Amazon RDS**, **Google BigQuery**, **Microsoft SQL Azure**, **Snowflake**,
    **Salesforce**, **Google Sheets**, and many others. It is beyond the scope of
    this book to cover each connection in depth, but as an example of a cloud data
    source, we'll consider connecting to Google Sheets.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 某些数据连接是连接到托管在云端的数据。这些包括**Amazon RDS**、**Google BigQuery**、**Microsoft SQL Azure**、**Snowflake**、**Salesforce**、**Google
    Sheets**等。详细介绍每种连接超出了本书的范围，但作为一个云数据源的示例，我们将考虑连接到Google Sheets。
- en: Google Sheets allows users to create and maintain spreadsheets of data online.
    Sheets may be shared and collaborated on by many different users. Here, we'll
    walk through an example of connecting to a sheet that is shared via a link.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: Google Sheets允许用户在线创建和维护数据表格。表格可以由多个不同的用户共享和协作。在这里，我们将演示如何连接到一个通过链接共享的表格。
- en: 'To follow the example, you''ll need a free Google account. With your credentials,
    follow these steps:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 为了跟随这个示例，你需要一个免费的Google帐户。使用你的凭据，按以下步骤操作：
- en: Click the **Add new data source** button on the toolbar, as shown here:![](img/B16021_02_14.png)
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击工具栏上的**添加新数据源**按钮，如下所示：![](img/B16021_02_14.png)
- en: 'Figure 2.14: The Add Data button'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.14：添加数据按钮
- en: Select **Google Sheets** from the list of possible data sources. You may use
    the search box to quickly narrow the list.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从可能的数据源列表中选择**Google Sheets**。你可以使用搜索框快速缩小列表范围。
- en: On the next screen, sign in to your Google account and allow Tableau Desktop
    the appropriate permissions. You will then be presented with a list of all your
    Google Sheets, along with preview and search capabilities, as shown in the following
    screenshot:![](img/B16021_02_15.png)
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一屏幕上，登录你的Google帐户并允许Tableau Desktop获得适当的权限。然后，你将看到所有Google Sheets的列表，并可以预览和搜索，如下图所示：![](img/B16021_02_15.png)
- en: 'Figure 2.15: You may select any Google Sheet you have permissions to view or
    you may enter the URL for a shared sheet'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.15：你可以选择任何你有权限查看的Google Sheet，或者你可以输入共享表格的URL。
- en: 'Enter the following URL (for convenience, it is included in the `Chapter 02
    Starter` workbook in the **Connect to Google Sheets** tab, and may be copied and
    pasted) into the search box and click the **Search** button: [https://docs.google.com/spreadsheets/d/1fWMGkPt0o7sdbW50tG4QLSZDwkjNO9X0mCkw-LKYu1A/edit?usp=sharing](https://docs.google.com/spreadsheets/d/1fWMGkPt0o7sdbW50tG4QLSZDwkjNO9X0mCkw-LKYu1A/edit?usp=sharing):'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下URL输入到搜索框中（为了方便，它已包含在`Chapter 02 Starter`工作簿的**连接到Google Sheets**标签页中，可以复制粘贴）：[https://docs.google.com/spreadsheets/d/1fWMGkPt0o7sdbW50tG4QLSZDwkjNO9X0mCkw-LKYu1A/edit?usp=sharing](https://docs.google.com/spreadsheets/d/1fWMGkPt0o7sdbW50tG4QLSZDwkjNO9X0mCkw-LKYu1A/edit?usp=sharing)，然后点击**搜索**按钮：
- en: Select the resulting `Superstore` sheet in the list and then click the **Connect**
    button. You should now see the **Data Source** screen.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在列表中选择结果中的`Superstore`表格，然后点击**连接**按钮。你现在应该能看到**数据源**屏幕。
- en: Click the **Data Source** name to rename it to `Superstore (Google Sheets)`:![](img/B16021_02_16.png)
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**数据源**名称，将其重命名为`Superstore (Google Sheets)`：![](img/B16021_02_16.png)
- en: 'Figure 2.16: Renaming a Data Source'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.16：重命名数据源
- en: For the purpose of this example, switch the connection option from **Live**
    to **Extract**. When connecting to your own Google Sheets data, you may choose
    either **Live** or **Extract**:![](img/B16021_02_17.png)
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本示例中，将连接选项从**Live**切换为**Extract**。当连接到你自己的Google Sheets数据时，你可以选择**Live**或**Extract**：![](img/B16021_02_17.png)
- en: 'Figure 2.17: Switch between Live and Extract, Edit extract options, and Add
    Filters'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.17：在Live和Extract之间切换，编辑提取选项，并添加筛选器
- en: Click the tab for the **Connect to Google Sheets** sheet. You will be prompted
    for a location to save the extract. Accept the default name and save it in the
    `Learning Tableau\Chapter 02` directory (selecting **Yes** to overwrite the existing
    file if needed). The data should be extracted within a few seconds.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**连接到 Google 表格**选项卡。系统会提示你选择保存提取文件的位置。接受默认名称，并将其保存在`Learning Tableau\Chapter
    02`目录下（如果需要，选择**是**来覆盖现有文件）。数据应在几秒钟内完成提取。
- en: Create a filled map of **Profit** by **State**, with **Profit** defining the
    **Color** and **Label**:![](img/B16021_02_18.png)
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建按**州**划分的**利润**填充地图，**利润**定义**颜色**和**标签**：![](img/B16021_02_18.png)
- en: 'Figure 2.18: The filled map demonstrates the ability to connect to a cloud-based
    data source'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.18：填充地图演示了连接到云端数据源的能力
- en: If your location is outside the United States, you may need to change your regional
    settings for Tableau to properly show the states in the map. Use the menu and
    select **File** | **Workbook Locale** | **More** and select **English (United
    States)**.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你所在的位置在美国之外，你可能需要更改 Tableau 的区域设置，以便正确显示地图中的州。使用菜单并选择**文件** | **工作簿区域设置**
    | **更多**，然后选择**英语（美国）**。
- en: Now that we've seen a few specific examples of connecting to data, let's consider
    some shortcuts and how to manage our data sources.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经看过了几个连接数据的具体示例，让我们来看一些快捷方式以及如何管理我们的数据源。
- en: Shortcuts for connecting to data
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接数据的快捷方式
- en: 'You can make certain connections very quickly. These options will allow you
    to begin analyzing more quickly:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以非常快速地进行某些连接。以下选项将帮助你更快速地开始分析：
- en: Paste data from the clipboard. If you have copied data in your system's clipboard
    from any source (for example, a spreadsheet, a table on a web page, or a text
    file), you can then paste the data directly into Tableau. This can be done using
    *Ctrl + V*, or **Data | Paste Data** from the menu. The data will be stored as
    a file and you will be alerted to its location when you save the workbook.
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从剪贴板粘贴数据。如果你从系统剪贴板复制了数据（例如，电子表格、网页上的表格或文本文件），你可以将数据直接粘贴到 Tableau 中。可以使用*Ctrl
    + V*，或者从菜单中选择**数据 | 粘贴数据**。数据将作为文件存储，当你保存工作簿时，会提示数据的位置。
- en: Select**File | Open**from the menu. This will allow you to open any data file
    that Tableau supports, such as text files, Excel files, Access files (not available
    on macOS), spatial files, statistical files, JSON, and even offline cube (`.cub`)
    files.
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从菜单中选择**文件 | 打开**。这将允许你打开 Tableau 支持的任何数据文件，如文本文件、Excel 文件、Access 文件（macOS 上不可用）、空间文件、统计文件、JSON
    甚至离线立方体（`.cub`）文件。
- en: Drag and drop a file from Windows Explorer or Finder onto the Tableau workspace.
    Any valid file-based data source can be dropped onto the Tableau workspace or
    even the Tableau shortcut on your desktop or taskbar.
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从 Windows 资源管理器或 Finder 拖放文件到 Tableau 工作区。任何有效的基于文件的数据源都可以拖放到 Tableau 工作区，甚至可以拖放到桌面或任务栏上的
    Tableau 快捷方式。
- en: Duplicate an existing data source. You can duplicate an existing data source
    by right-clicking and selecting **Duplicate**.
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 复制现有的数据源。你可以通过右键单击并选择**复制**来复制现有的数据源。
- en: These shortcuts provide a quick way for analyzing the data you need. Let's turn
    our attention to managing the data sources.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 这些快捷方式提供了一种快速分析所需数据的方法。接下来，让我们集中精力管理数据源。
- en: Managing data source metadata
  id: totrans-150
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管理数据源元数据
- en: Data sources in Tableau store information about the connection(s). In addition
    to the connection itself (for example, database server name, database, and/or
    filenames), the data source also contains information about all the fields available
    (such as field name, data type, default format, comments, and aliases). Often,
    this *data about the data* is referred to as **metadata**.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 中的数据源存储有关连接的信息。除了连接本身（例如，数据库服务器名称、数据库和/或文件名），数据源还包含有关所有可用字段的信息（例如字段名称、数据类型、默认格式、注释和别名）。通常，这些*关于数据的数据*被称为**元数据**。
- en: 'Right-clicking a field in the data pane reveals a menu of metadata options.
    Some of these options will be demonstrated in a later exercise; others will be
    explained throughout the book. These are some of the options available via right-clicking:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在数据面板中右键单击字段，弹出菜单会显示元数据选项。部分选项将在后面的练习中演示；其他选项将在本书中详细解释。以下是通过右键单击可以使用的一些选项：
- en: Renaming the field
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 重命名字段
- en: Hiding the field
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 隐藏字段
- en: Changing aliases for values of a non-date dimension
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改非日期维度值的别名
- en: Creating calculated fields, groups, sets, bins, or parameters
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建计算字段、分组、集合、区间或参数
- en: Splitting the field
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拆分字段
- en: Changing the default use of a date or numeric field to either discrete or continuous
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改日期或数字字段的默认使用方式，选择离散或连续
- en: Redefining the field as a dimension or a measure
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将字段重新定义为维度或度量
- en: Changing the data type of the field
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改字段的数据类型
- en: Assigning a geographic role to the field
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为字段分配地理角色
- en: Changing defaults for how a field is displayed in a visualization, such as the
    default colors and shapes, number or date format, sort order (for dimensions),
    or type of aggregation (for measures)
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改字段在可视化中显示的默认设置，例如默认颜色和形状、数字或日期格式、排序顺序（对于维度）或聚合类型（对于度量）
- en: Adding a default comment for a field (which will be shown as a tooltip when
    hovering over a field in the data pane, or shown as part of the description when
    **Describe...** is selected from the menu)
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为字段添加默认注释（当在数据面板中将鼠标悬停在字段上时，注释将作为工具提示显示，或者当从菜单中选择**描述...**时，注释会作为描述的一部分显示）
- en: Adding or removing the field from a hierarchy
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在层次结构中添加或移除字段
- en: Metadata options that relate to the visual display of the field, such as default
    sort order or default number format, define the overall default for a field. However,
    you can override the defaults in any individual view by right-clicking the active
    field on the shelf and selecting the desired options.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 与字段的可视化显示相关的元数据选项，例如默认排序顺序或默认数字格式，定义了字段的整体默认值。然而，你可以通过右键点击货架上的活动字段并选择所需选项，在任何单独的视图中覆盖这些默认值。
- en: 'To see how this works, use the filled map view of `Profit` by `State` that
    you created in the **Connect to Google Sheets** view. If you did not create this
    view, you may use the **Orders and Returns** data source, though the resulting
    view will be slightly different. With the filled map in front of you, follow these
    steps:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看这个效果，可以使用在**连接到 Google 表格**视图中创建的按州分类的`利润`填充地图视图。如果你没有创建此视图，可以使用**订单与退货**数据源，尽管结果视图会略有不同。打开填充地图后，按照以下步骤操作：
- en: Right-click the **Profit** field in the data pane and select **Default Properties**
    | **Number Format...**. The resulting dialog gives you many options for numeric
    format.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击数据面板中的**利润**字段，并选择**默认属性** | **数字格式...**。弹出的对话框会提供多种数字格式选项。
- en: Set the number format to **Currency (Custom)** with `0` **Decimal places** and
    the **Display Units** in `Thousands (K)`. After clicking **OK**, you should notice
    that the labels on the map have updated to include currency notation:![](img/B16021_02_19.png)
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数字格式设置为**货币（自定义）**，并将`0`**小数位数**和**显示单位**设置为`千（K）`。点击**确定**后，你应该会注意到地图上的标签已更新，包括货币符号：![](img/B16021_02_19.png)
- en: 'Figure 2.19: Editing the default number format of a field'
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.19：编辑字段的默认数字格式
- en: Right-click the **Profit** field again and select **Default properties** | **Color...**.
    The resulting dialog gives you an option to select and customize the default color
    encoding of the **Profit** field. Experiment with various palettes and settings.
    Notice that every time you click the **Apply** button, the visualization updates.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次右键点击**利润**字段并选择**默认属性** | **颜色...**。弹出的对话框将提供一个选项，让你选择并自定义**利润**字段的默认颜色编码。可以尝试不同的色板和设置。每次点击**应用**按钮时，可视化都会更新。
- en: Diverging palettes (palettes that blend from one color to another) work particularly
    well for fields such as **Profit**, which can have negative and positive values.
    The default center of `0` allows you to easily tell what values are positive or
    negative based on the color shown.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 发散色板（从一种颜色渐变到另一种颜色的色板）对于像**利润**这样的字段尤其有效，因为它可以具有负值和正值。默认的`0`中心可以让你轻松地通过显示的颜色分辨哪些值是正数，哪些值是负数。
- en: '![](img/B16021_02_20.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_20.png)'
- en: 'Figure 2.20: Customizing color'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.20：自定义颜色
- en: Because you have set the default format for the field at the data-source level,
    any additional views you create using **Profit** will include the default formatting
    you specified.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 由于你在数据源级别设置了字段的默认格式，因此你创建的任何使用**利润**的视图都将包含你指定的默认格式。
- en: Consider using color blind-safe colors in your visualizations. Orange and blue
    are usually considered a color blind-safe alternative to red and green. Tableau
    also includes a discrete color blind-safe palette. Additionally, consider adjusting
    the intensity of the colors, using labels, or different visualizations to make
    your visualizations more accessible.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的可视化中考虑使用色盲安全色。橙色和蓝色通常被认为是红色和绿色的色盲安全替代色。Tableau还包含了一个离散的色盲安全色板。此外，考虑调整颜色的强度，使用标签或不同的可视化方式，以使你的可视化更具可访问性。
- en: Working with extracts instead of live connections
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用提取代替实时连接
- en: Nearly all data sources allow the option of either connecting live or extracting
    the data. A few cloud-based data sources require an extract. Conversely, OLAP
    data sources cannot be extracted and require live connections.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎所有数据源都允许选择实时连接或提取数据。少数基于云的数据源要求必须进行提取。相反，OLAP 数据源无法提取，必须使用实时连接。
- en: 'Extracts extend the way in which Tableau works with data. Consider the following
    diagram:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 提取扩展了 Tableau 操作数据的方式。请参考以下示意图：
- en: '![](img/B16021_02_21.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_21.png)'
- en: 'Figure 2.21: Data from the original Data Source is extracted into a self-contained
    snapshot of the data'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.21：原始数据源的数据被提取到一个自包含的数据快照中
- en: When using a live connection, Tableau issues queries directly to the data source
    (or uses data in the cache, if possible). When you extract the data, Tableau pulls
    some or all of the data from the original source and stores it in an extract file.
    Prior to version 10.5, Tableau used a Tableau Data Extract (`.tde`) file. Starting
    with version 10.5, Tableau uses Hyper extracts (`.hyper`) and will convert `.tde`
    files to `.hyper` as you update older workbooks.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 使用实时连接时，Tableau 会直接向数据源发出查询（如果可能，也会使用缓存中的数据）。当你提取数据时，Tableau 会从原始数据源中拉取部分或全部数据并将其存储在提取文件中。在
    10.5 版本之前，Tableau 使用的是 Tableau 数据提取（`.tde`）文件。从 10.5 版本开始，Tableau 使用 Hyper 提取（`.hyper`）文件，并会在更新旧工作簿时将
    `.tde` 文件转换为 `.hyper` 文件。
- en: The fundamental paradigm of how Tableau works with data does not change, but
    you'll notice that Tableau is now querying and getting results from the extract.
    Data can be retrieved from the source again to refresh the extract. Thus, each
    extract is a snapshot of the data source at the time of the latest refresh. Extracts
    offer the benefit of being portable and extremely efficient.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 操作数据的基本模式并没有改变，但你会注意到 Tableau 现在是从提取中查询并获取结果。可以重新从源中获取数据以刷新提取。因此，每个提取都是数据源在最新刷新时的快照。提取的优势在于它具有便携性且非常高效。
- en: Creating extracts
  id: totrans-183
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建提取
- en: 'Extracts can be created in multiple ways, as follows:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 提取可以通过多种方式创建，如下所示：
- en: Select **Extract** on the **Data Source** screen as follows. The **Edit...**
    link will allow you to configure the extract:![](img/B16021_02_22.png)
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 **数据源** 页面上选择 **提取**，如图所示。点击 **编辑...** 链接将允许你配置提取：![](img/B16021_02_22.png)
- en: 'Figure 2.22: Select either Live or Extract for a connection and configure options
    for the extract by clicking Edit.'
  id: totrans-186
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.22：选择“实时”或“提取”作为连接方式，并通过点击“编辑”配置提取选项。
- en: Select the data source from the **Data** menu, or right-click the data source
    on the data pane and select **Extract data**. You will be given a chance to set
    configuration options for the extract, as demonstrated in the following screenshot:![](img/B16021_02_23.png)
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从 **数据** 菜单中选择数据源，或右键点击数据窗格中的数据源并选择 **提取数据**。你将有机会为提取设置配置选项，以下截图演示了此过程：![](img/B16021_02_23.png)
- en: 'Figure 2.23: The Extract data… option'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.23：提取数据… 选项
- en: Developers may create an extract using the Tableau Hyper API. This API allows
    you to use Python, Java, C++, or C#/.NET to programmatically read and write Hyper
    extracts. The details of this approach are beyond the scope of this book, but
    documentation is readily available on Tableau's website at [https://help.tableau.com/current/api/hyper_api/en-us/index.html](https://help.tableau.com/current/api/hyper_api/en-us/index.html).
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开发者可以使用 Tableau Hyper API 创建提取。此 API 允许你使用 Python、Java、C++ 或 C#/.NET 编程语言以编程方式读取和写入
    Hyper 提取文件。该方法的具体细节超出了本书的范围，但 Tableau 官方网站上有相关文档可供参考：[https://help.tableau.com/current/api/hyper_api/en-us/index.html](https://help.tableau.com/current/api/hyper_api/en-us/index.html)。
- en: Certain tools, such as `Alteryx` or `Tableau Prep`, can output Tableau extracts.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些工具，如 `Alteryx` 或 `Tableau Prep`，可以输出 Tableau 提取。
- en: 'You''ll have quite a few options for configuring an extract. To edit these
    options, select **Extract** and then **Edit…** on the **Data Source** screen or
    **Extract data…** from the context menu of a connection in the **Data** pane.
    When you configure an extract, you will be prompted to select certain options,
    as shown here:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 你将有多种选项来配置提取。要编辑这些选项，选择 **提取**，然后在 **数据源** 页面上选择 **编辑...**，或从 **数据** 窗格中的连接右键菜单选择
    **提取数据...**。在配置提取时，你将被提示选择某些选项，如下所示：
- en: '![](img/B16021_02_24.png)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_24.png)'
- en: 'Figure 2.24: The Extract Data dialog gives quite a few options for how to configure
    the extract'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.24：提取数据对话框提供了许多配置提取的选项
- en: 'You have a great deal of control when configuring an extract. Here are the
    various options, and the impact your choices will make on performance and flexibility:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置提取时，你有很大的控制权。以下是各种选项，以及你的选择对性能和灵活性的影响：
- en: Depending on the data source and object model you've created, you may select
    between **Logical Tables** and **Physical Tables**. We'll explore the details
    in *Chapter 13*, *Understanding the Tableau Data Model, Joins, and Blends*.
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据你创建的数据源和对象模型，你可以在**逻辑表**和**物理表**之间进行选择。我们将在*第13章*中探讨相关细节，*了解 Tableau 数据模型、连接和混合*。
- en: You may optionally add extract **Filters**, which limit the extract to a subset
    of the original source. In this example only, records where **Region** is **Central**
    or **South** and where **Category** is **Office Machines** will be included in
    the extract.
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以选择性地添加提取**过滤器**，将提取限制为原始源的一个子集。在此示例中，只有**Region**为**Central**或**South**且**Category**为**Office
    Machines**的记录将被包含在提取中。
- en: You may aggregate an extract by checking the box. This means that data will
    be rolled up to the level of visible dimensions and, optionally, to a specified
    date level, such as year or month.
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以通过勾选框来对提取进行聚合。这意味着数据将汇总到可见维度的级别，并且可以选择汇总到指定的日期级别，如年份或月份。
- en: '**Visible fields** are those that are shown in the data pane. You may hide
    a field from the Data Source screen or from the data pane by right-clicking a
    field and selecting **Hide**. This option will be disabled if the field is used
    in any view in the workbook. `Hidden` fields are not available to be used in a
    view. `Hidden` fields are not included in an extract as long as they are hidden
    prior to creating or optimizing the extract.'
  id: totrans-198
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**可见字段**是指在数据窗格中显示的字段。你可以通过右键单击字段并选择**隐藏**，将字段从数据源屏幕或数据窗格中隐藏。如果该字段在工作簿中的任何视图中使用，则此选项将被禁用。`隐藏`字段无法在视图中使用。`隐藏`字段在创建或优化提取之前是不会包含在提取中的。'
- en: In the preceding example, if only the **Region** and **Category** dimensions
    were visible, the resulting extract would only contain two rows of data (one row
    for **Central** and another for **South**). Additionally, any measures would be
    aggregated at the **Region**/**Category** level and would be done with respect
    to the **Extract** filters. For example, **Sales** would be rolled up to the sum
    of sales in **Central**/**Office Machines** and **South**/**Office Machines**.
    All measures are aggregated according to their default aggregation.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的示例中，如果只有**Region**和**Category**维度可见，生成的提取将仅包含两行数据（**Central**和**South**各一行）。此外，任何度量都会在**Region**/**Category**级别上进行聚合，并会根据**Extract**过滤器进行处理。例如，**Sales**将汇总为**Central**/**Office
    Machines**和**South**/**Office Machines**的销售总和。所有度量都会根据其默认的聚合方式进行汇总。
- en: You may adjust the number of rows in the extract by including all rows or a
    sampling of the top *n* rows in the dataset. If you select all rows, you can indicate
    an incremental refresh. If your source data incrementally adds records, and you
    have a field such as an identity column or date field that can be used reliably
    to identify new records as they are added, then an incremental extract can allow
    you to add those records to the extract without recreating the entire extract.
    In the preceding example, any new rows where **Row ID** is higher than the highest
    value of the previous extract refresh would be included in the next incremental
    refresh.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过包含所有行或数据集中前 *n* 行的抽样来调整提取中的行数。如果选择所有行，你可以指示进行增量刷新。如果源数据逐步添加记录，并且你有一个可以可靠识别新记录的字段，例如身份列或日期字段，那么增量提取可以让你将这些记录添加到提取中，而无需重新创建整个提取。在前面的示例中，任何**Row
    ID**高于上次提取刷新最大值的新行，都将包含在下一个增量刷新中。
- en: Incremental refreshes can be a great way to deal with large volumes of data
    that grow over time. However, use incremental refreshes with care, because the
    incremental refresh will only add new rows of data based on the field you specify.
    You won't get changes to existing rows, nor will rows be removed if they were
    deleted at the source. You will also miss any new rows if the value for the incremental
    field is less than the maximum value in the existing extract.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 增量刷新是处理随着时间增长的大量数据的一个好方法。然而，使用增量刷新时需要小心，因为增量刷新仅会基于你指定的字段添加新的数据行。你将无法获得对现有行的更改，也不会删除源中已删除的行。如果增量字段的值小于现有提取中的最大值，你也会错过任何新行。
- en: Now that we've considered how to create and configure extracts, let's turn our
    attention to using them.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经考虑了如何创建和配置提取数据，接下来我们来看看如何使用它们。
- en: Performance
  id: totrans-203
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 性能
- en: 'There are two types of extracts in Tableau:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 中有两种类型的提取数据：
- en: 'Tableau Data Extracts (`.tde` files): prior to Tableau 10.5, these were the
    only type of extract available.'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Tableau 数据提取（`.tde`文件）：在 Tableau 10.5 版本之前，这些是唯一可用的提取数据类型。
- en: Hyper (`.hyper` files) are available in Tableau 10.5 or later.
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Hyper（`.hyper`文件）在 Tableau 10.5 或更高版本中可用。
- en: 'Depending on scale and volume, both `.hyper` and `.tde` extracts may perform
    faster than most traditional live database connections. For the most part, Tableau
    will default to creating Hyper extracts. Unless you are using older versions of
    Tableau, there is little reason to use the older `.tde`. The incredible performance
    of Tableau extracts is based on several factors, including the following:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 根据规模和数据量，`.hyper`和`.tde`提取数据通常比大多数传统的实时数据库连接更快。通常情况下，Tableau 默认会创建 Hyper 提取数据。除非你使用的是旧版本的
    Tableau，否则没有太多理由使用旧版的 `.tde`。Tableau 提取数据的卓越性能基于几个因素，包括以下几点：
- en: Hyper extracts make use of a hybrid of OLTP and OLAP models and the engine determines
    the optimal query. Tableau Data Extracts are columnar and very efficient to query.
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Hyper 提取数据结合了 OLTP 和 OLAP 模型，且引擎会自动确定最佳查询方式。Tableau 数据提取采用列式存储，查询效率非常高。
- en: Extracts are structured so they can be loaded quickly into memory without additional
    processing and moved between memory and disk storage, so the size is not limited
    to the amount of RAM available, but RAM is efficiently used to boost performance.
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提取数据是以结构化的方式存储的，因此可以快速加载到内存中，无需额外的处理，并且在内存和磁盘存储之间传输数据，因此大小不受可用内存的限制，但内存会被高效使用以提高性能。
- en: Many calculated fields are materialized in the extract. The pre-calculated value
    stored in the extract can often be read faster than executing the calculation
    every time the query is executed. Hyper extracts extend this by potentially materializing
    many aggregations.
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 许多计算字段在提取数据中被物化。存储在提取数据中的预计算值通常比每次执行查询时都进行计算要读取得更快。Hyper 提取数据进一步扩展了这一点，通过物化更多的聚合结果来提升性能。
- en: 'You may choose to use extracts to increase performance over traditional databases.
    To maximize your performance gain, consider the following actions:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以选择使用提取数据来提高性能，超越传统数据库。为了最大化你的性能提升，考虑采取以下措施：
- en: Prior to creating the extract, hide unused fields. If you have created all desired
    visualizations, you can click the **Hide Unused Fields** button on the **Extract**
    dialog to hide all fields not used in any view or calculation.
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在创建提取数据之前，隐藏未使用的字段。如果你已经创建了所有需要的可视化，可以点击**隐藏未使用的字段**按钮，在**提取**对话框中隐藏所有未在任何视图或计算中使用的字段。
- en: If possible, use a subset of data from the original source. For example, if
    you have historical data for the last 10 years but only need the last two years
    for analysis, then filter the extract by the `Date` field.
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果可能，使用来自原始数据源的子集。例如，如果你有过去10年的历史数据，但只需要过去两年的数据进行分析，那么可以通过`Date`字段来筛选提取的数据。
- en: Optimize an extract after creating or editing calculated fields or deleting
    or hiding fields.
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在创建或编辑计算字段，或者删除或隐藏字段后，优化提取数据。
- en: Store extracts on solid-state drives.
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将提取的数据存储在固态硬盘上。
- en: Although performance is one major reason to consider using extracts, there are
    other factors to consider, which we will do next.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管性能是考虑使用提取数据的一个主要原因，但还有其他因素需要考虑，接下来我们将讨论这些因素。
- en: Portability and security
  id: totrans-217
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 便携性与安全性
- en: Let's say that your data is hosted on a database server accessible only from
    inside your office network. Normally, you'd have to be onsite or using a VPN to
    work with the data. Even cloud-based data sources require an internet connection.
    With an extract, you can take the data with you and work offline.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你的数据存储在仅限公司内部网络访问的数据库服务器上。通常情况下，你必须在现场或通过 VPN 才能访问这些数据。即使是云端数据源，也需要网络连接。通过提取数据，你可以将数据带走，并在离线时进行工作。
- en: 'An extract file contains data extracted from the source. When you save a workbook,
    you may save it as a Tableau workbook (`.twb`) file or a Tableau Packaged Workbook
    (`.twbx`) file. Let''s consider the difference:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 提取文件包含从源中提取的数据。当你保存工作簿时，可以将其保存为 Tableau 工作簿（`.twb`）文件或 Tableau 打包工作簿（`.twbx`）文件。我们来看看它们的区别：
- en: A Tableau workbook (`.twb`) contains definitions for all the connections, fields,
    visualizations, and dashboards, but does not contain any data or external files,
    such as images. A Tableau workbook can be edited in Tableau Desktop and published
    to Tableau Server.
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Tableau 工作簿（`.twb`）包含所有连接、字段、可视化和仪表板的定义，但不包含任何数据或外部文件，如图片。Tableau 工作簿可以在 Tableau
    Desktop 中编辑并发布到 Tableau Server。
- en: A Tableau packaged workbook (`.twbx`) contains everything in a (`.twb`) file
    but also includes extracts and external files that are packaged together in a
    single file with the workbook. A packaged workbook using extracts can be opened
    with Tableau Desktop, Tableau Reader, and published to Tableau Public or Tableau
    Online.
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Tableau 打包工作簿（`.twbx`）包含 `.twb` 文件中的所有内容，但还包括提取和外部文件，这些文件与工作簿一起打包在一个文件中。使用提取的打包工作簿可以在
    Tableau Desktop、Tableau Reader 中打开，并发布到 Tableau Public 或 Tableau Online。
- en: A packaged workbook file (`.twbx`) is really just a compressed `.zip` file.
    If you rename the extension from `.twbx` to `.zip`, you can access the contents
    as you would any other `.zip` file.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 打包工作簿文件（`.twbx`）实际上只是一个压缩的 `.zip` 文件。如果你将扩展名从 `.twbx` 更改为 `.zip`，你可以像访问其他 `.zip`
    文件一样访问其内容。
- en: There are a couple of security considerations to keep in mind when using an
    extract. First, any security layers that limit which data can be accessed according
    to the credentials used will not be effective after the extract is created. An
    extract does not require a username or password. All data in an extract can be
    read by anyone. Second, any data for visible (non-hidden) fields contained in
    an extract file (`.hyper` or `.tde`), or an extract contained in a packaged workbook
    (`.twbx`), can be accessed even if the data is not shown in the visualization.
    Be very careful to limit access to extracts or packaged workbooks containing sensitive
    or proprietary data.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 使用提取时需要注意一些安全性考虑。首先，任何限制根据所使用的凭证访问哪些数据的安全层，在创建提取后将不再有效。提取不需要用户名或密码，任何人都可以读取提取中的所有数据。其次，提取文件（`.hyper`
    或 `.tde`）或包含提取的打包工作簿（`.twbx`）中的可见（非隐藏）字段数据，即使这些数据未在可视化中显示，也可以访问。务必小心限制对包含敏感或专有数据的提取或打包工作簿的访问。
- en: When to use an extract
  id: totrans-224
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 何时使用提取
- en: You should consider various factors when determining whether to use an extract.
    In some cases, you won't have an option (for example, OLAP requires a live connection
    and some cloud-based data sources require an extract). In other cases, you'll
    want to evaluate your options.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 在决定是否使用提取时，你应考虑各种因素。在某些情况下，你没有选择（例如，OLAP 需要实时连接，一些基于云的数据源需要提取）。在其他情况下，你需要评估你的选择。
- en: 'In general, use an extract when:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，在以下情况下使用提取：
- en: You need better performance than you can get with the live connection.
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要比实时连接提供更好的性能。
- en: You need the data to be portable.
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要使数据具有可移植性。
- en: You need to use functions that are not supported by the database data engine
    (for example, `MEDIAN` is not supported with a live connection to SQL Server).
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要使用数据库数据引擎不支持的函数（例如，`MEDIAN` 在与 SQL Server 的实时连接中不受支持）。
- en: You want to share a packaged workbook. This is especially true if you want to
    share a packaged workbook with someone who uses the free Tableau Reader, which
    can only read packaged workbooks with data extracted.
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你想要共享打包工作簿。尤其是在你希望与使用免费版 Tableau Reader 的人共享打包工作簿时，因为 Tableau Reader 只能读取包含数据提取的打包工作簿。
- en: 'In general, do not use an extract when you have any of the following use cases:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，当你有以下任何使用案例时，不要使用提取：
- en: You have sensitive data that should not be accessible by certain users, or you
    have no control over who will be able to access the extract. However, you may
    hide sensitive fields prior to creating the extract, in which case they are no
    longer part of the extract.
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你有敏感数据，某些用户不应访问这些数据，或者你无法控制谁能够访问提取的数据。不过，你可以在创建提取之前隐藏敏感字段，在这种情况下，它们将不再是提取的一部分。
- en: You need to manage security based on login credentials. (However, if you are
    using Tableau Server, you may still use extracted connections hosted on Tableau
    Server that are secured by a login. We'll consider sharing your work with Tableau
    Server in *Chapter 16*, *Sharing Your Data Story*).
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要根据登录凭证管理安全性。（不过，如果你使用 Tableau Server，你仍然可以使用 Tableau Server 上托管的提取连接，并通过登录进行安全保护。我们将在*第16章*“共享你的数据故事”中讨论如何使用
    Tableau Server 分享你的工作）。
- en: You need to see changes in the source data updated in real time.
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要看到源数据的变化实时更新。
- en: The volume of data makes the time required to build the extract impractical.
    The number of records that can be extracted in a reasonable amount of time will
    depend on factors such as the data types of fields, the number of fields, the
    speed of the data source, and network bandwidth. The Hyper engine typically builds
    `.hyper` extracts much faster than the older `.tde` files were built.
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据量过大导致生成提取文件所需的时间不现实。可以在合理时间内提取的记录数量将取决于字段的数据类型、字段的数量、数据源的速度和网络带宽等因素。Hyper
    引擎通常比旧的 `.tde` 文件构建 `.hyper` 提取文件要快得多。
- en: With an understanding of how to create, manage, and use extracts (and when not
    to use them), we'll turn our attention to various ways of filtering data in Tableau.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 了解如何创建、管理和使用提取文件（以及何时不使用它们）后，我们将重点关注在 Tableau 中筛选数据的各种方法。
- en: Filtering data
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 筛选数据
- en: Often, you will want to filter data in Tableau in order to perform an analysis
    on a subset of data, narrow your focus, or drill into details. Tableau offers
    multiple ways to filter data.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，你会希望在 Tableau 中筛选数据，以便对数据的子集进行分析、缩小焦点或深入探讨细节。Tableau 提供了多种筛选数据的方式。
- en: 'If you want to limit the scope of your analysis to a subset of data, you can
    filter the data at the source using one of the following techniques:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你希望将分析范围限制为数据的一个子集，你可以使用以下技术之一在数据源中筛选数据：
- en: '**Data Source Filters** are applied before all other filters and are useful
    when you want to limit your analysis to a subset of data. These filters are applied
    before any other filters.'
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据源筛选器**在所有其他筛选器之前应用，并且当你想将分析限制为数据的一个子集时非常有用。这些筛选器在任何其他筛选器之前应用。'
- en: '**Extract Filters** limit the data that is stored in an extract (`.tde` or
    `.hyper`). Data source filters are often converted into extract filters if they
    are present when you extract the data.'
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**提取筛选器**限制存储在提取文件中的数据（`.tde` 或 `.hyper`）。如果在提取数据时存在数据源筛选器，它们通常会转换为提取筛选器。'
- en: '**Custom SQL Filters** can be accomplished using a live connection with custom
    SQL, which has a Tableau parameter in the `WHERE` clause. We''ll examine parameters
    in *Chapter 4*, *Starting an Adventure with Calculations and Parameters*.'
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自定义 SQL 筛选器**可以通过使用带有 Tableau 参数的 `WHERE` 子句的实时连接实现。我们将在*第 4 章*《与计算和参数的冒险之旅》中详细讨论参数。'
- en: 'Additionally, you can apply filters to one or more views using one of the following
    techniques:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，你还可以使用以下技术之一对一个或多个视图应用筛选器：
- en: Drag and drop fields from the data pane to the **Filters** shelf.
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从数据面板将字段拖动到**筛选器**架上。
- en: 'Select one or more marks or headers in a view and then select **Keep Only**
    or **Exclude**, as shown here:'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在视图中选择一个或多个标记或标题，然后选择**仅保留**或**排除**，如下所示：
- en: '![](img/B16021_02_25.png)'
  id: totrans-246
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_25.png)'
- en: 'Figure 2.25: Based on the mark selection, you may Keep Only values that match
    or Exclude such values.'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.25：根据标记选择，你可以仅保留匹配的值或排除这些值。
- en: Right-click any field in the data pane or in the view and select **Show Filter**.
    The filter will be shown as a control (examples include a drop-down list and checkbox)
    to allow the end user of the view or dashboard the ability to change the filter.
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 右键点击数据面板或视图中的任何字段，并选择**显示筛选器**。筛选器将显示为控件（例如下拉列表和复选框），以便视图或仪表板的最终用户能够更改筛选器。
- en: Use an action filter. We'll look more at filters and action filters in the context
    of dashboards.
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用操作筛选器。我们将在仪表板的上下文中进一步探讨筛选器和操作筛选器。
- en: Each of these options adds one or more fields to the **Filters** shelf of a
    view. When you drop a field on the **Filters** shelf, you will be prompted with
    options to define the filter. The filter options will differ most noticeably based
    on whether the field is discrete or continuous. Whether a field is filtered as
    a dimension or as a measure will greatly impact how the filter is applied and
    the results.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 每个选项都会将一个或多个字段添加到视图的**筛选器**架上。当你将字段拖到**筛选器**架上时，系统会提示你定义筛选器的选项。筛选器选项的差异最明显的表现是字段是离散的还是连续的。字段是作为维度筛选还是作为度量筛选，会极大地影响筛选器的应用方式及其结果。
- en: Filtering discrete (blue) fields
  id: totrans-251
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 筛选离散（蓝色）字段
- en: 'When you filter using a discrete field, you will be given options for selecting
    individual values to keep or exclude. For example, when you drop the discrete
    **Department** dimension onto the **Filters** shelf, Tableau will give you the
    following options:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 当你使用离散字段进行筛选时，系统会提供选择保留或排除单个值的选项。例如，当你将离散的**部门**维度拖到**筛选器**架上时，Tableau会提供以下选项：
- en: '![](img/B16021_02_26.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_26.png)'
- en: 'Figure 2.26: A filter for a discrete field will show options for including
    or excluding individual values'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.26：筛选离散字段时会显示包括或排除单个值的选项
- en: 'The **Filter** options include **General**, **Wildcard**, **Condition**, and
    **Top** tabs. Your filter can include options from each tab. The **Summary** section
    on the **General** tab will show all options selected:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '**筛选器**选项包括**常规**、**通配符**、**条件**和**顶部**标签。您的筛选器可以包括来自每个标签的选项。**常规**标签中的**摘要**部分将显示所有已选择的选项：'
- en: The **General** tab allows you to select items from a list (you can use the
    custom list to add items manually if the dimension contains a large number of
    values that take a long time to load). You may use the **Exclude** option to exclude
    the selected items.
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**常规**标签允许您从列表中选择项目（如果维度包含大量值并且加载时间较长，您可以使用自定义列表手动添加项目）。您可以使用**排除**选项排除选定的项目。'
- en: The **Wildcard** tab allows you to match string values that contain, start with,
    end with, or exactly match a given value.
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**通配符**标签允许您匹配包含、以某值开头、以某值结尾或完全匹配给定值的字符串值。'
- en: The **Condition** tab allows you to specify conditions based on aggregations
    of other fields that meet conditions (for example, a condition to keep any **Department**
    where the sum of sales was greater than $1,000,000). Additionally, you can write
    a custom calculation to form complex conditions. We'll cover calculations more
    in *Chapter 4*, *Starting an Adventure with Calculations and Parameters*, and
    *Chapter 6*, *Diving Deep with Table Calculations*.
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**条件**标签允许您根据其他字段的聚合结果指定条件（例如，保留任何**部门**，其销售总额超过1,000,000美元）。此外，您可以编写自定义计算来形成复杂的条件。我们将在*第4章*《与计算和参数一起开始冒险》和*第6章*《深入探讨表格计算》中详细讲解计算。'
- en: The **Top** tab allows you to limit the filter to only the top or bottom items.
    For example, you might decide to keep only the top five items by the sum of sales.
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**顶部**标签允许您将筛选器限制为仅显示顶部或底部项目。例如，您可能决定仅保留销售总额前五的项目。'
- en: Discrete measures (except for calculated fields using table calculations) cannot
    be added to the **Filters** shelf. If the field holds a date or numeric value,
    you can convert it to a continuous field before filtering. Other data types will
    require the creation of a calculated field to convert values you wish to filter
    into continuous numeric values.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 离散度量（除使用表格计算的计算字段外）无法添加到**筛选器**架上。如果字段包含日期或数值，您可以在筛选之前将其转换为连续字段。其他数据类型需要创建计算字段，将您希望筛选的值转换为连续的数值。
- en: Let's next consider how continuous filters are filtered.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来我们来看看如何筛选连续的过滤器。
- en: Filtering continuous (green) fields
  id: totrans-262
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 筛选连续（绿色）字段
- en: 'If you drop a continuous dimension onto the **Filters** shelf, you''ll get
    a different set of options. Often, you will first be prompted as to how you want
    to filter the field, as follows:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您将连续维度拖放到**筛选器**架上，您将获得不同的选项集。通常，系统会首先提示您如何筛选字段，如下所示：
- en: '![](img/B16021_02_27.png)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_27.png)'
- en: 'Figure 2.27: For numeric values, you''ll often see options for aggregating
    the value as part of the filter'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.27：对于数值，您通常会看到作为筛选器一部分的聚合选项
- en: 'The options here are divided into two major categories:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的选项分为两大类：
- en: '**All values**: The filter will be based on each individual value of the field,
    *row by row*. For example, an **All values** filter keeping only sales above $100
    will evaluate each record of underlying data and keep only individual sales above
    $100.'
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**所有值**：筛选器将基于字段的每个单独值，*逐行筛选*。例如，一个**所有值**筛选器，仅保留销售额超过100美元的记录，将评估每一条底层数据记录，仅保留销售额超过100美元的单个销售记录。'
- en: '**Aggregation**: The filter will be based on the aggregation specified (for
    example, **Sum**, **Average**, **Minimum**, **Maximum**, **Standard deviation**,
    and **Variance**) and the aggregation will be performed at the level of detail
    of the view. For example, a filter keeping only the sum of sales above $100,000
    on a view at the level of category will keep only categories that had at least
    $100,000 in total sales.'
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**聚合**：筛选器将基于指定的聚合（例如，**总和**、**平均值**、**最小值**、**最大值**、**标准差**和**方差**），并且聚合将在视图的细节层次上执行。例如，在类别级别的视图上保持销售总和超过100,000美元的筛选器将仅保留销售总额至少为100,000美元的类别。'
- en: 'Once you''ve made a selection (or if the selection wasn''t applicable for the
    field selected), you will be given another interface for setting the actual filter,
    as follows:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您做出选择（或如果该选择不适用于所选字段），您将获得另一个界面来设置实际的筛选器，如下所示：
- en: '![](img/B16021_02_28.png)'
  id: totrans-270
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_28.png)'
- en: 'Figure 2.28: Filter options for Sales (as a SUM)'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.28：销售额（作为SUM）的筛选选项
- en: Here, you'll see options for filtering continuous values based on a range with
    a start, end, or both. The **Special** tab gives options for showing all values,
    `NULL` values, or non-`NULL` values.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你会看到基于范围进行筛选的连续值选项，可以选择开始、结束或两者。**特殊**选项卡提供了显示所有值、`NULL`值或非`NULL`值的选项。
- en: From a user-interface perspective, the most dramatic difference in filtering
    options comes from whether a field is discrete or continuous. However, you should
    always think about whether you are using the field as a **Dimension Filter** or
    a **Measure Filter** to understand what kind of results you will get based on
    the order of operations, which is discussed in the *Appendix*.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 从用户界面的角度来看，筛选选项最显著的区别在于字段是离散的还是连续的。然而，你应始终考虑是否将字段用作**维度过滤器**或**测量过滤器**，以便了解根据操作顺序得到的结果是什么，操作顺序将在*附录*中讨论。
- en: Dimension filters will filter *detail rows of data*. For example, filtering
    out the Central Region will eliminate all rows for that region. You will not see
    any states for that region and your aggregate results, such as `SUM(Sales)`, will
    not include any values from that region.
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 维度过滤器将过滤*详细数据行*。例如，筛选出“中央地区”将删除该地区的所有数据行。你将看不到该地区的任何州，并且汇总结果，如`SUM(Sales)`，将不包括该地区的任何数据。
- en: Measure filters will filter *aggregate rows of data* at the level of detail
    defined by the dimensions included in your view. For example, if you filtered
    to include only where `SUM(Sales)` was greater than $100,000 and your view included
    `Region` and `Month`, then the resulting view would include only values where
    the `Region` had more than $100,000 in sales for the given month.
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测量过滤器将在由视图中包含的维度定义的详细级别上过滤*汇总数据行*。例如，如果你筛选只包含`SUM(Sales)`大于100,000美元的记录，并且视图中包括`Region`和`Month`，那么最终的视图将只包含`Region`在给定月份销售额超过100,000美元的值。
- en: Other than filtering discrete and continuous fields, you'll also notice some
    different options for filtering dates, which we'll consider next.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 除了筛选离散和连续字段外，你还会注意到在筛选日期时有一些不同的选项，我们接下来将讨论。
- en: Filtering dates
  id: totrans-277
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 筛选日期
- en: 'We''ll take a look at the special way Tableau handles dates in the *Visualizing
    dates and times* section of *Chapter 3*, *Moving Beyond Basic Visualizations*.
    For now, consider the options available when you drop an **Order Date** field
    onto the **Filters** shelf, as follows:'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在*第3章，超越基础可视化*的*可视化日期和时间*部分，详细了解Tableau处理日期的特殊方式。现在，请考虑将**订单日期**字段拖到**筛选器**架上的选项，如下所示：
- en: '![](img/B16021_02_29.png)'
  id: totrans-279
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B16021_02_29.png)'
- en: 'Figure 2.29: Initial filter options for a date field'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.29：日期字段的初始筛选选项
- en: 'The options here include the following:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的选项包括以下内容：
- en: '**Relative date**: This option allows you to filter a date based on a specific
    date (for example, keeping the last three weeks from today, or the last six months
    from January 1).'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**相对日期**：此选项允许你根据特定日期筛选，例如保留今天起的最后三周，或从1月1日起的最后六个月。'
- en: '**Range of dates**: This option allows you to filter a date based on a range
    with a starting date, ending date, or both.'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日期范围**：此选项允许你根据开始日期、结束日期或两者来筛选日期范围。'
- en: '**Date Part**: This option allows you to filter based on discrete parts of
    dates, such as **Years**, **Months**, **Days**, or combinations of parts, such
    as **Month/Year**. Based on your selection, you will have various options for
    filtering and have the option of defaulting to the latest value in the data.'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日期部分**：此选项允许你根据日期的离散部分进行筛选，例如**年份**、**月份**、**日期**，或部分的组合，如**月/年**。根据你的选择，你将获得不同的筛选选项，并且可以选择默认使用数据中的最新值。'
- en: '**Individual dates**: This option allows you to filter based on each individual
    value of the date field in the data.'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**单独的日期**：此选项允许你根据数据中日期字段的每个单独值进行筛选。'
- en: '**Count** or **Count (Distinct)**: This option allows you to filter based on
    the count, or distinct count, of date values in the data.'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**计数**或**计数（唯一）**：此选项允许你根据数据中日期值的计数或唯一计数进行筛选。'
- en: Depending on your selection, you will be given additional options for filtering.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 根据你的选择，你将获得更多的筛选选项。
- en: Other filtering options
  id: totrans-288
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 其他筛选选项
- en: 'You will also want to be aware of the following options when it comes to filtering:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 在筛选时，你还需要注意以下选项：
- en: You may display a filter control for nearly any field by right-clicking it and
    selecting **Show Filter**. The type of control depends on the type of field, whether
    it is discrete or continuous, and may be customized by using the little drop-down
    arrow at the upper-right of the filter control.
  id: totrans-290
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以通过右键单击字段并选择**显示过滤器**，为几乎任何字段显示过滤器控件。控件的类型取决于字段的类型，是否是离散的或连续的，并且可以通过使用过滤器控件右上角的小下拉箭头进行自定义。
- en: '**Filters** may be added to the **context**. Context is described in detail
    in the *Appendix* and we''ll see why it''s important in various examples throughout
    the book. For now, just note the option. This option is available via the drop-down
    menu on the filter control or the field on the **Filters** shelf.'
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**过滤器**可以添加到**上下文**中。上下文在*附录*中有详细描述，我们将通过本书中的多个示例了解其重要性。现在，只需注意此选项。此选项可通过过滤器控件的下拉菜单或**过滤器**架上的字段访问。'
- en: '**Filters** may be set to show all values in the database, all values in the
    context, all values in a hierarchy, or only values that are relevant based on
    other filters. These options are available via the drop-down menu on the **Filter**
    control or the field on the **Filters** shelf.'
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**过滤器**可以设置为显示数据库中的所有值、上下文中的所有值、层级中的所有值，或仅显示基于其他过滤器相关的值。这些选项可通过**过滤器**控件的下拉菜单或**过滤器**架上的字段访问。'
- en: When using Tableau Server, you may define user filters that allow you to provide
    row-level security by filtering based on user credentials.
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Tableau Server 时，你可以定义用户过滤器，通过基于用户凭证过滤来提供行级安全性。
- en: 'By default, any field placed on the **Filters** shelf defines a filter that
    is specific to the current view. However, you may specify the scope by using the
    menu for the field on the **Filters** shelf. Select **Apply to** and choose one
    of the following options:'
  id: totrans-294
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 默认情况下，放置在**过滤器**架上的任何字段定义一个特定于当前视图的过滤器。然而，你可以通过使用**过滤器**架上字段的菜单来指定范围。选择**应用于**，然后选择以下选项之一：
- en: '**All related data sources**: All data sources will be filtered by the value(s)
    specified. The relationships of fields are the same as blending (that is, the
    default by name and type match, or customized through the **Data | Edit Relationships...**
    menu option). All views using any of the related data sources will be affected
    by the filter. This option is sometimes referred to as **cross-data source filtering**.'
  id: totrans-295
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**所有相关数据源**：所有数据源将根据指定的值进行过滤。字段的关系与数据混合相同（即，默认按名称和类型匹配，或通过**数据 | 编辑关系...**菜单选项进行自定义）。所有使用任何相关数据源的视图将受到过滤器的影响。此选项有时被称为**跨数据源过滤**。'
- en: '**Current data source**: The data source for that field will be filtered. Any
    views using that data source will be affected by the filter.'
  id: totrans-296
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**当前数据源**：该字段的数据源将被过滤。任何使用该数据源的视图将受到过滤器的影响。'
- en: '**Selected worksheets**: Any worksheets selected that use the data source of
    the field will be affected by the filter.'
  id: totrans-297
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**选定工作表**：任何选定的工作表，只要使用该字段的数据源，都将受到过滤器的影响。'
- en: '**Current worksheet**: Only the current view will be affected by the filter.'
  id: totrans-298
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**当前工作表**：只有当前视图将受到过滤器的影响。'
- en: We'll see plenty of practical examples of filtering data throughout the book,
    many of which will make use of some of these options.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，我们将看到许多过滤数据的实际示例，其中许多示例将利用这些选项。
- en: Summary
  id: totrans-300
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: This chapter covered key concepts of how Tableau works with data. Although you
    will not usually be concerned with what queries Tableau generates to query underlying
    data engines, having a solid understanding of Tableau's paradigm will greatly
    aid you as you analyze data.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了 Tableau 如何与数据协作的关键概念。虽然你通常不会关注 Tableau 生成的查询来查询底层数据引擎，但对 Tableau 的基本概念有一个深入的理解，将极大地帮助你在分析数据时的工作。
- en: We looked at multiple examples of different connections to different data sources,
    considered the benefits and potential drawbacks of using data extracts, considered
    how to manage metadata, and considered options for filtering data.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 我们查看了多个不同数据源的连接示例，考虑了使用数据提取的优点和潜在缺点，思考了如何管理元数据，并考虑了过滤数据的选项。
- en: Working with data is fundamental to everything you do in Tableau. Understanding
    how to connect to various data sources, when to work with extracts, and how to
    customize metadata will be key as you begin deeper analysis and more complex visualizations,
    such as those covered in *Chapter 3*, *Moving Beyond Basic Visualizations*.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Tableau 中处理数据是你所有工作中的基础。理解如何连接各种数据源、何时使用提取数据，以及如何自定义元数据，将是你开始更深层次分析和更复杂可视化时的关键，例如在*第3章*《*超越基础可视化*》中讲解的内容。
