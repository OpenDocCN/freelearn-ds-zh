- en: Working with Maps
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用地图
- en: When I conduct Tableau classes and workshops for people who are using Tableau
    for the first time, I find that demonstrating **mapping** is always a big hit,
    sometimes resulting in murmurs of appreciation and surprise. People have told
    me on multiple occasions that Tableau’s mapping capability was the key feature
    that caused them to take notice of and consider Tableau’s offerings more seriously.
    Tableau’s out-of-the-box mapping capabilities are powerful and flexible. You may
    be surprised at how much you can accomplish without ever leaving the user interface.
    But these out-of-the-box capabilities are just the tip of the iceberg. With proper
    guidance (which I will attempt to provide in this chapter), you can expand beyond
    the native mapping functionality and explore techniques that will greatly enhance
    your workbooks’ functionality and aesthetics.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 当我为首次使用 Tableau 的人们举办 Tableau 课程和工作坊时，我发现展示**映射**功能总是大受欢迎，有时会引发一阵阵赞叹和惊讶。许多人曾多次告诉我，Tableau
    的映射功能是他们开始关注并认真考虑 Tableau 产品的关键因素。Tableau 开箱即用的映射功能既强大又灵活。你可能会惊讶于在不离开用户界面的情况下能完成多少任务。但这些开箱即用的功能只是冰山一角。通过正确的指导（我将在本章中提供），你可以超越原生的映射功能，探索那些能大大提升工作簿功能和美学的技巧。
- en: 'In this chapter, we will discuss the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Extending Tableau’s mapping capabilities without leaving Tableau
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在不离开 Tableau 的情况下扩展 Tableau 的映射功能
- en: Creating custom polygons
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建自定义多边形
- en: Heatmaps
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 热力图
- en: Dual axes and map layering
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 双轴和地图分层
- en: Extending Tableau mapping with other technology
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扩展 Tableau 的映射功能与其他技术
- en: Swapping maps
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更换地图
- en: Custom geocoding
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自定义地理编码
- en: The default mapping capability of Tableau is a big selling point. Take any city,
    region, country, or other geographical location, place it on a Tableau worksheet,
    and you get a nice map; add a measure like **Sales** to the **Color** shelf and
    your map colors change according to sales figures. In the following section, we
    will go a step further and enhance this capability with the less obvious features
    Tableau has to offer, like measuring distances on a map and plotting additional
    data (for example, weather data) in the background.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 的默认映射功能是一个重要的卖点。无论是城市、地区、国家还是其他地理位置，只需将其放入 Tableau 工作表中，就会生成一张漂亮的地图；如果将像**销售**这样的度量放到**颜色**架上，地图的颜色就会根据销售数据发生变化。在接下来的部分，我们将更进一步，通过
    Tableau 提供的一些不太明显的功能，来增强这个能力，比如在地图上测量距离和在背景中绘制附加数据（例如天气数据）。
- en: Extending Tableau’s mapping capabilities without leaving Tableau
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在不离开 Tableau 的情况下扩展 Tableau 的映射功能
- en: In our everyday lives, a map can be helpful for better understanding the world
    around us. For instance, maps are often used on websites, television, or in printed
    media to present demographic information. In such instances, the mapping requirement
    is **static** since the immediate goal does not require movement. Some businesses
    only have static mapping requirements—for example, a retail chain might create
    a visualization that includes a map to better understand sales performance in
    a given region. In such cases, movement between locations is not a direct need.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的日常生活中，地图可以帮助更好地理解周围的世界。例如，地图通常在网站、电视或印刷媒体中用于展示人口统计信息。在这种情况下，映射需求是**静态**的，因为即时目标并不需要移动。有些企业只有静态映射需求——例如，零售连锁可能会创建一个可视化图表，其中包括地图，以便更好地理解某个地区的销售业绩。在这种情况下，地点之间的移动不是直接需求。
- en: 'Often, however, a map is needed to navigate from point A to point B. This kind
    of mapping requirement is more complicated, because it encompasses static needs
    (what restaurant is nearby?), but must also deliver additional information, such
    as routes and distances (how can I get to that restaurant?). These **dynamic**
    mapping needs assume that movement is *required* to fulfill a demand. Many businesses
    need to understand routes and mileage, that is, how to get from point A to point
    B and the distances involved. These dynamic mapping requirements can vary greatly
    but most of these needs share at least two things in common: routes and distances.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，通常需要使用地图来从 A 点导航到 B 点。这类映射需求更为复杂，因为它不仅包括静态需求（例如，附近有什么餐馆？），还必须提供额外信息，如路线和距离（例如，如何去那个餐馆？）。这些**动态**映射需求假设需要*移动*才能满足需求。许多企业需要了解路线和里程，也就是如何从
    A 点到 B 点以及涉及的距离。这些动态映射需求可能会有所不同，但大多数需求至少有两个共同点：路线和距离。
- en: In the following exercise, we will consider flight routes and associated distances
    in Australia. Specifically, we will cover how to extract longitude and latitude
    numbers from Tableau and use that information in conjunction with trigonometry
    to calculate the mileage between various points. Along the way, we will utilize
    data blending, table calculations, mapping, and **Level of Detail** (**LOD**)
    calculations for a robust exercise that touches on many advanced features.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的练习中，我们将考虑澳大利亚的航班路线和相关距离。具体来说，我们将介绍如何从Tableau中提取经纬度数据，并结合三角学计算各个点之间的里程。在此过程中，我们将使用数据混合、表计算、地图以及**细节级别**（**LOD**）计算，进行一个涉及许多高级功能的综合练习。
- en: 'Please take the following steps:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 请按照以下步骤操作：
- en: Navigate to [https://public.tableau.com/profile/marleen.meier](https://public.tableau.com/profile/marleen.meier)
    to locate and download the workbook associated with this chapter.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问[https://public.tableau.com/profile/marleen.meier](https://public.tableau.com/profile/marleen.meier)以查找并下载与本章节相关的工作簿。
- en: Open the workbook and navigate to the `Map` worksheet.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开工作簿并转到`Map`工作表。
- en: Select **Transit Data** in the **Data** pane and double-click on **City**, then
    change **City** from **Detail** to **Label** in the **Marks** card.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据**窗格中选择**Transit Data**，双击**City**，然后将**City**从**详细信息**更改为**标签**，在**标记**卡片中。
- en: In the following screenshot, note that the cities **Mackay** and **Brisbane**
    are the only cities that display. This issue depends on your country setting,
    but the following is an example of an issue that may be encountered. If you see
    it, click on **14 unknown**, in the bottom-right corner:![](img/B18435_09_01.png)
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在以下截图中，请注意，**麦凯**和**布里斯班**是唯一显示的城市。这个问题取决于你的国家设置，但以下是可能遇到的一个示例。如果你看到了这个问题，请点击右下角的**14
    个未知**：![](img/B18435_09_01.png)
- en: 'Figure 9.1: Australia'
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 9.1：澳大利亚
- en: 'Caveat: if you are in the **United States**, Melbourne in Florida will display.
    If you are in another country, you may get different results.'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意：如果你在**美国**，佛罗里达州的墨尔本将会显示。如果你在其他国家，可能会得到不同的结果。
- en: 'Select **Edit Locations...**:'
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**编辑位置...**：
- en: '![](img/B18435_09_02.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_02.png)'
- en: 'Figure 9.2: Edit Locations…'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.2：编辑位置…
- en: Change **Country/Region** to **Fixed** | **Australia**:![](img/B18435_09_03.png)
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**Country/Region**更改为**固定** | **澳大利亚**：![](img/B18435_09_03.png)
- en: 'Figure 9.3: Select Australia'
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 9.3：选择澳大利亚
- en: '**Australia** is now displayed on the map:'
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**澳大利亚**现在已显示在地图上：'
- en: '![](img/B18435_09_04.png)'
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/B18435_09_04.png)'
- en: 'Figure 9.4: Australia'
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 9.4：澳大利亚
- en: Navigate to the `Miles` worksheet and place the **Trip ID** and **City** fields
    on the **Rows** shelf, and **Latitude (generated)** and **Longitude (generated)**
    on the **Text** shelf, as seen in the following screenshot:![](img/B18435_09_05.png)
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到`Miles`工作表，将**Trip ID**和**City**字段放置到**行**架上，将**Latitude (generated)**和**Longitude
    (generated)**放置到**文本**架上，如下图所示：![](img/B18435_09_05.png)
- en: 'Figure 9.5: Distances'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 9.5：距离
- en: Your screen should look like the preceding screenshot. Note that the crosstab
    is pretty cluttered. Ideally, **Latitude** and **Longitude** should be displayed
    in separate columns. Unfortunately, we can’t do this with the generated latitude
    and longitude because, although they are listed under the **Measures** portion
    of the **Data** pane, Tableau doesn’t treat them as measures. In order to complete
    the exercise, we will need to be able to access the latitude and longitude coordinates
    from a separate data source.
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你的屏幕应该看起来像前面的截图。请注意，交叉表非常凌乱。理想情况下，**Latitude**和**Longitude**应显示在单独的列中。不幸的是，我们不能这样做，因为尽管它们列在**数据**窗格的**度量**部分下，Tableau并没有将它们视为度量。为了完成练习，我们需要能够从另一个数据源中获取纬度和经度坐标。
- en: To do this, begin by clicking on the `Map` worksheet tab.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要做到这一点，首先点击`Map`工作表标签。
- en: Right-click on the visualization and select **View Data**. Copy all the data
    in the **Summary** tab of the resulting dialog box, by selecting every cell and
    clicking **Copy**.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击可视化并选择**查看数据**。通过选择每个单元格并点击**复制**，将结果对话框中**摘要**标签页的所有数据复制。
- en: Close the dialog box and press *Ctrl* + *V* (*Command* + *V* for Mac) to create
    a new dataset in Tableau. Rename the resulting dataset (now called `Clipboard_[timestamp]`)
    to `Lat` `Long`. Also, name the worksheet `Lat``Long`.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 关闭对话框并按*Ctrl* + *V*（Mac上为*Command* + *V*）在Tableau中创建一个新的数据集。将生成的数据集（现在名为`Clipboard_[时间戳]`）重命名为`Lat`
    `Long`。同时，将工作表命名为`Lat``Long`。
- en: In the `Lat Long` worksheet, rename `Latitude` `(generated)` and `Longitude``(generated)`
    to `Lat` and `Long`.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`Lat Long`工作表中，将`Latitude` `(generated)`和`Longitude (generated)`重命名为`Lat`和`Long`。
- en: 'Return to the `Miles` worksheet and, within the `Transit Data` data source,
    create two calculated fields: one called `LAT`, containing the code `AVG([Lat
    Long].[Lat])`, and one called `LONG`, containing the code `AVG([Lat Long].[Long])`.'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回到`Miles`工作表，在`Transit Data`数据源中创建两个计算字段：一个名为`LAT`，包含代码`AVG([Lat Long].[Lat])`，另一个名为`LONG`，包含代码`AVG([Lat
    Long].[Long])`。
- en: Remove **Latitude (generated)** and **Longitude (generated)** from **Text**
    on the **Marks** card.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**Marks**卡上的**Text**中移除**Latitude (generated)**和**Longitude (generated)**。
- en: Place **Measure Names** on the **Columns** shelf and the **Filter** shelf and
    select **Lat** and **Long**. Also, place **Measure Values** on the **Text** shelf.
    Now, we have the ability to treat latitude and longitude as true measures.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**Measure Names**放到**Columns**架和**Filter**架上，并选择**Lat**和**Long**。同时，将**Measure
    Values**放到**Text**架上。现在，我们可以将纬度和经度视为真正的度量值。
- en: 'Create two more calculated fields: one called `Lookup``Lat`, containing the
    code `Lookup(Lat,-1)`, and one called `Lookup``Long`, containing the code `Lookup(Long,
    -1)`. Place the two newly created calculated fields on the **Measure Values**
    shelf.'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建另外两个计算字段，一个名为`Lookup Lat`，包含代码`Lookup(Lat,-1)`，另一个名为`Lookup Long`，包含代码`Lookup(Long,
    -1)`。将这两个新创建的计算字段放到**Measure Values**架上。
- en: 'Create a calculated field named `Great``Circle``Distance``Formula` with the
    following code:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`Great Circle Distance Formula`的计算字段，包含以下代码：
- en: '[PRE0]'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: For kilometers, change `3959` to `6378`. This number represents the radius of
    the Earth and it needs to be updated from miles to kilometers.
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于公里数，将`3959`更改为`6378`。这个数字表示地球的半径，需要将其从英里更新为公里。
- en: Place the newly created calculated field **Great Circle Distance Formula** on
    the **Measure Values** shelf.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新创建的计算字段**Great Circle Distance Formula**放到**Measure Values**架上。
- en: 'Change the calculation for **Great Circle Distance Formula** so that it computes
    using **City** by clicking on the field itself and selecting **Compute Using:
    City**.'
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '更改**Great Circle Distance Formula**的计算方式，使其使用**City**进行计算，方法是点击字段本身并选择**Compute
    Using: City**。'
- en: 'Adjust the following calculations accordingly:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 相应地调整以下计算：
- en: '| **Name** | **Code** |'
  id: totrans-47
  prefs: []
  type: TYPE_TB
  zh: '| **名称** | **代码** |'
- en: '| `Lookup Lat` |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '| `Lookup Lat` |'
- en: '[PRE1]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '|'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: '| `Lookup Long` |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '| `Lookup Long` |'
- en: '[PRE2]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '|'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: Select the `Map` worksheet and set the **Marks** type to **Line**.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`Map`工作表并将**Marks**类型设置为**Line**。
- en: Place **Trip ID** on the **Detail** shelf.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**Trip ID**放到**Detail**架上。
- en: Drag **City** to the bottom of the **Marks** card view.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**City**拖到**Marks**卡视图的底部。
- en: 'Place the **Great Circle Distance Formula** field on the **Tooltip** shelf.
    Double-check that it is still set to **Compute Using: City**:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '将**Great Circle Distance Formula**字段放到**Tooltip**架上。再次检查它是否仍然设置为**Compute Using:
    City**：'
- en: '![Chart'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '![图表'
- en: Description automatically generated](img/B18435_09_06.png)
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '[自动生成的描述](img/B18435_09_06.png)'
- en: 'Figure 9.6: Australia distances'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.6：澳大利亚距离
- en: 'Create two more calculated fields, one called `Source City`, containing the
    following code:'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建另外两个计算字段，一个名为`Source City`，包含以下代码：
- en: '[PRE3]'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The second calculated field should be called `Destination City` and contain
    the following code:'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 第二个计算字段应命名为`Destination City`，并包含以下代码：
- en: '[PRE4]'
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Use the newly created calculated fields to format as desired. In particular,
    notice that in the following screenshot, **Source City** is on the **Color** shelf
    and **Destination City** is used on the **Tooltip** shelf:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用新创建的计算字段按需格式化。特别注意，在以下截图中，**Source City**位于**Color**架上，而**Destination City**则用于**Tooltip**架：
- en: '![Chart'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '![图表'
- en: Description automatically generated](img/B18435_09_07.png)
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '[自动生成的描述](img/B18435_09_07.png)'
- en: 'Figure 9.7: Flights'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.7：航班
- en: To sum up what we have done here, initially, we added a dataset to Tableau.
    We then needed to copy the latitudes and longitudes per city out of the workbook
    in order to create a second data source, which we then used as a blend to look
    up latitude and longitude values. With the help of LOD calculations, we could
    identify the source and destination cities, and lastly, we were able to measure
    the distance between cities by using the so-called great circle formula. Each
    color in the visualization represents a starting city; for example, all green
    lines measure distances from Perth to other cities. By hovering over a line, the
    source and destination city, as well as the distance measured in miles (or kilometers),
    will show.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 总结我们所做的事情，首先，我们将一个数据集添加到 Tableau 中。然后，我们需要从工作簿中复制每个城市的纬度和经度，以创建第二个数据源，我们随后将其作为混合数据源来查找纬度和经度值。通过使用
    LOD 计算，我们可以识别源城市和目的城市，最后，利用所谓的大圆公式，我们能够测量城市之间的距离。可视化中每种颜色代表一个起始城市；例如，所有绿色线条表示从珀斯到其他城市的距离。通过将鼠标悬停在某条线段上，可以显示源城市和目的城市，以及以英里（或公里）为单位的距离。
- en: If you wanted to analyze shipment routes or any other distances between two
    points, you now know exactly how to visualize this kind of data in Tableau.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想分析运输路线或任何两个点之间的距离，现在你已经知道如何在 Tableau 中可视化这种数据。
- en: '![Chart, diagram, radar chart'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '![图表，图示，雷达图'
- en: Description automatically generated](img/B18435_09_08.png)
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_08.png)
- en: 'Figure 9.8: U.S. Flight Departure Delays'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.8：美国航班起飞延误
- en: 'In *Figure 9.8*, you can see another, similar visualization, which is definitely
    worth checking out (try to replicate it!): [https://www.tableau.com/solutions/workbook/big-data-more-common-now-ever](https://www.tableau.com/solutions/workbook/big-data-more-common-now-ever).'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *图 9.8* 中，你可以看到另一个相似的可视化，这绝对值得一看（试着复制它！）：[https://www.tableau.com/solutions/workbook/big-data-more-common-now-ever](https://www.tableau.com/solutions/workbook/big-data-more-common-now-ever)。
- en: In the next section, we will discuss how to leverage a combination of maps and
    polygons to further extend our Tableau toolbox.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将讨论如何利用地图和多边形的结合，进一步扩展我们的 Tableau 工具箱。
- en: Creating custom polygons
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建自定义多边形
- en: 'Geographic areas for which Tableau natively provides polygons include worldwide
    airport codes, cities, countries, regions, territories, states, provinces, and
    some postcodes and second-level administrative districts (county-equivalents):
    U.S. area codes, **Core-Based Statistical Areas** (**CBSAs**), **Metropolitan
    Statistical Areas** (**MSAs**), congressional districts, and ZIP codes. This means,
    for example, that a filled map can easily be created for the countries of the
    world. Simply copy a list of the world’s countries (*Ctrl* + *C*) and paste that
    list into Tableau by pressing *Ctrl* + *V* while your mouse is located on an empty
    worksheet in Tableau Desktop. A new data source will be added to the top right
    under **Data**. Next, set the **View** type in Tableau to **Filled Map** and place
    the country list on the **Detail** shelf. Tableau will automatically draw polygons
    for each of those data points:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 原生提供多种地理区域的多边形，包括全球机场代码、城市、国家、地区、领土、州、省以及一些邮政编码和二级行政区（县级等效）：美国区号、**核心统计区域**（**CBSAs**）、**大都市统计区域**（**MSAs**）、国会选区和邮政编码。这意味着，例如，可以轻松地为世界各国创建填充地图。只需复制世界各国的列表（*Ctrl*
    + *C*），然后在 Tableau Desktop 中将该列表粘贴（*Ctrl* + *V*），同时将鼠标定位在一个空白工作表上。一个新的数据源将添加到右上方的
    **数据** 部分。接下来，将 Tableau 中的 **视图** 类型设置为 **填充地图**，并将国家列表放到 **详细信息** 区域。Tableau
    会自动为每个数据点绘制多边形：
- en: '![](img/B18435_09_09.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_09.png)'
- en: 'Figure 9.9: Native polygons'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.9：原生多边形
- en: 'There are some geographic types for which Tableau will not automatically provide
    polygons. These include telephone area codes. For these geographic types, Tableau
    will draw a symbol map but not a filled map, like so:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 对于某些地理类型，Tableau 不会自动提供多边形。这些类型包括电话区号。对于这些地理类型，Tableau 会绘制符号地图，而不是填充地图，如下所示：
- en: '![Map  Description automatically generated](img/B18435_09_10.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![地图  自动生成的描述](img/B18435_09_10.png)'
- en: 'Figure 9.10: Filled map failed'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.10：填充地图失败
- en: Even though the filled map **Marks** type is chosen, Tableau is not able to
    fill the map because the outlines of those areas are unknown to Tableau. Furthermore,
    special mapping needs may arise that require polygons to be drawn for areas that
    are not typically included on maps. For example, an organization may define sales
    regions that don’t follow the usual map boundaries. Or, a Tableau author may import
    an image of a basketball court or football pitch into Tableau and draw polygons
    to represent particular parts of the playing area. An alternative, which we discussed
    in more detail in *Chapter 8*, *Going Beyond the Basics*, could be mapping bookshelves
    in a store.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 即使选择了填充地图 **标记** 类型，Tableau 也无法填充地图，因为这些区域的轮廓对 Tableau 来说是未知的。此外，可能会出现需要为通常不包含在地图上的区域绘制多边形的特殊映射需求。例如，一个组织可能会定义不遵循常规地图边界的销售区域。或者，Tableau
    作者可能会将篮球场或足球场的图像导入 Tableau，并绘制多边形来表示场地的特定部分。另一种替代方案是，我们在 *第8章*《超越基础》中更详细地讨论过的，可以是为商店中的书架制作地图。
- en: But other than drawing polygons yourself, there are also file types that support
    drawing polygons. One of those file types is `.shp`. In the next exercise, we
    will make use of such a file and create polygons for Texas.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 除了自己绘制多边形外，还有一些文件类型支持绘制多边形。`.shp` 就是其中一种。在接下来的练习中，我们将使用这样的文件并为德克萨斯州创建多边形。
- en: Polygons for Texas
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 德克萨斯州的多边形
- en: 'By processing an example of the aforementioned `.shp` file type, Tableau can
    create polygons. Let’s try this out and show the population of Texas as polygons
    on a map of Texas:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 通过处理上述 `.shp` 文件类型的示例，Tableau 可以创建多边形。让我们尝试一下，并在德克萨斯州的地图上以多边形的形式展示德克萨斯州的人口：
- en: 'Open the **Texas Department of Transportation** page: [https://gis-txdot.opendata.arcgis.com/datasets/txdot-city-boundaries/explore?location=30.990445%2C-100.168292%2C6.68](https://gis-txdot.opendata.arcgis.com/datasets/txdot-city-boundaries/explore?location=30.990445%2C-100.168292%2C6.68).'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 **德克萨斯州交通部** 页面：[https://gis-txdot.opendata.arcgis.com/datasets/txdot-city-boundaries/explore?location=30.990445%2C-100.168292%2C6.68](https://gis-txdot.opendata.arcgis.com/datasets/txdot-city-boundaries/explore?location=30.990445%2C-100.168292%2C6.68)。
- en: Use the **Download** dropdown and download **Shapefile**:![](img/B18435_09_11.png)
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 **下载** 下拉菜单下载 **Shapefile**：![](img/B18435_09_11.png)
- en: 'Figure 9.11: Texas data'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 9.11：德克萨斯州数据
- en: 'In your `download` directory, you should find multiple files:'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在你的 `downloads` 目录中，你应该可以看到多个文件：
- en: '![](img/B18435_09_12.png)'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/B18435_09_12.png)'
- en: 'Figure 9.12: Texas city boundaries'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 9.12：德克萨斯州城市边界
- en: 'If you were to open a `.shp` file in a text editor, you would see the following:'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你在文本编辑器中打开 `.shp` 文件，你会看到以下内容：
- en: '![](img/B18435_09_13.png)'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/B18435_09_13.png)'
- en: 'Figure 9.13: .shp in a text editor'
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 9.13：文本编辑器中的 `.shp`
- en: Luckily, Tableau has native capabilities to read `.shp` files. In the workbook
    associated with this chapter, navigate to the `City` `Limits` worksheet and select
    **Data** | **New Data Source** | **Text File**.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 幸运的是，Tableau 本身具备读取 `.shp` 文件的能力。在本章相关的工作簿中，导航到 `City` `Limits` 工作表并选择 **数据**
    | **新建数据源** | **文本文件**。
- en: 'Navigate to your `downloads` directory or the path where you saved the Texas
    shapefiles and select the `.shp` file:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到你的 `downloads` 目录或保存德克萨斯州 shapefile 的路径，并选择 `.shp` 文件：
- en: '![](img/B18435_09_14.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_14.png)'
- en: 'Figure 9.14: Loading a spatial file'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.14：加载空间文件
- en: 'In the next screenshot, you can see how Tableau was able to read the `.shp`
    file and how it created an additional field called **Geometry** that indicates
    that we are looking at polygons and multipolygons in this file:'
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一个截图中，你可以看到 Tableau 如何读取 `.shp` 文件，以及它如何创建一个名为 **Geometry** 的附加字段，表示我们正在查看文件中的多边形和多重多边形：
- en: '![](img/B18435_09_15.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_15.png)'
- en: 'Figure 9.15: Geometry'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.15：几何图形
- en: 'Open a new worksheet and drag **Geometry** onto the empty canvas:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新工作表并将 **Geometry** 拖动到空白画布上：
- en: '![](img/B18435_09_16.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_16.png)'
- en: 'Figure 9.16: Adding geometry'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.16：添加几何图形
- en: 'And look at that! Tableau created polygons around areas in Texas right away:'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 看！Tableau 立刻在德克萨斯州的区域周围创建了多边形：
- en: '![](img/B18435_09_17.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_17.png)'
- en: 'Figure 9.17: Texas polygons'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.17：德克萨斯州多边形
- en: Feel free to adjust the formatting via **Map** | **Background Maps** | **Dark**.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可以通过 **地图** | **背景地图** | **深色** 来调整格式。
- en: Put the **City Nm** field on **Detail** and **Pop2010** on **Color** in the
    **Marks** card. (The color used in *Figure 9.17* is **Temperature Diverging**.)
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **City Nm** 字段放在 **详细信息** 上，**Pop2010** 放在 **颜色** 上，位于 **标记** 卡片中。（*图 9.17*
    中使用的颜色是 **温度渐变**。）
- en: 'Your worksheet should look as follows:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你的工作表应如下所示：
- en: '![](img/B18435_09_18.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_18.png)'
- en: 'Figure 9.18: Texas city boundaries'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.18：德克萨斯州城市边界
- en: You can see that we have a nice dark map now with polygons on top. The polygons
    define the area per city name (using the field **City Nm**) as published by the
    government of Texas. By placing the measure of the population in 2010 (using the
    field **Pop2010**) on the **Color** shelf, we can also see that the areas with
    red polygons had the highest number of inhabitants in 2010 and dark green the
    least.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，现在我们有了一张漂亮的深色地图，地图上有多边形。这些多边形定义了每个城市名称（使用字段**City Nm**）所对应的区域，这些数据由德克萨斯州政府发布。通过将2010年的人口数据（使用字段**Pop2010**）放置在**颜色**架上，我们还可以看到，红色多边形所在的区域在2010年人口最多，而深绿色区域人口最少。
- en: You might not like the polygons or maybe you are wondering if a spatial file
    like a `.shp` will only allow you to use polygons. Luckily, the answer is we can
    change the map, no matter whether it’s a spatial file or not. I really like heatmaps
    to display geographical density, so let’s use them in the next section.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能不喜欢多边形，或者您可能在想，像 `.shp` 这样的空间文件是否只能使用多边形。幸运的是，答案是我们可以改变地图，无论它是否是空间文件。我非常喜欢使用热力图来显示地理密度，所以我们将在接下来的部分使用它们。
- en: Heatmaps
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 热力图
- en: I want to share a feature with you that was part of an earlier Tableau release
    and has proven to be very useful when working with geographical data. It is the
    **Marks** type **Density** with which you can create heatmaps. This new feature
    is not limited to maps; you can also use it for any other type of chart. However,
    it is most efficient for dense data where patterns cannot be spotted easily.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我想与您分享一个功能，它是在早期的Tableau版本中加入的，已经证明在处理地理数据时非常有用。这个功能是**标记**类型**密度**，通过它您可以创建热力图。这个新功能不仅限于地图，您也可以用它来创建任何其他类型的图表。然而，它对于密集数据特别高效，在这些数据中很难轻易发现模式。
- en: 'The following steps will illustrate an example of creating a **heatmap**:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤将演示如何创建**热力图**的示例：
- en: Open the `Citylimits` tab in the workbook related to this chapter. If you did
    not complete the previous exercise, please open the `Citylimits` tab from the
    solutions workbook of this chapter.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开与本章相关的工作簿中的`Citylimits`选项卡。如果您没有完成之前的练习，请从本章的解决方案工作簿中打开`Citylimits`选项卡。
- en: Duplicate the worksheet, and call it `City Limits (2)`.
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制工作表，并将其命名为`City Limits (2)`。
- en: 'Set the **Marks** card type to **Density**:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**标记**卡片的类型设置为**密度**：
- en: '![](img/B18435_09_19.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_19.png)'
- en: 'Figure 9.19: Texas city density'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.19：德克萨斯州城市密度
- en: Click on **Color** in the **Marks** card and select any color you like. I chose
    **Density Gold Dark**.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**颜色**在**标记**卡片中，选择您喜欢的任何颜色。我选择了**密度金色深色**。
- en: 'Decrease **Size** in the **Marks** card by dragging the slider to the left.
    Drag until you like the size of the circles on your map:'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过拖动滑块向左减少**大小**，直到您喜欢地图上圆圈的大小为止：
- en: '![](img/B18435_09_20.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_20.png)'
- en: 'Figure 9.20: Heatmap'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.20：热力图
- en: Heatmaps can show you a spatial concentration and are perfect for very dense
    datasets. In the preceding figure, you can see that we lost the surroundings of
    the city, the polygon structure; however, we can still see the densely populated
    areas and now every city has the same size, making it easier to compare smaller
    with bigger geographic locations. And we were able to prove that a spatial file
    does not need to be used with polygons.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 热力图可以显示空间集中度，特别适合处理非常密集的数据集。在前面的图中，您可以看到城市周边的区域和多边形结构丢失了；然而，我们依然能看到人口密集的区域，并且每个城市的大小相同，使得小型和大型地理位置的比较变得更加容易。同时，我们也证明了不需要使用空间文件就可以与多边形一起使用。
- en: 'In the Tableau 2020.4 release, another feature was added: map layers. What
    they are and what they are used for will be described in the next section.'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在Tableau 2020.4版本中，新增了一个功能：地图层。它是什么以及如何使用，我们将在下一部分中介绍。
- en: Dual axes and layering maps
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 双轴与地图分层
- en: You might recall that on many different occasions throughout the previous chapters,
    we used dual axes. A dual axis visualization can also be achieved with maps, and,
    even better, since the Tableau 2020.4 release, maps can be layered. We simply
    add another layer with the same structure (which, in this case, is a map), and
    per layer, we can display different data.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能还记得，在之前的章节中，我们多次使用了双轴。在地图中同样可以实现双轴可视化，而且更好的是，自Tableau 2020.4版本以来，地图可以进行分层。我们只需添加另一个相同结构的层（在这种情况下是地图），并且每个层可以显示不同的数据。
- en: We will look at two exercises, the first one being about the use of dual axes
    and the second one including include map layers.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将探讨两个练习，第一个是关于使用双轴，第二个是关于添加地图层。
- en: Using dual axes
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用双轴
- en: 'Let’s get started:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始吧：
- en: 'First, we need a dataset. I simply created one in Excel myself; feel free to
    create your own, copy what you see in the following screenshot, or download the
    file from this book’s GitHub repository ([https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter09/Freight.xlsx](https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter09/Freight.xlsx)).
    Name the file `freight`:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要一个数据集。我自己在 Excel 中创建了一个数据集；你可以随意创建你自己的，或者复制以下截图中的内容，或者从本书的 GitHub 仓库下载文件（[https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter09/Freight.xlsx](https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter09/Freight.xlsx)）。将文件命名为`freight`：
- en: '![Graphical user interface, application, table, Excel'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，应用程序，表格，Excel'
- en: Description automatically generated](img/B18435_09_21.png)
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_21.png)
- en: 'Figure 9.21: Excel'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.21：Excel
- en: Connect the new dataset to Tableau and open a new worksheet called `Dual-axis
    map`.
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新的数据集连接到 Tableau，并打开一个名为`Dual-axis map`的新工作表。
- en: 'Double-click on **Origin Country** and the following map will appear:'
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击**原产国**，接下来会显示如下地图：
- en: '![](img/B18435_09_22.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_22.png)'
- en: 'Figure 9.22: Dual-axis map'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.22：双轴地图
- en: 'Change the **Marks** card type to a filled map and drag **Goods** onto the
    **Color** shelf:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**Marks**卡片类型更改为填充地图，并将**货物**拖到**颜色**架上：
- en: '![](img/B18435_09_23.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_23.png)'
- en: 'Figure 9.23: Dual-axis map II'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.23：双轴地图 II
- en: 'Click on **Longitude** in the **Columns** shelf, press *Ctrl* (or *Command*
    on Mac), and simultaneously move the field to its right. You should have copied
    a second copy of the **Longitude** field to the **Columns** shelf:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**列**架上点击**经度**，按下*Ctrl*（在 Mac 上按*Command*），同时将字段移动到右侧。你应该已经复制了第二个**经度**字段到**列**架上：
- en: '![](img/B18435_09_24.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_24.png)'
- en: 'Figure 9.24: Copying Longitude'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.24：复制经度
- en: 'You can also see that the **Marks** card maintains two layers now, plus an
    additional **All** layer, just like dual axes on a bar chart would:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你还可以看到**Marks**卡片现在保持了两个层，外加一个额外的**All**层，就像条形图的双轴一样：
- en: '![](img/B18435_09_25.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_25.png)'
- en: 'Figure 9.25: Marks card'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.25：Marks 卡片
- en: 'On the bottom layer, replace **Goods** with **Origin** on the **Color** shelf
    and see how the second map now shows colored dots representing cities:'
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在底部层中，将**货物**替换为**原产地**，并将其添加到**颜色**架上，看看第二张地图现在如何显示代表城市的彩色点：
- en: '![](img/B18435_09_26.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_26.png)'
- en: 'Figure 9.26: Dual-axis map'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.26：双轴地图
- en: Click on the right **Longitude** field in the **Columns** shelf and select **Dual
    Axis**.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**列**架右侧的**经度**字段，并选择**双轴**。
- en: 'You created your first layered map! Each country’s color represents the types
    of goods it ships. The dots indicate the cities for train, ship, plane, or truck
    transport:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 你创建了你的第一个分层地图！每个国家的颜色表示其运输的货物类型。点表示火车、船舶、飞机或卡车运输的城市：
- en: '![](img/B18435_09_27.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_27.png)'
- en: 'Figure 9.27: Dual-axis map'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.27：双轴地图
- en: After completing the first basic exercise, we will move on to a more complex
    one, using the newer map layering functionality.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 完成第一个基本练习后，我们将进入更复杂的练习，使用新的地图层叠功能。
- en: Adding map layers
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加地图层
- en: 'We want to visualize the transport routes with a line from the start to the
    destination city. We also want to show the time to delivery as well as the weight
    of the shipment. We will continue using the `freight` dataset from before; we
    just need to do some adjustments:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望通过从起点到目的地城市的线条来可视化运输路线。我们还想显示交货时间以及货物的重量。我们将继续使用之前的`freight`数据集，只需要做一些调整：
- en: 'The `freight` dataset does not have longitudes or latitudes, which are crucial
    for some of Tableau’s spatial calculated fields, like `MAKEPOINT`, which we will
    need later on. Open Google Maps and type in a city from the dataset, for example,
    `Lisbon`. In the URL, you will be able to find the longitude and latitude:'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`freight`数据集没有经度或纬度，这对于某些 Tableau 空间计算字段至关重要，例如我们后面需要的`MAKEPOINT`。打开谷歌地图，输入数据集中的一个城市，例如`Lisbon`。在网址中，你将能够找到经度和纬度：'
- en: '![](img/B18435_09_28.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_28.png)'
- en: 'Figure 9.28: Google Maps'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.28：谷歌地图
- en: 'Copy them and add them to a separate Excel sheet, as shown in the following
    screenshot, and call it `latlong`:'
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制这些内容并将其添加到一个单独的 Excel 表格中，如下图所示，并将其命名为`latlong`：
- en: '![Map'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '![地图'
- en: Description automatically generated](img/B18435_09_29.png)
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_29.png)
- en: 'Figure 9.29: Excel'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.29：Excel
- en: 'We needed to use a new Excel sheet because we have to create a spatial field
    for destinations as well as the origin. Since some cities are an origin as well
    as a destination, we will create two inner joins; both times, the initial `freight`
    Excel sheet will connect to the recently created `latlong` Excel sheet (if you
    downloaded the data from GitHub, the `latlong` table is the second tab in the
    `Freight.xlsx`):'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要使用新的Excel表格，因为我们还需要为目的地创建一个空间字段。由于一些城市既是源城市也是目的城市，我们将创建两个内部连接；每次，最初的`货运`（`freight`）Excel表格将与新创建的`经纬度`（`latlong`）Excel表格连接（如果你从GitHub下载了数据，`latlong`表格位于`Freight.xlsx`的第二个标签中）：
- en: '![A picture containing diagram'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_30.png)
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_30.png)
- en: 'Figure 9.30: Join'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.30：连接
- en: 'The only difference will be that the first join is made on **Origin** and **City**
    and the second on **Destination** and **City**. Rename the **latlong** data sources
    by double-clicking on the name, to avoid confusion:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 唯一的区别在于，第一个连接是基于**源**（**Origin**）和**城市**（**City**），第二个连接是基于**目的地**（**Destination**）和**城市**（**City**）。通过双击名称来重命名**经纬度**（**latlong**）数据源，以避免混淆：
- en: '![](img/B18435_09_31.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_31.png)'
- en: 'Figure 9.31: Join II'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.31：连接 II
- en: 'Open a new workbook and name it `4-layer map`. Create a calculated field called
    `Line`, with the following code:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的工作簿并命名为`4层地图`（`4-layer map`）。创建一个名为`线路`（`Line`）的计算字段，代码如下：
- en: '[PRE5]'
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The Tableau description shows that to make a point based on a spatial location,
    Tableau needs the longitude and latitude, or coordinates.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Tableau的描述显示，要根据空间位置创建一个点，Tableau需要经度和纬度或坐标。
- en: '![A picture containing diagram'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_32.png)
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_32.png)
- en: 'Figure 9.32: MAKEPOINT'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.32：MAKEPOINT
- en: 'Create another calculated field called `Days to delivery`, with the following
    code:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`交货天数`（`Days to delivery`）的计算字段，代码如下：
- en: '[PRE6]'
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Double-click on **City** from the **Origin** file and a map will appear, but
    you will encounter **12 unknown**. Click on the error and then **Edit Locations…**:'
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击**城市**（**City**）来自**源文件**（**Origin**），地图将会显示，但你将遇到**12个未知**（**12 unknown**）。点击错误信息然后选择**编辑位置...**（**Edit
    Locations…**）：
- en: '![A picture containing diagram'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_33.png)
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_33.png)
- en: 'Figure 9.33: Unknown cities'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.33：未知城市
- en: 'You will see that Tableau uses **United Kingdom** (it might be different for
    you) as a default country to find every city, but Tableau is unsuccessful because
    we have cities all over Europe in our dataset. Instead of a **Fixed** location,
    use the **From field** option and select **Origin Country**. Now this field will
    be used as a country per city in our dataset:'
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你会看到，Tableau默认使用**英国**（**United Kingdom**）（你的可能不同）作为查找每个城市的默认国家，但由于我们的数据集中包含了欧洲各地的城市，Tableau无法成功识别。你应该使用**字段中选择**（**From
    field**）选项，选择**源国家**（**Origin Country**）。现在这个字段将会作为每个城市在我们数据中的国家：
- en: '![A picture containing diagram'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_34.png)
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_34.png)
- en: 'Figure 9.34: Origin Country'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.34：源国家（**Origin Country**）
- en: 'Tableau automatically adds **Origin Country** to the view on the **Detail**
    shelf and displays the cities correctly now. You can also achieve the previous
    step by placing **Origin Country** on the **Detail** shelf directly:'
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Tableau会自动将**源国家**（**Origin Country**）添加到**详细信息**（**Detail**）货架，并且现在可以正确显示城市。你也可以通过直接将**源国家**（**Origin
    Country**）放到**详细信息**（**Detail**）货架来实现上一步：
- en: '![A picture containing diagram'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_35.png)
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_35.png)
- en: 'Figure 9.35: Origin cities'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.35：源城市
- en: Since one of our goals is to draw lines between the **Origin** and **Destination**
    cities, it only makes sense to also add **Destination**, correct? Double-click
    on **Destination** to add it to the visualization.
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于我们的目标之一是画出**源**（**Origin**）和**目的地**（**Destination**）城市之间的连线，因此将**目的地**（**Destination**）也加进去是有意义的，对吗？双击**目的地**（**Destination**）将其添加到可视化中。
- en: 'We now have all **Origin** and **Destination** cities in our view, but we won’t
    be able to distinguish between them because they are all on the same layer. Therefore,
    drag the just-added **Destination** field from the **Detail** shelf to the upper-left
    corner of your view, until the **Add a Marks Layer** sign appears:'
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们在视图中有了所有的**源**（**Origin**）和**目的地**（**Destination**）城市，但由于它们都在同一图层上，我们无法区分它们。因此，将刚刚添加的**目的地**（**Destination**）字段从**详细信息**（**Detail**）货架拖动到视图的左上角，直到出现**添加标记图层**（**Add
    a Marks Layer**）标志：
- en: '![A picture containing diagram'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_36.png)
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_36.png)
- en: 'Figure 9.36: Freight II'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.36：货运 II
- en: 'You will now see that the **Marks** card shows two layers:'
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在你会看到，**标记**卡片显示了两个层：
- en: '![Graphical user interface, text, application'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，文本，应用程序'
- en: Description automatically generated](img/B18435_09_37.png)
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_37.png)
- en: 'Figure 9.37: Marks'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.37：标记
- en: Rename the `Destination` layer to `Destination` `Country` by double-clicking
    on the name.
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击名称将`Destination`层重命名为`Destination` `Country`。
- en: 'Add another layer by dragging **Line** onto **Add a Marks Layer** and add **Days
    to Delivery** to **Color**. Name this layer `Line` and select the **Automatic**
    type from the **Marks** card dropdown:'
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过将**线条**拖动到**添加标记层**上，再将**交货天数**添加到**颜色**中，添加另一个层并命名为`线条`，从**标记**卡片下拉菜单中选择**自动**类型：
- en: '![Graphical user interface, text, application'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，文本，应用程序'
- en: Description automatically generated](img/B18435_09_38.png)
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_38.png)
- en: 'Figure 9.38: Marks layer'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.38：标记层
- en: 'Add another layer by dragging **City** onto **Add a Marks Layer** and call
    it `City (2)`. Add **Destination Country** to **Detail**. Select the **Automatic**
    type from the **Marks** card dropdown:'
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过将**城市**拖动到**添加标记层**上，再命名为`City (2)`，并将**目的地国家**添加到**详情**中。从**标记**卡片下拉菜单中选择**自动**类型：
- en: '![Graphical user interface, application'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，应用程序'
- en: Description automatically generated](img/B18435_09_39.png)
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_39.png)
- en: 'Figure 9.39: Marks layer'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.39：标记层
- en: 'Lastly, go back to the **Destination Country** layer, change **Destination
    Country** to **Detail**, and put **Weight** on **Color**. Select **Map** from
    the **Marks** card dropdown:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，返回到**目的地国家**层，将**目的地国家**更改为**详情**，并将**重量**放置在**颜色**上。从**标记**卡片下拉菜单中选择**地图**：
- en: '![Graphical user interface, text, application'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，文本，应用程序'
- en: Description automatically generated](img/B18435_09_40.png)
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_40.png)
- en: 'Figure 9.40: Marks layer'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.40：标记层
- en: 'Sort by dragging and dropping the layers in the following order: **Line**,
    **City**, **City (2)**, and **Destination Country**. Your worksheet should now
    look as follows:'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过拖放以下顺序对层进行排序：**线条**、**城市**、**城市 (2)**、和**目的地国家**。你的工作表现在应该如下所示：
- en: '![A picture containing diagram'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '![包含图表的图片'
- en: Description automatically generated](img/B18435_09_41.png)
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_41.png)
- en: 'Figure 9.41: Map'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.41：地图
- en: In order to make the visualization a bit easier to interpret, put **Origin**
    on the **Filters** shelf and select only a few origins of your choosing.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了使可视化更容易解读，将**起点**放到**筛选器**架上，并仅选择几个你挑选的起点。
- en: 'And to distinguish the **Origin** from the **Destination**, open the **City**
    and **City (2)** map layers and change **City** and **City (Destination)** respectively
    from **Detail** to **Shape**. Select one shape for the **Origin** and another
    for the **Destination**, for example, filled circles for **Origin** and crosses
    for **Destination**. You can also color the shapes by clicking on the **Color**
    shelf:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了区分**起点**和**目的地**，打开**城市**和**城市 (2)**地图层，并将**城市**和**城市（目的地）**分别从**详情**更改为**形状**。为**起点**选择一种形状，为**目的地**选择另一种形状，例如，使用实心圆表示**起点**，交叉表示**目的地**。你还可以通过点击**颜色**架来为形状上色：
- en: '![A picture containing diagram'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '![包含图表的图片'
- en: Description automatically generated](img/B18435_09_42.png)
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_09_42.png)
- en: 'Figure 9.42: Final layered map'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.42：最终分层地图
- en: Now, let’s look at what we have created. We can see that goods are being transported
    from every circle to a cross city. Both cities are connected by a yellow-to-red
    range colored line. More yellow-toned means that the delivery was fast, and more
    red-toned means that the delivery took longer. The destination country is colored
    in a turquoise-to-dark-blue color range. The darker the color, the more weight
    has been transported there. We can easily spot that Italy received the heaviest
    transport, coming from Istanbul and being delivered within 6 days. The slowest
    delivery was from Budapest to Warsaw, which took 26 days.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们来看看我们创建了什么。我们可以看到，货物正从每个圆圈城市运输到交叉城市。两个城市通过一条从黄色到红色的线连接。黄色调越多表示运输越快，而红色调越多则表示运输时间较长。目的地国家的颜色从绿松石色到深蓝色的色域变化。颜色越深，表示运输的重量越大。我们可以轻松发现，意大利接收了最重的运输，来自伊斯坦布尔并在6天内送达。最慢的运输是从布达佩斯到华沙，历时26天。
- en: I hope that this exercise showed you the benefits of layered maps. Each layer
    allows you to use **Color**, **Shape**, **Size**, **Label**, and other **Marks**
    in its unique way, opening new paths for your analysis. In the next section, we
    will go even further and use external technology for maps in Tableau.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 希望这个练习能向你展示分层地图的好处。每一层都可以通过独特的方式使用**颜色**、**形状**、**大小**、**标签**及其他**标记**，为你的分析开辟新的路径。在接下来的部分，我们将更进一步，使用外部技术在Tableau中制作地图。
- en: Extending Tableau mapping with other technology
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扩展Tableau地图功能与其他技术
- en: Next, we will consider how to extend Tableau’s mapping capabilities with other
    tools. Tableau’s developers were careful to create a mapping interface that is
    readily extensible. Some areas of this extensibility, such as connecting to a
    **Web Map Service** (**WMS**) server, are available directly from the interface;
    we’ll explore that next.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将考虑如何利用其他工具扩展Tableau的地图功能。Tableau的开发者小心翼翼地创建了一个易于扩展的地图接口。某些扩展性区域，例如连接到**Web地图服务**（**WMS**）服务器，可以直接从界面上使用；我们接下来将探索这一部分。
- en: Using custom maps with a WMS
  id: totrans-231
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用WMS的自定义地图
- en: The easiest way to bring a custom map into Tableau is directly from Desktop.
    We need a properly formatted URL that points to a WMS server. Tableau Desktop
    can connect to any WMS server that supports the WMS 1.0.0, 1.1.0, or 1.1.1 standards.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 将自定义地图带入Tableau的最简单方法是直接通过桌面。我们需要一个格式正确的URL，指向WMS服务器。Tableau桌面可以连接支持WMS 1.0.0、1.1.0或1.1.1标准的任何WMS服务器。
- en: A good place to find a list of such URLs is [http://directory.spatineo.com](http://directory.spatineo.com),
    which provides information on a ton of different mapping services.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 找到这类URL的好地方是[http://directory.spatineo.com](http://directory.spatineo.com)，它提供了大量不同地图服务的信息。
- en: 'The following exercise was inspired by Jeffrey A. Shaffer’s article *Building
    weather radar in Tableau in under 1 minute*, which can be accessed here: [https://www.dataplusscience.com/TableauWeatherRadar.html](https://www.dataplusscience.com/TableauWeatherRadar.html).
    However, we will include a different map and our source is the *NASA Earth Observation*
    data ([https://neo.gsfc.nasa.gov/](https://neo.gsfc.nasa.gov/)). In this exercise,
    we will see that by plotting additional data—in the form of background images—underneath
    your dataset, you will be able to make better decisions for your business. For
    example, if your sales figures are dependent on good (or bad) weather or your
    production is at risk of close-by wildfires, you will be able to see this all
    in one Tableau dashboard:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 以下练习灵感来源于Jeffrey A. Shaffer的文章*在Tableau中用不到1分钟构建天气雷达*，可以通过此链接访问：[https://www.dataplusscience.com/TableauWeatherRadar.html](https://www.dataplusscience.com/TableauWeatherRadar.html)。不过，我们将使用不同的地图，数据源是*NASA地球观测*数据（[https://neo.gsfc.nasa.gov/](https://neo.gsfc.nasa.gov/)）。在这个练习中，我们将看到，通过在数据集下方绘制附加数据（作为背景图像），你能够做出更好的商业决策。例如，如果你的销售数据受良好（或不良）天气的影响，或者你的生产面临附近野火的威胁，你将能够在一个Tableau仪表板中看到所有这些信息：
- en: Open the workbook associated with this chapter and navigate to the `WMS Server`
    worksheet via the Desktop.
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开与本章相关的工作簿，并通过桌面导航到`WMS Server`工作表。
- en: Select the `Superstore` data source.
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`Superstore`数据源。
- en: Place **State/Province** on the **Detail** shelf.
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**州/省**放在**详细信息**架上。
- en: 'Copy the [http://neo.gsfc.nasa.gov/wms/wms](http://neo.gsfc.nasa.gov/wms/wms)
    URL, then in Tableau, navigate to **Map** | **Background Maps** | **Add WMS Map**.
    Paste the URL and click **OK**:'
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制[http://neo.gsfc.nasa.gov/wms/wms](http://neo.gsfc.nasa.gov/wms/wms) URL，然后在Tableau中，导航至**地图**
    | **背景地图** | **添加WMS地图**。粘贴URL并点击**确定**：
- en: '![Graphical user interface, application'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，应用程序'
- en: Description automatically generated](img/B18435_09_43.png)
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_09_43.png)
- en: 'Figure 9.43: Add WMS Map'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.43：添加WMS地图
- en: In the **Marks** card, set the **View** type to **Map**.
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**标记**卡片中，将**视图**类型设置为**地图**。
- en: 'Click on the **Color** shelf to turn on **Border**, set the color to white,
    and set **Opacity** to **0%**:'
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**颜色**架以开启**边框**，将颜色设置为白色，并将**不透明度**设置为**0%**：
- en: '![A picture containing diagram'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张图表包含图示'
- en: Description automatically generated](img/B18435_09_44.png)
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_09_44.png)
- en: 'Figure 9.44: Active fires map'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.44：活跃火灾地图
- en: You can now see the active fires from the last month. But, by clicking on **Map**
    | **Background Layers**, more options will appear. Take a look at the left-hand
    side of your screen and select any other info domain you are interested in; how
    about **Average Land Surface Temperature**?
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你现在可以看到过去一个月的活跃火灾情况。但是，点击**地图**|**背景图层**，更多的选项将会出现。查看屏幕左侧，选择你感兴趣的其他信息领域；比如**平均陆地表面温度**怎么样？
- en: '![](img/B18435_09_45.png)'
  id: totrans-248
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_45.png)'
- en: 'Figure 9.45: Land Surface Temperature map'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.45：陆地表面温度地图
- en: 'Or **Cloud Fraction** (don’t forget to first deselect a map before you select
    a new one):'
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 或者**云覆盖率**（在选择新地图之前，别忘了先取消选择当前地图）：
- en: '![](img/B18435_09_46.png)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_46.png)'
- en: 'Figure 9.46: Cloud Fraction map'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.46：云覆盖率地图
- en: This feature will give you endless ways to analyze data related to geographic
    locations. Let’s say you own an online store. You could check if the sale of specific
    products is higher in specific areas, for example, umbrellas in rainy areas and
    sun protection in hotter regions. You can then continue to analyze if the market
    is already satisfied or if it makes sense to invest in marketing for those regions.
    Or maybe you want to move stock to regions where more sales are expected due to
    a weather change. Feel free to share your findings on Tableau Public and make
    sure to use the tag **#MasteringTableau**.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 这个功能将为你提供无尽的方式来分析与地理位置相关的数据。假设你拥有一家在线商店。你可以检查特定产品在特定区域的销售情况，例如，雨区的雨伞和热区的防晒产品。然后，你可以继续分析市场是否已经饱和，或者在这些地区投资营销是否有意义。或者，也许你想把库存转移到那些因天气变化而预期销售更高的地区。随时在
    Tableau Public 上分享你的发现，并确保使用标签**#MasteringTableau**。
- en: Before we proceed, here’s a note on tiling and zooming. Since high-resolution
    maps may be many gigabytes, it’s impractical to require you to download an entire
    map in order to zoom in on one small area. Tiles solve this problem by enabling
    multiple zoom levels. A zoom level of 0 results in a single tile (often a 256
    x 256-pixel PNG image) that displays the entire map. As the zoom levels increase,
    the number of map tiles increases exponentially. Also, a proportionally smaller
    section of the map displays; that is, as the zoom level increases, the area of
    the entire map that displays decreases and the total number of tiles required
    to fill the display remains constant. This helps control the amount of data downloaded
    at any given time.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们继续之前，这里有一个关于切片和缩放的说明。由于高分辨率的地图可能有多个千兆字节，要求你下载整个地图来缩放到某个小区域是不可行的。切片解决了这个问题，通过启用多个缩放级别。缩放级别
    0 会生成一个单一的切片（通常是 256 x 256 像素的 PNG 图像），显示整个地图。随着缩放级别的增加，地图切片的数量呈指数增长。同时，显示的地图区域相对变小；也就是说，随着缩放级别的增加，显示的整个地图区域变小，而填充显示的切片总数保持不变。这有助于控制在任何给定时刻下载的数据量。
- en: Next, we’ll explore Mapbox.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将探索 Mapbox。
- en: Exploring Mapbox
  id: totrans-256
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索 Mapbox
- en: 'Mapbox provides custom maps and integrates natively with Tableau. To learn
    how to build your own custom maps, you can check out its website here: [https://www.mapbox.com/](https://www.mapbox.com/).
    Starting with Tableau 2019.3, multiple Mapbox styles are even available by default:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: Mapbox 提供自定义地图，并与 Tableau 原生集成。要了解如何构建自己的自定义地图，可以访问其网站：[https://www.mapbox.com/](https://www.mapbox.com/)。从
    Tableau 2019.3 开始，多个 Mapbox 样式默认即可使用：
- en: '![Graphical user interface, application  Description automatically generated](img/B18435_09_47.png)'
  id: totrans-258
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，自动生成的应用程序描述](img/B18435_09_47.png)'
- en: 'Figure 9.47: Background Maps'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.47：背景地图
- en: Next to that, Mapbox itself provides an extended mapping service with an accompanying
    web application that enables users to customize maps. This customizability encompasses
    fonts, colors, background images, and more. Mapbox provides basic services free
    of charge but, of course, more maps and greater bandwidth needs will require an
    upgrade with an accompanying fee.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，Mapbox 本身提供了一个扩展的地图服务，并配有一个网络应用程序，允许用户自定义地图。这个自定义功能涵盖了字体、颜色、背景图像等方面。Mapbox
    提供基本的免费服务，但当然，更多的地图和更大的带宽需求将需要升级并支付相应费用。
- en: 'This exercise will show you how to connect to **Mapbox**:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 这个练习将向你展示如何连接到**Mapbox**：
- en: Navigate to [https://www.mapbox.com](https://www.mapbox.com) and create an account.
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问 [https://www.mapbox.com](https://www.mapbox.com) 并创建一个账户。
- en: 'After completing the signup and logging in to **Mapbox**, click on the **Studio**
    link:'
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成注册并登录到**Mapbox**后，点击**Studio**链接：
- en: '![Graphical user interface  Description automatically generated](img/B18435_09_48.png)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面，自动生成的应用程序描述](img/B18435_09_48.png)'
- en: 'Figure 9.48: Mapbox'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: '图 9.48: Mapbox'
- en: Click **New Style** and start creating a map. I chose **Monochrome** | **Dark**
    | **Customize Monochrome**.
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**新建样式**并开始创建地图。我选择了**单色** | **深色** | **自定义单色**。
- en: 'The Mapbox editor should open. Adjust the map based on your needs:'
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Mapbox编辑器应该会打开。根据您的需求调整地图：
- en: '![A picture containing diagram'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_49.png)
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_09_49.png)
- en: 'Figure 9.49: Mapbox integration'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: '图 9.49: Mapbox集成'
- en: 'Click **Share** (in the top-right corner) once you are done. Select **Third
    party** | **Tableau** and copy the URL:'
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成后点击右上角的**分享**。选择**第三方** | **Tableau**并复制URL：
- en: '![A picture containing diagram'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_50.png)
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_09_50.png)
- en: 'Figure 9.50: Mapbox integration'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: '图 9.50: Mapbox集成'
- en: In the workbook associated with this chapter, navigate to the `Mapbox Classic`
    worksheet and select **Map** | **Background Maps** | **Add** **Mapbox Map**.
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本章关联的工作簿中，导航到`Mapbox Classic`工作表，选择**地图** | **背景地图** | **添加** **Mapbox地图**。
- en: Add a **Style Name** (I used `MasteringTableau`) and copy the URL. Click **OK**.
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个**样式名称**（我使用了`MasteringTableau`）并复制URL。点击**确定**。
- en: 'Select the `Superstore` data source, double-click on **State**, and select
    the **MasteringTableau** map style via the **Map** | **Background Maps** | **MasteringTableau**
    path:'
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`Superstore`数据源，双击**State**，通过**地图** | **背景地图** | **MasteringTableau**路径选择**MasteringTableau**地图样式：
- en: '![A picture containing diagram'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_51.png)
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_09_51.png)
- en: 'Figure 9.51: Background Maps'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: '图 9.51: 背景地图'
- en: As you can see, Tableau makes use of the map we previously created in Mapbox.
    Great! So, this means you can customize your map just the way you like it.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，Tableau利用我们之前在Mapbox中创建的地图。太好了！这意味着您可以根据自己的喜好自定义地图。
- en: 'A manual on how to create custom maps and everything else you need to know
    about Mapbox can be found here: [https://docs.mapbox.com/studio-manual/guides/](https://docs.mapbox.com/studio-manual/guides/).'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 如何创建自定义地图及您需要了解的关于Mapbox的所有内容，请参阅此处：[https://docs.mapbox.com/studio-manual/guides/](https://docs.mapbox.com/studio-manual/guides/)。
- en: Swapping maps
  id: totrans-283
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 切换地图
- en: We will now create a dashboard that allows the end user to choose between the
    various maps we just discussed. The technique used for this exercise is known
    as **sheet swapping**. However, a deeper dive into this technique is presented
    in *Chapter 11*, *Designing Dashboard and Best Practices for Visualizations*.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将创建一个仪表板，允许最终用户在我们刚刚讨论的各种地图之间进行选择。用于这个练习的技术被称为**工作表切换**。然而，对这一技术的更深入探讨将在*第11章*中呈现，标题为*仪表板设计与可视化最佳实践*。
- en: 'Let’s look at the necessary steps:'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一下必要的步骤：
- en: 'Navigate to the `MapSwap` sheet in the workbook associated with this chapter.
    Double-click on **State**. Set the **Marks** card view to **Map**, click on **Color**,
    set **Opacity** to **0%**, and lastly, set **Border** to **Automatic**:'
  id: totrans-286
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本章关联的工作簿中，导航到`MapSwap`工作表。双击**State**。将**标记**卡视图设置为**地图**，点击**颜色**，将**不透明度**设置为**0%**，最后，将**边框**设置为**自动**：
- en: '![A picture containing graphical user interface  Description automatically
    generated](img/B18435_09_52.png)'
  id: totrans-287
  prefs: []
  type: TYPE_IMG
  zh: '![一张包含图形用户界面的图片  描述自动生成](img/B18435_09_52.png)'
- en: 'Figure 9.52: Color'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: '图 9.52: 颜色'
- en: 'Duplicate the **MapSwap** sheet twice:'
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制**MapSwap**工作表两次：
- en: '![A picture containing diagram'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_53.png)
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_09_53.png)
- en: 'Figure 9.53: Duplicate MapSwap sheet'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: '图 9.53: 复制MapSwap工作表'
- en: Select the **MapSwap** sheet and navigate to **Map** | **Background Maps** |
    **Normal**.
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**MapSwap**工作表，并导航到**地图** | **背景地图** | **常规**。
- en: Select the **MapSwap (2)** sheet and navigate to **Map** | **Background Maps**
    | **Dark**.
  id: totrans-294
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**MapSwap (2)**工作表，并导航到**地图** | **背景地图** | **深色**。
- en: Select the **MapSwap (3)** sheet and navigate to **Map** | **Background Maps**
    | **Satellite**.
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**MapSwap (3)**工作表，并导航到**地图** | **背景地图** | **卫星**。
- en: 'Create a parameter called **Show Sheet** like so:'
  id: totrans-296
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为**Show Sheet**的参数，如下所示：
- en: '![A picture containing diagram'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片'
- en: Description automatically generated](img/B18435_09_54.png)
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_09_54.png)
- en: 'Figure 9.54: Parameter'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: '图 9.54: 参数'
- en: Right-click on the parameter in the **Data** pane and select **Show Parameter**
    **Control**.
  id: totrans-300
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击**数据**窗格中的参数，选择**显示参数** **控制**。
- en: 'Create a calculated field called `Show Sheet Filter` like the following:'
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`Show Sheet Filter`的计算字段，如下所示：
- en: '[PRE7]'
  id: totrans-302
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Select the `MapSwap` worksheet and place **Show Sheet Filter** on the **Filters**
    shelf. Select **Select from list** and **Normal**:'
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`MapSwap`工作表，并将**显示工作表筛选器**放置在**筛选器**架上。选择**从列表中选择**和**正常**：
- en: '![A picture containing diagram'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: '![一张包含图表的图片](img/B18435_09_56.png)'
- en: Description automatically generated](img/B18435_09_55.png)
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 说明自动生成](img/B18435_09_55.png)
- en: 'Figure 9.55: Sheet filter'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.55：工作表筛选器
- en: 'Select the `MapSwap (2)` worksheet and place **Show Sheet Filter** on the **Filters**
    shelf. This time, select **Custom value list** and type `Dark`:'
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`MapSwap (2)`工作表，并将**显示工作表筛选器**放置在**筛选器**架上。这次选择**自定义值列表**并输入`Dark`：
- en: '![Graphical user interface, text, application, chat or text message  Description
    automatically generated](img/B18435_09_56.png)'
  id: totrans-308
  prefs: []
  type: TYPE_IMG
  zh: '![图形用户界面、文本、应用程序、聊天或文本消息 说明自动生成](img/B18435_09_56.png)'
- en: 'Figure 9.56: Custom value list'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.56：自定义值列表
- en: Repeat the previous step on the `MapSwap (3)` sheet and type `Satellite` instead
    of `Dark`.
  id: totrans-310
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`MapSwap (3)`表上重复之前的步骤，并输入`Satellite`代替`Dark`。
- en: Create a dashboard and call it `db_MapSwap`. Place a vertical container on the
    dashboard.
  id: totrans-311
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个仪表板并命名为`db_MapSwap`。将一个垂直容器放置在仪表板上。
- en: Place all three **MapSwap** sheets in the vertical container and hide their
    titles.
  id: totrans-312
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将所有三个**MapSwap**表放置在垂直容器中并隐藏它们的标题。
- en: 'Select a different map style and see how your map changes:'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择不同的地图样式并查看你的地图如何变化：
- en: '![Map  Description automatically generated](img/B18435_09_57.png)'
  id: totrans-314
  prefs: []
  type: TYPE_IMG
  zh: '![地图 说明自动生成](img/B18435_09_57.png)'
- en: 'Figure 9.57: Swap map'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.57：交换地图
- en: You might have seen a feature like dark/light or day/night backgrounds on your
    own computer or maybe on websites like YouTube or IDEs like PyCharm. With the
    **MapSwap** function, you can now offer the same comfort to your users on your
    Tableau dashboards.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能在自己的计算机上，或者像YouTube、PyCharm等IDE的网站上看到过类似的暗色/亮色或昼夜背景功能。使用**MapSwap**功能，你现在可以在Tableau仪表板上为用户提供相同的便利。
- en: Custom geocoding
  id: totrans-317
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自定义地理编码
- en: Before we close this chapter, I wanted to share a quick tip that I saw on LinkedIn
    some weeks ago. The post describing the following exercise came from Klaus Schulte,
    a German professor and 2018 *Iron Viz* Champion.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们结束这一章之前，我想分享一个几周前在LinkedIn上看到的小技巧。描述以下练习的帖子来自于德国教授和2018年*Iron Viz*冠军Klaus
    Schulte。
- en: He shared that he had built a grid map by using custom geocoding. Let’s try
    to replicate it!
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 他分享了他通过使用自定义地理编码构建了一个网格地图。让我们尝试复制它！
- en: 'Download hex map data somewhere or create it yourself. For this exercise, you
    can use the hex map data from my Tableau Public or GitHub: [https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter09/hexmap.xlsx](https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter09/hexmap.xlsx).
    If you want to create it yourself, please review the polygon exercise in *Chapter
    8*, *Going Beyond the Basics*. You can create the file the same way we created
    the book polygons:'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 从某个地方下载六边形地图数据，或者自己创建。对于本练习，你可以使用我在Tableau Public或GitHub上的六边形地图数据：[https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter09/hexmap.xlsx](https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/blob/main/Chapter09/hexmap.xlsx)。如果你想自己创建，请查看*第8章*中的多边形练习，*超越基础知识*。你可以像我们创建书本多边形一样创建该文件：
- en: Place the `hexmap` file in the `Mapsources` folder of your Tableau repository.
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`hexmap`文件放置在你的Tableau仓库的`Mapsources`文件夹中。
- en: Connect Tableau Desktop to the default `Superstore` data.
  id: totrans-322
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Tableau桌面版连接到默认的`Superstore`数据。
- en: 'Double-click on **State/Province**:'
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击**州/省**：
- en: '![](img/B18435_09_58.png)'
  id: totrans-324
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_58.png)'
- en: 'Figure 9.58: Normal map'
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.58：正常地图
- en: Click on **State/Province** in the **Data** pane and select **Geographic Role**
    | **Hexmap.xlsx**.
  id: totrans-326
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据**窗格中点击**州/省**并选择**地理角色** | **Hexmap.xlsx**。
- en: Click on **Map** | **Background Layers** and set the **Washout (%)** to `100%`.
  id: totrans-327
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**地图** | **背景图层**并将**洗涤（%）**设置为`100%`。
- en: 'The result will look like this:'
  id: totrans-328
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 结果将如下所示：
- en: '![](img/B18435_09_59.png)'
  id: totrans-329
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_59.png)'
- en: 'Figure 9.59: XX(will be *Figure 9.59*)'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.59：XX（将变为*图 9.59*）
- en: 'So why this effort? Because a grid map distributes the states evenly, if you
    did this without it, you wouldn’t be able to distinguish between states in close
    proximity and would miss some far away:'
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 那么为什么要进行这些努力呢？因为网格地图均匀分布各州，如果没有它，你就无法区分相邻的州，并且会错过一些远距离的州：
- en: '![](img/B18435_09_60.png)'
  id: totrans-332
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_09_60.png)'
- en: 'Figure 9.60: If no grid map'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.60：如果没有网格地图
- en: Thank you Klaus for this great tip! By the way, a hex map is not only applicable
    to the U.S.. Try it with Europe, Africa, South America, or the **Asia-Pacific**
    (**APAC**) region as well! Whenever you work with variances in size, a grid map
    comes in handy.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 感谢Klaus提供这个很棒的建议！顺便提一下，六边形地图不仅适用于美国，还可以试试欧洲、非洲、南美洲，或者**亚太地区**（**APAC**）！每当你处理不同尺寸的变化时，网格地图非常有用。
- en: Summary
  id: totrans-335
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we explored how to extend Tableau’s mapping capabilities without
    leaving the interface by capturing Tableau-generated latitude and longitude data
    and how to look this up on Google. We created polygons and a heatmap for Texas
    based on a `.shp` file as well as a dashboard with a dual map axis and another
    dashboard with 4 map layers. Next, we explored various ways to extend Tableau’s
    mapping using other technology. We connected to a WMS server and then explored
    the Mapbox offering, followed by an excursion to the world of polygons.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了如何在不离开界面的情况下扩展Tableau的映射功能，包括捕捉Tableau生成的纬度和经度数据，并了解如何在Google上查找这些数据。我们基于`.shp`文件为德克萨斯州创建了多边形和热力图，以及一个包含双地图轴的仪表板和另一个具有4个地图层的仪表板。接下来，我们探索了使用其他技术扩展Tableau映射的不同方法。我们连接到了一个WMS服务器，然后探索了Mapbox的功能，最后进入了多边形的世界。
- en: In the next chapter, we will explore using Tableau for presentations. Specifically,
    we will look at how to get the best images out of Tableau, how to effectively
    and efficiently use Tableau with PowerPoint, and how to use Tableau directly for
    presentations without relying on third-party tools.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探讨如何使用Tableau进行演示。具体来说，我们将了解如何从Tableau中提取最佳图片，如何有效高效地将Tableau与PowerPoint结合使用，以及如何直接使用Tableau进行演示，而不依赖第三方工具。
- en: Learn more on Discord
  id: totrans-338
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Discord上了解更多
- en: 'To join the Discord community for this book – where you can share feedback,
    ask questions to the author, and learn about new releases – follow the QR code
    below:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 要加入本书的Discord社区——在这里你可以分享反馈、向作者提问并了解新版本的发布——请扫描下面的二维码：
- en: '[https://packt.link/tableau](https://packt.link/tableau)'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/tableau](https://packt.link/tableau)'
- en: '![](img/QR_Code2044012316175764640.png)'
  id: totrans-341
  prefs: []
  type: TYPE_IMG
  zh: '![](img/QR_Code2044012316175764640.png)'
