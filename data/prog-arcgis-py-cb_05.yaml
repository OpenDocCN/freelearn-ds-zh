- en: Chapter 5. Executing Geoprocessing Tools from Scripts
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 5 章。从脚本中执行地理处理工具
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下菜谱：
- en: Finding geoprocessing tools
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查找地理处理工具
- en: Retrieving a toolbox alias
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获取工具箱别名
- en: Executing geoprocessing tools from a script
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从脚本中执行地理处理工具
- en: Using the output of a tool as an input to another tool
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将工具的输出用作另一个工具的输入
- en: Introduction
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: ArcGIS for Desktop contains over 800 geoprocessing tools, which can be used
    in your Python scripts. Using geoprocessing tools from your Pythons scripts enables
    you to execute complex workflows and perform batch geoprocessing tasks. In this
    chapter, you will learn how to use these tools in your scripts. Each tool has
    unique characteristics. The syntax to execute each will differ depending upon
    the type of input required to successfully execute the tool. We'll examine how
    you can determine the input parameters for any tool by using the ArcGIS for Desktop
    help system. The execution of a tool results in the creation of one or more output
    datasets along with a set of messages that are generated while the tool is running.
    We'll examine how you can use these messages.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: ArcGIS for Desktop 包含超过 800 个地理处理工具，这些工具可以在您的 Python 脚本中使用。在您的 Python 脚本中使用地理处理工具可以使您执行复杂的流程并执行批量地理处理任务。在本章中，您将学习如何在脚本中使用这些工具。每个工具都有其独特的特性。执行每个工具的语法将根据所需输入类型的不同而有所不同。我们将探讨如何使用
    ArcGIS for Desktop 帮助系统确定任何工具的输入参数。工具的执行将导致创建一个或多个输出数据集，以及工具运行期间生成的消息集。我们将探讨如何使用这些消息。
- en: Finding geoprocessing tools
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查找地理处理工具
- en: Before using a tool in your geoprocessing script, you will need to make sure
    that you have access to this tool, based on the current license level of ArcGIS
    for Desktop that you are running or that your end users will run. In addition
    to this, any extensions you have licensed and enabled must be taken into consideration
    as well. This information is contained within the ArcGIS for Desktop help system.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的地理处理脚本中使用工具之前，您需要确保您可以根据当前运行的 ArcGIS for Desktop 许可证级别访问此工具，或者您的最终用户将运行。此外，您已许可并启用的任何扩展也必须考虑在内。这些信息包含在
    ArcGIS for Desktop 帮助系统中。
- en: Getting ready
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The availability of geoprocessing tools for your script is dependent on the
    level of the ArcGIS license you are using. In version 10.3 of ArcGIS for Desktop,
    there are three license levels, namely basic, standard, and advanced. These were
    formerly known as **ArcView**, **ArcEditor**, and **ArcInfo**, respectively. It
    is important for you to understand the license level required for the tool that
    you want to use in your script. In addition to this, the use of extensions in
    ArcGIS for Desktop can result in the availability of additional tools for your
    script. There are two primary ways to find tools in ArcGIS for Desktop. The first
    is to use the search window and the second is to simply browse the contents of
    **ArcToolbox**. In this recipe, you will learn how to use the search window to
    find available geoprocessing tools that can be used in your scripts.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 您的脚本中地理处理工具的可用性取决于您使用的 ArcGIS 许可证级别。在 ArcGIS for Desktop 的 10.3 版本中，有三个许可证级别，即基本、标准和高级。这些以前分别被称为
    **ArcView**、**ArcEditor** 和 **ArcInfo**。了解您在脚本中想要使用的工具所需的许可证级别非常重要。此外，在 ArcGIS
    for Desktop 中使用扩展可能会导致您的脚本可用更多工具。在 ArcGIS for Desktop 中查找工具有两种主要方法。第一种是使用搜索窗口，第二种是简单地浏览
    **ArcToolbox** 的内容。在本菜谱中，您将学习如何使用搜索窗口查找可用于您脚本的可用地理处理工具。
- en: How to do it…
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做…
- en: Open `C:\ArcpyBook\Ch5\Crime_Ch5.mxd` in ArcMap.
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 ArcMap 中打开 `C:\ArcpyBook\Ch5\Crime_Ch5.mxd`。
- en: From the **Geoprocessing** menu item, select **Search For Tools**. This will
    display the **Search** window, as shown in the following screenshot. By default,
    you will be searching for **Tools**:![How to do it…](img/B04314_05_1.jpg)
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 **地理处理** 菜单项中选择 **搜索工具**。这将显示 **搜索** 窗口，如图下所示。默认情况下，您将搜索 **工具**：![如何做…](img/B04314_05_1.jpg)
- en: 'Type the `Clip` term into the search textbox. As you begin typing this word,
    the search textbox will automatically filter the results based on the first few
    letters you type. You''ll notice that for `Clip`, there are three possible tools:
    `clip(analysis), clip(coverage)`, and `clip(data_management)`. There are a number
    of cases where there are several geoprocessing tools with the same name. To uniquely
    define a tool, the toolbox alias is attached to the tool name. We''ll examine
    toolbox aliases in greater detail in the next recipe.'
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在搜索框中输入`Clip`术语。当您开始输入这个单词时，搜索框将自动根据您输入的前几个字母过滤结果。您会注意到对于`Clip`，有三种可能的工具：`clip(analysis)`、`clip(coverage)`和`clip(data_management)`。存在许多情况，其中有几个地理处理工具具有相同的名称。为了唯一地定义一个工具，工具箱别名附加到工具名称上。我们将在下一个菜谱中更详细地检查工具箱别名。
- en: For now, click on the search button to generate a list of matching tools. The
    search should generate a list similar to what you see in the following screenshot.
    Tools are indicated by a hammer icon in the search results. You'll also see a
    couple of other icons in the search results. The scroll icon indicates a Python
    script, and an icon containing multicolored squares indicates a model:![How to
    do it…](img/B04314_05_2.jpg)
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，点击搜索按钮以生成匹配工具的列表。搜索应生成类似于以下截图的列表。工具在搜索结果中以锤子图标表示。您还会在搜索结果中看到几个其他图标。滚动图标表示Python脚本，而包含多色方块的图标表示模型：![如何操作…](img/B04314_05_2.jpg)
- en: Select the **Clip (Analysis)** tool. This will open the dialog box for **the
    Clip (Analysis)** tool. This isn't all that useful to you as a script programmer.
    You will probably be more interested in the help provided by ArcGIS for Desktop
    for a particular tool.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**Clip (Analysis)**工具。这将打开**Clip (Analysis)**工具的对话框。这对您作为脚本程序员来说并不那么有用。您可能对ArcGIS
    for Desktop提供的特定工具的帮助更感兴趣。
- en: Click on the **Tool Help** button at the bottom of the tool dialog box to display
    detailed information about this particular tool:![How to do it…](img/B04314_05_3.jpg)
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击工具对话框底部的**工具帮助**按钮以显示有关此特定工具的详细信息：![如何操作…](img/B04314_05_3.jpg)
- en: Scroll down to the bottom of the help page for the **Clip** tool to examine
    the syntax for this particular tool.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动到帮助页面底部以检查**Clip**工具的语法。
- en: How it works…
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: The help system contains a summary, illustration, usage, syntax, code samples,
    available environment variables, related topics, and licensing information for
    each tool. As a geoprocessing script programmer, you will primarily be interested
    in the syntax, code samples, and licensing information sections near the bottom.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 帮助系统包含每个工具的摘要、插图、用法、语法、代码示例、可用环境变量、相关主题和许可信息。作为地理处理脚本程序员，您主要会对语法、代码示例和底部附近的许可信息部分感兴趣。
- en: Tip
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: You should always examine the licensing information section at the bottom of
    the help documentation for each tool, to make sure you have the appropriate license
    level to use the tool.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该始终检查每个工具的帮助文档底部的许可信息部分，以确保您拥有使用该工具的适当许可级别。
- en: 'The syntax section contains information about how this tool should be called
    from your Python script, including the name of the tool and the required and optional
    input parameters. All the parameters will be enclosed within parentheses. The
    required parameters for the `Clip` tool are `in_features`, `clip_features`, and
    `out_feature_class`. When you call this tool from your script, you will be required
    to provide these parameters to the tool for it to execute correctly. The fourth
    parameter is an optional parameter called `cluster_tolerance`. Parameters marked
    as optional in the syntax are surrounded by curly braces. The following screenshot
    provides an example of an optional parameter surrounded by curly braces. This
    doesn''t mean that you enclose the parameter in curly braces when you call the
    tool. It is in the help section simply to indicate that this parameter is optional
    when being called from your geoprocessing script:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 语法部分包含有关如何从您的Python脚本中调用此工具的信息，包括工具的名称和必需的以及可选的输入参数。所有参数都将包含在括号内。`Clip`工具的必需参数是`in_features`、`clip_features`和`out_feature_class`。当您从脚本调用此工具时，您必须提供这些参数以使工具正确执行。第四个参数是一个可选参数，称为`cluster_tolerance`。在语法中标记为可选的参数被大括号包围。以下截图提供了一个大括号包围的可选参数的示例。这并不意味着您在调用工具时将参数包围在大括号内。它仅用于帮助部分，以表明当从地理处理脚本调用时此参数是可选的：
- en: '![How it works…](img/B04314_05_4.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![它是如何工作的…](img/B04314_05_4.jpg)'
- en: Retrieving a toolbox alias
  id: totrans-26
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取工具箱别名
- en: All toolboxes have an alias which, when combined with the tool name, provides
    a unique reference to any tool in ArcGIS for Desktop. This alias is necessary
    because a number of tools have the same name. When referencing a tool from your
    Python script, it is necessary to reference both the tool name and alias.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 所有工具箱都有一个别名，当与工具名称结合时，为 ArcGIS for Desktop 中的任何工具提供唯一的引用。这个别名是必要的，因为许多工具具有相同的名称。当从你的
    Python 脚本引用工具时，需要引用工具名称和别名。
- en: Getting ready
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: In the last recipe, we looked at the **Clip** tool. There are actually three
    **Clip** tools, which can be found in the **Analysis Tools**, **Coverage Tools**,
    and **Data Management Tools** toolboxes. Each **Clip** tool performs a different
    function. For instance, the **Clip** tool in the **Analysis Tools** toolbox clips
    a vector feature class using an input feature, while the **Clip** tool in the
    **Data Management Tools** toolbox is used to create a spatial subset of a raster.
    Since it is possible to have multiple tools with the same name, we can uniquely
    identify a particular tool by providing both the tool name and the toolbox alias
    in which the tool resides. In this recipe, you will learn how to find the alias
    of a toolbox.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一个示例中，我们探讨了**裁剪**工具。实际上有三个**裁剪**工具，它们分别位于**分析工具**、**覆盖工具**和**数据管理工具**工具箱中。每个**裁剪**工具执行不同的功能。例如，**分析工具**工具箱中的**裁剪**工具使用输入要素裁剪矢量要素类，而**数据管理工具**工具箱中的**裁剪**工具用于创建栅格的空间子集。由于可能存在多个具有相同名称的工具，我们可以通过提供工具名称和工具所在的工具箱别名来唯一地识别特定的工具。在这个示例中，你将学习如何找到工具箱的别名。
- en: How to do it…
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: Open `C:\ArcpyBook\Ch5\Crime_Ch5.mxd` in ArcMap.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 ArcMap 中打开 `C:\ArcpyBook\Ch5\Crime_Ch5.mxd`。
- en: If necessary, open **ArcToolbox**.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要，打开**ArcToolbox**。
- en: Find the **Analysis Tools** toolbox, as shown in the following screenshot:![How
    to do it…](img/B04314_05_5.jpg)
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找如图所示的**分析工具**工具箱：![如何操作…](img/B04314_05_5.jpg)
- en: Right-click on the **Analysis Tools** toolbox and select **Properties**. This
    will display the **Analysis Tools Properties** dialog box, as shown in the following
    screenshot. The **Alias:** textbox will contain the alias:![How to do it…](img/B04314_05_6.jpg)
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击**分析工具**工具箱并选择**属性**。这将显示如图所示的**分析工具属性**对话框。**别名**文本框将包含别名：![如何操作…](img/B04314_05_6.jpg)
- en: How it works…
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: You can follow this process to find the alias name of any toolbox. In a Python
    script, you can execute a tool by referring to the tool with the `<toolname>_<toolbox
    alias>` syntax. For example, if you were calling the **Buffer** tool, it would
    be `Buffer_analysis`. Toolbox aliases are invariably simple. They are typically
    one word and do not include dashes or special characters. In the next recipe,
    we'll create a simple script that follows this format to execute a tool.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以按照以下过程找到任何工具箱的别名名称。在 Python 脚本中，你可以通过使用 `<toolname>_<toolbox alias>` 语法来执行工具。例如，如果你正在调用**缓冲区**工具，它将是
    `Buffer_analysis`。工具箱别名通常是简单的。它们通常是单个单词，不包含破折号或特殊字符。在下一个示例中，我们将创建一个简单的脚本，按照这个格式执行工具。
- en: Executing geoprocessing tools from a script
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从脚本中执行地理处理工具
- en: Once you have determined the toolbox alias and then verified the accessibility
    of the tool based on your current license level, you are ready to add the execution
    of the tool to a script.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你确定了工具箱别名并验证了基于你当前许可级别的工具可访问性，你就可以将工具的执行添加到脚本中。
- en: Getting ready
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Now that you understand how to find the tools that are available and how to
    uniquely reference them, the next step is to put this together and execute a tool
    from a geoprocessing script. In this recipe, you can then execute the tool from
    your script.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经了解了如何找到可用的工具以及如何唯一引用它们，下一步就是将这些工具组合起来，并在地理处理脚本中执行一个工具。在这个示例中，你可以从你的脚本中执行这个工具。
- en: How to do it…
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作…
- en: Open `C:\ArcpyBook\Ch5\Crime_Ch5.mxd` in ArcMap.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 ArcMap 中打开 `C:\ArcpyBook\Ch5\Crime_Ch5.mxd`。
- en: Click on the **Add Data** button and add the `EdgewoodSD.shp` file to the table
    of contents from the `c:\ArcpyBook\Ch5` folder.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加数据**按钮，将 `EdgewoodSD.shp` 文件从 `c:\ArcpyBook\Ch5` 文件夹添加到内容表中。
- en: If needed, turn off the **Crime Density by School District** and **Burglaries
    in 2009** layers to get a better view of the **EdgewoodSD** layer. There is only
    one polygon feature in this file. It represents the **Edgewood School District**.
    Now, we're going to write a script that clips the **Burglaries in 2009** features
    to this school district.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果需要，关闭**按学区划分的犯罪密度**和**2009年盗窃案**图层，以更好地查看**EdgewoodSD**图层。此文件中只有一个多边形要素。它代表**Edgewood学区**。现在，我们将编写一个脚本，将**2009年盗窃案**要素剪辑到这个学区。
- en: Open the Python window in ArcMap.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在ArcMap中打开Python窗口。
- en: 'Import the `arcpy` module:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入`arcpy`模块：
- en: '[PRE0]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Create a variable that references the input feature class to be clipped:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个变量，引用要剪辑的输入要素类：
- en: '[PRE1]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Create a variable that references the layer to be used for the clip:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个变量，引用用于剪辑的图层：
- en: '[PRE2]'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Create a variable that references the output feature class:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个变量，引用输出要素类：
- en: '[PRE3]'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Execute the **Clip** tool from the **Analysis Tools** toolbox:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**分析工具箱**中执行**Clip**工具：
- en: '[PRE4]'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: You can check your work by examining the `c:\ArcpyBook\code\Ch5\ExecuteGeoprocessingTools.py`
    solution file.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以通过检查`c:\ArcpyBook\code\Ch5\ExecuteGeoprocessingTools.py`解决方案文件来检查你的工作。
- en: Run the script. The output feature class containing only those burglary points
    within the **EdgewoodSD** school district should be added to the data frame, as
    shown in the following screenshot:![How to do it…](img/B04314_05_7.jpg)
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行脚本。包含仅限于**EdgewoodSD**学区内的盗窃点的输出要素类应添加到数据框中，如下截图所示：![如何做…](img/B04314_05_7.jpg)
- en: How it works…
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何工作…
- en: The primary line of code of interest in this recipe is the final line that executes
    the **Clip** tool. Notice that we called this tool by specifying a syntax of `Clip_analysis`,
    which gives us a reference to the **Clip** tool in the **Analysis Tools** toolbox,
    which has an alias of `analysis`. We've also passed three parameters that reference
    the input feature class, clip feature class, and output feature class. I should
    point out that we hardcoded the paths to each of the datasets. This is not a good
    programming practice, but in this particular instance, I just wanted to illustrate
    how to execute a tool. A future chapter will show how you can remove the hardcoding
    in your scripts and make them much more versatile.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个菜谱中，我们关注的代码主要行是执行**Clip**工具的最后一行。注意，我们通过指定`Clip_analysis`语法来调用此工具，这给了我们**Clip**工具在**分析工具箱**中的引用，该工具别名为`analysis`。我们还传递了三个参数，分别引用输入要素类、剪辑要素类和输出要素类。我应该指出，我们硬编码了每个数据集的路径。这不是一个好的编程实践，但在这个特定实例中，我只是想说明如何执行一个工具。未来的章节将展示如何从你的脚本中移除硬编码，并使它们更加灵活。
- en: 'Most tools that you use will require paths to data sources. This path must
    be the same as the path reported on the ArcCatalog **Location:** toolbar, as shown
    in the following screenshot:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 你使用的多数工具都需要数据源路径。此路径必须与ArcCatalog **位置**工具栏上报告的路径相同，如下截图所示：
- en: '![How it works…](img/B04314_05_8.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![如何工作…](img/B04314_05_8.jpg)'
- en: Tools use ArcCatalog to find geographic data using an ArcCatalog path. This
    path is a string and is unique to each dataset. The path can include folder locations,
    database connections, or a URL. So, it is important to check the path using ArcCatalog
    before attempting to write Python scripts against the data. ArcSDE paths require
    special consideration. Many ArcSDE users do not have standardized connection names,
    which can cause issues when running models or scripts.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 工具使用ArcCatalog通过ArcCatalog路径查找地理数据。此路径是一个字符串，并且对每个数据集都是唯一的。路径可以包括文件夹位置、数据库连接或URL。因此，在尝试针对数据编写Python脚本之前，使用ArcCatalog检查路径是很重要的。ArcSDE路径需要特别注意。许多ArcSDE用户没有标准化的连接名称，这可能在运行模型或脚本时引起问题。
- en: There's more...
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Geoprocessing tools are organized in two ways. You can access tools as functions
    on `arcpy` or as modules matching the toolbox alias name. In the first case, when
    tools are accessible as functions from `arcpy`, they are called in the format
    that you followed in this recipe. The tool name is followed by an underscore and
    then the toolbox alias. In the second form, tools are called as functions of a
    module, which takes the name of the toolbox alias. Here, `analysis` is the toolbox
    alias, so it becomes a module. `Clip` is a function of this module and is called
    as follows:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 地理处理工具以两种方式组织。您可以通过`arcpy`上的函数或与工具箱别名匹配的模块访问工具。在第一种情况下，当工具可以通过`arcpy`作为函数访问时，它们将以您在本教程中遵循的格式调用。工具名称后跟一个下划线和工具箱别名。在第二种形式中，工具作为模块的函数调用，该模块的名称与工具箱别名相同。在这里，`analysis`是工具箱别名，因此它成为一个模块。`Clip`是这个模块的函数，调用方式如下：
- en: '[PRE5]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Which method you use is really a matter of preference. They both accomplish
    the same thing, which is the execution of a geoprocessing tool.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 您使用哪种方法完全是个人喜好问题。它们都完成了相同的事情，即执行地理处理工具。
- en: Using the output of a tool as an input to another tool
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用工具的输出作为另一个工具的输入
- en: There will be many occasions when you will need to use the output of one tool
    as input to another tool. This is called tool chaining. An example of tool chaining
    could involve buffering a `stream` layer and then finding all residential properties
    that fall within the buffer. In this case, the `Buffer` tool would output a new
    layer, which would then be used as an input to the `Select by Location` tool or
    one of the other overlay tools. In this recipe, you will learn how to obtain the
    output of a tool and use it as input to another tool.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多情况下，您需要将一个工具的输出作为另一个工具的输入。这被称为工具链。工具链的一个例子可能涉及缓冲一个`stream`层，然后找到所有位于缓冲区内的住宅属性。在这种情况下，`Buffer`工具将输出一个新的层，然后该层将被用作`Select
    by Location`工具或其他叠加工具的输入。在本教程中，您将学习如何获取工具的输出并将其用作另一个工具的输入。
- en: Getting ready
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The `Buffer` tool creates an output feature class from an input feature layer
    using a specified distance. This output feature class can be stored in a variable,
    which can then be used as an input to another tool, such as the **Select Layer
    by Location** tool. In this recipe, you will learn how to use the output from
    the `Buffer` tool as an input to the **Select Layer by Location** tool to find
    schools that are within a half mile of a stream.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '`Buffer`工具使用指定的距离从一个输入要素层创建输出要素类。这个输出要素类可以存储在变量中，然后可以将其用作另一个工具的输入，例如**按位置选择层**工具。在本教程中，您将学习如何使用`Buffer`工具的输出作为**按位置选择层**工具的输入，以找到位于溪流半英里范围内的学校。'
- en: How to do it...
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Follow these steps to learn how to access the currently active map document
    in ArcMap:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤学习如何在ArcMap中访问当前活动的地图文档：
- en: Open ArcMap with a new map document file (`.mxd`).
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用新的地图文档文件（`.mxd`）打开ArcMap。
- en: Click on the **Add Data** button and add the streams and schools shapefiles
    from `c:\ArcpyBook\data\TravisCounty`.
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加数据**按钮，并将`c:\ArcpyBook\data\TravisCounty`中的溪流和学校要素文件添加到地图中。
- en: Click on the Python window button.
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击Python窗口按钮。
- en: 'Import the `arcpy` module:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入`arcpy`模块：
- en: '[PRE6]'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Set the workspace:'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置工作空间：
- en: '[PRE7]'
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Start a `try` statement and add variables for the streams, buffered streams
    layer, distance, and schools:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 开始`try`语句并添加用于溪流、缓冲溪流层、距离和学校的变量：
- en: '[PRE8]'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Execute the Buffer tool by passing in the input feature class, output feature
    class, distance, and several optional variables that control the look of the output
    buffer.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过传递输入要素类、输出要素类、距离以及控制输出缓冲区外观的几个可选变量来执行`Buffer`工具。
- en: '[PRE9]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Create a temporary layer for the schools by using the `MakeFeatureLayer` tool:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`MakeFeatureLayer`工具创建学校的临时图层：
- en: '[PRE10]'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Select all schools within a half mile of a stream by using the `SelectLayerByLocation`
    tool:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`SelectLayerByLocation`工具选择位于溪流半英里范围内的所有学校：
- en: '[PRE11]'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Add the `except` block to catch any errors:'
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加`except`块以捕获任何错误：
- en: '[PRE12]'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The entire script should appear as follows:![How to do it...](img/B04314_05_10.jpg)
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 整个脚本应如下所示：![如何操作...](img/B04314_05_10.jpg)
- en: You can check your work by examining the `c:\ArcpyBook\code\Ch5\ToolOutputUsedAsInput.py`
    solution file.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以通过检查`c:\ArcpyBook\code\Ch5\ToolOutputUsedAsInput.py`解决方案文件来检查您的作业。
- en: Run the script to view the results shown in the following screenshot:![How to
    do it...](img/B04314_05_11.jpg)
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行脚本以查看以下截图所示的结果：![如何操作...](img/B04314_05_11.jpg)
- en: How it works...
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: The `Buffer` tool creates an output feature class, which we call `StreamsBuffer.shp`
    and is stored in a variable called `streamsBuffer`. The `streamsBuffer` variable
    is then used as an input to the `SelectLayerByLocation` tool as the third parameter
    being passed to the function. The creation of the `Schools2Mile_lyr` layer file
    accomplishes this output as an input parameter as well. Using the output of one
    tool simply requires that you create a variable to hold the output data and then
    it can be reused as needed in other tools.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '`Buffer` 工具创建一个输出要素类，我们称之为 `StreamsBuffer.shp`，并存储在一个名为 `streamsBuffer` 的变量中。然后，`streamsBuffer`
    变量被用作 `SelectLayerByLocation` 工具的输入，作为传递给函数的第三个参数。创建 `Schools2Mile_lyr` 层文件也实现了将此输出作为输入参数的功能。使用一个工具的输出只需创建一个变量来存储输出数据，然后它可以在其他工具中按需重复使用。'
