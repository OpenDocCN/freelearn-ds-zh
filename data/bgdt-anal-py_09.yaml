- en: '*Appendix*'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*附录*'
- en: About
  id: totrans-1
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于
- en: This section is included to assist the students in performing the activities
    in the book. It includes detailed steps that are to be performed by the students
    to achieve the objectives of the activities.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本节内容旨在帮助学生完成书中的活动。它包括学生必须执行的详细步骤，以实现活动目标。
- en: 'Chapter 01: The Python Data Science Stack'
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第01章：Python数据科学工具栈
- en: 'Activity 1: IPython and Jupyter'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 1：IPython和Jupyter
- en: Open the `python_script_student.py` file in a text editor, copy the contents
    to a notebook in IPython, and execute the operations.
  id: totrans-5
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文本编辑器中打开`python_script_student.py`文件，将内容复制到IPython中的笔记本，并执行操作。
- en: 'Copy and paste the code from the Python script into a Jupyter notebook:'
  id: totrans-6
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Python脚本中的代码复制并粘贴到Jupyter笔记本中：
- en: '[PRE0]'
  id: totrans-7
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now, update the values of the `x` and `c` variables. Then, change the definition
    of the function:'
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，更新`x`和`c`变量的值。然后，修改函数的定义：
- en: '[PRE1]'
  id: totrans-9
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The output is as follows:'
  id: totrans-10
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE2]'
  id: totrans-11
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Activity 2: Working with Data Problems'
  id: totrans-12
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 2：处理数据问题
- en: 'Import pandas and NumPy library:'
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入pandas和NumPy库：
- en: '[PRE3]'
  id: totrans-14
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Read the RadNet dataset from the U.S. Environmental Protection Agency, available
    from the Socrata project:'
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从美国环境保护局获取RadNet数据集，数据可通过Socrata项目下载：
- en: '[PRE4]'
  id: totrans-16
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Create a list with numeric columns for radionuclides in the RadNet dataset:'
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个包含RadNet数据集中放射性同位素的数值列的列表：
- en: '[PRE5]'
  id: totrans-18
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Use the `apply` method on one column, with a `lambda` function that compares
    the `Non-detect` string:'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对一列使用`apply`方法，并使用一个`lambda`函数比较`Non-detect`字符串：
- en: '[PRE6]'
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The output is as follows:'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.19: DataFrame after applying the lambda function](img/C12913_01_19.jpg)'
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 1.19：应用lambda函数后的DataFrame](img/C12913_01_19.jpg)'
- en: 'Figure 1.19: DataFrame after applying the lambda function'
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1.19：应用lambda函数后的DataFrame
- en: 'Replace the text values with `NaN` in one column with `np.nan`:'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一列中的文本值替换为`NaN`，使用`np.nan`：
- en: '[PRE7]'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Use the same lambda comparison and use the `applymap` method on several columns
    at the same time, using the list created in the first step:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用相同的lambda比较，并对多个列同时使用`applymap`方法，使用在第一步中创建的列表：
- en: '[PRE8]'
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Create a list of the remaining columns that are not numeric:'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个包含所有非数值列的列表：
- en: '[PRE9]'
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The output is as follows:'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.20: List of columns and their type](img/C12913_01_20.jpg)'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 1.20：列及其类型列表](img/C12913_01_20.jpg)'
- en: 'Figure 1.20: List of columns and their type'
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1.20：列及其类型列表
- en: 'Convert the DataFrame objects into floats using the `to_numeric` function:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`to_numeric`函数将DataFrame对象转换为浮动数值：
- en: '[PRE10]'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The output is as follows:'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.21: List of columns and their type](img/C12913_01_21.jpg)'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 1.21：列及其类型列表](img/C12913_01_21.jpg)'
- en: 'Figure 1.21: List of columns and their type'
  id: totrans-37
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1.21：列及其类型列表
- en: 'Using the selection and filtering methods, verify that the names of the string
    columns don''t have any spaces:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用选择和过滤方法，确保字符串列的名称没有任何空格：
- en: '[PRE11]'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The output is as follows:'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.22: DataFrame after applying the selection and filtering method](img/C12913_01_22.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.22：应用选择和过滤方法后的DataFrame](img/C12913_01_22.jpg)'
- en: 'Figure 1.22: DataFrame after applying the selection and filtering method'
  id: totrans-42
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1.22：应用选择和过滤方法后的DataFrame
- en: 'Activity 3: Plotting Data with Pandas'
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 3：使用Pandas绘制数据
- en: Use the RadNet DataFrame that we have been working with.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用我们正在处理的RadNet DataFrame。
- en: Fix all the data type problems, as we saw before.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修复所有数据类型问题，正如我们之前看到的那样。
- en: 'Create a plot with a filter per `Location`, selecting the city of `San Bernardino`,
    and one radionuclide, with the *x*-axis set to the `date` and the *y*-axis with
    radionuclide `I-131`:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个图表，对`Location`进行筛选，选择`San Bernardino`市，并且选择一个放射性同位素，*x*轴设置为`date`，*y*轴为放射性同位素`I-131`：
- en: '[PRE12]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The output is as follows:'
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_01_23.jpg)'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_01_23.jpg)'
- en: 'Figure 1.23: Plot of Date collected vs I-131'
  id: totrans-50
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1.23：收集日期与I-131的关系图
- en: 'Create a scatter plot with the concentration of two related radionuclides,
    `I-131` and `I-132`:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个散点图，显示两个相关放射性同位素`I-131`和`I-132`的浓度：
- en: '[PRE13]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The output is as follows:'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 1.24: Plot of concentration of I-131 and I-132](img/C12913_01_24.jpg)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.24：I-131和I-132浓度图](img/C12913_01_24.jpg)'
- en: 'Figure 1.24: Plot of concentration of I-131 and I-132'
  id: totrans-55
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1.24：I-131和I-132浓度图
- en: 'Chapter 02: Statistical Visualizations Using Matplotlib and Seaborn'
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第02章：使用Matplotlib和Seaborn进行统计可视化
- en: 'Activity 4: Line Graphs with the Object-Oriented API and Pandas DataFrames'
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 4：使用面向对象API和Pandas DataFrame绘制线形图
- en: 'Import the required libraries in the Jupyter notebook and read the dataset
    from the Auto-MPG dataset repository:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Jupyter notebook 中导入所需的库，并从 Auto-MPG 数据集仓库读取数据集：
- en: '[PRE14]'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Provide the column names to simplify the dataset, as illustrated here:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供列名以简化数据集，如下所示：
- en: '[PRE15]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Now read the new dataset with column names and display it:'
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在读取包含列名的新数据集并显示：
- en: '[PRE16]'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The plot is as follows:'
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图形如下：
- en: '![Figure 2.29: The auto-mpg DataFrame](img/C12913_02_13.jpg)'
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 2.29：auto-mpg 数据框](img/C12913_02_13.jpg)'
- en: 'Figure 2.29: The auto-mpg DataFrame'
  id: totrans-66
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.29：auto-mpg 数据框
- en: 'Convert the `horsepower` and `year` data types to float and integer using the
    following command:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将 `horsepower` 和 `year` 数据类型转换为浮动和整数：
- en: '[PRE17]'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Let''s display the data types:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们显示数据类型：
- en: '[PRE18]'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The output is as follows:'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 2.30: The data types](img/C12913_02_30.jpg)'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 2.30：数据类型](img/C12913_02_30.jpg)'
- en: 'Figure 2.30: The data types'
  id: totrans-73
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.30：数据类型
- en: 'Now plot the average `horsepower` per `year` using the following command:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在使用以下命令绘制每年平均的 `horsepower`：
- en: '[PRE19]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The output is as follows:'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![](img/C12913_02_31.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/C12913_02_31.jpg)'
- en: 'Figure 2.31: Line plot'
  id: totrans-78
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.31：折线图
- en: 'Activity 5: Understanding Relationships of Variables Using Scatter Plots'
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 5：使用散点图理解变量之间的关系
- en: 'Import the required libraries into the Jupyter notebook and read the dataset
    from the Auto-MPG dataset repository:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Jupyter notebook 中导入所需的库，并从 Auto-MPG 数据集仓库读取数据集：
- en: '[PRE20]'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Provide the column names to simplify the dataset as illustrated here:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供列名以简化数据集，如下所示：
- en: '[PRE21]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Now read the new dataset with column names and display it:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在读取包含列名的新数据集并显示：
- en: '[PRE22]'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'The plot is as follows:'
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图形如下：
- en: '![Figure 2.32: Auto-mpg DataFrame](img/C12913_02_13.jpg)'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 2.32：Auto-mpg 数据框](img/C12913_02_13.jpg)'
- en: 'Figure 2.32: Auto-mpg DataFrame'
  id: totrans-88
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.32：Auto-mpg 数据框
- en: 'Now plot the scatter plot using the `scatter` method:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在使用 `scatter` 方法绘制散点图：
- en: '[PRE23]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'The output will be as follows:'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 2.33: Scatter plot using the scatter method](img/Image54488.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![图 2.33：使用 scatter 方法的散点图](img/Image54488.jpg)'
- en: 'Figure 2.33: Scatter plot using the scatter method'
  id: totrans-93
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.33：使用 scatter 方法的散点图
- en: 'Activity 6: Exporting a Graph to a File on Disk'
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 6：将图形导出为磁盘文件
- en: 'Import the required libraries in the Jupyter notebook and read the dataset
    from the Auto-MPG dataset repository:'
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Jupyter notebook 中导入所需的库，并从 Auto-MPG 数据集仓库读取数据集：
- en: '[PRE24]'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Provide the column names to simplify the dataset, as illustrated here:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供列名以简化数据集，如下所示：
- en: '[PRE25]'
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Now read the new dataset with column names and display it:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在读取包含列名的新数据集并显示：
- en: '[PRE26]'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Create a bar plot using the following command:'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令创建条形图：
- en: '[PRE27]'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The output is as follows:'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 2.34: Bar plot](img/C12913_02_34.jpg)'
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 2.34：条形图](img/C12913_02_34.jpg)'
- en: 'Figure 2.34: Bar plot'
  id: totrans-105
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.34：条形图
- en: 'Export it to a PNG file using the `savefig` function:'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `savefig` 函数将其导出为 PNG 文件：
- en: '[PRE28]'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Activity 7: Complete Plot Design'
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 7：完整的图表设计
- en: 'Import the required libraries in the Jupyter notebook and read the dataset
    from the Auto-MPG dataset repository:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Jupyter notebook 中导入所需的库，并从 Auto-MPG 数据集仓库读取数据集：
- en: '[PRE29]'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Provide the column names to simplify the dataset, as illustrated here:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供列名以简化数据集，如下所示：
- en: '[PRE30]'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Now read the new dataset with column names and display it:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在读取包含列名的新数据集并显示：
- en: '[PRE31]'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Perform GroupBy on `year` and `cylinders`, and unset the option to use them
    as indexes:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对 `year` 和 `cylinders` 进行分组，并取消将它们用作索引的选项：
- en: '[PRE32]'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Calculate the average miles per gallon over the grouping and set `year` as
    index:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算每加仑英里数的平均值，并按分组设置 `year` 为索引：
- en: '[PRE33]'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Set year as the DataFrame index:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `year` 设置为数据框的索引：
- en: '[PRE34]'
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Create the figure and axes using the object-oriented API:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用面向对象的 API 创建图形和坐标轴：
- en: '[PRE35]'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Group the `df_g` dataset by `cylinders` and plot the miles per gallon variable
    using the axes created with size (`10`,`8`):'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按 `cylinders` 对 `df_g` 数据集进行分组，并使用创建的大小为 (`10`, `8`) 的坐标轴绘制每加仑英里数变量：
- en: '[PRE36]'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'Set the **title**, **x** label, and **y** label on the axes:'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置 **标题**、**x** 轴标签和 **y** 轴标签：
- en: '[PRE37]'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The output is as follows:'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![](img/Image54506.jpg)'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/Image54506.jpg)'
- en: 'Figure 2.35: Line plot for average car power per year (without legends)'
  id: totrans-129
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.35：每年平均汽车功率的折线图（无图例）
- en: 'Include legends, as follows:'
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 包括图例，如下所示：
- en: '[PRE38]'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '![](img/Image54515.jpg)'
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/Image54515.jpg)'
- en: 'Figure 2.36: Line plot for average car power per year (with legends)'
  id: totrans-133
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.36：每年平均汽车功率的折线图（有图例）
- en: 'Save the figure to disk as a PNG file:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将图像保存为 PNG 文件：
- en: '[PRE39]'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Chapter 03: Working with Big Data Frameworks'
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 03 章：与大数据框架协作
- en: 'Activity 8: Parsing Text'
  id: totrans-137
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 8：解析文本
- en: 'Read the text files into the Spark object using the `text` method:'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `text` 方法将文本文件读入 Spark 对象：
- en: '[PRE40]'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: To parse the file that we are reading, we will use lambda functions and Spark
    operations such as `map`, `flatMap`, and `reduceByKey`. `flatmap` applies a function
    to all elements of an RDD, flattens the results, and returns the transformed RDD.
    `reduceByKey` merges the values based on the given key, combining the values.
    With these functions, we can count the number of lines and words in the text.
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为了解析我们正在读取的文件，我们将使用 lambda 函数和 Spark 操作，例如 `map`、`flatMap` 和 `reduceByKey`。`flatmap`
    将一个函数应用到 RDD 的所有元素，扁平化结果并返回转换后的 RDD。`reduceByKey` 会根据给定的键合并值，进行值的合并。借助这些函数，我们可以统计文本中的行数和单词数。
- en: 'Extract the `lines` from the text using the following command:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令从文本中提取 `lines`：
- en: '[PRE41]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'This splits each line in the file as an entry in the list. To check the result,
    you can use the `collect` method, which gathers all data back to the driver process:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将把文件中的每一行拆分成列表中的一个条目。要检查结果，可以使用 `collect` 方法，它会将所有数据收集回驱动程序进程：
- en: '[PRE42]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Now, let''s count the number of lines, using the `count` method:'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们使用 `count` 方法统计行数：
- en: '[PRE43]'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Note
  id: totrans-147
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: Be careful when using the `collect` method! If the DataFrame or RDD being collected
    is larger than the memory of the local driver, Spark will throw an error.
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用 `collect` 方法时要小心！如果被收集的 DataFrame 或 RDD 大于本地驱动程序的内存，Spark 会抛出错误。
- en: 'Now, let''s first split each line into words, breaking it by the space around
    it, and combining all elements, removing words in uppercase:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们首先将每一行按空格分割成单词，并将所有元素合并，去除大写字母的单词：
- en: '[PRE44]'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Let''s also remove the *stop words*. We could use a more consistent stop words
    list from **NLTK**, but for now, we will row our own:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还要移除 *停用词*。我们本可以使用 **NLTK** 提供的更一致的停用词列表，但现在我们将自定义一个：
- en: '[PRE45]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'Use the following command to remove the stop words from our token list:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令从我们的 token 列表中移除停用词：
- en: '[PRE46]'
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: We can now process our token list and count the unique words. The idea is to
    generate a list of tuples, where the first element is the `token` and the second
    element is the `count` of that particular token.
  id: totrans-155
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在我们可以处理我们的 token 列表并统计唯一单词的数量。这个思路是生成一个元组列表，第一个元素是 `token`，第二个元素是该特定 token
    的 `count`。
- en: 'First, let''s `map` our token to a list:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们将我们的 token 映射到一个列表：
- en: '[PRE47]'
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Use the `reduceByKey` operation, which will apply the operation to each of
    the lists:'
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `reduceByKey` 操作，它将对每个列表应用该操作：
- en: '[PRE48]'
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: Remember, collect all data back to the driver node! Always check whether there
    is enough memory by using tools such as `top` and `htop`.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，将所有数据收集回驱动节点！始终使用如 `top` 和 `htop` 等工具检查是否有足够的内存。
- en: 'Chapter 04: Diving Deeper with Spark'
  id: totrans-161
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 04 章：深入探索 Spark
- en: 'Activity 9: Getting Started with Spark DataFrames'
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 9：Spark DataFrame 入门
- en: 'If you are using Google Collab to run the Jupyter notebook, add these lines
    to ensure you have set the environment:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你正在使用 Google Collab 运行 Jupyter notebook，请添加以下几行代码以确保你已经设置好环境：
- en: '[PRE49]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'Install findspark if not installed using the following command:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 如果未安装 findspark，请使用以下命令进行安装：
- en: '[PRE50]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'To create a sample DataFrame by manually specifying the schema, importing findspark
    module to connect Jupyter with Spark:'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过手动指定模式来创建一个示例 DataFrame，并导入 findspark 模块以连接 Jupyter 和 Spark：
- en: '[PRE51]'
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Create the `SparkContext` and `SQLContext` using the following command:'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令创建 `SparkContext` 和 `SQLContext`：
- en: '[PRE52]'
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'The output is as follows:'
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE53]'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'Check the DataFrame using the following command:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令检查 DataFrame：
- en: '[PRE54]'
  id: totrans-174
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'The output is as follows:'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.29: Sample DataFrame](img/C12913_04_29.jpg)'
  id: totrans-176
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.29：示例 DataFrame](img/C12913_04_29.jpg)'
- en: 'Figure 4.29: Sample DataFrame'
  id: totrans-177
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.29：示例 DataFrame
- en: 'Create a sample DataFrame from an existing RDD. First creating RDD as illustrated
    here:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从现有的 RDD 创建一个示例 DataFrame。首先按如下方式创建 RDD：
- en: '[PRE55]'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'The output is as follows:'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE56]'
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'Converting RDD to DataFrame using the following command:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令将 RDD 转换为 DataFrame：
- en: '[PRE57]'
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'The output is as follows:'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.30: RDD to DataFrame](img/Image54539.jpg)'
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.30：从 RDD 转换到 DataFrame](img/Image54539.jpg)'
- en: 'Figure 4.30: RDD to DataFrame'
  id: totrans-186
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.30：从 RDD 转换到 DataFrame
- en: 'Create a sample DataFrame by reading the data from a CSV file:'
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过读取 CSV 文件中的数据来创建一个示例 DataFrame：
- en: '[PRE58]'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'The output is as follows:'
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE59]'
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'Print first seven rows of the DataFrame:'
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印 DataFrame 的前七行：
- en: '[PRE60]'
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'The output is as follows:'
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_31.jpg)'
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_31.jpg)'
- en: 'Figure 4.31: First seven rows of the DataFrame'
  id: totrans-195
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.31：DataFrame 的前七行
- en: 'Print the schema of the DataFrame:'
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印 DataFrame 的模式：
- en: '[PRE61]'
  id: totrans-197
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE61]'
- en: The output is as follows:![](img/C12913_04_32.jpg)
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输出如下：![](img/C12913_04_32.jpg)
- en: 'Figure 4.32: Schema of the DataFrame'
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.32：DataFrame的架构
- en: 'Print the number of columns and rows in DataFrame:'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印DataFrame中的列数和行数：
- en: '[PRE62]'
  id: totrans-201
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'The output is as follows:'
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE63]'
  id: totrans-203
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'Print the summary statistics of DataFrame and any two individual columns:'
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印DataFrame和任意两列的汇总统计：
- en: '[PRE64]'
  id: totrans-205
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'The output is as follows:'
  id: totrans-206
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_33.jpg)'
  id: totrans-207
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_33.jpg)'
- en: 'Figure 4.33: Summary statistics of DataFrame'
  id: totrans-208
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.33：DataFrame的汇总统计
- en: 'Print the summary of any two columns:'
  id: totrans-209
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 打印任意两列的汇总：
- en: '[PRE65]'
  id: totrans-210
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'The output is as follows:'
  id: totrans-211
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_34.jpg)'
  id: totrans-212
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_34.jpg)'
- en: 'Figure 4.34: Summary statistics of mpg and cyl columns'
  id: totrans-213
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.34：mpg和cyl列的汇总统计
- en: 'Write first seen rows of the sample DataFrame in a CSV file:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将样本DataFrame的首几行写入CSV文件：
- en: '[PRE66]'
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'Activity 10: Data Manipulation with Spark DataFrames'
  id: totrans-216
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动10：使用Spark DataFrame进行数据操作
- en: 'Install the packages as illustrated here:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照下面所示安装相关包：
- en: '[PRE67]'
  id: totrans-218
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'Then, import the `findspark` module to connect the Jupyter with Spark use the
    following command:'
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，导入`findspark`模块，使用以下命令将Jupyter与Spark连接：
- en: '[PRE68]'
  id: totrans-220
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'Now, create the `SparkContext` and `SQLContext` as illustrated here:'
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，创建`SparkContext`和`SQLContext`，如下面所示：
- en: '[PRE69]'
  id: totrans-222
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE69]'
- en: 'Create a DataFrame in Spark as illustrated here:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照下面所示在Spark中创建DataFrame：
- en: '[PRE70]'
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'The output is as follows:'
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_35.jpg)'
  id: totrans-226
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_35.jpg)'
- en: 'Figure 4.35: DataFrame in Spark'
  id: totrans-227
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.35：Spark中的DataFrame
- en: 'Rename any five columns of DataFrame using the following command:'
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令重命名DataFrame中的任意五列：
- en: '[PRE71]'
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE71]'
- en: 'The output is as follows:'
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_36.jpg)'
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_36.jpg)'
- en: 'Figure 4.36: Columns of DataFrame'
  id: totrans-232
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.36：DataFrame的列
- en: 'Select any two numeric and one categorical column from the DataFrame:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从DataFrame中选择任意两列数值型数据和一列类别型数据：
- en: '[PRE72]'
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'The output is as follows:'
  id: totrans-235
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_37.jpg)'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_37.jpg)'
- en: 'Figure 4.37: Two numeric and one categorical column from the DataFrame'
  id: totrans-237
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.37：DataFrame中的两列数值型和一列类别型数据
- en: 'Count the number of distinct categories in the categorical variable:'
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 统计类别型变量中不同类别的数量：
- en: '[PRE73]'
  id: totrans-239
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'Create two new columns in DataFrame by summing up and multiplying together
    the two numerical columns:'
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过对两列数值型数据求和和相乘，创建DataFrame中的两个新列：
- en: '[PRE74]'
  id: totrans-241
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'The output is as follows:'
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_38.jpg)'
  id: totrans-243
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_38.jpg)'
- en: 'Figure 4.38: New columns in DataFrame'
  id: totrans-244
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.38：DataFrame中的新列
- en: 'Drop both the original numerical columns:'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除原始数值型的两列：
- en: '[PRE75]'
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE75]'
- en: '![](img/C12913_04_39.jpg)'
  id: totrans-247
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_39.jpg)'
- en: 'Figure 4.39: New columns in DataFrame after dropping'
  id: totrans-248
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.39：删除列后的DataFrame中的新列
- en: 'Sort the data by categorical column:'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按类别列对数据进行排序：
- en: '[PRE76]'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'The output is as follows:'
  id: totrans-251
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_40.jpg)'
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_40.jpg)'
- en: 'Figure 4.40: Sort data by categorical columns'
  id: totrans-253
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.40：按类别列排序的数据
- en: 'Calculate the `mean` of the summation column for each distinct category in
    the `categorical` variable:'
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算`categorical`变量中每个不同类别的求和列的`mean`：
- en: '[PRE77]'
  id: totrans-255
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE77]'
- en: 'The output is as follows:'
  id: totrans-256
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_41.jpg)'
  id: totrans-257
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_41.jpg)'
- en: 'Figure 4.41: Mean of the summation column'
  id: totrans-258
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.41：求和列的均值
- en: 'Filter the rows with values greater than the `mean` of all the `mean` values
    calculated in the previous step:'
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 过滤出所有大于前一步骤中计算出的`mean`的行：
- en: '[PRE78]'
  id: totrans-260
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'The output is as follows:'
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_42.jpg)'
  id: totrans-262
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_42.jpg)'
- en: 'Figure 4.42: Mean of all the mean values calculated of the summation column'
  id: totrans-263
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.42：所有求和列均值的平均值
- en: 'De-duplicate the resultant DataFrame to make sure it has all unique records:'
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对结果DataFrame进行去重，以确保它包含所有唯一记录：
- en: '[PRE79]'
  id: totrans-265
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE79]'
- en: The output is `15`.
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出结果是`15`。
- en: 'Activity 11: Graphs in Spark'
  id: totrans-267
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动11：Spark中的图形
- en: 'Import the required Python libraries in the Jupyter Notebook:'
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Jupyter Notebook中导入所需的Python库：
- en: '[PRE80]'
  id: totrans-269
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'Read and show the data from the CSV file using the following command:'
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令读取并显示CSV文件中的数据：
- en: '[PRE81]'
  id: totrans-271
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'The output is as follows:'
  id: totrans-272
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_43.jpg)'
  id: totrans-273
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_43.jpg)'
- en: 'Figure 4.43: Auto-mpg DataFrame'
  id: totrans-274
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.43：Auto-mpg DataFrame
- en: 'Visualize the discrete frequency distribution of any continuous numeric variable
    from your dataset using a histogram:'
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用直方图可视化数据集中任何连续数值变量的离散频率分布：
- en: '[PRE82]'
  id: totrans-276
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE82]'
- en: 'The output is as follows:'
  id: totrans-277
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.44: Discrete frequency distribution histogram](img/C12913_04_44.jpg)'
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图4.44：离散频率分布直方图](img/C12913_04_44.jpg)'
- en: 'Figure 4.44: Discrete frequency distribution histogram'
  id: totrans-279
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.44：离散频率分布直方图
- en: 'Visualize the percentage share of the categories in the dataset using a pie
    chart:'
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用饼图可视化数据集中各类别的百分比份额：
- en: '[PRE83]'
  id: totrans-281
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE83]'
- en: 'The output is as follows:'
  id: totrans-282
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_04_45.jpg)'
  id: totrans-283
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_04_45.jpg)'
- en: 'Figure 4.45: Percentage share of the categories using pie chart'
  id: totrans-284
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4.45：使用饼图显示类别的百分比份额
- en: 'Plot the distribution of a continuous variable across the categories of a categorical
    variable using a boxplot:'
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用箱线图绘制连续变量在分类变量各类别下的分布：
- en: '[PRE84]'
  id: totrans-286
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'The output is as follows:'
  id: totrans-287
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.46: Distribution of a continuous using boxplot](img/C12913_04_46.jpg)'
  id: totrans-288
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.46: 使用箱线图绘制连续变量的分布](img/C12913_04_46.jpg)'
- en: 'Figure 4.46: Distribution of a continuous using boxplot'
  id: totrans-289
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 4.46: 使用箱线图绘制连续变量的分布'
- en: 'Visualize the values of a continuous numeric variable using a line chart:'
  id: totrans-290
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用折线图可视化连续数值变量的值：
- en: '[PRE85]'
  id: totrans-291
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE85]'
- en: 'The output is as follows:'
  id: totrans-292
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.47: Continuous numeric variable using a line chart](img/Image54696.jpg)'
  id: totrans-293
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.47: 使用折线图绘制连续数值变量](img/Image54696.jpg)'
- en: 'Figure 4.47: Continuous numeric variable using a line chart'
  id: totrans-294
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 4.47: 使用折线图绘制连续数值变量'
- en: 'Plot the values of multiple continuous numeric variables on the same line chart:'
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在同一折线图上绘制多个连续数值变量的值：
- en: '[PRE86]'
  id: totrans-296
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'The output is as follows:'
  id: totrans-297
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 4.48: Multiple continuous numeric variables](img/C12913_04_48.jpg)'
  id: totrans-298
  prefs: []
  type: TYPE_IMG
  zh: '![图 4.48: 多个连续数值变量](img/C12913_04_48.jpg)'
- en: 'Figure 4.48: Multiple continuous numeric variables'
  id: totrans-299
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 4.48: 多个连续数值变量'
- en: 'Chapter 05: Missing Value Handling and Correlation Analysis in Spark'
  id: totrans-300
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '第 05 章: Spark 中的缺失值处理和相关性分析'
- en: 'Activity 12: Missing Value Handling and Correlation Analysis with PySpark DataFrames'
  id: totrans-301
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '活动 12: 缺失值处理和使用 PySpark DataFrame 进行相关性分析'
- en: 'Import the required libraries and modules in the Jupyter notebook, as illustrated
    here:'
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Jupyter notebook 中导入所需的库和模块，如下所示：
- en: '[PRE87]'
  id: totrans-303
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE87]'
- en: 'Set up the `SparkContext` with the help of the following command in the Jupyter
    notebook:'
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Jupyter notebook 中使用以下命令设置 `SparkContext`：
- en: '[PRE88]'
  id: totrans-305
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE88]'
- en: 'Similarly, set up the `SQLContext` in the notebook:'
  id: totrans-306
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 同样，在 notebook 中设置 `SQLContext`：
- en: '[PRE89]'
  id: totrans-307
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'Now, read the CSV data into a Spark object using the following command:'
  id: totrans-308
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用以下命令将 CSV 数据读取到 Spark 对象中：
- en: '[PRE90]'
  id: totrans-309
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'The output is as follows:'
  id: totrans-310
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.14: Iris DataFrame, reading the CSV data into a Spark object](img/C12913_05_14.jpg)'
  id: totrans-311
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 5.14: Iris 数据框，将 CSV 数据读取到 Spark 对象中](img/C12913_05_14.jpg)'
- en: 'Figure 5.14: Iris DataFrame, reading the CSV data into a Spark object'
  id: totrans-312
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 5.14: Iris 数据框，将 CSV 数据读取到 Spark 对象中'
- en: Fill in the missing values in the `Sepallength` column with the column's mean.
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用列的均值填充 `Sepallength` 列中的缺失值。
- en: 'First, calculate the mean of the `Sepallength` column using the following command:'
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，使用以下命令计算 `Sepallength` 列的均值：
- en: '[PRE91]'
  id: totrans-315
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'Now, impute the missing values in the `Sepallength` column with the column''s
    mean, as illustrated here:'
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，用列的均值填补 `Sepallength` 列中的缺失值，如下所示：
- en: '[PRE92]'
  id: totrans-317
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'The output is as follows:'
  id: totrans-318
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.15: Iris DataFrame](img/C12913_05_15.jpg)'
  id: totrans-319
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 5.15: Iris 数据框](img/C12913_05_15.jpg)'
- en: 'Figure 5.15: Iris DataFrame'
  id: totrans-320
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 5.15: Iris 数据框'
- en: 'Compute the correlation matrix for the dataset. Make sure to import the required
    modules, as shown here:'
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算数据集的相关矩阵。确保导入所需的模块，如下所示：
- en: '[PRE93]'
  id: totrans-322
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE93]'
- en: 'Now, fill the missing values in the DataFrame before computing the correlation:'
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在计算相关性之前，先填充 DataFrame 中的缺失值：
- en: '[PRE94]'
  id: totrans-324
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE94]'
- en: 'Next, remove the `String` columns from the PySpark DataFrame, as illustrated
    here:'
  id: totrans-325
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，从 PySpark DataFrame 中删除 `String` 类型的列，如下所示：
- en: '[PRE95]'
  id: totrans-326
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE95]'
- en: 'Now, compute the correlation matrix in Spark:'
  id: totrans-327
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在 Spark 中计算相关矩阵：
- en: '[PRE96]'
  id: totrans-328
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE96]'
- en: 'Next, convert the correlation matrix into a pandas DataFrame using the following
    command:'
  id: totrans-329
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令将相关矩阵转换为 pandas DataFrame：
- en: '[PRE97]'
  id: totrans-330
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE97]'
- en: 'The output is as follows:'
  id: totrans-331
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.16: Convert the correlation matrix into a pandas DataFrame](img/Image54735.jpg)'
  id: totrans-332
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 5.16: 将相关矩阵转换为 pandas DataFrame](img/Image54735.jpg)'
- en: 'Figure 5.16: Convert the correlation matrix into a pandas DataFrame'
  id: totrans-333
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 5.16: 将相关矩阵转换为 pandas DataFrame'
- en: Plot the variable pairs showing strong positive correlation and fit a linear
    line on them.
  id: totrans-334
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制显示强正相关的变量对，并在其上拟合一条线性回归线。
- en: 'First, load the data from the Spark DataFrame into a pandas DataFrame:'
  id: totrans-335
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，将数据从 Spark DataFrame 加载到 pandas DataFrame：
- en: '[PRE98]'
  id: totrans-336
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE98]'
- en: 'The output is as follows:'
  id: totrans-337
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '[PRE99]'
  id: totrans-338
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE99]'
- en: 'Next, load the required modules and plotting data using the following commands:'
  id: totrans-339
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用以下命令加载所需的模块并绘制数据：
- en: '[PRE100]'
  id: totrans-340
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE100]'
- en: 'The output is as follows:'
  id: totrans-341
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.17: Seaborn plot for x = “Sepallength”, y = “Petallength”](img/Image54744.jpg)'
  id: totrans-342
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 5.17: Seaborn 绘图，x = “Sepallength”，y = “Petallength”](img/Image54744.jpg)'
- en: 'Figure 5.17: Seaborn plot for x = "Sepallength", y = "Petallength"'
  id: totrans-343
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 5.17: Seaborn 绘图，x = "Sepallength"，y = "Petallength"'
- en: 'Plot the graph so that `x` equals `Sepallength`, and `y` equals `Petalwidth`:'
  id: totrans-344
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制图形，使得 `x` 等于 `Sepallength`，`y` 等于 `Petalwidth`：
- en: '[PRE101]'
  id: totrans-345
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE101]'
- en: 'The output is as follows:'
  id: totrans-346
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.18: Seaborn plot for x = “Sepallength”, y = “Petalwidth”](img/Image54754.jpg)'
  id: totrans-347
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 5.18: Seaborn图，x = “Sepallength”，y = “Petalwidth”](img/Image54754.jpg)'
- en: 'Figure 5.18: Seaborn plot for x = "Sepallength", y = "Petalwidth"'
  id: totrans-348
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 5.18: Seaborn图，x = "Sepallength"，y = "Petalwidth"'
- en: 'Plot the graph so that `x` equals `Petalwidth` and `y` equals `Petalwidth`:'
  id: totrans-349
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制图表，使得`x`等于`Petalwidth`，`y`等于`Petalwidth`：
- en: '[PRE102]'
  id: totrans-350
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE102]'
- en: 'The output is as follows:'
  id: totrans-351
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 5.19: Seaborn plot for x = “Petallength”, y = “Petalwidth”](img/C12913_05_19.jpg)'
  id: totrans-352
  prefs: []
  type: TYPE_IMG
  zh: '![图 5.19: Seaborn图，x = “Petallength”，y = “Petalwidth”](img/C12913_05_19.jpg)'
- en: 'Figure 5.19: Seaborn plot for x = "Petallength", y = "Petalwidth"'
  id: totrans-353
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 5.19: Seaborn图，x = "Petallength"，y = "Petalwidth"'
- en: 'Chapter 6: Business Process Definition and Exploratory Data Analysis'
  id: totrans-354
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第六章：业务流程定义与探索性数据分析
- en: 'Activity 13: Carry Out Mapping to Gaussian Distribution of Numeric Features
    from the Given Data'
  id: totrans-355
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 13：根据给定数据对数值特征进行高斯分布映射
- en: 'Download the `bank.csv`. Now, use the following commands to read the data from
    it:'
  id: totrans-356
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载`bank.csv`。现在，使用以下命令读取其中的数据：
- en: '[PRE103]'
  id: totrans-357
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE103]'
- en: 'Identify the numeric data from the DataFrame. The data can be categorized according
    to its type, such as categorical, numeric (float, integer), date, and so on. We
    identify numeric data here because we can only carry out normalization on numeric
    data:'
  id: totrans-358
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从数据框中识别数值数据。数据可以根据其类型进行分类，例如类别型、数值型（浮动、整数）、日期等。我们在这里识别数值数据，因为我们只能对数值数据进行归一化：
- en: '[PRE104]'
  id: totrans-359
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE104]'
- en: 'The output is as follows:'
  id: totrans-360
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.12: DataFrame](img/C12913_06_12.jpg)'
  id: totrans-361
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 6.12: 数据框](img/C12913_06_12.jpg)'
- en: 'Figure 6.12: DataFrame'
  id: totrans-362
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 6.12: 数据框'
- en: 'Carry out a normality test and identify the features that have a non-normal
    distribution:'
  id: totrans-363
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进行正态性测试，并识别具有非正态分布的特征：
- en: '[PRE105]'
  id: totrans-364
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE105]'
- en: 'The output is as follows:'
  id: totrans-365
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![](img/C12913_06_13.jpg)'
  id: totrans-366
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_06_13.jpg)'
- en: 'Figure 6.13: Normality test and identify the features'
  id: totrans-367
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 6.13: 正态性测试并识别特征'
- en: Note
  id: totrans-368
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: The normality test conducted here is based on D'Agostino and Pearson's test
    ([https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.normaltest.html](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.normaltest.html)),
    which combines skew and kurtosis to identify how close the distribution of the
    features is to a Gaussian distribution. In this test, if the p-value is less than
    the set alpha value, then the null hypothesis is rejected, and the feature does
    not have a normal distribution. Here, we look into each column using a loop function
    and identify the distribution of each feature.
  id: totrans-369
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此处进行的正态性测试基于D'Agostino和Pearson的测试（[https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.normaltest.html](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.normaltest.html)），该测试结合了偏度和峰度来识别特征的分布与高斯分布的接近程度。在此测试中，如果p值小于设定的alpha值，则拒绝零假设，表明该特征不具有正态分布。我们通过循环函数查看每一列，并识别每个特征的分布。
- en: 'Plot the probability density of the features to visually analyze their distribution:'
  id: totrans-370
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制特征的概率密度图，以便直观地分析其分布：
- en: '[PRE106]'
  id: totrans-371
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE106]'
- en: 'The density plot of the features to check the normality is as follows:'
  id: totrans-372
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 检查正态性的特征密度图如下所示：
- en: '![Figure 6.14: Plot of features](img/C12913_06_14.jpg)'
  id: totrans-373
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 6.14: 特征图](img/C12913_06_14.jpg)'
- en: 'Figure 6.14: Plot of features'
  id: totrans-374
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 6.14: 特征图'
- en: Note
  id: totrans-375
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: Multiple variables' density plots are shown in the previous graph. The distribution
    of the features in the graph can be seen with a high positive kurtosis, which
    is not a normal distribution.
  id: totrans-376
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 多个变量的密度图在前面的图表中展示。图表中各特征的分布具有较高的正峰度，这不是正态分布。
- en: 'Prepare the power transformation model and carry out transformations on the
    identified features to convert them to normal distribution based on the `box-cox`
    or `yeo-johnson` method:'
  id: totrans-377
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 准备幂变换模型，并对已识别的特征进行变换，以便根据`box-cox`或`yeo-johnson`方法将其转换为正态分布：
- en: '[PRE107]'
  id: totrans-378
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE107]'
- en: In the previous commands, we prepare the power transformation model and apply
    it to the data of selected features.
  id: totrans-379
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在之前的命令中，我们准备了幂变换模型，并将其应用于所选特征的数据。
- en: 'Plot the probability density of the features again after the transformations
    to visually analyze the distribution of the features:'
  id: totrans-380
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在变换之后，再次绘制特征的概率密度图，以直观地分析特征的分布：
- en: '[PRE108]'
  id: totrans-381
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE108]'
- en: 'The output is as follows:'
  id: totrans-382
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 6.15: Plot of features](img/C12913_06_15.jpg)'
  id: totrans-383
  prefs: []
  type: TYPE_IMG
  zh: '![图 6.15: 特征图](img/C12913_06_15.jpg)'
- en: 'Figure 6.15: Plot of features'
  id: totrans-384
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: '图 6.15: 特征图'
- en: 'Chapter 07: Reproducibility in Big Data Analysis'
  id: totrans-385
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第七章：大数据分析中的可重复性
- en: 'Activity 14: Test normality of data attributes (columns) and carry out Gaussian
    normalization of non-normally distributed attributes'
  id: totrans-386
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 14：测试数据属性（列）的正态性，并对非正态分布的属性进行高斯归一化
- en: 'Import the required libraries and packages in the Jupyter notebook:'
  id: totrans-387
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Jupyter笔记本中导入所需的库和包：
- en: '[PRE109]'
  id: totrans-388
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE109]'
- en: 'Now, import the libraries required for preprocessing:'
  id: totrans-389
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，导入预处理所需的库：
- en: '[PRE110]'
  id: totrans-390
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE110]'
- en: 'Set the working directory using the following command:'
  id: totrans-391
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令设置工作目录：
- en: '[PRE111]'
  id: totrans-392
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE111]'
- en: 'Now, import the dataset into the Spark object:'
  id: totrans-393
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，将数据集导入到Spark对象中：
- en: '[PRE112]'
  id: totrans-394
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE112]'
- en: 'Identify the target variable in the data:'
  id: totrans-395
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 识别数据中的目标变量：
- en: '[PRE113]'
  id: totrans-396
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE113]'
- en: 'Generate training and testing data using the following command:'
  id: totrans-397
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令生成训练和测试数据：
- en: '[PRE114]'
  id: totrans-398
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE114]'
- en: 'Create the `Y` and `X` data, as illustrated here:'
  id: totrans-399
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建`Y`和`X`数据，如下所示：
- en: '[PRE115]'
  id: totrans-400
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE115]'
- en: 'Drop the `DV` or `y` using the `drop` command:'
  id: totrans-401
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`drop`命令删除`DV`或`y`：
- en: '[PRE116]'
  id: totrans-402
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE116]'
- en: 'The output is as follows:'
  id: totrans-403
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.22: Bank dataset](img/C12913_07_22.jpg)'
  id: totrans-404
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 7.22：银行数据集](img/C12913_07_22.jpg)'
- en: 'Figure 7.22: Bank dataset'
  id: totrans-405
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7.22：银行数据集
- en: 'Segment the data numerically and categorically and perform distribution transformation
    on the numeric data:'
  id: totrans-406
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对数据进行数值和分类分割，并对数值数据执行分布变换：
- en: '[PRE117]'
  id: totrans-407
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE117]'
- en: Perform data preprocessing on the data.
  id: totrans-408
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对数据进行预处理：
- en: 'Now, create a `loop` to identify the columns with a non-normal distribution
    using the following command (converting to NumPy arrays for more efficient computation):'
  id: totrans-409
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，创建一个`loop`，使用以下命令识别具有非正态分布的列（将数据转换为NumPy数组，以提高计算效率）：
- en: '[PRE118]'
  id: totrans-410
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE118]'
- en: 'The output is as follows:'
  id: totrans-411
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.23: Identifying the columns with a non-linear distribution](img/C12913_07_23.jpg)'
  id: totrans-412
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 7.23：识别具有非线性分布的列](img/C12913_07_23.jpg)'
- en: 'Figure 7.23: Identifying the columns with a non-linear distribution'
  id: totrans-413
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7.23：识别具有非线性分布的列
- en: 'Create a `PowerTransformer` based transformation (`box-cox`):'
  id: totrans-414
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建基于`PowerTransformer`的变换（`box-cox`）：
- en: '[PRE119]'
  id: totrans-415
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE119]'
- en: Note
  id: totrans-416
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: '`box-cox` can handle only positive values.'
  id: totrans-417
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`box-cox`仅能处理正值。'
- en: 'Apply the power transformation model on the data. Select the columns to normalize:'
  id: totrans-418
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对数据应用幂变换模型。选择需要标准化的列：
- en: '[PRE120]'
  id: totrans-419
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE120]'
- en: 'Create a density plot to check the normality:'
  id: totrans-420
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建密度图以检查正态性：
- en: '[PRE121]'
  id: totrans-421
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE121]'
- en: 'The output is as follows:'
  id: totrans-422
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.24: Density plot to check the normality](img/Image54824.jpg)'
  id: totrans-423
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 7.24：密度图检查正态性](img/Image54824.jpg)'
- en: 'Figure 7.24: Density plot to check the normality'
  id: totrans-424
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7.24：密度图检查正态性
- en: 'Now, transform the columns to a normal distribution using the following command:'
  id: totrans-425
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用以下命令将列转换为正态分布：
- en: '[PRE122]'
  id: totrans-426
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE122]'
- en: 'Again, create a density plot to check the normality:'
  id: totrans-427
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次创建密度图，以检查正态性：
- en: '[PRE123]'
  id: totrans-428
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE123]'
- en: 'The output is as follows:'
  id: totrans-429
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.25: Another density plot to check the normality](img/Image54838.jpg)'
  id: totrans-430
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 7.25：另一个密度图检查正态性](img/Image54838.jpg)'
- en: 'Figure 7.25: Another density plot to check the normality'
  id: totrans-431
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7.25：另一个密度图以检查正态性
- en: 'Use a `loop` to identify the columns with non-normal distribution on the transformed
    data:'
  id: totrans-432
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`loop`在转换后的数据上识别具有非正态分布的列：
- en: '[PRE124]'
  id: totrans-433
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE124]'
- en: 'The output is as follows:'
  id: totrans-434
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下：
- en: '![Figure 7.26: Power transformation model to data](img/Image54847.jpg)'
  id: totrans-435
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 7.26：幂变换模型应用于数据](img/Image54847.jpg)'
- en: 'Figure 7.26: Power transformation model to data'
  id: totrans-436
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7.26：幂变换模型应用于数据
- en: 'Bind the normalized and non-normalized columns. Select the columns not to normalize:'
  id: totrans-437
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绑定标准化和非标准化列。选择不进行标准化的列：
- en: '[PRE125]'
  id: totrans-438
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE125]'
- en: 'Use the following command to bind both the non-normalized and normalized columns:'
  id: totrans-439
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下命令绑定非标准化列和标准化列：
- en: '[PRE126]'
  id: totrans-440
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE126]'
- en: '![Figure 7.27: Non-normalized and normalized columns](img/C12913_07_27.jpg)'
  id: totrans-441
  prefs: []
  type: TYPE_IMG
  zh: '![图 7.27：非标准化和标准化列](img/C12913_07_27.jpg)'
- en: 'Figure 7.27: Non-normalized and normalized columns'
  id: totrans-442
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7.27：非标准化和标准化列
- en: 'Chapter 08: Creating a Full Analysis Report'
  id: totrans-443
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第08章：创建完整的分析报告
- en: 'Activity 15: Generating Visualization Using Plotly'
  id: totrans-444
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 15：使用Plotly生成可视化
- en: Import all the required libraries and packages into the Jupyter notebook. Make
    sure to read the data from `bank.csv` into the Spark DataFrame.
  id: totrans-445
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将所有必需的库和包导入到Jupyter笔记本中。确保将数据从`bank.csv`读取到Spark DataFrame中。
- en: 'Import the libraries for Plotly, as illustrated here:'
  id: totrans-446
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入Plotly库，如下所示：
- en: '[PRE127]'
  id: totrans-447
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE127]'
- en: 'Now, for visualization in Plotly, we need to initiate an offline session. Use
    the following command (requires version >= 1.9.0):'
  id: totrans-448
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，为了在Plotly中进行可视化，我们需要启动一个离线会话。使用以下命令（要求版本>= 1.9.0）：
- en: '[PRE128]'
  id: totrans-449
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE128]'
- en: 'Now Plotly is initiated offline. Use the following command to start a Plotly
    notebook:'
  id: totrans-450
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，Plotly已启动离线模式。使用以下命令启动Plotly笔记本：
- en: '[PRE129]'
  id: totrans-451
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE129]'
- en: After starting the Plotly notebook, we can use Plotly to generate many types
    of graphs, such as a bar graph, a boxplot, or a scatter plot, and convert the
    entire output into a user interface or an app that is supported by Python's Flask
    framework.
  id: totrans-452
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 启动Plotly笔记本后，我们可以使用Plotly生成多种类型的图表，如条形图、箱型图或散点图，并将整个输出转换为一个用户界面或一个支持Python Flask框架的应用程序。
- en: 'Now, plot each graph using Plotly:'
  id: totrans-453
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，使用 Plotly 绘制每个图表：
- en: 'Bar graph:'
  id: totrans-454
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 柱状图：
- en: '[PRE130]'
  id: totrans-455
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE130]'
- en: 'The bar graph is as follows:'
  id: totrans-456
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 柱状图如下所示：
- en: '![](img/C12913_08_18.jpg)'
  id: totrans-457
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![](img/C12913_08_18.jpg)'
- en: 'Figure 8.18: Bar graph'
  id: totrans-458
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 8.18：柱状图
- en: 'Scatter plot:'
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 散点图：
- en: '[PRE131]'
  id: totrans-460
  prefs: []
  type: TYPE_PRE
  zh: '[PRE131]'
- en: 'The scatter plot is as follows:'
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 散点图如下所示：
- en: '![Figure 8.19: Scatter plot](img/C12913_08_19.jpg)'
  id: totrans-462
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.19：散点图](img/C12913_08_19.jpg)'
- en: 'Figure 8.19: Scatter plot'
  id: totrans-463
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 8.19：散点图
- en: 'Boxplot:'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 箱形图：
- en: '[PRE132]'
  id: totrans-465
  prefs: []
  type: TYPE_PRE
  zh: '[PRE132]'
- en: 'The boxplot is as follows:'
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: 箱形图如下所示：
- en: '![Figure 8.20: Boxplot](img/C12913_08_20.jpg)'
  id: totrans-467
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.20：箱形图](img/C12913_08_20.jpg)'
- en: 'Figure 8.20: Boxplot'
  id: totrans-468
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 8.20：箱形图
