- en: 2\. Regression
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2. 回归
- en: Overview
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 概述
- en: This chapter is an introduction to linear regression analysis and its application
    to practical problem-solving in data science. You will learn how to use Python,
    a versatile programming language, to carry out regression analysis and examine
    the results. The use of the logarithm function to transform inherently non-linear
    relationships between variables and to enable the application of the linear regression
    method of analysis will also be introduced.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章是对线性回归分析的介绍，以及它在数据科学中的实际应用。您将学习如何使用 Python 这一多功能编程语言进行回归分析并检查结果。还将介绍使用对数函数转换变量之间固有的非线性关系，以便能够应用线性回归分析方法。
- en: By the end of this chapter, you will be able to identify and import the Python
    modules required for regression analysis; use the `pandas` module to load a dataset
    and prepare it for regression analysis; create a scatter plot of bivariate data
    and fit a regression line through it; use the methods available in the Python
    `statsmodels` module to fit a regression model to a dataset; explain the results
    of simple and multiple linear regression analysis; assess the goodness of fit
    of a linear regression model; and apply linear regression analysis as a tool for
    practical problem-solving.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，您将能够识别和导入回归分析所需的 Python 模块；使用 `pandas` 模块加载数据集并为回归分析做准备；创建双变量数据的散点图并拟合回归线；使用
    Python `statsmodels` 模块中可用的方法将回归模型拟合到数据集；解释简单和多元线性回归分析的结果；评估线性回归模型的拟合优度；并将线性回归分析作为解决实际问题的工具。
- en: Introduction
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: 'The previous chapter provided a primer to Python programming and an overview
    of the data science field. Data science is a relatively young multidisciplinary
    field of study. It draws its concepts and methods from the traditional fields
    of statistics, computer science, and the broad field of artificial intelligence
    (AI), especially the subfield of AI called machine learning:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 上一章介绍了 Python 编程的基础知识和数据科学领域的概述。数据科学是一个相对年轻的跨学科研究领域。它借鉴了传统的统计学、计算机科学和广泛的人工智能（AI）领域的概念和方法，尤其是人工智能的子领域——机器学习：
- en: '![Figure 2.1: The data science models'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.1：数据科学模型](img/B15019_02_01.jpg)'
- en: '](img/B15019_02_01.jpg)'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_01.jpg)'
- en: 'Figure 2.1: The data science models'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.1：数据科学模型
- en: As you can see in *Figure 2.1*, data science aims to make use of both **structured**
    and **unstructured** data, develop models that can be effectively used, make predictions,
    and also derive insights for decision making.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 如您在*图 2.1*中所见，数据科学旨在利用**结构化**和**非结构化**数据，开发能够有效使用的模型，进行预测，并为决策提供见解。
- en: A loose description of structured data will be any set of data that can be conveniently
    arranged into a table that consists of rows and columns. This kind of data is
    normally stored in database management systems.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 对结构化数据的宽泛描述是任何能够方便地安排成由行和列组成的表格的数据。这种数据通常存储在数据库管理系统中。
- en: Unstructured data, however, cannot be conveniently stored in tabular form –
    an example of such a dataset is a text document. To achieve the objectives of
    data science, a flexible programming language that effectively combines interactivity
    with computing power and speed is necessary. This is where the Python programming
    language meets the needs of data science and, as mentioned in *Chapter 1*, *Introduction
    to Data Science in Python*, we will be using Python in this book.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，非结构化数据不能方便地以表格形式存储——这样的数据集的一个例子是文本文件。为了实现数据科学的目标，需要一种灵活的编程语言，能够有效地将交互性与计算能力和速度相结合。这正是
    Python 编程语言满足数据科学需求的地方，正如*第一章*《Python中的数据科学入门》中提到的，我们将在本书中使用 Python。
- en: The need to develop models to make predictions and to gain insights for decisionmaking
    cuts across many industries. Data science is, therefore, finding uses in many
    industries, including healthcare, manufacturing and the process industries in
    general, the banking and finance sectors, marketing and e-commerce, the government,
    and education.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 需要开发模型以进行预测和获得决策见解的需求横跨许多行业。因此，数据科学正在许多行业中得到应用，包括医疗保健、制造业、一般过程行业、银行和金融部门、市场营销和电子商务、政府以及教育。
- en: In this chapter, we will be specifically be looking at regression, which is
    one of the key methods that is used regularly in data science, in order to model
    relationships between variables, where the **target variable** (that is, the value
    you're looking for) is a real number.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将特别讨论回归分析，它是数据科学中常用的关键方法之一，用于建模变量之间的关系，其中**目标变量**（即你要寻找的值）是一个实数。
- en: Consider a situation where a real estate business wants to understand and, if
    possible, model the relationship between the prices of property in a city and
    knowing the key attributes of the properties. This is a data science problem and
    it can be tackled using regression.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 假设一个房地产公司希望了解并且如果可能的话，建模城市中房产价格与房产关键属性之间的关系。这是一个数据科学问题，可以通过回归来解决。
- en: 'This is because the target variable of interest, which is the price of a property,
    is a real number. Examples of the key attributes of a property that can be used
    to predict its value are as follows:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 这是因为感兴趣的目标变量，即房产价格，是一个实数。可以用来预测房产价值的关键属性示例如下：
- en: The age of the property
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 房产的年龄
- en: The number of bedrooms in a property
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 房产的卧室数量
- en: Whether the property has a pool or not
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 房产是否有游泳池
- en: The area of land the property covers
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 房产所占土地的面积
- en: The distance of the property from facilities such as railway stations and schools
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 房产距离铁路站和学校等设施的距离
- en: Regression analysis can be employed to study this scenario, in which you have
    to create a function that maps the key attributes of a property to the target
    variable, which, in this case, is the price of a property.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 回归分析可以用于研究这种情况，你需要创建一个函数，将房产的关键属性映射到目标变量，在这个例子中，目标变量是房产的价格。
- en: 'Regression analysis is part of a family of machine learning techniques called
    **supervised machine learning**. It is called supervised because the machine learning
    algorithm that learns the model is provided a kind of *question* and *answer*
    dataset to learn from. The *question* here is the key attribute and the *answer*
    is the property price for each property that is used in the study, as shown in
    the following figure:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 回归分析是属于机器学习技术中的一个类别，叫做**监督机器学习**。之所以叫做监督，是因为学习模型的机器学习算法会提供一个类似于*问题*和*答案*的数据集供其学习。这里的*问题*是关键属性，而*答案*则是用于研究的每个房产的价格，如下图所示：
- en: '![Figure 2.2: Example of a supervised learning technique'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.2：监督学习技术的示例'
- en: '](img/B15019_02_02.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_02.jpg)'
- en: 'Figure 2.2: Example of a supervised learning technique'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.2：监督学习技术的示例
- en: Once a model has been learned by the algorithm, we can provide the model with
    a question (that is, a set of attributes for a property whose price we want to
    find) for it to tell us what the answer (that is, the price) of that property
    will be.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦算法学习了模型，我们就可以向模型提供一个问题（即一组房产属性，我们希望找出其价格），让它告诉我们该房产的价格（即答案）是多少。
- en: 'This chapter is an introduction to linear regression and how it can be applied
    to solve practical problems like the one described previously in data science.
    Python provides a rich set of modules (libraries) that can be used to conduct
    rigorous regression analysis of various kinds. In this chapter, we will make use
    of the following Python modules, among others: `pandas`, `statsmodels`, `seaborn`,
    `matplotlib`, and `scikit-learn`.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍了线性回归及其如何应用于解决数据科学中像前面描述的实际问题。Python提供了丰富的模块（库），可以用来进行各种类型的严谨回归分析。在本章中，我们将使用以下Python模块，当然还有其他模块：`pandas`、`statsmodels`、`seaborn`、`matplotlib`和`scikit-learn`。
- en: Simple Linear Regression
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简单线性回归
- en: In *Figure 2.3*, you can see the crime rate per capita and the median value
    of owner-occupied homes for the city of Boston, which is the largest city of the
    Commonwealth of Massachusetts. We seek to use regression analysis to gain an insight
    into what drives crime rates in the city.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图 2.3*中，你可以看到波士顿市的人均犯罪率和业主自住房屋的中位数价值，波士顿是马萨诸塞州最大的城市。我们希望通过回归分析来了解影响该市犯罪率的因素。
- en: Such analysis is useful to policy makers and society in general because it can
    help with decision-making directed toward the reduction of the crime rate, and
    hopefully the eradication of crime across communities. This can make communities
    safer and increase the quality of life in society.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这样的分析对政策制定者和社会整体非常有用，因为它有助于决策，推动减少犯罪率的措施，并有望在整个社区消除犯罪。这可以使社区更加安全，提高社会的生活质量。
- en: This is a data science problem and is of the supervised machine learning type.
    There is a dependent variable named `crime rate` (let's denote it *Y*), whose
    variation we seek to understand in terms of an independent variable, named `Median
    value of owner-occupied homes` (let's denote it *X*).
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个数据科学问题，属于有监督机器学习类型。存在一个因变量`犯罪率`（我们将其表示为*Y*），我们试图理解其变化，并将其与一个自变量`业主自住房屋中位数价值`（我们将其表示为*X*）联系起来。
- en: In other words, we are trying to understand the variation in crime rate based
    on different neighborhoods.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，我们试图根据不同的邻里情况，理解犯罪率的变化。
- en: Regression analysis is about finding a function, under a given set of assumptions,
    that best describes the relationship between the dependent variable (*Y* in this
    case) and the independent variable (*X* in this case).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 回归分析是寻找一个函数，在给定假设条件下，最好地描述因变量（在本例中为*Y*）与自变量（在本例中为*X*）之间的关系。
- en: 'When the number of independent variables is only one, and the relationship
    between the dependent and the independent variable is assumed to be a straight
    line, as shown in *Figure 2.3*, this type of regression analysis is called **simple
    linear regression**. The straight-line relationship is called the regression line
    or the line of **best** fit:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 当自变量只有一个，且假设因变量与自变量之间的关系为直线时，如*图 2.3*所示，这种回归分析称为**简单线性回归**。直线关系被称为回归线或**最佳**拟合线：
- en: '![Figure 2.3: A scatter plot of the crime rate against the median value'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.3：犯罪率与业主自住房屋中位数价值的散点图'
- en: of owner-occupied homes
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 业主自住房屋
- en: '](img/B15019_02_03.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_03.jpg)'
- en: 'Figure 2.3: A scatter plot of the crime rate against the median value of owner-occupied
    homes'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.3：犯罪率与业主自住房屋中位数价值的散点图
- en: In *Figure 2.3*, the regression line is shown as a solid black line. Ignoring
    the poor quality of the fit of the regression line to the data in the figure,
    we can see a decline in crime rate per capita as the median value of owner-occupied
    homes increases.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图 2.3*中，回归线以实心黑色线条表示。忽略回归线与图中数据拟合的较差质量，我们可以看到随着业主自住房屋中位数价值的增加，每人犯罪率有所下降。
- en: From a data science point of view, this observation may pose lots of questions.
    For instance, what is driving the decline in crime rate per capita as the median
    value of owner-occupier homes increases? Are richer suburbs and towns receiving
    more policing resources than less fortunate suburbs and towns? Unfortunately,
    these questions cannot be answered with such a simple plot as we find in *Figure
    2.3*. But the observed trend may serve as a starting point for a discussion to
    review the distribution of police and community-wide security resources.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 从数据科学的角度来看，这一观察可能引发许多问题。例如，是什么原因导致每人犯罪率随着业主自住房屋中位数价值的增加而下降？较富裕的郊区和城镇是否比经济条件较差的郊区和城镇获得更多的警力资源？不幸的是，这些问题无法通过像*图
    2.3*中的简单图表来解答。但观察到的趋势可能作为讨论的起点，用于审视警力和社区安全资源的分配情况。
- en: Returning to the question of how well the regression line fits the data, it
    is evident that almost one-third of the regression line has no data points scattered
    around it at all. Many data points are simply clustered on the horizontal axis
    around the zero (`0`) crime rate mark. This is not what you expect of a good regression
    line that fits the data well. A good regression line that fits the data well must
    sit amidst a *cloud* of data points.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 回到回归线拟合数据的效果问题，显然回归线的近三分之一处没有任何数据点分布在其周围。许多数据点仅仅聚集在横轴上，接近零（`0`）犯罪率的位置。这并不是你所期待的一个良好的回归线应该有的效果。一个良好的回归线应该能够很好地拟合数据，且应当位于一片*数据点云*之中。
- en: It appears that the relationship between the crime rate per capita and the median
    value of owner-occupied homes is not as linear as you may have thought initially.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来每人犯罪率与业主自住房屋中位数价值之间的关系，并不像你最初想的那样呈线性关系。
- en: In this chapter, we will learn how to use the logarithm function (a mathematical
    function for transforming values) to linearize the relationship between the crime
    rate per capita and the median value of owner-occupied homes, in order to improve
    the fit of the regression line to the data points on the scatter graph.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何使用对数函数（一种用于转换数值的数学函数）将人均犯罪率与自有住房中位数之间的关系线性化，从而改善回归线与散点图数据点的拟合度。
- en: We have ignored a very important question thus far. That is, *how can you determine
    the regression line for a given set of data?*
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们忽略了一个非常重要的问题。也就是，*如何为给定的数据集确定回归线？*
- en: A common method used to determine the regression line is called the method of
    least squares, which is covered in the next section.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 确定回归线的常用方法叫做最小二乘法，接下来将介绍该方法。
- en: The Method of Least Squares
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 最小二乘法
- en: The simple linear regression line is generally of the form shown in *Figure
    2.4*, where β0 and β1 are unknown constants, representing the intercept and the
    slope of the regression line, respectively.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 简单线性回归线通常呈现出*图 2.4*所示的形式，其中 β0 和 β1 是未知常数，分别表示回归线的截距和斜率。
- en: 'The intercept is the value of the dependent variable (Y) when the independent
    variable (X) has a value of zero (0). The slope is a measure of the rate at which
    the dependent variable (Y) changes when the independent variable (X) changes by
    one (1). The unknown constants are called the `≈`) in *Figure 2.4*. The model
    is called probabilistic because it does not model all the variability in the dependent
    variable (Y) :'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 截距是当自变量（X）为零时因变量（Y）的值。斜率是自变量（X）变化一个单位时因变量（Y）变化的速率。未知常数称为 `≈`）在*图 2.4*中。该模型被称为概率模型，因为它没有模拟因变量（Y）中的所有变异性：
- en: '![Figure 2.4: Simple linear regression equation'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.4：简单线性回归方程'
- en: '](img/B15019_02_04.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_04.jpg)'
- en: 'Figure 2.4: Simple linear regression equation'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.4：简单线性回归方程
- en: Calculating the difference between the actual dependent variable value and the
    predicted dependent variable value gives an error that is commonly termed as the
    residual (ϵi).
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 计算实际因变量值与预测因变量值之间的差异，得到的误差通常称为残差（ϵi）。
- en: Repeating this calculation for every data point in the sample, the residual
    (ϵi) for every data point can be squared, to eliminate algebraic signs, and added
    together to obtain the **error sum of squares** **(ESS)**.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 对样本中的每个数据点重复此计算，每个数据点的残差（ϵi）可以被平方，以消除代数符号，并加在一起以得到**误差平方和**（ESS）。
- en: The least squares method seeks to minimize the ESS.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 最小二乘法旨在最小化误差平方和（ESS）。
- en: Multiple Linear Regression
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 多元线性回归
- en: In the simple linear regression discussed previously, we only have one independent
    variable. If we include multiple independent variables in our analysis, we get
    a multiple linear regression model. Multiple linear regression is represented
    in a way that's similar to simple linear regression.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面讨论的简单线性回归中，我们只有一个自变量。如果我们在分析中包含多个自变量，就得到一个多元线性回归模型。多元线性回归的表示方式类似于简单线性回归。
- en: 'Let''s consider a case where we want to fit a linear regression model that
    has three independent variables, X1, X2, and X3\. The formula for the multiple
    linear regression equation will look like *Figure 2.5*:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们要拟合一个包含三个自变量 X1、X2 和 X3 的线性回归模型。多元线性回归方程的公式将如下所示，如*图 2.5*所示：
- en: '![Figure 2.5: Multiple linear regression equation'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.5：多元线性回归方程'
- en: '](img/B15019_02_05.jpg)'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_05.jpg)'
- en: 'Figure 2.5: Multiple linear regression equation'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.5：多元线性回归方程
- en: Each independent variable will have its own coefficient or parameter (that is,
    β1 β2 or β3). The βs coefficient tells us how a change in their respective independent
    variable influences the dependent variable if all other independent variables
    are unchanged.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 每个自变量将有自己的系数或参数（即 β1、β2 或 β3）。β 系数告诉我们，如果其他自变量保持不变，某个自变量的变化如何影响因变量。
- en: Estimating the Regression Coefficients (β0, β1, β2 and β3)
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 回归系数估计（β0、β1、β2 和 β3）
- en: The regression coefficients in *Figure 2.5* are estimated using the same least
    squares approach that was discussed when simple linear regression was introduced.
    To satisfy the least squares method, the chosen coefficients must minimize the
    sum of squared residuals.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 2.5*中的回归系数是使用与介绍简单线性回归时讨论的最小二乘法相同的方法估计的。为了满足最小二乘法的要求，所选的系数必须最小化平方残差的和。'
- en: Later in the chapter, we will make use of the Python programming language to
    compute these coefficient estimates practically.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章稍后，我们将利用 Python 编程语言实际计算这些系数估计值。
- en: Logarithmic Transformations of Variables
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 变量的对数变换
- en: As has been mentioned already, sometimes the relationship between the dependent
    and independent variables is not linear. This limits the use of linear regression.
    To get around this, depending on the nature of the relationship, the logarithm
    function can be used to transform the variable of interest. What happens then
    is that the transformed variable tends to have a linear relationship with the
    other untransformed variables, enabling the use of linear regression to fit the
    data. This will be illustrated in practice on the dataset being analyzed later
    in the exercises of the book.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，依赖变量与自变量之间的关系有时并不是线性的。这限制了线性回归的使用。为了解决这个问题，根据关系的性质，可以使用对数函数来变换感兴趣的变量。这样变换后的变量通常与其他未变换的变量呈线性关系，从而使得可以使用线性回归来拟合数据。本书后续的练习中将通过实践展示这一点。
- en: Correlation Matrices
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关矩阵
- en: In *Figure 2.3*, we saw how a linear relationship between two variables can
    be analyzed using a straight-line graph. Another way of visualizing the linear
    relationship between variables is with a correlation matrix. A correlation matrix
    is a kind of cross-table of numbers showing the correlation between pairs of variables,
    that is, how strongly the two variables are connected (this can be thought of
    as how a change in one variable will cause a change in the other variable). It
    is not easy analyzing raw figures in a table. A correlation matrix can, therefore,
    be converted to a form of "heatmap" so that the correlation between variables
    can easily be observed using different colors. An example of this is shown in
    *Exercise 2.01*, *Loading and Preparing the Data for Analysis*.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图 2.3*中，我们看到如何通过直线图分析两个变量之间的线性关系。另一种可视化变量之间线性关系的方法是使用相关矩阵。相关矩阵是一种数字交叉表，显示了变量对之间的相关性，也就是两个变量之间的关联程度（可以理解为一个变量的变化如何导致另一个变量的变化）。分析表格中的原始数据并不容易。因此，相关矩阵可以转换为“热图”的形式，便于通过不同的颜色观察变量之间的相关性。*练习
    2.01*中展示了这一点，*加载并准备数据以供分析*。
- en: Conducting Regression Analysis Using Python
  id: totrans-69
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Python 进行回归分析
- en: Having discussed the basics of regression analysis, it is now time to get our
    hands dirty and actually do some regression analysis using Python.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论了回归分析的基础知识后，现在是时候动手实践，使用 Python 进行实际的回归分析了。
- en: To begin with our analysis, we need to start a session in Python and load the
    relevant modules and dataset required.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 为了开始我们的分析，我们需要在 Python 中启动一个会话，并加载所需的相关模块和数据集。
- en: All of the regression analysis we will do in this chapter will be based on the
    Boston Housing dataset. The dataset is good for teaching and is suitable for linear
    regression analysis. It presents the level of challenge that necessitates the
    use of the logarithm function to transform variables in order to achieve a better
    level of model fit to the data. The dataset contains information on a collection
    of properties in the Boston area and can be used to determine how the different
    housing attributes of a specific property affect the property's value.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中我们进行的所有回归分析都将基于波士顿住房数据集。该数据集适合教学，且适用于线性回归分析。它呈现了一个足够的挑战性，需要使用对数函数来变换变量，以便更好地拟合数据。该数据集包含了波士顿地区一组房产的信息，可以用来确定特定房产的不同属性如何影响其价值。
- en: 'The column headings of the Boston Housing dataset CSV file can be explained
    as follows:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 波士顿住房数据集 CSV 文件的列标题可以解释如下：
- en: CRIM – per capita crime rate by town
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CRIM – 每个城镇的人均犯罪率。
- en: ZN – proportion of residential land zoned for lots over 25,000 sq.ft.
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ZN – 划定为超过 25,000 平方英尺的住宅用地比例。
- en: INDUS – proportion of non-retail business acres per town
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: INDUS – 每个城镇的非零售商业用地比例。
- en: CHAS – Charles River dummy variable (= 1 if tract bounds river; 0 otherwise)
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CHAS – 查尔斯河虚拟变量（= 1 如果区域边界接壤河流；否则为 0）
- en: NOX – nitric oxide concentration (parts per 10 million)
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NOX – 一氧化氮浓度（单位：每千万分之一）
- en: RM – average number of rooms per dwelling
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RM – 每个住宅的平均房间数
- en: AGE – proportion of owner-occupied units built prior to 1940
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AGE – 1940 年之前建造的自有住房单元比例
- en: DIS – weighted distances to five Boston employment centers
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DIS – 到五个波士顿就业中心的加权距离
- en: RAD – index of accessibility to radial highways
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RAD – 通向辐射公路的可达性指数
- en: TAX – full-value property-tax rate per $10,000
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: TAX – 每 $10,000 的全额财产税税率
- en: PTRATIO – pupil-teacher ratio by town
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PTRATIO – 按城镇划分的师生比
- en: LSTAT – % of lower status of the population
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: LSTAT – 低收入人群所占百分比
- en: MEDV – median value of owner-occupied homes in $1,000s
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MEDV – 自有住房的中位数价格（单位：千美元）
- en: The dataset we're using is a slightly modified version of the original and was
    sourced from [https://packt.live/39IN8Y6](https://packt.live/39IN8Y6).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用的数据集是原始数据集的轻微修改版本，来自于 [https://packt.live/39IN8Y6](https://packt.live/39IN8Y6)。
- en: 'Exercise 2.01: Loading and Preparing the Data for Analysis'
  id: totrans-88
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习 2.01：加载并准备数据进行分析
- en: In this exercise, we will learn how to load Python modules, and the dataset
    we need for analysis, into our Python session and prepare the data for analysis.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在本练习中，我们将学习如何将 Python 模块和我们需要的分析数据集加载到 Python 会话中，并准备数据进行分析。
- en: Note
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: We will be using the Boston Housing dataset in this chapter, which can be found
    on our GitHub repository at [https://packt.live/2QCCbQB](https://packt.live/2QCCbQB).
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在本章中使用波士顿房价数据集，您可以在我们的 GitHub 仓库找到它，链接：[https://packt.live/2QCCbQB](https://packt.live/2QCCbQB)。
- en: 'The following steps will help you to complete this exercise:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤将帮助您完成此练习：
- en: Open a new Colab notebook file.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的 Colab 笔记本文件。
- en: Load the necessary Python modules by entering the following code snippet into
    a single Colab notebook cell. Press the `matplotlib` to display the graphical
    output of the code in the notebook environment. The lines of code that follow
    use the `import` keyword to load various Python modules into our programming environment.
    This includes `patsy`, which is a Python module. Some of the modules are given
    aliases for easy referencing, such as the `seaborn` module being given the alias
    `sns`. Therefore, whenever we refer to `seaborn` in subsequent code, we use the
    alias `sns`. The `patsy` module is imported without an alias. We, therefore, use
    the full name of the `patsy` module in our code where needed.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过将以下代码片段输入到一个 Colab 笔记本单元中，加载所需的 Python 模块。按 `matplotlib` 显示代码在笔记本环境中的图形输出。接下来的代码行使用
    `import` 关键字将各种 Python 模块加载到我们的编程环境中。这些模块包括 `patsy`，它是一个 Python 模块。为了方便引用，某些模块被赋予别名，例如
    `seaborn` 模块的别名是 `sns`。因此，当我们在后续代码中引用 `seaborn` 时，使用别名 `sns`。`patsy` 模块没有使用别名，因此在代码中需要时，我们使用
    `patsy` 的全名。
- en: The `plot_corr` and `train_test_split` functions are imported from the `statsmodels.graphics.correlation`
    and `sklearn.model_selection` modules respectively. The last statement is used
    to set the aesthetic look of the graphs that `matplotlib` generates to the type
    displayed by the `seaborn` module.
  id: totrans-95
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`plot_corr` 和 `train_test_split` 函数分别从 `statsmodels.graphics.correlation` 和
    `sklearn.model_selection` 模块导入。最后的语句用于设置 `matplotlib` 生成的图表的美学外观，使其与 `seaborn`
    模块显示的类型一致。'
- en: 'Next, load the `Boston.CSV` file and assign the variable name `rawBostonData`
    to it by running the following code:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，加载 `Boston.CSV` 文件，并通过运行以下代码将变量名 `rawBostonData` 分配给它：
- en: '[PRE0]'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Inspect the first five records in the DataFrame:'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查 DataFrame 中的前五条记录：
- en: '[PRE1]'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'You should get the following output:'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您应该得到以下输出：
- en: '![Figure 2.6: First five rows of the dataset'
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 2.6：数据集的前五行'
- en: '](img/B15019_02_06.jpg)'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_06.jpg)'
- en: 'Figure 2.6: First five rows of the dataset'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 2.6：数据集的前五行
- en: 'Check for missing values (*null* values) in the DataFrame and then drop them
    in order to get a clean dataset Use the pandas method `dropna()` to find and remove
    these missing values:'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查 DataFrame 中是否存在缺失值（*null* 值），然后删除这些值以获得干净的数据集。使用 pandas 方法 `dropna()` 来查找并移除这些缺失值：
- en: '[PRE2]'
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Check for duplicate records in the DataFrame and then drop them in order to
    get a clean dataset. Use the `drop_duplicates()` method from pandas:'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查 DataFrame 中是否存在重复记录，然后删除它们以获得干净的数据集。使用 pandas 中的 `drop_duplicates()` 方法：
- en: '[PRE3]'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'List the column names of the DataFrame so that you can examine the fields in
    your dataset, and modify the names, if necessary, to names that are meaningful:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列出 DataFrame 的列名，以便您检查数据集中的字段，并在必要时修改为有意义的名称：
- en: '[PRE4]'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'You should get the following output:'
  id: totrans-110
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您应该得到以下输出：
- en: '![Figure 2.7: Listing all the column names'
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图2.7：列出所有列名'
- en: '](img/B15019_02_07.jpg)'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_07.jpg)'
- en: 'Figure 2.7: Listing all the column names'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.7：列出所有列名
- en: 'Rename the DataFrame columns so that they are meaningful. Be mindful to match
    the column names exactly as leaving out even white spaces in the name strings
    will result in an error. For example, this string, `ZN`, has a white space before
    and after and it is different from `ZN`. After renaming, print the head of the
    new DataFrame as follows:'
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重命名数据框的列，使其具有意义。请注意精确匹配列名，甚至在名称字符串中留空格也会导致错误。例如，字符串`ZN`前后有空格，它与`ZN`不同。重命名后，打印新的数据框头部，如下所示：
- en: '[PRE5]'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'You should get the following output:'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该得到以下输出：
- en: '![Figure 2.8: DataFrames being renamed'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图2.8：数据框被重命名'
- en: '](img/B15019_02_08.jpg)'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_08.jpg)'
- en: 'Figure 2.8: DataFrames being renamed'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.8：数据框被重命名
- en: Note
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: The preceding output is truncated. Please head to the GitHub repository to find
    the entire output.
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 上述输出已被截断。请前往 GitHub 仓库查看完整的输出。
- en: 'Inspect the data types of the columns in your DataFrame using the `.info()` function:'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`.info()`函数检查数据框中各列的数据类型：
- en: '[PRE6]'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'You should get the following output:'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该得到以下输出：
- en: '![Figure 2.9: The different data types in the dataset'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图2.9：数据集中的不同数据类型'
- en: '](img/B15019_02_09.jpg)'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_09.jpg)'
- en: 'Figure 2.9: The different data types in the dataset'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.9：数据集中的不同数据类型
- en: 'The output shows that there are `506` rows (`Int64Index: 506 entries`) in the
    dataset. There are also `13` columns in total (`Data columns`). None of the `13`
    columns has a row with a missing value (all `506` rows are *non-null*). 10 of
    the columns have floating-point (decimal) type data and three have integer type data.'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '输出显示数据集共有`506`行（`Int64Index: 506 entries`）。共有`13`列（`Data columns`）。`13`列中没有任何一列有缺失值（所有`506`行都是*非空*）。10列具有浮动（小数）类型数据，3列具有整数类型数据。'
- en: 'Now, calculate basic statistics for the numeric columns in the DataFrame:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，计算数据框中数值列的基本统计数据：
- en: '[PRE7]'
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We used the pandas function, `describe`, called on the DataFrame to calculate
    simple statistics for numeric fields (this includes any field with a `numpy` number
    data type) in the DataFrame. The statistics include the minimum, the maximum,
    the count of rows in each column, the average of each column (mean), the 25th
    percentile, the 50th percentile, and the 75th percentile. We transpose (using
    the `.T` function) the output of the `describe` function to get a better layout.
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们使用了 pandas 函数`describe`，该函数用于计算数据框中数值字段的简单统计数据（包括任何具有`numpy`数值数据类型的字段）。统计数据包括最小值、最大值、每列的行数、每列的平均值（均值）、第25百分位数、第50百分位数和第75百分位数。我们通过转置（使用`.T`函数）`describe`函数的输出，以获得更好的布局。
- en: 'You should get the following output:'
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该得到以下输出：
- en: '![Figure 2.10: Basic statistics of the numeric column'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图2.10：数值列的基本统计数据'
- en: '](img/B15019_02_10.jpg)'
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_10.jpg)'
- en: 'Figure 2.10: Basic statistics of the numeric column'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图2.10：数值列的基本统计数据
- en: 'Divide the DataFrame into training and test sets, as shown in the following
    code snippet:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据框划分为训练集和测试集，如下代码片段所示：
- en: '[PRE8]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: We choose a test data size of 30%, which is `0.3`. The `train_test_split` function
    is used to achieve this. We set the seed of the random number generator so that
    we can obtain a reproducible split each time we run this code. An arbitrary value
    of `10` is used here. It is good model-building practice to divide a dataset being
    used to develop a model into at least two parts. One part is used to develop the
    model and it is called a training set (`X_train` and `y_train` combined).
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们选择了30%的测试数据大小，即`0.3`。使用`train_test_split`函数实现这一点。我们设置了随机数生成器的种子，以便每次运行此代码时都能获得可重复的划分。这里使用了一个任意值`10`。在构建模型时，将用于开发模型的数据集至少划分为两部分是一种良好的做法。一部分用于开发模型，称为训练集（`X_train`和`y_train`合并）。
- en: Note
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: Splitting your data into training and test subsets allows you to use some of
    the data to train your model (that is, it lets you build a model that learns the
    relationships between the variables), and the rest of the data to test your model
    (that is, to see how well your new model can make predictions when given new data).
    You will use train-test splits throughout this book, and the concept will be explained
    in more detail in *Chapter 7, The Generalization Of Machine Learning Models*.
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将数据分割为训练和测试子集允许您使用部分数据来训练模型（即，它允许您构建一个学习变量之间关系的模型），其余数据用于测试模型（即，查看新数据给出时您的新模型能够做出多好的预测）。您将在本书中始终使用训练-测试拆分，并且这个概念将在*第7章，机器学习模型的泛化*中详细解释。
- en: 'Calculate and plot a correlation matrix for the `train_data` set:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算并绘制 `train_data` 集的相关矩阵：
- en: '[PRE9]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The use of the backslash character, `\`, on *line 4* in the preceding code snippet
    is to enforce the continuation of code on to a new line in Python. The `\` character
    is not required if you are entering the full line of code into a single line in
    your notebook.
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在前述代码片段中，*第4行* 使用反斜杠字符`\` 的目的是在Python中强制将代码延续到新的行。如果您在笔记本中将整行代码输入到单行中，则不需要`\`字符。
- en: 'You should get the following output:'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您应该得到以下输出：
- en: '![Figure 2.11: Output with the expected heatmap'
  id: totrans-145
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图2.11：预期热力图输出'
- en: '](img/B15019_02_11.jpg)'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_11.jpg)'
- en: 'Figure 2.11: Output with the expected heatmap'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.11：预期热力图输出
- en: In the preceding heatmap, we can see that there is a strong positive correlation
    (an increase in one causes an increase in the other) between variables that have
    orange or red squares. There is a strong negative correlation (an increase in
    one causes a decrease in the other) between variables with blue squares. There
    is little or no correlation between variables with pale-colored squares. For example,
    there appears to be a relatively strong correlation between `nitrixOxide_pp10m`
    and `non-retailLandProptn`, but a low correlation between `riverDummy` and any
    other variable.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述热力图中，我们可以看到具有橙色或红色方块的变量之间存在强正相关（一个变量的增加导致另一个变量的增加）。具有蓝色方块的变量之间存在强负相关（一个变量的增加导致另一个变量的减少）。具有浅色方块的变量之间几乎没有相关性。例如，`nitrixOxide_pp10m`
    和 `non-retailLandProptn` 之间似乎存在相对较强的相关性，但 `riverDummy` 和任何其他变量之间的相关性较低。
- en: Note
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/320HLAH](https://packt.live/320HLAH).
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问本节的源代码，请参阅 [https://packt.live/320HLAH](https://packt.live/320HLAH)。
- en: You can also run this example online at [https://packt.live/34baJAA](https://packt.live/34baJAA).
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以在 [https://packt.live/34baJAA](https://packt.live/34baJAA) 上在线运行此示例。
- en: We can use the findings from the correlation matrix as the starting point for
    further regression analysis. The heatmap gives us a good overview of relationships
    in the data and can show us which variables to target in our investigation.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以利用相关矩阵的发现作为进一步回归分析的起点。热力图为我们提供了数据关系的良好概述，并能显示我们在调查中应关注的变量。
- en: The Correlation Coefficient
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 相关系数
- en: In the previous exercise, we have seen how a correlation matrix heatmap can
    be used to visualize the relationships between pairs of variables. We can also
    see these same relationships in numerical form using the raw correlation coefficient
    numbers. These are values between -1 and 1, which represent how closely two variables
    are linked.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一练习中，我们已经看到如何使用相关矩阵热力图来可视化变量对之间的关系。我们也可以用数值形式看到这些相同的关系，使用原始的相关系数数字。这些数值介于-1和1之间，表示两个变量之间的密切程度。
- en: Pandas provides a `corr` function, which when called on DataFrame provides a
    matrix (table) of the correlation of all numeric data types. In our case, running
    the code, `train_data.corr (method = 'pearson')`, in the Colab notebook provides
    the results in *Figure 2.12*.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: Pandas 提供了一个 `corr` 函数，当在 DataFrame 上调用时提供所有数值数据类型的相关性矩阵（表）。在我们的情况下，在 Colab
    笔记本中运行代码 `train_data.corr(method='pearson')` 提供了 *图2.12* 的结果。
- en: Note
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Pearson is the standard correlation coefficient for measuring the relationship
    between variables.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: Pearson 是衡量变量之间关系的标准相关系数。
- en: It is important to note that *Figure 2.12* is symmetric along the left diagonal.
    The left diagonal values are correlation coefficients for features against themselves
    (and so all of them have a value of one (1)), and therefore are not relevant to
    our analysis. The data in *Figure 2.12* is what is presented as a plot in the
    output of *Step 12* in *Exercise 2.01*, *Loading and Preparing the Data for Analysis*.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，*图 2.12* 沿左对角线是对称的。左对角线的值是特征与自身之间的相关系数（因此它们的值都是 1），所以这些值与我们的分析无关。*图 2.12*
    中的数据即为在 *练习 2.01* 中 *加载和准备数据进行分析* 的 *步骤 12* 输出中的绘图展示。
- en: 'You should get the following output:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 您应获得以下输出：
- en: '![Figure 2.12: A correlation matrix of the training dataset'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.12：训练数据集的相关矩阵'
- en: '](img/B15019_02_12.jpg)'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_12.jpg)'
- en: 'Figure 2.12: A correlation matrix of the training dataset'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.12：训练数据集的相关矩阵
- en: Note
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: The preceding output is truncated.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 上述输出已被截断。
- en: Data scientists use the correlation coefficient as a statistic in order to measure
    the linear relationship between two numeric variables, X and Y. The correlation
    coefficient for a sample of bivariate data is commonly represented by r. In statistics,
    the common method to measure the correlation between two numeric variables is
    by using the Pearson correlation coefficient. Going forward in this chapter, therefore,
    any reference to the correlation coefficient means the Pearson correlation coefficient.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 数据科学家使用相关系数作为统计量，以衡量两个数值变量 X 和 Y 之间的线性关系。双变量数据样本的相关系数通常用 r 表示。在统计学中，衡量两个数值变量之间相关性的常见方法是使用
    Pearson 相关系数。因此，本章中任何提及相关系数的地方，均指代 Pearson 相关系数。
- en: To practically calculate the correlation coefficient statistic for the variables
    in our dataset in this course, we use a Python function. What is important to
    this discussion is the meaning of the values the correlation coefficient we calculate
    takes. The correlation coefficient (r) takes values between +1 and -1\.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 为了实际计算本课程中数据集变量的相关系数统计量，我们使用 Python 函数。对本讨论来说，重要的是我们计算的相关系数所取值的含义。相关系数 (r) 的值范围在
    +1 和 -1 之间。
- en: When r is equal to +1, the relationship between X and Y is such that both X
    and Y increase or decrease in the same direction perfectly. When r is equal to
    -1, the relationship between X and Y is such that an increase in X is associated
    with a decrease in Y perfectly and vice versa. When r is equal to zero (0), there
    is no linear relationship between X and Y.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 当 r 等于 +1 时，X 和 Y 之间的关系是，X 和 Y 会完美地朝同一方向同时增加或减少。当 r 等于 -1 时，X 和 Y 之间的关系是，X 的增加与
    Y 的减少完全相对应，反之亦然。当 r 等于零（0）时，X 和 Y 之间没有线性关系。
- en: Having no linear relationship between X and Y does not mean that X and Y are
    not related; instead, it means that if there is any relationship, it cannot be
    described by a straight line. In practice, correlation coefficient values around
    0.6 or higher (or -0.6 or lower) is a sign of a potentially exciting linear relationship
    between two variables, X and Y.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: X 和 Y 之间没有线性关系并不意味着 X 和 Y 没有关系；相反，这意味着如果存在任何关系，它不能用直线来描述。在实践中，相关系数值在 0.6 或更高（或
    -0.6 或更低）时，通常是 X 和 Y 之间潜在的线性关系的标志。
- en: The last column of the output of *Exercise 2.01*, *Loading and Preparing the
    Data for Analysis*, *Step 12*, provides r values for crime rate per capita against
    other features in color shades. Using the color bar, it is obvious that `radialHighwaysAccess`,
    `propTaxRate_per10K`, `nitrixOxide_pp10m`, and `pctLowerStatus` have the strongest
    correlation with crime rate per capita. This indicates that a possible linear
    relationship, between crime rate per capita and any of these independent variables,
    may be worth looking into.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '*练习 2.01* 的最后一列输出，*加载和准备数据进行分析*，*步骤 12*，提供了犯罪率与其他特征之间的 r 值，并通过颜色深浅展示。通过颜色条可以明显看出，`radialHighwaysAccess`、`propTaxRate_per10K`、`nitrixOxide_pp10m`
    和 `pctLowerStatus` 与犯罪率之间具有最强的相关性。这表明犯罪率与这些自变量之间可能存在一种线性关系，值得进一步研究。'
- en: 'Exercise 2.02: Graphical Investigation of Linear Relationships Using Python'
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习 2.02：使用 Python 进行线性关系的图形化探究
- en: Scatter graphs fitted with a regression line are a quick way by which a data
    scientist can visualize a possible correlation between a dependent variable and
    an independent variable.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 配有回归线的散点图是数据科学家可以用来快速可视化因变量与自变量之间可能相关性的方式。
- en: The goal of the exercise is to use this technique to investigate any linear
    relationship that may exist between crime rate per capita and the median value
    of owner-occupied homes in towns in the city of Boston.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 这次练习的目标是使用该技术来调查波士顿市区内每个镇的犯罪率与自有住房的中位数价值之间可能存在的线性关系。
- en: 'The following steps will help you complete the exercise:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤将帮助你完成练习：
- en: 'Open a new Colab notebook file and execute the steps up to and including *Step
    11* from *Exercise 2.01*, *Loading and Preparing the Data for Analysis*. This
    is shown in the code blocks below, starting with the import statements:'
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的 Colab 笔记本文件，并执行到包括*步骤 11*在内的 *练习 2.01*，*加载和准备数据以进行分析*。如下代码块所示，从导入语句开始：
- en: '[PRE10]'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Loading and preprocessing the data:'
  id: totrans-176
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 加载和预处理数据：
- en: '[PRE11]'
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Setting up the test and train data:'
  id: totrans-178
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 设置测试数据和训练数据：
- en: '[PRE12]'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Now use the `subplots` function in `matplotlib` to define a canvas (assigned
    the variable name `fig` in the following code) and a graph object (assigned the
    variable name `ax` in the following code) in Python. You can set the size of the
    graph by setting the `figsize` (width = `10`, height = `6`) argument of the function:'
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在使用 `matplotlib` 中的 `subplots` 函数来定义画布（在以下代码中赋值给变量 `fig`）和图形对象（在以下代码中赋值给变量
    `ax`）。你可以通过设置 `figsize`（宽度 = `10`，高度 = `6`）参数来设置图形的大小：
- en: '[PRE13]'
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Do not execute the code yet.
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在不要执行代码。
- en: 'Use the `seaborn` function `regplot` to create the scatter plot. Do not execute
    this code cell yet; we will add more code to style the plot in the next step:'
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `seaborn` 函数 `regplot` 创建散点图。现在不要执行该代码单元，我们将在下一步中添加更多代码来对图形进行样式设置：
- en: '[PRE14]'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The function accepts arguments for the independent variable (`x`), the dependent
    variable (`y`), the confidence interval of the regression parameters (`ci`), which
    takes values from 0 to 100, the DataFrame that has `x` and `y` (`data`), a matplotlib
    graph object (`ax`), and others to control the aesthetics of the points on the
    graph. (In this case, the confidence interval is set to `None` – we will see more
    on confidence intervals later in the chapter.)
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 该函数接受独立变量（`x`）、依赖变量（`y`）、回归参数的置信区间（`ci`，其值在 0 到 100 之间）、包含 `x` 和 `y` 的 DataFrame（`data`）、matplotlib
    图形对象（`ax`）以及其他控制图形点的美学参数。（在此案例中，置信区间设置为 `None`——我们将在本章稍后讨论更多关于置信区间的内容。）
- en: 'In the same cell as step 3, set the `x` and `y` labels, the `fontsize` and
    `name` labels, the `x` and `y` limits, and the `tick` parameters of the matplotlib
    graph object (`ax`). Also, set the layout of the canvas to `tight`:'
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在与步骤 3 相同的单元格中，设置 `x` 和 `y` 标签，`fontsize` 和 `name` 标签，`x` 和 `y` 的范围，以及 matplotlib
    图形对象（`ax`）的 `tick` 参数。同时，将画布的布局设置为 `tight`：
- en: '[PRE15]'
  id: totrans-187
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Now execute the cell. You should get the following output:'
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在执行该单元格，你应该得到以下输出：
- en: '![Figure 2.13: Scatter graph with a regression line using Python'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.13：使用 Python 的回归线散点图](img/B15019_02_13.jpg)'
- en: '](img/B15019_02_13.jpg)'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_13.jpg)'
- en: 'Figure 2.13: Scatter graph with a regression line using Python'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.13：使用 Python 的回归线散点图
- en: If the exercise was followed correctly, the output must be the same as the graph
    in *Figure 2.3*. In *Figure 2.3*, this output was presented and used to introduce
    linear regression without showing how it was created. What this exercise has taught
    us is how to create a scatter graph and fit a regression line through it using
    Python.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 如果正确执行了练习，输出结果必须与*图 2.3*中的图形相同。在*图 2.3*中，展示了这个输出，并用来引入线性回归，但并没有展示它是如何创建的。这次练习教会了我们如何使用
    Python 创建散点图并拟合回归线。
- en: Note
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/34cITnk](https://packt.live/34cITnk).
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考[https://packt.live/34cITnk](https://packt.live/34cITnk)。
- en: You can also run this example online at [https://packt.live/2CA4NFG](https://packt.live/2CA4NFG).
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以在[https://packt.live/2CA4NFG](https://packt.live/2CA4NFG)上在线运行此示例。
- en: 'Exercise 2.03: Examining a Possible Log-Linear Relationship Using Python'
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习 2.03：使用 Python 检查可能的对数-线性关系
- en: In this exercise, we will use the logarithm function to transform variables
    and investigate whether this helps provide a better fit of the regression line
    to the data. We will also look at how to use confidence intervals by including
    a 95% confidence interval of the regression coefficients on the plot.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 在本次练习中，我们将使用对数函数来转换变量，并研究这是否有助于使回归线更好地拟合数据。我们还将查看如何通过在图表上包含回归系数的 95% 置信区间来使用置信区间。
- en: 'The following steps will help you to complete this exercise:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤将帮助你完成这个练习：
- en: Open a new Colab notebook file and execute all the steps up to *Step 11* from
    *Exercise 2.01*, *Loading and Preparing the Data for Analysis*.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的Colab笔记本文件，并执行直到*步骤 11*的所有步骤，来自*练习 2.01*，*加载和准备数据进行分析*。
- en: 'Use the `subplots` function in `matplotlib` to define a canvas and a graph
    object in Python:'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`matplotlib`中的`subplots`函数在Python中定义一个画布和图形对象：
- en: '[PRE16]'
  id: totrans-201
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Do not execute this code yet.
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在不要执行此代码。
- en: 'In the same code cell, use the logarithm function in `numpy` (`np.log`) to
    transform the dependent variable (`y`). This essentially creates a new variable,
    `log(y)`:'
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在同一代码单元格中，使用`numpy`中的对数函数（`np.log`）转换因变量（`y`）。这本质上创建了一个新变量`log(y)`：
- en: '[PRE17]'
  id: totrans-204
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Do not execute this code yet.
  id: totrans-205
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在不要执行此代码。
- en: Use the seaborn `regplot` function to create the scatter plot. Set the `regplot`
    function confidence interval argument (`ci`) to `95%`. This will calculate a `95%`
    confidence interval for the regression coefficients and have them plotted on the
    graph as a shaded area along the regression line.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用seaborn的`regplot`函数创建散点图。将`regplot`函数的置信区间参数（`ci`）设置为`95%`。这将计算回归系数的`95%`置信区间，并将其作为回归线上的阴影区域绘制在图中。
- en: '[PRE18]'
  id: totrans-207
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Continuing in the same cell, set the `x` and `y` labels, the `fontsize` and
    `name` labels, the `x` and `y` limits, and the `tick` parameters of the `matplotlib`
    graph object (`ax`). Also, set the layout of the canvas to `tight`:'
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在同一单元格中，设置`x`和`y`标签、`fontsize`和`name`标签、`x`和`y`的坐标范围，以及`matplotlib`图形对象（`ax`）的`tick`参数。同时，将画布的布局设置为`tight`：
- en: '[PRE19]'
  id: totrans-209
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Now execute this cell. The output is as follows:'
  id: totrans-210
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在执行此单元格。输出如下：
- en: '![Figure 2.14: Expected scatter plot with an improved linear regression line'
  id: totrans-211
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 2.14：改进的线性回归线的期望散点图'
- en: '](img/B15019_02_14.jpg)'
  id: totrans-212
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_14.jpg)'
- en: 'Figure 2.14: Expected scatter plot with an improved linear regression line'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.14：改进的线性回归线的期望散点图
- en: By completing this exercise, we have successfully improved our scatter plot.
    The regression line created in this activity fits the data better than what was
    created in *Exercise 2.02*, *Graphical Investigation of Linear Relationships Using
    Python*. You can see by comparing the two graphs, the regression line in the log
    graph more clearly matches the spread of the data points. We have solved the issue
    where the bottom third of the line had no points clustered around it. This was
    achieved by transforming the dependent variable with the logarithm function. The
    transformed dependent variable (log of crime rate per capita) has an improved
    linear relationship with the median value of owner-occupied homes than the untransformed
    variable.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 通过完成这个练习，我们成功地改善了我们的散点图。此活动中创建的回归线比*练习 2.02*中的回归线更好地拟合了数据，*使用Python进行线性关系的图形分析*。通过比较这两张图，可以看到在对数图中，回归线更清楚地与数据点的分布匹配。我们解决了回归线下三分之一部分没有点聚集的问题。这是通过使用对数函数转换因变量实现的。经过转换的因变量（人均犯罪率的对数）与自有住房的中位数相比，具有比未转换变量更好的线性关系。
- en: Note
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/3ay4aZS](https://packt.live/3ay4aZS).
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考[https://packt.live/3ay4aZS](https://packt.live/3ay4aZS)。
- en: You can also run this example online at [https://packt.live/324nN7R](https://packt.live/324nN7R).
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以在[https://packt.live/324nN7R](https://packt.live/324nN7R)上在线运行此示例。
- en: The Statsmodels formula API
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Statsmodels公式API
- en: In *Figure 2.3*, a solid line represents the relationship between the crime
    rate per capita and the median value of owner-occupied homes. But how can we obtain
    the equation that describes this line? In other words, how can we find the intercept
    and the slope of the straight-line relationship?
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图 2.3*中，实线表示人均犯罪率与自有住房的中位数之间的关系。那么，我们如何获得描述这条线的方程呢？换句话说，我们如何找到直线关系的截距和斜率？
- en: Python provides a rich **Application Programming Interface** **(API)** for doing
    this easily. The statsmodels formula API enables the data scientist to use the
    formula language to define regression models that can be found in statistics literature
    and many dedicated statistical computer packages.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: Python提供了丰富的**应用程序编程接口** **(API)**，使这一过程变得容易。Statsmodels公式API使数据科学家能够使用公式语言定义回归模型，这些模型可以在统计学文献中找到，并且在许多专门的统计计算软件包中都有应用。
- en: 'Exercise 2.04: Fitting a Simple Linear Regression Model Using the Statsmodels
    formula API'
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习 2.04：使用Statsmodels公式API拟合简单线性回归模型
- en: In this exercise, we examine a simple linear regression model where the crime
    rate per capita is the dependent variable and the median value of owner-occupied
    homes is the independent variable. We use the statsmodels formula API to create
    a linear regression model for Python to analyze.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在本练习中，我们检查一个简单的线性回归模型，其中犯罪率人均是因变量，而业主自住住房的中位数是自变量。我们使用 statsmodels 公式 API 来创建一个线性回归模型，以便在
    Python 中进行分析。
- en: 'The following steps will help you complete this exercise:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤将帮助你完成这个练习：
- en: Open a new Colab notebook file and import the required packages.
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的 Colab 笔记本文件并导入所需的包。
- en: '[PRE20]'
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Execute *Step 2* to *11* from *Exercise 2.01*, *Loading and Preparing the Data
    for Analysis*.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行 *第2步* 至 *第11步*，内容来自 *练习 2.01*，*加载并准备分析数据*。
- en: 'Define a linear regression model and assign it to a variable named `linearModel`:'
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个线性回归模型，并将其赋值给名为 `linearModel` 的变量：
- en: '[PRE21]'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: As you can see, we call the `ols` function of the statsmodels API and set its
    formula argument by defining a `patsy` formula string that uses the tilde (`~`)
    symbol to relate the dependent variable to the independent variable. Tell the
    function where to find the variables named, in the string, by assigning the data
    argument of the `ols` function to the DataFrame that contains your variables (`train_data`).
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如你所见，我们调用了 statsmodels API 的`ols`函数，并通过定义一个 `patsy` 公式字符串来设置其公式参数，该字符串使用波浪号（`~`）符号将因变量与自变量关联。通过将
    `ols` 函数的数据参数指向包含变量的 DataFrame（`train_data`），告诉函数在哪里查找这些在字符串中命名的变量。
- en: 'Call the .`fit` method of the model instance and assign the results of the
    method to a `linearModelResult` variable, as shown in the following code snippet:'
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调用模型实例的 `.fit` 方法，并将该方法的结果赋值给名为 `linearModelResult` 的变量，如下所示的代码片段：
- en: '[PRE22]'
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Print a summary of the results stored the `linearModelResult` variable by running
    the following code:'
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过运行以下代码，打印存储在 `linearModelResult` 变量中的结果摘要：
- en: '[PRE23]'
  id: totrans-233
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'You should get the following output:'
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该得到以下输出：
- en: '![Figure 2.15: A summary of the simple linear regression analysis results'
  id: totrans-235
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图 2.15：简单线性回归分析结果摘要'
- en: '](img/B15019_02_15.jpg)'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_15.jpg)'
- en: 'Figure 2.15: A summary of the simple linear regression analysis results'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.15：简单线性回归分析结果摘要
- en: If the exercise was correctly followed, then a model has been created with the
    `statsmodels` formula API. The `fit` method (`.fit()`) of the model object was
    called to fit the linear regression model to the data. What fitting here means
    is to estimate the regression coefficients (parameters) using the ordinary least
    squares method.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 如果练习正确执行，则已经使用 `statsmodels` 公式 API 创建了一个模型。调用了模型对象的 `fit` 方法（`.fit()`）来将线性回归模型拟合到数据中。这里的拟合意味着使用普通最小二乘法来估计回归系数（参数）。
- en: Note
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/3iJXXge](https://packt.live/3iJXXge).
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参考 [https://packt.live/3iJXXge](https://packt.live/3iJXXge)。
- en: You can also run this example online at [https://packt.live/2YbZ54v](https://packt.live/2YbZ54v).
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以在线运行这个例子，访问 [https://packt.live/2YbZ54v](https://packt.live/2YbZ54v)。
- en: Analyzing the Model Summary
  id: totrans-242
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分析模型摘要
- en: The `.fit` method provides many functions to explore its output. These include
    the `conf_int()`, `pvalues`, `tvalues`, and `summary()` parameters. With these
    functions, the parameters of the model, the confidence intervals, and the p-values
    and t-values for the analysis can be retrieved from the results. (The concept
    of p-values and t-values will be explained later in the chapter.)
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: '`.fit` 方法提供了许多函数来探索其输出。这些函数包括 `conf_int()`、`pvalues`、`tvalues` 和 `summary()`
    参数。通过这些函数，可以从结果中获取模型参数、置信区间以及分析的 p 值和 t 值。（p 值和 t 值的概念将在本章稍后解释。）'
- en: The syntax simply involves following the dot notation, after the variable name
    containing the results, with the relevant function name – for example, `linearModelResult.conf_int()`
    will output the confidence interval values. The handiest of them all is the `summary()`
    function, which presents a table of all relevant results from the analysis.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 语法非常简单，方法是紧随包含结果的变量名后使用点符号表示相关函数名称——例如，`linearModelResult.conf_int()` 将输出置信区间值。最方便的函数是
    `summary()`，它会展示分析的所有相关结果表格。
- en: In *Figure 2.15*, the output of the summary function used in *Exercise 2.04,
    Fitting a Simple Linear Regression Model Using the Statsmodels formula API,* is
    presented. The output of the summary function is divided, using double dashed
    lines, into three main sections.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *图 2.15* 中，展示了在 *练习 2.04，使用 Statsmodels 公式 API 拟合简单线性回归模型* 中使用的 summary 函数的输出。summary
    函数的输出被用双重虚线分为三个主要部分。
- en: In *Chapter 9*, *Interpreting a Machine Learning Model*, the results of the
    three sections will be treated in detail. However, it is important to comment
    on a few points here.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *第 9 章*，*解释机器学习模型* 中，将详细讨论这三部分的结果。然而，在此有几点需要特别说明。
- en: In the top-left corner of *Section 1* in *Figure 2.15*, we find the dependent
    variable in the model (`Dep. Variable`) printed and `crimeRatePerCapita` is the
    value for *Exercise 2.04*, *Fitting a Simple Linear Regression Model Using the
    Statsmodels formula API*. A statistic named R-squared with a value of `0.144`
    for our model is also provided in *Section 1*. The R-squared value is calculated
    by Python as a fraction (`0.144`) but it is to be reported in percentages so the
    value for our model is `14.4%` The R-squared statistic provides a measure of how
    much of the variability in the dependent variable (`crimeRatePerCapita`), our
    model is able to explain. It can be interpreted as a measure of how well our model
    fits the dataset. In *Section 2* of *Figure 2.15*, the intercept and the independent
    variable in our model is reported. The independent variable in our model is the
    median value of owner-occupied homes (`medianValue_Ks`).
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *图 2.15* 的 *第 1 部分* 左上角，我们可以看到模型中的因变量（`Dep. Variable`）以及 `crimeRatePerCapita`，这是
    *练习 2.04，使用 Statsmodels 公式 API 拟合简单线性回归模型* 的值。模型的 R-squared 统计量为 `0.144`，该值出现在
    *第 1 部分* 中。R-squared 值由 Python 计算得出，表示为一个小数（`0.144`），但通常以百分比形式报告，因此我们模型的值为 `14.4%`。R-squared
    统计量提供了一个衡量模型能解释因变量（`crimeRatePerCapita`）变异性的指标。它可以解读为模型与数据集拟合程度的度量。在 *图 2.15*
    的 *第 2 部分* 中，报告了模型中的截距和自变量。模型中的自变量是房主自住住房的中位数价值（`medianValue_Ks`）。
- en: In this same *Section 2*, just next to the intercept and the independent variable,
    is a column that reports the model coefficients (`coef`). The intercept and the
    coefficient of the independent variable are printed under the column labeled `coef`
    in the summary report that Python prints out. The intercept has a value of `11.2094`
    with the coefficient of the independent variable having a value of negative `0.3502`
    (`-0.3502`). If we choose to denote the dependent variable in our model (`crimeRatePerCapita`)
    as y and the independent variable (the median value of owner-occupied homes) as
    *x*, we have all the ingredients to write out the equation that defines our model.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在同一 *第 2 部分* 中，紧挨着截距和自变量，有一列报告了模型系数（`coef`）。截距和自变量的系数在 Python 打印的摘要报告中列于 `coef`
    栏下。截距的值为 `11.2094`，而自变量的系数为负 `0.3502`（`-0.3502`）。如果我们选择将模型中的因变量（`crimeRatePerCapita`）表示为
    y，自变量（房主自住住房的中位数价值）表示为 *x*，我们就有了写出定义我们模型的方程所需的所有元素。
- en: Thus, y ≈ 11.2094 - 0.3502 x, is the equation for our model. In *Chapter 9*,
    *Interpreting a Machine Learning Model*, what this model means and how it can
    be used will be discussed in full.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，y ≈ 11.2094 - 0.3502 x，是我们模型的方程。在 *第 9 章*，*解释机器学习模型* 中，将全面讨论该模型的意义及其应用方式。
- en: The Model Formula Language
  id: totrans-250
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型公式语言
- en: Python is a very powerful language liked by many developers. Since the release
    of version 0.5.0 of statsmodels, Python now provides a very competitive option
    for statistical analysis and modeling rivaling R and SAS.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: Python 是一种非常强大的编程语言，深受许多开发者喜爱。自从 statsmodels 发布了 0.5.0 版本后，Python 现在为统计分析和建模提供了一个非常有竞争力的选项，堪比
    R 和 SAS。
- en: This includes what is commonly referred to as the R-style formula language,
    by which statistical models can be easily defined. Statsmodels implements the
    R-style formula language by using the `Patsy` Python library internally to convert
    formulas and data to the matrices that are used in model fitting.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 这包括通常所说的 R 风格公式语言，通过这种语言可以轻松定义统计模型。Statsmodels 通过内部使用 `Patsy` Python 库实现 R 风格的公式语言，将公式和数据转换为用于模型拟合的矩阵。
- en: '*Figure 2.16* summarizes the operators used to construct the `Patsy` formula
    strings and what they mean:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 2.16* 总结了用于构建 `Patsy` 公式字符串的操作符及其含义：'
- en: '![Figure 2.16: A summary of the Patsy formula syntax and examples'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.16：Patsy 公式语法及示例总结'
- en: '](img/B15019_02_16.jpg)'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_16.jpg)'
- en: 'Figure 2.16: A summary of the Patsy formula syntax and examples'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.16：Patsy公式语法和示例摘要
- en: Intercept Handling
  id: totrans-257
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 截距处理
- en: In patsy formula strings, `string 1` is used to define the intercept of a model.
    Because the intercept is needed most of the time, `string 1` is automatically
    included in every formula string definition. You don't have to include it in your
    string to specify the intercept. It is there invisibly. If you want to delete
    the intercept from your model, however, then you can subtract one (-1) from the
    formula string and that will define a model that passes through the origin. For
    compatibility with other statistical software, `Patsy` also allows the use of
    the string zero (0) and negative one (-1) to be used to exclude the intercept
    from a model. What this means is that, if you include 0 or -1 on the right-hand
    side of your formula string, your model will have no intercept.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 在patsy公式字符串中，`string 1`用于定义模型的截距。因为截距在大多数情况下是必需的，所以`string 1`会自动包含在每个公式字符串定义中。您无需在字符串中显式包含它来指定截距，它是隐式存在的。然而，如果您想从模型中删除截距，可以从公式字符串中减去一个(-1)，这将定义一个通过原点的模型。为了与其他统计软件兼容，`Patsy`还允许使用字符串零（0）和负一（-1）来排除模型中的截距。这意味着，如果在公式字符串的右侧包含0或-1，您的模型将没有截距。
- en: 'Activity 2.01: Fitting a Log-Linear Model Using the Statsmodels Formula API'
  id: totrans-259
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动 2.01：使用Statsmodels公式API拟合对数线性模型
- en: You have seen how to use the statsmodels API to fit a linear regression model.
    In this activity, you are asked to fit a log-linear model. Your model should represent
    the relationship between the log-transformed dependent variable (log of crime
    rate per capita) and the median value of owner-occupied homes.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经了解了如何使用statsmodels API来拟合线性回归模型。在本活动中，您需要拟合一个对数线性模型。您的模型应该表示对数转换后的因变量（每人犯罪率的对数）与业主自住房屋的中位数值之间的关系。
- en: 'The steps to complete this activity are as follows:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此活动的步骤如下：
- en: Define a linear regression model and assign it to a variable. Remember to use
    the `log` function to transform the dependent variable in the formula string.
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个线性回归模型并将其赋值给一个变量。记得在公式字符串中使用`log`函数转换因变量。
- en: Call the `fit` method of the log-linear model instance and assign the results
    of the method to a variable.
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调用对数线性模型实例的`fit`方法，并将该方法的结果赋值给一个变量。
- en: Print a summary of the results and analyze the output.
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印结果摘要并分析输出。
- en: 'Your output should look like the following figure:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 您的输出应如下图所示：
- en: '![Figure 2.17: A log-linear regression of crime rate per capita on the median
    value'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.17：按每人犯罪率对房屋中位数值的对数线性回归'
- en: of owner-occupied homes
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 业主自住房屋
- en: '](img/B15019_02_17.jpg)'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_17.jpg)'
- en: 'Figure 2.17: A log-linear regression of crime rate per capita on the median
    value of owner-occupied homes'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.17：按业主自住房屋中位数值对每人犯罪率的对数线性回归
- en: Note
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'The solution to this activity can be found here: [https://packt.live/2GbJloz](https://packt.live/2GbJloz).'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 本活动的解决方案可以在这里找到：[https://packt.live/2GbJloz](https://packt.live/2GbJloz)。
- en: Multiple Regression Analysis
  id: totrans-272
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 多元回归分析
- en: In the exercises and activity so far, we have used only one independent variable
    in our regression analysis. In practice, as we have seen with the Boston Housing
    dataset, processes and phenomena of analytic interest are rarely influenced by
    only one feature. To be able to model the variability to a higher level of accuracy,
    therefore, it is necessary to investigate all the independent variables that may
    contribute significantly toward explaining the variability in the dependent variable.
    Multiple regression analysis is the method that is used to achieve this.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，在这些练习和活动中，我们只使用了一个自变量进行回归分析。在实践中，正如我们在波士顿住房数据集中看到的那样，分析中感兴趣的过程和现象很少仅受单一特征的影响。为了能够更准确地建模变异性，因此，有必要研究所有可能对解释因变量的变异性具有显著贡献的自变量。因此，多元回归分析是实现这一目标的方法。
- en: 'Exercise 2.05: Fitting a Multiple Linear Regression Model Using the Statsmodels
    Formula API'
  id: totrans-274
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习 2.05：使用Statsmodels公式API拟合多元线性回归模型
- en: In this exercise, we will be using the plus operator (`+`) in the `patsy` formula
    string to define a linear regression model that includes more than one independent
    variable.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 在本练习中，我们将使用加法运算符（`+`）在`patsy`公式字符串中定义一个包含多个自变量的线性回归模型。
- en: 'To complete this activity, run the code in the following steps in your Colab
    notebook:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 要完成此活动，请在您的Colab笔记本中运行以下步骤中的代码：
- en: Open a new Colab notebook file and import the required packages.
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的Colab笔记本文件并导入所需的包。
- en: '[PRE24]'
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Execute *Step 2* to *11* from *Exercise 2.01*, *Loading and Preparing the Data
    for Analysis*.
  id: totrans-279
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行*步骤 2*到*步骤 11*，来自*练习 2.01*，*加载和准备数据进行分析*。
- en: 'Use the plus operator (`+`) of the Patsy formula language to define a linear
    model that regresses `crimeRatePerCapita` on `pctLowerStatus`, `radialHighwaysAccess`,
    `medianValue_Ks`, and `nitrixOxide_pp10m` and assign it to a variable named `multiLinearModel`.
    Use the Python line continuation symbol (`\`) to continue your code on a new line
    should you run out of space:'
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Patsy公式语言的加号操作符（`+`）定义一个线性模型，将`crimeRatePerCapita`对`pctLowerStatus`、`radialHighwaysAccess`、`medianValue_Ks`和`nitrixOxide_pp10m`进行回归，并将其分配给名为`multiLinearModel`的变量。如果代码行不够长，使用Python的行续符号（`\`）继续编写代码：
- en: '[PRE25]'
  id: totrans-281
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Call the `fit` method of the model instance and assign the results of the method
    to a variable:'
  id: totrans-282
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调用模型实例的`fit`方法，并将该方法的结果分配给一个变量：
- en: '[PRE26]'
  id: totrans-283
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Print a summary of the results stored the variable created in *Step 3*:'
  id: totrans-284
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印出*步骤 3*中创建的变量中存储的结果摘要：
- en: '[PRE27]'
  id: totrans-285
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The output is as follows:'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Figure 2.18: A summary of multiple linear regression results'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 2.18：多元线性回归结果摘要'
- en: '](img/B15019_02_18.jpg)'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B15019_02_18.jpg)'
- en: 'Figure 2.18: A summary of multiple linear regression results'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.18：多元线性回归结果摘要
- en: Note
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: To access the source code for this specific section, please refer to [https://packt.live/34cJgOK](https://packt.live/34cJgOK).
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此特定部分的源代码，请参见[https://packt.live/34cJgOK](https://packt.live/34cJgOK)。
- en: You can also run this example online at [https://packt.live/3h1CKOt](https://packt.live/3h1CKOt).
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在[https://packt.live/3h1CKOt](https://packt.live/3h1CKOt)在线运行这个示例。
- en: If the exercise was correctly followed, *Figure 2.18* will be the result of
    the analysis. In *Activity 2.01*, the R-squared statistic was used to assess the
    model for goodness of fit. When multiple independent variables are involved, the
    goodness of fit of the model created is assessed using the adjusted R-squared
    statistic.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 如果正确完成了练习，*图 2.18*将是分析的结果。在*活动 2.01*中，使用了R平方统计量来评估模型的拟合优度。当涉及多个自变量时，使用调整后的R平方统计量来评估所创建模型的拟合优度。
- en: The adjusted R-squared statistic considers the presence of the extra independent
    variables in the model and corrects for inflation of the goodness of fit measure
    of the model, which is just caused by the fact that more independent variables
    are being used to create the model.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 调整后的R平方统计量考虑了模型中额外自变量的存在，并对模型拟合优度的膨胀进行了修正，这种膨胀只是因为模型中使用了更多的自变量。
- en: The lesson we learn from this exercise is the improvement in the adjusted R-squared
    value in *Section 1* of *Figure 2.18*. When only one independent variable was
    used to create a model that seeks to explain the variability in `crimeRatePerCapita`
    in *Exercise 2.04*, *Fitting a Simple Linear Regression Model Using the Statsmodels
    formula API*, the R-squared value calculated was only `14.4` percent. In this
    exercise, we used four independent variables. The model that was created improved
    the adjusted R-squared statistic to `39.1` percent, an increase of `24.7` percent.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从这个练习中学到的经验是，*图 2.18*中*第 1 节*的调整后R平方值有所提高。当仅使用一个自变量来创建模型以解释*练习 2.04*中`crimeRatePerCapita`的变异性时，计算出的R平方值仅为`14.4`百分比。而在本练习中，我们使用了四个自变量。创建的模型将调整后的R平方统计量提高到了`39.1`百分比，增加了`24.7`百分比。
- en: We learn that the presence of independent variables that are correlated to a
    dependent variable can help explain the variability in the independent variable
    in a model. But it is clear that a considerable amount of variability, about `60.9`
    percent, in the dependent variable is still not explained by our model.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 我们了解到，自变量与因变量之间的相关性可以帮助解释模型中自变量的变异性。但显然，因变量中的相当一部分变异性，约`60.9`百分比，仍然没有被我们的模型解释。
- en: There is still room for improvement if we want a model that does a good job
    of explaining the variability we see in `crimeRatePerCapita`. In *Section 2* of
    *Figure 2.18*, the intercept and all the independent variables in our model are
    listed together with their coefficients. If we denote `pctLowerStatus` by x1,
    `radialHighwaysAccess` by x2, `medianValue_Ks` by x3 , and `nitrixOxide_pp10m`
    by x4, a mathematical expression for the model created can be written as y ≈ 0.8912+0.1028x1+0.4948x2-0.1103x3-2.1039x4\.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们希望模型能够很好地解释`crimeRatePerCapita`中的变异性，仍然有改进的空间。在*图2.18*的*第2节*中，我们列出了模型中的截距和所有自变量，并附上了它们的系数。如果我们将`pctLowerStatus`表示为x1，`radialHighwaysAccess`表示为x2，`medianValue_Ks`表示为x3，`nitrixOxide_pp10m`表示为x4，那么创建的模型的数学表达式可以写为
    y ≈ 0.8912 + 0.1028x1 + 0.4948x2 - 0.1103x3 - 2.1039x4。
- en: The expression just stated defines the model created in this exercise, and it
    is comparable to the expression for multiple linear regression provided in *Figure
    2.5* earlier.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 上述表达式定义了在本练习中创建的模型，它可以与*图2.5*中早先提供的多元线性回归的表达式进行比较。
- en: Assumptions of Regression Analysis
  id: totrans-299
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 回归分析的假设
- en: Due to the parametric nature of linear regression analysis, the method makes
    certain assumptions about the data it analyzes. When these assumptions are not
    met, the results of the regression analysis may be misleading to say the least.
    It is, therefore, necessary to check any analysis work to ensure the regression
    assumptions are not violated.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 由于线性回归分析的参数化特性，该方法对所分析的数据做出了一些假设。当这些假设不成立时，回归分析的结果可能会误导我们，至少是这样。因此，检查分析工作以确保回归假设没有被违反是必要的。
- en: 'Let''s review the main assumptions of linear regression analysis that we must
    ensure are met in order to develop a good model:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾一下线性回归分析的主要假设，这些假设必须得到满足，才能开发出一个良好的模型：
- en: The relationship between the dependent and independent variables must be linear
    and additive.
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因变量与自变量之间的关系必须是线性且可加的。
- en: This means that the relationship must be of the straight-line type, and if there
    are many independent variables involved, thus multiple linear regression, the
    weighted sum of these independent variables must be able to explain the variability
    in the dependent variable.
  id: totrans-303
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这意味着关系必须是直线型的，如果涉及多个自变量，则是多元线性回归，这些自变量的加权和必须能够解释因变量的变异性。
- en: The residual terms (ϵi) must be normally distributed. This is so that the standard
    error of estimate is calculated correctly. This standard error of estimate statistic
    is used to calculate t-values, which, in turn, are used to make statistical significance
    decisions. So, if the standard error of estimate is wrong, the t-values will be
    wrong and so are the statistical significance decisions that follow on from the
    p-values. The t-values that are calculated using the standard error of estimate
    are also used to construct confidence intervals for the population regression
    parameters. If the standard error is wrong, then the confidence intervals will
    be wrong as well.
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 残差项（ϵi）必须服从正态分布。这样可以确保估计的标准误差计算正确。这个估计标准误差统计量用于计算t值，而t值又用于做出统计显著性决策。因此，如果估计标准误差是错误的，那么t值也会错误，随后根据p值做出的统计显著性决策也会错误。使用估计标准误差计算的t值还用于构建总体回归参数的置信区间。如果标准误差错误，那么置信区间也会错误。
- en: The residual terms (ϵi) must have constant variance (homoskedasticity). When
    this is not the case, we have the heteroskedasticity problem. This point refers
    to the variance of the residual terms. It is assumed to be constant. We assume
    that each data point in our regression analysis contributes equal explanation
    to the variability we are seeking to model. If some data points contribute more
    explanation than others, our regression line will be pulled toward the points
    with more information. The data points will not be equally scattered around our
    regression line. The error (variance) about the regression line, in that case,
    will not be constant.
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 残差项（ϵi）必须具有恒定的方差（同方差性）。当情况不是这样时，我们就面临异方差性问题。这个问题指的是残差项的方差。我们假设它是恒定的。我们假设回归分析中的每个数据点对我们希望建模的变异性贡献相等。如果某些数据点比其他数据点贡献更多的解释，我们的回归线将被拉向信息更多的点。这些数据点不会均匀地分布在回归线周围。在这种情况下，回归线的误差（方差）将不是恒定的。
- en: The residual terms (ϵi) must not be correlated. When there is correlation in
    the residual terms, we have the problem known as autocorrelation. Knowing one
    residual term, must not give us any information about what the next residual term
    will be. Residual terms that are autocorrelated are unlikely to have a normal
    distribution.
  id: totrans-306
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 残差项（ϵi）必须没有相关性。当残差项之间存在相关性时，我们就遇到了所谓的自相关问题。知道一个残差项的值，不能帮助我们预测下一个残差项的值。自相关的残差项不太可能符合正态分布。
- en: There must not be correlation among the independent variables. When the independent
    variables are correlated among themselves, we have a problem called multicollinearity.
    This would lead to developing a model with coefficients that have values that
    depend on the presence of other independent variables. In other words, we will
    have a model that will change drastically should a particular independent variable
    be dropped from the model for example. A model like that will be inaccurate.
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 自变量之间不得存在相关性。当自变量之间相互相关时，我们就遇到了一个问题，称为多重共线性。这将导致我们开发出一个模型，其中的系数值依赖于其他自变量的存在。换句话说，如果某个特定的自变量从模型中移除，模型可能会发生剧烈变化。这样的模型将是不准确的。
- en: 'Activity 2.02: Fitting a Multiple Log-Linear Regression Model'
  id: totrans-308
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 活动2.02：拟合多元对数线性回归模型
- en: A log-linear regression model you developed earlier was able to explain about
    24% of the variability in the transformed crime rate per capita variable (see
    the values in *Figure 2.17*). You are now asked to develop a log-linear multiple
    regression model that will likely explain 80% or more of the variability in the
    transformed dependent variable. You should use independent variables from the
    Boston Housing dataset that have a correlation coefficient of 0.4 or more.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 你之前开发的对数线性回归模型能够解释转化后的每人犯罪率变量约24%的变化性（见*图2.17*中的数值）。现在你被要求开发一个对数线性多元回归模型，该模型可能会解释转化后的因变量80%或更多的变化性。你应该使用波士顿住房数据集中相关系数为0.4或更高的自变量。
- en: You are also encouraged to include the interaction of these variables to order
    two in your model. You should produce graphs and data that show that your model
    satisfies the assumptions of linear regression.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也鼓励你在模型中包括这些变量的二阶交互项。你应该生成图表和数据，证明你的模型满足线性回归的假设。
- en: 'The steps are as follows:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤如下：
- en: Define a linear regression model and assign it to a variable. Remember to use
    the `log` function to transform the dependent variable in the formula string,
    and also include more than one independent variable in your analysis.
  id: totrans-312
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个线性回归模型并将其赋值给一个变量。记得在公式字符串中使用`log`函数来转换因变量，并且在分析中包括多个自变量。
- en: Call the `fit` method of the model instance and assign the results of the method
    to a new variable.
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调用模型实例的`fit`方法，并将该方法的结果赋值给一个新变量。
- en: Print a summary of the results and analyze your model.
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印结果的摘要并分析你的模型。
- en: 'Your output should appear as shown:'
  id: totrans-315
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你的输出应该如图所示：
- en: '![Figure 2.19: Expected OLS results'
  id: totrans-316
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图2.19：预期的OLS结果'
- en: '](img/B15019_02_19.jpg)'
  id: totrans-317
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/B15019_02_19.jpg)'
- en: 'Figure 2.19: Expected OLS results'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.19：预期的OLS结果
- en: Note
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'The solution to this activity can be found here: [https://packt.live/2GbJloz](https://packt.live/2GbJloz).'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 此活动的解决方案可以在这里找到：[https://packt.live/2GbJloz](https://packt.live/2GbJloz)。
- en: Explaining the Results of Regression Analysis
  id: totrans-321
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 解释回归分析的结果
- en: A primary objective of regression analysis is to find a model that explains
    the variability observed in a dependent variable of interest. It is, therefore,
    very important to have a quantity that measures how well a regression model explains
    this variability. The statistic that does this is called R-squared (R2). Sometimes,
    it is also called the coefficient of determination. To understand what it actually
    measures, we need to take a look at some other definitions.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 回归分析的一个主要目标是找到一个能够解释因变量变化性的模型。因此，非常重要的是要有一个量度，能够衡量回归模型解释变化性的程度。这个统计量被称为R平方（R2）。有时，它也被称为决定系数。为了理解它到底衡量了什么，我们需要查看一些其他的定义。
- en: The first of these is called the **Total Sum of Squares** (**TSS**). TSS gives
    us a measure of the total variance found in the dependent variable from its mean
    value.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 其中第一个是被称为**总平方和**（**TSS**）的量。TSS为我们提供了因变量相对于其均值的总方差的度量。
- en: The next quantity is called the **Regression sum of squares** (**RSS**). This
    gives us a measure of the amount of variability in the dependent variable that
    our model explains. If you imagine us creating a perfect model with no errors
    in prediction, then TSS will be equal to RSS. Our hypothetically perfect model
    will provide an explanation for all the variability we see in the dependent variable
    with respect to the mean value. In practice, this rarely happens. Instead, we
    create models that are not perfect, so RSS is less than TSS. The missing amount
    by which RSS falls short of TSS is the amount of variability in the dependent
    variable that our regression model is not able to explain. That quantity is the
    **Error Sum of Squares** (**ESS**), which is essentially the sum of the residual
    terms of our model.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个量称为**回归平方和**（**RSS**）。它衡量了我们模型解释的因变量的变异程度。如果你想象我们创建了一个完美的模型，预测没有任何误差，那么TSS将等于RSS。我们假设的完美模型将解释因变量相对于均值的所有变异。在实践中，这种情况很少发生。相反，我们创建的模型并不完美，因此RSS小于TSS。RSS与TSS的差额是回归模型无法解释的因变量变异量。这个量被称为**误差平方和**（**ESS**），本质上是我们模型的残差项之和。
- en: R-squared is the ratio of RSS to TSS. This, therefore, gives us a percentage
    measure of how much variability our regression model is able to explain compared
    to the total variability in the dependent variable with respect to the mean. R2
    will become smaller when RSS grows smaller and vice versa. In the case of simple
    linear regression where the independent variable is one, R2 is enough to decide
    the overall fit of the model to the data.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: R平方是RSS与TSS的比率。因此，它给出了我们的回归模型相对于因变量均值总变异量能够解释的变异百分比。当RSS变小，R2也会变小，反之亦然。在简单线性回归中，当自变量只有一个时，R2足以决定模型与数据的整体拟合程度。
- en: There is a problem, however, when it comes to multiple linear regression. The
    R2 is known to be sensitive to the addition of extra independent variables to
    the model, even if the independent variable is only slightly correlated to the
    dependent variable. Its addition will increase R2\. Depending on R2 alone to make
    a decision between models defined for the same dependent variable will lead to
    chasing a complex model that has many independent variables in it. This complexity
    is not helpful practically. In fact, it may lead to a problem in modeling called
    overfitting.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，当涉及到多元线性回归时，存在一个问题。R2已知对模型中加入额外自变量非常敏感，即使该自变量与因变量只有微弱的相关性。它的加入会增加R2。仅仅依赖R2来在为同一个因变量定义的模型之间做决策，最终会导致追求一个包含许多自变量的复杂模型。这种复杂性在实践中没有帮助。事实上，它可能会导致一个叫做过拟合的建模问题。
- en: To overcome this problem, the Adjusted R2 (denoted *Adj. R-Squared* on the output
    of statsmodels) is used to select between models defined for the same dependent
    variable. Adjusted R2 will increase only when the addition of an independent variable
    to the model contributes to explaining the variability in the dependent variable
    in a meaningful way.
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 为了克服这个问题，使用了调整后的R2（在statsmodels的输出中表示为*Adj. R-Squared*），用来在为同一个因变量定义的模型之间进行选择。只有当自变量的加入有意义地帮助解释因变量的变异时，调整后的R2才会增加。
- en: In *Activity 2.02*, *Fitting a Multiple Log-Linear Regression Model*, our model
    explained 88 percent of the variability in the transformed dependent variable,
    which is really good. We started with simple models and worked to improve the
    fit of the models using different techniques. All the exercises and activities
    done in this chapter have pointed out that the regression analysis workflow is
    iterative. You start by plotting to get a visual picture and follow from there
    to improve upon the model you finally develop by using different techniques. Once
    a good model has been developed, the next step is to validate the model statistically
    before it can be used for making a prediction or acquiring insight for decision
    making. Next, let's discuss what validating the model statistically means.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 在*活动2.02*中，*拟合多个对数线性回归模型*，我们的模型解释了转化后因变量88%的变异，这非常好。我们从简单的模型开始，利用不同的技术来改进模型的拟合度。本章中所有的练习和活动都强调回归分析工作流是迭代的。你从绘图开始，获得一个可视化图像，然后根据这个图像继续改进最终开发的模型，使用不同的技术。一旦开发出一个好的模型，下一步就是在统计上验证该模型，然后才能用它进行预测或获取决策支持。接下来，我们来讨论在统计上验证模型意味着什么。
- en: Regression Analysis Checks and Balances
  id: totrans-329
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 回归分析中的制衡
- en: In the preceding discussions, we used the R-squared and the Adjusted R-squared
    statistics to assess the goodness of fit of our models. While the R-squared statistic
    provides an estimate of the strength of the relationship between a model and the
    dependent variable(s), it does not provide a formal statistical hypothesis test
    for this relationship.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的讨论中，我们使用了R平方值和调整后的R平方值统计量来评估模型的拟合优度。尽管R平方值统计量提供了模型与因变量之间关系强度的估计，但它并没有提供该关系的正式统计假设检验。
- en: What do we mean by a formal statistical hypothesis test for a relationship between
    a dependent variable and some independent variable(s) in a model?
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，什么是针对模型中因变量与某些自变量之间关系的正式统计假设检验呢？
- en: We must recall that, to say an independent variable has a relationship with
    a dependent variable in a model, the coefficient (β) of that independent variable
    in the regression model must *not* be zero (0). It is well and good to conduct
    a regression analysis with our Boston Housing dataset and find an independent
    variable (say the median value of owner-occupied homes) in our model to have a
    nonzero coefficient (β).
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 我们必须记住，要说一个自变量与回归模型中的因变量有关系，该自变量的回归系数（β）必须是*非零*（不等于0）。如果我们用波士顿住房数据集进行回归分析，找到一个自变量（比如拥有者自住房屋的中位数）在模型中有一个非零的回归系数（β），那是很好且正确的。
- en: The question is will we (or someone else) find the median value of owner-occupied
    homes as having a nonzero coefficient (β), if we repeat this analysis using a
    different sample of Boston Housing dataset taken at different locations or times?
    Is the nonzero coefficient for the median value of owner-occupied homes, found
    in our analysis, specific to our sample dataset and zero for any other Boston
    Housing data sample that may be collected? Did we find the nonzero coefficient
    for the median value of owner-occupied homes by chance? These questions are what
    hypothesis tests seek to clarify. We cannot be a hundred percent sure that the
    nonzero coefficient (β) of an independent variable is by chance or not. But hypothesis
    testing gives a framework by which we can calculate the level of confidence where
    we can say that the nonzero coefficient (β) found in our analysis is not by chance.
    This is how it works.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 问题是，如果我们使用不同位置或时间的波士顿住房数据集的不同样本重复此分析，我们是否（或其他人）会发现拥有者自住房屋的中位数具有非零的回归系数（β）？在我们的分析中发现的拥有者自住房屋中位数的非零回归系数，是特定于我们的样本数据集，还是对于任何其他波士顿住房数据样本来说都是零？我们是否偶然发现了拥有者自住房屋中位数的非零回归系数？这些问题是假设检验要解决的。我们无法百分之百确定一个自变量的非零回归系数（β）是否是偶然的，但假设检验提供了一个框架，让我们能够计算出一个置信度水平，以便我们可以说，在我们的分析中发现的非零回归系数（β）不是偶然的。这就是它的工作原理。
- en: We first agree a level of risk (α-value or α-risk or Type I error) that may
    exist that the nonzero coefficient (β) may have been found by chance. The idea
    is that we are happy to live with this level of risk of making the error or mistake
    of claiming that the coefficient (β) is nonzero when in fact it is zero.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先确定一个风险水平（α值或α风险或第一类错误），即回归系数（β）可能是偶然发现的风险。我们接受在这个风险水平下，错误地认为回归系数（β）是非零的，而实际上它是零。
- en: In most practical analyses, the α-value is set at 0.05, which is 5 in percentage
    terms. When we subtract the α-risk from one (1-α) we have a measure of the level
    of confidence that we have that the nonzero coefficient (β) found in our analysis
    did not come about by chance. So, our confidence level is 95% at 5% α-value.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数实际分析中，α值设定为0.05，即百分比上的5%。当我们从1中减去α风险（1-α）时，我们得到了一个度量，表示我们对在分析中发现的非零回归系数（β）不是由偶然造成的置信度。因此，我们的置信水平在5%
    α值下是95%。
- en: We then go ahead to calculate a probability value (usually called the p-value),
    which gives us a measure of the α-risk related to the coefficient (β) of interest
    in our model. We compare the p-value to our chosen α-risk, and if the p-value
    is less than the agreed α-risk, we reject the idea that the nonzero coefficient
    (β) was found by chance. This is because the risk of making a mistake of claiming
    the coefficient (β) is nonzero is within the acceptable limit we set for ourselves
    earlier.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们计算一个概率值（通常称为p值），它为我们提供了模型中感兴趣的回归系数（β）相关的α风险的度量。我们将p值与我们选择的α风险进行比较，如果p值小于我们设定的α风险，我们就拒绝认为非零回归系数（β）是偶然发现的观点。这是因为我们所设定的接受限度内，错误地认为回归系数（β）非零的风险是可以接受的。
- en: 'Another way of stating that the nonzero coefficient (β) was NOT found by chance
    is to say that the coefficient (β) is statistically significant or that we reject
    the null hypothesis (the null hypothesis being that there is no relationship between
    the variables being studied). We apply these ideas of statistical significance
    to our models in two stages:'
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种说法是，非零系数（β）不是偶然发现的，我们可以说该系数（β）具有统计显著性，或者我们拒绝零假设（零假设为研究的变量之间没有关系）。我们将这些统计显著性的概念应用于我们的模型中，分为两个阶段：
- en: In stage one, we validate the model as a whole statistically.
  id: totrans-338
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第一阶段，我们整体验证模型的统计显著性。
- en: In stage two, we validate the independent variables in our model individually
    for statistical significance.
  id: totrans-339
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第二阶段，我们单独验证模型中的每个自变量的统计显著性。
- en: The F-test
  id: totrans-340
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: F检验
- en: The F-test is what validates the overall statistical significance of the strength
    of the relationship between a model and its dependent variables. If the p-value
    for the F-test is less than the chosen α-level (0.05, in our case), we reject
    the null hypothesis and conclude that the model is statistically significant overall.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: F检验用于验证模型与其因变量之间关系的整体统计显著性。如果F检验的p值小于所选的α水平（在我们的例子中是0.05），我们拒绝零假设，并得出结论，模型在整体上具有统计显著性。
- en: When we fit a regression model, we generate an F-value. This value can be used
    to determine whether the test is statistically significant. In general, an increase
    in R2 increases the F-value. This means that the larger the F-value, the better
    the chances of the overall statistical significance of a model.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们拟合回归模型时，会生成一个F值。这个值可以用来判断测试是否具有统计学意义。通常，R²的增加会导致F值的增加。这意味着，F值越大，模型的整体统计显著性越有可能。
- en: A good F-value is expected to be larger than **one**. The model in *Figure 2.19*
    has an F-statistic value of 261.5, which is larger than one, and a p-value (Prob
    (F-statistic)) of approximately zero. The risk of making a mistake and rejecting
    the null hypothesis when we should not (known as a Type I error in hypothesis
    testing), is less than the 5% limit we chose to live with at the beginning of
    the hypothesis test. Because the p-value is less than 0.05, we reject the null
    hypothesis about our model in *Figure 2.19*. Therefore, we state that the model
    is statistically significant at the chosen 95% confidence level.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 一个好的F值应该大于**1**。*图2.19*中的模型F统计量值为261.5，超过了1，并且其p值（Prob (F-statistic)）接近零。我们所选择的5%错误容忍限度小于犯错的风险（即，当我们不应该拒绝零假设时错误地拒绝了它，这被称为假设检验中的I型错误）。因为p值小于0.05，我们拒绝了*图2.19*模型的零假设。因此，我们可以说该模型在所选的95%置信水平下具有统计显著性。
- en: The t-test
  id: totrans-344
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: t检验
- en: Once a model has been determined to be statistically significant globally, we
    can proceed to examine the significance of individual independent variables in
    the model. In *Figure 2.19*, the p-values (denoted `p>|t|` in *Section 2*) for
    the independent variables are provided. The p-values were calculated using the
    t-values also given on the summary results. The process is not different from
    what was just discussed for the global case. We compare the p-values to the 0.05
    α-level. If an independent variable has a p-value of less than 0.05, the independent
    variable is statistically significant in our model in explaining the variability
    in the dependent variable. If the p-value is 0.05 or higher, the particular independent
    variable (or term) in our model is not statistically significant. What this means
    is that that term in our model does not contribute toward explaining the variability
    in our dependent variable statistically. A close inspection of *Figure 2.19* shows
    that some of the terms have p-values larger than 0.05\. These terms don't contribute
    in a statistically significant way of explaining the variability in our transformed
    dependent variable. To improve this model, those terms will have to be dropped
    and a new model tried. It is clear by this point that the process of building
    a regression model is truly iterative.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦确定模型在整体上具有统计显著性，我们可以继续检验模型中各个自变量的显著性。在*图 2.19*中，提供了自变量的 p 值（在*第 2 节*中用 `p>|t|`
    表示）。这些 p 值是通过摘要结果中给出的 t 值计算得出的。这个过程与之前讨论的全局显著性检验没有什么不同。我们将 p 值与 0.05 的 α 水平进行比较。如果某个自变量的
    p 值小于 0.05，则该自变量在解释因变量的变异性方面在统计上是显著的。如果 p 值大于或等于 0.05，则该自变量（或项）在我们的模型中并不具有统计显著性。这意味着该项在我们的模型中不能为解释因变量的变异性提供统计学上的贡献。仔细观察*图
    2.19*，可以看到一些项的 p 值大于 0.05。这些项在统计学上对解释我们转化后的因变量的变异性没有显著贡献。为了改进这个模型，需要删除这些项，并尝试一个新的模型。到此为止，我们已经清楚地认识到，建立回归模型的过程是一个真正的迭代过程。
- en: Summary
  id: totrans-346
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概述
- en: This chapter introduced the topic of linear regression analysis using Python.
    We learned that regression analysis, in general, is a supervised machine learning
    or data science problem. We learned about the fundamentals of linear regression
    analysis, including the ideas behind the method of least squares. We also learned
    about how to use the pandas Python module to load and prepare data for exploration
    and analysis.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 本章介绍了使用 Python 进行线性回归分析的主题。我们了解到回归分析通常是一个监督式机器学习或数据科学问题。我们学习了线性回归分析的基本原理，包括最小二乘法背后的思想。我们还学习了如何使用
    pandas Python 模块加载和准备数据进行探索和分析。
- en: We explored how to create scatter graphs of bivariate data and how to fit a
    line of best fit through them. Along the way, we discovered the power of the statsmodels
    module in Python. We explored how to use it to define simple linear regression
    models and to solve the model for the relevant parameters. We also learned how
    to extend that to situations where the number of independent variables is more
    than one – multiple linear regressions. We investigated approaches by which we
    can transform a non-linear relation between a dependent and independent variable
    so that a non-linear problem can be handled using linear regression, introduced
    because of the transformation. We took a closer look at the statsmodels formula
    language. We learned how to use it to define a variety of linear models and to
    solve for their respective model parameters.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 我们探索了如何创建双变量数据的散点图，并学习了如何通过这些图形拟合最佳拟合线。在这个过程中，我们发现了 Python 中 statsmodels 模块的强大功能。我们探索了如何使用它来定义简单线性回归模型，并求解相关参数。我们还学习了如何将这种方法扩展到自变量超过一个的情况——多元线性回归。我们研究了通过某些方法将因变量与自变量之间的非线性关系转化为线性问题，从而使用线性回归处理非线性问题，这种转化带来了新的可能性。我们深入探讨了
    statsmodels 公式语言，学习了如何使用它来定义各种线性模型并求解它们的相应模型参数。
- en: We continued to learn about the ideas underpinning model goodness of fit. We
    discussed the R-squared statistic as a measure of the goodness of fit for regression
    models. We followed our discussions with the basic concepts of statistical significance.
    We learned about how to validate a regression model globally using the F-statistic,
    which Python calculates for us. We also examined how to check for the statistical
    significance of individual model coefficients using t-tests and their associated
    p-values. We reviewed the assumptions of linear regression analysis and how they
    impact on the validity of any regression analysis work.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 我们继续学习模型拟合优度背后的思想。我们讨论了R平方统计量，作为回归模型拟合优度的度量。接着，我们讨论了统计显著性的基本概念。我们学习了如何使用F统计量对回归模型进行全局验证，而这项工作由Python为我们完成。我们还检查了如何使用t检验及其关联的p值来检验单个模型系数的统计显著性。我们回顾了线性回归分析的假设以及它们如何影响回归分析工作的有效性。
- en: We will now move on from regression analysis, and *Chapter 3*, *Binary Classification*,
    and *Chapter 4*, *Multiclass Classification with RandomForest*, will discuss binary
    and multi-label classification, respectively. These chapters will introduce the
    techniques needed to handle supervised data science problems where the dependent
    variable is of the categorical data type.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将从回归分析转向*第3章*，*二分类*，以及*第4章*，*使用随机森林的多分类*，它们分别讨论二分类和多标签分类。这些章节将介绍处理监督学习问题所需的技术，其中因变量是分类数据类型。
- en: Regression analysis will be revisited when the important topics of model performance
    improvement and interpretation are given a closer look later in the book. In *Chapter
    8*, *Hyperparameter Tuning*, we will see how to use k-nearest neighbors and as
    another method for carrying out regression analysis. We will also be introduced
    to ridge regression, a linear regression method that is useful for situations
    where there are a large number of parameters.
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 回归分析将在本书后续部分深入讨论模型性能改进和解释时再次出现。在*第8章*，*超参数调优*中，我们将看到如何使用k-最近邻算法作为进行回归分析的另一种方法。我们还将介绍岭回归，这是一种线性回归方法，适用于参数数量较多的情况。
