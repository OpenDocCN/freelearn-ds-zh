- en: '3'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '3'
- en: Working with Off-Chain Data
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用链下数据
- en: In the previous chapter, we learned that on-chain data serves as the primary
    source of Web3 data analysis. It is open, distributed, and trustworthy. While
    on-chain data will be key to answering most business data science questions, it
    is essential to complement it with relevant information from off-chain data sources,
    which is the focus of this chapter.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一章中，我们了解到链上数据是Web3数据分析的主要来源。它是开放的、分布式的且值得信赖的。尽管链上数据对于解答大多数商业数据科学问题至关重要，但必须用链下数据源的相关信息来补充，这也是本章的重点。
- en: Consider a scenario where we receive a request to assess the economic relevance
    of a smart contract. We can query the number of tokens locked in it, but to finalize
    the analysis, we need to determine the monetary value of those tokens. To accomplish
    this, we must integrate on-chain data with prices, often derived from off-chain
    sources.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们收到一个请求，要求评估一个智能合约的经济相关性。我们可以查询该合约中锁定的代币数量，但要完成分析，我们还需要确定这些代币的货币价值。为了实现这一点，我们必须将链上数据与价格进行整合，而这些价格通常来自链下来源。
- en: Prices, news, and opinions are not stored on-chain and must be retrieved from
    external sources. In this chapter, we will delve into those sources and acquire
    data from selected APIs. Specifically, we will discuss alternatives for fetching
    prices, analyze a crypto news aggregator, and explore the significance of social
    media, particularly X (formerly Twitter).
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 价格、新闻和观点不存储在链上，必须从外部来源获取。本章将深入探讨这些来源，并从选定的API获取数据。具体而言，我们将讨论获取价格的替代方法，分析一个加密新闻聚合器，并探讨社交媒体，尤其是X（前Twitter）的重要性。
- en: Off-chain data differs in nature from on-chain data, and it is crucial to exercise
    caution regarding reliability when dealing with these sources. The sources discussed
    in this chapter are typically centralized, meaning the entities have complete
    control over their data. This directly affects the datasets we will utilize, as
    data points may be subject to deletion, missing entries, or manipulation. In contrast,
    on-chain data transactions, as a rule, cannot be modified.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 链下数据的性质与链上数据不同，因此在处理这些来源时，必须特别注意其可靠性。本章讨论的这些来源通常是集中式的，意味着实体完全控制其数据。这直接影响我们将要使用的数据集，因为数据点可能会被删除、缺失或篡改。相比之下，链上数据交易原则上无法被修改。
- en: 'This chapter specifically covers the following topics:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 本章具体涵盖以下主题：
- en: Integrating prices into our dataset
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将价格整合到我们的数据集
- en: Incorporating news into our dataset
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将新闻融入我们的数据集
- en: Adding social network data to our dataset
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将社交网络数据添加到我们的数据集中
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: We will be using **Tweepy**, a Python library that allows us to easily interact
    with X. With Tweepy, we can fetch, post, and retrieve information about tweets,
    users, and much more. To start using Tweepy, we first need to register for a developer
    account on the Twitter developer website and obtain a set of API keys, as explained
    in *Appendix 2*. The documentation for Tweepy is available at [https://docs.tweepy.org/en/stable/](https://docs.tweepy.org/en/stable/).
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用**Tweepy**，这是一个Python库，允许我们轻松地与X进行交互。使用Tweepy，我们可以获取、发布和检索关于推文、用户以及更多的信息。要开始使用Tweepy，我们首先需要在Twitter开发者网站上注册一个开发者账户，并获取一组API密钥，如*附录2*所述。Tweepy的文档可以在[https://docs.tweepy.org/en/stable/](https://docs.tweepy.org/en/stable/)找到。
- en: 'If you have not worked with Tweepy before, it can be installed with the following
    code:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你之前没有使用过Tweepy，可以通过以下代码进行安装：
- en: '[PRE0]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Additionally, we’ll be utilizing Plotly **graph objects** and Plotly **Express**,
    two visualization libraries that empower us to create interactive visualizations
    with Python. Plotly Express is a high-level library that allows us to plot common
    types of graphs—such as scatter plots, line charts, maps, pie charts, and more—with
    minimal lines of code. The documentation for Plotly Express can be found at [https://plotly.com/python/plotly-express/](https://plotly.com/python/plotly-express/).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们将使用Plotly **图形对象**和Plotly **Express**，这两个可视化库使我们能够用Python创建互动式可视化。Plotly
    Express是一个高级库，允许我们用最少的代码行绘制常见类型的图表——如散点图、折线图、地图、饼图等。Plotly Express的文档可以在[https://plotly.com/python/plotly-express/](https://plotly.com/python/plotly-express/)找到。
- en: Plotly graph objects offer more flexibility and control over visualizations,
    allowing the creation of complex plots with a high degree of customization. The
    documentation for Plotly graph objects is available at [https://plotly.com/python/graph-objects/](https://plotly.com/python/graph-objects/).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Plotly 图形对象提供了更多的灵活性和控制力，使得创建高度自定义的复杂图表成为可能。Plotly 图形对象的文档可以在[https://plotly.com/python/graph-objects/](https://plotly.com/python/graph-objects/)找到。
- en: 'To use both libraries, we need to have the Plotly library installed. If you
    have not worked with Plotly before, it can be installed with the following code
    snippet:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使用这两个库，我们需要安装 Plotly 库。如果你之前没有使用过 Plotly，可以通过以下代码片段安装：
- en: '[PRE1]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: You can find Jupyter notebooks containing examples discussed in this chapter
    in the book’s GitHub repository at [https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter03](https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter03).
    We recommend reading through the code files in the `Chapter03` folder to follow
    along.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在本书的 GitHub 仓库中找到包含本章讨论示例的 Jupyter 笔记本，地址为[https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter03](https://github.com/PacktPublishing/Data-Science-for-Web3/tree/main/Chapter03)。我们建议你阅读`Chapter03`文件夹中的代码文件，以便跟进学习。
- en: Introductory example – listing data sources
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入门示例 – 列出数据来源
- en: 'Let’s examine this headline:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看这个标题：
- en: '**Dogecoin gains 25% after Elon Musk confirms Tesla will accept DOGE** **for
    merchandise**'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '**狗狗币上涨 25%，因为 Elon Musk 确认 Tesla 将接受 DOGE** **用于商品购买**'
- en: '(Source – Cointelegraph: [https://cointelegraph.com/news/dogecoin-gains-25-after-elon-musk-confirms-tesla-will-accept-doge-for-merchandise](https://cointelegraph.com/news/dogecoin-gains-25-after-elon-musk-confirms-tesla-will-accept-doge-for-merchandise).)'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '（来源 – Cointelegraph: [https://cointelegraph.com/news/dogecoin-gains-25-after-elon-musk-confirms-tesla-will-accept-doge-for-merchandise](https://cointelegraph.com/news/dogecoin-gains-25-after-elon-musk-confirms-tesla-will-accept-doge-for-merchandise)。）'
- en: 'This headline references three data sources:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 这个标题引用了三个数据来源：
- en: '**Headline (news)**: An online newspaper specializing in the Web3 industry
    generates this headline. Blockchain news is gradually entering mainstream platforms,
    and similar information can also be found in traditional financial news indexes
    such as Reuters.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标题（新闻）**：一份专注于 Web3 行业的在线报纸生成了这个标题。区块链新闻逐渐进入主流平台，类似的信息也可以在传统的金融新闻索引中找到，例如路透社。'
- en: '**Prices**: The headline refers to the price variation of a particular cryptocurrency.
    Price data is not typically fetched from the on-chain sources; rather, it is a
    piece of information data scientists find useful to integrate from a third-party
    data source.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**价格**：这个标题提到的是某种特定加密货币的价格波动。价格数据通常不会从链上数据源获取；相反，它是数据科学家认为有用的、需要从第三方数据源集成的信息。'
- en: '**X (formerly Twitter)/social networks**: Numerous market-impact events unfold
    on social networks, where key figures in the Web3 ecosystem have established significant
    online reputations. A single tweet from these influential individuals can alter
    prices or bring attention to a scam or failed negotiation. Most Web3 companies
    maintain a presence on X, often before creating a LinkedIn page. In this case,
    the impact on Dogecoin, as mentioned in the headline, originated from Elon Musk’s
    tweet: “*Tesla will make some merch buyable with Doge and see how it goes*” (source:
    [https://twitter.com/elonmusk/status/1470703708677840896](https://twitter.com/elonmusk/status/1470703708677840896)).'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**X（前身为 Twitter）/社交网络**：许多具有市场影响力的事件发生在社交网络上，Web3 生态系统中的关键人物在这些平台上建立了重要的在线声誉。这些有影响力的人物的一条推文可以改变价格，或引起对骗局或失败谈判的关注。大多数
    Web3 公司在 X 上保持活跃，通常在创建 LinkedIn 页面之前。在这个案例中，标题中提到的对狗狗币的影响来自于 Elon Musk 的一条推文：“*Tesla
    将让一些商品用 Doge 购买，看看效果如何*”（来源：[https://twitter.com/elonmusk/status/1470703708677840896](https://twitter.com/elonmusk/status/1470703708677840896)）。'
- en: We described three off-chain data sources that will be relevant for our business
    data science projects and that we must learn how to consume in a data scientist-friendly
    format to integrate them effectively. We will discuss each of them in the subsequent
    sections.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们描述了三个与我们的业务数据科学项目相关的链外数据来源，我们必须学习如何以适合数据科学家使用的格式有效地集成它们。我们将在接下来的章节中讨论每一个数据来源。
- en: Adding prices to our dataset
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 向我们的数据集添加价格
- en: 'Price information is typically stored off-chain, and various sources provide
    access to this data. Some of the most popular APIs include the following:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 价格信息通常存储在链外，多个来源提供对此数据的访问。一些最受欢迎的 API 包括以下几种：
- en: CoinGecko
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CoinGecko
- en: CoinMarketCap
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CoinMarketCap
- en: Binance
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Binance
- en: Chainlink
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Chainlink
- en: 'OHLC data: Kraken'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OHLC 数据：Kraken
- en: Each API comes with its own limitations, which we need to consider when deciding
    whether to integrate them into our projects. Specific details can be found in
    their respective documentation.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 每个API都有其自身的限制，我们需要在决定是否将其集成到项目中时加以考虑。具体细节可以在各自的文档中找到。
- en: 'Regarding price data, it is important to understand how it is calculated, as
    in these examples:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 关于价格数据，理解它是如何计算的非常重要，如以下示例所示：
- en: CoinMarketCap calculates an asset’s price by considering the volume-weighted
    average of all markets where the asset is traded. This approach is based on the
    notion that more liquid markets are less susceptible to price fluctuations or
    manipulation and, therefore, more reliable.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CoinMarketCap通过考虑所有交易市场的加权平均价格来计算资产的价格。这种方法基于这样的假设：更具流动性的市场不易受到价格波动或操纵，因此更可靠。
- en: Binance reports prices based on transactions conducted on their platform. Depending
    on the pair, it provides the price of the last trade executed in their market.
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Binance根据其平台上的交易报告价格。根据交易对，它提供市场上最近一次交易的价格。
- en: Let’s briefly analyze each of them.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们简要分析一下其中的每一个。
- en: CoinGecko
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CoinGecko
- en: The **CoinGecko** ([https://www.coingecko.com/](https://www.coingecko.com/))
    documentation is straightforward and easy to understand, and they offer a free
    tier that does not require any registration. With their URL engine, which can
    build the endpoint URL based on what the user needs, making the requests more
    efficient.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '**CoinGecko** ([https://www.coingecko.com/](https://www.coingecko.com/))的文档清晰易懂，且提供了一个无需注册的免费层。通过他们的URL引擎，可以根据用户需求构建端点URL，使请求更加高效。'
- en: We can find their documentation at [https://www.coingecko.com/api/documentation](https://www.coingecko.com/es/api/documentation).
    Let’s test the `simple/price` endpoint, which is accessible through this link,
    too.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在[https://www.coingecko.com/api/documentation](https://www.coingecko.com/es/api/documentation)找到他们的文档。让我们也通过这个链接测试`simple/price`端点。
- en: '![Figure 3.1 – CoinGecko API view](img/B19446_03_01.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.1 – CoinGecko API视图](img/B19446_03_01.jpg)'
- en: Figure 3.1 – CoinGecko API view
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.1 – CoinGecko API视图
- en: 'As shown in *Figure 3**.2*, the *required* parameters for this endpoint are
    `ids` and `vs_currencies`:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图 3**.2*所示，此端点所需的参数是`ids`和`vs_currencies`：
- en: '![Figure 3.2 – Partial view of the simple/price query parameters](img/B19446_03_02.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.2 – 简单/价格查询参数的部分视图](img/B19446_03_02.jpg)'
- en: Figure 3.2 – Partial view of the simple/price query parameters
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.2 – 简单/价格查询参数的部分视图
- en: 'There are also several optional parameters, such as the following:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一些可选参数，如下所示：
- en: '`include_market_cap`'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`include_market_cap`'
- en: '`include_24hr_vol`'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`include_24hr_vol`'
- en: '`include_24hr_change`'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`include_24hr_change`'
- en: '`include_last_updated_at`'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`include_last_updated_at`'
- en: '`precision`'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`precision`'
- en: 'To obtain the *ID* for a specific asset, we go to CoinGecko’s main page and
    search for the asset by name. If, for example, we want to fetch the current price
    of Bitcoin, we would need to add Bitcoin''s ID in our query. To look for it, we
    go to CoinGecko''s main page and type `Bitcoin` in the search bar, as shown in
    *Figure 3**.3*:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取特定资产的*ID*，我们可以去CoinGecko的主页并按名称搜索该资产。例如，如果我们想获取比特币的当前价格，我们需要在查询中添加比特币的ID。要查找它，我们只需去CoinGecko的主页并在搜索框中输入`Bitcoin`，如*图
    3**.3*所示：
- en: '![Figure 3.3 – CoinGecko search bar](img/B19446_03_03.jpg)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.3 – CoinGecko 搜索框](img/B19446_03_03.jpg)'
- en: Figure 3.3 – CoinGecko search bar
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.3 – CoinGecko 搜索框
- en: 'This will lead us to the Bitcoin information page on CoinGecko ([https://www.coingecko.com/en/coins/bitcoin](https://www.coingecko.com/en/coins/bitcoin))
    where, as shown in *Figure 3**.4*, we can find the API ID that we will source
    as a parameter in the query:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 这将引导我们进入CoinGecko上的比特币信息页面([https://www.coingecko.com/en/coins/bitcoin](https://www.coingecko.com/en/coins/bitcoin))，如*图
    3**.4*所示，我们可以找到作为查询参数使用的API ID：
- en: '![Figure 3.4 – CoinGecko Bitcoin (BTC) page view](img/B19446_03_04.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.4 – CoinGecko比特币（BTC）页面视图](img/B19446_03_04.jpg)'
- en: Figure 3.4 – CoinGecko Bitcoin (BTC) page view
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.4 – CoinGecko比特币（BTC）页面视图
- en: For our `simple/price` request, we also need to input the `vs_currencies` parameter,
    which determines the currency of the price. In this case, we will use `usd`.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的`simple/price`请求，我们还需要输入`vs_currencies`参数，它决定了价格的货币类型。在本例中，我们将使用`usd`。
- en: 'Once we have filled in the mandatory requirements on the API page, we can press
    the blue **Execute** button, which will return the URL we can use:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 填写完API页面上的必填项后，我们可以点击蓝色的**执行**按钮，这将返回我们可以使用的URL：
- en: '[PRE2]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Let’s see how this works in `prices.ipynb`.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一下在`prices.ipynb`中的操作。
- en: CoinMarketCap
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CoinMarketCap
- en: 'CoinMarketCap ([https://coinmarketcap.com/](https://coinmarketcap.com/)) provides
    extensive documentation, available at the following link: [https://coinmarketcap.com/api/documentation/v1/](https://coinmarketcap.com/api/documentation/v1/).
    Although this documentation may seem overwhelming, for our purposes, locate the
    **CRYPTOCURRENCY** category on the left-hand side of the page, accessible through
    a drop-down menu containing several endpoints related to prices:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: CoinMarketCap ([https://coinmarketcap.com/](https://coinmarketcap.com/)) 提供了广泛的文档，可以通过以下链接访问：[https://coinmarketcap.com/api/documentation/v1/](https://coinmarketcap.com/api/documentation/v1/)。尽管这些文档可能看起来有些复杂，但对于我们的目的，定位到页面左侧的**加密货币**类别，通过包含多个与价格相关的端点的下拉菜单可以进行访问：
- en: '![Figure 3.5 – CoinMarketCap left bar view](img/B19446_03_05.jpg)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![图3.5 – CoinMarketCap左侧栏视图](img/B19446_03_05.jpg)'
- en: Figure 3.5 – CoinMarketCap left bar view
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.5 – CoinMarketCap左侧栏视图
- en: 'For our purposes, we will utilize the endpoint documented at this link: [https://coinmarketcap.com/api/documentation/v1/#operation/getV2CryptocurrencyQuotesLatest](https://coinmarketcap.com/api/documentation/v1/#operation/getV2CryptocurrencyQuotesLatest).'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的目的，我们将使用以下链接文档中的端点：[https://coinmarketcap.com/api/documentation/v1/#operation/getV2CryptocurrencyQuotesLatest](https://coinmarketcap.com/api/documentation/v1/#operation/getV2CryptocurrencyQuotesLatest)。
- en: CoinMarketCap offers multiple tiers of services with varying API limits and
    endpoints. For this introductory explanation, we will rely on the free tier.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: CoinMarketCap提供多个服务层级，API限制和端点各不相同。对于这次的介绍性说明，我们将依赖免费的层级。
- en: 'We extract the latest Bitcoin price using CoinMarketCap’s API in the `prices.ipynb`
    notebook. To identify the ID of a specific coin, we can execute the map ID endpoint,
    which shows all cryptocurrencies listed on the CoinMarketCap website with their
    unique ID. Additional details about this endpoint can be accessed in the documentation:
    [https://coinmarketcap.com/api/documentation/v1/#operation/getV1CryptocurrencyMap](https://coinmarketcap.com/api/documentation/v1/#operation/getV1CryptocurrencyMap).
    The ID for Bitcoin is `slug` parameter, which consists of the string name of the
    cryptocurrency – in our case, simply `bitcoin`.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过CoinMarketCap的API在`prices.ipynb`笔记本中提取最新的比特币价格。为了识别特定币种的ID，我们可以执行映射ID端点，它显示了所有在CoinMarketCap网站上列出的加密货币及其唯一ID。有关该端点的更多细节可以在文档中访问：[https://coinmarketcap.com/api/documentation/v1/#operation/getV1CryptocurrencyMap](https://coinmarketcap.com/api/documentation/v1/#operation/getV1CryptocurrencyMap)。比特币的ID是`slug`参数，它包含了加密货币的字符串名称——在我们的例子中，简单地就是`bitcoin`。
- en: A note on links and scams
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 关于链接和骗局的提示
- en: Highly sophisticated scams can deceive victims through search engines. Accessing
    a project, especially smaller or less-known ones that we have not visited before,
    by clicking from a search engine where scammers can manipulate web pages into
    top suggestions elevates the risks. CoinGecko and CoinMarketCap have proven to
    be reliable for having authentic links to official websites. A more in-depth exploration
    of security will be provided in [*Chapter 10*](B19446_10.xhtml#_idTextAnchor294).
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 高度复杂的骗局可以通过搜索引擎欺骗受害者。通过点击搜索引擎中的链接访问项目，特别是我们之前未访问过的小型或不太知名的项目，存在更高的风险，骗子可以通过操控网页将其提升为排名靠前的建议链接。CoinGecko和CoinMarketCap已经证明在提供指向官方网站的真实链接方面非常可靠。关于安全性更深入的探讨将在[*第10章*](B19446_10.xhtml#_idTextAnchor294)中提供。
- en: Binance
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Binance
- en: This is one of the most important centralized exchanges currently active. The
    exchange offers a basic data plan that does not require registration. The documentation
    is organized based on the products available on the exchange.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 这是目前活跃的最重要的中心化交易所之一。该交易所提供一个无需注册的基础数据计划。文档根据交易所提供的产品进行组织。
- en: '![Figure 3.6 – Binance main menu](img/B19446_03_06.jpg)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![图3.6 – Binance主菜单](img/B19446_03_06.jpg)'
- en: Figure 3.6 – Binance main menu
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.6 – Binance主菜单
- en: To extract the spot price of Bitcoin, navigate to the **Spot/Margin/Savings/Mining**
    tab, as illustrated in *Figure 3**.6*. The documentation and available endpoints
    are listed in a drop-down menu on the left-hand side of the page.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 要提取比特币的现货价格，请导航到**现货/保证金/储蓄/挖矿**标签，如*图3.6*所示。文档和可用端点在页面左侧的下拉菜单中列出。
- en: 'The URL for the endpoint is composed of two parts – a general base endpoint
    and the query part:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 该端点的URL由两部分组成——一个通用的基础端点和查询部分：
- en: 'The base endpoint is located in the **General Info** section, accessible at
    this link: [https://binance-docs.github.io/apidocs/spot/en/#general-info](https://binance-docs.github.io/apidocs/spot/en/#general-info)'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基础端点位于**常规信息**部分，可以通过以下链接访问：[https://binance-docs.github.io/apidocs/spot/en/#general-info](https://binance-docs.github.io/apidocs/spot/en/#general-info)
- en: '![Figure 3.7 – Binance General Info view](img/B19446_03_07.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.7 – 币安一般信息视图](img/B19446_03_07.jpg)'
- en: Figure 3.7 – Binance General Info view
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.7 – 币安一般信息视图
- en: 'The query part we will use is as follows:'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们将使用的查询部分如下：
- en: '[PRE3]'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The documentation for this code is in the *Market Data Endpoints* section available
    at this link: [https://binance-docs.github.io/apidocs/spot/en/#symbol-price-ticker](https://binance-docs.github.io/apidocs/spot/en/#symbol-price-ticker).'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码的文档位于 *市场数据端点* 部分，可以通过以下链接访问：[https://binance-docs.github.io/apidocs/spot/en/#symbol-price-ticker](https://binance-docs.github.io/apidocs/spot/en/#symbol-price-ticker)。
- en: In `prices.ipynb`, we extract the latest Bitcoin price from this source. The
    endpoint requires a `symbol` parameter, expressed in a trading pair format, and
    we use `BTCUSDT`.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `prices.ipynb` 中，我们从这个来源提取最新的比特币价格。该端点需要一个 `symbol` 参数，以交易对格式表示，我们使用 `BTCUSDT`。
- en: To obtain the list of available trading pairs, there are two options. The first
    is on the Binance platform, and the second is on TradingView, where an account
    can be created at [https://es.tradingview.com/](https://es.tradingview.com/).
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取可用交易对的列表，有两个选项。第一个是在币安平台上，第二个是在 TradingView 上，可以在 [https://es.tradingview.com/](https://es.tradingview.com/)
    创建一个账户。
- en: 'On TradingView’s main page, go to **Symbol Search**, as shown in *Figure 3**.8*:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在 TradingView 的主页上，进入 **符号搜索**，如 *图 3.8* 所示：
- en: '![Figure 3.8 – TradingView Symbol Search bar](img/B19446_03_08.jpg)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.8 – TradingView 符号搜索栏](img/B19446_03_08.jpg)'
- en: Figure 3.8 – TradingView Symbol Search bar
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.8 – TradingView 符号搜索栏
- en: 'This opens a dropdown displaying the complete list of trading pairs. To filter
    by exchange, modify the **All sources** parameter, as shown in *Figure 3**.9*:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这将打开一个下拉菜单，显示所有的交易对列表。要按交易所进行过滤，修改 **所有来源** 参数，如 *图 3.9* 所示：
- en: '![Figure 3.9 – TradingView sources](img/B19446_03_09.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.9 – TradingView 数据源](img/B19446_03_09.jpg)'
- en: Figure 3.9 – TradingView sources
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.9 – TradingView 数据源
- en: 'When the search box opens on `Binance` and press *Enter*:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 当搜索框在 `Binance` 上打开时，按 *Enter* 键：
- en: '![Figure 3.10 – TradingView source selection](img/B19446_03_10.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.10 – TradingView 来源选择](img/B19446_03_10.jpg)'
- en: Figure 3.10 – TradingView source selection
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.10 – TradingView 来源选择
- en: This will display all the trading pairs for the specific exchange under the
    **SYMBOL** column. This symbol is the string we will pass as a parameter to our
    query.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示特定交易所的所有交易对，位于 **SYMBOL** 列中。这个符号是我们将作为参数传递给查询的字符串。
- en: '![Figure 3.11 – Binance pairs/symbols as shown on TradingView](img/B19446_03_11.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.11 – 在 TradingView 上显示的 Binance 交易对/符号](img/B19446_03_11.jpg)'
- en: Figure 3.11 – Binance pairs/symbols as shown on TradingView
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.11 – 在 TradingView 上显示的 Binance 交易对/符号
- en: Binance’s API provides comprehensive data beyond price information, making it
    a valuable resource for exploration.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 币安的 API 提供了超越价格信息的全面数据，使其成为一个宝贵的探索资源。
- en: Oracles – Chainlink
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预言机 – Chainlink
- en: '**Oracles** serve as bridges connecting a smart contract to real-world data.
    Consider an insurance smart contract designed to provide coverage against specific
    climate-related events, such as rain. In the closed environment of its blockchain,
    how can the smart contract ascertain whether it is currently raining or not? The
    solution lies in oracles, which establish the link between the smart contract
    and external information, ensuring that the necessary data is reflected within
    the blockchain.'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '**预言机** 作为智能合约与现实世界数据之间的桥梁。考虑一个为特定气候相关事件（例如雨水）提供保险的智能合约。在其区块链的封闭环境中，智能合约如何判断当前是否下雨？解决方案在于预言机，它们建立了智能合约与外部信息之间的联系，确保必要的数据能在区块链内反映出来。'
- en: '**Chainlink** stands out as one of the most widely used sets of oracles. This
    chapter focuses on price feeds for smart contracts, though there are others such
    as proof of reserve feeds or NFT price feeds (explored in [*Chapter 4*](B19446_04.xhtml#_idTextAnchor145)).
    Documentation for the steps discussed is available at [https://docs.chain.link/data-feeds/api-reference](https://docs.chain.link/data-feeds/api-reference).'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '**Chainlink** 是最广泛使用的预言机之一。本章重点讨论智能合约的价格数据源，虽然也有其他数据源，例如储备证明数据源或 NFT 价格数据源（将在
    [*第 4 章*](B19446_04.xhtml#_idTextAnchor145) 中讨论）。讨论的步骤的文档可在 [https://docs.chain.link/data-feeds/api-reference](https://docs.chain.link/data-feeds/api-reference)
    找到。'
- en: Most price consensus occurs off-chain, and when it is necessary to update the
    blockchain, the agreed-upon price is recorded on-chain by price feed oracles.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数价格共识发生在链外，当需要更新区块链时，经过一致同意的价格会通过价格数据源预言机记录在链上。
- en: 'For example, the Bitcoin price is continuously updated and can be seen at [https://data.chain.link/ethereum/mainnet/crypto-usd/btc-usd](https://data.chain.link/ethereum/mainnet/crypto-usd/btc-usd).
    Prices are updated on-chain based on *trigger parameters*, as shown in *Figure
    3**.13*:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，比特币价格会持续更新，并可在 [https://data.chain.link/ethereum/mainnet/crypto-usd/btc-usd](https://data.chain.link/ethereum/mainnet/crypto-usd/btc-usd)
    查看。价格会基于 *触发参数* 在链上更新，如 *图 3.13* 所示：
- en: '**Deviation threshold**: Triggered when off-chain data deviates by more than
    0.5% from the last updated price.'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**偏差阈值**：当链下数据与最后更新的价格偏差超过 0.5% 时触发。'
- en: '**Heartbeat**: Activated after a specified time since the last update has elapsed.
    Each price feed has its specific time heartbeat. For the Bitcoin price feed, this
    interval is set to one hour. Consequently, the feed will be refreshed once an
    hour has passed, provided the previous trigger has not occurred before that.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**心跳**：在自上次更新以来经过指定时间后激活。每个价格信息源都有其特定的心跳时间。对于比特币价格信息源，该间隔设置为一小时。因此，价格信息将在一小时后刷新，前提是之前的触发事件没有在此之前发生。'
- en: If we want to source data from these smart contracts, we need to be aware of
    the heartbeat and check its timestamp to ensure that the latest answer is recent
    enough for our dataset to add it.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想从这些智能合约中获取数据，我们需要关注心跳，并检查其时间戳，确保最新的答案足够新，以便将其添加到我们的数据集中。
- en: '![Figure 3.12 – Chainlink price feed information view](img/B19446_03_12.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.12 – Chainlink 价格信息视图](img/B19446_03_12.jpg)'
- en: Figure 3.12 – Chainlink price feed information view
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.12 – Chainlink 价格信息视图
- en: To extract the latest price or the **latest round** price, we will need the
    contract address, as indicated in the second red square of the preceding figure.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 要提取最新价格或 **最新回合** 的价格，我们需要合约地址，如前面图示中的第二个红框所示。
- en: The contract `prices.ipynb`.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 合约 `prices.ipynb`。
- en: 'Available `read` functions for the price feed smart contract include the following:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 可用的 `read` 函数用于价格信息智能合约，包括以下内容：
- en: '`decimals()`: Returns the number of decimals in the response. In the `prices.ipynb`
    example, this value is `8`, retrieved with the following code snippet:'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`decimals()`：返回响应中的小数位数。在 `prices.ipynb` 示例中，此值为 `8`，通过以下代码片段获取：'
- en: '[PRE4]'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'getRoundData(uint80): Returns the data in a specific round.'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: getRoundData(uint80)：返回特定回合中的数据。
- en: '[PRE5]'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '`latestRoundData()`: Returns the latest round data.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`latestRoundData()`：返回最新的回合数据。'
- en: '`version()`: Returns the contract version.'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`version()`：返回合约版本。'
- en: 'To get the price, we need to execute the `latestRoundData` function, as follows:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取价格，我们需要执行 `latestRoundData` 函数，如下所示：
- en: '[PRE6]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The result is a list composed of the following elements:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是一个由以下元素组成的列表：
- en: '| `roundId` | Each time the oracle is updated, it is known as a `roundId` value.
    To retrieve the answer of a historical round, we need to call the `getRoundData(uint80)`
    function and provide this number as a parameter. |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| `roundId` | 每次更新预言机时，都会生成一个 `roundId` 值。要获取历史回合的答案，我们需要调用 `getRoundData(uint80)`
    函数，并提供该数字作为参数。 |'
- en: '| `answer` | This returns the price of the asset, the desired data point. |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| `answer` | 这是返回的资产价格，即所需的数据点。 |'
- en: '| `startedAt` | This is the timestamp when the round started. |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| `startedAt` | 这是回合开始时间的时间戳。 |'
- en: '| `updatedAt` | This is the timestamp when the round was updated. |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| `updatedAt` | 这是回合更新时间的时间戳。 |'
- en: Table 3.1 – Oracle response
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 表 3.1 – 预言机响应
- en: There is one last element in the response (`answeredInRound`), which is a legacy
    variable and is no longer used.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 响应中还有一个最后的元素（`answeredInRound`），这是一个遗留变量，现已不再使用。
- en: 'Once the `answer` is retrieved, translate it to traditional decimal format
    by moving the comma as many places as indicated by the `decimals()` function:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦获取到 `answer`，根据 `decimals()` 函数指示的小数位数，将逗号移动相应的位置，转换为传统的小数格式：
- en: '![Figure 3.13 – Bitcoin price as fed by Chainlink](img/B19446_03_13.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.13 – 由 Chainlink 提供的比特币价格](img/B19446_03_13.jpg)'
- en: Figure 3.13 – Bitcoin price as fed by Chainlink
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.13 – 由 Chainlink 提供的比特币价格
- en: OHLC – Kraken
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: OHLC – Kraken
- en: '**Open, High, Low, Close** (**OHLC**) data is a specific dataset where each
    row includes a timestamp and four columns:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '**开盘、最高、最低、收盘** (**OHLC**) 数据是一种特定的数据集，其中每行包括一个时间戳和四列数据：'
- en: '**Open price** (**O**): This is the asset’s price at the beginning of the analyzed
    period'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**开盘价** (**O**)：这是该资产在分析期间开始时的价格。'
- en: '**High price** (**H**): This is the highest price of the asset during the analyzed
    period'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最高价格** (**H**)：这是在分析期间该资产的最高价格。'
- en: '**Low price** (**L**): This is the lowest price of the asset during the analyzed
    period'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最低价格** (**L**)：这是在分析期间该资产的最低价格。'
- en: '**Closing price** (**C**): This is the last asset’s price at the end of the
    analyzed period'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**收盘价**（**C**）：这是分析期间结束时最后的资产价格。'
- en: 'An example can be seen in *Table 3.2*:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在 *表 3.2* 中看到一个示例：
- en: '| **Timestamp** | **Open** | **High** | **Low** | **Close** |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| **时间戳** | **开盘价** | **最高价** | **最低价** | **收盘价** |'
- en: '| `2022-12-06 00:00:00` | `16965.7` | `17089.1` | `16965.7` | `17011.0` |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| `2022-12-06 00:00:00` | `16965.7` | `17089.1` | `16965.7` | `17011.0` |'
- en: Table 3.2 – An example of OHLC data
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 表 3.2 – OHLC 数据示例
- en: The OHLC columns provide information about the price variations of an asset
    over a specific period of time. *Figure 3**.14* shows an example of a candlestick
    chart that can be created using OHLC data.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: OHLC 列提供了有关资产在特定时间段内价格变化的信息。*图 3.14* 显示了一个可以使用 OHLC 数据创建的蜡烛图示例。
- en: '![Figure 3.14 – Candlestick design](img/B19446_03_14.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.14 – 蜡烛图设计](img/B19446_03_14.jpg)'
- en: Figure 3.14 – Candlestick design
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.14 – 蜡烛图设计
- en: Each row of the dataset can be used to plot one candlestick. The *Close* and
    *Open* prices inform us whether, during a given period of time, the asset’s price
    decreased (*Close* is lower than *Open*) or increased (*Close* is higher than
    *Open*). This information is used to color the body of the bar.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集中的每一行可以用来绘制一个蜡烛图。*收盘价*和*开盘价*告诉我们，在给定的时间段内，资产的价格是下降（*收盘价*低于*开盘价*）还是上升（*收盘价*高于*开盘价*）。这些信息用于给蜡烛图的实体上色。
- en: The OHLC data can include additional columns such as traded volume or the number
    of trades. See the example in `prices.ipynb`.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: OHLC 数据可以包括额外的列，如成交量或交易数量。请参阅 `prices.ipynb` 中的示例。
- en: Technical indicators such as moving averages or Bollinger bands, which are popular
    in trading, can also be plotted using OHLC data.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 像移动平均线或布林带等技术指标，在交易中非常流行，也可以使用 OHLC 数据进行绘制。
- en: The **Kraken** centralized exchange provides OHLC data in its open API, which
    is very well documented. As we learned with Binance, when using exchanges, every
    price search has to be expressed as a trading pair.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '**Kraken** 集中交易所通过其开放 API 提供 OHLC 数据，并且文档非常完善。正如我们在使用 Binance 时学到的那样，使用交易所时，每个价格查询都必须以交易对的形式表达。'
- en: The documentation can be found at [https://docs.kraken.com/rest/#section/General-Usage](https://docs.kraken.com/rest/#section/General-Usage).
    The endpoint we will use is explained at [https://docs.kraken.com/rest/#tag/Market-Data/operation/getOHLCData](https://docs.kraken.com/rest/#tag/Market-Data/operation/getOHLCData).
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 文档可以在 [https://docs.kraken.com/rest/#section/General-Usage](https://docs.kraken.com/rest/#section/General-Usage)
    找到。我们将使用的端点在 [https://docs.kraken.com/rest/#tag/Market-Data/operation/getOHLCData](https://docs.kraken.com/rest/#tag/Market-Data/operation/getOHLCData)
    中有详细说明。
- en: 'When working with OHLC data, it is important to consider the time intervals
    or granularity of the data. Prices that may appear high or low in a short time
    frame may be insignificant when analyzed over a longer period. Time granularity
    will depend on the API. Usually, it is possible to extract seconds, minutes, hours,
    and days and a combination of those. In Kraken, it is possible to extract with
    the following parameters:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理 OHLC 数据时，考虑数据的时间间隔或粒度非常重要。在短时间内看似高或低的价格，在较长时间段内分析时可能并不重要。时间粒度将取决于 API。通常，可以提取秒、分钟、小时和天数以及它们的组合。在
    Kraken 中，可以使用以下参数进行提取：
- en: '![Figure 3.15 – Interval parameter expressed in seconds](img/B19446_03_15.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.15 – 以秒为单位表示的间隔参数](img/B19446_03_15.jpg)'
- en: Figure 3.15 – Interval parameter expressed in seconds
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.15 – 以秒为单位表示的间隔参数
- en: To plot a candlestick chart, we can use the `plotly.graph_objects` library.
    In `prices.ipynb`, we fetch the OHLC dataset of the Bitcoin price with a four-hour
    period from April 01 to April 05, 2023, and use the library to plot the corresponding
    candlesticks.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 要绘制蜡烛图，我们可以使用 `plotly.graph_objects` 库。在 `prices.ipynb` 中，我们提取了 2023 年 4 月 1
    日至 4 月 5 日之间四小时周期的比特币 OHLC 数据集，并使用该库绘制相应的蜡烛图。
- en: Final thoughts on prices
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于价格的最终思考
- en: 'After our thorough discussion on prices, here are a few key points to remember:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们对价格进行了深入讨论后，以下是一些需要记住的关键点：
- en: Not all fiat currencies are supported by these APIs. For currencies that are
    not the US dollar or Euro, the API may reflect the central bank’s official exchange
    rate with the US dollar, which can differ significantly from the real market price.
    This is especially true for countries with regulated economies or high inflation.
    It is necessary to understand where the APIs are sourcing their data from before
    adding those prices to our dataset.
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 并非所有法定货币都被这些 API 支持。对于不是美元或欧元的货币，API 可能会显示该国中央银行与美元的官方汇率，这可能与实际市场价格有很大差异。特别是对于那些有监管经济或高通货膨胀的国家来说，这一点尤其如此。在将这些价格添加到我们的数据集之前，有必要了解这些
    API 数据的来源。
- en: Prices of tokens or coins are not the sole products that we may have to track.
    We could also receive a request to track floor prices of an NFT collection.
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代币或硬币的价格并不是我们可能需要跟踪的唯一产品。我们还可能会收到跟踪某个 NFT 系列的地板价格的请求。
- en: At the time of this writing, Web3 assets still exhibit significant price variations
    in short periods of time. When calculating averages, we have to be mindful of
    outliers that may affect them. Data sourced from low liquidity markets, such as
    small exchanges are more prone to outliers. Read the description of how those
    prices are calculated and compare them regularly with other sources or create
    a volume-weighted average as CoinMarketCap does.
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在写这篇文章时，Web3 资产在短时间内仍然表现出显著的价格波动。在计算平均值时，我们必须注意可能影响这些平均值的异常值。来自低流动性市场（如小型交易所）的数据更容易受到异常值的影响。请阅读这些价格如何计算的说明，并定期与其他来源进行比较，或像
    CoinMarketCap 一样创建加权平均值。
- en: News often triggers price fluctuations, so let’s now explore a dedicated news
    aggregator that keeps track of relevant information in the Web3 world.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 新闻常常引发价格波动，因此让我们现在探索一个专门的新闻聚合器，它跟踪 Web3 世界中的相关信息。
- en: Adding news to our dataset
  id: totrans-159
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将新闻添加到我们的数据集
- en: A professor once mentioned that in the crypto world, news takes only five minutes
    to impact the price of an asset.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 一位教授曾提到，在加密世界中，新闻只需五分钟就能影响一个资产的价格。
- en: News is not only important for its effect on prices but marketing teams may
    also request analysis of the social impact of a brand, a campaign, or a product,
    or it may be necessary to source an algorithm, among other applications. For that
    purpose, data scientists need news formatted for analysis.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 新闻不仅仅对价格产生影响，营销团队也可能要求分析品牌、活动或产品的社会影响，或者可能需要获取某个算法等应用。为了这个目的，数据科学家需要格式化适合分析的新闻数据。
- en: As of today, there is a dedicated source named **CryptoPanic**, a data aggregator
    that specifically indexes news relevant to the Web3 ecosystem. The link to the
    website is https://cryptopanic.com/.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 截至目前，已有一个名为**CryptoPanic**的专门数据聚合源，它专门索引与 Web3 生态系统相关的新闻。网站链接是 [https://cryptopanic.com/](https://cryptopanic.com/)。
- en: Its data can be consumed through an API and the API key is available upon registration.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 它的数据可以通过 API 访问，注册后可以获得 API 密钥。
- en: 'On the main page, go to the **Sign In** tab on the left menu:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在主页面，点击左侧菜单中的**登录**选项卡：
- en: '![Figure 3.16 – An overview of the CryptoPanic main view](img/B19446_03_16.jpg)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.16 – CryptoPanic 主界面概览](img/B19446_03_16.jpg)'
- en: Figure 3.16 – An overview of the CryptoPanic main view
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.16 – CryptoPanic 主界面概览
- en: 'If it is your first time signing up, you will need to confirm your email. After
    that, you are registered. Click on the **Develop** tab located on the home page:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这是你第一次注册，你需要确认你的电子邮件。之后，你就完成注册了。点击主页上的**开发**选项卡：
- en: '![Figure 3.17 – The Develop tab](img/B19446_03_17.jpg)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.17 – 开发选项卡](img/B19446_03_17.jpg)'
- en: Figure 3.17 – The Develop tab
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.17 – 开发选项卡
- en: 'Click on either of the **API** tabs on the new page:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 点击新页面上的任一**API**选项卡：
- en: '![Figure 3.18 – API documentation](img/B19446_03_18.jpg)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.18 – API 文档](img/B19446_03_18.jpg)'
- en: Figure 3.18 – API documentation
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.18 – API 文档
- en: 'Click on **API Keys** and it will open a new page with the credentials:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**API 密钥**，它会打开一个新页面，其中包含凭证：
- en: '![Figure 3.19 – API keys](img/B19446_03_19.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.19 – API 密钥](img/B19446_03_19.jpg)'
- en: Figure 3.19 – API keys
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3.19 – API 密钥
- en: 'The documentation is available at this link: [https://cryptopanic.com/developers/api/](https://cryptopanic.com/developers/api/).'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 文档可通过此链接访问：[https://cryptopanic.com/developers/api/](https://cryptopanic.com/developers/api/)。
- en: We will query with the traditional `requests` library, adding our API key to
    the endpoints listed in the documentation. A step-by-step guide to fetching a
    list of news can be seen on `news.ipynb`.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用传统的`requests`库进行查询，并将 API 密钥添加到文档中列出的端点。获取新闻列表的详细步骤可以在`news.ipynb`中看到。
- en: 'There are filters that can be applied to our requests to limit the amount of
    information received. The filters include the following:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以对请求应用过滤器，以限制接收的信息量。这些过滤器包括以下内容：
- en: 'Currency: The asset referred to in the indexed news'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 货币：在索引新闻中提到的资产
- en: 'Region: The language'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 区域：语言
- en: 'UI: This included the following categories – rising, hot, bullish, bearish,
    important, saved, and lol'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: UI：包括以下类别——上升、热门、看涨、看跌、重要、保存和笑话
- en: 'Kind: This is either media or news'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 类型：这可以是媒体或新闻
- en: 'The filters can be combined, and each can accept multiple parameters. For example,
    it is possible to fetch news in English and Spanish by adding the following string
    to the URL:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 过滤器可以组合使用，每个过滤器都可以接受多个参数。例如，可以通过在URL中添加以下字符串来获取英文和西班牙文的新闻：
- en: '[PRE7]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'In `news.ipynb`, we apply two filters, currency and kind:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在`news.ipynb`中，我们应用了两个过滤器：货币和类型：
- en: '[PRE8]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The API also offers professional paid options (named “pro” on their website)
    that enable access to extra metadata or to get links to the original sources.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 该API还提供专业付费选项（在其网站上称为“pro”），这些选项可以访问额外的元数据或获取原始来源的链接。
- en: 'What is also very interesting about this API is that the request returns the
    following:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 这个API的另一个有趣之处在于，返回的请求内容包括以下内容：
- en: The community’s opinion on the sentiment of the headline. This can be particularly
    useful for sourcing a sentiment analysis algorithm, such as the one we will build
    in [*Chapter 8*](B19446_08.xhtml#_idTextAnchor250).
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 社区对头条新闻情绪的看法。这对构建情绪分析算法尤为有用，例如我们将在[*第8章*](B19446_08.xhtml#_idTextAnchor250)中构建的算法。
- en: The timestamp of the published news. This enables us to join the headlines with
    prices, allowing us to compare the historical impact of the news on prices.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发布新闻的时间戳。这样我们就可以将头条新闻与价格结合起来，比较新闻对价格的历史影响。
- en: As seen in the introductory example at the beginning of the chapter, what happens
    on social networks can heavily impact prices even before any journalist writes
    about it. Therefore, it is important to add their input to our dataset.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 正如在本章开头的介绍示例中所看到的，社交网络上的事件甚至在记者写文章之前就能对价格产生重大影响。因此，重要的是将社交网络的数据添加到我们的数据集中。
- en: Adding social networks to our dataset
  id: totrans-192
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将社交网络添加到我们的数据集中
- en: Web3 is an online industry so everything that happens online, from opinions
    to interactions, holds significant influence.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: Web3是一个在线行业，因此在线发生的所有事件，从意见到互动，都具有重要的影响力。
- en: '**Sentiment analysis**, gauging reactions to products or tokens, plays a crucial
    role for marketing teams, analysts, and traders alike. A noteworthy example illustrating
    the importance of such metrics is the CoinStats Fear and Greed indicator. This
    index, available at [https://coinstats.app/fear-and-greed/](https://coinstats.app/fear-and-greed/),
    incorporates social media posts, among other factors, to measure market sentiment.'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '**情绪分析**，即衡量对产品或代币的反应，在营销团队、分析师和交易员中都发挥着至关重要的作用。一个突出的例子，说明了这种指标的重要性，就是CoinStats的恐惧与贪婪指数。这个指数可以在[https://coinstats.app/fear-and-greed/](https://coinstats.app/fear-and-greed/)查看，结合了社交媒体帖子等因素来衡量市场情绪。'
- en: '![Figure 3.20 – Crypto Fear and Greed Indicator](img/B19446_03_20.jpg)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![图3.20 – 加密恐惧与贪婪指数](img/B19446_03_20.jpg)'
- en: Figure 3.20 – Crypto Fear and Greed Indicator
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.20 – 加密恐惧与贪婪指数
- en: According to CoinStats’ explanation, the index combines data from various sources.
    To capture psychological momentum, they also draw insights from social media interactions
    on X, focusing on specific hashtags that carry both fear and greed components,
    which contribute to the overall calculation. The social media component holds
    a 15% weight in the final index, as per the documentation.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 根据CoinStats的解释，该指数结合了来自不同来源的数据。为了捕捉心理动能，它们还从X上的社交媒体互动中获取见解，专注于具有恐惧和贪婪元素的特定标签，这些因素共同参与了总体计算。根据文档，社交媒体因素在最终指数中占有15%的权重。
- en: X (formerly Twitter)
  id: totrans-198
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: X（前身为Twitter）
- en: X is probably the most important social media platform regarding Web3 conversations
    as of the day of this writing, and the service needs no presentation.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: X可能是目前Web3相关对话中最重要的社交媒体平台，而且该服务无需介绍。
- en: Note
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 注释
- en: We will use *X* and *Twitter* interchangeably. Although the platform’s user
    interface now bears the name X, on the developer tools side and in all URLs, it
    retains its former name, Twitter.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将*X*和*Twitter*交替使用。尽管该平台的用户界面现在使用的是X这个名称，但在开发者工具和所有网址中，它仍然保留着原来的名称Twitter。
- en: 'A paradigmatic example of how what happens on X impacts the industry is the
    majority opinion that the FTX exchange speedily crashed after Binance announced
    on their official X page, “*As a result of corporate due diligence, as well as
    the latest news reports regarding mishandled customer funds and alleged US agency
    investigations, we have decided that we will not pursue the potential acquisition
    of FTX.com*” (source: [https://twitter.com/binance/status/1590449161069268992](https://twitter.com/binance/status/1590449161069268992)).'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 一个典型的例子，说明了 X 上发生的事情如何影响行业，是在 Binance 在其官方 X 页面上宣布，“*由于公司尽职调查，以及关于客户资金处理不当和美国机构调查的最新新闻报道，我们决定不再追求对
    FTX.com 的潜在收购*”（来源：[https://twitter.com/binance/status/1590449161069268992](https://twitter.com/binance/status/1590449161069268992)）。
- en: Access to X data became a paid service in February 2023, with subscription details
    available through the developer portal at [https://developer.twitter.com/](https://developer.twitter.com/).
    The exercises in this section leverage the Basic subscription and API v2.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: X 数据访问自 2023 年 2 月起成为付费服务，订阅详情可通过开发者门户网站 [https://developer.twitter.com/](https://developer.twitter.com/)
    获得。本节中的练习使用了基础订阅和 API v2。
- en: To obtain API keys with reading privileges, we need to create a project and
    connect an app, as detailed in *Appendix 2*.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取具有读取权限的 API 密钥，我们需要创建一个项目并连接一个应用程序，具体步骤请参见 *附录 2*。
- en: 'Most user tweets are public, and a tailored query allows us to fetch tweets
    based on diverse criteria such as user, topic, language, or location. In `social.ipynb`,
    we extract the latest 100 tweets containing the words *Bitcoin* and *BTC*, excluding
    retweets and limited to the English language, using the following query:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数用户的推文是公开的，定制查询允许我们根据用户、主题、语言或位置等多种标准获取推文。在 `social.ipynb` 中，我们提取了最新的 100
    条包含 *Bitcoin* 和 *BTC* 的推文，排除了转发，并限制为英文推文，查询如下：
- en: '[PRE9]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Additional instructions for constructing effective queries can be found at [https://developer.twitter.com/en/docs/twitter-api/tweets/search/integrate/build-a-query](https://developer.twitter.com/en/docs/twitter-api/tweets/search/integrate/build-a-query).
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 有关构建有效查询的更多说明，请参见 [https://developer.twitter.com/en/docs/twitter-api/tweets/search/integrate/build-a-query](https://developer.twitter.com/en/docs/twitter-api/tweets/search/integrate/build-a-query)。
- en: Checkpoint
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 检查点
- en: A step-by-step version of the tweet extraction pipeline is detailed in `social.ipynb`.
    Alternatively, the resulting CSV file has been uploaded to the book’s GitHub and
    is accessible at `tweets_100.csv`.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 推文提取流程的逐步版本详见 `social.ipynb`。或者，生成的 CSV 文件已上传到本书的 GitHub，并可以在 `tweets_100.csv`
    中访问。
- en: 'With v2 endpoints, it is possible to request `annotations`, adding contextual
    information to tweets. This feature is valuable for data analysis as it normalizes
    content within a limited taxonomy. For instance, consider the tweet shown in *Figure
    3**.21*:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 v2 端点，可以请求 `annotations`，为推文添加上下文信息。此功能对数据分析非常有价值，因为它在有限的分类法中对内容进行标准化。例如，考虑
    *图 3.21* 中展示的推文：
- en: '![Figure 3.21 – Example tweet (ID: 1731806102101033329)](img/B19446_03_21.jpg)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![图 3.21 – 示例推文（ID: 1731806102101033329）](img/B19446_03_21.jpg)'
- en: 'Figure 3.21 – Example tweet (ID: 1731806102101033329)'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: '图 3.21 – 示例推文（ID: 1731806102101033329）'
- en: X offers entity recognition and context annotations for this tweet. `Person`,
    `Place`, `Product`, `Organization`, and `Other`.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: X 提供了实体识别和上下文注释功能，用于该推文。`Person`、`Place`、`Product`、`Organization` 和 `Other`。
- en: 'There are three entities recognized in the body of the tweet. Two are organizations
    –`Blackrock` and `SEC` – and the third is of the `Other` category, when referring
    to `Bitcoin`:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 推文正文中识别出三个实体。两个是组织 – `Blackrock` 和 `SEC` – 第三个属于 `Other` 类别，指的是 `Bitcoin`：
- en: '[PRE10]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The complete dictionary of entities for this tweet can be seen in `social.ipynb.`
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 该推文的完整实体字典可以在 `social.ipynb` 中查看。
- en: X further enriches tweet information through **context annotations**, which
    are inferred from the semantics of the text, keywords, and hashtags. A comprehensive
    list of keywords, hashtags, and handles has been developed, and tagged to specific
    contexts. If any of these elements appear in a tweet, they are appropriately tagged.
    As of June 2022, there are more than 80 context domains. The link to the relevant
    documentation can be found in the *Further* *reading* section.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: X 通过 **上下文注释**进一步丰富推文信息，这些注释是从文本的语义、关键词和标签中推断出来的。已经制定了一个全面的关键词、标签和用户名单，并根据具体上下文进行标记。如果这些元素出现在推文中，它们将被适当标记。截至
    2022 年 6 月，已有超过 80 个上下文领域。相关文档链接可以在 *进一步* *阅读* 部分找到。
- en: 'One example follows:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是一个示例：
- en: '[PRE11]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: This information is valuable for categorization and NLP machine learning algorithms.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 这些信息对于分类和自然语言处理（NLP）机器学习算法非常有价值。
- en: The complete list of context annotations for this tweet is available in `social.ipynb`.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 该推文的完整上下文注释列表可在`social.ipynb`中找到。
- en: A commonly employed method by marketing and product teams seeking insights into
    words associated with products or brands involves analyzing customer reviews,
    feedback, or social media comments. This approach provides a deeper understanding
    of the audience and their perceptions. One graphical way to achieve this is by
    creating word clouds, which highlight the most frequently mentioned words. This
    aids in identifying customer sentiments, preferences, and pain points at a glance.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 营销和产品团队常用的一种方法是分析与产品或品牌相关的词汇，这通常通过分析客户评论、反馈或社交媒体评论来实现。这种方法可以更深入地了解受众及其看法。实现这一目标的图形化方式之一是创建词云，突出显示最常被提到的词汇。这有助于一目了然地识别客户的情感、偏好和痛点。
- en: 'To reproduce a word cloud, we utilize tweets as the data source, specifically
    extracting 1,000 tweets targeting a protocol in the NFT space introduced in [*Chapter
    4*](B19446_04.xhtml#_idTextAnchor145) – namely, OpenSea. To perform this extraction,
    we used the following query:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 为了重现词云，我们利用推文作为数据源，特别是提取了1,000条针对NFT领域中的一个协议（在[*第4章*](B19446_04.xhtml#_idTextAnchor145)中介绍）——即OpenSea的推文。为了执行此提取，我们使用了以下查询：
- en: '[PRE12]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Checkpoint
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 检查点
- en: A step-by-step version of the tweet extraction pipeline is detailed in `social.ipynb`.
    Alternatively, the resulting CSV file has been uploaded to the book’s GitHub and
    is accessible at `tweets_df.csv`.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 推文提取管道的逐步版本详见`social.ipynb`。另外，生成的CSV文件已上传到本书的GitHub，并可以通过`tweets_df.csv`访问。
- en: 'In the notebook, we will find libraries and methods to clean the tweets to
    normalize them before counting the frequency of appearance of the words. These
    are traditional NLP steps that we will describe in more detail in [*Chapter 8*](B19446_08.xhtml#_idTextAnchor250).
    The resulting word cloud for OpenSea is shown in *Figure 3**.22*:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 在笔记本中，我们将找到用于清理推文的库和方法，在计算单词出现频率之前对其进行标准化。这些是传统的NLP步骤，我们将在[*第8章*](B19446_08.xhtml#_idTextAnchor250)中更详细地描述。OpenSea的词云结果如*图3.22*所示：
- en: '![Figure 3.22 – OpenSea word cloud](img/B19446_03_22.jpg)'
  id: totrans-228
  prefs: []
  type: TYPE_IMG
  zh: '![图3.22 – OpenSea词云](img/B19446_03_22.jpg)'
- en: Figure 3.22 – OpenSea word cloud
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.22 – OpenSea词云
- en: Once we learn to extract social off-chain data, we can combine it with on-chain
    data to expand our analysis. Tweets, Discord conversations, Telegram interactions,
    and other community forums have timestamps and geo-location tags that can be used
    to merge off-chain activity with transactions occurring on-chain. This helps analysts
    infer the active hours of a chain or a protocol, deduce the geographic location
    of customers, and more. These types of analyses are typically requested by marketing
    teams to improve the direction of their campaigns.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们学会提取社交链外数据，就可以将其与链上数据结合，扩展我们的分析。推文、Discord对话、Telegram互动以及其他社区论坛都有时间戳和地理位置标签，可以用于将链外活动与链上发生的交易进行合并。这有助于分析师推测链或协议的活跃时间、推断客户的地理位置等。这些类型的分析通常是营销团队请求的，以改善他们广告活动的方向。
- en: An example of a company leveraging this connection between the two worlds is
    Spindl, which is working on merging Web2 marketing data sources with on-chain
    data to build the first marketing funnel tool for the Web3 space.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 一个利用这两种世界之间连接的公司例子是Spindl，该公司正在努力将Web2营销数据源与链上数据合并，以构建Web3领域的第一个营销漏斗工具。
- en: A note on Twitter profiles to follow
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 一个关于Twitter个人资料的说明
- en: 'Here are some interesting profiles to follow for Web3 data analysis/content,
    among many others:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一些有趣的个人资料可以关注，以进行Web3数据分析/内容创作，除此之外还有许多其他有趣的个人资料：
- en: '`@``0xGembus`: [https://twitter.com/0xGembus](https://twitter.com/0xGembus)'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '`@``0xGembus`: [https://twitter.com/0xGembus](https://twitter.com/0xGembus)'
- en: '`@``0xAtomist`: [https://twitter.com/0xAtomist](https://twitter.com/0xAtomist)'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '`@``0xAtomist`: [https://twitter.com/0xAtomist](https://twitter.com/0xAtomist)'
- en: '`@``hildobby_`: [https://twitter.com/hildobby_](https://twitter.com/hildobby_)'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '`@``hildobby_`: [https://twitter.com/hildobby_](https://twitter.com/hildobby_)'
- en: 'Other social media data sources to explore are as follows:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 其他值得探索的社交媒体数据源如下：
- en: '**Reddit**: This platform hosts numerous Web3-related conversations in the
    form of Subreddits. The posts and comments within these Subreddits offer valuable
    information.'
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Reddit**：该平台托管了许多与Web3相关的对话，形式为Subreddits。Subreddit中的帖子和评论提供了宝贵的信息。'
- en: '**BitcoinTalk.org forum**: The public posts on this forum also serve as an
    interesting source of information.'
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BitcoinTalk.org 论坛**：该论坛上的公开帖子也是一个有趣的信息来源。'
- en: Summary
  id: totrans-240
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we examined various off-chain sources of data relevant to the
    Web3 economy, categorizing the analysis into three main areas. For prices, we
    explored multiple APIs from traditional sources to exchanges, as well as an oracle.
    With news, we learned how to extract real-time headlines from the best dedicated
    news indexer as of the time of writing – namely, CryptoPanic. For X (formerly
    Twitter), we utilized its API to gauge the sentiment around an NFT protocol. This
    list of resources is not exhaustive, and we have only scratched the surface of
    the uses we can give to all this data.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们考察了与 Web3 经济相关的各种链外数据来源，并将分析分为三个主要领域。对于价格，我们探索了来自传统来源到交易所的多个 API，以及一个预言机。关于新闻，我们学习了如何提取实时头条，这些头条来自当时最优秀的专门新闻索引器——CryptoPanic。至于
    X（前身为 Twitter），我们利用其 API 来衡量围绕 NFT 协议的情绪。这个资源清单并不详尽，我们只触及了我们能够为这些数据提供的所有用途的表面。
- en: In the next chapter, we will delve into NFTs and their applications in the gaming,
    art, and name service industries.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将深入探讨NFT及其在游戏、艺术和命名服务行业中的应用。
- en: Further reading
  id: totrans-243
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'To complement this chapter, the following links may help:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 为了补充本章，以下链接可能对你有所帮助：
- en: 'Prices:'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 价格：
- en: Support CoinMarketCap. (2020). Security check. How are prices calculated on
    CoinMarketCap? [https://support.coinmarketcap.com/hc/en-us/articles/360015968632-How-are-prices-calculated-on-CoinMarketCap-](https://support.coinmarketcap.com/hc/en-us/articles/360015968632-How-are-prices-calculated-on-CoinMarketCap-)
  id: totrans-246
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持 CoinMarketCap。（2020）。安全检查。如何计算 CoinMarketCap 上的价格？[https://support.coinmarketcap.com/hc/en-us/articles/360015968632-How-are-prices-calculated-on-CoinMarketCap-](https://support.coinmarketcap.com/hc/en-us/articles/360015968632-How-are-prices-calculated-on-CoinMarketCap-)
- en: Crypto API documentation. (n.d.). CoinGecko. [https://www.coingecko.com/api/documentation](https://www.coingecko.com/es/api/documentation)
  id: totrans-247
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密 API 文档。（无日期）。CoinGecko。[https://www.coingecko.com/api/documentation](https://www.coingecko.com/es/api/documentation)
- en: Account. (n.d.). Cryptocurrency Prices, Charts And Market Capitalizations |
    CoinMarketCap. [https://coinmarketcap.com/api/documentation/v1/](https://coinmarketcap.com/api/documentation/v1/)
  id: totrans-248
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 账户。（无日期）。加密货币价格、图表与市值 | CoinMarketCap。[https://coinmarketcap.com/api/documentation/v1/](https://coinmarketcap.com/api/documentation/v1/)
- en: CoinMarketCap. (n.d.). Most trusted cryptocurrency market data API | CoinMarketCap.
    coinmarketcap.com. [https://coinmarketcap.com/api/faq](https://coinmarketcap.com/api/faq)
  id: totrans-249
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: CoinMarketCap。（无日期）。最受信任的加密货币市场数据 API | CoinMarketCap。coinmarketcap.com。[https://coinmarketcap.com/api/faq](https://coinmarketcap.com/api/faq)
- en: 'Useful Chainlink tutorials. Chainlink. (2022). Learning resources. Chainlink
    documentation: [https://docs.chain.link/getting-started/other-tutorials/](https://docs.chain.link/getting-started/other-tutorials/)'
  id: totrans-250
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有用的 Chainlink 教程。Chainlink。（2022）。学习资源。Chainlink 文档：[https://docs.chain.link/getting-started/other-tutorials/](https://docs.chain.link/getting-started/other-tutorials/)
- en: 'To further expand on oracles. Chainlink, *What is an Oracle in blockchain?
    » explained*. Blockchain Oracles for Hybrid Smart Contracts | Chainlink: [https://chain.link/education/blockchain-oracles](https://chain.link/education/blockchain-oracles)'
  id: totrans-251
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '进一步扩展关于预言机的内容。Chainlink，*区块链中的预言机是什么？ » 解释*。Chainlink: 混合智能合约的区块链预言机：[https://chain.link/education/blockchain-oracles](https://chain.link/education/blockchain-oracles)'
- en: Data feeds API reference. (n.d.). Chainlink documentation. [https://docs.chain.link/data-feeds/api-reference](https://docs.chain.link/data-feeds/api-reference)
  id: totrans-252
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据流 API 参考。（无日期）。Chainlink 文档。[https://docs.chain.link/data-feeds/api-reference](https://docs.chain.link/data-feeds/api-reference)
- en: Price feed contract addresses. (n.d.). Chainlink Documentation. [https://docs.chain.link/data-feeds/price-feeds/addresses/](https://docs.chain.link/data-feeds/price-feeds/addresses/)
  id: totrans-253
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 价格信息合约地址。（无日期）。Chainlink 文档。[https://docs.chain.link/data-feeds/price-feeds/addresses/](https://docs.chain.link/data-feeds/price-feeds/addresses/)
- en: 'News:'
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新闻：
- en: For a step-by-step process to download a website. Furneaux, Nick. “Investigating
    Cryptocurrencies. Understanding, Extracting, and Analyzing Blockchain Evidence”
    Wiley, 2018\. [*Chapter 8*](B19446_08.xhtml#_idTextAnchor250).- Pages 125 to 130.
  id: totrans-255
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 下载网站的逐步过程。Furneaux, Nick。“调查加密货币。理解、提取与分析区块链证据” Wiley，2018。[*第8章*](B19446_08.xhtml#_idTextAnchor250)。-
    第125至130页。
- en: 'Social networks:'
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 社交网络：
- en: Installation — Tweepy 4.13.0 documentation. (n.d.). Tweepy Documentation — tweepy
    4.13.0 documentation. [https://docs.tweepy.org/en/stable/install.xhtml](https://docs.tweepy.org/en/stable/install.xhtml)
  id: totrans-257
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装 — Tweepy 4.13.0 文档。（无日期）。Tweepy 文档 — tweepy 4.13.0 文档。[https://docs.tweepy.org/en/stable/install.xhtml](https://docs.tweepy.org/en/stable/install.xhtml)
- en: Getting-started-with-the-twitter-api-v2-for-academic-research/5-how-to-write-search-queries.md
    at main · twitterdev/getting-started-with-the-twitter-api-v2-for-academic-research.
    (n.d.). GitHub. [https://github.com/twitterdev/getting-started-with-the-twitter-api-v2-for-academic-research/blob/main/modules/5-how-to-write-search-queries.md](https://github.com/twitterdev/getting-started-with-the-twitter-api-v2-for-academic-research/blob/main/modules/5-how-to-write-search-queries.md)
  id: totrans-258
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Getting-started-with-the-twitter-api-v2-for-academic-research/5-how-to-write-search-queries.md
    at main · twitterdev/getting-started-with-the-twitter-api-v2-for-academic-research.
    (n.d.). GitHub. [https://github.com/twitterdev/getting-started-with-the-twitter-api-v2-for-academic-research/blob/main/modules/5-how-to-write-search-queries.md](https://github.com/twitterdev/getting-started-with-the-twitter-api-v2-for-academic-research/blob/main/modules/5-how-to-write-search-queries.md)
- en: Overview. (n.d.). Use Cases, Tutorials, and Documentation | Twitter Developer
    Platform. [https://developer.twitter.com/en/docs/twitter-api/annotations/overview](https://developer.twitter.com/en/docs/twitter-api/annotations/overview)
    and [https://developer.twitter.com/en/docs/twitter-api/annotations/faq](https://developer.twitter.com/en/docs/twitter-api/annotations/faq)
  id: totrans-259
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 概述. (n.d.). 用例、教程和文档 | Twitter 开发者平台. [https://developer.twitter.com/en/docs/twitter-api/annotations/overview](https://developer.twitter.com/en/docs/twitter-api/annotations/overview)
    和 [https://developer.twitter.com/en/docs/twitter-api/annotations/faq](https://developer.twitter.com/en/docs/twitter-api/annotations/faq)
