- en: Statistical Modeling in Anaconda
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Anaconda中的统计建模
- en: 'In this chapter, we will first present the simplest statistical model: the
    one-factor linear model. To make the learning process more interesting, we will
    discuss an application of such a model: the famous financial model called the **Capital
    Asset Pricing Model** (**CAPM**). In terms of processing data, we will show you
    how to detect and remove missing values, and how to replace missing values with
    means or other values in R, Python, or Julia. Also, **outliers** would distort
    our statistical results. Thus, we need to know how to detect and deal with them.
    After that, we talk about multi-factor linear models. Again, to make our discussion
    more meaningful, we will discuss the famous **Fama-French** 3-factor and 5-factor
    linear models, and the **Fama-French-Carhart** 4-factor linear model. Then, we
    will discuss how to rank those different models, that is, how to measure the performance
    of different models. In this chapter, the following topics will be covered:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将首先介绍最简单的统计模型：单因子线性模型。为了让学习过程更加有趣，我们将讨论该模型的一个应用：著名的金融模型——**资本资产定价模型**（**CAPM**）。在数据处理方面，我们将向你展示如何检测和删除缺失值，以及如何在R、Python或Julia中用均值或其他值替换缺失值。此外，**异常值**会扭曲我们的统计结果。因此，我们需要知道如何检测并处理异常值。接下来，我们将讨论多因子线性模型。同样，为了使讨论更加有意义，我们将讨论著名的**法马-弗伦奇**3因子和5因子线性模型，以及**法马-弗伦奇-卡哈特**4因子线性模型。然后，我们将讨论如何对这些不同的模型进行排名，即如何衡量不同模型的表现。本章将涵盖以下内容：
- en: Introduction to linear models
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 线性模型介绍
- en: Running a linear regression in R, Python, Julia, and Octave
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在R、Python、Julia和Octave中运行线性回归
- en: Critical value and the decision rule
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 临界值和决策规则
- en: F-test, critical value, and the decision rule
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: F检验、临界值和决策规则
- en: Dealing with missing data
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 处理缺失数据
- en: Detecting outliers and treatments
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检测异常值及其处理
- en: Several multivariate linear models
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 几个多元线性模型
- en: Collinearity and its solution
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 共线性及其解决方案
- en: A model's performance measure
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型的性能衡量
- en: Introduction to linear models
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 线性模型介绍
- en: 'The one-factor linear model is the simplest way to show a relationship between
    two variables: *y* and *x*. In other words, we try to use *x* to explain *y*.
    The general form for a one-factor linear model is given here, where *y[t]* is
    the dependent variable at time *t*, *α* is the intercept, β is the slope, *x[t]*
    is the value of an independent variable at time *t*, and *ε[t]* is a random term:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 单因子线性模型是展示两个变量（*y*和*x*）之间关系的最简单方式。换句话说，我们尝试用*x*来解释*y*。单因子线性模型的一般形式如下所示，其中*y[t]*是时间*t*的因变量，*α*是截距，β是斜率，*x[t]*是时间*t*的独立变量的值，*ε[t]*是随机项：
- en: '![](img/f297f98b-bbf1-4ffd-9c98-ae239138099c.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f297f98b-bbf1-4ffd-9c98-ae239138099c.png)'
- en: 'To run a linear regression, we intend to estimate the intercept (*α*) and the
    slope (*β*). One-factor means that the model has just one explanatory variable,
    that is, one independent variable of `x`, and linear means that when drawing a
    graph based on the equation (1), we would have a straight line. With the following
    R program, we could get a linear line:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行线性回归，我们打算估计截距(*α*)和斜率(*β*)。单因子意味着模型只有一个解释变量，也就是`x`的一个独立变量，线性意味着当根据方程（1）绘制图表时，我们会得到一条直线。通过以下R程序，我们可以得到一条线性线：
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The related graph is shown here:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 相关图表如下所示：
- en: '![](img/331f78ac-5e43-44cb-a036-eb3166523eed.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](img/331f78ac-5e43-44cb-a036-eb3166523eed.png)'
- en: Another explanation for a linear model is that the power of the independent
    variable of `x` is `1`. There are many applications for such a simple one-factor
    linear model. Later in the chapter, we present the famous CAPM, which is a one-factor
    linear model.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 线性模型的另一个解释是独立变量`x`的幂为`1`。这样的简单单因子线性模型有很多应用。在本章稍后部分，我们将介绍著名的CAPM，它就是一个单因子线性模型。
- en: Running a linear regression in R, Python, Julia, and Octave
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在R、Python、Julia和Octave中运行线性回归
- en: 'The following code block shows how to run such a one-factor linear regression
    in R:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码块展示了如何在R中运行一个单因子线性回归：
- en: '[PRE1]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The first line of `set.seed(12345)` guarantees that different users will get
    the same random numbers when the same `seed()` is applied, that is, `12345` in
    this case. The R function `rnorm(n)` is used to generate *n* random numbers from
    a standard normal distribution. Also, the two letters of the `lm()` function stand
    for linear model. The result is shown here:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 第一行的 `set.seed(12345)` 确保不同的用户在使用相同的 `seed()` 时会得到相同的随机数，这里的 `seed` 值是 `12345`。R
    函数 `rnorm(n)` 用于从标准正态分布中生成 *n* 个随机数。同时，`lm()` 函数的两个字母代表线性模型。结果如下所示：
- en: '[PRE2]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The estimated intercept is `4.11`, while the estimated slope is `5.00`. To
    get more information about the function, we can use the `summary()` function,
    shown in the following code:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 估计的截距为 `4.11`，估计的斜率为 `5.00`。要获取更多关于该函数的信息，我们可以使用 `summary()` 函数，如下所示：
- en: '[PRE3]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The alpha, that is, the intercept, is `4.11` and it is statistically significant.
    The reason is that its T-value is `18.27`, which is higher than `2` if we choose
    a 5% significance value. However, it is also significant at any significance level,
    indicated by the three stars: `***`. Alternatively, we could look at its P-value
    to determine significance. With the same logic, the slope value is `5`, which
    is statistically significant. Usually, we have the following two critical values
    for the T-value:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 截距 alpha 为 `4.11`，并且具有统计学意义。原因在于其 T 值为 `18.27`，如果我们选择 5% 的显著性水平，该值高于 `2`。然而，它在任何显著性水平下都是显著的，表示为三个星号：`***`。另外，我们也可以通过其
    P 值来确定显著性。按照相同的逻辑，斜率值为 `5`，同样具有统计学意义。通常，我们有以下两个临界值用于 T 值：
- en: '![](img/46d5ad70-5beb-4521-bf68-71f6b2cdaf79.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](img/46d5ad70-5beb-4521-bf68-71f6b2cdaf79.png)'
- en: 'Alternatively, we have the following decision rule for *pValue*:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，我们有以下 *pValue* 的决策规则：
- en: '![](img/1ea7a5bc-ebed-41aa-86ee-9199a2a9311e.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1ea7a5bc-ebed-41aa-86ee-9199a2a9311e.png)'
- en: 'The following Python code would run a linear regression:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 以下的 Python 代码将运行线性回归：
- en: '[PRE4]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Similarly, in the following code, for a set of *x* and *y* values, we could
    run a linear regression in Julia:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，在以下代码中，对于一组 *x* 和 *y* 值，我们可以在 Julia 中运行线性回归：
- en: '[PRE5]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The related output is shown here:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 相关输出如下所示：
- en: '![](img/b6a1c1d9-eb98-4d12-889e-6082f063bf22.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b6a1c1d9-eb98-4d12-889e-6082f063bf22.png)'
- en: 'Note that there is no meaning in `X` and `Y` since their values are arbitrarily
    chosen. Based on the z values for both intercept and *β*, we can conclude that
    the intercept is statistically the same as zero since its `z value` is `-1.09`
    and the slope is statistically different from zero since its `z value` if `8.66`.
    In the previous Julia program, we assume that the `GLM` package is installed.
    If not, see the following screenshot to install the package:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，`X` 和 `Y` 没有实际意义，因为它们的值是任意选择的。基于截距和 *β* 的 z 值，我们可以得出结论：截距在统计上与零相同，因为其 `z
    值` 为 `-1.09`，而斜率在统计上与零不同，因为其 `z 值` 为 `8.66`。在前面的 Julia 程序中，我们假设已安装 `GLM` 包。如果没有，请参见以下截图安装该包：
- en: '![](img/f0b74a26-0d21-4ef8-acf0-79d384ebcfde.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f0b74a26-0d21-4ef8-acf0-79d384ebcfde.png)'
- en: 'In other words, if the `DataFrames` Julia package is not installed, we need
    to issue a command of `Pkg.add("DataFrames")`. For more information on handling
    various packages for R, Python, and Julia, see [Chapter 6](c812a40e-eb24-4bb8-8af5-1cfe1834ec77.xhtml),
    *Managing Packages*. To run a linear regression for Octave, we generate `x` and
    `y` first:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，如果未安装 `DataFrames` Julia 包，我们需要执行命令 `Pkg.add("DataFrames")`。有关如何处理 R、Python
    和 Julia 中的各种包，请参见[第 6 章](c812a40e-eb24-4bb8-8af5-1cfe1834ec77.xhtml)，*管理包*。要在
    Octave 中运行线性回归，我们首先生成 `x` 和 `y`：
- en: '[PRE6]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The related graph is shown here:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 相关图表如下所示：
- en: '![](img/d0a55b69-6dec-4280-8b27-5ca391e2e651.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d0a55b69-6dec-4280-8b27-5ca391e2e651.png)'
- en: 'Based on the previously generated `x` and `y` values, we have the following
    Octave program to run a linear regression:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 基于之前生成的 `x` 和 `y` 值，我们可以编写以下 Octave 程序来运行线性回归：
- en: '[PRE7]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Critical value and the decision rule
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 临界值和决策规则
- en: 'A T-test is any statistical hypothesis test in which the test statistic follows
    a student''s T-distribution under the null hypothesis. It can be used to determine
    whether two sets of data are significantly different from each other. For a one-sample
    *T*-test and for the null hypothesis that the mean is equal to a specified value
    *μ[0]*, we use the following statistic, where *t* is the T-value, ![](img/98cefac5-8dc6-4f27-ad6c-f9d66caf3882.png) is
    the sample mean, *μ[0]* is the our assumed return mean, *σ* is the sample standard
    deviation of the sample, *n* is the sample size, and *S.E.* is the standard error:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: T检验是任何统计假设检验，在零假设下，检验统计量遵循学生的T分布。它可以用来判断两组数据是否显著不同。对于单样本*T*检验，假设零假设为均值等于指定值*μ[0]*，我们使用以下统计量，其中*t*为T值，![](img/98cefac5-8dc6-4f27-ad6c-f9d66caf3882.png)为样本均值，*μ[0]*为假设的均值，*σ*为样本标准差，*n*为样本大小，*S.E.*为标准误差：
- en: '![](img/adc69a2d-b42c-40bc-93dc-8a4db2806f62.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](img/adc69a2d-b42c-40bc-93dc-8a4db2806f62.png)'
- en: 'The degrees of freedom used in this test are *n - 1*. The critical *T*-value
    is used to accept or reject the null hypothesis. The decision rule is given here:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 该检验中使用的自由度为*n - 1*。临界*T*值用于接受或拒绝零假设。决策规则如下：
- en: '![](img/c70c67be-bbcc-499c-a644-45093038d010.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c70c67be-bbcc-499c-a644-45093038d010.png)'
- en: 'In the previous section, we mentioned two critical values: `2` for a T-value
    and `0.05` for a P-value. Actually, those two critical values are correlated.
    For a 5% critical P-value, its related critical T-value will be about `2`. The
    following function, `qt()`, shows this relationship:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一部分中，我们提到了两个临界值：`2`为T值，`0.05`为P值。实际上，这两个临界值是相关的。对于5%的临界P值，其相关的临界T值大约为`2`。以下函数`qt()`显示了这种关系：
- en: '[PRE8]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The general function will be:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 一般函数为：
- en: '![](img/5b3af1cd-1922-4397-98fa-aa85f8917347.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5b3af1cd-1922-4397-98fa-aa85f8917347.png)'
- en: 'where `qt()` is the student''s T-distribution, α is the significance level,
    such as 1%, 5%, or 10%, *degree_freedom* is the degree of freedom (*n-p*) where
    *n* is the number of data points, and *p* is the number of repressors, that is,
    the number of independent variables. When we want a much stronger result, we can
    choose `0.01` as our *α*. Assume that from the code that follows, our degree of
    freedom is `50`; the corresponding critical T-value will be `2.68`:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，`qt()`是学生T分布，α是显著性水平，如1%、5%或10%，*degree_freedom*是自由度（*n-p*），其中*n*为数据点的数量，*p*为回归系数的数量，即独立变量的数量。当我们需要更强的结果时，可以选择`0.01`作为*α*。假设在下面的代码中，我们的自由度为`50`，对应的临界T值为`2.68`：
- en: '[PRE9]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The following Python code would give us the critical value for a two-sided
    test:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 以下Python代码将给出双侧检验的临界值：
- en: '[PRE10]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: F-test, critical value, and the decision rule
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: F检验，临界值及决策规则
- en: 'In the previous examples, we saw the F-value for the performance of the whole
    model. Now, let''s look at the F-distribution. Assume that *x[1]* and *x[2]* are
    two independent random variables with the [Chi-Square distribution](http://www.r-tutor.com/node/60)
    with *df[1]* and *df[2]* degrees of freedom, respectively. The ratio of *x[1]/df[1]*
    divided by *x[2]/df[2]* would follow an F-distribution:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的例子中，我们看到了整个模型的F值。现在，让我们来看一下F分布。假设*x[1]*和*x[2]*是两个独立的随机变量，分别服从[卡方分布](http://www.r-tutor.com/node/60)，自由度分别为*df[1]*和*df[2]*。则*x[1]/df[1]*与*x[2]/df[2]*的比值将遵循F分布：
- en: '![](img/6aa00651-92ca-4301-8aa6-1a9f3e271d57.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6aa00651-92ca-4301-8aa6-1a9f3e271d57.png)'
- en: 'An R program to draw a graph for the F distribution with (10, 2) degrees of
    freedom is shown here:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是一个R程序，用于绘制自由度为(10, 2)的F分布图：
- en: '[PRE11]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The related plot is shown here:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 相关图示如下：
- en: '![](img/113bf502-a271-4cd5-9bce-3d652065a80b.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](img/113bf502-a271-4cd5-9bce-3d652065a80b.png)'
- en: 'The following R program shows the critical value for a given α of `0.1` and
    (1, 2) degrees of freedom:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 以下R程序显示了给定α为`0.1`和自由度为(1, 2)时的临界值：
- en: '[PRE12]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The following Python program estimates the critical F-value:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 以下Python程序估算临界F值：
- en: '[PRE13]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: The related decision rule is that if our F-value is higher than the critical
    value, we would conclude that our overall model is significant.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 相关的决策规则是，如果我们的F值高于临界值，我们将得出结论，认为整体模型是显著的。
- en: An application of a linear regression in finance
  id: totrans-69
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 线性回归在金融中的应用
- en: 'In finance, a famous application of a one-factor linear model is associated
    with CAPM, which was developed in the 1960s; see *Sharpe* (1964), *Litner* (1965),
    and *Mossin* (1966). Up until today, CAPM has been discussed in almost all finance
    textbooks because of its simplicity and usefulness. Its general formula is shown
    here:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在金融学中，著名的单因子线性模型应用之一与CAPM相关，该模型于1960年代开发；参见*Sharpe*（1964）、*Litner*（1965）和*Mossin*（1966）。直到今天，CAPM几乎在所有的金融教材中都有讨论，因为它的简便性和实用性。其通用公式如下所示：
- en: '![](img/fc6e90ba-1bda-45c6-ad7f-7eb7ee26fd87.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fc6e90ba-1bda-45c6-ad7f-7eb7ee26fd87.png)'
- en: 'where `E()` is the expectation, *R[i]* is return for stock *i*, R[f] is the
    risk-free interest rate, and *E(R[mkt])* is the expected market return. Usually,
    we could use the S&P500 index as our market index. The slope of the equation,
    that is *β*, is a measure of the market risk. For individual stock, β represents
    the sensitivity of a stock''s expected returns in response to the market risk
    premium, that is, E(R[mkt])-R[f]. A risk premium represents the required extra
    return for bearing extra risk when compared with the risk-free rate. The following
    formula could be used to estimate *β*, where *β[i]* is the beta for stock *i*,
    *cov(R[i],R[m])* is the covariance between the returns of stock i, and the returns
    of a market index, *ρ,* is the correlation between stock *i* and the market index. *σ[i]*
    is the standard deviation of stock *i* and *σ[m]* is the standard deviation of
    the market index:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 其中`E()`是期望值，*R[i]*是股票*i*的回报，R[f]是无风险利率，*E(R[mkt])*是预期的市场回报。通常，我们可以使用S&P500指数作为我们的市场指数。方程的斜率，即*β*，是市场风险的衡量指标。对于单个股票，β表示股票预期回报对市场风险溢价的敏感度，即E(R[mkt])-R[f]。风险溢价表示相对于无风险利率，承担额外风险所需的额外回报。以下公式可以用来估算*β*，其中*β[i]*是股票*i*的贝塔值，*cov(R[i],R[m])*是股票i的回报与市场指数回报之间的协方差，*ρ*是股票*i*与市场指数之间的相关性，*σ[i]*是股票*i*的标准差，*σ[m]*是市场指数的标准差：
- en: '![](img/a17e8178-c7c3-4ea6-8ceb-83a647a27827.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a17e8178-c7c3-4ea6-8ceb-83a647a27827.png)'
- en: 'For the beta value, we could run a linear regression for CAPM by using historical
    data. There is another variable of the previous formula shown next, where *R[i,t]* is
    stock i''s return at time *t*, *R[f,t]* is the risk-free interest rate at time
    t, and R[mkt,t] is the market return at time t while ![](img/4436b8c9-48f4-4ffe-82f0-591a062c4f95.png) is
    a random factor:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 对于贝塔值，我们可以通过使用历史数据运行CAPM的线性回归。下述公式显示了之前公式的另一个变量，其中*R[i,t]*是股票i在时间*t*的回报，*R[f,t]*是时间t的无风险利率，R[mkt,t]是时间t的市场回报，而![](img/4436b8c9-48f4-4ffe-82f0-591a062c4f95.png)是一个随机因素：
- en: '![](img/461d54bd-94ba-4d06-b3d9-75a5df45d38a.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](img/461d54bd-94ba-4d06-b3d9-75a5df45d38a.png)'
- en: 'The previous equation associated with CAPM can be applied to estimate the expected
    cost of equity, that is, the expected stock return, after we estimate the beta
    successfully. In the preceding variation, one added advantage is that the logic
    of CAPM is much clearer. On the left-hand side, we have an individual stock''s
    risk premium while on the right-hand side, we have the market risk premium, shown
    in the following:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 之前与CAPM相关的方程可以用来估算预期的股本成本，即预期的股票回报率，在我们成功估算出贝塔值后。在前述的变式中，一个附加的优点是CAPM的逻辑更加清晰。在左侧，我们有单个股票的风险溢价，而在右侧，我们有市场的风险溢价，如下所示：
- en: '![](img/99c63600-13e7-4f4e-8bf7-67482c21140e.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/99c63600-13e7-4f4e-8bf7-67482c21140e.png)'
- en: 'Later in the chapter, we will show you how to run CAPM by using historical
    monthly stock data and the *S&P500* data as the market index; programs written
    in R, Python, and Julia will be available. Using R, we could estimate a stock''s
    market risk, that is, the beta value. First, let''s write a function called `ret_f()`
    to estimate returns for a given input price dataset:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章后面，我们将展示如何使用历史的月度股票数据和*S&P500*数据作为市场指数来运行CAPM；将提供R、Python和Julia编写的程序。使用R语言，我们可以估算股票的市场风险，即贝塔值。首先，让我们编写一个名为`ret_f()`的函数，用于估算给定输入价格数据集的回报：
- en: '[PRE14]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'In the previous R program, we define a function called `ret_f()`. Then, we
    call this function twice to estimate returns for the download IBM''s price data
    and S&P500 monthly data. Again, these two time series can be manually downloaded
    from Yahoo!Finance at [http://finance.yahoo.com](http://finance.yahoo.com). The
    first several lines of the final dataset are shown here:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的R程序中，我们定义了一个名为`ret_f()`的函数。然后，我们调用该函数两次，用于估算下载IBM价格数据和S&P500月度数据的回报。同样，这两个时间序列可以从Yahoo!Finance手动下载，网址为[http://finance.yahoo.com](http://finance.yahoo.com)。最终数据集的前几行如下所示：
- en: '[PRE15]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Now, we can apply the `lm()` function, shown as follows, with the corresponding
    output:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以应用`lm()`函数，如下所示，并附上相应输出：
- en: '![](img/e85e6273-de2b-444d-bbf5-c3418169187b.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e85e6273-de2b-444d-bbf5-c3418169187b.png)'
- en: 'Based on the result, the intercept is `0.00277` and it is not statistically
    significant. The slope (or the beta value) is `0.96`, which is statically significant.
    R2 is 35%, which means that the model could explain 35% of the variation in the
    dependent variable. The F-statistic is a measure of goodness of fit of the whole
    model, which is statistically significant since its P-value is extremely small.
    Note that for the previous beta estimation, we use the whole input data set, that
    is, all years, while in real-world market risk (*β*) estimation, researchers or
    professionals working on Wall Street usually use only a few years'' data, such
    as a 3-year window. Before writing a Python program to estimate a stock''s beta,
    first we have to retrieve stock data from `quandl`, shown in the program here:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 根据结果，截距为`0.00277`，且统计上不显著。斜率（或β值）为`0.96`，统计上显著。R2为35%，这意味着该模型可以解释因变量变异的35%。F统计量是衡量整个模型拟合优度的指标，因其P值极小，统计上显著。请注意，对于前面的β估计，我们使用了整个输入数据集，即所有年份的数据，而在实际市场风险（*β*）估计中，研究人员或华尔街的专业人士通常只使用几年的数据，例如3年的窗口期。在编写Python程序估算股票的β值之前，首先我们需要从`quandl`获取股票数据，程序如下：
- en: '[PRE16]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The related output is shown in the following screenshot:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 相关输出在以下截图中展示：
- en: '![](img/b6d0497f-2d3f-438f-98e1-cf27becafca2.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b6d0497f-2d3f-438f-98e1-cf27becafca2.png)'
- en: 'From the previous output, we know that the frequency of data is daily. For
    monthly data, we have the following Python code:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的输出中，我们知道数据的频率是日数据。对于月度数据，我们可以使用以下Python代码：
- en: '[PRE17]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '`quandl` is a data delivery platform which includes many free datasets, but
    users might need to register to get specific datasets (for a more detailed discussion,
    see [Chapter 3](b40472e2-4998-4d7c-ac22-b77f4ad21a22.xhtml), *Data Basics*). The
    following Python program downloads IBM''s monthly data from `quandl` and the monthly
    S&P500 market index data from the author''s website, and runs a linear regression
    to get the market risk, that is, β for IBM:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '`quandl`是一个数据交付平台，包含许多免费的数据集，但用户可能需要注册以获取特定数据集（详细讨论请参见[第3章](b40472e2-4998-4d7c-ac22-b77f4ad21a22.xhtml)，*数据基础*）。以下Python程序从`quandl`下载IBM的月度数据以及从作者网站下载的S&P500市场指数月度数据，并运行线性回归以获得市场风险，即IBM的β值：'
- en: '[PRE18]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The related output is shown here:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 相关输出如下所示：
- en: '[PRE19]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'By using daily data, the next Python program estimates the annual betas for
    Walmart, with a ticker symbol of WMT using `quandl` to download data:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 使用日数据，下面的Python程序通过`quandl`下载数据来估算沃尔玛（WMT）的年β值：
- en: '[PRE20]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The related output is shown here:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 相关输出如下所示：
- en: '![](img/11262017-2fb0-4a63-a536-5dfdba3a6d0c.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/11262017-2fb0-4a63-a536-5dfdba3a6d0c.png)'
- en: 'In the following Julia program, we assume that two files are downloaded from
    Yahoo!Finance at [http://finance.yahoo.com](http://finance.yahoo.com). Those input
    files are `ibmMonthly5years.csv` and `sp500Monthly5years.csv`, and they are the
    latest 5-year monthly historical data. The Julia program is given here:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的Julia程序中，我们假设从Yahoo!Finance下载了两个文件：[http://finance.yahoo.com](http://finance.yahoo.com)。这些输入文件是`ibmMonthly5years.csv`和`sp500Monthly5years.csv`，它们是最新的5年期月度历史数据。Julia程序如下：
- en: '[PRE21]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Note that we manually removed the first observation since it contained a non-numerical
    value. The related output is shown here:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们手动删除了第一个观察值，因为它包含了非数值的内容。相关输出如下所示：
- en: '![](img/f47d91af-ea7c-4b98-9aab-b3a6e2ef0ac9.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f47d91af-ea7c-4b98-9aab-b3a6e2ef0ac9.png)'
- en: Dealing with missing data
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 处理缺失数据
- en: There are many ways to deal with missing records. The simplest one is to delete
    them. This is especially true when we have a relative large dataset. One potential
    issue is that our final dataset should not be changed in any fundamental way after
    we delete the missing data. In other words, if the missing records happened in
    a random way, then simply deleting them would not generate a biased result.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 处理缺失记录有很多方法。最简单的一种方法是删除它们。特别是当我们有相对较大的数据集时，这种方法是适用的。一个潜在的问题是，在删除缺失数据后，我们的最终数据集不应该发生根本性的变化。换句话说，如果缺失记录是随机发生的，那么简单删除它们不会产生偏差的结果。
- en: Removing missing data
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 删除缺失数据
- en: 'The following R program uses the `na.omit()` function:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 以下R程序使用`na.omit()`函数：
- en: '[PRE22]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Another R function called `na.exclude()` could be used as well. The following
    Python program removes all `sp.na` code:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个R函数`na.exclude()`也可以使用。下面的Python程序移除了所有`sp.na`代码：
- en: '[PRE23]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: For brevity, we omitted the output.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 为简洁起见，我们省略了输出。
- en: Replacing missing data with another value
  id: totrans-110
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用另一个值替换缺失数据
- en: 'In the following dataset, we have three valid values: `*2*`, `*3*`, and `*4*`.
    Obviously, their mean is `3`. Since there are two NAs, we plan to replace them
    with the mean, that is, *3* in this case. The following R code achieves this:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下数据集中，我们有三个有效值：`*2*`、`*3*` 和 `*4*`。显然，它们的均值是 `3`。由于有两个NA值，我们计划用均值替换它们，即在这种情况下用
    *3* 替代。以下是实现此操作的R代码：
- en: '[PRE24]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'For Python, see the following program:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Python，请参阅以下程序：
- en: '[PRE25]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The related output is:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 相关输出为：
- en: '[PRE26]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Detecting outliers and treatments
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测异常值及其处理
- en: 'First, a word of caution: one person''s waste might be another person''s treasure,
    and this is true for outliers. For example, for the week of 2/5/2018 to 2/15/2018,
    the **Dow Jones Industrial Average** (**DJIA**) suffers a huge loss. Cheng and
    Hum (2018) show that the index travels more than 22,000 points, as shown in the
    following table:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，提醒一点：一个人的废物可能是另一个人的宝藏，这对于异常值也同样适用。例如，在2018年2月5日至2018年2月15日这一周，**道琼斯工业平均指数**（**DJIA**）遭遇了巨大的亏损。Cheng和Hum（2018）展示了该指数在这一期间波动超过22,000点，具体数据见下表：
- en: '| **Weekday** | **Points** |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| **工作日** | **点数** |'
- en: '| Monday | 5,113 |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| 星期一 | 5,113 |'
- en: '| Tuesday | 5,460 |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| 星期二 | 5,460 |'
- en: '| Wednesday | 2,886 |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| 星期三 | 2,886 |'
- en: '| Thursday | 3,369 |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| 星期四 | 3,369 |'
- en: '| Friday | 5,425 |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| 星期五 | 5,425 |'
- en: '| Total | 22,253 |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| 总计 | 22,253 |'
- en: Table 5.1 Dow Jones industrial average points traveled
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 表5.1 道琼斯工业平均指数波动点数
- en: If we want to study the relationship between a stock and the DJIA index, the
    observations might be treated as outliers. However, when studying the topic related
    to the impact of the market on individual stocks, we should pay special attention
    to those observations. In other words, those observations should not be treated
    as outliers.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想研究股票与DJIA指数之间的关系，这些观测值可能会被视为异常值。然而，在研究市场对个股影响的课题时，我们应该特别关注这些观测值。换句话说，这些观测值不应被视为异常值。
- en: 'There are many different definitions of an outlier:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 异常值有许多不同的定义：
- en: First, for a given dataset, an outlier is a data point, or an observation, that
    is located an abnormal distance from other observations
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一，对于给定的数据集，异常值是指与其他观测值距离异常远的数据点或观测值
- en: Second, if removing an observation results in a metrical change for a regression,
    then this observation will be an outliner
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二，如果删除某一观测值导致回归模型发生变化，则该观测值将被视为异常值
- en: Third, the distance between an outlier and the mean is at least three standard
    deviations
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第三，异常值与均值之间的距离至少为三个标准差
- en: 'Assume that we have download the weekly S&P500 historical data from Yahoo!Finance
    at [https://finance.yahoo.com/](https://finance.yahoo.com/). The ticker symbol
    for the S&P500 market index is `^GSPC`. Assume further that the dataset is saved
    under `c:/temp` with a name of `^GSPCweekly.csv`. The following R program shows
    the number of cases satisfying the following condition: *n* standard deviations
    from their mean. In the program, we assign `n` a value of `3`:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们已从Yahoo!Finance下载了每周的S&P500历史数据，网址为[https://finance.yahoo.com/](https://finance.yahoo.com/)。S&P500市场指数的股票代码是`^GSPC`。假设数据集保存在`c:/temp`目录下，文件名为`^GSPCweekly.csv`。以下R程序展示了满足以下条件的案例数量：与均值相差
    *n* 个标准差。在程序中，我们将 `n` 设置为 `3`：
- en: '[PRE27]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'It is a good idea to show a few output results:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 展示一些输出结果是个不错的主意：
- en: '[PRE28]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Among `3554` weekly returns, `15` of them could be treated as outliers if defined
    as at least three standard deviations from the mean. Of course, users could use
    other ways to define an outlier. How to treat those outliers depends on the research
    topic. One way is to delete them, but the most important reminder is that researchers
    should detail their methods of treating outliers.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在`3554`周回报中，如果定义为与均值相差至少三个标准差，则其中的`15`个可以被视为异常值。当然，用户也可以采用其他方式来定义异常值。如何处理这些异常值取决于研究主题。一种方法是删除它们，但最重要的提醒是，研究人员应详细说明他们处理异常值的方法。
- en: Several multivariate linear models
  id: totrans-137
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 几个多元线性模型
- en: 'As we mentioned at the beginning of the chapter, we could show several applications
    of multivariable linear models. The first one is a three-factor linear model.
    The general formula is quite similar to the one-factor linear model, shown here:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们在本章开头提到的，我们可以展示几个多元线性模型的应用。第一个是三因素线性模型。其一般公式与单因素线性模型类似，如下所示：
- en: '![](img/590f701a-5550-4ec0-90a6-e61d96de449e.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](img/590f701a-5550-4ec0-90a6-e61d96de449e.png)'
- en: 'The definitions are the same as before. The only difference is that we have
    three independent variables instead of one. Our objective is to estimate four
    parameters, one intercept plus three coefficients:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 定义与之前相同。唯一的区别是我们有三个自变量而不是一个。我们的目标是估算四个参数，一个截距加三个系数：
- en: '![](img/92a1dee0-b7a2-4925-8ab0-720a95711e27.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](img/92a1dee0-b7a2-4925-8ab0-720a95711e27.png)'
- en: 'For example, the equation of the famous Fama-French 3-factor model is given,
    where *R[i]* is the stock i''s return and R[m] is the market return. SMB (Small
    Minus Big) is defined as the returns of the small portfolios minus the returns
    of the big portfolios and HML (High Minus Low) is the difference of returns of
    high book-to-market portfolios minus the returns of low book-to-market portfolios.
    (See the Ken French data library at [http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html](http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html)
    for more detailed definitions.) To download these three factors, we could go to
    Prof. French''s data library to download them, as shown in the following steps:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，著名的 Fama-French 三因素模型的方程式如下，其中 *R[i]* 是股票 i 的回报，R[m] 是市场回报。SMB（Small Minus
    Big）定义为小型投资组合的回报减去大型投资组合的回报，而 HML（High Minus Low）是高账面市值比投资组合的回报减去低账面市值比投资组合的回报。（欲了解更详细的定义，请参见
    Ken French 数据库 [http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html](http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html)）。为了下载这三个因素，我们可以前往
    Prof. French 的数据库下载，如下所示：
- en: Go to the previous link.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前往前一个链接。
- en: 'Choose CSV for the monthly data (the first line in the following screenshot):'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 CSV 格式的月度数据（如下截图中的第一行）：
- en: '![](img/5c583731-0785-4977-a66d-2064f2c2c8b2.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5c583731-0785-4977-a66d-2064f2c2c8b2.png)'
- en: 'The first several lines of the unzipped `csv` file are shown here:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 解压后的 `csv` 文件的前几行如下所示：
- en: '[PRE29]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'This file was created by `CMPT_ME_BEME_RETS` using the 201712 CRSP database:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 此文件由 `CMPT_ME_BEME_RETS` 使用201712 CRSP数据库创建：
- en: '[PRE30]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'In R, we could issue the following code to download it from the author''s website:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在 R 中，我们可以发出以下代码从作者的网站下载它：
- en: '[PRE31]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'For the following R program, we can run the Fama-French 3-factor model for
    IBM:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 对于以下的 R 程序，我们可以运行 Fama-French 三因素模型来分析 IBM：
- en: '[PRE32]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'In the previous code, we assume that the function called `ret_f()` is available
    (see the previous discussion about this function). The output is shown here:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的代码中，我们假设 `ret_f()` 函数可用（请参阅关于此函数的前述讨论）。输出如下所示：
- en: '![](img/879ce7f4-bbda-4a08-9879-3b999c299adb.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](img/879ce7f4-bbda-4a08-9879-3b999c299adb.png)'
- en: 'Here is the Fama-French-Carhart''s 4-factor model:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 Fama-French-Carhart 的四因素模型：
- en: '![](img/d01e2160-0af8-4e60-81db-d831227f1d8b.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d01e2160-0af8-4e60-81db-d831227f1d8b.png)'
- en: 'To download these four factors (Market, SMB, HML, and Momentum), we go to Professor
    Ken French''s data library to download two zipped files:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 为了下载这四个因素（市场、SMB、HML 和动量），我们去教授 Ken French 的数据库下载两个压缩文件：
- en: '[PRE33]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The related output is shown here:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 相关输出显示如下：
- en: '[PRE34]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: To save space, we would not run a Fama-French-Carhart 4-factor model since it
    is quite similar to running the CAPM and Fama-French 3-factor model.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 为了节省空间，我们不运行 Fama-French-Carhart 四因素模型，因为它与运行 CAPM 和 Fama-French 三因素模型非常相似。
- en: 'In 2014, Fama and French developed their 5-factor model, which has the following
    form:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在2014年，Fama 和 French 开发了他们的五因素模型，其形式如下：
- en: '![](img/206f05ba-4c88-4285-85b2-427d4a2c6b19.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](img/206f05ba-4c88-4285-85b2-427d4a2c6b19.png)'
- en: 'In the equation, RMW[t] is the return difference between portfolios of stocks
    with robust and weak profitability, and CMA[t] is the return difference between
    portfolios of low and high investment stocks. Fama and French call the low and
    high investment stocks conservative and aggressive, respectively. If the sensitivities
    to the five factors, βi (i=1,2,...,5), capture all the variations in the expected
    returns, the intercept α[i] will be zero for all securities and portfolios *i*.
    The following R program downloads the `ff5Monthly.RData` set from the author''s
    website:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在方程中，RMW[t] 是具有强大和弱盈利能力股票组合之间的回报差异，CMA[t] 是低投资和高投资股票组合之间的回报差异。Fama 和 French
    将低投资和高投资股票分别称为保守型和激进型。如果对五个因素的敏感度 βi (i=1,2,...,5) 能捕捉所有预期回报的变化，则所有证券和组合 *i* 的截距
    α[i] 将为零。以下 R 程序从作者的网站下载 `ff5Monthly.RData` 数据集：
- en: '[PRE35]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'The related output is shown here:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 相关输出显示如下：
- en: '[PRE36]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Collinearity and its solution
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 共线性及其解决方法
- en: 'In statistics, multicollinearity, or collinearity, is a phenomenon in which
    one independent variable (predictor variable) in a multiple regression model can
    be linearly predicted from the others with a substantial degree of accuracy. Collinearity
    tends to inflate the variance of at least one estimated regression coefficient.
    This could cause some regression coefficients to have the wrong sign. Those issues
    would make our regression results unreliable. Therefore, how can we detect the
    potential problem? One way is that we could simply look at the correlation between
    each pair of independent variables. If their correlation is close to ±1, then
    we might have such an issue:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 在统计学中，多重共线性（或共线性）是一种现象，其中在多元回归模型中，一个自变量（预测变量）可以通过其他变量以较高的准确度线性预测。共线性往往会膨胀至少一个估计回归系数的方差。这可能导致某些回归系数出现错误的符号。这些问题会使我们的回归结果不可靠。那么，如何检测潜在的问题呢？一种方法是简单地查看每对自变量之间的相关性。如果它们的相关性接近±1，那么我们可能就会遇到这样的问题：
- en: '[PRE37]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'To find out the correlation between each pair of portfolios, we could use the
    R function called `cor()` to generate a correlation matrix, shown here:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 为了找出每对投资组合之间的相关性，我们可以使用一个名为`cor()`的R函数来生成相关矩阵，如下所示：
- en: '[PRE38]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'According to *Martz* (2013), we have the following warning signs for a collinearity
    problem:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 根据*Martz*（2013年），我们有以下共线性问题的警告信号：
- en: '| **#** | **Description** |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| **#** | **描述** |'
- en: '| 1 | A coefficient is not significant, even though it should be |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 一个系数不显著，尽管它应该是显著的 |'
- en: '| 2 | After adding/deleting an `X` variable, the regression coefficients change
    dramatically |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 在添加/删除`X`变量后，回归系数发生了剧烈变化 |'
- en: '| 3 | A negative coefficient when the opposite should be true |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 当事实应该相反时，出现了一个负系数 |'
- en: '| 4 | A positive coefficient when the opposite should be true |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 当事实应该相反时，出现了一个正系数 |'
- en: '| 5 | Input variables have high pairwise correlations |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| 5 | 输入变量之间有很高的成对相关性 |'
- en: Table 5.2 Warning signs of collinearity
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 表5.2 共线性警告信号
- en: There are many ways to treat the issue. The simplest one is to delete one of
    the input variables that is highly correlated with another input variable. For
    example, if two input variables are strongly correlated, we could drop one of
    them. The second way is to use the residuals after running two variables against
    each other.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 处理这个问题的方法有很多种。最简单的一种是删除与另一个输入变量高度相关的输入变量。例如，如果两个输入变量之间有很强的相关性，我们可以删除其中一个。第二种方法是使用在将两个变量相互比较后的残差。
- en: A model's performance measure
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 一个模型的表现衡量标准
- en: 'In this chapter, we looked at several applications of linear models, including
    CAPM, the Fama-French 3-factor linear model, the Fama-French-Carhart 4-factor
    linear model, and the Fama-French 5-factor linear model. Obviously, CAPM is the
    simplest one since it only involves a market index as the explanatory variable.
    One question remains though: which model is the best? In other words, how do we
    rank these models and how is their performance measured? When running linear regressions,
    the output will show both the R² and adjusted R². When comparing models with different
    numbers of independent variables, the adjusted R² is a better measure since it
    is adjusted by the number of input variables. However, note we should not depend
    only on the adjusted R² since this is in the sample measure. In other words, a
    higher adjusted R² simply means that based on this sample dataset, model A is
    better than model B. Hence, a much better measure is to use the performance of
    the out-of-sample prediction.'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们研究了线性模型的几种应用，包括资本资产定价模型（CAPM）、法马-法兰奇三因子线性模型、法马-法兰奇-卡哈特四因子线性模型和法马-法兰奇五因子线性模型。显然，CAPM是最简单的模型，因为它只涉及一个市场指数作为解释变量。不过，仍然有一个问题：哪个模型是最好的？换句话说，我们如何对这些模型进行排名，并且如何衡量它们的表现？在运行线性回归时，输出将显示R²和调整后的R²。比较具有不同自变量个数的模型时，调整后的R²是一个更好的衡量标准，因为它已根据输入变量的数量进行了调整。然而，请注意，我们不应仅依赖调整后的R²，因为它是样本内的度量。换句话说，更高的调整后R²意味着基于这个样本数据集，模型A比模型B更好。因此，更好的衡量标准是使用样本外预测的表现。
- en: Summary
  id: totrans-185
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have explained many important issues related to statistics,
    such as T-distribution, F-distribution, T-tests, F-tests, and other hypothesis
    tests. We have also discussed linear regression, how to deal with missing data,
    how to treat outliers, collinearity and its treatments, and how to run a multi-variable
    linear regression.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们解释了与统计学相关的许多重要问题，如T分布、F分布、T检验、F检验及其他假设检验。我们还讨论了线性回归、如何处理缺失数据、如何处理异常值、共线性及其处理方法，以及如何运行多变量线性回归。
- en: In [Chapter 6](c812a40e-eb24-4bb8-8af5-1cfe1834ec77.xhtml), Ma*naging Packages*,
    we will discuss the importance of managing package; how to find out about all
    packages available for R, Python, and Julia; and how to find the manual for each
    package. In addition, we will discuss the issue of package dependency and how
    to make our programming a little easier when dealing with packages.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第六章](c812a40e-eb24-4bb8-8af5-1cfe1834ec77.xhtml)，*管理包*中，我们将讨论包管理的重要性；如何查找R、Python和Julia中所有可用的包；以及如何查找每个包的手册。此外，我们还将讨论包依赖性问题，以及如何在处理包时让我们的编程更加简单。
- en: Review questions and exercises
  id: totrans-188
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 复习题和练习
- en: What is the definition of a single-factor linear model?
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单因子线性模型的定义是什么？
- en: How many independent variables are there in a single-factor model?
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单因子模型中有多少个自变量？
- en: What does it mean for something to be statically different from zero?
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 什么叫做某个值在统计学上与零有显著差异？
- en: What are the critical T-values and P-values to tell whether an estimate is statistically
    significant?
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用于判断估计值是否具有统计显著性的临界T值和P值是什么？
- en: When the significant level is 1%, what is the critical T-value when there are
    30 degrees of freedom?
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当显著性水平为1%时，30个自由度下的临界T值是多少？
- en: What is the difference between a one-sided test and a two-sided test?
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单边检验和双边检验有什么区别？
- en: What are the corresponding missing codes for missing data items in R, Python,
    and Julia?
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: R、Python 和 Julia 中缺失数据项的相应缺失值代码是什么？
- en: How do we treat missing variables if our sample is big? How about if our sample
    is small?
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们的样本很大，如何处理缺失变量？如果我们的样本较小，应该如何处理？
- en: How do we generally detect outliners and deal with them?
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们通常如何检测异常值并处理它们？
- en: How do we generate a correlated return series? For example, write an R program
    to generate 5-year monthly returns for two stocks with a fixed correlation of
    0.5.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们如何生成相关的回报序列？例如，编写一个R程序，生成两个股票在5年内每月的回报数据，且它们之间的相关性为0.5。
- en: In terms of the critical T-value, is this the same for a one-sided test and
    a two-sided test when the significance level is fixed?
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 就临界T值而言，在显著性水平固定的情况下，单边检验和双边检验的临界T值是否相同？
- en: What is collinearity? What might be damaged if our dependents variables are
    strongly correlated?
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 什么是共线性？如果我们的因变量高度相关，可能会造成什么损害？
- en: How do we detect the multicollinearity? What are the functions to estimate the
    correlation matrix in R, Python, and Julia?
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们如何检测多重共线性？R、Python 和 Julia 中用于估算相关矩阵的函数是什么？
- en: 'Write an R program to estimate Microsoft''s annual βs over the last 10 years
    by using daily data. (Source of data: [http://finance.yahoo.com](http://finance.yahoo.com).)'
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个R程序，使用过去10年的微软每日数据，估算微软的年*β*值。（数据来源：[http://finance.yahoo.com](http://finance.yahoo.com)。）
- en: 'Based on the following code, we could download monthly data. Find out whether
    the last day of each week is a trading day or not (hint: you could use an R dataset
    downloadable at [http://canisius.edu/~yany/RData/tradingDaysM.RData](http://canisius.edu/~yany/RData/tradingDaysM.RData)):'
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于以下代码，我们可以下载每月数据。找出每周最后一天是否为交易日（提示：你可以使用一个可以从[http://canisius.edu/~yany/RData/tradingDaysM.RData](http://canisius.edu/~yany/RData/tradingDaysM.RData)下载的R数据集）：
- en: '[PRE39]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Download the monthly price data for Walmart from the Quandl platform and S&P500
    data from Yahoo!Finance. Estimate Walmart''s *β* by using monthly data from the
    last 5 years. A few lines of sample code are given here:'
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从Quandl平台下载沃尔玛的每月价格数据，从Yahoo!Finance下载S&P500的数据。使用过去5年的每月数据估算沃尔玛的*β*值。以下是几行示例代码：
- en: '[PRE40]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Write an R program by using the monthly data over the last 10 years for IBM
    and run a Fama-French-Carhart 4-factor model. Then, compare it with CAPM. Which
    model is better?
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个R程序，使用过去10年的IBM每月数据，运行Fama-French-Carhart四因素模型。然后，将其与CAPM模型进行比较。哪个模型更好？
- en: 'Generate a pickle dataset similar to the following R dataset:'
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成一个类似于以下R数据集的pickle数据集：
- en: '[PRE41]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'When estimating *β*, we could have the following formula, where *βi* is the
    beta for stock *i*, *Ri* is the return for stock *i*, *Rm* is the return for a
    market index, and ![](img/0ae88abb-5d23-424f-b85d-f5d7d24e9411.png) is the variance
    for the market:'
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在估计*β*时，我们可以使用以下公式，其中*βi*是股票*i*的贝塔系数，*Ri*是股票*i*的收益率，*Rm*是市场指数的收益率，且 ![](img/0ae88abb-5d23-424f-b85d-f5d7d24e9411.png) 是市场的方差：
- en: '![](img/cc2d06e5-cab4-4967-8e4e-d22eb575f1e4.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cc2d06e5-cab4-4967-8e4e-d22eb575f1e4.png)'
- en: 'Write an R program to estimate the correlation matrix for the following five
    stocks:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个R程序来估计以下五只股票的相关性矩阵：
- en: '| **#** | **Name** | **Ticker** |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| **#** | **名称** | **股票代码** |'
- en: '| 1 | International Business Machines | IBM |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 国际商业机器公司 | IBM |'
- en: '| 2 | Walmart | WMT |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 沃尔玛 | WMT |'
- en: '| 3 | Citigroup | CG |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 花旗集团 | CG |'
- en: '| 4 | Microsoft | MSFT |'
  id: totrans-217
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 微软 | MSFT |'
- en: '| 5 | Johnson and Johnson | JNJ |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '| 5 | 强生公司 | JNJ |'
- en: Use the 10-year monthly price data to estimate the correlation matrix based
    on the previous five stocks (assume the returns of those five stocks follow a
    normal distribution).
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用过去十年的月度价格数据，估计基于前五只股票的相关性矩阵（假设这五只股票的收益率遵循正态分布）。
- en: Based on the correlation matrix, generate a return matrix to simulate their
    future monthly returns over the next 10 years.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于相关性矩阵，生成一个收益率矩阵，用来模拟它们未来十年内每月的收益率。
- en: Write programs in R or Python to generate similar F-tables (see the link at [http://www.socr.ucla.edu/applets.dir/f_table.html](http://www.socr.ucla.edu/applets.dir/f_table.html)).
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写R或Python程序生成类似的F表（请参见[http://www.socr.ucla.edu/applets.dir/f_table.html](http://www.socr.ucla.edu/applets.dir/f_table.html)链接）。
- en: 'In this chapter, we have the following Julia program to run CAPM (one-factor
    linear model). Simplify the program by writing a subroutine to estimate a return:'
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 本章中，我们有以下Julia程序来运行CAPM（一因子线性模型）。通过编写一个子程序来估计收益率，从而简化程序：
- en: '[PRE42]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
