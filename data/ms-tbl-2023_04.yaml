- en: Learning about Joins, Blends, and Data Structures
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 学习连接、混合和数据结构
- en: Connecting Tableau to data often means more than connecting to a single table
    in a single data **source**. You may need to use Tableau to join multiple tables
    from a single data source. For this purpose, we can use joins, which combine a
    dataset row with another dataset’s row if a given key value matches. You can also
    join tables from disparate data sources or union data with a similar metadata
    structure.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 连接 Tableau 到数据通常不仅仅意味着连接到单个数据**源**中的一个表。你可能需要使用 Tableau 将来自单个数据源的多个表连接起来。为此，我们可以使用连接功能，它会将一个数据集的行与另一个数据集的行合并，如果给定的键值匹配。你还可以连接来自不同数据源的表，或者联合具有相似元数据结构的数据。
- en: Sometimes, you may need to merge data that does not share a common row-level
    key, meaning if you were to match two datasets on a row level like in a join,
    you would duplicate data because the row data in one dataset is of much greater
    detail (for example, cities) than the other dataset (which might contain countries).
    In such cases, you will need to blend the data. This functionality allows you
    to, for example, show the count of cities per country without changing the city
    dataset to a country level.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，你可能需要合并没有共享共同行级键的数据，这意味着如果你像连接操作一样在行级别匹配两个数据集，你会复制数据，因为一个数据集中的行数据比另一个数据集的行数据更加详细（例如，包含城市），而另一个数据集可能包含国家。在这种情况下，你需要混合数据。此功能允许你，例如，在不将城市数据集更改为国家级别的情况下，显示每个国家的城市数量。
- en: Also, you may find instances when it is necessary to create multiple connections
    to a single data source in order to pivot the data in different ways. This is
    possible by manipulating the data structure, which can help you achieve data analysis
    from different angles using the same dataset. It may be required to discover answers
    to questions that are difficult or simply not possible with a single data structure.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，你可能会发现有必要对单个数据源创建多个连接，以便从不同角度透视数据。通过操作数据结构，这是可能的，它可以帮助你从不同的角度使用相同的数据集进行数据分析。这样做可能是发现那些使用单一数据结构难以或根本无法解答的问题所必需的。
- en: 'In this chapter, we will discuss the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将讨论以下主题：
- en: Relationships
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关系
- en: Joins
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接
- en: Unions
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 联合
- en: Blends
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 混合
- en: Understanding data structures
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解数据结构
- en: In version 2020.2, Tableau added functionality that will allow you to join or
    blend without specifying one of the two methods. It is called **relationships**.
    We will start this chapter off by explaining this new feature before we investigate
    the details of joins, blends, and more.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在 2020.2 版本中，Tableau 添加了一个功能，允许你在不指定两种方法之一的情况下进行连接或混合。这就是**关系**功能。我们将在本章开始时解释这一新特性，然后再深入探讨连接、混合等的细节。
- en: Relationships
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 关系
- en: 'Although this chapter will primarily focus on joins, blends, and the manipulation
    of data structures, let’s begin with an introduction to **relationships**: a new
    functionality available since Tableau 2020.2, and one that the Tableau community
    has been waiting a long time for. It is the new default option in the data canvas;
    therefore, we will first investigate **relationships**, which belong to the **logical
    layer of the data model,** before diving deeper into the join and union functionalities
    that operate on the **physical layer**.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管本章将主要集中讨论连接、混合以及数据结构的操作，但我们首先从**关系**的介绍开始：这是自 Tableau 2020.2 版本以来新增的功能，Tableau
    社区一直在期待这一功能。它是数据画布中的默认选项；因此，我们将首先研究**关系**，它属于**数据模型的逻辑层**，然后再深入探讨在**物理层**上操作的连接和联合功能。
- en: 'To read all about the physical and logical layers of Tableau’s data model,
    visit the Tableau help pages: [https://help.tableau.com/current/online/en-us/datasource_datamodel.htm](https://help.tableau.com/current/online/en-us/datasource_datamodel.htm).'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 要详细了解 Tableau 数据模型的物理层和逻辑层，请访问 Tableau 帮助页面：[https://help.tableau.com/current/online/en-us/datasource_datamodel.htm](https://help.tableau.com/current/online/en-us/datasource_datamodel.htm)。
- en: For now, you can think of the logical layer as being able to count smarter.
    Imagine a customer table with unique customer names and an order table with hundreds
    of recorded orders. In a logical layer, a customer name with multiple orders (thus
    multiple rows of order and customer IDs in the order table) will be counted as
    one customer because the logical layer is smart and it recognizes the customer
    name, while the physical layer would count one customer for each order and hence
    it would count the same customer as multiple customers if they ordered multiple
    times. You could only solve this by counting distinct values (which is not required
    when using the logical layer).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以将逻辑层理解为能够更智能地计数。假设有一个包含唯一客户姓名的客户表和一个记录了数百条订单的订单表。在逻辑层中，一个有多个订单的客户姓名（因此在订单表中会有多个订单和客户ID行）将被计为一个客户，因为逻辑层非常智能，能够识别客户姓名，而物理层则会将每个订单当作一个客户，因此如果同一客户下了多个订单，物理层会把这个客户计算为多个客户。你只能通过计数不同的值来解决这个问题（但使用逻辑层时不需要这样做）。
- en: 'In the following screenshot, you can see the data source canvas, with two datasets
    combined in a relationship on the left-hand side and the same datasets combined
    using a **join** on the right-hand side. Please note that relationships only show
    a line between the tables (**Orders**, **People**, and **Returns**) whereas joins
    indicate the type of join by two circles:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在下图中，你可以看到数据源画布，左侧是通过关系组合的两个数据集，右侧是通过 **连接** 组合的相同数据集。请注意，关系仅在表之间显示一条线（**订单**、**人员**
    和 **退货**），而连接则通过两个圆圈表示连接类型：
- en: '![](img/B18435_04_01.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_01.png)'
- en: 'Figure 4.1: Relationships and joins on the data source canvas'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.1：数据源画布中的关系和连接
- en: A key difference is that the preview of the data, at the bottom, will show only
    data from the selected table in relationships, compared to all data when using
    joins. This makes sense because the granularity of data can change in relationships,
    depending on the fields you are using in your dashboard. Joins, however, have
    a fixed level of granularity, which is defined by the type of join and join clauses
    you choose.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 一个关键的区别是，数据预览的底部只会显示来自关系中所选表的数据，而在使用连接时会显示所有数据。这是有道理的，因为在关系中，数据的粒度可能会发生变化，具体取决于你在仪表板中使用的字段。然而，连接具有固定的粒度级别，该级别由你选择的连接类型和连接子句定义。
- en: 'Relationships are the default for Tableau Desktop 2020.2 and higher. However,
    if you still want to make use of the join functionality, you can drag a dataset
    into the data source canvas, click on the drop-down arrow, and select **Open…**:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 关系是 Tableau Desktop 2020.2 及更高版本的默认设置。然而，如果你仍然希望使用连接功能，你可以将数据集拖入数据源画布，点击下拉箭头，并选择
    **打开…**：
- en: '![](img/B18435_04_02.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_02.png)'
- en: 'Figure 4.2: From relationship to join canvas'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.2：从关系到连接画布
- en: This will open the dataset as you used to see it in the data pane in Tableau
    in versions before 2020.2 and you will be able to use joins the old way, as we
    will describe in the *Joins* section.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 这将以你在 Tableau 2020.2 之前的版本中常见的方式打开数据集，你将能够以旧有方式使用连接，正如我们在 *连接* 部分中所描述的那样。
- en: 'The line between two datasets in a relationship (based on the logical layer)
    is called a **noodle** due to its al dente spaghetti looks **–** yum! Tableau
    detects a relationship as soon as you drag in the second data source to the data
    source canvas, but you can add more key columns or remove and adjust them if needed
    by clicking on the noodle itself:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在关系中的两个数据集之间的线（基于逻辑层）被称为 **面条**，因为它看起来像有嚼劲的意大利面 **–** 好吃！当你将第二个数据源拖入数据源画布时，Tableau
    会立即检测到一个关系，但你可以通过点击面条本身，添加更多的键列或删除和调整它们。
- en: '![](img/B18435_04_03.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_03.png)'
- en: 'Figure 4.3: Relationship keys'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.3：关系键
- en: If you open older dashboards in Tableau 2020.2 or later versions, you will see
    that the joined data will be shown as **Migrated**. This is intentional. Just
    click on the migrated data source and Tableau will switch from the logical to
    the physical layer, meaning you will see the join-based data source canvas instead
    of the relationship canvas.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在 Tableau 2020.2 或更高版本中打开旧版仪表板，你会看到已连接的数据将显示为 **已迁移**。这是故意为之。只需点击已迁移的数据源，Tableau
    将从逻辑层切换到物理层，这意味着你将看到基于连接的数据源画布，而不是关系画布。
- en: Looking at the worksheet, you will notice differences as well. You will see
    that in the new relationshipslayout, the columns are divided by table name first
    and then split into **Dimensions** and **Measures** per data source, while in
    a join, the columns are divided into **Dimensions** and **Measures** and split
    by table name.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 查看工作表时，您也会注意到一些差异。您会看到，在新的关系布局中，列首先按表名划分，然后按每个数据源中的**维度**和**度量**进行拆分，而在连接中，列按**维度**和**度量**拆分，并按表名进行划分。
- en: To conclude on relationships, the new data source layout makes it a lot easier
    to combine datasets and you do not have to decide upfront if you want to join
    or blend. People that are used to the old data source pane might have to get used
    to the new flexibility a bit, but for new Tableau users, it will be much easier
    to work with different datasets from the start. Nevertheless, we will still cover
    joins next, especially because the functionality is still part of Tableau in the
    physical layer.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 总结关系，新的数据源布局使得合并数据集变得更加容易，您无需事先决定是否要进行连接或合并。习惯了旧版数据源窗格的人可能需要适应新的灵活性，但对于新用户来说，从一开始就更容易处理不同的数据集。尽管如此，我们仍然会接着讲解连接，特别是因为该功能仍然是
    Tableau 物理层的一部分。
- en: Joins
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接
- en: This book assumes basic knowledge of joins, specifically inner, left-outer,
    right-outer, and full-outer joins. If you are not familiar with the basics of
    joins, consider taking W3Schools’ SQL tutorial at [https://www.w3schools.com/sql/default.asp](https://www.w3schools.com/sql/default.asp).
    The basics are not difficult, so it won’t take you long to get up to speed.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 本书假设读者具备基本的连接知识，特别是内连接、左外连接、右外连接和全外连接。如果您不熟悉连接的基础知识，可以考虑参加 W3Schools 的 SQL 教程，网址为[https://www.w3schools.com/sql/default.asp](https://www.w3schools.com/sql/default.asp)。基础知识不难，因此您很快就能掌握。
- en: 'The following screenshot shows three related datasets:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了三个相关的数据集：
- en: '![](img/B18435_04_04.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_04.png)'
- en: 'Figure 4.4: Related datasets'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.4：相关数据集
- en: To better understand what Tableau does to your data when joining multiple tables,
    let us explore join queries.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解 Tableau 在连接多个表时对数据的处理方式，我们将探索连接查询。
- en: Join queries
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接查询
- en: 'The following screenshot is a representation of the joined datasets in *Figure
    4.4*:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了在*图 4.4*中的联合数据集：
- en: '![](img/B18435_04_05.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_05.png)'
- en: 'Figure 4.5: Join culling'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.5：连接裁剪
- en: The preceding screenshot represents an inner join between the **Orders** and
    **Returns** tables, connected through an inner join on the common key, **Order
    ID**. **Orders** and **People** are joined on the common key **Region**.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 上述截图展示了**订单**和**退货**表之间的内部连接，通过共同的键**订单 ID**进行连接。**订单**和**人员**表通过共同的键**区域**连接。
- en: To better understand what has just been described, we will continue with a join
    culling exercise. We will look at the SQL queries generated by Tableau when building
    a simple view using these two tables, which will show us what Tableau does under
    the hood while we simply drag and drop.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解刚才描述的内容，我们将继续进行一个连接裁剪练习。我们将查看 Tableau 在使用这两个表构建简单视图时生成的 SQL 查询，这将向我们展示在简单的拖放操作下，Tableau
    在后台做了什么。
- en: 'Please follow these steps:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 请按照以下步骤操作：
- en: Locate and download the workbook associated with this chapter from [https://public.tableau.com/profile/marleen.meier/](https://public.tableau.com/profile/marleen.meier/).
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从[https://public.tableau.com/profile/marleen.meier/](https://public.tableau.com/profile/marleen.meier/)下载与本章相关的工作簿。
- en: Select the **Join Culling** worksheet and click on the **Sample - EU Superstore
    Join** data source.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**连接裁剪**工作表，点击**示例 - 欧盟超级商店连接**数据源。
- en: 'From the menu, select **Help**, then **Settings and Performance**, and then
    **Start Performance Recording**:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从菜单中选择**帮助**，然后选择**设置与性能**，接着选择**开始性能记录**：
- en: '![](img/B18435_04_06.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_06.png)'
- en: 'Figure 4.6: Start Performance Recording'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.6：开始性能记录
- en: 'Drag **People** to the **Rows** shelf and place **Sales** on the **Text** shelf:'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**人员**拖到**行**货架，并将**销售**放到**文本**货架上：
- en: '![](img/B18435_04_07.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_07.png)'
- en: 'Figure 4.7: Drag and drop'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.7：拖放操作
- en: Stop the recording with **Help**, then **Settings and Performance**, and finally,
    **Stop Performance Recording**.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过**帮助**，然后选择**设置与性能**，最后选择**停止性能记录**来停止记录。
- en: 'In the resulting **Performance Summary** dashboard, drag the time slider to
    `0.0000` and select both green bars: **Executing Query**. Now you see the two
    SQL queries generated by Tableau:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在生成的**性能摘要**仪表板中，将时间滑块拖动到`0.0000`，并选择两个绿色条形图：**执行查询**。现在，您会看到 Tableau 生成的两个
    SQL 查询：
- en: '![](img/B18435_04_08.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_08.png)'
- en: 'Figure 4.8: Performance recording'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.8：性能记录
- en: 'So far, we have connected Tableau to our dataset, then we created a very simple
    worksheet, showing us the number of sales for people. But, for Tableau to show
    the people’s names and the sales amount, it needs to get data from two different
    tables: **Orders** and **People**. The performance recording in *Figure 4.8* shows
    how long each step of building the dashboard took and which query was sent to
    the database. Since we first dragged a dimension and then a measure into the worksheet,
    we see two queries. The second query combines both dragged piles; therefore, we
    will focus on the latter. Let’s look at it in detail:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经将 Tableau 连接到我们的数据集，然后创建了一个非常简单的工作表，显示了每个人的销售数量。但为了让 Tableau 显示人名和销售金额，它需要从两个不同的表格中获取数据：**订单**和**人员**。*图
    4.8*中的性能记录显示了构建仪表板的每个步骤花费的时间以及发送到数据库的查询。由于我们首先将维度拖入工作表，然后再拖入度量，因此我们看到两个查询。第二个查询结合了两个拖动的字段，因此我们将重点关注后者。让我们详细看看：
- en: '[PRE0]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Note that an inner join was generated between the tables. This was a view behind
    the scenes of Tableau’s **join feature**.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，表格之间生成了内连接。这是 Tableau **连接功能**背后的一个视图。
- en: Now that the technical details have been discussed, let us look at joins in
    the dashboards themselves.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 现在技术细节已经讨论完毕，让我们来看看仪表板中的连接。
- en: Join calculations
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连接计算
- en: In Tableau, it is possible to join two files based on a calculation. You would
    use this functionality to resolve mismatches between two data sources. The calculated
    join can be accessed in the dropdown of each join.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Tableau 中，可以基于计算连接两个文件。你可以使用此功能来解决两个数据源之间的不匹配问题。计算连接可以在每个连接的下拉菜单中找到。
- en: 'See the following screenshot:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 请参见以下截图：
- en: '![](img/B18435_04_09.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_09.png)'
- en: 'Figure 4.9: Create Join Calculation...'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.9：创建连接计算...
- en: 'As an example, imagine a dataset that contains one column for **First Name**,
    and another column for **Last Name**. You want to join it to a second dataset
    that has one column called **Name**, containing the first and last name. One option
    to join those two datasets is to create a **Join Calculation** like the following
    in the first dataset:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 举个例子，假设一个数据集包含一列**名字**和另一列**姓氏**。你想将其连接到一个包含**姓名**列的第二个数据集，该列包含姓名和姓氏。连接这两个数据集的一种方式是在第一个数据集中创建一个**连接计算**，如下所示：
- en: '[PRE1]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Now, select the **Name** column in the second dataset and your keys should be
    matching!
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，选择第二个数据集中**姓名**这一列，确保你的键匹配！
- en: 'If you want to know more about calculated joins, please check the Tableau help
    pages: [https://help.tableau.com/current/pro/desktop/en-us/joining_tables.htm#use-calculations-to-resolve-mismatches-between-fields-in-a-join](https://help.tableau.com/current/pro/desktop/en-us/joining_tables.htm#use-calculations-to-resolve-mismatches-between-fields-in-a-join).'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想了解更多关于计算连接的内容，请查看 Tableau 帮助页面：[https://help.tableau.com/current/pro/desktop/en-us/joining_tables.htm#use-calculations-to-resolve-mismatches-between-fields-in-a-join](https://help.tableau.com/current/pro/desktop/en-us/joining_tables.htm#use-calculations-to-resolve-mismatches-between-fields-in-a-join)。
- en: Spatial joins
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 空间连接
- en: In Tableau 2018.2, **spatial joins** were added. What this means is that you
    can join spatial fields from MapInfo tables and Shape, Esri, KML, TopoJSON, and
    GeoJSON files. You can also use CSV or Excel files and translate the data into
    spatial data by using the Tableau `MAKEPOINT`function (see *Chapter 12**, Leveraging
    Advanced Analytics*). In practice, imagine two datasets, one about the location
    of basins, indicated by a spatial field, and a second dataset containing the locations
    of waterfowl sightings, also in a spatial column. Tableau allows you to join the
    two, which is very hard to do otherwise because most programs don’t support spatial
    data.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Tableau 2018.2 中，**空间连接**功能被添加了。这意味着你可以连接来自 MapInfo 表格以及 Shape、Esri、KML、TopoJSON
    和 GeoJSON 文件的空间字段。你还可以使用 CSV 或 Excel 文件，并通过使用 Tableau 的`MAKEPOINT`函数将数据转换为空间数据（见*第
    12 章*，利用高级分析）。实际操作中，假设有两个数据集，一个是关于流域位置的，指示了一个空间字段，另一个数据集包含水鸟目击位置，同样是一个空间列。Tableau
    允许你将这两个数据集合并，而这在其他情况下非常困难，因为大多数程序不支持空间数据。
- en: To join on spatial columns, you have to select the **Intersects** field from
    the **Join** dropdown, only visible when working with spatial data.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 要在空间列上连接，你必须从**连接**下拉菜单中选择**相交**字段，只有在处理空间数据时才能看到该选项。
- en: 'For more information on joining spatial files in Tableau, read the following
    resources from Tableau:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 有关在 Tableau 中连接空间文件的更多信息，请阅读 Tableau 提供的以下资源：
- en: '[https://help.tableau.com/current/pro/desktop/en-us/maps_spatial_join.htm](https://help.tableau.com/current/pro/desktop/en-us/maps_spatial_join.htm)'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://help.tableau.com/current/pro/desktop/zh-cn/maps_spatial_join.htm](https://help.tableau.com/current/pro/desktop/zh-cn/maps_spatial_join.htm)'
- en: '[https://www.tableau.com/about/blog/2018/8/perform-advanced-spatial-analysis-spatial-join-now-available-tableau-92166](https://www.tableau.com/about/blog/2018/8/perform-advanced-spatial-analysis-spatial-join-now-available-tableau-92166)'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://www.tableau.com/about/blog/2018/8/perform-advanced-spatial-analysis-spatial-join-now-available-tableau-92166](https://www.tableau.com/about/blog/2018/8/perform-advanced-spatial-analysis-spatial-join-now-available-tableau-92166)'
- en: '[https://help.tableau.com/current/pro/desktop/en-us/maps_spatial_join.htm](https://help.tableau.com/current/pro/desktop/en-us/maps_spatial_join.htm)'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://help.tableau.com/current/pro/desktop/zh-cn/maps_spatial_join.htm](https://help.tableau.com/current/pro/desktop/zh-cn/maps_spatial_join.htm)'
- en: '[https://help.tableau.com/current/pro/desktop/en-us/examples_spatial_files.htm](https://help.tableau.com/current/pro/desktop/en-us/examples_spatial_files.htm)'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://help.tableau.com/current/pro/desktop/zh-cn/examples_spatial_files.htm](https://help.tableau.com/current/pro/desktop/zh-cn/examples_spatial_files.htm)'
- en: Alternatively to a horizontal join, you might need a vertical join, also called
    a **union**. A typical union use case is visualizing data that is stored in multiple
    files or tables over time. You might have a daily report, in which the column
    structure is the same but collected as a new file every day, stored in a monthly
    or yearly folder.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 相较于水平连接，你可能需要垂直连接，也叫做**联合**。一个典型的联合使用场景是可视化存储在多个文件或表格中的数据，这些数据是随着时间的推移而变化的。你可能有一个每日报告，其中列的结构相同，但每天都作为一个新文件存储在一个按月或按年命名的文件夹里。
- en: Combining those files gives so much more insight than looking at them one at
    a time! You will be able to analyze trends and daily or yearly changes or perform
    a year-to-date analysis. Thus, we will continue with an in-depth explanation of
    unions in Tableau next.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 合并这些文件比逐一查看它们能提供更多的洞察！你将能够分析趋势、日常或年度变化，或进行年初至今的分析。因此，我们将继续深入讲解Tableau中的联合操作。
- en: Unions
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 联合
- en: Sometimes you might want to analyze data with the same metadata structure that
    is stored in different files – for example, sales data from multiple years, different
    months, or countries. Instead of copying and pasting the data, you can union it.
    We already touched upon this topic in *Chapter 3*, *Using Tableau Prep Builder*,
    but a union is basically where Tableau will append new rows of data to existing
    columns with the same header. For the following exercise, we will use FIFA data
    (from the PlayStation game, not the World Cup). The data is from Kaggle ([https://www.kaggle.com/datasets/stefanoleone992/fifa-22-complete-player-dataset?resource=download](https://www.kaggle.com/datasets/stefanoleone992/fifa-22-complete-player-dataset?resource=download))
    and ships in multiple CSVs; each CSV contains data for one year and male/female
    are split too.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 有时你可能需要分析以相同元数据结构存储在不同文件中的数据——例如，来自多个年份、不同月份或不同国家的销售数据。与其复制粘贴数据，你可以进行联合操作。我们在*第3章*中已经提到过这个话题，*使用Tableau
    Prep Builder*，但联合基本上就是Tableau将新数据行附加到具有相同表头的现有列中。对于接下来的练习，我们将使用FIFA数据（来自PlayStation游戏，而非世界杯）。这些数据来自Kaggle（[https://www.kaggle.com/datasets/stefanoleone992/fifa-22-complete-player-dataset?resource=download](https://www.kaggle.com/datasets/stefanoleone992/fifa-22-complete-player-dataset?resource=download)），并且以多个CSV文件的形式提供；每个CSV文件包含一年的数据，并且按性别（男性/女性）进行了划分。
- en: 'For our analysis, we want to combine all the files into one. Hence, we need
    to union, by taking the following steps:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的分析，我们希望将所有文件合并成一个。因此，我们需要通过以下步骤进行联合操作：
- en: Download the CSV files from GitHub ([https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/tree/main/Chapter04](https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/tree/main/Chapter04))
    or Kaggle ([https://www.kaggle.com/datasets/stefanoleone992/fifa-22-complete-player-dataset?resource=download](https://www.kaggle.com/datasets/stefanoleone992/fifa-22-complete-player-dataset?resource=download)).
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从GitHub下载CSV文件（[https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/tree/main/Chapter04](https://github.com/PacktPublishing/Mastering-Tableau-2023-Fourth-Edition/tree/main/Chapter04)）或Kaggle（[https://www.kaggle.com/datasets/stefanoleone992/fifa-22-complete-player-dataset?resource=download](https://www.kaggle.com/datasets/stefanoleone992/fifa-22-complete-player-dataset?resource=download)）。
- en: 'In the dashboard belonging to this chapter, open the **Connect to data** pane,
    and click on **Text file**:'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本章的仪表板中，打开**连接数据**窗格，并点击**文本文件**：
- en: '![](img/B18435_04_10.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_10.png)'
- en: 'Figure 4.10: Text file'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.10：文本文件
- en: Locate the downloaded FIFA data on your machine and connect to any one of the
    files.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你的机器上找到下载的FIFA数据，并连接到其中一个文件。
- en: 'Create the union by dragging and dropping **a second file** from the left pane
    on top of the **initial file** until the word **Union** appears, a sign that when
    dropping the data now, the data will be used for a union:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过从左侧面板拖放**第二个文件**到**初始文件**上，直到出现“**联合**”字样，表示当数据被放下时，它将用于联合：
- en: '![Graphical user interface, application, Word'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，应用程序，Word'
- en: Description automatically generated](img/B18435_04_11.png)
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_04_11.png)
- en: 'Figure 4.11: Union'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.11：联合
- en: 'Alternatively, click on the arrow of the primary dataset and select **Convert
    to Union…**:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 或者，点击主数据集的箭头，选择**转换为联合...**：
- en: '![](img/B18435_04_12.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_12.png)'
- en: 'Figure 4.12: Convert to Union...'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.12：转换为联合...
- en: 'In the following popup (*Figure 4.13*), the user has the option to select all
    the data tables that should be part of the union individually by dragging and
    dropping or by using a **Wildcard** union, which includes all tables in a certain
    directory based on the naming convention—a ***** represents any character. `players*`
    will include any file that starts with `players`. Respectively, `female*` will
    include all files starting with `female`, and `*` will include all files:'
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在以下弹出窗口（*图 4.13*）中，用户可以通过拖放或使用**通配符**联合，选择应该包含在联合中的所有数据表，通配符联合会基于命名约定包含某个目录中的所有表——*****代表任意字符。`players*`
    将包含所有以 `players` 开头的文件。分别，`female*` 将包含所有以 `female` 开头的文件，`*` 将包含所有文件：
- en: '![](img/B18435_04_13.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_13.png)'
- en: 'Figure 4.13: Edit Union...'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.13：编辑联合...
- en: 'Unions are used to combine data that is similar and can be appended underneath
    each other. They are most often used for multiple data files where each has a
    different date stamp, a different region, a different manager, and so forth. By
    using a union, you want to make the dataset more complete. We saw that Tableau
    allows unions by dragging and dropping, as well as right-clicking on the initial
    data source. We also talked about unions that combine one or more other datasets,
    using drag and drop or wildcards. *Figure 4.14* presents a typical union example:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 联合用于组合相似的数据，并可以将它们按顺序附加在一起。它们通常用于多个数据文件，每个文件有不同的日期戳、不同的区域、不同的经理等。通过使用联合，你希望使数据集更加完整。我们看到
    Tableau 允许通过拖放或右键点击初始数据源来创建联合。我们还讨论了将一个或多个其他数据集组合在一起的联合，使用拖放或通配符。*图 4.14* 展示了一个典型的联合示例：
- en: '![](img/B18435_04_14.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_14.png)'
- en: 'Figure 4.14: Union'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.14：联合
- en: 'Let us look at the aspects we need to remember:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看我们需要记住的几个要点：
- en: Unions append data in creating additional rows.
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 联合通过创建附加行来追加数据。
- en: A union should contain datasets that have many common columns.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个联合应该包含具有许多公共列的数据集。
- en: Unions should only be used for same-structured data stored across multiple data
    sources.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 联合应该仅用于存储在多个数据源中的结构相同的数据。
- en: Keep an eye on performance when using unions. With each additional dataset in
    the union, you will increase the complexity of Tableau’s VizQL.
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用联合时，请注意性能。每增加一个数据集，你将增加 Tableau VizQL 的复杂度。
- en: 'Since you just became a union expert, it’s time to move on to the next feature
    Tableau offers: **blending**! Blending helps you to combine datasets that have
    a different level of granularity. Think *one-to-many*relationships between datasets.
    One dataset has a unique key per row; the other has multiple rows per key. To
    avoid duplicating rows in the first-mentioned dataset, Tableau deployed blending,
    long before relationships were part of the software package.'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 既然你已经成为联合专家，现在是时候进入 Tableau 提供的下一个功能：**合并**！合并帮助你结合具有不同粒度的数据集。考虑数据集之间的*一对多*关系。一个数据集每行都有唯一的键；另一个数据集每个键有多行。为了避免在第一个数据集中重复行，Tableau
    提前部署了合并功能，早在关系成为软件包的一部分之前。
- en: Blends
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 合并
- en: 'Relationships make data blending a little less needed and it can be seen as
    legacy functionality. But for the sake of completeness and for older Tableau versions
    (below 2020.2), let’s consider a summary of data blending in the following sections.
    In a nutshell, data blending allows you to merge multiple disparate data sources
    into a single view. Understanding the following four points will give you a grasp
    of the main points regarding data blending:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 关系使得数据合并变得不那么必要，并且可以视为过时功能。但为了完整性和为了支持旧版本的 Tableau（2020.2 以下），我们来看一下以下部分的总结。简而言之，数据合并允许你将多个不同的数据源合并到一个视图中。理解以下四个要点将帮助你掌握数据合并的要点：
- en: Data blending is typically used to merge data from multiple data sources. Although
    as of Tableau 10, joins are possible between multiple data sources, there are
    still cases when data blending is the only feasible option to merge data from
    two or more sources. In the following sections, we will see a practical example
    that demonstrates such a case.
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据混合通常用于合并来自多个数据源的数据。虽然从 Tableau 10 开始，多个数据源之间可以进行连接，但仍然有一些情况，数据混合是合并两个或更多数据源数据的唯一可行选项。在接下来的部分中，我们将看到一个展示这种情况的实际示例。
- en: Data blending requires a shared dimension. A date dimension is often a viable
    candidate for blending multiple data sources.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据混合需要共享的维度。日期维度通常是混合多个数据源的可行候选项。
- en: Data blending aggregates and then matches. On the other hand, joining matches
    and then aggregates.
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据混合先进行聚合，然后匹配。另一方面，连接先进行匹配，然后聚合。
- en: Data blending does not enable dimensions from a secondary data source. Attempting
    to use dimensions from a secondary data source will result in a * or null in the
    view. There is an exception to this rule, which we will discuss later, in the
    *Adding secondary dimensions* section.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据混合不会启用来自次级数据源的维度。尝试使用次级数据源中的维度会导致视图中显示*或null。此规则有一个例外，我们将在稍后的*添加次级维度*部分中讨论。
- en: 'Now that we have introduced relationships, joins, and unions, I would like
    to shift your focus a bit to data structures within your workbook. You might have
    set up the perfect join or union, started dragging and dropping fields onto your
    workbook canvas, used a filter, used a calculated field, and then received some
    unexpected results. Tableau is behaving, just not the way you like it. Why might
    that be?! The order of operation here is key. It is essential to know when which
    filter will be applied and how this affects your data. Therefore, next in line:
    the order of operations.'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经介绍了关系、连接和并集，我想稍微调整一下你对工作簿内数据结构的关注。你可能已经设置好了完美的连接或并集，开始将字段拖拽到工作簿画布上，使用了筛选器、计算字段，然后却得到了意料之外的结果。Tableau
    确实在工作，只是方式你可能不太喜欢。为什么会这样呢？！这里的操作顺序至关重要。了解每个筛选器的应用顺序及其如何影响数据非常重要。因此，接下来要讲的是：操作顺序。
- en: Exploring the order of operations
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索操作顺序
- en: Isn’t a data blend the same thing as a left join? This is a question that new
    Tableau authors often ask. The answer, of course, is no, but let us explore the
    differences. The following example is simple, even lighthearted, but does demonstrate
    profound consequences that can result from incorrect aggregation resulting from
    an erroneous join.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 数据混合和左连接不是同一回事吗？这是许多新 Tableau 用户经常问的问题。答案当然是否定的，但让我们来探讨一下它们的区别。下面的示例很简单，甚至有些轻松，但确实展示了由于错误的连接导致错误聚合所带来的深远后果。
- en: We will explore in which order aggregation happens in Tableau. This will help
    you understand how to use blends and joins more effectively.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将探讨在 Tableau 中聚合发生的顺序。这将帮助你更有效地使用数据混合和连接。
- en: 'For this example, we will use the following data:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本示例，我们将使用以下数据：
- en: '![](img/B18435_04_15.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_15.png)'
- en: 'Figure 4.15: Pants and shirts sales'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.15：裤子和衬衫销售情况
- en: 'In these tables, two people are listed: **Tanya** and **Zhang**. In one table,
    these people are members of the **Salesperson** dimension, and in the other, they
    are members of the **Sales Associate** dimension. Furthermore, **Tanya** and **Zhang**
    both sold $200 in pants and $100 in shirts. Let us explore new ways Tableau could
    connect to this data to better understand joining and data blending.'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些表格中，列出了两个人：**Tanya**和**Zhang**。在一张表中，这两人是**销售员**维度的成员，在另一张表中，他们是**销售助理**维度的成员。此外，**Tanya**和**Zhang**分别销售了200美元的裤子和100美元的衬衫。让我们探索
    Tableau 可能以新方式连接到这些数据，从而更好地理解连接和数据混合。
- en: When you look at the spreadsheets associated with this exercise, you will notice
    additional columns. These columns will be used in a later exercise.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 当你查看与本练习相关的电子表格时，你会注意到额外的列。这些列将在后续的练习中使用。
- en: 'Please take the following steps:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 请按照以下步骤操作：
- en: In the workbook associated with this chapter, right-click on the `Pants` data
    source and look at the data by clicking **View data**. Do the same for the `Shirts`
    data source.
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在与本章相关的工作簿中，右键点击`Pants`数据源，并通过点击**查看数据**来查看数据。同样的操作也要在`Shirts`数据源上进行。
- en: 'Open the `Join` data source by right-clicking on it and selecting **Edit Data
    Source**, and observe the join between the **Pants** and **Shirts** tables using
    **Salesperson/Sales Associate** as the common key:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击`Join`数据源并选择**编辑数据源**，观察**裤子**和**衬衫**表之间的连接，使用**销售员/销售助理**作为共同的键：
- en: '![](img/B18435_04_16.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_16.png)'
- en: 'Figure 4.16: Join'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.16：连接
- en: 'On the **Pants** worksheet, select the **Pants** data source and place **Salesperson**
    on the **Rows** shelf and **Pants Amount** on the **Text** shelf:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**裤子**工作表中，选择**裤子**数据源，并将**销售员**放置在**行**架上，将**裤子金额**放置在**文本**架上：
- en: '![](img/B18435_04_17.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_17.png)'
- en: 'Figure 4.17: Setting up the worksheet'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.17：设置工作表
- en: 'On the **Shirts** worksheet, select the **Shirts** data source and place **Sales
    Associate** on the **Rows** shelf and **Shirt Amount** on the **Text** shelf:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**衬衫**工作表中，选择**衬衫**数据源，并将**销售助理**放置在**行**架上，将**衬衫金额**放置在**文本**架上：
- en: '![](img/B18435_04_18.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_18.png)'
- en: 'Figure 4.18: Shirts'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.18：衬衫
- en: 'On the **Join** worksheet, select the **Join** data source and place **Salesperson**
    on the **Rows** shelf. Next, double-click **Pants Amount** and **Shirt Amount**
    to place both on the view:'
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**连接**工作表中，选择**连接**数据源并将**销售员**放置在**行**架上。接下来，双击**裤子金额**和**衬衫金额**，将两者都放到视图中：
- en: '![](img/B18435_04_19.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_19.png)'
- en: 'Figure 4.19: Join'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.19：连接
- en: 'On the **Blend – Pants Primary** worksheet, select the **Pants** data source
    and place **Salesperson** on the **Rows** shelf and **Pants Amount** on the **Text**
    shelf:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**混合 – 裤子主**工作表中，选择**裤子**数据源，并将**销售员**放置在**行**架上，将**裤子金额**放置在**文本**架上：
- en: '![](img/B18435_04_20.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_20.png)'
- en: 'Figure 4.20: Blend pants'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.20：混合裤子
- en: Stay on the same worksheet and select the `Shirts` data source from the data
    source pane on the left and double-click on **Shirt Amount**. Click **OK** if
    an error message pops up.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保持在同一工作表中，从左侧的数据源面板中选择`衬衫`数据源并双击**衬衫金额**。如果弹出错误信息，点击**确定**。
- en: 'Select **Data** from the menu bar, then **Edit Blend Relationships…**:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从菜单栏选择**数据**，然后选择**编辑混合关系…**：
- en: '![](img/B18435_04_21.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_21.png)'
- en: 'Figure 4.21: Edit Blend Relationships...'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.21：编辑混合关系…
- en: In the resulting dialog box, select `Pants` as the **Primary data source** and
    `Shirts` as the **Secondary data source**, then click on the **Custom** radio
    button, as shown in *Figure 4.22*, then click **Add…**.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在弹出的对话框中，选择`裤子`作为**主数据源**，选择`衬衫`作为**次数据源**，然后点击**自定义**单选按钮，如*图 4.22*所示，然后点击**添加…**。
- en: In the left column, select **Salesperson**, and in the right column, select
    **Sales Associate**. The left column represents data from the **Primary data source**
    and the right column represents all the data available in the **Secondary data
    source**.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左列中选择**销售员**，在右列中选择**销售助理**。左列代表来自**主数据源**的数据，右列代表**次数据源**中所有可用的数据。
- en: Remove all other links, if any, and click **OK**. The results in the dialog
    box should match what is displayed in the following screenshot:![](img/B18435_04_22.png)
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移除所有其他链接（如果有的话），然后点击**确定**。对话框中的结果应该与以下屏幕截图显示的内容相匹配：![](img/B18435_04_22.png)
- en: 'Figure 4.22: Blend Relationships'
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.22：混合关系
- en: 'A little recap of what we have done so far: we are working with three data
    sources: **Pants**, **Shirts**, and **Join**, where **Join** consists of **Pants**
    and **Shirts**. We have also created a blend with **Pants** being the primary
    data source and we connected them by using **Salesperson** and **Sales Associate**
    as keys.'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 目前为止我们所做的简要回顾：我们正在使用三个数据源：**裤子**、**衬衫**和**连接**，其中**连接**包含**裤子**和**衬衫**。我们还创建了一个混合，**裤子**是主数据源，并且通过使用**销售员**和**销售助理**作为键将它们连接起来。
- en: Do not get confused by the name **Blend Relationships**. This has nothing to
    do with the logical layer relationships. It is just the name of the pop-up window.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不要被**Blend Relationships**的名称混淆。它与逻辑层关系无关。它只是弹出窗口的名称。
- en: 'Going back to the exercise, continue with the following steps:'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 回到练习，继续执行以下步骤：
- en: 'On the `Blend` `–` `Shirts` `Primary` worksheet, select the **Shirts** data
    source and place **Sales Associate** on the **Rows** shelf and **Shirt Amount**
    on the **Text** shelf:'
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`Blend` `–` `衬衫` `主`工作表中，选择**衬衫**数据源，并将**销售助理**放置在**行**架上，将**衬衫金额**放置在**文本**架上：
- en: '![](img/B18435_04_23.png)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_23.png)'
- en: 'Figure 4.23: Blend Shirts – Primary'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.23：混合衬衫 – 主
- en: 'In the same workbook, select the `Pants` data source, make sure the chain icon
    next to **Salesperson** is connected/red, and double-click **Pants Amount** to
    add it to the view:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在同一个工作簿中，选择`Pants`数据源，确保**销售员**旁边的链条图标已连接/变红，然后双击**Pants Amount**将其添加到视图中：
- en: '![](img/B18435_04_24.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_24.png)'
- en: 'Figure 4.24: Finalizing the worksheet'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '图 4.24: 完成工作表'
- en: 'Place all five worksheets on a dashboard. Format and arrange as desired. Now
    let us compare the results between the five worksheets in the following screenshot:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将所有五个工作表放到仪表板上。根据需要进行格式化和排列。现在，让我们在以下截图中比较五个工作表之间的结果：
- en: '![](img/B18435_04_25.png)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_25.png)'
- en: 'Figure 4.25: Comparison'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '图 4.25: 比较'
- en: 'In the preceding screenshot, the **Join** worksheet has double the expected
    results. Why? Because a join first matches the common key (in this case, **Salesperson/Sales
    Associate**) and then aggregates the results. The more matches found on a common
    key, the worse the problem will become. If multiple matches are found on a common
    key, the results will grow exponentially. Two matches will result in squared results,
    three will give cubed results, and so forth. This exponential effect is represented
    graphically in the following screenshot:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，**Join**工作表的结果是预期结果的两倍。为什么？因为连接操作首先匹配共同的键（在这个例子中是**销售员/销售助理**），然后再聚合结果。共同键上找到的匹配越多，问题就越严重。如果在共同键上找到多个匹配，结果将呈指数级增长。两个匹配会导致结果平方，三个匹配会导致结果立方，依此类推。这个指数效应在下面的截图中有图示表示：
- en: '![](img/B18435_04_26.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_26.png)'
- en: 'Figure 4.26: Join'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '图 4.26: 连接'
- en: On the other hand, the blend functioned more efficiently, but before the blend
    could function properly, we had to edit the data relationship so that Tableau
    could connect the two data sources using the **Salesperson** and **Sales Associate**
    fields. If the two fields had been identically named (for example, **Salesperson**),
    Tableau would have automatically provided an option to blend between the data
    sources using those fields.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，数据融合的效率更高，但在融合能够正常工作之前，我们必须编辑数据关系，以便 Tableau 能通过**销售员**和**销售助理**字段连接两个数据源。如果这两个字段的名称相同（例如，**销售员**），Tableau
    会自动提供一个选项来使用这些字段进行数据源之间的融合。
- en: The results for the `Blend Pants – Primary` and `Blend Shirts – Primary` worksheets
    are correct. There is no exponential effect. Why? Because data blending first
    aggregates the results from both data sources, and then matches the results on
    a common dimension.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '`Blend Pants – Primary`和`Blend Shirts – Primary`工作表的结果是正确的，没有出现指数效应。为什么？因为数据融合首先聚合来自两个数据源的结果，然后在共同的维度上进行匹配。'
- en: 'In this case, it is **Salesperson/Sales Associate**, as demonstrated in the
    following screenshot:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，使用的是**销售员/销售助理**，如下图所示：
- en: '![](img/B18435_04_27.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_27.png)'
- en: 'Figure 4.27: Blending results'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '图 4.27: 融合结果'
- en: What we saw in this exercise is that joins can change the data structure, so
    be careful when using them and be very aware of which columns are a suitable key.
    Also, do checks before and after joining your data, which can be as easy as counting
    rows and checking if this is the expected result.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在本次练习中，我们看到连接操作会改变数据结构，因此在使用连接时要小心，并且要非常清楚哪些列是合适的键。此外，在连接数据之前和之后进行检查也很重要，检查方法可以是简单的行数计数，并确认这是否是预期的结果。
- en: Blending has advantages and disadvantages; adding dimensions, for example, is
    not that straightforward. But we will explore more details regarding secondary
    dimensions in the next section.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 数据融合有优点也有缺点；例如，添加维度并不像想象的那么简单。不过我们将在下一节详细探讨有关次级维度的内容。
- en: Adding secondary dimensions
  id: totrans-166
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加次级维度
- en: Data blending, although particularly useful for connecting disparate data sources,
    has limitations. The most important limitation to be aware of is that data blending
    does not enable dimensions from a secondary data source. There is an exception
    to this limitation; that is, there is one way you can add a dimension from a secondary
    data source. Let us explore this further.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 数据融合虽然特别适用于连接不同的数据源，但也有其局限性。需要特别注意的局限性是，数据融合不允许从次级数据源中添加维度。但有一个例外，即有一种方法可以从次级数据源中添加维度。我们接下来将进一步探讨这个问题。
- en: 'There are other fields besides **Salesperson**/**Sales Associate** and **Shirt
    Amount**/**Pants Amount** in the data sources. We will reference those fields
    in this exercise:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 数据源中除了**销售员/销售助理**和**衬衫金额/裤子金额**，还有其他字段。在本次练习中，我们将引用这些字段：
- en: In the workbook associated with this chapter, select the `Adding Secondary Dimensions`
    worksheet.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在与本章关联的工作簿中，选择`添加次级维度`工作表。
- en: Select the **Shirts** data source.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**衬衫**数据源。
- en: 'Add a relationship between the **Shirts** and **Pants** data sources for **Material
    Type**, taking the following steps:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**衬衫**和**裤子**数据源之间为**物料类型**添加关系，按以下步骤进行：
- en: Select **Data** and then **Edit Relationships**.
  id: totrans-172
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**数据**，然后选择**编辑关系**。
- en: Ensure that **Shirts** is the primary data source and **Pants** is the secondary
    data source.
  id: totrans-173
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保**衬衫**是主要数据源，**裤子**是次级数据源。
- en: Select the **Custom** radio button.
  id: totrans-174
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**自定义**单选按钮。
- en: Click **Add…**.
  id: totrans-175
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加…**。
- en: Select **Material Type** in both the left and right columns:![Graphical user
    interface, application
  id: totrans-176
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左列和右列中选择**物料类型**：![图形用户界面，应用程序
- en: Description automatically generated](img/B18435_04_28.png)
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_04_28.png)
- en: 'Figure 4.28: Custom blend relationships'
  id: totrans-178
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.28：自定义混合关系
- en: Click **OK** to return to the view.
  id: totrans-179
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**返回到视图。
- en: Place **Material Type** on the **Rows** shelf.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**物料类型**放置在**行**架上。
- en: 'Select the **Pants** data source and make sure that the chain-link icon next
    to **Material Type** in the **Data** pane is activated and that the chain-link
    icon next to **Salesperson** is deactivated. If the icon is a gray, broken chain
    link, it is not activated. If it is an orange, connected chain link, it is activated:'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**裤子**数据源，并确保**数据**窗格中**物料类型**旁边的链条图标已激活，同时**销售人员**旁边的链条图标未激活。如果图标是灰色的、断开的链条链接，则表示未激活；如果是橙色的、连接的链条链接，则表示已激活：
- en: '![](img/B18435_04_29.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_29.png)'
- en: 'Figure 4.29: Shirts and Pants'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.29：衬衫与裤子
- en: 'Place **Material Cat** *before* **Material Type**, and **Fastener** *after*
    **Material Type** on the **Rows** shelf as follows:'
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**物料类别**放置在**物料类型**之前，并将**紧固件**放置在**物料类型**之后，按如下方式操作：
- en: '![Table'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '![表格'
- en: Description automatically generated](img/B18435_04_30.png)
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成的描述](img/B18435_04_30.png)
- en: 'Figure 4.30: Secondary dimensions'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.30：次级维度
- en: '**Material Cat** is a dimension from a secondary data source. Data blending
    does not enable dimensions from a secondary data source. Why does it work in this
    case? There are a few reasons:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: '**物料类别**是来自次级数据源的一个维度。数据混合并不启用来自次级数据源的维度。为什么在这种情况下它有效呢？有几个原因：'
- en: There is a one-to-many relationship between **Material Cat** and **Material
    Type**; that is, each member of the **Material Type** dimension is matched with
    one and only one member of the **Material Cat** dimension.
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**物料类别**和**物料类型**之间存在一对多关系；也就是说，**物料类型**维度中的每个成员都与**物料类别**维度中的一个且仅一个成员匹配。'
- en: The view is blended on **Material Type**, not **Material Cat**. This is important
    because **Material Type** is at a lower level of granularity than **Material Cat**.
    Attempting to blend the view on **Material Cat** will not enable **Material Type**
    as a secondary dimension.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 视图是基于**物料类型**进行混合的，而不是**物料类别**。这很重要，因为**物料类型**的粒度比**物料类别**更细。尝试基于**物料类别**进行混合视图将无法启用**物料类型**作为次级维度。
- en: Every member of the **Material Type** dimension within the primary data source
    also exists in the secondary data source.
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主要数据源中的每个**物料类型**维度成员在次级数据源中也存在。
- en: '**Fastener** is also a dimension from the secondary data source. In *Figure
    4.35*, it displays ***** in one of the cells, thus demonstrating that **Fastener**
    is not working as a dimension should; that is, it is not slicing the data, as
    discussed in *Chapter 1*, *Reviewing the Basics*. The reason an asterisk is displayed
    is that there are multiple **Fastener** types associated with **Wool**. **Button**
    and **Velcro** display because **Acrylic** and **Polyester** each have only one
    **Fastener** type in the underlying data.'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: '**紧固件**也是来自次级数据源的一个维度。在*图 4.35*中，它在某个单元格中显示*****，这表明**紧固件**未按预期作为维度工作；也就是说，它没有按预期切分数据，正如*第一章*中讨论的*回顾基础*所提到的。显示星号的原因是与**羊毛**相关的有多个**紧固件**类型。**纽扣**和**魔术贴**显示是因为**丙烯酸**和**聚酯**在底层数据中只有一个**紧固件**类型。'
- en: If you use blending, make sure that your main reason is to combine measures
    and that you do not need the dimensions on a detailed level. It is especially
    useful to know this before you create a dashboard, to prepare accordingly. Your
    data needs extra prepping (check *Chapter 3,* *Using Tableau Prep builder*) because
    neither a join nor a blend can bring you the expected data structure. Or you can
    make use of scaffolding, a technique that uses a helper data source—we will discuss
    this in the next section.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 如果使用混合，确保你的主要目的是合并度量，并且你不需要详细层次的维度。在创建仪表盘之前，了解这一点尤其有用，可以做好相应的准备。你的数据需要额外的预处理（请参考*第3章*，*使用Tableau
    Prep Builder*），因为无论是连接还是混合都无法提供你期望的数据结构。或者你可以使用脚手架技术，这是一种利用辅助数据源的方法——我们将在下一节讨论此方法。
- en: Introducing scaffolding
  id: totrans-194
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 引入脚手架技术
- en: Scaffolding is a technique that introduces a second data source through blending
    to reshape and/or extend the initial data source. Scaffolding enables capabilities
    that extend Tableau to meet visualization and analytical needs that may otherwise
    be exceedingly difficult or altogether impossible. Joe Mako, who pioneered scaffolding
    in Tableau, tells a story in which he used the technique to recreate a dashboard
    using four worksheets. The original dashboard, which did not use scaffolding,
    required 80 worksheets painstakingly aligned pixel by pixel.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 脚手架技术是一种通过混合引入第二数据源，重新塑造和/或扩展初始数据源的方法。脚手架技术扩展了Tableau的功能，以满足可视化和分析需求，这些需求通常非常困难或根本不可能实现。脚手架技术的先驱乔·马科（Joe
    Mako）曾讲述过他如何利用该技术，通过四个工作表重新创建仪表盘的故事。原始的仪表盘没有使用脚手架技术，必须用80个工作表进行艰苦的逐像素对齐。
- en: Among the many possibilities that scaffolding enables is extending Tableau’s
    forecasting functionality. Tableau’s native forecasting capabilities are sometimes
    criticized for lacking sophistication. Scaffolding can be used to address this
    criticism.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 脚手架技术能够扩展Tableau的预测功能。Tableau的原生预测功能有时因缺乏复杂性而受到批评。脚手架技术可以用来解决这一批评。
- en: 'The following are the steps:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是步骤：
- en: In the workbook associated with this chapter, select the `Scaffolding` worksheet
    and connect to the `World Indicators` data source.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本章相关的工作簿中，选择`脚手架`工作表并连接到`世界指标`数据源。
- en: 'Using Excel or a text editor, create a `Records` dataset. The following two-row
    table represents the `Records` dataset in its entirety:'
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Excel或文本编辑器创建`记录`数据集。以下两行表格表示`记录`数据集的全部内容：
- en: '![Table'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: '![表格'
- en: Description automatically generated](img/B18435_04_31.png)
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_04_31.png)
- en: 'Figure 4.31: Excel file'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.31：Excel文件
- en: Connect Tableau to the dataset.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 连接Tableau到数据集。
- en: To be expedient, consider copying the dataset directly from Excel by using *Ctrl*
    + *C* and pasting it directly into Tableau with *Ctrl* + *V*.
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了方便，考虑直接使用*Ctrl* + *C*从Excel复制数据集，然后使用*Ctrl* + *V*直接粘贴到Tableau中。
- en: 'Create a **Start Date** parameter in Tableau, with the settings seen in the
    following screenshot. Notice the highlighted sections in the screenshot by which
    you can set the desired display format:'
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Tableau中创建一个**开始日期**参数，设置如以下截图所示。注意截图中的高亮部分，你可以通过这些部分设置所需的显示格式：
- en: '![](img/B18435_04_32.png)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_32.png)'
- en: 'Figure 4.32: Display format'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.32：显示格式
- en: Create another parameter named **End Date** with identical settings.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建另一个名为**结束日期**的参数，设置与前者相同。
- en: 'In the **Data** pane, right-click on the **Start Date** and **End Date** parameters
    you just created and select **Show Parameter**:'
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据**面板中，右键点击刚创建的**开始日期**和**结束日期**参数，选择**显示参数**：
- en: '![](img/B18435_04_33.png)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_33.png)'
- en: 'Figure 4.33: Show Parameter'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.33：显示参数
- en: 'Set the start and end dates as desired, for example, **2000** – **2027**:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置所需的开始和结束日期，例如，**2000** – **2027**：
- en: '![](img/B18435_04_34.png)'
  id: totrans-213
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_34.png)'
- en: 'Figure 4.34: Start and end dates'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.34：开始日期和结束日期
- en: 'Select the **Records** data source and create a calculated field called **Date**
    with the following code:'
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**记录**数据源，并创建一个名为**日期**的计算字段，代码如下：
- en: '[PRE2]'
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Place the **Date** field on the **Rows** shelf.
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**日期**字段放置到**行**货架上。
- en: 'Right-click on the **Date** field on the **Rows** shelf and select **Show Missing
    Values**. Note that all the dates between the start and end date settings now
    display:'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击**日期**字段，在**行**货架上选择**显示缺失值**。注意，现在所有开始日期和结束日期之间的日期都会显示出来：
- en: '![](img/B18435_04_35.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_35.png)'
- en: 'Figure 4.35: Show Missing Values'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.35：显示缺失值
- en: 'Create a parameter named **Select Country A** with the settings shown in the
    following screenshot. Note that the list of countries was added with the **Add
    values from** button:'
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为**选择国家A**的参数，并按照下图所示的设置进行配置。请注意，国家列表是通过**从中添加值**按钮添加的：
- en: '![](img/B18435_04_36.png)'
  id: totrans-222
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_36.png)'
- en: 'Figure 4.36: Add from field'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.36：从字段添加
- en: Create another parameter named **Select Country B** with identical settings.
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建另一个名为**选择国家B**的参数，设置与前述相同。
- en: 'Create a parameter named **Select Country A Forecast** with the settings given
    in the following screenshot:'
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为**选择国家A预测**的参数，并按照下图所示的设置进行配置：
- en: '![](img/B18435_04_37.png)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_37.png)'
- en: 'Figure 4.37: Edit parameter'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.37：编辑参数
- en: Create another parameter named **Select Country B Forecast** with identical
    settings.
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建另一个名为**选择国家B预测**的参数，设置与前述参数相同。
- en: 'In the **Data** pane, right-click on the four parameters you just created (**Select
    Country A**, **Select Country B**, **Select Country A Forecast**, and **Select
    Country B Forecast**) and select **Show Parameter**:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据**面板中，右键单击刚刚创建的四个参数（**选择国家A**、**选择国家B**、**选择国家A预测**和**选择国家B预测**），并选择**显示参数**：
- en: '![](img/B18435_04_38.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_38.png)'
- en: 'Figure 4.38: Show Parameter'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.38：显示参数
- en: 'Make sure that the **Date** field in the **World Indicators** data source has
    the orange chain-link icon deployed. This indicates it is used as a linking field:'
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保在**世界指标**数据源中，**日期**字段旁边显示有橙色链条图标。这表示该字段被用作链接字段：
- en: '![](img/B18435_04_39.png)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_39.png)'
- en: 'Figure 4.39: Link'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.39：链接
- en: 'Within the **World Indicators** dataset, create the following calculated fields:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**世界指标**数据集中，创建以下计算字段：
- en: '| **Calculated field name** | **Calculated field code** |'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **计算字段名称** | **计算字段代码** |'
- en: '| `Country A Population` |'
  id: totrans-237
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `国家A人口` |'
- en: '[PRE3]'
  id: totrans-238
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '|'
  id: totrans-239
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: '| `Country B Population` |'
  id: totrans-240
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `国家B人口` |'
- en: '[PRE4]'
  id: totrans-241
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '|'
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: 'Within the **Records** dataset, create the following calculated fields:'
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**记录**数据集中，创建以下计算字段：
- en: '| **Calculated field name** | **Calculated field code** |'
  id: totrans-244
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **计算字段名称** | **计算字段代码** |'
- en: '| `Actual/Forecast` |'
  id: totrans-245
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `实际/预测` |'
- en: '[PRE5]'
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '|'
  id: totrans-247
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: '| `Country A Population` |'
  id: totrans-248
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `国家A人口` |'
- en: '[PRE6]'
  id: totrans-249
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '|'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: '| `Country A YOY Change` |'
  id: totrans-251
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `国家A同比变化` |'
- en: '[PRE7]'
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '|'
  id: totrans-253
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: '| `Country B Population` |'
  id: totrans-254
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `国家B人口` |'
- en: '[PRE8]'
  id: totrans-255
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '|'
  id: totrans-256
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: '| `Country B YOY Change` |'
  id: totrans-257
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `国家B同比变化` |'
- en: '[PRE9]'
  id: totrans-258
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '|'
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: '| `Country A-B Diff` |'
  id: totrans-260
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `国家A-B差异` |'
- en: '[PRE10]'
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '|'
  id: totrans-262
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: '| `Country A-B % Diff` |'
  id: totrans-263
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `国家A-B百分比差异` |'
- en: '[PRE11]'
  id: totrans-264
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '|'
  id: totrans-265
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '|'
- en: 'Within the **Data** pane, right-click on **Country A YOY Change**, **Country
    B YOY Change**, and **Country A-B % Diff** and select **Default Properties** |
    **Number Format…** to change the default number format to **Percentage**:'
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据**面板中，右键单击**国家A同比变化**、**国家B同比变化**和**国家A-B百分比差异**，然后选择**默认属性** | **数字格式…**，将默认数字格式更改为**百分比**：
- en: '![](img/B18435_04_40.png)'
  id: totrans-267
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_40.png)'
- en: 'Figure 4.40: Default Properties'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.40：默认属性
- en: 'With the **Records** data source selected, place the **Actual/Forecast**, **Measure
    Values**, and **Measure Names** fields on the **Color**, **Text**, and **Columns**
    shelves, respectively:'
  id: totrans-269
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**记录**数据源，将**实际/预测**、**度量值**和**度量名称**字段分别放置在**颜色**、**文本**和**列**架构上：
- en: '![Graphical user interface, table'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，表格'
- en: Description automatically generated](img/B18435_04_41.png)
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_04_41.png)
- en: 'Figure 4.41: Forecast setup'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.41：预测设置
- en: 'Adjust the **Measure Values** shelf so that the fields that display are identical
    to the following screenshot. Also, ensure that **Compute Using** for each of these
    fields is set to **Table (down)**:'
  id: totrans-273
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 调整**度量值**架构，使得显示的字段与下图所示相同。同时，确保每个字段的**计算方式**设置为**表（向下）**：
- en: '![Graphical user interface, table'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: '![图形用户界面，表格'
- en: Description automatically generated](img/B18435_04_42.png)
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_04_42.png)
- en: 'Figure 4.42: Compute Using'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.42：计算方式
- en: So, what have we achieved so far? We created a duplicated data structure that
    allows us to compare two countries in two separate columns, even though the data
    is in one column in the original dataset. This setup allows us to ask more advanced
    questions.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们取得了什么成果？我们创建了一个重复的数据结构，使得即使原始数据集中的数据在一列中，我们也能将两个国家放在两个单独的列中进行比较。这一设置使我们能够提出更高级的问题。
- en: 'To demonstrate this, let us ask, “*When will India’s population overtake China’s?*”
    You can set the parameters as desired—I chose 0.45% and 1.20% as the average yearly
    growth rates, but feel free to choose any parameter you think works best for a
    country. In *Figure 4.48*, you see that with a growth rate of 0.45% and 1.20%
    for China and India, respectively, India will have more inhabitants than China
    by 2024\. You can observe this by looking at the columns **Country A Population**
    and **Country B Population**. Everything in orange is a forecast, while everything
    in blue is actual data from our dataset:'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 为了证明这一点，让我们问一下，“*印度的人口何时会超过中国？*” 您可以根据需要设置参数——我选择了0.45%和1.20%作为平均年增长率，但请随意选择您认为最适合一个国家的参数。在*图4.48*中，您可以看到中国和印度分别以0.45%和1.20%的增长率，印度将在2024年比中国拥有更多居民。您可以通过查看**Country
    A Population**和**Country B Population**列来观察到这一点。所有橙色表示预测数据，而所有蓝色表示我们数据集中的实际数据：
- en: '![](img/B18435_04_43.png)'
  id: totrans-279
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_43.png)'
- en: 'Figure 4.43: Forecast dashboard'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.43：预测仪表盘
- en: We are obviously already many years ahead; can you use this dashboard to figure
    out the actual average growth rate for China and India from 2012 to 2020 if I
    tell you that the population in 2020 was 1,439,323,776 in China and 1,380,004,385
    in India? Share your results on Tableau Public with the tag **#MasteringTableau**!
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 我们显然已经超前了多年；你能使用这个仪表板来计算出2012年至2020年间中国和印度的实际平均增长率吗？如果告诉你2020年中国的人口为1,439,323,776，印度的人口为1,380,004,385，那么请在Tableau
    Public上分享你的结果，并标记为**#MasteringTableau**！
- en: One key to this exercise is data scaffolding. Data scaffolding produces data
    that does not exist in the data source. The **World Indicators** dataset only
    includes dates from 2000 to 2012 and obviously, the **Records** dataset does not
    contain any dates. By using the **Start Date** and **End Date** parameters coupled
    with the calculated **Date** field, we were able to produce any set of dates desired.
    We had to blend the data, rather than join or union, to keep the original data
    source intact and create all additional data outside of **World Indicators** itself.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 这个练习的关键之一是数据搭建。数据搭建生成不存在于数据源中的数据。**World Indicators**数据集仅包括2000年至2012年的日期，显然**Records**数据集不包含任何日期。通过使用**Start
    Date**和**End Date**参数与计算的**Date**字段，我们能够生成所需的任何日期集。我们必须混合数据，而不是联接或合并，以保持原始数据源的完整性，并在**World
    Indicators**之外创建所有额外的数据。
- en: The actual data scaffolding occurred upon selecting **Show Missing Values**
    from the **Date** field dropdown after it was placed on the **Rows** shelf. This
    allowed every year between **Start Date** and **End Date** to display, even when
    there were no matching years in the underlying data. *Chapter 6*, *Utilizing OData,
    Data Densification, Big Data, and Google BigQuery*, will explore something remarkably
    similar to data scaffolding, data densification, in more detail.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 在将**Date**字段放置在**Rows**架上后，选择**Show Missing Values**后，实际数据搭建发生了。这允许显示**Start
    Date**和**End Date**之间的每一年，即使底层数据中没有匹配的年份。*第6章*，*使用OData、数据搭建、大数据和Google BigQuery*，将更详细地探讨类似于数据搭建的数据密集化。
- en: 'Let us look at a few of the calculated fields in more depth to better understand
    how forecasting works in this exercise:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更深入地看一些计算字段，以更好地理解这个练习中的预测工作方式：
- en: 'Calculated field: `Actual/Forecast`:'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: '计算字段：`Actual/Forecast`:'
- en: '[PRE12]'
  id: totrans-286
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The preceding code determines whether data exists in the **World Indicators**
    dataset. If the date is after 2012, no data exists and thus `Forecast` is returned.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 前述代码确定了是否在**World Indicators**数据集中存在数据。如果日期在2012年之后，则不存在数据，因此返回`Forecast`。
- en: 'Calculated field: `Country A Population`:'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 计算字段：`Country A Population`：
- en: '[PRE13]'
  id: totrans-289
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: If forecasting is necessary to determine the value (that is, if the date is
    after 2012), the `ELSE` portion of this code is exercised. The `PREVIOUS_VALUE`
    function returns the value of the previous row and multiplies the results by the
    forecast and then adds the previous row.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要预测以确定数值（即，如果日期在2012年之后），则执行此代码的`ELSE`部分。`PREVIOUS_VALUE`函数返回前一行的数值，并将结果乘以预测值，然后加上前一行。
- en: 'Let’s look at an example in the following table:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一个示例在下表中：
- en: '| `Previous Row Value (PRV)` | 1,000 |'
  id: totrans-292
  prefs: []
  type: TYPE_TB
  zh: '| `Previous Row Value (PRV)` | 1,000 |'
- en: '| `Forecast (F)` | 0.01 |'
  id: totrans-293
  prefs: []
  type: TYPE_TB
  zh: '| `Forecast (F)` | 0.01 |'
- en: '| `PRV * F` | 10 |'
  id: totrans-294
  prefs: []
  type: TYPE_TB
  zh: '| `PRV * F` | 10 |'
- en: '| `Current Row Value` | 1,010 |'
  id: totrans-295
  prefs: []
  type: TYPE_TB
  zh: '| `Current Row Value` | 1,010 |'
- en: 'One important thing to note in the `Country A Population` calculated field
    is that the forecast is quite simple: multiply the previous population by a given
    forecast number and tally the results. Without changing the overall structure
    of the logic, this section of code could be modified with more sophisticated forecasting.'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 在`Country A Population`计算字段中，有一点非常重要：预测非常简单：将前一个人口数乘以给定的预测值，然后求和。无需改变逻辑的整体结构，这段代码可以通过更复杂的预测方法进行修改。
- en: These exercises have shown that with a few other tricks and techniques, blending
    can be used to great effect in your data projects. Finally, we will talk about
    data structures in general such that you will better understand why Tableau is
    doing what it is doing and how you can achieve your visualization goals.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 这些练习表明，通过一些其他技巧和方法，数据融合可以在你的数据项目中产生很大的效果。最后，我们将讨论数据结构的一般概念，这样你就能更好地理解为什么 Tableau
    这么做，以及如何实现你的可视化目标。
- en: Understanding data structures
  id: totrans-298
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解数据结构
- en: The right data structure is not easily definable. True, there are ground rules.
    For instance, tall data is generally better than wide data. A wide dataset with
    lots of columns can be difficult to work with, whereas the same data structured
    in a tall format with fewer columns but more rows is usually easier to work with.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 正确的数据结构并不容易定义。确实，有一些基本规则。例如，长格式的数据通常比宽格式的数据更好。包含大量列的宽格式数据可能难以处理，而相同的数据如果用更少的列和更多的行呈现的长格式，通常会更容易操作。
- en: But this is not always the case! Some business questions are more easily answered
    with wide data structures. And that is the crux of the matter. Business questions
    determine the right data structure. If one structure answers all questions, great!
    However, your questions may require multiple data structures. The **pivot** feature
    in Tableau helps you adjust data structures on the fly to answer different business
    questions.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 但这并非总是如此！有些商业问题使用宽格式的数据结构更容易回答。这就是问题的关键。商业问题决定了正确的数据结构。如果一个结构能回答所有问题，那太好了！然而，你的问题可能需要多种数据结构。Tableau
    中的**透视**功能可以帮助你灵活调整数据结构，以回答不同的业务问题。
- en: 'Before beginning this exercise, make sure you understand the following points:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始这个练习之前，确保你理解以下几点：
- en: Pivoting in Tableau is limited to Excel, text files, and Google Sheets; otherwise,
    you must use Custom SQL or Tableau Prep
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Tableau 中进行数据透视的操作仅限于 Excel、文本文件和 Google 表格；否则，您必须使用自定义 SQL 或 Tableau Prep。
- en: A pivot in Tableau is referred to as *unpivot* in database terminology
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Tableau 中，数据透视被称为数据库术语中的*反透视*。
- en: 'As a business analyst for a hospital, you are connecting Tableau to a daily
    snapshot of patient data. You have two questions:'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 作为医院的商业分析师，你正在将 Tableau 连接到病人的每日快照数据。你有两个问题：
- en: How many events occur on any given date? For example, how many patients check
    in on a given day?
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在任何给定日期，发生了多少事件？例如，某天有多少病人入住？
- en: How much time expires between events? For example, what is the average stay
    for patients in the hospital for multiple days?
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 事件之间消耗了多少时间？例如，住院病人的平均住院天数是多少？
- en: 'To answer these questions, take the following steps:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 为了回答这些问题，请按以下步骤操作：
- en: In the starter workbook associated with this chapter, select the `Time Frames`
    worksheet, and within the **Data** pane, select the **Patient_Snapshot** data
    source.
  id: totrans-308
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在本章节的启动工作簿中，选择`时间框架`工作表，并在**数据**窗格中选择**Patient_Snapshot**数据源。
- en: Click on the dropdown in the **Marks** card and select **Bar** as the chart
    type.
  id: totrans-309
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**标记**卡片中的下拉菜单，选择**条形图**作为图表类型。
- en: 'Right-click in the **Data** pane to create a parameter named **Select Time
    Frame** with the settings displayed in the following screenshot:'
  id: totrans-310
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据**窗格中右键单击，创建一个名为**选择时间框架**的参数，并使用以下截图所示的设置：
- en: '![](img/B18435_04_44.png)'
  id: totrans-311
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_44.png)'
- en: 'Figure 4.44: Parameter'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.44：参数
- en: Right-click on the parameter we just created and select **Show Parameter**.
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击我们刚创建的参数，选择**显示参数**。
- en: 'Right-click in the **Data** pane to create a calculated field called **Selected
    Time Frame** with the following code:'
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据**窗格中右键单击，创建一个名为**选择时间框架**的计算字段，代码如下：
- en: '[PRE14]'
  id: totrans-315
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Drag the following fields to the associated shelves and define them as directed:'
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下字段拖到相应的货架上，并按照指示进行定义：
- en: '| Field name | Shelf directions |'
  id: totrans-317
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 字段名称 | 货架方向 |'
- en: '| Patient Type | Drag to the **Filter** shelf and check **Inpatient**. |'
  id: totrans-318
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 病人类型 | 拖动到**筛选器**货架，并勾选**住院病人**。 |'
- en: '| Check-in Date | Drag to the **Filter** shelf and select **Range of dates**.
    Also, right-click on the resulting filter and select **Show Filter**. |'
  id: totrans-319
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 入住日期 | 拖动到**筛选**架上并选择**日期范围**。同时，右键点击结果筛选并选择**显示筛选器**。 |'
- en: '| Check-in Date | Right-click and drag to the **Columns** shelf and select
    **MDY**. |'
  id: totrans-320
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 入住日期 | 右键点击并拖动到**列**架上，选择**MDY**。 |'
- en: '| Selected Time Frame | Right-click and drag to the **Rows** shelf and select
    **AVG**. |'
  id: totrans-321
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 选择的时间范围 | 右键点击并拖动到**行**架上，选择**AVG**。 |'
- en: '| Selected Time Frame | Right-click and drag to the **Color** shelf and select
    **AVG**. Set colors as desired. |'
  id: totrans-322
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 选择的时间范围 | 右键点击并拖动到**颜色**架上，选择**AVG**。根据需要设置颜色。 |'
- en: 'After these actions, your worksheet should look like the following:'
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成这些操作后，你的工作表应如下所示：
- en: '![Chart, bar chart'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: '![图表，条形图'
- en: Description automatically generated](img/B18435_04_45.png)
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 自动生成描述](img/B18435_04_45.png)
- en: 'Figure 4.45: Initial dashboard'
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.45：初始仪表盘
- en: 'Right-click on the **Avg Selected Time Frame** axis and select **Edit Axis…**,
    as shown in the following figure. Then, delete the title:'
  id: totrans-327
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击**选定时间范围**轴并选择**编辑轴...**，如下图所示。然后，删除标题：
- en: '![](img/B18435_04_46.png)'
  id: totrans-328
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_46.png)'
- en: 'Figure 4.46: Edit Axis...'
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.46：编辑轴...
- en: 'Select **Worksheet** | **Show Title**. Edit the title by inserting the parameter
    **Select Time Frame**, as shown in the following screenshot:'
  id: totrans-330
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**工作表** | **显示标题**。通过插入参数**选择时间范围**来编辑标题，如下截图所示：
- en: '![](img/B18435_04_47.png)'
  id: totrans-331
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_47.png)'
- en: 'Figure 4.47: Add parameter'
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.47：添加参数
- en: The data structure was ideal for the first part of this exercise. You were able
    to create the visualization quickly. The only section of moderate interest was
    setting up the **Selected Time Frame** calculated field with the associated parameter.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 数据结构非常适合本练习的第一部分。你能够迅速创建可视化。唯一的中等难度部分是设置带有关联参数的**选定时间范围**计算字段。
- en: 'This allows the end user to choose which time frame they would like to view:'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 这使得最终用户可以选择他们希望查看的时间范围：
- en: '![](img/B18435_04_48.png)'
  id: totrans-335
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_48.png)'
- en: 'Figure 4.48: Dashboard'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.48：仪表盘
- en: But what happens if you need to find out how many people were involved in a
    type of event per day?
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，如果你需要查找每天参与某种事件的人数，会发生什么呢？
- en: 'This question is rather difficult to answer using the current data structure
    because we have one row per patient with multiple dates in that row. In *Figure
    4.49*, you can see the difference: the right-hand side is our current data structure,
    and the left-hand side is the data structure that will make it easier to count
    events per day:'
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 由于当前的数据结构是每个患者一行，且每行有多个日期，这个问题使用当前的数据结构回答起来比较困难。在*图 4.49*中，你可以看到差异：右侧是我们当前的数据结构，左侧是能够更容易按天统计事件的数据结构：
- en: '![](img/B18435_04_49.png)'
  id: totrans-339
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_49.png)'
- en: 'Figure 4.49: Patient data structure'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.49：患者数据结构
- en: 'Therefore, in the second part of this exercise, we will try a different approach
    by pivoting the data:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在本练习的第二部分，我们将尝试通过数据透视来采取不同的方法：
- en: In the starter workbook associated with this chapter, select the `Events Per
    Date` worksheet.
  id: totrans-342
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在与本章节相关的启动工作簿中，选择`每日期事件`工作表。
- en: In the **Data** pane, right-click the **Patient_Snapshot** data source and choose
    **Duplicate**.
  id: totrans-343
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据**窗格中，右键点击**患者快照**数据源并选择**复制**。
- en: Rename the duplicate **Events**.
  id: totrans-344
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重命名重复的**事件**。
- en: 'Right-click on the **Events** data source and choose **Edit Data Source...**:'
  id: totrans-345
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击**事件**数据源并选择**编辑数据源...**：
- en: '![](img/B18435_04_50.png)'
  id: totrans-346
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18435_04_50.png)'
- en: 'Figure 4.50: Edit Data Source...'
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4.50：编辑数据源...
- en: 'Take the following steps:'
  id: totrans-348
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照以下步骤操作：
- en: Select all five of the date fields with *Shift* or *Ctrl* + click.
  id: totrans-349
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用*Shift*或*Ctrl* + 点击选择所有五个日期字段。
- en: Select the drop-down option for any of the selected fields and choose **Pivot**:![](img/B18435_04_51.png)
  id: totrans-350
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为任何已选择的字段选择下拉选项并选择**透视**：![](img/B18435_04_51.png)
- en: 'Figure 4.51: Pivot'
  id: totrans-351
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.51：数据透视
- en: The pivot will turn rows and columns around and we will get a data structure
    just like in *Figure 4.49* on the left-hand side. Rename the pivoted fields **Event
    Type** and **Event Date**.
  id: totrans-352
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 数据透视将会交换行和列，我们将得到一个类似于*图 4.49*左侧的数据结构。将数据透视后的字段重命名为**事件类型**和**事件日期**。
- en: 'Select the `Events Per Date` worksheet and place the following fields on the
    associated shelves and define as directed:'
  id: totrans-353
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择`每日期事件`工作表，并将以下字段放置到关联的架上并按要求定义：
- en: '| **Field name** | **Shelf directions** |'
  id: totrans-354
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **字段名称** | **架上的方向** |'
- en: '| `Event Date` | Right-click and drag to the **Rows** shelf and select **MDY**
    |'
  id: totrans-355
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `事件日期` | 右键点击并拖动到**行**架上，选择**MDY** |'
- en: '| `Event Type` | Place after **Event Date** on the **Rows** shelf |'
  id: totrans-356
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `事件类型` | 放置于**事件日期**之后的**行**架上 |'
- en: '| `Patient Type` | Right-click and select **Show Filter** |'
  id: totrans-357
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `患者类型` | 右键点击并选择**显示筛选器** |'
- en: '| `Number of Records` | Drag to the **Columns** shelf |'
  id: totrans-358
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `记录数` | 拖动到**列**架上 |'
- en: From this, your worksheet should look like the following:![Chart, bar chart
  id: totrans-359
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于此，您的工作表应该如下所示：![图表，条形图
- en: Description automatically generated](img/B18435_04_52.png)
  id: totrans-360
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 描述自动生成](img/B18435_04_52.png)
- en: 'Figure 4.52: Events per Date'
  id: totrans-361
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 4.52：按日期划分的事件
- en: 'The original data structure was not well suited to this exercise; however,
    after duplicating the data source and pivoting, the task of counting events per
    day was quite simple since we were able to achieve this by using only three fields:
    **Event Date**, **Number of Records**, and **Event Type**. That is the main takeaway.
    If you find yourself struggling to create a visualization to answer a seemingly
    simple business question, consider pivoting.'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 原始数据结构并不适合这个练习；然而，在复制数据源并进行数据透视后，通过仅使用三个字段：**事件日期**、**记录数**和**事件类型**，计算每日事件变得相当简单。这是主要的收获。如果你发现自己在创建一个看似简单的商业问题可视化时遇到困难，考虑使用数据透视。
- en: Summary
  id: totrans-363
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: We began this chapter with an introduction to relationships, followed by a discussion
    on joins, and discovered the queries Tableau uses to generate the respective data.
    Unions come in handy if identically formatted data, stored in multiple sheets
    or data sources, needs to be appended.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从介绍关系开始这一章节，接着讨论了联接，并且了解了 Tableau 用来生成相应数据的查询。若需要将格式相同的数据从多个表格或数据源合并，**联合**操作非常有用。
- en: Then, we reviewed data blending to clearly understand how it differs from joining.
    We discovered that the primary limitation in data blending is that no dimensions
    are allowed from a secondary source; however, we also discovered that there are
    exceptions to this rule. We also discussed scaffolding, which can make data blending
    surprisingly fruitful.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们回顾了数据混合，清楚地理解了它与联接的区别。我们发现数据混合的主要限制在于不允许使用来自二级数据源的维度；然而，我们也发现这一规则是有例外的。我们还讨论了支架结构，这使得数据混合变得出乎意料的有效。
- en: Finally, we discussed data structures and learned how pivoting can make difficult
    or impossible visualizations easy. Having completed our second data-centric discussion,
    in the next chapter, we will discuss table calculations, partitioning, and addressing.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们讨论了数据结构，并学习了如何通过数据透视使得困难或不可能的可视化变得简单。完成了第二次以数据为中心的讨论后，在下一章节中，我们将讨论表计算、分区和地址处理。
- en: Learn more on Discord
  id: totrans-367
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在 Discord 上了解更多
- en: 'To join the Discord community for this book – where you can share feedback,
    ask questions to the author, and learn about new releases – follow the QR code
    below:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 要加入这个书籍的 Discord 社区——你可以在这里分享反馈、向作者提问，并了解新版本的发布——请扫描下面的二维码：
- en: '[https://packt.link/tableau](https://packt.link/tableau)'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://packt.link/tableau](https://packt.link/tableau)'
- en: '![](img/QR_Code2044012316175764640.png)'
  id: totrans-370
  prefs: []
  type: TYPE_IMG
  zh: '![](img/QR_Code2044012316175764640.png)'
