- en: Chapter 5. Data Analysis on Spark
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第5章：Spark上的数据分析
- en: The field of data analytics at scale has been evolving like never before. Various
    libraries and tools were developed for data analysis with a rich set of algorithms.
    On a parallel line, distributed computing techniques were evolving with time,
    to process huge datasets at scale. These two traits had to converge, and that
    was the primary intention behind the development of Spark.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 数据分析领域的规模化发展前所未有。为数据分析开发了各种库和工具，拥有丰富的算法集。同时，分布式计算技术随着时间的推移也在不断发展，以便在大规模处理庞大数据集。这两个特性必须结合起来，这就是Spark开发的主要目的。
- en: The previous two chapters outlined the technology aspects of data science. It
    covered some fundamentals on the DataFrame API, Datasets, streaming data  and
    how it facilitated data representation through DataFrames that R and Python users
    were familiar with. After introducing this API, we saw how operating on datasets
    became easier than ever. We also looked at how Spark SQL played a background role
    in supporting the DataFrame API with its robust features and optimization techniques.
    In this chapter, we are going to cover the scientific aspect of big data analysis
    and learn various data analytics techniques that can be executed on Spark.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 前两章概述了数据科学的技术方面，涵盖了DataFrame API、数据集、流数据的基础知识，以及它如何通过DataFrame促进数据表示，这是R和Python用户熟悉的方式。在介绍了这个API后，我们看到操作数据集变得比以往更加简单。我们还看到了Spark
    SQL如何通过其强大的功能和优化技术在后台支持DataFrame API。在本章中，我们将介绍大数据分析的科学方面，并学习可以在Spark上执行的各种数据分析技术。
- en: 'As a prerequisite for this chapter, a basic understanding of the DataFrame
    API and statistics fundamentals is good to have. However, we have tried to make
    the content as simple as possible and covered some important fundamentals in detail
    so that anyone can get started with statistical analysis on Spark. The topics
    covered in this chapter are as follows:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的前提是对DataFrame API和统计学基础有基本了解。然而，我们已尽力将内容简化，并详细涵盖了一些重要的基础知识，以便任何人都能在Spark上开始进行统计分析。本章将涵盖以下主题：
- en: Data analytics life cycle
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据分析生命周期
- en: Data acquisition
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据采集
- en: Data preparation
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据准备
- en: Data consolidation
  id: totrans-7
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据整合
- en: Data cleansing
  id: totrans-8
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据清理
- en: Data transformation
  id: totrans-9
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据转换
- en: Basics of statistics
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 统计学基础
- en: Sampling
  id: totrans-11
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 抽样
- en: Data distributions
  id: totrans-12
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据分布
- en: Descriptive statistics
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述性统计
- en: Measures of location
  id: totrans-14
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 位置度量
- en: Measures of spread
  id: totrans-15
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 离散度量
- en: Summary statistics
  id: totrans-16
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 汇总统计
- en: Graphical techniques
  id: totrans-17
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 图形技术
- en: Inferential statistics
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 推断统计
- en: Discrete probability distributions
  id: totrans-19
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 离散概率分布
- en: Continuous probability distributions
  id: totrans-20
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连续概率分布
- en: Standard error
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标准误差
- en: Confidence level
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 置信度水平
- en: Margin of error and confidence interval
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 错误边际和置信区间
- en: Variability in population
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 人群中的变异性
- en: Estimating sample size
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 样本量估算
- en: Hypothesis testing
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 假设检验
- en: Chi-square test
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 卡方检验
- en: F-test
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: F检验
- en: Correlations
  id: totrans-29
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 相关性
- en: Data analytics life cycle
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据分析生命周期
- en: For most real-world projects, there is some defined sequence of steps to be
    followed. However, there are no universally agreed upon definitions or boundaries
    for data analytics and data science. Generally, the term "data analytics" encompasses
    the techniques and processes involved in examining data, discovering useful insights,
    and communicating them. The term "data science" can be best treated as an interdisciplinary
    field drawing from *statistics*, *computer science*, and *mathematics*. Both terms
    deal with processing raw data to derive knowledge or insights, usually in an iterative
    fashion, and some people use them interchangeably.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 对于大多数现实世界的项目，都有一套定义好的步骤顺序需要遵循。然而，数据分析和数据科学并没有普遍认同的定义或边界。通常，“数据分析”一词涵盖了检查数据、发现有用洞察并传达这些洞察的技术和过程。而“数据科学”一词最好被视为一个跨学科的领域，涉及*统计学*、*计算机科学*和*数学*。这两个术语都涉及对原始数据的处理，以得出知识或洞察，通常是迭代进行的，有些人会交替使用这两个术语。
- en: 'Based on diverse business requirements, there are different ways of approaching
    problems but there is no unique standard process that fits in well with all possible
    scenarios. A typical process workflow can be summarized as a cycle of formulating
    a question, exploring, hypothesizing, validating the hypothesis, analyzing the
    results, and starting all over again. This is depicted in the following figure
    with the thick arrows. From a data perspective, the workflow consists of data
    acquisition, preprocessing, exploring the data, modeling, and communicating the
    results. This is shown in the figure as circles. Analysis and visualization happen
    at every stage, right from data collection to results communication. The data
    analytics workflow encompasses all the activities shown in both views:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 根据不同的业务需求，解决问题的方式有很多种，但并没有一个适用于所有可能场景的标准流程。一个典型的流程可以概括为：提出问题、探索、假设、验证假设、分析结果，然后重新开始。这一点通过下图中的粗箭头进行了展示。从数据的角度来看，工作流程包括数据获取、预处理、数据探索、建模和结果传达。这些通过图中的圆圈来表示。分析和可视化在每个阶段都会发生，从数据收集到结果传达都贯穿其中。数据分析工作流程涵盖了两个视图中展示的所有活动：
- en: '![Data analytics life cycle](img/image_05_001.jpg)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![数据分析生命周期](img/image_05_001.jpg)'
- en: The most important thing in the entire life cycle is the question at hand. Data
    that might contain an answer (relevant data!) to that question comes next. Depending
    on the question, the first task is to collect the right data from one or more
    data sources as needed. Organizations often maintain **data lakes**, which are
    humongous repositories of data in their original format.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在整个生命周期中，最重要的事情是当前的问题。接下来是可能包含答案（相关数据！）的数据。根据问题的不同，第一项任务是根据需要从一个或多个数据源收集正确的数据。组织通常维护**数据湖**，这是存储原始格式数据的庞大库。
- en: The next step is to clean/transform the data to the desired format. Data cleansing
    is also called data munging, data wrangling, or data dredging. This involves activities
    such as missing value treatment and outlier treatment upon assessing the quality
    of the data at hand. You may also have to aggregate/plot the data for better understanding.
    This process of formulating the final data matrix to work with is touted as the
    most time-consuming step. This also happens to be an underestimated component
    that is considered to be part of preprocessing, along with other activities such
    as feature extraction and data transformation.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是清洗/转换数据到所需的格式。数据清洗也称为数据处理、数据整理或数据挖掘。这包括在评估手头数据质量时进行缺失值处理和异常值处理等活动。你可能还需要对数据进行汇总/绘制图表，以便更好地理解数据。这个制定最终数据矩阵的过程被认为是最耗时的步骤。这也是一个被低估的部分，通常与特征提取和数据转换等其他活动一起被视为预处理的一部分。
- en: The crux of data science, that is, training models and extracting patterns,
    comes next, which requires heavy use of statistics and machine learning. The final
    step is publishing the results.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 数据科学的核心，训练模型和提取模式，紧接其后，这需要大量使用统计学和机器学习。最后一步是发布结果。
- en: The remaining sections in this chapter delve deeper into each of these steps
    and how they can be implemented using Spark. Some basics of statistics are also
    included so as to enable the reader to follow the code snippets with ease.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 本章剩余部分将深入探讨这些步骤，并讲解如何使用Spark实现这些步骤。章节中还包括了一些基础的统计知识，以便让读者更轻松地理解代码片段。
- en: Data acquisition
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据获取
- en: Data acquisition, or data collection, is the very first step in any data science
    project. Usually, you won't find the complete set of required data in one place
    as it is distributed across **line-of-business** (**LOB**) applications and systems.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 数据获取，或数据收集，是任何数据科学项目中的第一步。通常，你不会在一个地方找到完整的所需数据，因为数据分布在**业务线**（**LOB**）应用程序和系统中。
- en: The majority of this section has already been covered in the previous chapter,
    which outlined how to source data from different data sources and store the data
    in DataFrames for easier analysis. There is a built-in mechanism in Spark to fetch
    data from some of the common data sources and the *Data Source API* is provided
    for the ones not supported out of the box on Spark.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 本节的大部分内容已经在上一章中讨论过，上一章概述了如何从不同的数据源获取数据并将其存储在DataFrame中，以便于分析。Spark内置了从一些常见数据源获取数据的机制，对于不支持的源，则提供了*数据源API*。
- en: 'To get a better understanding of the data acquisition and preparation phases,
    let us assume a scenario and try to address all the steps involved with example
    code snippets. The scenario is such that employee data is present across native
    RDDs, JSON files, and on a SQL server. So, let''s see how we can get those to
    Spark DataFrames:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解数据采集和准备阶段，让我们假设一个场景，并尝试通过示例代码片段来解决所有涉及的步骤。场景假设员工数据分布在本地RDD、JSON文件和SQL服务器中。那么，让我们看看如何将这些数据导入到Spark
    DataFrame中：
- en: '**Python**'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE0]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '**Scala**'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE1]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Data preparation
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据准备
- en: Data quality has always been a pervasive problem in the industry. The presence
    of incorrect or inconsistent data can produce misleading results of your analysis.
    Implementing better algorithm or building better models will not help much if
    the data is not cleansed and prepared well, as per the requirement. There is an
    industry jargon called **data engineering** that refers to data sourcing and preparation.
    This is typically done by data scientists and in a few organizations, there is
    a dedicated team for this purpose. However, while preparing data, a scientific
    perspective is often needed to do it right. As an example, you may not just do
    *mean substitution* to treat missing values and look into data distribution to
    find more appropriate values to substitute. Another such example is that you may
    not just look at a box plot or scatter plot to look for outliers, as there could
    be multivariate outliers which are not visible if you plot a single variable.
    There are different approaches, such as **Gaussian Mixture Models** (**GMMs**)
    and **Expectation Maximization** (**EM**) algorithms that use **Mahalanobis distance**
    to look for multivariate outliers.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 数据质量一直是行业中的一个普遍问题。错误或不一致的数据可能会导致分析结果的误导。如果数据没有按照要求进行清理和准备，实施更好的算法或构建更好的模型也无法取得显著效果。有一个行业术语叫做**数据工程**，它指的是数据的来源和准备工作。这通常由数据科学家完成，在一些组织中，会有专门的团队负责这项工作。然而，在准备数据时，通常需要一种科学的视角来确保正确处理。例如，处理缺失值时，你可能不仅仅采用*均值替代*，而是需要查看数据分布，找到更合适的值进行替代。另一个例子是，你可能不仅仅看箱型图或散点图来查找异常值，因为可能存在多变量异常值，这些异常值在单变量图中可能不可见。有不同的方法，比如**高斯混合模型**（**GMMs**）和**期望最大化**（**EM**）算法，使用**马氏距离**来寻找多变量异常值。
- en: The data preparation phase is an extremely important phase, not only for the
    algorithms to work properly, but also for you to develop a better understanding
    of your data so that you can take the right approach while implementing an algorithm.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 数据准备阶段是一个极为重要的阶段，不仅仅是为了让算法正确工作，还能帮助你更好地理解数据，从而在实施算法时采取正确的处理方法。
- en: Once the data has been acquired from different sources, the next step is to
    consolidate them all so that the data as a whole can be cleaned, formatted, and
    transformed to the format needed for your analysis. Please note that you might
    have to take samples of data from the sources, depending on the scenario, and
    then prepare the data for further analysis. Various sampling techniques that can
    be used are discussed later in this chapter.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦从不同的数据源获取到数据，下一步就是将它们整合起来，以便可以对整个数据进行清理、格式化和转换，以适应分析所需的格式。请注意，根据场景的不同，您可能需要从数据源中抽取样本，然后准备数据以进行进一步分析。本章后续将讨论可以使用的各种抽样技术。
- en: Data consolidation
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据整合
- en: 'In this section, we will take a look at how to combine data acquired from various
    data sources:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将了解如何将来自各种数据源的数据结合起来：
- en: '**Python**'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE2]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '**Scala**'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE3]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'After integrating data from those sources, the final dataset (in this case
    it is `final_data`) should be of the following format (just example data):'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在将来自这些数据源的数据整合后，最终的数据集（在本例中为`final_data`）应具有如下格式（示例数据）：
- en: '| **emp_id** | **name** | **age** | **role** | **salary** |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| **emp_id** | **name** | **age** | **role** | **salary** |'
- en: '| 1 | John | 25 | Associate | 10,000 $ |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| 1 | John | 25 | 助理 | 10,000 $ |'
- en: '| 2 | Ray | 35 | Manager | 12,000 $ |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| 2 | Ray | 35 | 经理 | 12,000 $ |'
- en: '| 3 | Mike | 24 | Manager | 12,000 $ |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| 3 | Mike | 24 | 经理 | 12,000 $ |'
- en: '| 4 | Jane | 28 | Associate | null |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| 4 | Jane | 28 | 助理 | null |'
- en: '| 5 | Kevin | 26 | Manager | 12,000 $ |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| 5 | Kevin | 26 | 经理 | 12,000 $ |'
- en: '| 6 | Vincent | 35 | Senior Manager | 22,000 $ |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| 6 | Vincent | 35 | 高级经理 | 22,000 $ |'
- en: '| 7 | James | 38 | Senior Manager | 20,000 $ |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| 7 | James | 38 | 高级经理 | 20,000 $ |'
- en: '| 8 | Shane | 32 | Manager | 12,000 $ |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| 8 | Shane | 32 | 经理 | 12,000 $ |'
- en: '| 9 | Larry | 29 | Manager | 10,000 $ |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| 9 | Larry | 29 | 经理 | 10,000 $ |'
- en: '| 10 | Kimberly | 29 | Associate | 8,000 $ |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| 10 | Kimberly | 29 | 助理 | 8,000 $ |'
- en: '| 11 | Alex | 28 | Manager | 12,000 $ |'
  id: totrans-68
  prefs: []
  type: TYPE_TB
  zh: '| 11 | Alex | 28 | 经理 | 12,000 $ |'
- en: '| 12 | Garry | 25 | Manager | 12.000 $ |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '| 12 | Garry | 25 | 经理 | 12,000 $ |'
- en: '| 13 | Max | 31 | Manager | 12,000 $ |'
  id: totrans-70
  prefs: []
  type: TYPE_TB
  zh: '| 13 | Max | 31 | 经理 | 12,000 $ |'
- en: Data cleansing
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据清洗
- en: Once you have the data consolidated in one place, it is extremely important
    that you spend enough time and effort in cleaning it before analyzing it. This
    is an iterative process because you have to validate the actions you have taken
    on the data and continue till you are satisfied with the data quality. It is advisable
    that you spend time analyzing the causes of anomalies you detect in the data.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦将数据集中到一个地方，非常重要的一点是，在进行分析之前，要花费足够的时间和精力清洗数据。这是一个迭代过程，因为你必须验证你对数据所做的操作，并持续进行直到对数据质量感到满意。建议你花时间分析数据中发现的异常的原因。
- en: Some level of impurity in data usually exists in any dataset. There can be various
    kinds of issues with data, but we are going to address a few common cases, such
    as missing values, duplicate values, transforming, or formatting (adding or removing
    digits from a number, splitting a column into two, merging two columns into one).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 数据中通常存在一定程度的杂质。在任何数据集中都可能存在各种问题，但我们将讨论一些常见的情况，如缺失值、重复值、数据转换或格式化（例如，给数字添加或删除数字，拆分一列成两列，或者将两列合并为一列）。
- en: Missing value treatment
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 缺失值处理
- en: There are various ways of handling missing values. One way is dropping rows
    containing missing values. We may want to drop a row even if a single column has
    missing value, or may have different strategies for different columns. We may
    want to retain the row as long as the total number of missing values in that row
    are under a threshold. Another approach may be to replace nulls with a constant
    value, say the mean value in case of numeric variables.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 处理缺失值的方式有很多种。一个方法是删除包含缺失值的行。即使只有某一列有缺失值，我们也可能希望删除这一行，或者对于不同的列采用不同的策略。我们还可以设定一个阈值，只要该行缺失值的总数低于阈值，就保留该行。另一种方法是用常数值替换空值，例如在数值型变量中使用均值替代。
- en: In this section, we will not be providing some examples in both Scala and Python
    and will try to cover various scenarios to give you a broader perspective.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将提供一些Scala和Python中的示例，并尝试涵盖各种场景，以帮助你从更广泛的角度理解。
- en: '**Python**'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE4]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '**Scala**'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE5]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Outlier treatment
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 异常值处理
- en: 'Understanding what an outlier is also important to treat it well. To put it
    simply, an outlier is a data point that does not share the same characteristics
    as the rest of the data points. Example: if you have a dataset of schoolchildren
    and there are a few age values in the range of 30-40 then they could be outliers.
    Let us look into a different example now: if you have a dataset where a variable
    can have data points only in two ranges, say, in the 10-20 or 80-90 range, then
    the data points (say, 40 or 55) with values in between these two ranges could
    also be outliers. In this example, 40 or 55 do not belong to the 10-20 range,
    nor do they belong to the 80-90 range, and are outliers.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 了解什么是异常值也很重要，这样才能正确处理它。简单来说，异常值是与其余数据点特征不一致的数据点。例如：如果你有一个学生的年龄数据集，而其中有几个年龄值在30-40岁范围内，那么它们可能是异常值。现在让我们看一个不同的例子：如果你有一个数据集，其中某个变量的值只能在两个范围内，如10-20岁或80-90岁，那么介于这两个范围之间的数据点（例如，40或55岁）也可能是异常值。在这个例子中，40或55既不属于10-20岁范围，也不属于80-90岁范围，因此它们是异常值。
- en: Also, there can be univariate outliers and there can be multivariate outliers
    as well. We will focus on univariate outliers in this book for simplicity's sake
    as Spark MLlib may not have all the algorithms needed at the time of writing this
    book.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，数据中可以存在单变量异常值，也可以存在多变量异常值。为了简化起见，本书将重点讨论单变量异常值，因为在本书写作时，Spark MLlib可能没有所有需要的算法。
- en: In order to treat the outliers, you have to first see if there are outliers.
    There are different ways, such as summary statistics and plotting techniques,
    to find the outliers. You can use the built-in library functions such as `matplotlib`
    of Python to visualize your data. You can do so by connecting to Spark through
    a notebook (for example, Jupyter) so that the visuals can be generated, which
    may not be possible on a command shell.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 为了处理异常值，你首先需要判断是否存在异常值。可以通过不同的方式来发现异常值，例如使用汇总统计和绘图技术。你可以使用Python的内置库函数，如`matplotlib`，来可视化数据。通过连接到Spark（例如，通过Jupyter笔记本），你可以生成这些可视化，这在命令行中可能是无法实现的。
- en: 'Once you find outliers, you can either delete the rows containing outliers
    or impute the mean values in place of outliers or do something more relevant,
    as applicable to your case. Let us have a look at the mean substitution method
    here:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦发现异常值，你可以选择删除包含异常值的行，或者用均值替换异常值，或者根据具体情况做出更相关的处理。让我们来看看均值替代方法：
- en: '**Python**'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE6]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '**Scala**'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE7]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Duplicate values treatment
  id: totrans-90
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 处理重复值
- en: 'There are different ways of treating the duplicate records in a dataset. We
    will demonstrate those in the following code snippets:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 处理数据集中重复记录的方式有多种。我们将在以下代码片段中演示这些方法：
- en: '**Python**'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE8]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '**Scala:**'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala:**'
- en: '[PRE9]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Data transformation
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据转换
- en: 'There can be various kinds of data transformation needs and every case is mostly
    unique. We are going to cover some basic types of transformations, as follows:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 数据转换的需求可能有多种，而且每个案例大多是独特的。我们将覆盖以下一些基本的转换类型：
- en: Merging two columns into one
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将两列合并为一列
- en: Adding characters/numbers to the existing ones
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向现有数据添加字符/数字
- en: Deleting or replacing characters/numbers from the existing ones
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除或替换现有字符/数字
- en: Changing date formats
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改日期格式
- en: '**Python**'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE10]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '**Scala:**'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala:**'
- en: '[PRE11]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Now that we are familiar with basic examples, let us put together a somewhat
    complex example. You might have noticed that the date column in Authors data has
    different date formats. In some cases, month is followed by day, and vice versa.
    Such anomalies are common in the real world, wherein data might be collected from
    different sources. Here, we are looking at a case where the date column has data
    points with many different date formats. We need to standardize all the different
    date formats into one format. To do so, we first have to create a **user-defined
    function** (**udf**) that can take care of the different formats and convert those
    to one common format.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了基本的示例，让我们来处理一个稍微复杂一点的例子。你可能已经注意到，作者数据中的日期列有不同的日期格式。在某些情况下，月份在前，日期在后；而在其他情况下则相反。这种异常在现实世界中很常见，因为数据可能来自不同的来源。在这里，我们看到的情况是日期列中有多个不同的日期格式数据点。我们需要将所有不同的日期格式标准化为一个统一的格式。为此，我们首先需要创建一个**用户定义函数**（**udf**），它可以处理不同的格式并将它们转换为统一的格式。
- en: '[PRE12]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '**Scala**'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE13]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: That lines up the date of birth strings neatly. We can keep fine-tuning the
    udf as we encounter more varieties of date formats.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 这会整齐地排列出生日期字符串。当我们遇到更多不同的日期格式时，可以继续调整这个用户定义函数（udf）。
- en: At this stage, before getting started with data analysis, it is extremely important
    that you should pause for a moment and re-evaluate the actions you have taken
    from starting data acquisition to cleaning and transforming it. There have been
    a lot of cases where tremendous time and effort involved went for a toss and led
    to project failure because of incorrect data being analyzed and modeled. Such
    cases became perfect examples of a famous computer adage - **Garbage In, Garbage
    Out** (**GIGO**).
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一阶段，在开始进行数据分析之前，非常重要的一点是你应该暂停片刻，重新评估从数据采集到数据清理和转换过程中所采取的所有步骤。有很多情况下，涉及大量时间和精力的工作最后失败，因为分析和建模的数据是不正确的。这些情况成了著名计算机谚语的完美例证——**垃圾进，垃圾出**（**GIGO**）。
- en: Basics of statistics
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 统计学基础
- en: 'The field of statistics is all about using mathematical procedures to summarize
    the raw facts and figures of a dataset in some meaningful way so that it makes
    sense to you. This includes, and is not limited to: gathering data, analyzing
    it, interpreting it, and representing it.'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 统计学领域主要是通过数学方法将数据集中的原始事实和数字以某种有意义的方式进行总结，使其对你有意义。这包括但不限于：收集数据、分析数据、解释数据和展示数据。
- en: The field of statistics exists mainly because it is usually impossible to collect
    data for the entire population. So using statistical techniques, we estimate the
    population parameters using the sample statistics by addressing the uncertainties.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 统计学的存在主要是因为通常无法收集整个总体的数据。因此，通过使用统计技术，我们利用样本统计量来估计总体参数，并应对不确定性。
- en: In this section, we will cover some basic statistics and analysis techniques
    on which we are going to build up our complete understanding of the concepts covered
    in this book.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将介绍一些基础的统计学和分析技术，在这些基础上，我们将逐步建立对本书中所涵盖概念的全面理解。
- en: 'The study of statistics can be broadly categorized into two main branches:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 统计学的研究可以大致分为两个主要分支：
- en: Descriptive statistics
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述性统计
- en: Inferential statistics
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 推断统计
- en: 'The following diagram depicts these two terms and shows how we estimate the
    population parameters from samples:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表展示了这两个术语，并说明了我们如何从样本中估计总体参数：
- en: '![Basics of statistics](img/image_05_002.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![统计基础](img/image_05_002.jpg)'
- en: Before we get started on these, it is important to get some familiarity with
    sampling and distributions.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，了解抽样和分布是很重要的。
- en: Sampling
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 抽样
- en: 'Through sampling techniques, we just take a portion of the population dataset
    and work on it:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 通过抽样技术，我们只需从总体数据集中取出一部分并进行处理：
- en: '![Sampling](img/image_05_003.jpg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![抽样](img/image_05_003.jpg)'
- en: 'But why do we sample? The following are various reasons for sampling:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 但为什么我们要进行抽样？以下是进行抽样的各种原因：
- en: Difficult to get the entire population's data; for example, the heights of the
    citizens of any country.
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 很难获得整个总体的数据；例如，某个国家公民的身高。
- en: Difficult to process the entire dataset. When we talk about big data computing
    platforms such as Spark, the scope of this challenge nearly disappears. However,
    there can be scenarios where you have to treat the entire data at hand as a sample
    and extrapolate your analysis result to a future time or to a larger population.
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 处理整个数据集是很困难的。当我们谈论大数据计算平台（如Spark）时，这个挑战几乎消失了。然而，也有可能遇到需要将手头的整个数据视为样本，并将分析结果推断到未来时间或更大总体的情况。
- en: Difficult to plot voluminous data to visualize it. There can be technical limitations
    to it.
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 难以绘制大量数据以便可视化。技术上可能存在限制。
- en: For validation of your analysis or validation of your predictive models - especially
    when you are working with small datasets and you have to rely on cross-validation.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了验证你的分析或验证预测模型——特别是在处理小数据集时，你需要依赖交叉验证。
- en: 'For effective sampling, there are two important constraints: one is determining
    the sample size and the other is the technique to choose for sampling. The sample
    size greatly influences the estimation of population parameters. We will cover
    this aspect later in this chapter after covering some of the prerequisite basics.
    In this section, we will focus on sampling techniques.'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 为了有效的抽样，有两个重要的约束：一是确定样本大小，二是选择抽样技术。样本大小对总体参数的估计有很大的影响。我们将在本章后面讨论这一方面，首先会介绍一些先决的基础知识。在这一节中，我们将重点讨论抽样技术。
- en: There are various probability-based (the probability of each sample being selected
    is known) and non-probability-based (the probability of each sample being selected
    is not known) sampling techniques available, but we are going to limit our discussion
    to probability-based techniques only.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 有多种基于概率（每个样本被选择的概率已知）和非概率（每个样本被选择的概率未知）抽样技术可供选择，但我们将仅讨论基于概率的技术。
- en: Simple random sample
  id: totrans-132
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 简单随机抽样
- en: The **simple random sample** (**SRS**) is the most basic type of probability
    sampling method, where every element has the same probability of being chosen.
    This means that every possible sample of *n* elements has an equal chance of selection.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: '**简单随机抽样**（**SRS**）是最基本的概率抽样方法，其中每个元素被选择的概率相同。这意味着每个可能的*n*元素样本都有相等的选择机会。'
- en: Systematic sampling
  id: totrans-134
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 系统抽样
- en: Systematic sampling is probably the simplest of all probability-based sampling
    techniques, where every *kth* element of the population is sampled. So this is
    otherwise known as interval sampling. It starts with a fixed starting point chosen
    at random and then an interval is estimated (the *kth* element, where *k = (population
    size)/(sample size)*). Here, the progression through the elements is circled to
    start from the beginning when it reaches the end till your sample size is reached.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 系统抽样可能是所有基于概率的抽样技术中最简单的一种，在这种方法中，总体的每个*第k*个元素都会被抽取。因此，这也叫做间隔抽样。它从一个随机选择的固定起点开始，然后估算一个间隔（即*第k*个元素，其中*k
    = (总体大小)/(样本大小)*）。这里，元素的选择会循环进行，直到达到样本大小，即从开始重新选择直到结束。
- en: Stratified sampling
  id: totrans-136
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 分层抽样
- en: 'This sampling technique is preferred when the subgroups or subpopulations within
    the population vary, because other sampling techniques might not help extract
    a sample that is a good representative of the population. Through stratified sampling,
    the population is divided into homogeneous subgroups called **strata** and a sample
    is taken by randomly selecting the subjects from those strata in proportion to
    the population. So, the stratum size to population size ratio is maintained in
    the sample as well:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 当种群内的子群体或子群体差异较大时，这种抽样技术是首选，因为其他抽样技术可能无法提取出一个能够良好代表整个种群的样本。通过分层抽样，将种群划分为同质的子群体，称为**层**，并通过按照种群比例从这些层中随机选择样本来进行抽样。因此，样本中的层大小与种群大小的比例保持一致：
- en: '**Python**'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE14]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '**Scala**:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**:'
- en: '[PRE15]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Note
  id: totrans-142
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: We only looked at sampling on DataFrames; there are MLlib library functions
    such as `sampleByKey` and `sampleByKeyExact` to do stratified sampling on RDDs
    of key-value pairs. Check out `spark.util.random` package for Bernoulli , Poisson
    or Random samplers.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 我们只看了DataFrame上的抽样；在MLlib库中也有如`sampleByKey`和`sampleByKeyExact`等函数，可以在键值对的RDD上进行分层抽样。可以查看`spark.util.random`包，了解Bernoulli、Poisson或随机抽样器。
- en: Data distributions
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据分布
- en: Understanding how your data is distributed is one of the primary tasks you need
    to perform to turn data into information. Analyzing the distributions of the variables
    helps detect the outliers, visualize the trends in the data, and can also shape
    up your understanding for the data at hand. This helps in thinking right and taking
    the right approaches in solving a business problem. Plotting the distributions
    makes it visually more intuitive and we will cover this aspect in the *Descriptive
    statistics* section.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 了解数据的分布情况是将数据转化为信息的主要任务之一。分析变量的分布有助于发现异常值、可视化数据的趋势，并且有助于你对数据的理解。这有助于正确思考并采取正确的方式解决业务问题。绘制分布图使得直观性更强，我们将在*描述性统计*部分讨论这一方面。
- en: Frequency distributions
  id: totrans-146
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 频率分布
- en: Frequency distribution explains which values a variable takes and how often
    it takes those values. It is usually represented with a table with each possible
    value with its corresponding number of occurrences.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 频率分布解释了一个变量可以取哪些值，以及它取这些值的频率。通常用一个表格来表示每个可能值及其对应的出现次数。
- en: 'Let''s consider an example where we roll a six-sided die 100 times and observe
    the following frequencies:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们掷一颗六面骰子100次，并观察到以下频率：
- en: '![Frequency distributions](img/Chapter-5_NEw.jpg)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![频率分布](img/Chapter-5_NEw.jpg)'
- en: Frequency Table
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 频率表
- en: Similarly, you might observe different distributions on every set of 100 rolls
    of the die because it would depend on chance.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 同样地，你可能会在每一组100次掷骰子中观察到不同的分布，因为这将取决于运气。
- en: 'At times, you might be interested in the proportions of occurrences instead
    of just occurrences. In the preceding die roll example, we rolled the die 100
    times in total, so the proportionate distribution or the **relative frequency
    distribution** would appear as follows:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，你可能对出现次数的比例感兴趣，而不仅仅是出现的次数。在前面的掷骰子例子中，我们总共掷了100次骰子，因此比例分布或**相对频率分布**将呈现如下：
- en: '![Frequency distributions](img/Final-5-RT-3.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![频率分布](img/Final-5-RT-3.jpg)'
- en: Relative Frequency Table
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 相对频率表
- en: Probability distributions
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 概率分布
- en: 'In the same example of die rolling, we know that a total probability of 1 is
    distributed across all faces of the die. This means that a probability of 1/6
    (approximately 0.167) is associated with face 1 through face 6\. Irrespective
    of the number of times you roll a die (a fair die!), the same probability of 1/6
    would be distributed evenly on all sides of the die. So, if you plot this distribution,
    it would appear as follows:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在同一个掷骰子的例子中，我们知道一个总概率为1的值是分布在骰子的所有面上的。这意味着每一面（从1到6）上都与概率1/6（约为0.167）相关联。无论你掷骰子的次数是多少（假设是公平的骰子！），1/6的概率都会均匀地分布在骰子的所有面上。所以，如果你绘制这个分布图，它将呈现如下：
- en: '![Probability distributions](img/Chapter-new.jpg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![概率分布](img/Chapter-new.jpg)'
- en: Probability Distribution
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 概率分布
- en: We looked at three kinds of distributions here - frequency distributions, relative
    frequency distribution, and probability distribution.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里查看了三种分布——频率分布、相对频率分布和概率分布。
- en: This probability distribution is actually the distribution of the population.
    In real-world cases, at times we have prior knowledge of the population distribution
    (in our example, it is the probability of 0.167 on all six sides of a fair die)
    and at times we don't. In scenarios where we don't have the population distribution,
    finding the distribution of the population itself becomes part of your inferential
    statistics. Also, unlike the fair die example, where the same probability is associated
    with all the sides, there can be different probabilities associated with the values
    a variable can take and they can follow a particular type of distribution as well.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 这个概率分布实际上是总体的分布。在实际情况中，有时我们已经知道总体分布（在我们的例子中，它是公平骰子六个面的概率为0.167），而有时我们不知道。在没有总体分布的情况下，找出总体分布本身就成为推断统计的一部分。而且，与公平骰子的例子不同，所有面上的概率相同，在其他情况下，变量可能的值可以与不同的概率相关联，并且这些值也可以遵循某种特定类型的分布。
- en: Now it's time to reveal the secret! The relation between the relative frequency
    distribution and the probability distribution is the basis of statistical inference.
    The relative frequency distributions are also called empirical distributions based
    on what we observe in the samples we take (here, it is a sample of 100). As discussed
    earlier, the empirical distributions of every 100 rolls of the die would differ
    depending on chance. Now, the larger the number of rolls, the closer will be the
    relative frequency distribution to the probability distribution. So, the relative
    frequencies of an infinite number of die rolls is the probability distribution,
    which in turn is the population distribution.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是揭开秘密的时候了！相对频率分布与概率分布之间的关系是统计推断的基础。相对频率分布也叫做经验分布，它是基于我们在样本中观察到的内容（这里是100次的样本）。如前所述，每100次掷骰子的经验分布会根据机会而有所不同。现在，掷骰子的次数越多，相对频率分布与概率分布的差异就越小。因此，无限次掷骰子的相对频率分布即为概率分布，而概率分布反过来就是总体分布。
- en: There are various kinds of probability distributions, which are again categorized
    into two, based on the type of variable - categorical or continuous. We will cover
    these distributions in detail in the subsequent sections of this chapter. However,
    we should know what these categories imply! Categorical variables can take on
    only a few categories; for example, pass/fail, zero/one, cancer/malignant are
    examples of categorical variables with two categories. Similarly, a categorical
    variable can have more categories, such as red/green/blue, type1/type2/type3/type4,
    and so on. Continuous variables can take on any value in a given range and measured
    on a continuous scale, for example, age, height, salary, and so on. Theoretically,
    there can be an infinite number of possible values between any two values of a
    continuous variable. For example, between 5'6" and 6'4" height values (foot and
    inch scale), there can be many fractional values possible. The same holds true
    when measured in a centimeter scale as well.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 概率分布有多种类型，这些分布根据变量类型（分类变量或连续变量）再次分类。我们将在本章的后续部分详细讨论这些分布。不过，我们应该了解这些分类所代表的含义！分类变量只能取几个类别。例如，及格/不及格、零/一、癌症/恶性是具有两个类别的分类变量的例子。同样，分类变量也可以有更多的类别，比如红/绿/蓝、类型1/类型2/类型3/类型4，等等。连续变量可以在给定的范围内取任意值，并且是以连续的尺度进行度量的，例如年龄、身高、工资等。理论上，在连续变量的任意两个值之间可以有无限多个可能值。例如，在身高范围5'6"到6'4"（英尺和英寸尺度）之间，可能有许多分数值。同样，在厘米尺度下也是如此。
- en: Descriptive statistics
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 描述性统计
- en: In the previous section, we learnt how distributions are formed. In this section,
    we will learn how to describe them through descriptive statistics. There are two
    important components of a distribution that can help describe it, which are its
    location and its spread.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一节中，我们学习了分布是如何形成的。在本节中，我们将学习如何通过描述性统计来描述这些分布。描述分布的两个重要组成部分是其位置和分布的扩展。
- en: Measures of location
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 位置度量
- en: A measure of location is a single value that describes where the center of the
    data lies. The three most common measures of location are mean, median, and mode.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 位置度量是一个描述数据中心位置的单一值。三种最常见的定位度量是均值、中位数和众数。
- en: Mean
  id: totrans-167
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 均值
- en: By far the most common and widely used measure of central tendency is the **mean**,
    which is otherwise known as the average. Whether it is a sample or a population,
    the mean or average is the summation of all the elements divided by the total
    number of elements.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，最常见且广泛使用的集中趋势度量是**均值**，也称为平均数。无论是样本还是总体，均值或平均数是所有元素的总和除以元素的总数。
- en: Median
  id: totrans-169
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 中位数
- en: The **median** is the middle value of a series of data when sorted in any order
    so that half of the data is greater than the median and the other half smaller.
    When there are two middle values (with an even number of data items), the median
    is the average of those middle two. Medians are better measures of location when
    the data has outliers (extreme values).
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '**中位数**是当数据按任意顺序排序时位于中间的数值，使得一半数据大于中位数，另一半小于中位数。当有两个中位数值（数据项数目为偶数）时，中位数是这两个中间值的平均值。中位数是处理数据集中的异常值（极端值）时更好的位置度量。'
- en: Mode
  id: totrans-171
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 众数
- en: The **mode** is the most frequent data item. It can be determined for both qualitative
    and quantitative data.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '**众数**是出现频率最高的数据项。它可以用于定性数据和定量数据的确定。'
- en: '**Python**'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: //Reusing data_new created in duplicated value treatment
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: //重用在重复值处理中创建的data_new
- en: '[PRE16]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '**Scala**'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE17]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Measures of spread
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 离散度度量
- en: Measures of spread describe how close or scattered the data is for a particular
    variable or data item.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 离散度度量描述了某一特定变量或数据项的数据的集中程度或分散程度。
- en: Range
  id: totrans-180
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 范围
- en: The range is the difference between the smallest and largest values of a variable.
    One disadvantage to it is that it does not take into account every value in the
    data.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 范围是变量最小值和最大值之间的差异。它的一个缺点是没有考虑到数据中的每一个值。
- en: Variance
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 方差
- en: 'To find the variability in the dataset, we can subtract each value from the
    mean, square them up so it gets rid of the negative signs (also scales up the
    magnitude), and then sum them all and divide by the total number of values:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 为了找出数据集中的变异性，我们可以将每个值与均值相减，平方它们以去除负号（同时放大数值），然后将所有结果相加，并除以总的值个数：
- en: '![Variance](img/image_05_007.jpg)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![方差](img/image_05_007.jpg)'
- en: If the data is more spread out, the variance will be a large number. One disadvantage
    to it is that it gives undue weight to the outliers.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 如果数据分布较广，方差会是一个较大的数字。它的一个缺点是对异常值赋予了过多的权重。
- en: Standard deviation
  id: totrans-186
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 标准差
- en: 'Like variance, standard deviation is also a measure of dispersion within the
    data. Variance had the limitation that the unit of data was also squared along
    with the data, so it was difficult to relate the variance with the values in the
    dataset. So, standard deviation is calculated as the square root of the variance:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 与方差类似，标准差也是衡量数据离散程度的指标。方差的一个局限性是数据的单位也被平方，因此很难将方差与数据集中的数值相关联。因此，标准差是通过方差的平方根计算出来的：
- en: '![Standard deviation](img/image_05_008.jpg)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![标准差](img/image_05_008.jpg)'
- en: '**Python**'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE18]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '**Scala**'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE19]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Summary statistics
  id: totrans-193
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 汇总统计
- en: 'The summary statistics of a dataset is extremely useful information that gives
    us a quick insight into the data at hand. Using the function `colStats` available
    in statistics, we can obtain a multivariate statistical summary of `RDD[Vector]`
    which contains column-wise max, min, mean, variance, number of non-zeros, and
    the total count. Let us explore this through some code examples:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集的汇总统计信息是非常有用的信息，可以帮助我们快速了解当前的数据。通过使用统计学中提供的`colStats`函数，我们可以获得`RDD[Vector]`的多变量统计汇总，其中包含按列计算的最大值、最小值、均值、方差、非零值的数量和总计数。让我们通过一些代码示例来探索这个：
- en: '**Python**'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE20]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '**Scala**'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE21]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Tip
  id: totrans-199
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Apache Spark MLlib RDD-based API is in maintenance mode starting Spark 2.0\.
    They are expected to deprecated in 2.2+ and removed in Spark 3.0.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: Apache Spark MLlib 基于 RDD 的 API 从 Spark 2.0 开始进入维护模式。预计在 2.2+ 中将被弃用，并在 Spark
    3.0 中移除。
- en: Graphical techniques
  id: totrans-201
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 图形化技术
- en: To understand the behavior of your data points, you may have to plot them and
    see. You need a platform, however, to visualize your data in terms of *box plots*,
    *scatter plots*, or *histograms*, to name a few. The iPython/Jupyter notebook
    or any other third-party notebook supported by Spark can be used for data visualization
    in your browser itself. Databricks provides their own notebook. Visualization
    is covered in its own chapter and this chapter focuses on the complete life cycle.
    However, Spark provides histogram data preparation out of the box so that bucket
    ranges and frequencies may be transferred to the client machine as against the
    complete dataset. The following example shows the same.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解数据点的行为，您可能需要绘制它们并查看。但是，您需要一个平台来将您的数据可视化，例如*箱线图*、*散点图*或*直方图*等。 iPython/Jupyter
    笔记本或任何由 Spark 支持的第三方笔记本都可以在浏览器中用于数据可视化。 Databricks 提供他们自己的笔记本。可视化在自己的章节中进行讨论，本章专注于完整的生命周期。但是，Spark提供了直方图数据准备，使得桶范围和频率可以与客户端机器传输，而不是完整数据集。以下示例显示了相同。
- en: '**Python**'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE22]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '**Scala:**'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala:**'
- en: '[PRE23]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Inferential statistics
  id: totrans-207
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 推断统计学
- en: 'We saw that descriptive statistics were extremely useful in describing and
    presenting data, but they did not provide a way to use the sample statistics to
    infer the population parameters or to validate any hypothesis we might have made.
    So, the techniques of inferential statistics surfaced to address such requirements.
    Some of the important uses of inferential statistics are:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到描述统计学在描述和展示数据方面非常有用，但它们并没有提供一种使用样本统计量来推断总体参数或验证我们可能提出的任何假设的方法。因此，推断统计学的技术出现以满足这些需求。推断统计学的一些重要用途包括：
- en: Estimation of population parameters
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 估计总体参数
- en: Hypothesis testing
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 假设检验
- en: Please note that a sample can never represent a population perfectly because
    every time we sample, it naturally incurs sampling errors, hence the need for
    inferential statistics! Let us spend some time understanding the various types
    of probability distributions that can help infer the population parameters.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，样本永远无法完美地代表总体，因为每次抽样都会自然产生抽样误差，因此需要推断统计学！让我们花些时间了解可以帮助推断总体参数的各种概率分布类型。
- en: Discrete probability distributions
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 离散概率分布
- en: Discrete probability distributions are used to model data that is discrete in
    nature, which means that data can only take on certain values, such as integers.
    Unlike categorical variables, discrete variables can take on only numeric data,
    especially count data from a set of distinct whole values. Also, the sum of probabilities
    of all possible values of a random variable is one. The discrete probability distributions
    are described in terms of probability mass function. There can be various types
    of discrete probability distributions. The following are a few examples.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 离散概率分布用于建模本质上是离散的数据，这意味着数据只能取特定的值，如整数。与分类变量不同，离散变量可以仅取数值数据，特别是一组不同整数值的计数数据。此外，随机变量所有可能值的概率之和为一。离散概率分布以概率质量函数描述。可以有各种类型的离散概率分布。以下是一些示例。
- en: Bernoulli distribution
  id: totrans-214
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 伯努利分布
- en: Bernoulli distribution is a type of distribution that describes the trials having
    only two possible outcomes, such as success/failure, head/tail, the face value
    of a six-sided die is 4 or not, the message sent was received or not, and so on.
    Bernoulli distribution can be generalized for any categorical variable with two
    or more possible outcomes.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 伯努利分布是一种描述只有两种可能结果的试验的分布，例如成功/失败，正面/反面，六面骰子的面值为4或不为4，发送的消息是否被接收等。伯努利分布可以推广为任何具有两个或更多可能结果的分类变量。
- en: 'Let''s take the example of "students'' pass rate for an exam" where 0.6 (60
    percent) is the probability **P** of the students passing the exam and 0.4 (40
    percent) is the probability (**1-P**) for the students to fail in the exam. Let
    us denote fail as **0** and pass as **1**:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们以“学生通过考试的概率”为例，其中0.6（60%）是学生通过考试的概率**P**，而0.4（40%）是学生未能通过考试的概率（**1-P**）。让我们将失败表示为**0**，通过表示为**1**：
- en: '![Bernoulli distribution](img/image_05_011.jpg)'
  id: totrans-217
  prefs: []
  type: TYPE_IMG
  zh: '![伯努利分布](img/image_05_011.jpg)'
- en: Such distributions cannot answer questions such as the expected pass rate of
    a student, because the expected value (μ) is going to be some fraction that this
    distribution cannot take. It can only mean that if you sample 1,000 students,
    then 600 would pass and 400 would fail.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 这样的分布无法回答诸如学生的预期通过率的问题，因为预期值（μ）将是一个分数，而该分布不能取这个值。它只能意味着，如果你对1000名学生进行抽样，那么600名会通过，400名会失败。
- en: Binomial distribution
  id: totrans-219
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 二项分布
- en: This distribution can describe a series of Bernoulli trials (each with only
    two possible outcomes). Also, it assumes that the outcome of one trial does not
    affect the subsequent trials and that the probability of any event occurring is
    the same on every trial. An example of binomial distribution is tossing a coin
    five times. Here, the outcome of the first toss does not influence the outcome
    of the second toss, and the probability associated with each outcome is the same
    on all tosses.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 该分布可以描述一系列伯努利试验（每个试验只有两种可能结果）。此外，它假设一个试验的结果不会影响后续的试验，并且每次试验中事件发生的概率是相同的。一个二项分布的例子是抛掷硬币五次。在这里，第一个投掷的结果不会影响第二次投掷的结果，每次投掷的概率是相同的。
- en: 'If *n* is the number of trials and *p* is the probability of success in every
    trial, then the mean (μ) of this binomial distribution would be given by:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 如果*n*是试验次数，*p*是每次试验中成功的概率，那么该二项分布的均值（μ）可以表示为：
- en: '*μ = n * p*'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: '*μ = n * p*'
- en: 'The variance (σ2x) would be given by:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 方差（σ2x）可以表示为：
- en: '*σ2x = n*p*(1-p).*'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '*σ2x = n*p*(1-p)。*'
- en: 'In general, a random variable *X* that follows binomial distribution with parameters
    *n* and *p*, we can write as *X ~ B(n, p)*. For such a distribution, the probability
    of getting exactly *k* successes in *n* trials can be described by the probability
    mass function as follows:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，遵循二项分布的随机变量*X*，其参数为*n*和*p*，可以表示为*X ~ B(n, p)*。对于这样的分布，获得在*n*次试验中恰好* k *次成功的概率可以通过概率质量函数来描述，如下所示：
- en: '![Binomial distribution](img/image_05_012.jpg)![Binomial distribution](img/image_05_013.jpg)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![Binomial distribution](img/image_05_012.jpg)![Binomial distribution](img/image_05_013.jpg)'
- en: here, k = 0, 1, 2, ..., n
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，k = 0, 1, 2, ..., n
- en: Sample problem
  id: totrans-228
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例问题
- en: 'Let us assume a hypothetical scenario. Suppose 24 percent of companies in a
    city announced they would provide support to the tsunami-affected areas of the
    country as part of their CSR activity. In a sample of 20 companies chosen at random,
    find the probability of the number of companies that have announced they will
    help tsunami-affected areas:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 假设一个假设场景。假设某城市的24%公司宣布将向受到海啸影响的地区提供支持，作为其社会责任活动的一部分。在一个随机选择的20家公司样本中，求出有多少公司宣布将帮助海啸受灾地区的概率：
- en: Exactly three
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恰好三次
- en: Less than three
  id: totrans-231
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 少于三次
- en: Three or more
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 三次或更多
- en: '**Solution**:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: '**解答**：'
- en: The sample size = *n* = 20.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 样本大小 = *n* = 20。
- en: The probability that a company chosen at random has announced it will help =
    *P = 0.24*.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 随机选择的公司宣布将提供帮助的概率 = *P = 0.24*。
- en: a) P(x = 3) = ^(20)C[3] (0.24)³ (0.76) ^(17) = 0.15
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: a) P(x = 3) = ^(20)C[3] (0.24)³ (0.76) ^(17) = 0.15
- en: b) P(x < 3) = P(0) + P(1) + P(2)
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: b) P(x < 3) = P(0) + P(1) + P(2)
- en: = (0.76) ^(20) + ^(20)C[1] (0.24) (0.76)^(19) + ^(20)C[2] (0.24)² (0.76)^(18)
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: = (0.76) ^(20) + ^(20)C[1] (0.24) (0.76)^(19) + ^(20)C[2] (0.24)² (0.76)^(18)
- en: = 0.0041 + 0.0261 + 0.0783 = 0.11
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: = 0.0041 + 0.0261 + 0.0783 = 0.11
- en: c) P(x >= 3) = 1 - P(x <= 2) = 1- 0.11 = 0.89
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: c) P(x >= 3) = 1 - P(x <= 2) = 1 - 0.11 = 0.89
- en: Note that binomial distribution is widely used in scenarios where you want to
    model the success rate in a sample of size *n* drawn from a population of size
    *N*, with replacement. If it is done without replacement then the draws will no
    longer be independent and hence will not follow binomial distribution rightly.
    However, such scenarios do exist and can be modeled using different types of distributions,
    such as hypergeometric distributions.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，二项分布广泛应用于你想要模拟从一个规模为*N*的总体中抽取大小为*n*的样本成功率的场景，且在抽样过程中允许重复。如果没有替换，那么抽样将不再独立，因此不能正确遵循二项分布。然而，确实存在这样的场景，可以通过不同类型的分布进行建模，如超几何分布。
- en: Poisson distribution
  id: totrans-242
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 泊松分布
- en: Poisson distribution can describe the probability of a given number of independent
    events that occur with a known average rate in a fixed interval of time or space.
    Please note that the events should only have binary outcomes such as success or
    failure, for example, the number of phone calls you receive per day or the number
    of cars passing a signal per hour. You need to carefully take a closer look at
    these examples. Please note here that you do not have the opposite half of this
    information, that is, how many phone calls you did not receive per day or how
    many cars did not pass that signal. Such data points do not have the other half
    of the information. On the contrary, if I say that 30 out of 50 students passed
    in an exam, you can easily infer that 20 students have failed! You have this other
    half of the information.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 泊松分布可以描述在固定时间或空间区间内，以已知平均速率发生的一定数量的独立事件的概率。请注意，事件应该只有二元结果，例如：你每天接到的电话次数，或者每小时通过某个信号的汽车数量。你需要仔细观察这些例子。请注意，这里没有提供信息的另一半，比如：你每天没有接到多少个电话，或者每小时没有通过多少辆车。这样的数据点没有另一半的信息。相反，如果我说50个学生中有30个通过了考试，你可以很容易地推断出有20个学生没有通过！你有了这另一半的信息。
- en: 'If *µ* is the mean number of events occurring (a known average rate in a fixed
    interval of time or space) then the probability of *k* events occurring at the
    same interval can be described by the probability mass function:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 如果*µ*是发生事件的平均次数（在固定时间或空间区间内的已知平均速率），那么在同一时间区间内发生*k*次事件的概率可以通过概率质量函数来描述：
- en: '![Poisson distribution](img/image_05_014.jpg)'
  id: totrans-245
  prefs: []
  type: TYPE_IMG
  zh: '![泊松分布](img/image_05_014.jpg)'
- en: here, *k* = 0, 1, 2, 3...
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 其中， *k* = 0, 1, 2, 3...
- en: The preceding equation describes the Poisson distribution.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的公式描述了泊松分布。
- en: For a Poisson distribution, mean and variance are the same. Also, the Poisson
    distribution tends to be more symmetric as its mean or variance increases.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 对于泊松分布，均值和方差是相同的。同时，随着均值或方差的增加，泊松分布趋向于更加对称。
- en: Sample problem
  id: totrans-249
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例问题
- en: 'Suppose you knew that the mean number of calls to a fire station on a weekday
    is eight. What is the probability that on a given weekday there would be 11 calls?
    This problem can be solved using the following formula based on the Poisson distribution:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你知道在一个工作日，消防站接到的电话平均次数是八次。那么，在某个工作日接到11个电话的概率是多少呢？这个问题可以通过以下基于泊松分布的公式来解决：
- en: '![Sample problem](img/image_05_015.jpg)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![示例问题](img/image_05_015.jpg)'
- en: Continuous probability distributions
  id: totrans-252
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 连续概率分布
- en: 'Continuous probability distributions are used to model data that is continuous
    in nature, which means that data can only take on any value within a specified
    range. So we deal with probabilities associated with intervals and not with any
    particular value as it is zero. Continuous probability distributions are the theoretical
    models of experiments; it is a relative frequency distribution built from an infinite
    number of observations. This means that when you reduce the interval, the number
    of observations increases, and as the number of observations increases more and
    more and approaches infinity, it forms a continuous probability distribution.
    The total area under the curve is one and to find the probability associated with
    any particular range, we have to find the area under the curve. Therefore, continuous
    distributions are normally described in terms of **probability density function**
    (**PDF**) which is of the following type:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 连续概率分布用于对连续性质的数据进行建模，这意味着数据只能取特定范围内的任何值。因此，我们处理的是与区间相关的概率，而不是与某个特定值相关的概率，因为它的概率为零。连续概率分布是实验的理论模型；它是通过无限次观测建立的相对频率分布。这意味着当你缩小区间时，观测次数会增加，而随着观测次数越来越多并接近无穷大时，它就形成了一个连续概率分布。曲线下的总面积为1，若要找到与某个特定范围相关的概率，我们必须找到曲线下的面积。因此，连续分布通常通过**概率密度函数**（**PDF**）来描述，其形式如下：
- en: P(a ≤ X ≤ b) = a∫^b f(x) dx
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: P(a ≤ X ≤ b) = a∫^b f(x) dx
- en: There can be various types of continuous probability distributions. The following
    sections are a few examples.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 连续概率分布有多种类型。以下章节展示了几个例子。
- en: Normal distribution
  id: totrans-256
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 正态分布
- en: A normal distribution is a simple, straightforward, yet very important continuous
    probability distribution. It is otherwise known as a Gaussian distribution or
    **bell curve** because of its appearance when plotted. Also, for a perfect normal
    distribution, the mean, median, and mode are all the same.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 正态分布是一种简单、直观，但非常重要的连续概率分布。因其绘制时的外观而被称为高斯分布或**钟形曲线**。此外，对于完美的正态分布，均值、中位数和众数都是相同的。
- en: Many naturally occurring phenomena follow a normal distribution (they may follow
    a different distribution as well!), such as the heights of people, errors in measurement,
    and so on. However, normal distributions are not suitable to model variables that
    are highly skewed or are inherently positive (for example, share prices or students'
    test scores where the difficulty level was minimal). Such variables may be better
    described by different distributions or by the normal distribution after a data
    transformation (like logarithmic transformation).
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 许多自然现象遵循正态分布（它们也可能遵循不同的分布！），例如人的身高、测量误差等。但是，正态分布不适合模拟高度倾斜或固有为正值的变量（例如股票价格或学生的测试成绩，其中难度水平很低）。这些变量可能更适合用不同的分布描述，或者在数据转换（如对数转换）后再用正态分布描述。
- en: 'Normal distributions can be described using two descriptors: mean for the location
    of the center and standard deviation for the spread (height and width). The probability
    density function that represents a normal distribution is as follows:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 正态分布可以用两个描述符来描述：均值代表中心位置，标准差代表扩展（高度和宽度）。表示正态分布的概率密度函数如下：
- en: '![Normal distribution](img/image_05_016.jpg)'
  id: totrans-260
  prefs: []
  type: TYPE_IMG
  zh: '![正态分布](img/image_05_016.jpg)'
- en: One of the reasons this normal distribution tops the chart for popularity is
    because of the **Central Limit Theorem** (**CLT**). It states that, regardless
    of the population distribution, the mean of samples independently drawn from same
    population distribution is distributed almost normally and this normality increases
    more and more with the increase in sample size. This behavior is actually the
    basis of statistical hypothesis testing.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 正态分布之所以在流行度榜首，其中一个原因是**中心极限定理**（**CLT**）。它指出，无论是什么种群分布，从同一种群分布独立抽取的样本的均值几乎服从正态分布，这种正态性随着样本量的增加而增强。这种行为实际上是统计假设检验的基础。
- en: Additionally, every normal distribution, irrespective of its mean and standard
    deviation, follows an empirical rule (68-95-99.7 rule) which states that about
    68 percent of the area under the curve falls within one standard deviation of
    the mean, 95 percent of the area under the curve falls within two standard deviations
    of the mean, and around 99.7 percent of the area under the curve falls within
    three standard deviations of the mean.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，每个正态分布，无论其均值和标准差如何，都遵循经验法则（68-95-99.7法则），即约68%的面积位于均值的一个标准差内，约95%的面积位于均值的两个标准差内，约99.7%的面积位于均值的三个标准差内。
- en: Now, to find the probability of an event, you can either use integral calculus
    or transform the distribution into a standard normal distribution as explained
    in the next section.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，为了找到事件的概率，您可以使用积分微积分，或者按照下一节中的说明将分布转换为标准正态分布。
- en: Standard normal distribution
  id: totrans-264
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 标准正态分布
- en: A standard normal distribution is a type of normal distribution with mean *0*
    and standard deviation *1*. Such a distribution is rarely found naturally. It
    is designed mainly to find the area under the curve of a normal distribution (instead
    of integrating using calculus) or to normalize the data points.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 标准正态分布是一种均值为*0*，标准差为*1*的正态分布类型。这种分布在自然界中很少见。它主要设计用于找出正态分布曲线下的面积（而不是使用微积分积分）或者标准化数据点。
- en: 'Suppose a random variable *X* is normally distributed with mean (*μ*) and standard
    deviation (*σ*), then the random variable *Z* will have a standard normal distribution
    with mean *0* and standard deviation *1*. The value of *Z* can be found as:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 假设随机变量*X*服从均值（*μ*）和标准差（*σ*）的正态分布，则随机变量*Z*将服从均值*0*和标准差*1*的标准正态分布。可以通过以下方式找到*Z*的值：
- en: '![Standard normal distribution](img/image_05_017.jpg)'
  id: totrans-267
  prefs: []
  type: TYPE_IMG
  zh: '![标准正态分布](img/image_05_017.jpg)'
- en: Since data can be standardized in this manner, the data points can be represented
    and interpreted as *how many standard deviations away from the mean* they lie
    in the distribution. It helps in comparing two distributions with different scales.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 由于数据可以通过这种方式标准化，因此数据点可以表示为*离均值有多少个标准差*，并可以在分布中进行解读。这有助于比较两个具有不同尺度的分布。
- en: You can find the applications of a normal distribution in scenarios where one
    wants to find what percent would fall under a specified range - assuming that
    the distribution is approximately normal.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在那些想要找到落入特定范围的百分比的场景中使用正态分布——前提是分布大致正态。
- en: 'Consider the following example:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑以下示例：
- en: If the time a shopkeeper operates the shop on a given day follows the normal
    distribution with *μ* = *8* hours and *σ* = *0.5* hours, what is the probability
    that he stays at the shop for less than 7.5 hours?
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 如果商店老板在某一天经营商店的时间遵循正态分布，且*μ* = *8*小时，*σ* = *0.5*小时，那么他在商店待少于7.5小时的概率是多少？
- en: 'The probability distribution would look as follows:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 概率分布将如下所示：
- en: '![Standard normal distribution](img/image_05_018.jpg)'
  id: totrans-273
  prefs: []
  type: TYPE_IMG
  zh: '![标准正态分布](img/image_05_018.jpg)'
- en: Data distribution
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 数据分布
- en: '![Standard normal distribution](img/Capture.jpg)![Standard normal distribution](img/image_05_020.jpg)'
  id: totrans-275
  prefs: []
  type: TYPE_IMG
  zh: '![标准正态分布](img/Capture.jpg)![标准正态分布](img/image_05_020.jpg)'
- en: Standard normal distribution
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 标准正态分布
- en: 'So the probability that the shopkeeper stays at the shop for less than 7.5
    hours is given by:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，商店老板待在商店少于7.5小时的概率由以下公式给出：
- en: '*P(z = -1) = 0.1587 = 15.87*'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: '*P(z = -1) = 0.1587 = 15.87*'
- en: Note
  id: totrans-279
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: This was figured out using the Z-table.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 这是通过Z表计算出来的。
- en: 'Please note that normality in a dataset is mostly an approximation. You first
    need to check the normality of the data and then proceed further if your analysis
    is based on the assumption of normality in data. There are various different ways
    to check for normality: you can opt for techniques such as histogram (with a curve
    fitted with the mean and standard deviation of the data), normal probability plot,
    or QQ plot.'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，数据集的正态性通常是一个近似值。你首先需要检查数据的正态性，如果你的分析假设数据为正态分布，则可以继续进行。检查正态性的方法有很多种：你可以选择直方图（并且拟合一条与数据均值和标准差相符的曲线）、正态概率图或QQ图等技术。
- en: Chi-square distribution
  id: totrans-282
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 卡方分布
- en: 'Chi-square distribution is one of the most widely used distributions in statistical
    inference. It is a special case of gamma distribution, which is useful in modeling
    skewed distributions of the variables that are not negative. It states that, if
    a random variable *X* is normally distributed and *Z* is one of its standard normal
    variables, then *Z[2]* will have a X[²] distribution with one degree of freedom.
    Similarly, if we take many such random independent standard normal variables from
    the same distribution, square them and add them up, then that will also follow
    X[²] distribution as follows:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方分布是统计推断中最广泛使用的分布之一。它是伽玛分布的一个特例，适用于建模非负变量的偏斜分布。它表示，如果随机变量*X*是正态分布的，且*Z*是其标准正态变量之一，那么*Z[2]*将具有*X[²]*分布，且自由度为1。类似地，如果我们从相同分布中抽取多个这样的独立标准正态变量，将它们平方并相加，那么它们也将遵循*X[²]*分布，如下所示：
- en: '*Z[12] + Z[22] + ... + Z[k2]* will have X[2] distribution with *k* degrees
    of freedom.'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: '*Z[12] + Z[22] + ... + Z[k2]*将具有*X[2]*分布，且自由度为*k*。'
- en: Chi-square distribution is mainly used for the inference of population variance
    or population standard deviation given the sample variance or standard deviation.
    This is because X[2] distribution is defined in an alternative way, in terms of
    the ratio of sample variance to population variance.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方分布主要用于基于样本方差或标准差推断总体方差或总体标准差。这是因为*X[2]*分布是通过另一种方式定义的，涉及样本方差与总体方差的比率。
- en: To justify this point, let us take a random sample (*x[1]*, *x[2]*,...,*xn*)
    from a normal distribution with variance ![Chi-square distribution](img/Ch.jpg)
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 为了证明这一点，让我们从一个正态分布中随机抽取样本（*x[1]*, *x[2]*,...,*xn*），其方差为![卡方分布](img/Ch.jpg)
- en: 'The sample mean would be given by:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 样本均值由以下公式给出：
- en: '![Chi-square distribution](img/image_05_021.jpg)'
  id: totrans-288
  prefs: []
  type: TYPE_IMG
  zh: '![卡方分布](img/image_05_021.jpg)'
- en: 'However, the sample variance is given by:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，样本方差由以下公式给出：
- en: '![Chi-square distribution](img/image_05_022.jpg)'
  id: totrans-290
  prefs: []
  type: TYPE_IMG
  zh: '![卡方分布](img/image_05_022.jpg)'
- en: 'Considering the preceding mentioned facts, we can define the chi-square statistic
    as follows:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到上述事实，我们可以将卡方统计量定义如下：
- en: '![Chi-square distribution](img/image_05_023.jpg)'
  id: totrans-292
  prefs: []
  type: TYPE_IMG
  zh: '![卡方分布](img/image_05_023.jpg)'
- en: (Remember ![Chi-square distribution](img/image_05_024.jpg) and *Z[2]* will have
    X[2] distribution.)
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: （记住![卡方分布](img/image_05_024.jpg) 和 *Z[2]* 将会有 X[2] 分布。）
- en: So , ![Chi-square distribution](img/image_05_025.jpg)
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，![卡方分布](img/image_05_025.jpg)
- en: Therefore, the sampling distribution of the chi-square statistic will follow
    a chi-square distribution with *(n-1)* degrees of freedom.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，卡方统计量的抽样分布将遵循自由度为*(n-1)*的卡方分布。
- en: 'The probability density function of a chi-square distribution with *n* degrees
    of freedom and gamma function *Г* is given by:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 具有*n*自由度和伽马函数*Г*的卡方分布的概率密度函数如下：
- en: '![Chi-square distribution](img/image_05_026.jpg)'
  id: totrans-297
  prefs: []
  type: TYPE_IMG
  zh: '![卡方分布](img/image_05_026.jpg)'
- en: For a *χ2* distribution with *k* degrees of freedom, mean (*µ*) = *k* and variance
    (*σ2*) = *2k.*
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 对于具有*k*自由度的*χ2*分布，均值（*µ*）= *k*，方差（*σ2*）= *2k*。
- en: Please note that chi-square distributions are positively skewed, but the degree
    of skewness decreases with the increase in the degree of freedom and approaches
    a normal distribution.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，卡方分布是正偏的，但随着自由度增加，偏度减小，并接近正态分布。
- en: Sample problem
  id: totrans-300
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 示例问题
- en: Find the 90 percent confidence interval for the variance and standard deviation
    for the price in dollars for adult single movie tickets. The data given represents
    a selected sample of nationwide movie theaters. Assume the variable is normally
    distributed.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 找到成人单人电影票价格的方差和标准差的90%置信区间。所给数据代表全国电影院的选定样本。假设变量呈正态分布。
- en: 'Given sample (in $): 10, 08, 07, 11, 12, 06, 05, 09, 15, 12'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 给定样本（以$计算）：10, 08, 07, 11, 12, 06, 05, 09, 15, 12
- en: 'Solution:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: '*N* = *10*'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: '*N* = *10*'
- en: 'Mean of sample:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 样本均值：
- en: '![Sample problem](img/Mean-of-sample.jpg)'
  id: totrans-306
  prefs: []
  type: TYPE_IMG
  zh: '![示例问题](img/Mean-of-sample.jpg)'
- en: 'Variance of sample:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 样本的方差：
- en: '![Sample problem](img/Variance.jpg)'
  id: totrans-308
  prefs: []
  type: TYPE_IMG
  zh: '![示例问题](img/Variance.jpg)'
- en: 'Standard deviation of sample:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 样本的标准差：
- en: S = sqrt(9.61)
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: S = sqrt(9.61)
- en: 'Degree of freedom:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 自由度：
- en: 10-1 = 9
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 10-1 = 9
- en: Now we need to find the 90 percent confidence interval, which means that 10
    percent of the data will be left over in the tails.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要找到90%的置信区间，这意味着数据的10%将留在尾部。
- en: '![Sample problem](img/image_05_027.jpg)'
  id: totrans-314
  prefs: []
  type: TYPE_IMG
  zh: '![示例问题](img/image_05_027.jpg)'
- en: 'Now, let us use the formula:'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们使用公式：
- en: '![Sample problem](img/image_05_028.jpg)![Sample problem](img/image_05_029.jpg)'
  id: totrans-316
  prefs: []
  type: TYPE_IMG
  zh: '![示例问题](img/image_05_028.jpg)![示例问题](img/image_05_029.jpg)'
- en: Then we can either find the chi-square value using a table or a computer program.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们可以使用表格或计算机程序找到卡方值。
- en: To find the middle 90 percent confidence interval, we can consider the left
    95 percent and right 5 percent.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 要找到中间90%的置信区间，我们可以考虑左边95%和右边5%。
- en: 'So after substituting the numbers, we get:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，代入数字后，我们得到：
- en: '![Sample problem](img/image_05_030.jpg)![Sample problem](img/image_05_031.jpg)![Sample
    problem](img/image_05_032.jpg)'
  id: totrans-320
  prefs: []
  type: TYPE_IMG
  zh: '![示例问题](img/image_05_030.jpg)![示例问题](img/image_05_031.jpg)![示例问题](img/image_05_032.jpg)'
- en: So, we can conclude that we are 90 percent confident that the standard deviation
    for the price of a single movie ticket of the population (all tickets in the nation)
    is between $2.26 and $5.10 based on a sample of 10 nationwide movie ticket prices.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以得出结论，基于全国10家电影票价格样本，我们对整个国家的电影票价格标准差有90%的信心区间在$2.26和$5.10之间。
- en: Student's t-distribution
  id: totrans-322
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 学生t分布
- en: Student's t-distribution is used in estimating the mean of a normally distributed
    population in the case where the population standard deviation is not known or
    the sample size is too small. In such cases, both *μ* and *σ* are unknown and
    population parameters are estimated only through the sample.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 学生t分布用于估算正态分布总体的均值，当总体标准差未知或样本量过小时。在这种情况下，只能通过样本估算总体参数*μ*和*σ*。
- en: This distribution is bell-shaped and symmetric like normal distribution, but
    has heavier tails. The t-distribution becomes a normal distribution when the sample
    size is large.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 这个分布呈钟形，对称，类似正态分布，但尾部更重。当样本量大时，t分布趋于正态分布。
- en: Let us take a random sample (*x1*, *x2*,...,*xn*) from a normal distribution
    with mean *μ* and variance *σ2*.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从均值为*μ*和方差为*σ2*的正态分布中随机抽取样本(*x1*, *x2*,...,*xn*)。
- en: The sample mean would be ![Student's t-distribution](img/image_05_033.jpg) and
    sample variance ![Student's t-distribution](img/image_05_034.jpg)
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 样本均值为 ![学生t分布](img/image_05_033.jpg) 和样本方差 ![学生t分布](img/image_05_034.jpg)
- en: 'Considering the above-mentioned facts, the t-statistic can be defined as:'
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到上述事实，t统计量可以定义为：
- en: '![Student''s t-distribution](img/image_05_035.jpg)'
  id: totrans-328
  prefs: []
  type: TYPE_IMG
  zh: '![学生t分布](img/image_05_035.jpg)'
- en: The sampling distribution of the t-statistic will follow a t-distribution with
    *(n-1)* **degrees of freedom** (**df** ). The higher the degree of freedom, the
    closer will be the t-distribution to the standard normal distribution.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: t统计量的抽样分布将遵循具有 *(n-1)* **自由度** (**df**) 的t分布。自由度越高，t分布越接近标准正态分布。
- en: The mean of a t-distribution (*μ*) = *0* and variance *(σ2) = df/df-2*
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: t分布的均值 (*μ*) = *0*，方差 *(σ2) = df/df-2*
- en: Now, just to make things clearer, let us look back for a moment and consider
    the scenario where the population *σ* is known. When the population is normally
    distributed, the sample mean *x̄* is mostly normally distributed regardless of
    the sample size and any linear transformation of *x̄* such as ![Student's t-distribution](img/image_05_037.jpg)
    will also follow a normal distribution.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，为了让事情更清晰，让我们回顾一下，考虑总体 *σ* 已知的情况。当总体是正态分布时，无论样本量大小如何，样本均值 *x̄* 通常也是正态分布，且任何线性变换的
    *x̄*，例如![学生t分布](img/image_05_037.jpg)，也将遵循正态分布。
- en: What if the population is not normally distributed? Even then, the distribution
    of *x̄* (which is the sampling distribution) or ![Student's t-distribution](img/image_05_037.jpg) will
    follow a normal distribution as per CLT when the sample size is large enough!
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 如果总体不是正态分布怎么办？即使如此，根据中心极限定理，当样本量足够大时，*x̄*（即抽样分布）或![学生t分布](img/image_05_037.jpg)的分布将趋近于正态分布！
- en: The other scenario is that the population *σ* is unknown. With this, if the
    population is normally distributed, the sample mean *x̄* is mostly normally distributed,
    but the random variable ![Student's t-distribution](img/image_05_039.jpg) will
    not follow a normal distribution; it follows a t-distribution with *(n-1)* degrees
    of freedom. The reason is because of the randomness of *S* in the denominator,
    it is different for different samples.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种情况是总体的 *σ* 不为已知。如果总体是正态分布，那么样本均值 *x̄* 通常也是正态分布，但随机变量 ![学生t分布](img/image_05_039.jpg)
    将不遵循正态分布；它遵循具有 *(n-1)* 自由度的t分布。原因是因为分母中的 *S* 存在随机性，不同的样本会导致不同的值。
- en: In the above case, if the population is not normally distributed, the distribution
    of ![Student's t-distribution](img/image_05_040.jpg) will follow a normal distribution
    as per CLT with sufficiently large sample sizes (and not with the small sample
    size!). So, with the large sample size, the distribution of ![Student's t-distribution](img/image_05_040.jpg) follows
    a normal distribution, and it is safe to assume that it follows t-distribution
    because t-distribution approaches normality with an increase in the sample size.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述情况下，如果总体不是正态分布，按照中心极限定理（CLT），当样本量足够大时，![学生t分布](img/image_05_040.jpg)的分布将趋近于正态分布（但小样本量时则不适用！）。因此，当样本量较大时，![学生t分布](img/image_05_040.jpg)的分布会趋近于正态分布，可以安全地假设它符合t分布，因为t分布随着样本量增加而逐渐接近正态分布。
- en: F-distribution
  id: totrans-335
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: F-分布
- en: In statistical inference, F-distribution is used to study the variance of two
    normally distributed populations. It states that the sampling distribution of
    the sample variances from two independent normally distributed populations with
    the same population variance follow F-distribution.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 在统计推断中，F-分布用于研究两个正态分布总体的方差。它表明，来自两个独立正态分布总体的样本方差的抽样分布，如果这两个总体的方差相同，则遵循F-分布。
- en: If the sample variance of sample 1 is ![F-distribution](img/image_05_041.jpg) and
    if the sample variance of sample 2 is ![F-distribution](img/image_05_042.jpg) then,
    ![F-distribution](img/image_05_043.jpg) will have F-distribution (*σ12 = σ22*).
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 如果样本1的样本方差是![F-分布](img/image_05_041.jpg)，并且样本2的样本方差是![F-分布](img/image_05_042.jpg)，那么![F-分布](img/image_05_043.jpg)将遵循F-分布（*σ12
    = σ22*）。
- en: From the above fact, we can also say that ![F-distribution](img/image_05_044.jpg) will
    also follow F-distribution.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 根据上述事实，我们还可以说，![F-分布](img/image_05_044.jpg)也将遵循F-分布。
- en: In the previous section of chi-square distribution, we can also say that
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一节的卡方分布中，我们还可以说：
- en: '![F-distribution](img/image_05_045.jpg) will also follow F-distribution with
    *n1-1* and *n2-1* degrees of freedom. For each combination of these degrees of
    freedoms, there would be different F-distributions.'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: '![F-分布](img/image_05_045.jpg)也将遵循具有 *n1-1* 和 *n2-1* 自由度的F分布。对于这些自由度的每种组合，会有不同的F分布。'
- en: Standard error
  id: totrans-341
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 标准误差
- en: The standard deviation of the sampling distribution of a statistic (such as
    mean or variance) is called the **standard error** (**SE**), a measure of variability.
    In other words, the **standard error of the mean** (**SEM**) can be defined as
    the standard deviation of the sample mean's estimate of a population mean.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 统计量（如均值或方差）抽样分布的标准差称为**标准误差**（**SE**），它是衡量变异性的一个指标。换句话说，**均值的标准误差**（**SEM**）可以定义为样本均值对总体均值估计的标准差。
- en: 'As you increase the sample sizes, the sampling distribution of the mean gets
    more and more normal and the standard deviation gets smaller. It is proved that:'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 随着样本量的增加，均值的抽样分布变得越来越接近正态分布，标准差也变得越来越小。已证明：
- en: '![Standard error](img/image_05_046.jpg)'
  id: totrans-344
  prefs: []
  type: TYPE_IMG
  zh: '![标准误差](img/image_05_046.jpg)'
- en: (*n* being the sample size)
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: (*n* 代表样本大小)
- en: '![Standard error](img/image_05_047.jpg)'
  id: totrans-346
  prefs: []
  type: TYPE_IMG
  zh: '![标准误差](img/image_05_047.jpg)'
- en: The smaller the standard error, the more representative the sample will be of
    the overall population. Also, the larger the sample size, the smaller the standard
    error.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 标准误差越小，样本对总体的代表性就越强。此外，样本量越大，标准误差越小。
- en: SE is very important in other measures of statistical inference, such as margin
    of error and confidence interval.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 标准误差在统计推断的其他度量中非常重要，例如误差范围和置信区间。
- en: Confidence level
  id: totrans-349
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 置信水平
- en: It is a measure of how certain you would like to be (the probability) in estimating
    the population parameter through sample statistics so that the expected values
    would fall within a desired range or confidence interval. It is calculated by
    subtracting the significance level (*α*) from *1* (that is, *confidence level
    = 1 - α*). So, if *α = 0.05*, the confidence level would be *1-0.05 = 0.95*
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 它是衡量通过样本统计量估计总体参数时，你希望有多大的置信度（概率），从而使得期望值落在一个期望的区间或置信区间内。它是通过从1中减去显著性水平（*α*）来计算的（即，*置信水平
    = 1 - α*）。所以，如果*α = 0.05*，则置信水平为*1-0.05 = 0.95*。
- en: Usually, the higher the confidence level, the higher the sample size required.
    However, there are often trade-offs and you have to decide on how confident you
    would like to be so that you can estimate the sample size needed for your confidence
    level.
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，置信水平越高，所需的样本量也越大。然而，通常存在一定的权衡，您需要决定希望达到的置信度，从而估算所需的样本量。
- en: Margin of error and confidence interval
  id: totrans-352
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 误差范围和置信区间
- en: As discussed already, since a sample can never be a 100 percent representative
    of the population, estimating the population parameter through inference will
    always have some margin of error due to sampling errors. Usually, the bigger the
    sample size, the smaller the margin of error. However, you have to decide on how
    much error to allow, and estimating a proper sample size required would depend
    on that.
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，由于样本永远不能完全代表总体，通过推断估算总体参数时，总会存在一些抽样误差，导致误差范围。通常，样本越大，误差范围越小。然而，您需要决定接受多少误差，所需的适当样本大小也会取决于这一点。
- en: So, the range of values below and above the sample statistic based on the margin
    of error is called the **confidence interval**. In other words, a confidence interval
    is a range of numbers within which we believe the true population parameter to
    fall a certain percentage of the time (confidence level).
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，基于误差范围的样本统计量上下的数值范围称为**置信区间**。换句话说，置信区间是一个数值区间，我们相信总体的真实参数会有某个百分比的时间落在这个区间内（置信水平）。
- en: Please note here that a statement such as "I am 95 percent confident that the
    confidence interval contains the true value" could be misleading! The right way
    of stating this could be "*If I take an infinite number of samples of the same
    size, then 95 percent of the time the confidence interval would contains the true
    value".*
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，像“我有95％的把握置信区间包含真实值”这样的说法可能会误导！正确的表述方式应该是“*如果我从相同大小的样本中抽取无限多次样本，那么在95％的情况下，置信区间将包含真实值*”。
- en: For example, when you put the confidence level as 95 percent and the confidence
    interval as 4 percent for a sample statistic 58 (here, 58 is any sample statistic
    such as mean, variance, or standard deviation), you can say that you are 95 percent
    sure that the true percentage of the population is between 58 - 4 = 54 percent
    and 58 + 4 = 62 percent.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，当你将置信水平设为95％，并且将置信区间设为4％，对于一个样本统计量58（这里，58是任何样本统计量，如均值、方差或标准差），你可以说你有95％的把握认为总体的真实百分比在58
    - 4 = 54％和58 + 4 = 62％之间。
- en: Variability in the population
  id: totrans-357
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总体的变异性
- en: The variability in the population is one of the most important factors we should
    consider in our inferential statistics. It plays an important role in estimating
    the sample size. No matter what sampling algorithm you choose that can best represent
    the population, the sample size still plays a crucial role - and this is obvious!
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 总体的变异性是我们在推断统计中应该考虑的最重要因素之一。它在估算样本大小时起着重要作用。无论你选择什么抽样算法来最好地代表总体，样本大小仍然起着至关重要的作用——这一点显而易见！
- en: If the variation in the population is more, then the sample size required would
    also be more.
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 如果总体的变异性较大，那么所需的样本大小也会更大。
- en: Estimating sample size
  id: totrans-360
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 估算样本大小
- en: We already covered sampling techniques in the previous sections. In this section,
    we will discuss how to estimate the sample size. Assume you have to prove a concept
    or to assess the result of some action, then you take some relevant data and try
    to prove your point. However, how would you ensure you have enough data? Samples
    that are too big waste time and resources, and samples that are too small may
    lead to misleading results. Estimating the sample size depends majorly on factors
    such as the margin of error or confidence interval, confidence level, and variability
    in the population.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经在前面的章节中讨论了抽样技术。在本节中，我们将讨论如何估算样本大小。假设你必须证明某个概念或评估某个行动的结果，那么你会收集一些相关数据并试图证明你的观点。然而，如何确保你拥有足够的数据呢？样本过大浪费时间和资源，样本过小可能导致误导性的结果。估算样本大小主要取决于误差范围或置信区间、置信水平以及总体的变异性等因素。
- en: 'Consider the following example:'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑以下示例：
- en: The college president asks the statistics teacher to estimate the average age
    of the students at their college. How large a sample is necessary? The statistics
    teacher would like to be 99 percent confident that the estimate should be accurate
    within 1 year. From a previous study, the standard deviation of the ages is known
    to be 3 years.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 大学校长要求统计学老师估算其学院学生的平均年龄。需要多大的样本？统计学老师希望能有99%的置信度，使得估算值在1年以内是准确的。根据以往的研究，已知年龄的标准差为3年。
- en: 'Solution:'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: '![Estimating sample size](img/image_05_048.jpg)![Estimating sample size](img/image_05_049.jpg)'
  id: totrans-365
  prefs: []
  type: TYPE_IMG
  zh: '![估算样本大小](img/image_05_048.jpg)![估算样本大小](img/image_05_049.jpg)'
- en: Hypothesis testing
  id: totrans-366
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 假设检验
- en: Hypothesis testing is about testing the assumptions made for the population
    parameters. This helps in determining whether a result is statistically significant
    or has occurred by chance. It is the most important instrument of statistical
    research. We will discuss some of the testing to see how variables are related
    to each other in the population.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 假设检验是关于测试为总体参数所做假设的过程。这有助于确定一个结果是否具有统计学意义，或是否是偶然发生的。这是统计研究中最重要的工具之一。我们将讨论一些检验方法，看看变量在总体中是如何相互关联的。
- en: Null and alternate hypotheses
  id: totrans-368
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 原假设与备择假设
- en: The null hypothesis (denoted as H0) is often the initial claim about the population
    parameter, and it is mostly indicative of *no effect* or *no relation*. In our
    hypothesis testing, our aim is to invalidate and reject the null hypothesis to
    be able to accept the alternate hypothesis (denoted as H1). The alternate hypothesis
    is indicative of some effect in your experiment. While experimenting, please note
    here that you either reject the null hypothesis or fail to reject the null hypothesis.
    If you are successful in rejecting the null hypothesis then the alternate hypothesis
    is to be considered and if you fail to reject the null hypothesis then the null
    hypothesis is considered (though it may not be true!).
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 原假设（记作H0）通常是关于总体参数的初始假设，通常表示*无效应*或*无关联*。在我们的假设检验中，我们的目的是否定并拒绝原假设，以便接受备择假设（记作H1）。备择假设表示实验中存在某种效应。在实验过程中，请注意你要么拒绝原假设，要么无法拒绝原假设。如果你成功地拒绝了原假设，那么备择假设就应该被考虑；如果你未能拒绝原假设，那么原假设就被视为成立（尽管它可能不成立！）。
- en: So, we usually hope to get a very small P-value (lower than the defined significance
    level alpha) to be able to reject the null hypothesis. If the P-value is greater
    than alpha, then you fail to reject the null hypothesis.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，我们通常希望得到一个非常小的P值（低于定义的显著性水平alpha），以便拒绝原假设。如果P值大于alpha，那么你就无法拒绝原假设。
- en: Chi-square test
  id: totrans-371
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 卡方检验
- en: Most of the statistical inference techniques are used to estimate the population
    parameters or to test a hypothesis using the sample statistics such as *mean*.
    However, the chi-square statistic takes a completely different approach by examining
    the whole distribution or the relationship between two distributions. In the field
    of inferential statistics, many test statistics resemble a chi-square distribution.
    The most common tests using this distribution are the chi-square test of goodness
    of fit (one-way tables) and chi-square test of independence (two-way tables).
    The *goodness of fit* test is done when you want to see if the sample data follows
    the same distribution in the population and the *independence* test is done when
    you want to see if two categorical variables are related to each other in the
    population.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数统计推断技术用于估计总体参数或使用样本统计量（如*均值*）来检验假设。然而，卡方统计量采取完全不同的方法，通过检查整个分布或两个分布之间的关系来进行分析。在推断统计学领域，许多检验统计量类似于卡方分布。使用这种分布的最常见检验是卡方拟合优度检验（单向表）和卡方独立性检验（双向表）。*拟合优度*检验是在你想要查看样本数据是否遵循总体中的相同分布时进行的，而*独立性*检验是在你想要查看两个分类变量是否在总体中相互关联时进行的。
- en: 'The input data types determine whether to conduct a *goodness of fit* or *independence*
    test without specifying them as switches explicitly. So, if you provide a vector
    as input, then the *goodness of fit* test is conducted and if you provide a matrix
    as input, then the *independence* test is conducted. In either case, a vector
    of frequencies of events or a contingency matrix is provided as input which you
    need to compute first. Let us explore these through examples:'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 输入数据类型决定了是否进行*拟合优度*检验或*独立性*检验，而不需要明确指定这些作为开关。因此，如果你提供一个向量作为输入，则进行*拟合优度*检验；如果你提供一个矩阵作为输入，则进行*独立性*检验。在这两种情况下，都需要先提供事件的频率向量或列联矩阵作为输入，然后进行计算。让我们通过实例来探讨这些：
- en: '**Python**'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE24]'
  id: totrans-375
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '**Scala**'
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE25]'
  id: totrans-377
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: F-test
  id: totrans-378
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: F检验
- en: We have already covered how to calculate the F-statistic in the previous sections.
    Now we will solve a sample problem.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经在前面的章节中介绍了如何计算F统计量。现在我们将解决一个样本问题。
- en: 'Problem:'
  id: totrans-380
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 问题：
- en: You want to test the belief that the income of Master's degree holders shows
    greater variability than the income of Bachelor's degree holders. A random sample
    of 21 graduates and a random sample of 30 Masters were taken. The standard deviation
    of the graduates sample was $180 and that of the Masters sample was $112.
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 你想要检验一个假设：硕士学位持有者的收入波动性是否大于学士学位持有者的收入波动性。随机抽取了21名毕业生和30名硕士生。毕业生样本的标准差为$180，硕士生样本的标准差为$112。
- en: 'Solution:'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'The null hypothesis is: *H[0] : σ[1]² =σ[2]²*'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: '零假设是：*H[0] : σ[1]² =σ[2]²*'
- en: Given that *S[1] = $180*, *n[1] = 21*, and *S[2] = $112*, *n[2] = 30*
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 给定 *S[1] = $180*，*n[1] = 21*，*S[2] = $112*，*n[2] = 30*
- en: Considering the level of significance to be *α = 0.05*
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 假设显著性水平为*α = 0.05*
- en: '*F = S[1]² /S[2]² = 180²/112² = 2.58*'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: '*F = S[1]² /S[2]² = 180²/112² = 2.58*'
- en: From the F-table with the significance level 0.05, df1=20 and df2=29, we can
    see that the F-value is 1.94
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 从显著性水平为0.05的F表中，df1=20和df2=29，我们可以看到F值为1.94
- en: Since the computed value of F is greater than the table value of F, we can reject
    the null hypothesis and conclude that *σ[1]² >σ[2]* ^(*2*) .
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 由于计算出的F值大于表中F值，我们可以拒绝零假设并得出结论：*σ[1]² >σ[2]* ^(*2*)。
- en: Correlations
  id: totrans-389
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 相关性
- en: 'Correlations provide a way to measure the statistical dependence between two
    random variables that are numeric in nature. This shows the extent to which the
    two variables change with each other. There are basically two types of correlation
    measures: Pearson and Spearman. Pearson is more appropriate for interval scale
    data, such as temperature, height, and so on. Spearman is more appropriate for
    ordinal scale, such as a satisfaction survey where 1 is less satisfied and 5 is
    most satisfied. Also, Pearson is calculated based on true values and is useful
    in finding linear relationships whereas Spearman is based on rank order and is
    useful in finding monotonic relationships. The monotonic relationship means that
    the variables do change together, but not at a constant rate. Please note that
    both of these correlation measures can only measure linear or monotonic relationships
    and are not capable of depicting any other kind of relationships such as non-linear
    relationships.'
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: 相关性提供了一种衡量两个数值型随机变量之间统计依赖关系的方法。它展示了两个变量相互变化的程度。基本上有两种类型的相关性度量：皮尔逊相关性和斯皮尔曼相关性。皮尔逊相关性更适合于区间尺度数据，如温度、身高等；斯皮尔曼相关性则更适合于有序尺度数据，如满意度调查，其中1表示不满意，5表示最满意。此外，皮尔逊相关性是基于真实值计算的，适用于找到线性关系，而斯皮尔曼相关性则是基于排名顺序计算的，适用于找到单调关系。单调关系意味着变量确实会一起变化，但变化速率不一定恒定。请注意，这两种相关性度量只能衡量线性或单调关系，不能描绘其他类型的关系，如非线性关系。
- en: In Spark, both of these are supported. If you input two `RDD[Double]`, the output
    is a *Double* and if you input an `RDD[Vector]`, the output is a *Correlation
    Matrix*. In both Scala and Python implementations, if you do not provide the type
    of correlation as input, then the default considered is always Pearson.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Spark 中，这两者都得到了支持。如果输入是两个 `RDD[Double]`，输出是一个*Double*；如果输入是一个 `RDD[Vector]`，输出是一个*相关性矩阵*。在
    Scala 和 Python 的实现中，如果没有提供相关性类型作为输入，则默认考虑为皮尔逊相关性。
- en: '**Python**'
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: '**Python**'
- en: '[PRE26]'
  id: totrans-393
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '**Scala**'
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: '**Scala**'
- en: '[PRE27]'
  id: totrans-395
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Summary
  id: totrans-396
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we briefly covered the steps involved in the data science life
    cycle, such as data acquisition, data preparation, and data exploration through
    descriptive statistics. We also learnt to estimate the population parameters through
    sample statistics using some popular tools and techniques.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们简要介绍了数据科学生命周期中的几个步骤，如数据获取、数据准备和通过描述性统计进行数据探索。我们还学习了如何通过一些流行的工具和技术，利用样本统计量估计总体参数。
- en: We explained the basics of statistics from both theoretical and practical aspects
    by going deeper into the fundamentals in a few areas to be able to solve business
    problems. Finally, we learnt a few examples on how statistical analysis can be
    performed on Apache Spark, leveraging the out-of-the-box features, which was basically
    the objective behind this chapter.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从理论和实践两个方面解释了统计学的基础，通过深入研究几个领域的基本概念，能够解决业务问题。最后，我们学习了如何在 Apache Spark 上进行统计分析的几个示例，利用开箱即用的功能，这也是本章的主要目标。
- en: We will discuss more details of the machine learning part of data science in
    the next chapter as we have already built statistical understanding in this chapter.
    Learnings from this chapter should help connect to the machine learning algorithms
    in a more informed way.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在下一章讨论数据科学中机器学习部分的更多细节，因为本章已经建立了统计学的基础。通过本章的学习，应该能够更有根据地连接到机器学习算法。
- en: References
  id: totrans-400
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'Supported statistics by Spark:'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: Spark 支持的统计：
- en: '[http://spark.apache.org/docs/latest/mllib-statistics.html](http://spark.apache.org/docs/latest/mllib-statistics.html)'
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://spark.apache.org/docs/latest/mllib-statistics.html](http://spark.apache.org/docs/latest/mllib-statistics.html)'
- en: 'Plotting features of Databricks:'
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: Databricks 的绘图功能：
- en: '[https://docs.cloud.databricks.com/docs/latest/databricks_guide/04%20Visualizations/4%20Matplotlib%20and%20GGPlot.html](https://docs.cloud.databricks.com/docs/latest/databricks_guide/04%20Visualizations/4%20Matplotlib%20and%20GGPlot.html)'
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://docs.cloud.databricks.com/docs/latest/databricks_guide/04%20Visualizations/4%20Matplotlib%20and%20GGPlot.html](https://docs.cloud.databricks.com/docs/latest/databricks_guide/04%20Visualizations/4%20Matplotlib%20and%20GGPlot.html)'
- en: 'Detailed information on OOTB library functions of MLLIB stats:'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: MLLIB 统计的开箱即用库函数的详细信息：
- en: '[http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.mllib.stat.Statistics$](http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.mllib.stat.Statistics%24)'
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.mllib.stat.Statistics$](http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.mllib.stat.Statistics%24)'
