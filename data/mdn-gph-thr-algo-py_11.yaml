- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Goods Prices/Sales Data
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 商品价格/销售数据
- en: In this chapter, we’ll combine spatial and temporal approaches to **spatiotemporal
    data**—data that includes both spatial components and time series components.
    To handle the time components, we’ll slice our datasets into overlapping time
    windows as we did with our stock data in [*Chapter 6*](B21087_06.xhtml#_idTextAnchor078).
    To handle the spatial components, we’ll calculate local Moran statistics based
    on correlations for each time slice and threshold the value to create a network
    for that time slice. Then, we’ll look at changes in **Forman-Ricci curvature centrality**
    and **PageRank centrality** across slices of time and space. Examples include
    the Burkina Faso millet dataset first seen in [*Chapter 2*](B21087_02.xhtml#_idTextAnchor028)
    and a new store sales dataset.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将结合空间和时间方法来处理**时空数据**——这类数据既包含空间组件也包含时间序列组件。为了处理时间组件，我们将像在[*第6章*](B21087_06.xhtml#_idTextAnchor078)中处理股票数据那样，将我们的数据集切割成重叠的时间窗口。为了处理空间组件，我们将基于每个时间切片的相关性计算局部莫兰统计量，并将阈值设置为创建该时间切片的网络。然后，我们将观察时间和空间切片中的**Forman-Ricci曲率中心性**和**PageRank中心性**的变化。示例包括在[*第2章*](B21087_02.xhtml#_idTextAnchor028)中首次出现的布基纳法索小米数据集和一个新的商店销售数据集。
- en: By the end of this chapter, you’ll understand how to set up spatiotemporal data
    analytics with networks to capture changes over time within the spatial and temporal
    relationships of the datasets using **igraph** and different types of plots to
    look at spatial relationships within slices of time.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，你将了解如何使用**igraph**和不同类型的图表来设置时空数据分析，以捕获数据集中空间和时间关系随时间的变化。
- en: 'In particular, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 尤其是我们将涵盖以下主题：
- en: An introduction to spatiotemporal data
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时空数据简介
- en: Analyzing our spatiotemporal data
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分析我们的时空数据
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: You will require Jupyter Notebook to run the practical examples in this chapter.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要Jupyter Notebook来运行本章中的实践示例。
- en: 'The code for this chapter is available here: [https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python](https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的代码可在以下链接找到：[https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python](https://github.com/PacktPublishing/Modern-Graph-Theory-Algorithms-with-Python)
- en: An introduction to spatiotemporal data
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 时空数据简介
- en: In [*Chapter 2*](B21087_02.xhtml#_idTextAnchor028), we discussed some aspects
    of spatial and temporal data that make such data difficult to wrangle, analyze,
    and scale with statistical and machine learning methods. Recall that both types
    of data are not independent, with dependencies crossing either space or time in
    the dataset. Alternative approaches to prediction are needed, and representations
    of spatial and temporal data as a network allow analysts to leverage the tools
    of network science to find change points, mine for patterns, and even predict
    future system behavior in the case of temporal data. In the previous chapters,
    we’ve learned how to analyze both spatial and temporal data with network science
    tools such as centrality to understand important trends.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在[*第2章*](B21087_02.xhtml#_idTextAnchor028)中，我们讨论了使这类数据难以处理、分析和用统计和机器学习方法扩展的一些时空数据方面。回想一下，这两种类型的数据都不是独立的，数据集中的依赖关系跨越了空间或时间。需要预测的替代方法，将时空数据作为网络表示允许分析师利用网络科学工具来找到变化点、挖掘模式，甚至在时间数据的情况下预测未来系统行为。在前几章中，我们学习了如何使用网络科学工具（如中心性）来分析空间和时间数据，以了解重要趋势。
- en: Many analytic tasks in the real world involve spatiotemporal data—including
    the analysis of world stock markets influenced by local policies, data mining
    of store data across locations for trends in customer behavior and revenue, discerning
    disease sources and population vulnerabilities during an epidemic, tracking human
    behavior (such as crime, eating habits, substance use, birth rates, or terrorism)
    across countries or regions of a specific country, and demonstrating the effects
    of climate change across vulnerable countries.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 世界上许多分析任务都涉及时空数据——包括受当地政策影响的世界股票市场的分析、分析不同地点的商店数据以了解客户行为和收入趋势、在流行病期间识别疾病来源和人口脆弱性、跟踪特定国家或该国家特定地区的国家或地区的人类行为（如犯罪、饮食习惯、物质使用、出生率或恐怖主义），以及展示气候变化对脆弱国家的影响。
- en: Let’s get acquainted with our two datasets and problems relevant to many applications
    of spatiotemporal data.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们熟悉我们的两个数据集以及与许多时空数据应用相关的相关问题。
- en: The Burkina Faso market dataset
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 布基纳法索市场数据集
- en: In [*Chapter 2*](B21087_02.xhtml#_idTextAnchor028), we introduced the Burkina
    Faso market dataset, which recorded market millet prices across the country from
    Quarter 2 of 2015 to Quarter 2 of 2022\. During this period, world grain prices
    fluctuated due to COVID-19 supply chain issues and the Ukraine conflict limiting
    food distribution and aid. Food security is a major issue in many regions of the
    world, and understanding what might cause prices to soar out of reach for the
    average person or family is critical in meeting the world’s food needs and avoiding
    famine.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在[*第二章*](B21087_02.xhtml#_idTextAnchor028)中，我们介绍了布基纳法索市场数据集，该数据集记录了从2015年第二季度到2022年第二季度的全国市场小米价格。在此期间，由于COVID-19供应链问题和乌克兰冲突限制食品分销和援助，世界粮食价格波动。食品安全是全球许多地区的主要问题，了解可能造成价格飙升，使普通个人或家庭无法负担的关键因素，对于满足全球粮食需求和避免饥荒至关重要。
- en: Some regions of a country may be more vulnerable to food shortages or soaring
    costs of goods than others, and the spatial features in our dataset capture these
    for the Burkina Faso markets. We’d imagine a rural market (such as the one shown
    in *Figure 7**.1*) would face greater pricing and availability instability than
    a market in the heart of a city such as Ouagadougou. In addition, some events
    within a period may cause more pricing volatility than other events in that same
    period. Capturing the time series trends is also important to understand the causes
    and potential effects of events on grain prices in the region. Thus, capturing
    the data as spatiotemporal data allows us to analyze both trends across locations
    and across time.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 一个国家的某些地区可能比其他地区更容易受到粮食短缺或商品价格上涨的影响，我们数据集中的空间特征捕捉了布基纳法索市场的这些情况。我们可以想象，一个乡村市场（如*图7.1*中所示）可能面临比位于奥罗达古市中心的市场的更大的价格和可用性波动。此外，在某个时期内，某些事件可能比同一时期内的其他事件导致更大的价格波动。捕捉时间序列趋势对于理解事件对地区粮食价格的影响原因和潜在影响也很重要。因此，将数据作为时空数据捕捉使我们能够分析跨地点和跨时间的趋势。
- en: '![Figure 7.1 – An illustration of a rural market in Burkina Faso](img/B21087_07_01.jpg)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![图7.1 – 布基纳法索乡村市场的插图](img/B21087_07_01.jpg)'
- en: Figure 7.1 – An illustration of a rural market in Burkina Faso
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.1 – 布基纳法索乡村市场的插图
- en: To capture spatial trends, we’ll return to the weight matrix introduced in [*Chapter
    2*](B21087_02.xhtml#_idTextAnchor028), which connected markets located in provinces
    that share a border. This roughly captures the geography of Burkina Faso, allowing
    regions that share many borders the potential to influence each other’s pricing
    and demonstrating the potential supply chain issues related to remote regions
    of the country.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 为了捕捉空间趋势，我们将回到在[*第二章*](B21087_02.xhtml#_idTextAnchor028)中引入的权重矩阵，该矩阵连接了位于共享边界的省份的市场。这大致捕捉了布基纳法索的地理特征，使得共享许多边界的地区有可能相互影响其定价，并展示了与国家偏远地区相关的潜在供应链问题。
- en: Just as pricing can change over time and geography, so can sales volumes. Let’s
    turn to our next example and explore how sales can change across stores due to
    COVID-19 changes in work policies and the movements of populations across a city.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 就像价格可以随时间和地理变化一样，销售量也可以变化。让我们转向下一个例子，探讨由于COVID-19期间工作政策的变化和城市人口流动的变化，销售如何在不同商店之间变化。
- en: Store sales data
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 存储销售数据
- en: 'Let’s consider a local chain of printer supply stores in a medium-sized city.
    As populations change near store locations, it may be necessary to pivot business
    strategy: closing stores that are struggling to minimize real estate costs, preferentially
    stocking certain stores that are doing well, and opening new locations in high-volume
    sales areas. Perhaps work-from-home initiatives during COVID-19 have resulted
    in more people working from home in certain areas of the city and more people
    moving to certain areas as they have the freedom to live where they would like
    to live rather than live close to their offices. Perhaps return-to-office initiatives
    also impact demand for home office supplies. All these factors can impact the
    printer supply stores and change quickly.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑一个中等城市中一家本地打印机供应连锁店。随着商店附近人口的变化，可能需要调整业务策略：关闭经营困难以最小化房地产成本的商店，优先为表现良好的商店补货，并在销售量高的地区开设新店。也许COVID-19期间的远程办公倡议导致某些城市地区的更多人从家工作，以及更多的人因为可以自由选择居住地而不是靠近办公室而搬往某些地区。也许重返办公室的倡议也影响了家庭办公用品的需求。所有这些因素都可能影响打印机供应店，并迅速变化。
- en: 'To explore this further, we’ve created a simulated dataset with sales from
    four stores serving a single metropolitan area that mimic the population movement
    trends heralded by COVID-19 policies and subsequent waffling on return-to-office
    versus remote work policies. Let’s say Store 1 (*Figure 7**.2*) serves a population
    that mainly works in nursing, grocery store management, and other jobs that do
    not stay remote for very long. This area also has temporary school closures. We’d
    expect to see a bump in sales initially during COVID-19 lockdowns but a quick
    return-to-normal pattern of sales:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 为了进一步探讨这个问题，我们创建了一个模拟数据集，其中包含四个服务于单一大都市区的商店的销售数据，这些数据模仿了由COVID-19政策和随后的关于重返办公室与远程工作政策摇摆不定的决策所预示的人口流动趋势。假设商店1（*图7.2*）服务于主要从事护理、杂货店管理和其他不太可能长期远程工作的职业的人口。该地区还有临时学校关闭。我们预计在COVID-19封锁期间销售量会最初上升，但随后会迅速回到正常的销售模式：
- en: '![Figure 7.2 – An illustration of a printer supply store – Store 1](img/B21087_07_02.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![图7.2 – 一家打印机供应店的插图 – 商店1](img/B21087_07_02.jpg)'
- en: Figure 7.2 – An illustration of a printer supply store – Store 1
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.2 – 一家打印机供应店的插图 – 商店1
- en: However, Store 2 is located near the downtown area and serves a population of
    mostly mid-level technical workers, who largely don’t fall under return-to-work
    policies once they are fully remote. Thus, sales spike during the initial lockdown
    and stabilize to the new normal for that area of town.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，商店2位于市中心附近，服务于主要是中级技术工人的群体，一旦他们完全远程工作，他们大多不适用于重返工作岗位的政策。因此，在最初的封锁期间销售量激增，并稳定到该地区的新的正常水平。
- en: 'Store 3 serves a very desirable suburb near the downtown area mainly comprised
    of high-earning professionals who either worked from home or went into the office
    regularly before COVID-19\. The commute is typically long, but the school system
    and safety of the neighborhood are excellent. During COVID-19, this suburb experienced
    a real estate boom as families elsewhere in the state decided to settle in that
    area now that they could work from home. Thus, by 2023, the area will have a large
    remote-worker population in need of printer supplies. Store 3 may need a larger
    space by 2023, as shown in *Figure 7**.3*:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 商店3服务于市中心附近一个非常受欢迎的郊区，主要由高收入专业人士组成，他们在COVID-19之前要么在家工作，要么定期去办公室。通勤通常很漫长，但学校系统和社区的安全性都很出色。在COVID-19期间，这个郊区经历了房地产的繁荣，因为该州其他地区的家庭现在可以远程工作，决定搬到这里定居。因此，到2023年，该地区将有大量需要打印机供应的远程工作者。如图7.3*所示，商店3可能到2023年需要更大的空间：
- en: '![Figure 7.3 – An illustration of a warehouse of printer supplies](img/B21087_07_03.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![图7.3 – 一家打印机供应仓库的插图](img/B21087_07_03.jpg)'
- en: Figure 7.3 – An illustration of a warehouse of printer supplies
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.3 – 一家打印机供应仓库的插图
- en: 'Store 4, however, serves the downtown area, which experiences a dramatic population
    loss as young families who like the convenience of a short commute move to the
    suburbs. Return-to-work policies don’t attract workers back to condos in the downtown
    areas, leaving most buildings partially empty or inhabited by seasonal residents.
    Ideally, we’d like to avoid a pile-up of supplies and no potential clients (*Figure
    7**.4*):'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，商店4服务于市中心区域，该区域经历了人口的大量流失，因为喜欢短途通勤便利的年轻家庭搬到了郊区。重返工作岗位的政策并没有吸引工人回到市中心区域的公寓，导致大多数建筑部分空置或被季节性居民居住。理想情况下，我们希望避免供应积压和没有潜在客户的情况（*图7.4*）：
- en: '![Figure 7.4 – An illustration of an abandoned printer supply store with no
    customers](img/B21087_07_04.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![图7.4 – 一家无客户的废弃打印机供应店的插图](img/B21087_07_04.jpg)'
- en: Figure 7.4 – An illustration of an abandoned printer supply store with no customers
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.4 – 一家无客户的废弃打印机供应店的插图
- en: Our goal is to spot trends as they happen to pivot business strategy as quickly
    as possible to meet growing regional demands for supplies and to minimize real
    estate expenses as rents soar in our metro area. Given that these stores share
    a geography, we’ll assume that the spatial weight matrix connects all four stores
    to each other. In a larger chain of stores, creating spatial weights based on
    demographic characteristics or distance from other stores might hone the analysis.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目的是在趋势发生时迅速发现趋势，以便尽可能快地调整业务策略，以满足对供应不断增长的区域需求，并在我们大都市区的租金飙升时最大限度地减少房地产费用。鉴于这些商店共享地理位置，我们假设空间权重矩阵将所有四个商店相互连接。在一个更大的连锁店中，基于人口统计特征或其他商店的距离创建空间权重可能会使分析更加精确。
- en: For now, let’s turn our attention to the code that will help us find insights
    into our Burkina Faso market data and our COVID-19 store sales data.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们将注意力转向代码，这将帮助我们深入了解我们的布基纳法索市场数据和我们的COVID-19门店销售数据。
- en: Analyzing our spatiotemporal datasets
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分析我们的时空数据集
- en: 'Our Burkina Faso market dataset is conveniently broken into quarters, and to
    understand quarter-by-quarter changes, it makes sense to set our window size as
    four quarters (a year) with a three-quarter overlap (to focus on monthly changes).
    As we did in [*Chapter 2*](B21087_02.xhtml#_idTextAnchor028), we’ll calculate
    the local Moran statistic through the weight matrix and correlation metric. Let’s
    set up our needed packages and import our Burkina Faso Market dataset plus its
    weight matrix with `Script 7.1`:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们布基纳法索市场数据集方便地分为季度，为了理解季度间的变化，将我们的窗口大小设置为四个季度（一年），三个季度的重叠（以关注月度变化）是有意义的。正如我们在[*第2章*](B21087_02.xhtml#_idTextAnchor028)中所做的那样，我们将通过权重矩阵和相关性指标计算局部莫兰统计量。让我们通过`Script
    7.1`设置所需的包并导入布基纳法索市场数据集及其权重矩阵：
- en: '[PRE0]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now that we have our data and packages, let’s calculate the Forman-Ricci curvature
    and PageRank centrality and save the network and overall metrics for each time
    slice by adding to `Script 7.1` with a correlation threshold set to `0.9` (for
    maximum sensitivity to major changes):'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了数据和包，让我们通过添加到`Script 7.1`来计算Forman-Ricci曲率和PageRank中心性，并将每个时间切片的网络和整体指标保存下来，将相关阈值设置为`0.9`（以对主要变化的最大敏感性）：
- en: '[PRE1]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now that we have our metrics calculated, let’s plot the results to see how
    PageRank and Forman-Ricci curvature centrality vary over time by adding to `Script
    7.1`:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经计算了指标，让我们通过添加到`Script 7.1`来绘制结果，以查看PageRank和Forman-Ricci曲率中心性随时间的变化：
- en: '[PRE2]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This should show a plot with very little variance in PageRank centrality but
    an increase and cyclical fluctuation of Forman-Ricci curvature centrality (*Figure
    7**.5*). This suggests that the volatility of millet prices increased over our
    markets, starting sometime around 2018-2019 (where volatility increased, then
    decreased, then increased again before leveling off at a higher volatility level)
    and got a bit worse during COVID-19 and the Ukraine conflict.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该会显示一个PageRank中心性变化非常小的图表，但Forman-Ricci曲率中心性（*图7**.5*）会增加并周期性波动。这表明我们市场的小米价格波动性有所增加，大约从2018-2019年开始（波动性增加，然后减少，然后再次增加，最终在更高的波动水平上稳定下来），在COVID-19和乌克兰冲突期间略有恶化。
- en: '![Figure 7.5 – A plot of average centrality metrics from 2015-2022 on the Burkina
    Faso market millet prices](img/B21087_07_05.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![图7.5 – 2015-2022年布基纳法索市场小米价格的平均中心性指标图](img/B21087_07_05.jpg)'
- en: Figure 7.5 – A plot of average centrality metrics from 2015-2022 on the Burkina
    Faso market millet prices
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.5 – 2015-2022年布基纳法索市场小米价格的平均中心性指标图
- en: 'Now that we have a plot showing changes in volatility, we can investigate what
    our markets look like at different periods. You may wish to investigate all periods,
    but we’ll compare two periods—one with low volatility and one with high volatility—and
    show them in the following code. Let’s plot time period `4`, where volatility
    was low according to Forman-Ricci curvature centrality (highest centrality measurement
    in the dataset), and the size of each vertex is weighted by Forman-Ricci curvature
    for that vertex, by adding to `Script 7.1`:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个显示波动性变化的图表，我们可以调查在不同时期我们的市场看起来如何。你可能希望调查所有时期，但我们将比较两个时期——一个低波动性时期和一个高波动性时期——并在以下代码中展示它们。让我们绘制时间周期`4`，根据Forman-Ricci曲率中心性（数据集中的最高中心性测量），波动性较低，每个顶点的尺寸由该顶点的Forman-Ricci曲率加权，通过添加到`Script
    7.1`：
- en: '[PRE3]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'This should yield a plot like *Figure 7**.6*, showing very few markets connected
    by correlation and spatial weighting and very low Forman-Ricci curvature for vertices
    (very small vertex sizes):'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该会产生一个类似于*图7**.6*的图表，显示通过相关性和空间加权连接的非常少的市场，以及顶点（顶点尺寸非常小）的非常低的Forman-Ricci曲率：
- en: '![Figure 7.6 – A plot showing markets connected by correlation >0.9 within
    the same geographical area weighted by Forman-Ricci curvature centrality](img/B21087_07_06.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![图7.6 – 显示同一地理区域内通过相关性>0.9连接的市场，并按Forman-Ricci曲率中心性加权的图表](img/B21087_07_06.jpg)'
- en: Figure 7.6 – A plot showing markets connected by correlation >0.9 within the
    same geographical area weighted by Forman-Ricci curvature centrality
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.6 – 显示同一地理区域内通过相关性>0.9连接的市场，并按Forman-Ricci曲率中心性加权的图表
- en: '*Figure 7**.6* shows that most markets are not connected to each other, and
    those that are connected to each other tend to have very little mutual connectivity,
    yielding Forman-Ricci curvature centrality metrics near `0`. This means that prices
    are independent, suggesting a robust network of markets that are unlikely to be
    highly impacted by external factors such as COVID-19 or international trade changes.
    Changes that impact one or two markets are unlikely to impact all of the country’s
    markets, and sellers and consumers impacted by local issues (such as a dry quarter)
    can seek grain from a neighboring area if needed. The government can also address
    shortages by simply moving excess grain from one province with a good supply to
    another with supply issues. Fixing local issues with supplies won’t take much
    time or money from a government perspective.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '*图7**.6* 显示，大多数市场之间没有相互连接，而那些相互连接的市场往往相互连接性非常小，产生的Forman-Ricci曲率中心性指标接近`0`。这意味着价格是独立的，表明市场网络稳健，不太可能受到COVID-19或国际贸易变化等外部因素的影响。影响一到两个市场的变化不太可能影响该国的所有市场，受本地问题（如干旱季度）影响的卖家和消费者在需要时可以从邻近地区寻求谷物。政府也可以通过简单地将一个供应充足的省份的过剩谷物转移到供应有问题的另一个省份来解决短缺问题。从政府的角度来看，解决本地供应问题不会花费太多时间和金钱。'
- en: 'Let’s examine a period of higher volatility (the 19th period) and see how connectivity
    and Forman-Ricci curvature centrality compared to time period `4` by adding to
    `Script 7.1`:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考察一个波动性较高的时期（第19个时期），并看看连接性和Forman-Ricci曲率中心性如何与时间周期`4`进行比较，通过向`脚本7.1`中添加内容：
- en: '[PRE4]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This should yield a plot like *Figure 7**.7*, where many markets are connected
    to each other mutually, yielding Forman-Ricci curvature centrality metrics much
    further from zero, suggesting highly interconnected supply chains across large
    regions of the country that are vulnerable to large shortages that could cause
    a famine in the area. Addressing these issues will cost the government much more
    in terms of time and cost, leaving people vulnerable to food shortages or price
    spikes that make grain unaffordable for consumers.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该会产生一个类似于*图7**.7*的图表，其中许多市场相互连接，产生的Forman-Ricci曲率中心性指标远高于零，表明该国广大地区的供应链高度互联，容易受到可能导致该地区饥荒的大规模短缺的影响。解决这些问题将使政府在时间和成本上付出更多，使人们容易受到食品短缺或价格飙升的影响，使得谷物对消费者来说难以负担。
- en: Note
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 注释
- en: Some connected markets share many mutual connections, yielding strong curvature
    metrics, while some markets remain unconnected to any other market. The less-connected
    market prices suggest some areas are less vulnerable to widespread grain price
    spikes or shortages that would cause a famine.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 一些相互连接的市场有许多相互连接，产生了强大的曲率指标，而一些市场则与其他任何市场都没有连接。这些连接性较弱的市场的价格表明，一些地区不太容易受到广泛的谷物价格上涨或短缺的影响，这些短缺可能导致饥荒。
- en: '![Figure 7.7 – The 19th time period in the Burkina Faso market millet price
    network](img/B21087_07_07.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![图7.7 – 布基纳法索市场小米价格网络的第19个时期](img/B21087_07_07.jpg)'
- en: Figure 7.7 – The 19th time period in the Burkina Faso market millet price network
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.7 – 布基纳法索市场小米价格网络的第19个时期
- en: From our analyses, we can glean some insight into our market price behaviors
    over time. Prior to 2017, prices showed less volatility across markets. Individual
    markets weren’t as tightly coupled with respect to price, suggesting local impacts
    on pricing. However, as markets became more dependent on global forces with respect
    to price, the markets became more volatile and susceptible to the impact of world
    events, such as COVID-19 and the Ukraine conflict. Indeed, in our raw dataset,
    we can see prices soaring after these events. This suggests that country-wide
    approaches are needed to address rising food prices, rather than focus on local
    markets that are struggling or vulnerable to changes in local production or global
    aid.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 从我们的分析中，我们可以了解到我们市场价格随时间的变化情况。在2017年之前，市场价格在各个市场之间的波动性较小。各个市场在价格方面并没有紧密相连，这表明价格受到的是本地影响。然而，随着市场在价格方面越来越依赖于全球力量，市场变得更加波动，容易受到世界事件（如COVID-19和乌克兰冲突）的影响。确实，在我们的原始数据集中，我们可以看到在这些事件之后价格飙升。这表明需要全国范围内的方法来解决不断上升的食品价格，而不是仅仅关注那些正在挣扎或容易受到本地生产或全球援助变化影响的本地市场。
- en: Looking at historical changes through the **United States Agency for International
    Development** (**USAID**) database and articles found on Google, we see that 2010-2020
    was a period of development and international food aid in Burkina Faso, though
    many in the country relied mainly on subsistence farming rather than food purchased
    at markets. Given the rising prices, it is not surprising that subsistence farming
    and food aid were necessary, as grain prices reached crisis levels.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 通过查看**美国国际开发署**（**USAID**）数据库和Google上找到的文章的历史变化，我们看到2010-2020年是布基纳法索发展和国际粮食援助的时期，尽管这个国家的大多数人主要依赖自给自足的农业，而不是在市场上购买的食物。鉴于价格上涨，自给自足的农业和粮食援助是必要的，因为粮食价格达到了危机水平。
- en: 'Now that we’ve seen how to analyze spatiotemporal data to visualize trends
    of volatility, let’s turn our attention to the four stores impacted by work-from-home
    and return-to-office policies in a localized city. We’ll ignore weighting, as
    these stores are in the same area and include only four stores. We’ll use a threshold
    of `0.9` again to maximize our chances of finding extremely volatile periods in
    the data. Let’s import our data with `Script 7.2` and get started:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经看到了如何分析时空数据来可视化波动趋势，让我们将注意力转向受在家办公和重返办公室政策影响的本地城市中的四个商店。我们将忽略权重，因为这些商店位于同一区域，并且只包括四个商店。我们将再次使用`0.9`作为阈值，以最大化我们在数据中找到极端波动期的机会。让我们使用`Script
    7.2`导入我们的数据并开始：
- en: '[PRE5]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'We’ll calculate Forman-Ricci curvature and PageRank centrality for this network
    by adding to `Script 7.2`; don’t worry if you encounter a runtime warning, as
    it may appear for Windows machines but does not indicate a problem running your
    code:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过在`Script 7.2`中添加内容来计算这个网络的Forman-Ricci曲率和PageRank中心性；如果你遇到运行时警告，不用担心，因为它可能出现在Windows机器上，但这并不表示你的代码运行有问题：
- en: '[PRE6]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Again, we can plot PageRank and Forman-Ricci curvature centrality to identify
    periods of high and low volatility by adding to `Script 7.2`:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，我们可以通过在`Script 7.2`中添加内容来绘制PageRank和Forman-Ricci曲率中心性，以识别高波动和低波动期：
- en: '[PRE7]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: You should see a plot similar to *Figure 7**.8*, where volatility overall is
    fairly constant over the time period, with a few periods of increasing or decreasing
    volatility marking periods where pricing may be influenced by outside factors
    that our store managers cannot control.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该会看到一个类似于*图7.8*的图表，其中波动性在时间期间总体上相当稳定，有几个波动性增加或减少的时期，这些时期的价格可能受到我们商店经理无法控制的外部因素的影响。
- en: '![Figure 7.8 – A plot of PageRank and Forman-Ricci curvature averages](img/B21087_07_08.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图7.8 – PageRank和Forman-Ricci曲率平均值的图表](img/B21087_07_08.jpg)'
- en: Figure 7.8 – A plot of PageRank and Forman-Ricci curvature averages
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.8 – PageRank和Forman-Ricci曲率平均值的图表
- en: 'While we wouldn’t expect major changes from period to period in volatility
    to show up in network plots for each period, we do see some differences in volatility
    that are worth investigating. Let’s again choose two periods to investigate (period
    `10` and period `30`). We’ll investigate period `10` first by adding to `Script
    7.2`, weighting our vertices by Forman-Ricci curvature to visualize the interconnectivity
    of sales:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们不会期望波动性在各个时期之间有重大变化，从而在各个时期的网络图中显示出来，但我们确实看到了一些值得调查的波动性差异。让我们再次选择两个时期进行调查（时期`10`和时期`30`）。我们将首先通过在`Script
    7.2`中添加内容，通过Forman-Ricci曲率对顶点进行加权来可视化销售的互连性，来调查时期`10`：
- en: '[PRE8]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This should show a plot like *Figure 7**.9*, where only two stores are connected
    to each other, suggesting a period of relative stability where outside influences
    shouldn’t impact sales across our stores as much as in other periods that are
    more volatile.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该会显示一个类似于*图7.9*的图表，其中只有两家商店相互连接，这表明这是一个相对稳定的时期，外部影响不应该像在其他更波动的时期那样影响我们的商店的销售。
- en: '![Figure 7.9 – A plot of our stores from period 10](img/B21087_07_09.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![图7.9 – 第10个时期的商店图表](img/B21087_07_09.jpg)'
- en: Figure 7.9 – A plot of our stores from period 10
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.9 – 第10个时期的商店图表
- en: 'Let’s compare this plot with period `30`’s plot by adding to `Script 7.2`:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过在`Script 7.2`中添加内容来比较这个图表与时期`30`的图表：
- en: '[PRE9]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'This code should produce a plot similar to *Figure 7**.10*, showing connectivity
    across all four stores (maximum possible volatility), which leaves stores vulnerable
    to events that might impact sales across all four stores instead of impacting
    only one local store:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 这段代码应该会生成一个类似于*图7.10*的图表，显示所有四个商店之间的连通性（最大可能的波动性），这使得商店容易受到可能影响所有四个商店的销售而不是仅影响一个本地商店的事件的影响：
- en: '![Figure 7.10 – A network plot of our store data from period 30 showing maximal
    volatility](img/B21087_07_10.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![图7.10 – 来自第30期的我们店铺数据的网络图，显示了最大波动性](img/B21087_07_10.jpg)'
- en: Figure 7.10 – A network plot of our store data from period 30 showing maximal
    volatility
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.10 – 来自第30期的我们店铺数据的网络图，显示了最大波动性
- en: Taken together, our results suggest volatility is fairly constant for our stores
    a few months prior to COVID-19 and increases upon the work-from-home mandates,
    continuing more or less through return-to-work policies. From our raw simulation
    data, some stores benefit from this change, while other stores suffer quite a
    bit. As volatility changes, store managers need to focus on factors they can control
    regarding their individual stores, and the manager overseeing all stores in the
    area may need to strategize on how to pivot supplies and growth needs of growing
    stores while considering the consolidation of buildings for those struggling stores.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 综合来看，我们的结果表明，在COVID-19爆发前几个月，我们店铺的波动性相对稳定，在居家办公政策实施后波动性增加，并在一定程度上持续到重返工作岗位的政策实施。从我们的原始模拟数据来看，一些店铺从这种变化中受益，而其他店铺则遭受了相当大的损失。随着波动性的变化，店铺经理需要关注他们可以控制的与各自店铺相关的因素，而负责该地区所有店铺的经理可能需要制定策略，以在考虑那些陷入困境的店铺的建筑整合的同时，调整增长店铺的供应和增长需求。
- en: Overall, these analyses provide some insight into pricing and sales vulnerability
    over times of crisis, allowing decision makers to pinpoint times requiring strategy
    pivots. Combined with other analytics (such as time series forecasting through
    multichannel singular spectrum analysis, for instance, or information on demographic
    or time-of-day differences in buying behavior), these types of analyses add insight
    into the timing and specific geographies that require attention to continue thriving
    in changing times.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 总体而言，这些分析在危机时期对定价和销售脆弱性提供了一些见解，使决策者能够确定需要战略转变的时间点。结合其他分析（例如，通过多通道单频谱分析进行的时间序列预测，或者关于人口统计或购买行为时间差异的信息），这些类型的分析为在变化的时代继续繁荣提供了对时间和特定地理区域的洞察。
- en: Summary
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we extended our prior insights on temporal and spatial data
    to tackle analytics problems with spatiotemporal datasets, including a store sales
    dataset and a Burkina Faso market millet price dataset. We sliced our two datasets
    by time, calculated spatial statistics, and analyzed network centrality metrics
    to identify changepoints and periods of volatility in our data. Periods of volatility
    correspond to network vulnerability to crashes and spikes in prices, sales, and
    other metrics, as the interconnectedness of the system allows for effects on one
    part of the network to spill into other parts of the network. We saw this at play
    during COVID-19 and the Ukraine conflict for Burkina Faso’s markets, as well as
    the impacts of COVID-19 on the sales data. In [*Chapter 7*](B21087_07.xhtml#_idTextAnchor088),
    we'll look at sales and goods pricing across both time and geography to see how
    network science can solve problems in spatiotemporal data. In [*Chapter 8*](B21087_08.xhtml#_idTextAnchor097),
    we'll consider dynamic networks, where connections and even individuals can change
    over time, and examine how these changes impact disease spread in wildlife populations.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将我们对时间和空间数据的先前见解扩展到处理时空数据集的分析问题，包括一个店铺销售数据集和布基纳法索市场小米价格数据集。我们按时间切分了这两个数据集，计算了空间统计量，并分析了网络中心性指标以识别数据中的变化点和波动期。波动期对应于网络对崩溃和价格、销售以及其他指标飙升的脆弱性，因为系统的互联互通使得网络的一部分对其他部分产生影响。我们在COVID-19和布基纳法索市场的乌克兰冲突期间以及COVID-19对销售数据的影响中看到了这一点。在
    [*第7章*](B21087_07.xhtml#_idTextAnchor088) 中，我们将查看时间和地理空间上的销售和商品定价，以了解网络科学如何解决时空数据中的问题。在
    [*第8章*](B21087_08.xhtml#_idTextAnchor097) 中，我们将考虑动态网络，其中连接甚至个人会随时间变化，并研究这些变化如何影响野生动物种群中的疾病传播。
- en: References
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: Han, X., Zhu, G., Zhao, L., Du, R., Wang, Y., Chen, Z., ... & He, S. (2023).
    *Ollivier–Ricci Curvature Based Spatio-Temporal Graph Neural Networks for Traffic
    Flow Forecasting*. *Symmetry*, *15* (5), 995.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: Han, X., Zhu, G., Zhao, L., Du, R., Wang, Y., Chen, Z., ... & He, S. (2023).
    *基于Ollivier–Ricci曲率的时空图神经网络用于交通流量预测*. *对称性*, *15* (5), 995.
- en: Schlör, J., Strnad, F. M., Fröhlich, C., & Goswami, B. (2022, May). *Identifying
    patterns of teleconnections, a curvature-based network analysis*. In *EGU General
    Assembly Conference Abstracts* (pp. EGU22-7256).
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: Schlör, J., Strnad, F. M., Fröhlich, C., & Goswami, B. (2022, May). *基于曲率的网络分析识别遥相关模式*.
    见 *EGU General Assembly Conference Abstracts* (pp. EGU22-7256).
- en: 'Shekhar, S., Jiang, Z., Ali, R. Y., Eftelioglu, E., Tang, X., Gunturi, V. M.,
    & Zhou, X. (2015). *Spatiotemporal data mining: A computational perspective*.
    *ISPRS International Journal of Geo-Information*, *4* (4), 2306-2338.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 谢克哈, 姜志, 阿里, R. Y., 伊夫特利奥古卢, E., 唐晓, G. M., & 周晓 (2015). *时空数据挖掘：计算视角*. *国际摄影测量与遥感杂志*,
    *4* (4), 2306-2338.
- en: Wang, Y., Huang, Z., Yin, G., Li, H., Yang, L., Su, Y., ... & Shan, X. (2022).
    *Applying Ollivier-Ricci curvature to indicate the mismatch of travel demand and
    supply in urban transit network*. *International Journal of Applied Earth Observation
    and Geoinformation*, *106*, 102666.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 王宇, 黄志, 邢国, 李辉, 杨磊, 苏燕, ... & 山晓 (2022). *将Ollivier-Ricci曲率应用于表示城市交通网络中出行需求与供给的不匹配*.
    *国际应用地球观测与地理信息杂志*, *106*, 102666.
