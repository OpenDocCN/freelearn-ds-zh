- en: Chapter 11. The Future of ArcGIS Development
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第11章。ArcGIS开发的未来
- en: What does the future hold for those who want to develop map applications for
    ArcGIS Server? After all, the direction of the Internet changes with each new
    technology, and what is popular today might not be popular tomorrow. The Flex
    and Silverlight APIs were quite popular at one point, and now they're only being
    maintained. What does the future hold for ArcGIS Server development with JavaScript?
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 对于那些想要为ArcGIS Server开发地图应用程序的人来说，未来会怎样？毕竟，互联网的方向随着每一次新技术而改变，今天流行的明天可能就不流行了。Flex和Silverlight
    API曾经非常流行，但现在只在进行维护。JavaScript在ArcGIS Server开发中的未来会怎样？
- en: If the latest releases from ESRI are any indication, JavaScript is still the
    development language of choice for the web. However, instead of letting users
    build applications from scratch, the ArcGIS platform has released new features
    that can jump start application development. Two of them, ArcGIS Online and Web
    AppBuilder, are based on the ArcGIS JavaScript API. We'll take a look at these
    technologies, and develop an application using a map created with ArcGIS Online.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 如果ESRI的最新发布有任何迹象，JavaScript仍然是网络开发的优选语言。然而，ArcGIS平台已经发布了新的功能，可以帮助快速启动应用程序开发。其中两个，ArcGIS
    Online和Web AppBuilder，都是基于ArcGIS JavaScript API的。我们将探讨这些技术，并使用ArcGIS Online创建的地图开发一个应用程序。
- en: 'In this chapter, we''ll cover the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: How to use ArcGIS Online to create web maps
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何使用ArcGIS Online创建网络地图
- en: What Web AppBuilder is and how it relates to ArcGIS Online
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web AppBuilder是什么以及它与ArcGIS Online的关系
- en: How to use an ArcGIS Online web map in your ArcGIS JavaScript API application
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何在ArcGIS JavaScript API应用程序中使用ArcGIS Online网络地图
- en: ArcGIS Online
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ArcGIS Online
- en: 'ArcGIS Online is ESRI''s online tool for creating web maps in the cloud. ArcGIS
    Online provides a way for users to create web maps, mix and match map services
    and other data sources, modify popups, and share the resulting web maps, either
    with the general public or within their organizations. This is a screenshot of
    the ArcGIS Online page where you can add data from different sources into custom
    maps:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: ArcGIS Online是ESRI在云中创建网络地图的在线工具。ArcGIS Online为用户提供了一种创建网络地图、混合匹配地图服务和其他数据源、修改弹出窗口以及与公众或其组织共享生成的网络地图的方法。这是ArcGIS
    Online页面的截图，您可以在自定义地图中添加来自不同来源的数据：
- en: '![ArcGIS Online](img/6459OT_11_01.jpg)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![ArcGIS Online](img/6459OT_11_01.jpg)'
- en: Besides referencing data through web maps, ArcGIS Online subscriptions allow
    you to upload and store data. Tiled map services can be created with tiled map
    packages generated through ArcGIS Server. Feature services can be created to store,
    update, and retrieve feature data. You can also use other ArcGIS Server extensions,
    such as geocoding and routing through ArcGIS Online. This means that you don't
    have to use your own hardware to host your data. You can maintain your feature
    data and tiled maps in the ArcGIS Online cloud.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 除了通过网络地图引用数据外，ArcGIS Online订阅允许您上传和存储数据。可以通过ArcGIS Server生成的瓦片地图包创建瓦片地图服务。可以创建要素服务来存储、更新和检索要素数据。您还可以使用其他ArcGIS
    Server扩展，如通过ArcGIS Online进行地理编码和路线规划。这意味着您不需要使用自己的硬件来托管数据。您可以在ArcGIS Online云中维护您的要素数据和瓦片地图。
- en: Now, I'm sure you're wondering how ESRI can afford to offer these features.
    The more advanced services cost credits, which can be purchased through ESRI.
    Each simple transaction can cost a fraction of a credit, but repeated use can
    add up. Tiled and feature services also cost credits, and are charged by gigabytes
    of storage per month. Depending on the size of your organization, you get an allotted
    number of credits per year, with the option to purchase more. However, if you
    have a developer account, ArcGIS Online currently offers 50 credits a month for
    testing your applications.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我相信你一定在想知道ESRI是如何负担得起提供这些功能的。更高级的服务需要消耗积分，这些积分可以通过ESRI购买。每次简单交易可能只需消耗一小部分积分，但重复使用会累积。瓦片地图服务和要素服务也消耗积分，按每月存储的千兆字节计费。根据你组织的规模，你每年可以获得一定数量的积分，并且可以选择购买更多。然而，如果你有一个开发者账户，ArcGIS
    Online目前为测试你的应用程序提供每月50积分。
- en: ArcGIS Portal
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ArcGIS Portal
- en: If you work for an enterprise organization that doesn't want its data hosted
    through a public platform such as ArcGIS Online, there is a private version as
    well. ArcGIS Portal is an organization-centered version of ArcGIS Online that
    can work within a private or secured network. Logins can be verified through a
    number of common secure protocols such as SAML and oAuth2.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您为一家不希望其数据通过如 ArcGIS Online 这样的公共平台托管的企业的组织工作，也存在一个私有版本。ArcGIS Portal 是 ArcGIS
    Online 的以组织为中心的版本，可以在私有或受保护的网络中工作。登录可以通过多种常见的安全协议进行验证，如 SAML 和 oAuth2。
- en: ArcGIS Portal has many of the same features as ArcGIS Online. You can create
    and share web maps. You can upload, catalog, and search for data sources in your
    organization and, using administrator access, you can set user roles and permissions.
    The primary difference is that the data you create and share is kept within the
    company network. What happens in ArcGIS Portal stays in ArcGIS Portal.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: ArcGIS Portal 与 ArcGIS Online 具有许多相同的功能。您可以创建和共享网络地图。您可以在组织中上传、编目和搜索数据源，并且使用管理员访问权限，您可以设置用户角色和权限。主要区别在于您创建和共享的数据保留在公司网络内。在
    ArcGIS Portal 发生的事情将留在 ArcGIS Portal 内。
- en: Web AppBuilder
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Web AppBuilder
- en: 'Developers have made the same map tools over and over for different sites.
    Almost all generic web mapping applications have a drawing tool, a measuring tool,
    a print tool, a legend, and so on. The developers at ESRI China have implemented
    an idea to create an application that builds JavaScript web mapping apps that
    use ArcGIS Online web maps. They call the tool **Web AppBuilder**, that is shown
    in the following screenshot:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 开发者反复为不同的网站制作相同的地图工具。几乎所有通用的网络地图应用都有一个绘图工具、一个测量工具、一个打印工具、一个图例等等。ESRI 中国的开发者实施了一个想法，创建一个应用程序，构建使用
    ArcGIS Online 网络地图的 JavaScript 网络地图应用。他们称这个工具为 **Web AppBuilder**，如下面的截图所示：
- en: '![Web AppBuilder](img/6459OT_11_02.jpg)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![Web AppBuilder](img/6459OT_11_02.jpg)'
- en: Web AppBuilder creates full-page web mapping applications using the ArcGIS JavaScript
    API. The applications use responsive design elements and fit any screen. Publishers
    have a choice of color scheme, title text, logos, and an assortment of widgets.
    Web AppBuilder applications are published and hosted through ArcGIS Online, so
    you don't need your own hosting environment to create a web map application.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Web AppBuilder 使用 ArcGIS JavaScript API 创建全页面的网络地图应用。这些应用使用响应式设计元素，适用于任何屏幕。发布者可以选择颜色方案、标题文本、标志以及一系列小部件。Web
    AppBuilder 应用通过 ArcGIS Online 发布和托管，因此您不需要自己的托管环境来创建网络地图应用。
- en: You can create generic Web Appbuilder applications straight from ArcGIS Online.
    Using an existing AGOL webmap, you can create an application, add several default
    widgets, such as printing, measuring, and queries. You can define titles, color
    schemes (from a list), and parameters for each of the widgets you use.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以直接从 ArcGIS Online 创建通用的 Web Appbuilder 应用。使用现有的 AGOL 网络地图，您可以创建一个应用程序，添加几个默认小部件，如打印、测量和查询。您可以定义标题、颜色方案（从列表中选择）以及您使用的每个小部件的参数。
- en: Developer Edition
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开发者版
- en: One issue with the default Web AppBuilder is that there is no room for custom
    development. If you don't like the way the **Query** widget searches for results,
    you don't have anything better. ESRI recognized this, and released a developer
    edition for custom development.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 默认 Web AppBuilder 的问题之一是没有空间进行自定义开发。如果您不喜欢 **查询** 小部件搜索结果的方式，您没有更好的选择。ESRI 认识到这一点，并发布了开发者版以进行自定义开发。
- en: The Web AppBuilder Developer Edition is a Node.js application that lets you
    generate web mapping applications using default widgets and any custom widgets
    you create. Widgets are based on Dojo's `dijit` system, and are easily added to
    the system. Web AppBuilder and the applications created with it are tied to an
    ArcGIS Online account.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: Web AppBuilder 开发者版是一个 Node.js 应用程序，允许您使用默认小部件和您创建的任何自定义小部件生成网络地图应用。小部件基于 Dojo
    的 `dijit` 系统，并且可以轻松添加到系统中。Web AppBuilder 及其创建的应用程序与 ArcGIS Online 账户相关联。
- en: Web AppBuilder Developer Edition generates the HTML, style sheets, and JavaScript
    necessary to run a freestanding website. Configuration data is stored in JSON
    files. Along with creating custom widgets, it is possible to create custom themes,
    modifying the style and position of elements to match your requirements.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: Web AppBuilder 开发者版生成运行独立网站所需的 HTML、样式表和 JavaScript。配置数据存储在 JSON 文件中。除了创建自定义小部件外，还可以创建自定义主题，修改元素的样式和位置以满足您的需求。
- en: Widgets made for the Web AppBuilder Developer Edition are highly extensible.
    Widget components can be written for international markets using **i18n** (internationalization)
    and localization principals. Configurations can store label names in the widget
    in multiple languages, which will be loaded correctly with the application. Widget
    configurations can also be modified prior to application deployment. Settings
    for the widgets can be written using dijit form elements, much like the application
    itself, to modify the configuration.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 为 Web AppBuilder 开发者版制作的小部件具有高度的扩展性。可以使用 **i18n**（国际化）和本地化原则为国际市场编写小部件组件。配置可以将在小部件中存储的标签名称以多种语言保存，这些标签名称将与应用程序一起正确加载。小部件配置也可以在应用程序部署之前进行修改。可以使用与应用程序本身类似的方式来编写小部件的设置，使用
    dijit 表单元素来修改配置。
- en: As of the time of writing, ArcGIS Online will not host applications created
    with the Developer Edition. Applications generated with the Developer Edition
    are hosted on the developer's own platform. Since the files generated through
    the Developer Edition are static HTML, JavaScript, CSS, and image files, they
    can be hosted with little or no server-side processing.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 截至撰写本文时，ArcGIS Online 不会托管使用开发者版创建的应用程序。使用开发者版生成应用程序托管在开发者的自有平台上。由于通过开发者版生成的文件是静态的
    HTML、JavaScript、CSS 和图像文件，因此它们可以以很少或没有服务器端处理的方式进行托管。
- en: Note
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For more information regarding Web AppBuilder, refer to the ESRI website at
    [http://doc.arcgis.com/en/web-appbuilder/](http://doc.arcgis.com/en/web-appbuilder/).
    For more information about Web AppBuilder Developer Edition, including download
    instructions and tutorials, visit [https://developers.arcgis.com/web-appbuilder/](https://developers.arcgis.com/web-appbuilder/).
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 有关 Web AppBuilder 的更多信息，请参考 ESRI 网站 [http://doc.arcgis.com/en/web-appbuilder/](http://doc.arcgis.com/en/web-appbuilder/)。有关
    Web AppBuilder 开发者版的更多信息，包括下载说明和教程，请访问 [https://developers.arcgis.com/web-appbuilder/](https://developers.arcgis.com/web-appbuilder/)。
- en: More Node.js
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更多 Node.js
- en: Speaking of Node.js, there are a number of tools for the ArcGIS JavaScript API
    that rely on Node.js. The ArcGIS API for JavaScript Web Optimizer is a Node.js
    project hosted by ESRI, which packages your custom modules along with a minimum
    set of ESRI and Dojo modules for a simplified build process. You can host through
    ESRI's **content delivery network** (**CDN**), or download and host it yourself.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 谈到 Node.js，ArcGIS JavaScript API 有许多依赖于 Node.js 的工具。ArcGIS API for JavaScript
    Web Optimizer 是一个由 ESRI 托管的 Node.js 项目，它将你的自定义模块与最小数量的 ESRI 和 Dojo 模块打包，以简化构建过程。你可以通过
    ESRI 的 **内容分发网络**（**CDN**）进行托管，或者下载并自行托管。
- en: If you decide to focus more on the Web AppBuilder Developer Edition, there's
    a Node.js project for that, too. The `generator-esri-appbuilder-js` project generates
    a template Web AppBuilder widget with all the necessary files. It asks you for
    basic information, such as the widget name and author information, as well as
    what kinds of files the widget will require. The project is based on Yeoman, a
    Node.js template-generating tool.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你决定更多地关注 Web AppBuilder 开发者版，也有相应的 Node.js 项目。`generator-esri-appbuilder-js`
    项目生成一个包含所有必要文件的模板 Web AppBuilder 小部件。它会询问你一些基本信息，例如小部件名称和作者信息，以及小部件将需要哪些类型的文件。该项目基于
    Yeoman，这是一个 Node.js 模板生成工具。
- en: Note
  id: totrans-31
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For more information on the ArcGIS API for JavaScript Web Optimizer, visit [https://developers.arcgis.com/javascript/jshelp/inside_web_optimizer.html](https://developers.arcgis.com/javascript/jshelp/inside_web_optimizer.html).
    For the `generator-esri-appbuilder-js` project, you can find it on NPM at [https://www.npmjs.com/package/generator-esri-appbuilder-js](https://www.npmjs.com/package/generator-esri-appbuilder-js),
    or view the source code at [https://github.com/Esri/generator-esri-appbuilder-js](https://github.com/Esri/generator-esri-appbuilder-js).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 有关 ArcGIS API for JavaScript Web Optimizer 的更多信息，请访问 [https://developers.arcgis.com/javascript/jshelp/inside_web_optimizer.html](https://developers.arcgis.com/javascript/jshelp/inside_web_optimizer.html)。有关
    `generator-esri-appbuilder-js` 项目，你可以在 NPM 上找到它 [https://www.npmjs.com/package/generator-esri-appbuilder-js](https://www.npmjs.com/package/generator-esri-appbuilder-js)，或者查看源代码
    [https://github.com/Esri/generator-esri-appbuilder-js](https://github.com/Esri/generator-esri-appbuilder-js)。
- en: Our application
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 我们的应用程序
- en: Now that we're up to speed on the latest and greatest from ESRI, let's return
    to our story. The Y2K society called and they love the work we've done with our
    application. They can't wait to share all that information with the general public.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了 ESRI 的最新和最优秀的功能，让我们回到我们的故事。Y2K 社会联系我们了，他们非常喜欢我们使用应用程序完成的工作。他们迫不及待地想与公众分享所有这些信息。
- en: The interesting thing is that the Y2K society has purchased a few ArcGIS Online
    licenses. Now they want you to store the web map data in that format, so they
    can manage and add new data about the year 2000 as they come across it.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，Y2K协会购买了一些ArcGIS Online许可证。现在他们希望您以该格式存储web地图数据，这样他们就可以在发现时管理和添加关于2000年的新数据。
- en: Our goal is to create an ArcGIS Online webmap for the Y2K society and add it
    to our existing application. We will add the map layers, popup templates, and
    charts into the webmap. We'll then load the webmap into our existing application,
    cut out unnecessary features, and make the rest of the custom features work with
    the webmap.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目的是为Y2K协会创建一个ArcGIS Online webmap并将其添加到我们现有的应用中。我们将把地图图层、弹出模板和图表添加到webmap中。然后我们将webmap加载到我们现有的应用中，删除不必要的功能，并使其他自定义功能与webmap协同工作。
- en: Creating a webmap
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建webmap
- en: We need to create a webmap to use in our application. If you haven't already
    set up a developer account for ArcGIS Online, go to [https://developers.arcgis.com/en/sign-up/](https://developers.arcgis.com/en/sign-up/)
    to sign up for a developer account. Once you've signed in, click on **Map** in
    the top menu. It will load an empty map much like the image at the beginning of
    the chapter.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要创建一个用于我们应用的webmap。如果您还没有为ArcGIS Online设置开发者账户，请访问[https://developers.arcgis.com/en/sign-up/](https://developers.arcgis.com/en/sign-up/)注册开发者账户。登录后，点击顶部菜单中的**地图**。它将加载一个空地图，类似于本章开头的图像。
- en: 'We can start by saving a copy of our map. This will allow us to name the map,
    write descriptions, search terms, and so on. In the toolbar toward the top, click
    on the **Save** dropdown and select **Save**. This will create a dialog popup
    that will let us enter the name of our map, write a summary, and add tags that
    make it easier to search for our map. We can put the map in our base folder, or
    make a new one for the application. Add `Y2K Census Map` to the title, and give
    a brief description. It should look similar to the following screenshot:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以先保存地图的副本。这将允许我们命名地图，编写描述、搜索词等。在顶部工具栏中，点击**保存**下拉菜单并选择**保存**。这将创建一个对话框，允许我们输入地图的名称，编写摘要，并添加便于搜索地图的标签。我们可以将地图放入我们的基础文件夹，或者为应用创建一个新的文件夹。将标题添加为`Y2K人口普查地图`，并给出简要描述。它应该看起来类似于以下截图：
- en: '![Creating a webmap](img/6459OT_11_03.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![创建webmap](img/6459OT_11_03.jpg)'
- en: Once you've clicked **SAVE MAP**, the map should have a new name. If you look
    in the URL, you'll also notice some strange characters. Your webmap has now been
    assigned a new webmap ID (`?webmap=XXXXXXXXXXXXXXXXX`), which is a unique string
    that ArcGIS Online uses to reference your map. Keep this webmap ID handy, because
    we'll use it later in our application.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**保存地图**后，地图应该有一个新的名称。如果您查看URL，您也会注意到一些奇怪的字符。您的webmap现在已被分配了一个新的webmap ID
    (`?webmap=XXXXXXXXXXXXXXXXX`)，这是一个ArcGIS Online用来引用您的地图的唯一字符串。请保留这个webmap ID，因为我们稍后会用到它。
- en: Changing the basemap
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更改底图
- en: One of the best features of using ArcGIS Online to host your webmap is all the
    basemap backgrounds that are available. From satellite and aerial photos to simple
    grayscale maps, there's a good background available for your data.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 使用ArcGIS Online托管您的webmap的最好功能之一是所有可用的底图背景。从卫星和航空照片到简单的灰度地图，都有适合您数据的好背景。
- en: 'In previous versions of our application, we used the national geographic basemap
    to frame our data. We can do the same for this webmap. Click **Basemap** in the
    upper left-hand corner of the toolbar, and you''ll be able to view a number of
    web map thumbnail images. Select the **National Geographic** basemap, and the
    map should update. The basemap selector should look like the following screenshot:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们应用的先前版本中，我们使用国家地理底图来框定我们的数据。我们也可以为这个webmap做同样的事情。点击工具栏左上角的**底图**，您将能够查看许多web地图缩略图。选择**国家地理**底图，地图应该会更新。底图选择器应该看起来像以下截图：
- en: '![Changing the basemap](img/6459OT_11_04.jpg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![更改底图](img/6459OT_11_04.jpg)'
- en: Adding the census map service
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加人口普查地图服务
- en: ArcGIS Online provides a number of ways to add layers to maps. Whether we have
    an ArcGIS Server map service or a simple CSV file, ArcGIS Online can accommodate
    a wide variety of data. To add layers to the map, click on the **Add** button
    in the upper left-hand corner and select from the drop-down choices. Some of the
    different ways to add layers to webmaps are discussed in the following sections.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: ArcGIS Online 提供了多种方法向地图添加图层。无论我们是否有 ArcGIS 服务器地图服务或简单的 CSV 文件，ArcGIS Online
    都可以容纳各种数据。要向地图添加图层，请点击左上角的 **添加** 按钮，并从下拉选项中选择。以下几节将讨论向网络地图添加图层的一些不同方法。
- en: Searching for layers
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 搜索图层
- en: ArcGIS Online catalogs a wide variety of map layers for both public and organizational
    use. ArcGIS Online provides a search blank and a list of matching maps and layers
    to add to your webmap. If layers and services have been shared within your organization,
    you can search for keywords and tags to add that layer into your map. You can
    also add map services and layers that other people have marked as public data.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ArcGIS Online 为公众和组织使用提供了广泛的地图图层。ArcGIS Online 提供了一个搜索框和匹配地图及图层列表，以便添加到你的网络地图中。如果你组织内部已经共享了图层和服务，你可以搜索关键词和标签以将该图层添加到你的地图中。你还可以添加其他人标记为公开数据的地图服务和图层。
- en: Note
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 备注
- en: If your web map contains layers that are restricted to either your organization,
    or to specific groups within your organization, anyone who views the webmap will
    be prompted to log in to prove they can view the layers. If login fails, the webmap
    may load, but the restricted data will not be loaded on the map.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的网络地图包含仅限于你的组织或组织内特定组的数据层，那么查看网络地图的人将被提示登录以证明他们可以查看这些层。如果登录失败，网络地图可能会加载，但受限数据将不会加载到地图上。
- en: Browsing for ESRI layers
  id: totrans-52
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 浏览 ESRI 图层
- en: 'ESRI has a large collection of its own map data available for public use. The
    data covers a wide range of topics and interests. You can filter by category,
    and click to add the map layer to your existing map. Currently, major categories
    include the following:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: ESRI 拥有大量自己的地图数据，可供公众使用。这些数据涵盖了广泛的主题和兴趣。你可以按类别筛选，并点击将地图图层添加到现有地图中。目前，主要类别包括以下：
- en: Imagery
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 影像
- en: Basemaps
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 底图
- en: Historical maps
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 历史地图
- en: Demographics and lifestyles
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 人口统计和生活习惯
- en: Landscapes
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 地貌
- en: Earth observations
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 地球观测
- en: Urban systems
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 城市系统
- en: Transportation
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 交通
- en: Boundaries and places
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 边界和地点
- en: While you might be tempted to grab census data from this location, remember
    that this shows more current data. Since we're using the Year 2000 data in this
    case, we'll ignore this option. However, we'll remember this, because it could
    be useful in other projects.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然你可能想从这个位置抓取人口普查数据，但请记住，这显示的是更当前的数据。由于我们在这个案例中使用的是 2000 年的数据，我们将忽略此选项。然而，我们会记住这一点，因为它可能在其他项目中很有用。
- en: Adding layers from the web
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从网络添加图层
- en: 'This option allows us to add from a number of web map services. While it''s
    expected that we can add ArcGIS Server map services, some of the other choices
    may surprise you. Besides ArcGIS Server map and feature services, other layer
    types we can add include:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 此选项允许我们从多个网络地图服务中添加。虽然我们预期可以添加 ArcGIS 服务器地图服务，但其他一些选择可能会让你感到惊讶。除了 ArcGIS 服务器地图和要素服务外，我们还可以添加以下其他图层类型：
- en: WMS Service
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WMS 服务
- en: WMTS Service
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WMTS 服务
- en: Tiled Service
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 铺砖服务
- en: KML file
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: KML 文件
- en: GeoRSS file
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: GeoRSS 文件
- en: CSV file
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CSV 文件
- en: Note that the CSV file refers to one available online, more than likely through
    another service. If you have a CSV file to upload, you would select the next option.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，CSV 文件指的是一个在线可用的文件，很可能是通过另一个服务。如果你有要上传的 CSV 文件，你会选择下一个选项。
- en: Adding layer from a file
  id: totrans-73
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从文件添加图层
- en: 'Here, we get to upload a file and have ArcGIS Online render it for us. The
    dialog asks for a file to upload and, based on the file format, it will also ask
    for information to determine geographical locations. Acceptable files for adding
    geographical data include the following:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以上传一个文件，并让 ArcGIS Online 为我们渲染它。对话框要求上传一个文件，并根据文件格式，它还会要求提供信息以确定地理位置。可用于添加地理数据的可接受文件包括以下内容：
- en: A shape file with up to 1,000 features stored in a `.zip` folder
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个包含最多 1,000 个特征并存储在 `.zip` 文件夹中的形状文件
- en: A tab or comma delimited text or CSV file
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个制表符或逗号分隔的文本或 CSV 文件
- en: A **GPS Exchange Format** (**GPX**), which is available from many GPS units
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 **GPS 交换格式**（**GPX**），可以从许多 GPS 设备中获得
- en: Adding map notes
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 添加地图注释
- en: This option allows you to draw custom points, lines, and polygons on the map
    as notes for other users or applications. You can select from a number of predefined
    feature types with unique renderers. Based on the note template you pick, you
    can add points, lines, and polygons with custom symbols.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 此选项允许您在地图上绘制自定义的点、线和多边形作为其他用户或应用的备注。您可以从多种预定义的特征类型和独特的渲染器中进行选择。根据您选择的备注模板，您可以添加带有自定义符号的点、线和多边形。
- en: Our application data source
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 我们的应用程序数据源
- en: 'For our application data source, we''ll add a layer from the web. After you
    choose to add a layer from the web, select the ArcGIS web service from the drop-down
    list, and either type or paste the 2000 census map service URL in the blank. Leave
    the **Use as Basemap** checkbox unchecked. Finally, click **ADD LAYER** to add
    it to the map. You can see a screenshot of the prompt in the following image:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的应用程序数据源，我们将从网络中添加一个图层。选择从网络添加图层后，从下拉列表中选择 ArcGIS 网络服务，并输入或粘贴 2000 年人口普查地图服务
    URL 到空白处。不要勾选**用作底图**复选框。最后，点击**添加图层**将其添加到地图中。您可以在以下图像中看到提示的截图：
- en: '![Our application data source](img/6459OT_11_05.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![我们的应用程序数据源](img/6459OT_11_05.jpg)'
- en: Styling
  id: totrans-83
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 样式
- en: ArcGIS Online allows you to restyle many dynamic and feature layers, even if
    they weren't styled that way on the original map. You can add custom renderers
    to alter the color, transparency, and picture symbology of each layer. You can
    turn a simple map with no style into a custom map with unique value symbology,
    telling the story you want to tell.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: ArcGIS Online 允许您重新样式许多动态和特征层，即使它们在原始地图上没有被这样样式化。您可以为每个层添加自定义渲染器来改变颜色、透明度和图片符号。您可以将没有样式的简单地图转换为具有独特价值符号的自定义地图，讲述您想要讲述的故事。
- en: For our web map, we see the simple black outlines of the states and counties
    on our map. We're going to change the style to make them look more appealing,
    and to blend them in with the National Geographic basemap background.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的网络地图，我们在地图上看到州和县的简单黑色轮廓。我们将更改样式，使它们看起来更有吸引力，并与国家地理底图背景融合。
- en: First, click on the census map service layer under **Contents** to expand the
    map layer. You'll see the different sublayers that make up the layer, such as
    **States**, **Counties**, **Block Groups**, and **Block Points**. By clicking
    on each one, you can see the symbols for each layer.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，在**内容**下点击人口普查地图服务层以展开地图层。您将看到构成该层的不同子层，例如**州**、**县**、**街区组**和**街区点**。通过点击每个子层，您可以看到每个层的符号。
- en: We'll start changing the symbology for the **States**. Click the little downward-pointing
    triangle to the right of **States** and select **Change Style**. The first menu
    will appear on the left, and let you select a label and symbol. Between the basemap
    and our popups, we'll have a good idea of what state we're in, so we'll leave
    the labels alone. Click on the **Options** button in the **Single Symbol** drawing
    under **Select a drawing style**.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将开始更改**州**的符号。点击**州**右侧的小向下三角形，选择**更改样式**。第一个菜单将出现在左侧，允许您选择标签和符号。在底图和我们的弹出窗口之间，我们将对所在州有一个很好的了解，所以我们将保留标签不变。在**选择绘图样式**下的**单符号绘图**中点击**选项**按钮。
- en: 'The next prompt lets you change the symbol and the visibility range of the
    layer on the map. If the layers are already set with minimum and maximum visibilities,
    this will not make those more lenient, but it can make them stricter. Click on
    the **Symbol** link to get a color prompt. From here, you can set the color of
    the outline and the inside filling of the polygons. It should look something like
    the following screenshot:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个提示允许您更改地图上层的符号和可见范围。如果层已经设置了最小和最大可见性，这不会使它们更宽松，但可以使它们更严格。点击**符号**链接以获取颜色提示。从这里，您可以设置多边形的轮廓颜色和内部填充颜色。它应该看起来像以下截图：
- en: '![Styling](img/6459OT_11_06.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![样式](img/6459OT_11_06.jpg)'
- en: Change the color of the outline to a darker orange, and click **OK**. We'll
    leave a transparent fill in the states. Repeat the same processes with the **Counties**
    and **Block Groups**, picking a lighter shade of orange each time.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 将轮廓颜色改为较深的橙色，然后点击**确定**。我们将在州中保留透明的填充。对**县**和**街区组**重复相同的流程，每次选择较浅的橙色色调。
- en: Creating popups
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建弹出窗口
- en: Now that we've adjusted our layers, let's look at the popups. ArcGIS Online
    lets you create and configure popups for map layers and feature services on your
    webmap. They provide a number of popup configurations, including a list of feature
    attributes and a **What You See Is What You Get** (**WYSIWYG**) rich text editor.
    Both allow some value formatting, such as thousand separators for numbers, or
    date formatting for dates. The WYSIWYG editor also allows you to use text colors
    and add links based on value attributes.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经调整了图层，让我们看看弹出窗口。ArcGIS Online允许您为您的网络地图上的地图图层和要素服务创建和配置弹出窗口。它们提供了一系列弹出窗口配置，包括要素属性列表和**所见即所得**（**WYSIWYG**）富文本编辑器。两者都允许一些值格式化，例如数字的千位分隔符或日期的格式化。WYSIWYG编辑器还允许您使用文本颜色并根据值属性添加链接。
- en: For our application, we're going to stick with displaying the list of attributes.
    Click on the **Options** button for the **States** (the little downward-pointing
    triangle), and select **Configure Popup**. In the next menu on the left-hand side,
    we can modify the title and the contents. Remember that, in any of the blanks,
    field names are surrounded by brackets and will be replaced with values.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的应用程序，我们将坚持显示属性列表。点击**州**（向下指向的小三角形）的**选项**按钮，并选择**配置弹出窗口**。在左侧的下一个菜单中，我们可以修改标题和内容。记住，在任何空白处，字段名称都由方括号包围，并将被替换为值。
- en: Next to the **Display** dropdown, select **A list of field attributes**. This
    will create a long list of all the field attributes. We don't want to see all
    of them, or even most of them, so we'll configure which fields we see. Click on
    the **Configure Attributes** link under the list of fields.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在**显示**下拉菜单旁边，选择**字段属性列表**。这将创建一个包含所有字段属性的冗长列表。我们不想看到所有这些属性，甚至大多数属性，因此我们将配置我们看到的字段。点击字段列表下的**配置属性**链接。
- en: 'You''ll see a dialog with a list of fields available for viewing. Each field
    has a checkbox for visibility, a field name shown with brackets, and a field alias.
    Field aliases can be altered by clicking on them and typing in a different value.
    Unchecking a box here means that it won''t appear in the popup. For numeric and
    date fields, extra formatting prompts appear to the right of the list when such
    a field is selected. Look at the following screenshot:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到一个包含可用于查看的字段列表的对话框。每个字段都有一个用于可见性的复选框，一个显示在方括号中的字段名称，以及一个字段别名。可以通过点击它们并输入不同的值来更改字段别名。取消选中这里的复选框意味着它不会出现在弹出窗口中。对于数值和日期字段，当选择此类字段时，右侧将出现额外的格式化提示。请看以下截图：
- en: '![Creating popups](img/6459OT_11_07.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![创建弹出窗口](img/6459OT_11_07.jpg)'
- en: Since we see the state name in the title, we can uncheck everything but **Population
    for 2000**, **Square Miles**, and **Population per Square mile**. We'll rename
    the aliases to make them more appealing. Finally, we'll click **OK**. The list
    of attributes should reflect the three fields we've made visible at this point.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们在标题中看到了状态名称，我们可以取消选中除**2000年人口**、**平方英里**和**每平方英里人口**之外的所有选项。我们将重命名别名以使其更具吸引力。最后，我们将点击**确定**。属性列表应该反映我们目前可见的三个字段。
- en: Adding charts
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 添加图表
- en: The popup configuration controls on ArcGIS Online also allow you to add images,
    charts, and graphs based on feature attributes. The images and graphs appear in
    the popups under the content we've displayed. These graphics are drawn using the
    `dojox/charting` libraries.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: ArcGIS Online上的弹出窗口配置控件还允许您根据要素属性添加图像、图表和图形。这些图像和图表出现在我们已显示的内容下的弹出窗口中。这些图形使用`dojox/charting`库绘制。
- en: Going back to the **States** layer, we'll add the graphs for the ethnicities,
    genders, and ages in the states. In the lower left, under **Popup Media**, click
    on the **Add** button. A dropdown will appear, letting you choose the image or
    chart you would like to see. For our ethnic graph, we'll select a pie graph.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 返回到**州**图层，我们将添加各州中的民族、性别和年龄的图表。在左下角，在**弹出媒体**下，点击**添加**按钮。将出现一个下拉菜单，让您选择想要看到的图像或图表。对于我们的民族图表，我们将选择饼图。
- en: 'In the next prompt, we''re given the parameters required to configure the pie
    chart. It requires a title, a caption, and selected fields to add to the chart.
    We''re also given the option to normalize the data against another field in our
    data. If we were comparing relative population levels between areas, it would
    be beneficial to normalize against the entire population, but since we''re making
    pie charts, and the populations of each ethnic group should add up to 100 percent,
    we''ll skip normalization. You can see an example of the prompt in the following
    screenshot:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个提示中，我们得到了配置饼图所需的参数。它需要一个标题、一个说明以及要添加到图表中的选定字段。我们还得到了一个选项，可以将数据与数据中的另一个字段进行归一化。如果我们正在比较不同地区的相对人口水平，那么与总人口进行归一化将是有益的，但因为我们正在制作饼图，并且每个民族群体的人口总和应该达到100%，所以我们跳过归一化。您可以在以下截图中看到提示的示例：
- en: '![Adding charts](img/6459OT_11_08.jpg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![添加图表](img/6459OT_11_08.jpg)'
- en: For the **State** popup, we'll give the graph a name of `Ethnic Graph`. We'll
    then add a caption to explain what the chart is all about. Finally, we'll make
    sure that the **WHITE**, **BLACK**, **AMERI_ES**, **ASIAN**, **HISPANIC**, **MULT_RACE**,
    **HAWN_PI**, and **OTHER** fields are checked. Note that, if you didn't reformat
    the names of the fields when configuring the popup field name attributes in the
    previous section, the attributes will appear just as you left them. You can edit
    the field aliases here as well. You don't necessarily have to make them visible
    in the popup to make them chartable (and format their aliases) here. Finally,
    click **OK**, and you should see your **Ethnic Chart** in the list of **Popup
    Media**.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 对于**州**弹出窗口，我们将给图表命名为`民族图`。然后，我们将添加一个说明来解释图表的内容。最后，我们将确保**WHITE**、**BLACK**、**AMERI_ES**、**ASIAN**、**HISPANIC**、**MULT_RACE**、**HAWN_PI**和**OTHER**字段被选中。请注意，如果您在上一节配置弹出窗口字段名称属性时没有重新格式化字段名称，属性将保持您离开时的样子。您也可以在这里编辑字段别名。您不必一定在弹出窗口中使它们可见来使它们可图表化（并格式化它们的别名）。最后，点击**确定**，你应该能在**弹出媒体**列表中看到您的**民族图表**。
- en: We'll repeat the steps for adding the gender and age charts. For the gender
    pie chart, we'll repeat the preceding steps to add another pie chart. We'll label
    it `Gender Chart`, and make sure that the `MALES` and `FEMALES` fields are checked.
    For the age bar chart, we'll select **Bar Chart** from the first menu. In the
    second prompt, we'll title the chart `Age Chart` and add the `AGE_UNDER5`, `AGE_5_17`,
    `AGE_18_21`, `AGE_22_29`, `AGE_30_39`, `AGE_40_49`, `AGE_50_64`, and `AGE_65_UP`
    fields.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将重复添加性别和年龄图表的步骤。对于性别饼图，我们将重复前面的步骤添加另一个饼图。我们将将其标记为`性别图表`，并确保`MALES`和`FEMALES`字段被选中。对于年龄柱状图，我们将从第一个菜单中选择**柱状图**。在第二个提示中，我们将图表标题设置为`年龄图表`，并添加`AGE_UNDER5`、`AGE_5_17`、`AGE_18_21`、`AGE_22_29`、`AGE_30_39`、`AGE_40_49`、`AGE_50_64`和`AGE_65_UP`字段。
- en: Once the charts have been configured, be sure to click on **SAVE POPUP** on
    the bottom of the popup menu. This will reload the map with the new popup configurations.
    Click on a state to test that the popups appear. You should see the fields we
    added, and **Ethnic Chart** in the **State** popup. Arrows are also added to the
    right and left of the charts so that the user can view the gender and age graphs
    as well. Hovering over the graphs with your mouse will show the labels and numbers
    behind the graphs. They should appear like the popups shown in the following pictures.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦配置好图表，请务必点击弹出菜单底部的**保存弹出窗口**。这将使用新的弹出窗口配置重新加载地图。点击一个州来测试弹出窗口是否出现。你应该能看到我们添加的字段，以及**民族图表**在**州**弹出窗口中。图表的左右两侧也添加了箭头，以便用户可以查看性别和年龄图表。将鼠标悬停在图表上会显示图表背后的标签和数字。它们应该看起来像以下图片中显示的弹出窗口。
- en: 'This screenshot shows the **Ethnic Graph**:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 这张截图显示了**民族图**：
- en: '![Adding charts](img/6459OT_11_09.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![添加图表](img/6459OT_11_09.jpg)'
- en: 'This screenshot shows the **Gender Chart**:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这张截图显示了**性别图表**：
- en: '![Adding charts](img/6459OT_11_11.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![添加图表](img/6459OT_11_11.jpg)'
- en: 'This screenshot shows the **Age Chart**:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 这张截图显示了**年龄图表**：
- en: '![Adding charts](img/6459OT_11_10.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![添加图表](img/6459OT_11_10.jpg)'
- en: Uses for an ArcGIS Online webmap
  id: totrans-112
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ArcGIS Online 网上图表的用途
- en: ArcGIS Online not only provides maps, but also tools with which you can perform
    analysis, collect data, and share maps with others. Some of the other features
    available in the preceding toolbar are as follows.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: ArcGIS Online不仅提供地图，还提供了可以进行分析、收集数据和与他人共享地图的工具。上一工具栏中可用的其他功能如下。
- en: Sharing
  id: totrans-114
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 分享
- en: '**Sharing** lets you control who has access to your webmap. You can share the
    map with the world, with those in your organization, or keep it to yourself. You
    can give other people access to the map by sharing the URL for it. You can also
    imbed the webmap in any website as an iframe, or create a web application using
    one of the web app templates.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '**共享**让你可以控制谁可以访问你的webmap。你可以与世界共享地图，与组织内的人共享，或者只保留给自己。你可以通过共享地图的URL来让其他人访问地图。你还可以将webmap嵌入任何网站作为iframe，或者使用其中一个web应用模板创建网络应用程序。'
- en: Printing
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 打印
- en: The **Print** control in the toolbar opens a printable copy of the webmap in
    a new tab on your browser. The printable copy shows the title, the map in its
    current extent, and the attribution data. The page is formatted to be printed
    on an ANSI (A letter-sized) piece of paper.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 工具栏中的**打印**控制项会在浏览器的新标签页中打开一个可打印的webmap副本。可打印的副本显示了标题、当前范围的地图以及归属数据。页面格式化为打印在ANSI（A型纸大小）的纸张上。
- en: Directions
  id: totrans-118
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 路线
- en: By clicking on **Directions**, you'll get a Directions widget in the left-hand
    portion of the screen. The Directions widget lets you get directions from a starting
    point to a finishing point, with any number of stops in between. Directions and
    time can be calculated for a car, truck, or walking. You can also collect return
    trip data, as well as traffic data, on the route. Remember that directions and
    traffic routing cost credits to use.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**路线**，你将在屏幕左侧部分获得一个路线小部件。路线小部件让你可以从起点到终点获取路线，中间可以有任意多个停靠点。可以为汽车、卡车或步行计算路线和时间。你还可以收集往返路线数据以及路线上的交通数据。请记住，路线和交通路由需要消耗信用点来使用。
- en: Measurements
  id: totrans-120
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测量
- en: The measurement widget here mimics the measurement `dijit` in `esri/dijit/Measurement`.
    You can draw points, lines, and polygons to collect coordinates, lengths, and
    areas respectively. You can also change the units of measurement into metric or
    English units. When collecting latitude and longitude with points, it displays
    them in decimal degrees, as well as degrees-minutes-seconds.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 此处的测量小部件模仿了`esri/dijit/Measurement`中的测量`dijit`。你可以绘制点、线和多边形来收集坐标、长度和面积。你还可以将测量单位更改为公制或英制单位。当使用点收集纬度和经度时，它将以十进制度数显示，以及度分秒。
- en: Bookmarks
  id: totrans-122
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 书签
- en: The **Bookmarks** tool allows you to save locations on the webmap. The bookmarks
    widget captures the current map extent and gives it a name. When creating multiple
    bookmarks of areas on the map, you can quickly navigate to them by clicking on
    the bookmark names. You can also edit the names and delete unwanted bookmarks.
    Bookmark data is saved along with other features of the webmap.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '**书签**工具允许你在webmap上保存位置。书签小部件捕获当前地图范围并为其命名。当在地图上创建多个区域的书签时，你可以通过点击书签名称快速导航到它们。你也可以编辑名称和删除不需要的书签。书签数据会与其他webmap功能一起保存。'
- en: Developing against an ArcGIS Online webmap
  id: totrans-124
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 面向ArcGIS Online webmap的开发
- en: If your organization is happy with the webmaps and tools offered by ArcGIS Online,
    you could potentially run your public facing GIS from the website and never develop
    another tool. Sometimes you need custom functionality. Sometimes you need an application
    that makes custom requests from other data sources when you click on a map. Maybe
    you need a complicated query page or a query builder to collect results. Whatever
    your specialized needs, you can bring the ArcGIS Online webmap to your custom
    app.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的组织对ArcGIS Online提供的webmap和工具感到满意，你可能会从网站运行你的面向公众的GIS，而无需再开发其他工具。有时你需要定制功能。有时当你点击地图时，你需要一个应用程序从其他数据源进行定制请求。也许你需要一个复杂的查询页面或查询构建器来收集结果。无论你的特殊需求是什么，你都可以将ArcGIS
    Online webmap带入你的定制应用程序。
- en: What does using an AGOL webmap do for your application? It cuts out many of
    the map configuration steps. All the tiled, dynamic, and feature layers we would
    normally hardcode in the application can now be mashed together in a webmap and
    loaded in our app. All the popups and `infoTemplate` that we had to assign through
    code can now be carried over from the we map. Whenever changes to the map service
    layers and popups are required, they can be made through ArcGIS Online, instead
    of changing the code and hoping that users aren't still running a cached copy
    of your configuration script. Configurations can be handled by someone else, giving
    you more time to code.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 AGOL 网络地图对您的应用程序有什么好处？它省去了许多地图配置步骤。我们通常会在应用程序中硬编码的所有瓦片、动态和要素层现在可以合并到一个网络地图中，并在我们的应用程序中加载。我们之前必须通过代码分配的所有弹出窗口和
    `infoTemplate` 现在可以从网络地图中继承。每当需要更改地图服务层和弹出窗口时，都可以通过 ArcGIS Online 进行更改，而不是更改代码并希望用户没有仍在运行缓存的配置脚本副本。配置可以由其他人处理，这样您就有更多时间编码。
- en: Creating the webmap
  id: totrans-127
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建网络地图
- en: 'In order to bring in the webmap we created earlier, we need to update our `app.js`
    file. In the list of modules in the `app.js` file''s `require()` method, we need
    to add a reference to the `esri/arcgis/utils` module. This will give us the tools
    we need to add the webmap to our application:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 为了引入我们之前创建的网络地图，我们需要更新我们的 `app.js` 文件。在 `app.js` 文件 `require()` 方法中的模块列表中，我们需要添加对
    `esri/arcgis/utils` 模块的引用。这将为我们提供将网络地图添加到应用程序所需的工具：
- en: '[PRE0]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Typically, we would use the `arcgisUtils.createMap()` method to construct our
    new webmap. It requires parameters similar to the `esri/map` constructor, including
    a reference to the HTML element `id` where the map should go, and an `options`
    object. However, the `arcgisUtils.createMap()` method also requires an ArcGIS
    Online webmap `id`. You can get this `id` by opening your webmap in ArcGIS Online
    to edit. If you look at the URL, you''ll see the search parameter `webmap=XXXXXXXXXXXXXXX`,
    where those *X*''s are replaced by alphanumeric characters. You can copy and paste
    the `id` numbers into your application to create a webmap, like so:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，我们会使用 `arcgisUtils.createMap()` 方法来构建我们的新网络地图。它需要与 `esri/map` 构造函数类似的参数，包括地图应放置的
    HTML 元素 `id` 的引用，以及一个 `options` 对象。然而，`arcgisUtils.createMap()` 方法还需要一个 ArcGIS
    Online 网络地图 `id`。您可以通过在 ArcGIS Online 中打开您的网络地图以进行编辑来获取此 `id`。如果您查看 URL，您会看到搜索参数
    `webmap=XXXXXXXXXXXXXXX`，其中那些 *X* 被替换为字母数字字符。您可以将 `id` 数字复制并粘贴到您的应用程序中，以创建网络地图，如下所示：
- en: '[PRE1]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Options for the `arcgisUtils.createMap()` method include, but are not limited
    to the following:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '`arcgisUtils.createMap()` 方法的选项包括但不限于以下内容：'
- en: '`bingMapKey`: The unique key string provided in your subscription to Bing Maps.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`bingMapKey`：您在 Bing Maps 订阅中提供的唯一密钥字符串。'
- en: '`editable`: A `Boolean` value that you can use to disable any feature layer
    editing.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`editable`：一个 `Boolean` 值，您可以使用它来禁用任何要素层编辑。'
- en: '`geometryServiceURL`: URL link to ArcGIS Server geometry service.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`geometryServiceURL`：指向 ArcGIS Server 几何服务的 URL 链接。'
- en: '`ignorePopups`: A `Boolean` that will disable all popups if true.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ignorePopups`：一个 `Boolean`，如果为真，将禁用所有弹出窗口。'
- en: '`mapOptions`: The normal options you would pass to create a normal map.'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mapOptions`：您在创建普通地图时通常会传递的正常选项。'
- en: '`usePopupManager`: A `Boolean` value that, when true, tells `InfoWindow` to
    retrieve all clicked features that have popup templates. When true, it also handles
    the popups visibility of map service sublayers whether the parent layer is visible
    or not. If false, popups on sublayers may or may not load if the parent layer
    is not turned on, and you will have to manually control popup visibility for complicated
    maps.'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`usePopupManager`：一个 `Boolean` 值，当为真时，告诉 `InfoWindow` 获取所有具有弹出模板的点击特征。当为真时，它还处理地图服务子层的弹出窗口可见性，无论父层是否可见。如果为假，当父层未开启时，子层的弹出窗口可能加载或不加载，您将不得不手动控制弹出窗口的可见性，对于复杂的地图尤其如此。'
- en: 'The `arcgisUtils.createMap()` method will return a `dojo/Deferred` promise,
    which will fire a success callback using `then()` once the webmap data has been
    downloaded and the map has been created. The callback will return a response object
    that contains the following:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '`arcgisUtils.createMap()` 方法将返回一个 `dojo/Deferred` 承诺，一旦下载了网络地图数据并创建了地图，就会使用
    `then()` 触发成功回调。回调将返回一个包含以下内容的响应对象：'
- en: '`map`: The `esri/map` object created'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`map`：创建的 `esri/map` 对象'
- en: '`itemInfo`: An object containing:'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`itemInfo`：一个包含对象的对象：'
- en: '`item`: An object that contains the map title, a snippet to describe it, and
    the extent in a nested array form'
  id: totrans-142
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`item`：一个包含地图标题、描述片段和嵌套数组形式的范围的对象'
- en: '`itemInfo`: A JSON object containing data about the map services, renderers,
    popups, bookmarks, and other map data used to create the web map'
  id: totrans-143
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`itemInfo`：一个包含有关地图服务、渲染器、弹出窗口、书签以及其他用于创建网络地图的地图数据的JSON对象'
- en: '`errors`: An array of errors encountered when loading data and creating the
    map services'
  id: totrans-144
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`errors`：在加载数据和创建地图服务时遇到的错误数组'
- en: '`clickEventHandler` and `clickEventListener`: When populated, these control
    the map click events that show popups. If you ever need to turn off popups, you
    can run the following:'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`clickEventHandler`和`clickEventListener`：当填充时，这些控制显示弹出窗口的地图点击事件。如果您需要关闭弹出窗口，可以运行以下代码：'
- en: '[PRE2]'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'To restore the popups, run the following line of code (assuming that you''ve
    loaded the `dojo/on` module:'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要恢复弹出窗口，请运行以下代码行（假设您已加载了`dojo/on`模块）：
- en: '[PRE3]'
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Note
  id: totrans-149
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: When creating the webmap, if you set the `usePopupManager` parameter to `true`
    (the default is `false`), the `clickEventHandler` and `clickEventListener` parameters
    will be null. In that case, popup visibility will be controlled through the `map.setInfoWindowOnClick(boolean)`
    method.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建网络地图时，如果您将`usePopupManager`参数设置为`true`（默认为`false`），则`clickEventHandler`和`clickEventListener`参数将为null。在这种情况下，弹出窗口的可见性将通过`map.setInfoWindowOnClick(boolean)`方法来控制。
- en: 'Since we incorporated the ESRI Bootstrap back in [Chapter 8](ch08.html "Chapter 8. Styling
    Your Map"), *Styling Your Map*, we need to use the ESRI Bootstrap version of the
    `createMap()` constructor in the `esri/arcgis/utils` module. Since the map may
    take time to load, we''ll move the census widget loading inside the deferred callback.
    The code should look as follows:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们在[第8章](ch08.html "第8章。美化您的地图")中引入了ESRI Bootstrap，因此我们需要在`esri/arcgis/utils`模块中使用`createMap()`构造函数的ESRI
    Bootstrap版本。由于地图可能需要一些时间才能加载，我们将把普查小部件的加载移到延迟回调中。代码应如下所示：
- en: '[PRE4]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: In our census widget
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在我们的普查小部件中
- en: 'Now that we have defined many parts of our map in the webmap, we can remove
    a lot of the widget code that handled the same information. In the module reference
    of our census''s `define` statement, we can remove references to the following
    modules:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经在网络地图中定义了我们地图的许多部分，我们可以删除处理相同信息的许多小部件代码。在我们的普查`define`语句的模块引用中，我们可以删除对以下模块的引用：
- en: The **State**, **County**, **Block Group**, and **Block Point** templates
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**州**、**县**、**街区组**和**街区点**模板'
- en: '`IdentifyTask` and `IdentifyParameter`'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`IdentifyTask`和`IdentifyParameter`'
- en: '`InfoTemplates`'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`InfoTemplates`'
- en: '`D3/d3`'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`D3/d3`'
- en: Remember to delete the module references as well as their corresponding variables.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 记得删除模块引用以及它们对应的变量。
- en: In the body of our widget, we can remove any references to the `identifytask`
    or map clicking, or `infowindow` selection events, since that controlled the popups.
    We can also remove all the methods that created the charts on our popups. All
    we're left with is a widget that populates the drop-down menus for states, counties,
    and block groups, to let us see that data.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们小部件的主体中，我们可以删除对`identifytask`或地图点击或`infowindow`选择事件的任何引用，因为它们控制了弹出窗口。我们还可以删除创建弹出窗口上图表的所有方法。我们剩下的只是一个填充州、县和街区组下拉菜单的小部件，以便我们可以查看这些数据。
- en: Don't feel bad about deleting so much code. One of the joys of a developer's
    life is to delete lines of code, since they are possible sources of errors.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 对于删除这么多代码，请不要感到难过。开发者生活中的一大乐趣就是删除代码行，因为它们可能是错误的可能来源。
- en: Accessing webmap in our app
  id: totrans-162
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在我们的应用程序中访问网络地图
- en: What would we do if we needed something from the ArcGIS Online webmap configuration?
    If we want that information, the ArcGIS JavaScript API gives us the tools to retrieve
    it. By using the `esri/arcgis/utils` and `esri/request` modules, we can retrieve
    and work with our web map data.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们需要从ArcGIS Online网络地图配置中获取某些信息，我们会怎么做？如果我们需要这些信息，ArcGIS JavaScript API为我们提供了检索它的工具。通过使用`esri/arcgis/utils`和`esri/request`模块，我们可以检索并处理我们的网络地图数据。
- en: 'To access our web map configuration data, we need two pieces of information:
    the URL of the site hosting the data and the web map ID. The URL of the service
    hosting the webmap data can be found in the `arcgisUrl` property of the `esri/arcgis/utils`
    module. By default, it points to [http://www.arcgis.com/sharing/rest/content/items](http://www.arcgis.com/sharing/rest/content/items),
    but if your webmaps are hosted in a private enterprise network in the ArcGIS portal,
    this URL string should be replaced with the appropriate URL for your portal service.'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问我们的 web 地图配置数据，我们需要两件信息：托管数据的网站 URL 和 web 地图 ID。托管 webmap 数据的服务 URL 可以在 `esri/arcgis/utils`
    模块的 `arcgisUrl` 属性中找到。默认情况下，它指向 [http://www.arcgis.com/sharing/rest/content/items](http://www.arcgis.com/sharing/rest/content/items)，但如果你的
    webmap 在 ArcGIS 门户的私有企业网络中托管，则应将此 URL 字符串替换为你的门户服务的适当 URL。
- en: 'In our JavaScript code, we can combine the URL hosting the webmap data, along
    with the webmap ID, into a URL to access JSON data for our webmap. We can use
    the `esri/request` module to request the data from the URL and use it wherever
    we need in our application. A bit of sample code is shown in the following snippet:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的 JavaScript 代码中，我们可以将托管 webmap 数据的 URL 和 webmap ID 结合起来，形成一个 URL，以便访问我们
    webmap 的 JSON 数据。我们可以使用 `esri/request` 模块从 URL 请求数据，并在我们的应用程序中需要的地方使用它。以下是一个示例代码片段：
- en: '[PRE5]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If you look at the JSON results from our webmap, using either the map console
    or a JSON viewing plugin for the browser, you can see that the webmap data for
    our application includes map service layers, a background basemap, and even details
    about the configuration of our popups. There's a lot of potentially useful information
    in this response, should we need it.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你查看我们 webmap 的 JSON 结果，无论是使用地图控制台还是浏览器的 JSON 查看插件，你都可以看到我们应用程序的 webmap 数据包括地图服务图层、背景底图，甚至关于我们弹出窗口配置的详细信息。如果需要，这个响应中包含了很多可能有用的信息。
- en: Interacting with the map through code
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 通过代码与地图交互
- en: In our previous version, we loaded `InfoTemplates` for each layer to define
    the format of the content displayed in the popups. Now that we have all that information
    defined through ArcGIS Online, we don't need to make the extra HTTP requests to
    load the HTML templates. You can click on the map and the popups will be ready
    to be used.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们之前的版本中，我们为每个图层加载 `InfoTemplates` 以定义弹出窗口中显示的内容的格式。现在，由于我们通过 ArcGIS Online
    定义了所有这些信息，我们不需要进行额外的 HTTP 请求来加载 HTML 模板。你可以在地图上点击，弹出窗口就会准备好使用。
- en: However, we run into a problem when we try to use our custom drop-down selectors
    to bring up the popups. In the older version, we would query the data, add an
    appropriate template, and insert it in the `InfoWindow`. Now, a user click pulls
    the appropriate data for us. But how can we click on the map without clicking
    on the map?
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，当我们尝试使用自定义的下拉选择器来弹出弹出窗口时，我们遇到了问题。在旧版本中，我们会查询数据，添加适当的模板，并将其插入到 `InfoWindow`
    中。现在，用户点击会为我们获取适当的数据。但我们如何在不点击地图的情况下点击地图呢？
- en: Using an undocumented trick, we can trigger a map-click event with our data.
    We could zoom to the feature extent on the map and trigger the map click event
    when it's done. This trick has been successfully deployed on a number of websites
    that use ArcGIS Online webmaps.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 使用一个未记录的技巧，我们可以用我们的数据触发地图点击事件。我们可以将地图缩放到要素范围，并在完成后触发地图点击事件。这个技巧已经在多个使用 ArcGIS
    Online webmap 的网站上成功部署。
- en: 'Look for the `_updateInfoWindowFromQuery()` method in the `Census.js` widget.
    It currently contains steps that set the map extent and fill in the contents of
    the map''s `InfoWindow`. We''ll keep the extent setting, but remove any references
    to `map.infoWindow`. Instead, inside the asynchronous callback function called
    after the map has changed extents, we''ll add code to call the `map.onClick()`
    method to trigger the click event:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `Census.js` 小部件中查找 `_updateInfoWindowFromQuery()` 方法。它目前包含设置地图范围和填充地图 `InfoWindow`
    内容的步骤。我们将保留范围设置，但删除对 `map.infoWindow` 的任何引用。相反，在地图范围改变后调用的异步回调函数内部，我们将添加代码来调用
    `map.onClick()` 方法以触发点击事件：
- en: '[PRE6]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The `map.onClick()` function requires an object with three properties: a graphic,
    a `mapPoint`, and a `screenPoint` that contains the coordinates of the point on
    the screen. We can use the first of our query results for the graphic that has
    been clicked. For a quick and dirty click location, we can use the center of the
    current extent, which we get from `resultExtent.getCenter()`. As for the corresponding
    `screenPoint` for our map point, the map has methods for converting geographic
    points to screen points and the other way around. We''ll use the `map.toScreen()`
    method with the center point to get its coordinates on the screen. We''ll then
    feed the results into the `map.onClick()` method, and test the application. The
    function should look like the following:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '`map.onClick()`函数需要一个包含三个属性的对象：一个图形、一个`mapPoint`和一个包含屏幕上该点坐标的`screenPoint`。我们可以使用我们的查询结果中的第一个来获取被点击的图形。对于快速且简单的点击位置，我们可以使用当前范围的中心，这是我们通过`resultExtent.getCenter()`获得的。至于我们地图点的相应`screenPoint`，地图有将地理点转换为屏幕点以及相反的方法。我们将使用`map.toScreen()`方法与中心点来获取其在屏幕上的坐标。然后我们将结果输入到`map.onClick()`方法中，并测试应用程序。该函数看起来应该如下所示：'
- en: '[PRE7]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'We can test the code by loading our application and clicking the **Census**
    button. It should show our drop-down modals for the state, county, and block group
    data. When we select a state like California, it should query, zoom, and the popup
    should appear momentarily with the popups we configured earlier. Now, we have
    a fully functioning census application, while letting ArcGIS Online handle most
    of the work:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过加载我们的应用程序并点击**Census**按钮来测试代码。它应该显示我们的州、县和街区数据下拉模态。当我们选择像加利福尼亚这样的州时，它应该查询、缩放，并且之前配置的弹出窗口应该瞬间出现。现在，我们有一个完全功能性的普查应用程序，同时让ArcGIS
    Online处理大部分工作：
- en: '![Interacting with the map through code](img/6459OT_11_12.jpg)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![通过代码与地图交互](img/6459OT_11_12.jpg)'
- en: Summary
  id: totrans-178
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: 'In this chapter, we have looked at the newest tools provided by ESRI for the
    ArcGIS platform: ArcGIS Online and Web AppBuilder. We have created a webmap using
    ArcGIS Online, adding layers, formatting them, and creating popups. We added the
    webmap to our own application.'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了ESRI为ArcGIS平台提供的最新工具：ArcGIS Online和Web AppBuilder。我们使用ArcGIS Online创建了一个webmap，添加了图层，格式化它们，并创建了弹出窗口。我们将webmap添加到了我们自己的应用程序中。
- en: Throughout this book, we've dived deep into the ArcGIS JavaScript API. We started
    by creating a simple webmap application, complete with click events and geographical
    data. You have learned how to use to tools provided by the API and the Dojo framework
    to build custom controls and modules that you could reuse from project to project.
    You then experimented with adding other JavaScript libraries, so that developers
    not so familiar with dojo could contribute. You learned how to edit geographical
    data through web applications. You also learned how to style your map applications
    for desktop and mobile use. You even learned how to unit test your code. Finally,
    you learned how ESRI is simplifying webmap development through ArcGIS Online and
    Web AppBuilder, bringing applications to the public faster. You have definitely
    come a long way.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书的整个过程中，我们深入研究了ArcGIS JavaScript API。我们从一个简单的带有点击事件和地理数据的webmap应用程序开始。你学习了如何使用API和Dojo框架提供的工具来构建可以跨项目重复使用的自定义控件和模块。然后你尝试添加其他JavaScript库，以便不熟悉dojo的开发者也能做出贡献。你学习了如何通过Web应用程序编辑地理数据。你还学习了如何为桌面和移动设备样式化你的地图应用程序。你甚至学习了如何对代码进行单元测试。最后，你学习了ESRI如何通过ArcGIS
    Online和Web AppBuilder简化webmap开发，从而更快地将应用程序带给公众。你无疑已经取得了很大的进步。
- en: Note
  id: totrans-181
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Where do you go from here? There are a number of great books, blogs, and other
    resources. You can find out about current trends in ArcGIS development through
    ESRI's forums at [http://geonet.esri.com](http://geonet.esri.com), or find support
    for the latest ArcGIS APIs at [http://developers.arcgis.com](http://developers.arcgis.com).
    For blogs, you can check out Dave Bouwman's blog at [http://blog.davebouwman.com](http://blog.davebouwman.com),
    or Rene Rubalcava at [http://odoe.net](http://odoe.net). For books, you may want
    learn about how to manage ArcGIS Server to serve your web maps with *Managing
    ArcGIS for Server* by Hussein Nasser. You may also want to check out *ArcGIS Web
    Development* by Rene Rubalcava, *Developing Web and Mobile ArcGIS Server Applications
    with JavaScript* by Eric Pimpler, or *Developing Mobile Web Applications* by Matthew
    Sheehan.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 你接下来要去哪里？有很多优秀的书籍、博客和其他资源。你可以在ESRI的论坛上了解ArcGIS开发的最新趋势，论坛地址为[http://geonet.esri.com](http://geonet.esri.com)，或者找到最新ArcGIS
    API的支持，地址为[http://developers.arcgis.com](http://developers.arcgis.com)。对于博客，你可以查看Dave
    Bouwman的博客，地址为[http://blog.davebouwman.com](http://blog.davebouwman.com)，或者Rene
    Rubalcava的博客，地址为[http://odoe.net](http://odoe.net)。对于书籍，你可能想了解如何通过Hussein Nasser的《Managing
    ArcGIS for Server》来管理ArcGIS Server以提供你的网络地图。你可能还想阅读Rene Rubalcava的《ArcGIS Web
    Development》，Eric Pimpler的《Developing Web and Mobile ArcGIS Server Applications
    with JavaScript》，或者Matthew Sheehan的《Developing Mobile Web Applications》。
